{"version":3,"sources":["webpack:///app.bundle.js","webpack:///webpack/bootstrap c5b93f66f92ee1eecb4b","webpack:///c:/data/Projects/Steering/src/bootstrap.js","webpack:///./~/babel-runtime/helpers/interop-require-default.js","webpack:///c:/data/Projects/Steering/~/hedra/bootstrap.jsx","webpack:///./~/debug/browser.js","webpack:///./~/debug/debug.js","webpack:///./~/debug/~/ms/index.js","webpack:///c:/data/Projects/Steering/src/app.js","webpack:///./~/babel-runtime/helpers/get.js","webpack:///./~/babel-runtime/core-js/object/get-own-property-descriptor.js","webpack:///./~/babel-runtime/~/core-js/library/fn/object/get-own-property-descriptor.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.js","webpack:///./~/babel-runtime/~/core-js/library/modules/es6.object.get-own-property-descriptor.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.to-iobject.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.iobject.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.cof.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.defined.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.object-sap.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.def.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.global.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.core.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.fails.js","webpack:///./~/babel-runtime/helpers/inherits.js","webpack:///./~/babel-runtime/core-js/object/create.js","webpack:///./~/babel-runtime/~/core-js/library/fn/object/create.js","webpack:///./~/babel-runtime/core-js/object/set-prototype-of.js","webpack:///./~/babel-runtime/~/core-js/library/fn/object/set-prototype-of.js","webpack:///./~/babel-runtime/~/core-js/library/modules/es6.object.set-prototype-of.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.set-proto.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.is-object.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.an-object.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.ctx.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.a-function.js","webpack:///./~/babel-runtime/helpers/create-class.js","webpack:///./~/babel-runtime/core-js/object/define-property.js","webpack:///./~/babel-runtime/~/core-js/library/fn/object/define-property.js","webpack:///./~/babel-runtime/helpers/class-call-check.js","webpack:///./~/babel-runtime/helpers/to-consumable-array.js","webpack:///./~/babel-runtime/core-js/array/from.js","webpack:///./~/babel-runtime/~/core-js/library/fn/array/from.js","webpack:///./~/babel-runtime/~/core-js/library/modules/es6.string.iterator.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.string-at.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.to-integer.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.iter-define.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.library.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.redef.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.hide.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.property-desc.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.support-desc.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.has.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.wks.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.shared.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.uid.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.iterators.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.iter-create.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.tag.js","webpack:///./~/babel-runtime/~/core-js/library/modules/es6.array.from.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.to-object.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.iter-call.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.is-array-iter.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.to-length.js","webpack:///./~/babel-runtime/~/core-js/library/modules/core.get-iterator-method.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.classof.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.iter-detect.js","webpack:///./~/babel-runtime/core-js/promise.js","webpack:///./~/babel-runtime/~/core-js/library/fn/promise.js","webpack:///./~/babel-runtime/~/core-js/library/modules/web.dom.iterable.js","webpack:///./~/babel-runtime/~/core-js/library/modules/es6.array.iterator.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.unscope.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.iter-step.js","webpack:///./~/babel-runtime/~/core-js/library/modules/es6.promise.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.strict-new.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.for-of.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.same.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.species.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.microtask.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.task.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.invoke.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.html.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.dom-create.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.mix.js","webpack:///./~/babel-runtime/core-js/get-iterator.js","webpack:///./~/babel-runtime/~/core-js/library/fn/get-iterator.js","webpack:///./~/babel-runtime/~/core-js/library/modules/core.get-iterator.js","webpack:///c:/data/Projects/Steering/~/hedra/app.jsx","webpack:///c:/data/Projects/Steering/~/hedra/hedra.jsx","webpack:///c:/data/Projects/Steering/~/emitter/emitter.jsx","webpack:///c:/data/Projects/Steering/vendor/three.js","webpack:///./~/babel-runtime/core-js/math/sign.js","webpack:///./~/babel-runtime/~/core-js/library/fn/math/sign.js","webpack:///./~/babel-runtime/~/core-js/library/modules/es6.math.sign.js","webpack:///./~/babel-runtime/~/core-js/library/modules/$.sign.js","webpack:///./~/babel-runtime/core-js/object/define-properties.js","webpack:///./~/babel-runtime/~/core-js/library/fn/object/define-properties.js","webpack:///c:/data/Projects/Steering/~/hedra/plugins/resize.jsx","webpack:///c:/data/Projects/Steering/src/lib/random.js","webpack:///c:/data/Projects/Steering/src/agent.js","webpack:///./~/babel-runtime/helpers/bind.js","webpack:///c:/data/Projects/Steering/src/steering/index.js","webpack:///c:/data/Projects/Steering/vendor/gl-matrix/vec3.js","webpack:///c:/data/Projects/Steering/vendor/gl-matrix/common.js","webpack:///c:/data/Projects/Steering/src/hunt.js","webpack:///c:/data/Projects/Steering/src/steering/behaviours/wander.js","webpack:///c:/data/Projects/Steering/src/steering/behaviour.js","webpack:///c:/data/Projects/Steering/src/steering/behaviours/pursue.js","webpack:///c:/data/Projects/Steering/src/steering/behaviours/seek.js","webpack:///c:/data/Projects/Steering/src/steering/behaviours/evade.js","webpack:///c:/data/Projects/Steering/src/steering/behaviours/flee.js","webpack:///c:/data/Projects/Steering/src/swarm.js","webpack:///c:/data/Projects/Steering/src/steering/behaviours/align.js","webpack:///c:/data/Projects/Steering/src/steering/behaviours/cohere.js","webpack:///c:/data/Projects/Steering/src/steering/behaviours/separate.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","_interopRequireDefault","Object","defineProperty","value","_hedraBootstrap","_hedraBootstrap2","_app","_app2","obj","__esModule","default","_debug","_debug2","window","debug","App","onload","load","then","app","parent","document","body","useColors","documentElement","style","console","firebug","exception","table","navigator","userAgent","toLowerCase","match","parseInt","RegExp","$1","formatArgs","args","arguments","this","namespace","humanize","diff","color","concat","Array","prototype","slice","index","lastC","replace","splice","log","Function","apply","save","namespaces","storage","removeItem","e","r","localstorage","localStorage","chrome","local","colors","formatters","j","v","JSON","stringify","enable","selectColor","prevColor","length","disabled","enabled","self","curr","Date","ms","prevTime","prev","coerce","format","formatter","val","logFn","bind","fn","split","len","i","skips","push","substr","names","disable","name","test","Error","stack","message","parse","str","exec","n","parseFloat","type","y","d","h","s","short","Math","round","long","plural","floor","ceil","options","_get","_inherits","_createClass","_classCallCheck","_toConsumableArray","_Promise","_getIterator","_hedraApp","_hedraApp2","_hedraPluginsResize","_hedraPluginsResize2","_libRandom","_agent","_agent2","_hunt","_swarm","_swarm2","_BaseApp","config","_this","getPrototypeOf","ratio","camera","position","set","lookAt","scene","width","undefined","height","on","event","tan","fovx","PI","fovy","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_loop","agent","add","steering","fromDisc","velocity","fromCircle","x","toArray","_iterator","next","done","err","key","all","_Object$getOwnPropertyDescriptor","_x","_x2","_x3","_again","object","property","receiver","desc","getter","get","$","it","getDesc","$Object","create","getProto","isEnum","propertyIsEnumerable","getOwnPropertyDescriptor","setDesc","setDescs","defineProperties","getKeys","keys","getNames","getOwnPropertyNames","getSymbols","getOwnPropertySymbols","each","forEach","toIObject","$getOwnPropertyDescriptor","IObject","defined","cof","toString","TypeError","KEY","$def","exp","S","F","global","core","PROTOTYPE","ctx","that","source","own","out","isGlobal","G","isProto","P","target","B","W","C","param","UNDEFINED","__g","version","__e","_Object$create","_Object$setPrototypeOf","subClass","superClass","constructor","enumerable","writable","configurable","__proto__","D","setPrototypeOf","isObject","anObject","check","O","proto","buggy","aFunction","a","b","_Object$defineProperty","props","descriptor","Constructor","protoProps","staticProps","instance","_Array$from","arr","isArray","arr2","from","$at","String","iterated","_t","_i","point","toInteger","TO_STRING","pos","l","charCodeAt","charAt","isNaN","LIBRARY","$redef","hide","has","SYMBOL_ITERATOR","Iterators","BUGGY","FF_ITERATOR","KEYS","VALUES","returnThis","Base","NAME","DEFAULT","IS_SET","FORCE","methods","createMethod","kind","TAG","_native","_default","IteratorPrototype","values","entries","createDesc","bitmap","hasOwnProperty","store","Symbol","SHARED","px","random","tag","stat","toObject","isArrayIter","toLength","getIterFn","iter","arrayLike","result","step","iterator","mapfn","mapping","iterFn","ret","ITERATOR","min","classof","getIteratorMethod","ARG","T","callee","SAFE_CLOSING","riter","safe","Promise","NodeList","HTMLCollection","setUnscope","_k","Arguments","Wrapper","strictNew","forOf","setProto","same","species","SPECIES","RECORD","asap","PROMISE","process","isNode","testResolve","sub","resolve","useNative","P2","works","thenableThenGotten","isPromise","sameConstructor","getConstructor","isThenable","notify","record","isReject","chain","ok","run","react","cb","fail","rej","res","setTimeout","handler","promise","isUnhandled","emit","onunhandledrejection","reason","error","$reject","$resolve","wrapper","executor","onFulfilled","onRejected","catch","reject","iterable","remaining","results","race","f","is","head","last","macrotask","Observer","MutationObserver","WebKitMutationObserver","flush","domain","exit","enter","nextTick","toggle","node","createTextNode","observe","characterData","data","task","defer","channel","port","invoke","html","cel","setTask","setImmediate","clearTask","clearImmediate","MessageChannel","counter","queue","ONREADYSTATECHANGE","listner","port2","port1","onmessage","postMessage","addEventListener","importScripts","appendChild","removeChild","clear","un","createElement","src","getIterator","_hedra","_hedra2","_three","_three2","HedraApp","_Hedra","make","innerWidth","innerHeight","offsetWidth","offsetHeight","margin","backgroundColor","Scene","PerspectiveCamera","copy","Vector3","renderer","WebGLRenderer","alpha","antialias","setClearColor","setSize","domElement","display","_","clock","Clock","pause","play","Stats","stats","top","left","TWEEN","_time","time","update","_this2","start","requestAnimationFrame","_animate","stop","_this3","running","_frame","getDelta","getElapsedTime","delta","bubble","render","_emitter","_emitter2","Hedra","_Emitter","geometry","material","Mesh","Object3D","children","child","tween","Tween","to","duration","easing","onComplete","onStop","rotation","quaternion","scale","Emitter","_emitters","_subscribers","_emitters$event","_len","items","_key","shift","_emitters$event2","_len2","_key2","off","_len3","_key3","map","emitter","__WEBPACK_AMD_DEFINE_FACTORY__","__WEBPACK_AMD_DEFINE_RESULT__","_Math$sign","_Object$defineProperties","THREE","REVISION","cancelAnimationFrame","lastTime","vendors","callback","currTime","now","timeToCall","max","clearTimeout","sign","MOUSE","LEFT","MIDDLE","RIGHT","CullFaceNone","CullFaceBack","CullFaceFront","CullFaceFrontBack","FrontFaceDirectionCW","FrontFaceDirectionCCW","BasicShadowMap","PCFShadowMap","PCFSoftShadowMap","FrontSide","BackSide","DoubleSide","FlatShading","SmoothShading","NoColors","FaceColors","VertexColors","NoBlending","NormalBlending","AdditiveBlending","SubtractiveBlending","MultiplyBlending","CustomBlending","AddEquation","SubtractEquation","ReverseSubtractEquation","MinEquation","MaxEquation","ZeroFactor","OneFactor","SrcColorFactor","OneMinusSrcColorFactor","SrcAlphaFactor","OneMinusSrcAlphaFactor","DstAlphaFactor","OneMinusDstAlphaFactor","DstColorFactor","OneMinusDstColorFactor","SrcAlphaSaturateFactor","NeverDepth","AlwaysDepth","LessDepth","LessEqualDepth","EqualDepth","GreaterEqualDepth","GreaterDepth","NotEqualDepth","MultiplyOperation","MixOperation","AddOperation","UVMapping","CubeReflectionMapping","CubeRefractionMapping","EquirectangularReflectionMapping","EquirectangularRefractionMapping","SphericalReflectionMapping","RepeatWrapping","ClampToEdgeWrapping","MirroredRepeatWrapping","NearestFilter","NearestMipMapNearestFilter","NearestMipMapLinearFilter","LinearFilter","LinearMipMapNearestFilter","LinearMipMapLinearFilter","UnsignedByteType","ByteType","ShortType","UnsignedShortType","IntType","UnsignedIntType","FloatType","HalfFloatType","UnsignedShort4444Type","UnsignedShort5551Type","UnsignedShort565Type","AlphaFormat","RGBFormat","RGBAFormat","LuminanceFormat","LuminanceAlphaFormat","RGBEFormat","RGB_S3TC_DXT1_Format","RGBA_S3TC_DXT1_Format","RGBA_S3TC_DXT3_Format","RGBA_S3TC_DXT5_Format","RGB_PVRTC_4BPPV1_Format","RGB_PVRTC_2BPPV1_Format","RGBA_PVRTC_4BPPV1_Format","RGBA_PVRTC_2BPPV1_Format","Projector","projectVector","vector","warn","project","unprojectVector","unproject","pickingRay","CanvasRenderer","Color","setRGB","g","setHex","setStyle","hex","setHSL","hue2rgb","q","t","euclideanModulo","clamp","parseAlpha","strAlpha","components","size","ColorKeywords","clone","copyGammaToLinear","gammaFactor","pow","copyLinearToGamma","safeInverse","convertGammaToLinear","convertLinearToGamma","sqrt","getHex","getHexString","getHSL","optionalTarget","hue","saturation","hsl","lightness","getStyle","offsetHSL","addColors","color1","color2","addScalar","multiply","multiplyScalar","lerp","equals","fromArray","array","offset","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","Quaternion","z","w","_y","_z","_w","onChangeCallback","setFromEuler","euler","Euler","c1","cos","c2","c3","s1","sin","s2","s3","order","setFromAxisAngle","axis","angle","halfAngle","setFromRotationMatrix","te","elements","m11","m12","m13","m21","m22","m23","m31","m32","m33","trace","setFromUnitVectors","v1","EPS","vFrom","vTo","dot","abs","crossVectors","normalize","inverse","conjugate","lengthSq","multiplyQuaternions","qax","qay","qaz","qaw","qbx","qby","qbz","qbw","multiplyVector3","applyQuaternion","slerp","qb","cosHalfTheta","halfTheta","acos","sinHalfTheta","ratioA","ratioB","onChange","qa","qm","Vector2","setX","setY","setComponent","getComponent","addVectors","addScaledVector","subVectors","subScalar","divide","divideScalar","scalar","invScalar","clampScalar","minVal","maxVal","roundToZero","negate","lengthManhattan","distanceTo","distanceToSquared","dx","dy","setLength","oldLength","lerpVectors","v2","fromAttribute","attribute","itemSize","setZ","multiplyVectors","applyEuler","applyAxisAngle","applyMatrix3","applyMatrix4","applyProjection","qx","qy","qz","qw","ix","iy","iz","iw","matrix","Matrix4","multiplyMatrices","projectionMatrix","getInverse","matrixWorld","transformDirection","cross","ax","ay","az","bx","by","bz","projectOnVector","projectOnPlane","planeNormal","reflect","normal","angleTo","theta","dz","setEulerFromRotationMatrix","setEulerFromQuaternion","getPositionFromMatrix","setFromMatrixPosition","getScaleFromMatrix","setFromMatrixScale","getColumnFromMatrix","setFromMatrixColumn","sx","sy","sz","me","Vector4","setW","setAxisAngleFromQuaternion","setAxisAngleFromRotationMatrix","epsilon","epsilon2","xx","yy","zz","xy","xz","yz","_order","DefaultOrder","RotationOrders","asin","atan2","setFromQuaternion","makeRotationFromQuaternion","setFromVector3","reorder","newOrder","toVector3","optionalResult","Line3","end","line","center","distanceSq","distance","at","closestPointToPointParameter","startP","startEnd","clampToLine","startEnd2","startEnd_startP","closestPointToPoint","Box2","Infinity","setFromPoints","points","makeEmpty","il","expandByPoint","setFromCenterAndSize","halfSize","box","empty","expandByVector","expandByScalar","containsPoint","containsBox","getParameter","isIntersectionBox","clampPoint","distanceToPoint","clampedPoint","intersect","union","translate","Box3","setFromObject","scope","updateMatrixWorld","traverse","Geometry","vertices","BufferGeometry","attributes","positions","getBoundingSphere","Sphere","radius","Matrix3","Float32Array","n11","n12","n13","n21","n22","n23","n31","n32","n33","identity","multiplyVector3Array","applyToVector3Array","applyToBuffer","buffer","getX","getY","getZ","setXYZ","determinant","throwOnInvertible","det","msg","transpose","tmp","flattenToArrayOffset","getNormalMatrix","transposeIntoArray","n14","n24","n34","n41","n42","n43","n44","extractPosition","copyPosition","extractBasis","xAxis","yAxis","zAxis","makeBasis","extractRotation","scaleX","scaleY","scaleZ","makeRotationFromEuler","ae","af","be","bf","ce","cf","de","df","ac","ad","bc","bd","setRotationFromQuaternion","x2","y2","z2","wx","wy","wz","eye","up","a11","a12","a13","a14","a21","a22","a23","a24","a31","a32","a33","a34","a41","a42","a43","a44","b11","b12","b13","b14","b21","b22","b23","b24","b31","b32","b33","b34","b41","b42","b43","b44","multiplyToArray","multiplyVector4","rotateAxis","crossVector","getPosition","setPosition","rotateX","rotateY","rotateZ","rotateByAxis","getMaxScaleOnAxis","scaleXSq","scaleYSq","scaleZSq","makeTranslation","makeRotationX","makeRotationY","makeRotationZ","makeRotationAxis","tx","ty","makeScale","compose","decompose","invSX","invSY","invSZ","makeFrustum","right","bottom","near","far","makePerspective","fov","aspect","ymax","degToRad","ymin","xmin","xmax","makeOrthographic","Ray","origin","direction","ray","recast","directionDistance","distanceSqToPoint","distanceSqToSegment","segCenter","segDir","v0","optionalPointOnRay","optionalPointOnSegment","s0","sqrDist","extDet","segExtent","a01","b0","b1","invDet","isIntersectionSphere","sphere","intersectSphere","tca","d2","radius2","thc","t0","t1","isIntersectionPlane","plane","distToPoint","denominator","distanceToPlane","constant","intersectPlane","intersectBox","tmin","tmax","tymin","tymax","tzmin","tzmax","invdirx","invdiry","invdirz","intersectTriangle","edge1","edge2","backfaceCulling","DdN","DdQxE2","DdE1xQ","QdN","matrix4","optionalCenter","maxRadiusSq","intersectsSphere","radiusSum","deltaLengthSq","getBoundingBox","Frustum","p0","p1","p2","p3","p4","p5","planes","Plane","frustum","setFromMatrix","me0","me1","me2","me3","me4","me5","me6","me7","me8","me9","me10","me11","me12","me13","me14","me15","setComponents","intersectsObject","boundingSphere","computeBoundingSphere","negRadius","intersectsBox","d1","setFromNormalAndCoplanarPoint","setFromCoplanarPoints","inverseNormalLength","distanceToSphere","projectPoint","orthoPoint","perpendicularMagnitude","isIntersectionLine","startSign","endSign","intersectLine","coplanarPoint","m1","optionalNormalMatrix","normalMatrix","newNormal","newCoplanarPoint","generateUUID","chars","uuid","rnd","join","clampBottom","mapLinear","a1","a2","b2","smoothstep","smootherstep","random16","randInt","low","high","randFloat","randFloatSpread","range","degreeToRadiansFactor","degrees","radToDeg","radianToDegreesFactor","radians","isPowerOfTwo","nextPowerOfTwo","Spline","interpolate","t2","t3","intPoint","weight","w2","w3","pa","pb","pc","pd","v3","initFromArray","getPoint","k","getControlPointsArray","coords","getLength","nSubDivisions","nSamples","oldIntPoint","oldPosition","tmpVec","chunkLengths","totalLength","chunks","total","reparametrizeByArcLength","samplingCoef","indexCurrent","indexNext","realDistance","sampling","newpoints","sl","Triangle","resultLengthSq","barycoordFromPoint","dot00","dot01","dot02","dot11","dot12","denom","invDenom","u","setFromPointsAndIndices","i0","i1","i2","triangle","area","midpoint","autoStart","startTime","oldTime","elapsedTime","performance","newTime","EventDispatcher","hasEventListener","removeEventListener","dispatchEvent","listener","_listeners","listeners","indexOf","listenerArray","descSort","Raycaster","params","Line","LOD","Points","threshold","Sprite","PointCloud","_intersectObject","raycaster","intersects","recursive","visible","raycast","linePrecision","setFromCamera","OrthographicCamera","intersectObject","sort","intersectObjects","objects","Object3DIdCount","DefaultUp","onRotationChange","onQuaternionChange","modelViewMatrix","rotationAutoUpdate","matrixAutoUpdate","DefaultMatrixAutoUpdate","matrixWorldNeedsUpdate","castShadow","receiveShadow","frustumCulled","renderOrder","userData","applyMatrix","setRotationFromAxisAngle","setRotationFromEuler","setRotationFromMatrix","rotateOnAxis","q1","translateOnAxis","translateX","translateY","translateZ","localToWorld","worldToLocal","remove","getChildByName","getObjectByName","getObjectById","getObjectByProperty","getWorldPosition","getWorldQuaternion","getWorldRotation","getWorldScale","getWorldDirection","traverseVisible","traverseAncestors","updateMatrix","force","toJSON","meta","extractFromCache","cache","metadata","isRootObject","geometries","materials","textures","images","generator","output","eulerOrder","useQuaternion","renderDepth","Face3","materialIndex","vertexNormals","vertexColors","Face4","BufferAttribute","dynamic","updateRange","count","setDynamic","copyAt","index1","index2","copyArray","copyColorsArray","copyIndicesArray","indices","copyVector2sArray","vectors","copyVector3sArray","copyVector4sArray","getW","setXY","setXYZW","needsUpdate","Int8Attribute","Int8Array","Uint8Attribute","Uint8Array","Uint8ClampedAttribute","Uint8ClampedArray","Int16Attribute","Int16Array","Uint16Attribute","Uint16Array","Int32Attribute","Int32Array","Uint32Attribute","Uint32Array","Float32Attribute","Float64Attribute","Float64Array","DynamicBufferAttribute","InstancedBufferAttribute","meshPerAttribute","InterleavedBuffer","stride","InstancedInterleavedBuffer","InterleavedBufferAttribute","interleavedBuffer","GeometryIdCount","faces","faceVertexUvs","morphTargets","morphColors","morphNormals","skinWeights","skinIndices","lineDistances","boundingBox","verticesNeedUpdate","elementsNeedUpdate","uvsNeedUpdate","normalsNeedUpdate","colorsNeedUpdate","lineDistancesNeedUpdate","groupsNeedUpdate","vertex","face","jl","computeBoundingBox","fromBufferGeometry","normals","uvs","uv","uvs2","uv2","tempNormals","tempUVs","tempUVs2","addFace","groups","group","computeFaceNormals","ab","fl","vA","vB","vC","computeVertexNormals","areaWeighted","vl","computeMorphNormals","__originalFaceNormal","__originalVertexNormals","tmpGeo","faceNormals","faceNormal","dstNormalsFace","dstNormalsVertex","computeTangents","computeLineDistances","merge","materialIndexOffset","vertexOffset","vertices1","vertices2","faces1","faces2","uvs1","vertexCopy","faceCopy","faceVertexNormals","faceVertexColors","uvCopy","mergeMesh","mesh","mergeVertices","verticesMap","unique","changes","precisionPoints","precision","faceIndicesToRemove","dupIndex","idx","setBit","getNormalIndex","hash","normalsHash","getColorIndex","colorsHash","getUvIndex","uvsHash","parameters","hasMaterial","hasFaceUv","hasFaceVertexUv","hasFaceNormal","hasFaceVertexNormal","hasFaceColor","hasFaceVertexColor","faceType","uvsCopy","kl","dispose","DirectGeometry","computeGroups","fromGeometry","hasFaceVertexUv2","morphTargetsLength","morphTargetsPosition","morphNormalsLength","morphTargetsNormal","hasSkinIndices","hasSkinWeights","vertexUvs","morphTarget","morphNormal","morphAttributes","drawRange","addIndex","setIndex","getIndex","addAttribute","getAttribute","removeAttribute","addDrawCall","indexOffset","addGroup","clearDrawCalls","clearGroups","setDrawRange","updateFromObject","direct","__directGeometry","lineDistance","fromDirectGeometry","TypeArray","bb","pA","pB","pC","normalizeNormals","computeOffsets","attribute1","attributeArray1","attribute2","attributeArray2","attributeSize","drawcalls","offsets","MaxIndex","InstancedBufferGeometry","maxInstancedCount","instances","Camera","matrixWorldInverse","CubeCamera","cubeResolution","cameraPX","cameraNX","cameraPY","cameraNY","cameraPZ","cameraNZ","renderTarget","WebGLRenderTargetCube","magFilter","minFilter","updateCubeMap","generateMipmaps","activeCubeFace","setRenderTarget","zoom","updateProjectionMatrix","cx","cy","setLens","focalLength","frameHeight","atan","setViewOffset","fullWidth","fullHeight","Light","AmbientLight","DirectionalLight","intensity","onlyShadow","shadowCameraNear","shadowCameraFar","shadowCameraLeft","shadowCameraRight","shadowCameraTop","shadowCameraBottom","shadowCameraVisible","shadowBias","shadowDarkness","shadowMapWidth","shadowMapHeight","shadowMap","shadowMapSize","shadowCamera","shadowMatrix","HemisphereLight","skyColor","groundColor","PointLight","decay","SpotLight","exponent","shadowCameraFov","Cache","files","file","Loader","onLoadStart","onLoadProgress","onLoadComplete","crossOrigin","extractUrlBase","url","parts","pop","initMaterials","texturePath","createMaterial","imageLoader","nearest_pow2","LN2","create_texture","where","sourceFile","repeat","wrap","anisotropy","texture","fullPath","loader","Handlers","Texture","setCrossOrigin","image","canvas","context","getContext","drawImage","wrapS","wrapT","wrapMap","mirror","rgb2hex","rgb","ImageLoader","mtype","mpars","shading","blending","transparent","opacity","depthTest","depthWrite","flipSided","side","doubleSided","wireframe","colorDiffuse","DbgColor","colorEmissive","emissive","colorSpecular","specular","specularCoef","shininess","transparency","mapDiffuse","mapDiffuseRepeat","mapDiffuseOffset","mapDiffuseWrap","mapDiffuseAnisotropy","mapLight","mapLightRepeat","mapLightOffset","mapLightWrap","mapLightAnisotropy","mapAO","mapAORepeat","mapAOOffset","mapAOWrap","mapAOAnisotropy","mapBump","mapBumpRepeat","mapBumpOffset","mapBumpWrap","mapBumpAnisotropy","mapNormal","mapNormalRepeat","mapNormalOffset","mapNormalWrap","mapNormalAnisotropy","mapSpecular","mapSpecularRepeat","mapSpecularOffset","mapSpecularWrap","mapSpecularAnisotropy","mapAlpha","mapAlphaRepeat","mapAlphaOffset","mapAlphaWrap","mapAlphaAnisotropy","mapBumpScale","bumpScale","mapNormalFactor","normalScale","DbgName","handlers","regex","XHRLoader","manager","DefaultLoadingManager","onLoad","onProgress","onError","cached","request","XMLHttpRequest","open","response","itemEnd","itemError","responseType","withCredentials","send","itemStart","setResponseType","setWithCredentials","JSONLoader","text","json","setTexturePath","parseModel","isBitSet","fi","zLength","colorIndex","normalIndex","uvIndex","isQuad","faceA","faceB","uvLayer","nUvLayers","parseSkin","influencesPerVertex","bones","animation","animations","parseMorphing","dstVertices","srcVertices","cl","dstColors","srcColors","statusDomElement","_statusDomElement","LoadingManager","isLoading","itemsLoaded","itemsTotal","onStart","BufferGeometryLoader","typedArray","MaterialLoader","setTextures","getTexture","uniforms","vertexShader","fragmentShader","alphaTest","wireframeLinewidth","sizeAttenuation","alphaMap","bumpMap","normalMap","displacementMap","displacementScale","displacementBias","specularMap","envMap","combine","reflectivity","lightMap","lightMapIntensity","aoMap","aoMapIntensity","ObjectLoader","substring","lastIndexOf","parseGeometries","parseImages","parseTextures","parseMaterials","parseObject","geometryLoader","bufferGeometryLoader","widthSegments","heightSegments","BoxGeometry","depth","depthSegments","CircleBufferGeometry","segments","thetaStart","thetaLength","CircleGeometry","CylinderGeometry","radiusTop","radiusBottom","radialSegments","openEnded","SphereGeometry","phiStart","phiLength","SphereBufferGeometry","DodecahedronGeometry","detail","IcosahedronGeometry","OctahedronGeometry","TetrahedronGeometry","RingGeometry","innerRadius","outerRadius","thetaSegments","phiSegments","TorusGeometry","tube","tubularSegments","arc","TorusKnotGeometry","heightScale","TextGeometry","loadImage","path","parseConstant","getGeometry","getMaterial","mode","Group","levels","level","addLevel","TextureLoader","DataTextureLoader","BinaryTextureLoader","_parser","DataTexture","texData","mipmaps","mipmapCount","CompressedTextureLoader","CompressedTexture","loadTexture","texDatas","isCubemap","Material","MaterialIdCount","blendSrc","blendDst","blendEquation","blendSrcAlpha","blendDstAlpha","blendEquationAlpha","depthFunc","colorWrite","polygonOffset","polygonOffsetFactor","polygonOffsetUnits","overdraw","_needsUpdate","setValues","newValue","currentValue","Number","wrapAround","boolean","wrapRGB","LineBasicMaterial","linewidth","linecap","linejoin","fog","LineDashedMaterial","dashSize","gapSize","MeshBasicMaterial","refractionRatio","wireframeLinecap","wireframeLinejoin","skinning","MeshLambertMaterial","MeshPhongMaterial","metal","emissiveMap","MeshDepthMaterial","MeshNormalMaterial","MultiMaterial","MeshFaceMaterial","PointsMaterial","PointCloudMaterial","ParticleBasicMaterial","ParticleSystemMaterial","ShaderMaterial","defines","lights","derivatives","defaultAttributeValues","index0AttributeName","UniformsUtils","RawShaderMaterial","SpriteMaterial","TextureIdCount","DEFAULT_IMAGE","DEFAULT_MAPPING","premultiplyAlpha","flipY","unpackAlignment","onUpdate","getDataURL","toDataURL","transformUv","CanvasTexture","CubeTexture","VideoTexture","video","readyState","HAVE_ENOUGH_DATA","inverseMatrix","testPoint","rayPointDistanceSq","localThresholdSq","intersectPoint","distanceToRay","localThreshold","ParticleSystem","LineSegments","precisionSq","vStart","vEnd","interSegment","interRay","distSq","faceIndex","nbVertices","LineStrip","LinePieces","updateMorphTargets","morphTargetBase","morphTargetInfluences","morphTargetDictionary","ml","getMorphTargetIndexByName","uvIntersection","uv1","uv3","barycoord","tempA","tempB","tempC","uvA","uvB","uvC","intersectionPoint","intersectionPointWorld","isFaceMaterial","faceMaterial","morphInfluences","tl","influence","targets","Bone","skin","Skeleton","boneInverses","useVertexTexture","identityMatrix","boneTextureWidth","boneTextureHeight","boneMatrices","boneTexture","calculateInverses","bl","pose","bone","offsetMatrix","SkinnedMesh","bindMode","bindMatrix","bindMatrixInverse","gbone","rotq","scl","normalizeSkinWeights","skeleton","sw","MorphAnimMesh","mirroredLoop","lastKeyframe","currentKeyframe","directionBackwards","setFrameRange","startKeyframe","endKeyframe","setDirectionForward","setDirectionBackward","parseAnimations","firstAnimation","pattern","morph","label","setAnimationLabel","playAnimation","fps","updateAnimation","frameTime","keyframe","influences","mix","interpolateTargets","getObjectForDistance","matrixPosition","guessSizeSq","Particle","LensFlare","lensFlares","positionScreen","customUpdateCallback","updateLensFlares","flare","vecX","vecY","wantedRotation","overrideMaterial","autoUpdate","Fog","FogExp2","density","ShaderChunk","merged","uniforms_src","uniforms_dst","parameter_src","UniformsLib","common","diffuse","offsetRepeat","flipEnvMap","aomap","lightmap","emissivemap","bumpmap","normalmap","displacementmap","fogDensity","fogNear","fogFar","fogColor","ambientLightColor","directionalLightDirection","directionalLightColor","hemisphereLightDirection","hemisphereLightSkyColor","hemisphereLightGroundColor","pointLightColor","pointLightPosition","pointLightDistance","pointLightDecay","spotLightColor","spotLightPosition","spotLightDirection","spotLightDistance","spotLightAngleCos","spotLightExponent","spotLightDecay","psColor","shadowmap","ShaderLib","basic","lambert","phong","dashed","totalSize","mNear","mFar","cube","tCube","tFlip","equirect","tEquirect","depthRGBA","glClearColor","_premultipliedAlpha","_gl","clearColor","setDefaultGLState","state","init","viewport","_viewportX","_viewportY","_viewportWidth","_viewportHeight","_clearColor","_clearAlpha","resetGLState","_currentProgram","_currentCamera","_currentGeometryProgram","_currentMaterialId","_lightsNeedUpdate","reset","onContextLost","preventDefault","properties","onTextureDispose","deallocateTexture","_infoMemory","onRenderTargetDispose","deallocateRenderTarget","onMaterialDispose","deallocateMaterial","textureProperties","__image__webglTextureCube","deleteTexture","__webglInit","__webglTexture","renderTargetProperties","deleteFramebuffer","__webglFramebuffer","deleteRenderbuffer","__webglRenderbuffer","releaseMaterialProgramReference","programInfo","program","programCache","releaseProgram","setupVertexAttributes","startIndex","extension","extensions","initAttributes","geometryAttributes","programAttributes","getAttributes","materialDefaultAttributeValues","programAttribute","geometryAttribute","enableAttribute","getAttributeBuffer","bindBuffer","ARRAY_BUFFER","vertexAttribPointer","FLOAT","BYTES_PER_ELEMENT","vertexAttribDivisorANGLE","vertexAttrib2fv","vertexAttrib3fv","vertexAttrib4fv","vertexAttrib1fv","disableUnusedAttributes","numericalSort","painterSortStable","reversePainterSortStable","pushImmediateRenderItem","transparentImmediateObjects","transparentImmediateObjectsLastIndex","opaqueImmediateObjects","opaqueImmediateObjectsLastIndex","pushRenderItem","transparentObjects","transparentObjectsLastIndex","opaqueObjects","opaqueObjectsLastIndex","renderItem","_vector3","projectObject","sprites","ImmediateRenderObject","_frustum","sortObjects","_projScreenMatrix","groupMaterial","renderObjects","renderList","renderBufferDirect","renderObjectsImmediate","setMaterial","setProgram","renderBufferImmediate","initMaterial","materialProperties","getParameters","code","getProgramCode","programChange","shaderID","shader","__webglShader","acquireProgram","numSupportedMorphTargets","maxMorphTargets","numSupportedMorphNormals","maxMorphNormals","uniformsList","uniformLocations","getUniforms","location","setMaterialFaces","setBlending","setDepthFunc","setDepthTest","setDepthWrite","setColorWrite","setPolygonOffset","CULL_FACE","setFlipSided","_usedTextureUnits","refreshProgram","refreshMaterial","refreshLights","p_uniforms","m_uniforms","useProgram","uniformMatrix4fv","capabilities","logarithmicDepthBuffer","uniform1f","logDepthBufFC","cameraPosition","uniform3f","viewMatrix","floatVertexTextures","textureUnit","getTextureUnit","uniform1i","setTexture","boneGlobalMatrices","refreshUniformsFog","setupLights","refreshUniformsLights","_lights","markUniformsLightsNeedsUpdate","refreshUniformsCommon","refreshUniformsLine","refreshUniformsDash","refreshUniformsParticle","refreshUniformsPhong","_shadowPass","refreshUniformsShadow","loadUniformsGeneric","loadUniformsMatrices","modelMatrix","uvScaleMap","_canvas","ambient","directional","distances","decays","spot","directions","anglesCos","exponents","hemi","skyColors","groundColors","light","uniformMatrix3fv","maxTextures","uniform","uniform2f","uniform4f","uniform1iv","uniform3iv","uniform1fv","uniform2fv","uniform3fv","uniform4fv","_array","i3","i4","setCubeTexture","setCubeTextureDynamic","setColorLinear","ll","zlights","dirColors","dirPositions","pointColors","pointPositions","pointDistances","pointDecays","spotColors","spotPositions","spotDistances","spotDirections","spotAnglesCos","spotExponents","spotDecays","hemiSkyColors","hemiGroundColors","hemiPositions","dirLength","pointLength","spotLength","hemiLength","dirCount","pointCount","spotCount","hemiCount","dirOffset","pointOffset","spotOffset","hemiOffset","_direction","setTextureParameters","textureType","isImagePowerOfTwo","texParameteri","TEXTURE_WRAP_S","paramThreeToGL","TEXTURE_WRAP_T","TEXTURE_MAG_FILTER","TEXTURE_MIN_FILTER","CLAMP_TO_EDGE","filterFallback","__currentAnisotropy","texParameterf","TEXTURE_MAX_ANISOTROPY_EXT","getMaxAnisotropy","uploadTexture","slot","createTexture","activeTexture","TEXTURE0","bindTexture","TEXTURE_2D","pixelStorei","UNPACK_FLIP_Y_WEBGL","UNPACK_PREMULTIPLY_ALPHA_WEBGL","UNPACK_ALIGNMENT","clampToMaxSize","maxTextureSize","glFormat","glType","mipmap","texImage2D","getCompressedTextureFormats","compressedTexImage2D","generateMipmap","__version","maxSize","TEXTURE_CUBE_MAP","isCompressed","isDataTexture","cubeImage","autoScaleCubemaps","maxCubemapSize","TEXTURE_CUBE_MAP_POSITIVE_X","setupFrameBuffer","framebuffer","textureTarget","bindFramebuffer","FRAMEBUFFER","framebufferTexture2D","COLOR_ATTACHMENT0","setupRenderBuffer","renderbuffer","bindRenderbuffer","RENDERBUFFER","depthBuffer","stencilBuffer","renderbufferStorage","DEPTH_COMPONENT16","framebufferRenderbuffer","DEPTH_ATTACHMENT","DEPTH_STENCIL","DEPTH_STENCIL_ATTACHMENT","RGBA4","updateRenderTargetMipmap","NEAREST","LINEAR","REPEAT","MIRRORED_REPEAT","NEAREST_MIPMAP_NEAREST","NEAREST_MIPMAP_LINEAR","LINEAR_MIPMAP_NEAREST","LINEAR_MIPMAP_LINEAR","UNSIGNED_BYTE","UNSIGNED_SHORT_4_4_4_4","UNSIGNED_SHORT_5_5_5_1","UNSIGNED_SHORT_5_6_5","BYTE","SHORT","UNSIGNED_SHORT","INT","UNSIGNED_INT","HALF_FLOAT_OES","ALPHA","RGB","RGBA","LUMINANCE","LUMINANCE_ALPHA","FUNC_ADD","FUNC_SUBTRACT","FUNC_REVERSE_SUBTRACT","ZERO","ONE","SRC_COLOR","ONE_MINUS_SRC_COLOR","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","DST_ALPHA","ONE_MINUS_DST_ALPHA","DST_COLOR","ONE_MINUS_DST_COLOR","SRC_ALPHA_SATURATE","COMPRESSED_RGB_S3TC_DXT1_EXT","COMPRESSED_RGBA_S3TC_DXT1_EXT","COMPRESSED_RGBA_S3TC_DXT3_EXT","COMPRESSED_RGBA_S3TC_DXT5_EXT","COMPRESSED_RGB_PVRTC_4BPPV1_IMG","COMPRESSED_RGB_PVRTC_2BPPV1_IMG","COMPRESSED_RGBA_PVRTC_4BPPV1_IMG","COMPRESSED_RGBA_PVRTC_2BPPV1_IMG","MIN_EXT","MAX_EXT","_context","_width","_height","pixelRatio","_alpha","_depth","_stencil","stencil","_antialias","premultipliedAlpha","_preserveDrawingBuffer","preserveDrawingBuffer","autoClear","autoClearColor","autoClearDepth","autoClearStencil","gammaInput","gammaOutput","_currentFramebuffer","_currentWidth","_currentHeight","_infoRender","calls","info","memory","programs","WebGLExtensions","WebGLCapabilities","WebGLState","WebGLProperties","WebGLObjects","WebGLPrograms","bufferRenderer","WebGLBufferRenderer","indexedBufferRenderer","WebGLIndexedBufferRenderer","WebGLShadowMap","spritePlugin","SpritePlugin","lensFlarePlugin","LensFlarePlugin","getContextAttributes","forceContextLoss","loseContext","MAX_TEXTURE_MAX_ANISOTROPY_EXT","getPrecision","getPixelRatio","setPixelRatio","getSize","updateStyle","setViewport","setScissor","scissor","enableScissorTest","setScissorTest","getClearColor","getClearAlpha","setClearAlpha","bits","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT","clearDepth","clearStencil","clearTarget","buffers","hasPositions","createBuffer","hasNormals","hasUvs","hasColors","bufferData","positionArray","DYNAMIC_DRAW","normalArray","nx","ny","nz","uvArray","colorArray","drawArrays","TRIANGLES","updateBuffers","geometryProgram","activeInfluences","getWireframeAttribute","ELEMENT_ARRAY_BUFFER","setLineWidth","setMode","LINES","renderInstances","lineWidth","LINE_STRIP","POINTS","forceClear","setFaceCulling","cullFace","frontFaceDirection","frontFace","CW","CCW","BACK","FRONT","FRONT_AND_BACK","complete","isCube","isTargetPowerOfTwo","createFramebuffer","createRenderbuffer","shareDepthFrom","vx","vy","readRenderTargetPixels","WebGLRenderTarget","restore","checkFramebufferStatus","FRAMEBUFFER_COMPLETE","readPixels","supportsFloatTextures","supportsHalfFloatTextures","supportsStandardDerivatives","supportsCompressedTextureS3TC","supportsCompressedTexturePVRTC","supportsBlendMinMax","supportsVertexTextures","vertexTextures","supportsInstancedArrays","addPrePlugin","addPostPlugin","updateShadowMap","shadowMapEnabled","shadowMapType","shadowMapCullFace","shadowMapDebug","drawArraysInstancedANGLE","drawElements","drawElementsInstancedANGLE","gl","getExtension","getMaxPrecision","getShaderPrecisionFormat","VERTEX_SHADER","HIGH_FLOAT","FRAGMENT_SHADER","MEDIUM_FLOAT","MAX_TEXTURE_IMAGE_UNITS","maxVertexTextures","MAX_VERTEX_TEXTURE_IMAGE_UNITS","MAX_TEXTURE_SIZE","MAX_CUBE_MAP_TEXTURE_SIZE","maxAttributes","MAX_VERTEX_ATTRIBS","maxVertexUniforms","MAX_VERTEX_UNIFORM_VECTORS","maxVaryings","MAX_VARYING_VECTORS","maxFragmentUniforms","MAX_FRAGMENT_UNIFORM_VECTORS","floatFragmentTextures","_maxPrecision","WebGLGeometries","onGeometryDispose","buffergeometry","_bufferGeometry","deleteAttributes","deleteAttribute","__webglBuffer","deleteBuffer","removeAttributeBuffer","updateAttribute","bufferType","attributeProperties","updateBuffer","usage","STATIC_DRAW","bufferSubData","subarray","edges","checkEdge","list","WebGLProgram","generateDefines","fetchUniformLocations","identifiers","getProgramParameter","ACTIVE_UNIFORMS","getActiveUniform","getUniformLocation","suffixPos","fetchAttributeLocations","ACTIVE_ATTRIBUTES","getActiveAttrib","getAttribLocation","filterEmptyLine","string","programIdCount","shadowMapTypeDefine","envMapTypeDefine","envMapModeDefine","envMapBlendingDefine","prefixVertex","prefixFragment","gammaFactorDefine","customDefines","createProgram","maxDirLights","maxPointLights","maxSpotLights","maxHemiLights","maxShadows","maxBones","flatShading","filter","useFog","fogExp","vertexGlsl","fragmentGlsl","glVertexShader","WebGLShader","glFragmentShader","attachShader","bindAttribLocation","linkProgram","programLog","getProgramInfoLog","vertexLog","getShaderInfoLog","fragmentLog","runnable","haveDiagnostics","LINK_STATUS","getError","VALIDATE_STATUS","diagnostics","prefix","deleteShader","cachedUniforms","cachedAttributes","destroy","deleteProgram","usedTimes","allocateBones","nVertexUniforms","nVertexMatrices","allocateLights","dirLights","pointLights","spotLights","hemiLights","allocateShadows","shaderIDs","parameterNames","maxLightCount","envMapMode","parameterName","pl","addLineNumbers","lines","createShader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","_renderer","_objects","getDepthMaterial","depthMaterial","useMorphing","useSkinning","customDepthMaterial","_depthMaterialMorphSkin","_depthMaterialSkin","_depthMaterialMorph","_depthMaterial","_renderList","_state","_matrixPosition","depthShader","depthUniforms","BLEND","shadowFilter","pars","cameraHelper","CameraHelper","clearAlpha","newAttributes","enabledAttributes","compressedTextureFormats","currentBlending","currentBlendEquation","currentBlendSrc","currentBlendDst","currentBlendEquationAlpha","currentBlendSrcAlpha","currentBlendDstAlpha","currentDepthFunc","currentDepthWrite","currentColorWrite","currentFlipSided","currentLineWidth","currentPolygonOffsetFactor","currentPolygonOffsetUnits","currentTextureSlot","currentBoundTextures","DEPTH_TEST","LEQUAL","blendFunc","enableVertexAttribArray","disableVertexAttribArray","formats","COMPRESSED_TEXTURE_FORMATS","blendEquationSeparate","blendFuncSeparate","NEVER","ALWAYS","LESS","EQUAL","GEQUAL","GREATER","NOTEQUAL","depthMask","colorMask","factor","units","POLYGON_OFFSET_FILL","scissorTest","SCISSOR_TEST","webglSlot","webglType","webglTexture","boundTexture","flares","vertexBuffer","elementBuffer","hasVertexTexture","tempTexture","occlusionTexture","renderType","occlusionMap","screenPosition","viewportWidth","viewportHeight","tempPosition","invAspect","halfViewportWidth","halfViewportHeight","screenPositionPixels","TEXTURE1","copyTexImage2D","sprite","spritePosition","spriteRotation","spriteScale","uvOffset","uvScale","fogType","fillStyle","fillRect","oldFogType","sceneFogType","GeometryUtils","geometry1","geometry2","ImageUtils","loadTextureCube","loadCompressedTexture","loadCompressedTextureCube","getNormalMap","subtract","getImageData","imageData","createImageData","ly","uy","lx","ux","num_points","putImageData","generateDataTexture","SceneUtils","createMultiMaterialObject","detach","attach","FontUtils","divisions","getFace","loadFace","family","familyName","ThreeFont","cssFontWeight","cssFontStyle","drawText","resolution","fontPaths","Path","extractGlyphPoints","paths","outline","action","cpx","cpy","cpx0","cpy0","cpx1","cpy1","cpx2","cpy2","laste","pts","glyph","glyphs","o","_cachedOutline","moveTo","lineTo","quadraticCurveTo","Shape","Utils","bezierCurveTo","b3","ha","generateShapes","curveSegments","font","shapes","toShapes","EPSILON","contour","verts","vertIndices","nv","snip","py","aX","aY","bX","bY","cX","cY","apx","apy","bpx","bpy","cCROSSap","bCROSScp","aCROSSbp","Triangulate","typeface_js","_typeface_js","Audio","createBufferSource","onended","onEnded","gain","createGain","connect","destination","panner","createPanner","autoplay","playbackRate","isPlaying","decodeAudioData","loop","currentTime","disconnect","setFilter","getFilter","setPlaybackRate","getPlaybackRate","setLoop","getLoop","setRefDistance","refDistance","getRefDistance","setRolloffFactor","rolloffFactor","getRolloffFactor","setVolume","getVolume","AudioListener","AudioContext","webkitAudioContext","orientation","setOrientation","Curve","getPointAt","getUtoTmapping","getPoints","getSpacedPoints","lengths","getLengths","__arcLengthDivisions","cacheArcLengths","current","sum","updateArcLengths","targetArcLength","arcLengths","comparison","lengthBefore","lengthAfter","segmentLength","segmentFraction","getTangent","pt1","pt2","vec","getTangentAt","tangentQuadraticBezier","tangentCubicBezier","tangentSpline","h00","h10","h01","h11","getPointFunc","CurvePath","curves","bends","autoClose","curve","checkConnection","closePath","startPoint","endPoint","LineCurve","curveLengths","getCurveLengths","lens","cacheLengths","sums","maxX","maxY","maxZ","minX","minY","minZ","NEGATIVE_INFINITY","POSITIVE_INFINITY","createPointsGeometry","createGeometry","createSpacedPointsGeometry","addWrapPath","bendpath","getTransformedPoints","oldPts","getWrapPoints","getTransformedSpacedPoints","oldX","oldY","xNorm","bounds","pathPt","actions","fromPoints","PathActions","MOVE_TO","LINE_TO","QUADRATIC_CURVE_TO","BEZIER_CURVE_TO","CSPLINE_THRU","ARC","ELLIPSE","vlen","lastargs","x0","y0","aCPx","aCPy","QuadraticBezierCurve","aCP1x","aCP1y","aCP2x","aCP2y","CubicBezierCurve","splineThru","npts","SplineCurve","aRadius","aStartAngle","aEndAngle","aClockwise","absarc","absellipse","ellipse","xRadius","yRadius","aRotation","EllipseCurve","lastPoint","closedPath","useSpacedPoints","item","spts","spline","deltaAngle","tdivisions","isCCW","noHoles","extractSubpaths","inActions","subPaths","lastPath","toShapesNoHoles","inSubpaths","tmpPath","tmpShape","isPointInsidePolygon","inPt","inPolygon","polyLen","inside","edgeLowPt","edgeHighPt","edgeDx","edgeDy","perpEdge","solid","holesFirst","isClockWise","tmpPoints","betterShapeHoles","newShapes","newShapeHoles","mainIdx","ambiguous","toChange","sIdx","sLen","sho","hIdx","ho","hole_unassigned","s2Idx","froms","tos","hole","tmpHoles","holes","extrude","extruded","ExtrudeGeometry","makeGeometry","ShapeGeometry","getPointsHoles","holesPts","getSpacedPointsHoles","extractAllPoints","shape","extractPoints","extractAllSpacedPoints","triangulateShape","point_in_segment_2D_colin","inSegPt1","inSegPt2","inOtherPt","intersect_segments_2D","inSeg1Pt1","inSeg1Pt2","inSeg2Pt1","inSeg2Pt2","inExcludeAdjacentSegs","seg1dx","seg1dy","seg2dx","seg2dy","seg1seg2dx","seg1seg2dy","limit","perpSeg1","perpSeg2","factorSeg1","seg1Pt","seg2Pt","seg1min","seg1max","seg1minVal","seg1maxVal","seg2min","seg2max","seg2minVal","seg2maxVal","isPointInsideAngle","inVertex","inLegFromPt","inLegToPt","legFromPtX","legFromPtY","legToPtX","legToPtY","otherPtX","otherPtY","from2toAngle","from2otherAngle","other2toAngle","removeHoles","isCutLineInsideAngles","inShapeIdx","inHoleIdx","lastShapeIdx","prevShapeIdx","nextShapeIdx","insideAngle","lastHoleIdx","prevHoleIdx","nextHoleIdx","intersectsShapeEdge","inShapePt","inHolePt","nextIdx","intersection","intersectsHoleEdge","ihIdx","chkHole","indepHoles","holeIndex","shapeIndex","shapePt","holePt","holeIdx","cutKey","tmpShape1","tmpShape2","tmpHole1","tmpHole2","failedCuts","hl","minShapeIndex","h2","allPointsMap","allpoints","shapeWithoutHoles","triangles","b2p0","b2p1","b2p2","b3p0","b3p1","b3p2","b3p3","tangent","point0","point1","point2","point3","ArcCurve","LineCurve3","QuadraticBezierCurve3","CubicBezierCurve3","SplineCurve3","CatmullRomCurve3","CubicPoly","pz","x1","c0","initNonuniformCatmullRom","x3","dt0","dt1","dt2","initCatmullRom","tension","calc","ClosedSplineCurve3","AnimationHandler","CATMULLROM","CATMULLROM_FORWARD","initialized","hierarchy","rot","quat","usedMorphTargets","morphTargetName","morphTargetsInfluences","root","parseRecurseHierarchy","deltaTimeMS","resetBlendWeights","Animation","timeScale","interpolationType","keyTypes","animationCache","positionWeight","quaternionWeight","scaleWeight","prevKey","nextKey","originalMatrix","getNextKeyWith","newVector","newQuat","interpolateCatmullRom","prevXYZ","nextXYZ","proportionalWeight","getPrevKeyWith","currentPoint","forwardPoint","KeyFrameAnimation","isPaused","sids","sid","endTime","original","hasTarget","MorphAnimation","frames","lastFrame","currentFrame","frame","buildPlane","udir","vdir","gridX","gridY","width_half","height_half","gridX1","gridY1","segment_width","segment_height","uva","uvb","uvc","uvd","depth_half","CubeGeometry","centerUV","segment","ii","heightHalf","verticesRow","uvsRow","na","nb","tanTheta","v4","n1","n2","n3","n4","uv4","EdgesGeometry","thresholdAngle","thresholdDot","edge","sortFunction","vert1","vert2","face1","face2","addShapeList","addShape","scalePt2","pt","getBevelVec","inPrev","inNext","v_trans_x","v_trans_y","shrink_by","v_prev_x","v_prev_y","v_next_x","v_next_y","v_prev_lensq","collinear0","v_prev_len","v_next_len","ptPrevShift_x","ptPrevShift_y","ptNextShift_x","ptNextShift_y","sf","v_trans_lensq","direction_eq","buildLidFaces","bevelEnabled","layer","flen","f3","steps","bevelSegments","buildSideFaces","layeroffset","sidewalls","ahole","slen1","slen2","f4","shapesOffset","uvgen","generateTopUV","wallContour","stepIndex","stepsLength","contourIndex1","contourIndex2","generateSideWallUV","extrudePts","splineTube","binormal","position2","amount","bevelThickness","bevelSize","extrudePath","extrudeByPath","UVGenerator","WorldUVGenerator","TubeGeometry","FrenetFrames","shapePoints","reverse","bs","vert","contourMovements","oneHoleMovements","holesMovements","verticesMovements","binormals","indexA","indexB","indexC","indexD","LatheGeometry","inversePointLength","inverseSegments","phi","np","base","u0","u1","PlaneGeometry","PlaneBufferGeometry","offset2","radiusStep","thetaSegment","thetaEnd","vertexCount","textShapes","getPos","in_q","in_p","cu","su","quOverP","cs","tz","grid","tang","bitan","ip","jp","closed","taper","NoTaper","numpoints","pos2","tangents","SinusoidalTaper","initialNormal3","smallest","MAX_VALUE","mat","PolyhedronGeometry","prepare","azimuth","inclination","centroid","azi","correctUV","subdivide","cols","aj","bj","rows","ParametricGeometry","func","slices","stacks","sliceCount","WireframeGeometry","numEdges","ol","drawcall","numTris","AxisHelper","ArrowHelper","lineGeometry","coneGeometry","dir","headLength","headWidth","cone","setDirection","setColor","BoxHelper","BoundingBoxHelper","addLine","addPoint","pointMap","hexFrustum","hexCone","hexUp","hexTarget","hexCross","setPoint","DirectionalLightHelper","lightPlane","targetLine","EdgesHelper","FaceNormalsHelper","nNormals","objGeometry","GridHelper","setColors","colorCenterLine","colorGrid","HemisphereLightHelper","sphereSize","lightSphere","PointLightHelper","SkeletonHelper","getBoneList","boneList","matrixWorldInv","boneMatrix","SpotLightHelper","vector2","coneLength","coneWidth","VertexNormalsHelper","objPos","objNorm","WireframeHelper","renderCallback","MorphBlendMesh","animationsMap","animationsList","numFrames","startFrame","endFrame","createAnimation","setAnimationWeight","active","autoCreateAnimations","frameRanges","setAnimationDirectionForward","setAnimationDirectionBackward","setAnimationFPS","setAnimationDuration","setAnimationTime","getAnimationTime","getAnimationDuration","stopAnimation","resize","parentNode","Resize","helper","fov_helper","_bind","_steering","_steering2","Agent","dt","_position","_glMatrixVec3","_glMatrixVec32","Steering","track","speed","fromValues","glMatrix","vec3","ARRAY_TYPE","mul","div","scaleAndAdd","dist","squaredDistance","squaredLength","sqrLen","hermite","factorTimes2","factor1","factor2","factor3","factor4","bezier","inverseFactor","inverseFactorTimesTwo","RANDOM","zScale","transformMat4","transformMat3","transformQuat","arg","cosine","ENABLE_SIMD","SIMD_AVAILABLE","USE_SIMD","setMatrixArrayType","degree","toRadian","_steeringBehavioursWander","_steeringBehavioursWander2","_steeringBehavioursPursue","_steeringBehavioursPursue2","_steeringBehavioursEvade","_steeringBehavioursEvade2","agents","predator","wander","prey","pursue","evade","_behaviour","_behaviour2","Wander","_Behaviour","_ref","_ref$radius","_ref$distance","_ref$volatility","volatility","displacement","addForce","Behaviour","_seek","Pursue","seek","Seek","_flee","flee","Flee","_steeringBehavioursAlign","_steeringBehavioursAlign2","_steeringBehavioursCohere","_steeringBehavioursCohere2","_steeringBehavioursSeparate","_steeringBehavioursSeparate2","steerings","align","cohere","separate","Align","neighborhoodDistance","reduce","average","Cohere"],"mappings":"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","file":"app.bundle.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"/\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _interopRequireDefault = __webpack_require__(1)['default'];\n\t\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\tvar _hedraBootstrap = __webpack_require__(2);\n\t\n\tvar _hedraBootstrap2 = _interopRequireDefault(_hedraBootstrap);\n\t\n\tvar _app = __webpack_require__(6);\n\t\n\tvar _app2 = _interopRequireDefault(_app);\n\t\n\texports['default'] = (0, _hedraBootstrap2['default'])(_app2['default']);\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 1 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\texports[\"default\"] = function (obj) {\n\t  return obj && obj.__esModule ? obj : {\n\t    \"default\": obj\n\t  };\n\t};\n\t\n\texports.__esModule = true;\n\n/***/ },\n/* 2 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _interopRequireDefault = __webpack_require__(1)['default'];\n\t\n\tObject.defineProperty(exports, '__esModule', {\n\t\tvalue: true\n\t});\n\t\n\tvar _debug = __webpack_require__(3);\n\t\n\tvar _debug2 = _interopRequireDefault(_debug);\n\t\n\twindow.debug = _debug2['default'];\n\t\n\texports['default'] = function (App) {\n\t\twindow.onload = function () {\n\t\t\tApp.load().then(function () {\n\t\t\t\twindow.app = new App({ parent: document.body });\n\t\t\t});\n\t\t};\n\t};\n\t\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 3 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\n\t/**\n\t * This is the web browser implementation of `debug()`.\n\t *\n\t * Expose `debug()` as the module.\n\t */\n\t\n\texports = module.exports = __webpack_require__(4);\n\texports.log = log;\n\texports.formatArgs = formatArgs;\n\texports.save = save;\n\texports.load = load;\n\texports.useColors = useColors;\n\texports.storage = 'undefined' != typeof chrome\n\t               && 'undefined' != typeof chrome.storage\n\t                  ? chrome.storage.local\n\t                  : localstorage();\n\t\n\t/**\n\t * Colors.\n\t */\n\t\n\texports.colors = [\n\t  'lightseagreen',\n\t  'forestgreen',\n\t  'goldenrod',\n\t  'dodgerblue',\n\t  'darkorchid',\n\t  'crimson'\n\t];\n\t\n\t/**\n\t * Currently only WebKit-based Web Inspectors, Firefox >= v31,\n\t * and the Firebug extension (any Firefox version) are known\n\t * to support \"%c\" CSS customizations.\n\t *\n\t * TODO: add a `localStorage` variable to explicitly enable/disable colors\n\t */\n\t\n\tfunction useColors() {\n\t  // is webkit? http://stackoverflow.com/a/16459606/376773\n\t  return ('WebkitAppearance' in document.documentElement.style) ||\n\t    // is firebug? http://stackoverflow.com/a/398120/376773\n\t    (window.console && (console.firebug || (console.exception && console.table))) ||\n\t    // is firefox >= v31?\n\t    // https://developer.mozilla.org/en-US/docs/Tools/Web_Console#Styling_messages\n\t    (navigator.userAgent.toLowerCase().match(/firefox\\/(\\d+)/) && parseInt(RegExp.$1, 10) >= 31);\n\t}\n\t\n\t/**\n\t * Map %j to `JSON.stringify()`, since no Web Inspectors do that by default.\n\t */\n\t\n\texports.formatters.j = function(v) {\n\t  return JSON.stringify(v);\n\t};\n\t\n\t\n\t/**\n\t * Colorize log arguments if enabled.\n\t *\n\t * @api public\n\t */\n\t\n\tfunction formatArgs() {\n\t  var args = arguments;\n\t  var useColors = this.useColors;\n\t\n\t  args[0] = (useColors ? '%c' : '')\n\t    + this.namespace\n\t    + (useColors ? ' %c' : ' ')\n\t    + args[0]\n\t    + (useColors ? '%c ' : ' ')\n\t    + '+' + exports.humanize(this.diff);\n\t\n\t  if (!useColors) return args;\n\t\n\t  var c = 'color: ' + this.color;\n\t  args = [args[0], c, 'color: inherit'].concat(Array.prototype.slice.call(args, 1));\n\t\n\t  // the final \"%c\" is somewhat tricky, because there could be other\n\t  // arguments passed either before or after the %c, so we need to\n\t  // figure out the correct index to insert the CSS into\n\t  var index = 0;\n\t  var lastC = 0;\n\t  args[0].replace(/%[a-z%]/g, function(match) {\n\t    if ('%%' === match) return;\n\t    index++;\n\t    if ('%c' === match) {\n\t      // we only are interested in the *last* %c\n\t      // (the user may have provided their own)\n\t      lastC = index;\n\t    }\n\t  });\n\t\n\t  args.splice(lastC, 0, c);\n\t  return args;\n\t}\n\t\n\t/**\n\t * Invokes `console.log()` when available.\n\t * No-op when `console.log` is not a \"function\".\n\t *\n\t * @api public\n\t */\n\t\n\tfunction log() {\n\t  // this hackery is required for IE8/9, where\n\t  // the `console.log` function doesn't have 'apply'\n\t  return 'object' === typeof console\n\t    && console.log\n\t    && Function.prototype.apply.call(console.log, console, arguments);\n\t}\n\t\n\t/**\n\t * Save `namespaces`.\n\t *\n\t * @param {String} namespaces\n\t * @api private\n\t */\n\t\n\tfunction save(namespaces) {\n\t  try {\n\t    if (null == namespaces) {\n\t      exports.storage.removeItem('debug');\n\t    } else {\n\t      exports.storage.debug = namespaces;\n\t    }\n\t  } catch(e) {}\n\t}\n\t\n\t/**\n\t * Load `namespaces`.\n\t *\n\t * @return {String} returns the previously persisted debug modes\n\t * @api private\n\t */\n\t\n\tfunction load() {\n\t  var r;\n\t  try {\n\t    r = exports.storage.debug;\n\t  } catch(e) {}\n\t  return r;\n\t}\n\t\n\t/**\n\t * Enable namespaces listed in `localStorage.debug` initially.\n\t */\n\t\n\texports.enable(load());\n\t\n\t/**\n\t * Localstorage attempts to return the localstorage.\n\t *\n\t * This is necessary because safari throws\n\t * when a user disables cookies/localstorage\n\t * and you attempt to access it.\n\t *\n\t * @return {LocalStorage}\n\t * @api private\n\t */\n\t\n\tfunction localstorage(){\n\t  try {\n\t    return window.localStorage;\n\t  } catch (e) {}\n\t}\n\n\n/***/ },\n/* 4 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\n\t/**\n\t * This is the common logic for both the Node.js and web browser\n\t * implementations of `debug()`.\n\t *\n\t * Expose `debug()` as the module.\n\t */\n\t\n\texports = module.exports = debug;\n\texports.coerce = coerce;\n\texports.disable = disable;\n\texports.enable = enable;\n\texports.enabled = enabled;\n\texports.humanize = __webpack_require__(5);\n\t\n\t/**\n\t * The currently active debug mode names, and names to skip.\n\t */\n\t\n\texports.names = [];\n\texports.skips = [];\n\t\n\t/**\n\t * Map of special \"%n\" handling functions, for the debug \"format\" argument.\n\t *\n\t * Valid key names are a single, lowercased letter, i.e. \"n\".\n\t */\n\t\n\texports.formatters = {};\n\t\n\t/**\n\t * Previously assigned color.\n\t */\n\t\n\tvar prevColor = 0;\n\t\n\t/**\n\t * Previous log timestamp.\n\t */\n\t\n\tvar prevTime;\n\t\n\t/**\n\t * Select a color.\n\t *\n\t * @return {Number}\n\t * @api private\n\t */\n\t\n\tfunction selectColor() {\n\t  return exports.colors[prevColor++ % exports.colors.length];\n\t}\n\t\n\t/**\n\t * Create a debugger with the given `namespace`.\n\t *\n\t * @param {String} namespace\n\t * @return {Function}\n\t * @api public\n\t */\n\t\n\tfunction debug(namespace) {\n\t\n\t  // define the `disabled` version\n\t  function disabled() {\n\t  }\n\t  disabled.enabled = false;\n\t\n\t  // define the `enabled` version\n\t  function enabled() {\n\t\n\t    var self = enabled;\n\t\n\t    // set `diff` timestamp\n\t    var curr = +new Date();\n\t    var ms = curr - (prevTime || curr);\n\t    self.diff = ms;\n\t    self.prev = prevTime;\n\t    self.curr = curr;\n\t    prevTime = curr;\n\t\n\t    // add the `color` if not set\n\t    if (null == self.useColors) self.useColors = exports.useColors();\n\t    if (null == self.color && self.useColors) self.color = selectColor();\n\t\n\t    var args = Array.prototype.slice.call(arguments);\n\t\n\t    args[0] = exports.coerce(args[0]);\n\t\n\t    if ('string' !== typeof args[0]) {\n\t      // anything else let's inspect with %o\n\t      args = ['%o'].concat(args);\n\t    }\n\t\n\t    // apply any `formatters` transformations\n\t    var index = 0;\n\t    args[0] = args[0].replace(/%([a-z%])/g, function(match, format) {\n\t      // if we encounter an escaped % then don't increase the array index\n\t      if (match === '%%') return match;\n\t      index++;\n\t      var formatter = exports.formatters[format];\n\t      if ('function' === typeof formatter) {\n\t        var val = args[index];\n\t        match = formatter.call(self, val);\n\t\n\t        // now we need to remove `args[index]` since it's inlined in the `format`\n\t        args.splice(index, 1);\n\t        index--;\n\t      }\n\t      return match;\n\t    });\n\t\n\t    if ('function' === typeof exports.formatArgs) {\n\t      args = exports.formatArgs.apply(self, args);\n\t    }\n\t    var logFn = enabled.log || exports.log || console.log.bind(console);\n\t    logFn.apply(self, args);\n\t  }\n\t  enabled.enabled = true;\n\t\n\t  var fn = exports.enabled(namespace) ? enabled : disabled;\n\t\n\t  fn.namespace = namespace;\n\t\n\t  return fn;\n\t}\n\t\n\t/**\n\t * Enables a debug mode by namespaces. This can include modes\n\t * separated by a colon and wildcards.\n\t *\n\t * @param {String} namespaces\n\t * @api public\n\t */\n\t\n\tfunction enable(namespaces) {\n\t  exports.save(namespaces);\n\t\n\t  var split = (namespaces || '').split(/[\\s,]+/);\n\t  var len = split.length;\n\t\n\t  for (var i = 0; i < len; i++) {\n\t    if (!split[i]) continue; // ignore empty strings\n\t    namespaces = split[i].replace(/\\*/g, '.*?');\n\t    if (namespaces[0] === '-') {\n\t      exports.skips.push(new RegExp('^' + namespaces.substr(1) + '$'));\n\t    } else {\n\t      exports.names.push(new RegExp('^' + namespaces + '$'));\n\t    }\n\t  }\n\t}\n\t\n\t/**\n\t * Disable debug output.\n\t *\n\t * @api public\n\t */\n\t\n\tfunction disable() {\n\t  exports.enable('');\n\t}\n\t\n\t/**\n\t * Returns true if the given mode name is enabled, false otherwise.\n\t *\n\t * @param {String} name\n\t * @return {Boolean}\n\t * @api public\n\t */\n\t\n\tfunction enabled(name) {\n\t  var i, len;\n\t  for (i = 0, len = exports.skips.length; i < len; i++) {\n\t    if (exports.skips[i].test(name)) {\n\t      return false;\n\t    }\n\t  }\n\t  for (i = 0, len = exports.names.length; i < len; i++) {\n\t    if (exports.names[i].test(name)) {\n\t      return true;\n\t    }\n\t  }\n\t  return false;\n\t}\n\t\n\t/**\n\t * Coerce `val`.\n\t *\n\t * @param {Mixed} val\n\t * @return {Mixed}\n\t * @api private\n\t */\n\t\n\tfunction coerce(val) {\n\t  if (val instanceof Error) return val.stack || val.message;\n\t  return val;\n\t}\n\n\n/***/ },\n/* 5 */\n/***/ function(module, exports) {\n\n\t/**\n\t * Helpers.\n\t */\n\t\n\tvar s = 1000;\n\tvar m = s * 60;\n\tvar h = m * 60;\n\tvar d = h * 24;\n\tvar y = d * 365.25;\n\t\n\t/**\n\t * Parse or format the given `val`.\n\t *\n\t * Options:\n\t *\n\t *  - `long` verbose formatting [false]\n\t *\n\t * @param {String|Number} val\n\t * @param {Object} options\n\t * @return {String|Number}\n\t * @api public\n\t */\n\t\n\tmodule.exports = function(val, options){\n\t  options = options || {};\n\t  if ('string' == typeof val) return parse(val);\n\t  return options.long\n\t    ? long(val)\n\t    : short(val);\n\t};\n\t\n\t/**\n\t * Parse the given `str` and return milliseconds.\n\t *\n\t * @param {String} str\n\t * @return {Number}\n\t * @api private\n\t */\n\t\n\tfunction parse(str) {\n\t  str = '' + str;\n\t  if (str.length > 10000) return;\n\t  var match = /^((?:\\d+)?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(str);\n\t  if (!match) return;\n\t  var n = parseFloat(match[1]);\n\t  var type = (match[2] || 'ms').toLowerCase();\n\t  switch (type) {\n\t    case 'years':\n\t    case 'year':\n\t    case 'yrs':\n\t    case 'yr':\n\t    case 'y':\n\t      return n * y;\n\t    case 'days':\n\t    case 'day':\n\t    case 'd':\n\t      return n * d;\n\t    case 'hours':\n\t    case 'hour':\n\t    case 'hrs':\n\t    case 'hr':\n\t    case 'h':\n\t      return n * h;\n\t    case 'minutes':\n\t    case 'minute':\n\t    case 'mins':\n\t    case 'min':\n\t    case 'm':\n\t      return n * m;\n\t    case 'seconds':\n\t    case 'second':\n\t    case 'secs':\n\t    case 'sec':\n\t    case 's':\n\t      return n * s;\n\t    case 'milliseconds':\n\t    case 'millisecond':\n\t    case 'msecs':\n\t    case 'msec':\n\t    case 'ms':\n\t      return n;\n\t  }\n\t}\n\t\n\t/**\n\t * Short format for `ms`.\n\t *\n\t * @param {Number} ms\n\t * @return {String}\n\t * @api private\n\t */\n\t\n\tfunction short(ms) {\n\t  if (ms >= d) return Math.round(ms / d) + 'd';\n\t  if (ms >= h) return Math.round(ms / h) + 'h';\n\t  if (ms >= m) return Math.round(ms / m) + 'm';\n\t  if (ms >= s) return Math.round(ms / s) + 's';\n\t  return ms + 'ms';\n\t}\n\t\n\t/**\n\t * Long format for `ms`.\n\t *\n\t * @param {Number} ms\n\t * @return {String}\n\t * @api private\n\t */\n\t\n\tfunction long(ms) {\n\t  return plural(ms, d, 'day')\n\t    || plural(ms, h, 'hour')\n\t    || plural(ms, m, 'minute')\n\t    || plural(ms, s, 'second')\n\t    || ms + ' ms';\n\t}\n\t\n\t/**\n\t * Pluralization helper.\n\t */\n\t\n\tfunction plural(ms, n, name) {\n\t  if (ms < n) return;\n\t  if (ms < n * 1.5) return Math.floor(ms / n) + ' ' + name;\n\t  return Math.ceil(ms / n) + ' ' + name + 's';\n\t}\n\n\n/***/ },\n/* 6 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _get = __webpack_require__(7)['default'];\n\t\n\tvar _inherits = __webpack_require__(21)['default'];\n\t\n\tvar _createClass = __webpack_require__(32)['default'];\n\t\n\tvar _classCallCheck = __webpack_require__(35)['default'];\n\t\n\tvar _toConsumableArray = __webpack_require__(36)['default'];\n\t\n\tvar _Promise = __webpack_require__(63)['default'];\n\t\n\tvar _getIterator = __webpack_require__(81)['default'];\n\t\n\tvar _interopRequireDefault = __webpack_require__(1)['default'];\n\t\n\tObject.defineProperty(exports, '__esModule', {\n\t\tvalue: true\n\t});\n\t\n\tvar _debug = __webpack_require__(3);\n\t\n\tvar _debug2 = _interopRequireDefault(_debug);\n\t\n\tvar _hedraApp = __webpack_require__(84);\n\t\n\tvar _hedraApp2 = _interopRequireDefault(_hedraApp);\n\t\n\tvar _hedraPluginsResize = __webpack_require__(94);\n\t\n\tvar _hedraPluginsResize2 = _interopRequireDefault(_hedraPluginsResize);\n\t\n\tvar _libRandom = __webpack_require__(95);\n\t\n\tvar _agent = __webpack_require__(96);\n\t\n\tvar _agent2 = _interopRequireDefault(_agent);\n\t\n\tvar _hunt = __webpack_require__(101);\n\t\n\tvar _hunt2 = _interopRequireDefault(_hunt);\n\t\n\tvar _swarm = __webpack_require__(108);\n\t\n\tvar _swarm2 = _interopRequireDefault(_swarm);\n\t\n\tvar debug = (0, _debug2['default'])('app');\n\t\n\tvar App = (function (_BaseApp) {\n\t\t_inherits(App, _BaseApp);\n\t\n\t\t_createClass(App, null, [{\n\t\t\tkey: 'load',\n\t\t\tvalue: function load() {\n\t\t\t\treturn _Promise.all([_agent2['default'].load()]);\n\t\t\t}\n\t\t}]);\n\t\n\t\tfunction App(config) {\n\t\t\tvar _this = this;\n\t\n\t\t\t_classCallCheck(this, App);\n\t\n\t\t\tdebug('construct');\n\t\n\t\t\t_get(Object.getPrototypeOf(App.prototype), 'constructor', this).call(this, config);\n\t\n\t\t\t(0, _hedraPluginsResize2['default'])(this, { ratio: 16 / 9 });\n\t\n\t\t\tthis.camera.position.set(0, 0, 150);\n\t\t\tthis.camera.lookAt(this.scene.position);\n\t\n\t\t\tvar width = undefined;\n\t\t\tvar height = undefined;\n\t\n\t\t\tthis.on('resize-post').then(function (event) {\n\t\t\t\twidth = 150 * Math.tan(event.fovx / 2 * Math.PI / 180) * 2;\n\t\t\t\theight = 150 * Math.tan(event.fovy / 2 * Math.PI / 180) * 2;\n\t\t\t});\n\t\n\t\t\tvar _iteratorNormalCompletion = true;\n\t\t\tvar _didIteratorError = false;\n\t\t\tvar _iteratorError = undefined;\n\t\n\t\t\ttry {\n\t\t\t\tvar _loop = function () {\n\t\t\t\t\tvar agent = _step.value;\n\t\n\t\t\t\t\t_this.add(agent);\n\t\n\t\t\t\t\tagent.steering.position = [].concat(_toConsumableArray((0, _libRandom.fromDisc)(50)), [0]);\n\t\t\t\t\tagent.steering.velocity = [].concat(_toConsumableArray((0, _libRandom.fromCircle)(1)), [0]);\n\t\n\t\t\t\t\tagent.on('update').then(function () {\n\t\t\t\t\t\twhile (agent.position.x > width / 2) {\n\t\t\t\t\t\t\tagent.position.x -= width;\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\twhile (agent.position.x < -width / 2) {\n\t\t\t\t\t\t\tagent.position.x += width;\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\twhile (agent.position.y > height / 2) {\n\t\t\t\t\t\t\tagent.position.y -= height;\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\twhile (agent.position.y < -height / 2) {\n\t\t\t\t\t\t\tagent.position.y += height;\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\tagent.steering.position = agent.position.toArray();\n\t\t\t\t\t});\n\t\t\t\t};\n\t\n\t\t\t\tfor (var _iterator = _getIterator((0, _swarm2['default'])()), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t\t\t\t\t_loop();\n\t\t\t\t}\n\t\t\t} catch (err) {\n\t\t\t\t_didIteratorError = true;\n\t\t\t\t_iteratorError = err;\n\t\t\t} finally {\n\t\t\t\ttry {\n\t\t\t\t\tif (!_iteratorNormalCompletion && _iterator['return']) {\n\t\t\t\t\t\t_iterator['return']();\n\t\t\t\t\t}\n\t\t\t\t} finally {\n\t\t\t\t\tif (_didIteratorError) {\n\t\t\t\t\t\tthrow _iteratorError;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\n\t\treturn App;\n\t})(_hedraApp2['default']);\n\t\n\texports['default'] = App;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 7 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar _Object$getOwnPropertyDescriptor = __webpack_require__(8)[\"default\"];\n\t\n\texports[\"default\"] = function get(_x, _x2, _x3) {\n\t  var _again = true;\n\t\n\t  _function: while (_again) {\n\t    var object = _x,\n\t        property = _x2,\n\t        receiver = _x3;\n\t    desc = parent = getter = undefined;\n\t    _again = false;\n\t    if (object === null) object = Function.prototype;\n\t\n\t    var desc = _Object$getOwnPropertyDescriptor(object, property);\n\t\n\t    if (desc === undefined) {\n\t      var parent = Object.getPrototypeOf(object);\n\t\n\t      if (parent === null) {\n\t        return undefined;\n\t      } else {\n\t        _x = parent;\n\t        _x2 = property;\n\t        _x3 = receiver;\n\t        _again = true;\n\t        continue _function;\n\t      }\n\t    } else if (\"value\" in desc) {\n\t      return desc.value;\n\t    } else {\n\t      var getter = desc.get;\n\t\n\t      if (getter === undefined) {\n\t        return undefined;\n\t      }\n\t\n\t      return getter.call(receiver);\n\t    }\n\t  }\n\t};\n\t\n\texports.__esModule = true;\n\n/***/ },\n/* 8 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = { \"default\": __webpack_require__(9), __esModule: true };\n\n/***/ },\n/* 9 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar $ = __webpack_require__(10);\n\t__webpack_require__(11);\n\tmodule.exports = function getOwnPropertyDescriptor(it, key){\n\t  return $.getDesc(it, key);\n\t};\n\n/***/ },\n/* 10 */\n/***/ function(module, exports) {\n\n\tvar $Object = Object;\n\tmodule.exports = {\n\t  create:     $Object.create,\n\t  getProto:   $Object.getPrototypeOf,\n\t  isEnum:     {}.propertyIsEnumerable,\n\t  getDesc:    $Object.getOwnPropertyDescriptor,\n\t  setDesc:    $Object.defineProperty,\n\t  setDescs:   $Object.defineProperties,\n\t  getKeys:    $Object.keys,\n\t  getNames:   $Object.getOwnPropertyNames,\n\t  getSymbols: $Object.getOwnPropertySymbols,\n\t  each:       [].forEach\n\t};\n\n/***/ },\n/* 11 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t// 19.1.2.6 Object.getOwnPropertyDescriptor(O, P)\n\tvar toIObject = __webpack_require__(12);\n\t\n\t__webpack_require__(16)('getOwnPropertyDescriptor', function($getOwnPropertyDescriptor){\n\t  return function getOwnPropertyDescriptor(it, key){\n\t    return $getOwnPropertyDescriptor(toIObject(it), key);\n\t  };\n\t});\n\n/***/ },\n/* 12 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t// to indexed object, toObject with fallback for non-array-like ES3 strings\r\n\tvar IObject = __webpack_require__(13)\r\n\t  , defined = __webpack_require__(15);\r\n\tmodule.exports = function(it){\r\n\t  return IObject(defined(it));\r\n\t};\n\n/***/ },\n/* 13 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t// indexed object, fallback for non-array-like ES3 strings\n\tvar cof = __webpack_require__(14);\n\tmodule.exports = 0 in Object('z') ? Object : function(it){\n\t  return cof(it) == 'String' ? it.split('') : Object(it);\n\t};\n\n/***/ },\n/* 14 */\n/***/ function(module, exports) {\n\n\tvar toString = {}.toString;\n\t\n\tmodule.exports = function(it){\n\t  return toString.call(it).slice(8, -1);\n\t};\n\n/***/ },\n/* 15 */\n/***/ function(module, exports) {\n\n\t// 7.2.1 RequireObjectCoercible(argument)\n\tmodule.exports = function(it){\n\t  if(it == undefined)throw TypeError(\"Can't call method on  \" + it);\n\t  return it;\n\t};\n\n/***/ },\n/* 16 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t// most Object methods by ES6 should accept primitives\n\tmodule.exports = function(KEY, exec){\n\t  var $def = __webpack_require__(17)\n\t    , fn   = (__webpack_require__(19).Object || {})[KEY] || Object[KEY]\n\t    , exp  = {};\n\t  exp[KEY] = exec(fn);\n\t  $def($def.S + $def.F * __webpack_require__(20)(function(){ fn(1); }), 'Object', exp);\n\t};\n\n/***/ },\n/* 17 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar global    = __webpack_require__(18)\n\t  , core      = __webpack_require__(19)\n\t  , PROTOTYPE = 'prototype';\n\tvar ctx = function(fn, that){\n\t  return function(){\n\t    return fn.apply(that, arguments);\n\t  };\n\t};\n\tvar $def = function(type, name, source){\n\t  var key, own, out, exp\n\t    , isGlobal = type & $def.G\n\t    , isProto  = type & $def.P\n\t    , target   = isGlobal ? global : type & $def.S\n\t        ? global[name] : (global[name] || {})[PROTOTYPE]\n\t    , exports  = isGlobal ? core : core[name] || (core[name] = {});\n\t  if(isGlobal)source = name;\n\t  for(key in source){\n\t    // contains in native\n\t    own = !(type & $def.F) && target && key in target;\n\t    if(own && key in exports)continue;\n\t    // export native or passed\n\t    out = own ? target[key] : source[key];\n\t    // prevent global pollution for namespaces\n\t    if(isGlobal && typeof target[key] != 'function')exp = source[key];\n\t    // bind timers to global for call from export context\n\t    else if(type & $def.B && own)exp = ctx(out, global);\n\t    // wrap global constructors for prevent change them in library\n\t    else if(type & $def.W && target[key] == out)!function(C){\n\t      exp = function(param){\n\t        return this instanceof C ? new C(param) : C(param);\n\t      };\n\t      exp[PROTOTYPE] = C[PROTOTYPE];\n\t    }(out);\n\t    else exp = isProto && typeof out == 'function' ? ctx(Function.call, out) : out;\n\t    // export\n\t    exports[key] = exp;\n\t    if(isProto)(exports[PROTOTYPE] || (exports[PROTOTYPE] = {}))[key] = out;\n\t  }\n\t};\n\t// type bitmap\n\t$def.F = 1;  // forced\n\t$def.G = 2;  // global\n\t$def.S = 4;  // static\n\t$def.P = 8;  // proto\n\t$def.B = 16; // bind\n\t$def.W = 32; // wrap\n\tmodule.exports = $def;\n\n/***/ },\n/* 18 */\n/***/ function(module, exports) {\n\n\t// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\n\tvar UNDEFINED = 'undefined';\n\tvar global = module.exports = typeof window != UNDEFINED && window.Math == Math\n\t  ? window : typeof self != UNDEFINED && self.Math == Math ? self : Function('return this')();\n\tif(typeof __g == 'number')__g = global; // eslint-disable-line no-undef\n\n/***/ },\n/* 19 */\n/***/ function(module, exports) {\n\n\tvar core = module.exports = {version: '1.2.1'};\n\tif(typeof __e == 'number')__e = core; // eslint-disable-line no-undef\n\n/***/ },\n/* 20 */\n/***/ function(module, exports) {\n\n\tmodule.exports = function(exec){\n\t  try {\n\t    return !!exec();\n\t  } catch(e){\n\t    return true;\n\t  }\n\t};\n\n/***/ },\n/* 21 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar _Object$create = __webpack_require__(22)[\"default\"];\n\t\n\tvar _Object$setPrototypeOf = __webpack_require__(24)[\"default\"];\n\t\n\texports[\"default\"] = function (subClass, superClass) {\n\t  if (typeof superClass !== \"function\" && superClass !== null) {\n\t    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n\t  }\n\t\n\t  subClass.prototype = _Object$create(superClass && superClass.prototype, {\n\t    constructor: {\n\t      value: subClass,\n\t      enumerable: false,\n\t      writable: true,\n\t      configurable: true\n\t    }\n\t  });\n\t  if (superClass) _Object$setPrototypeOf ? _Object$setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n\t};\n\t\n\texports.__esModule = true;\n\n/***/ },\n/* 22 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = { \"default\": __webpack_require__(23), __esModule: true };\n\n/***/ },\n/* 23 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar $ = __webpack_require__(10);\n\tmodule.exports = function create(P, D){\n\t  return $.create(P, D);\n\t};\n\n/***/ },\n/* 24 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = { \"default\": __webpack_require__(25), __esModule: true };\n\n/***/ },\n/* 25 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t__webpack_require__(26);\n\tmodule.exports = __webpack_require__(19).Object.setPrototypeOf;\n\n/***/ },\n/* 26 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t// 19.1.3.19 Object.setPrototypeOf(O, proto)\n\tvar $def = __webpack_require__(17);\n\t$def($def.S, 'Object', {setPrototypeOf: __webpack_require__(27).set});\n\n/***/ },\n/* 27 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t// Works with __proto__ only. Old v8 can't work with null proto objects.\n\t/* eslint-disable no-proto */\n\tvar getDesc  = __webpack_require__(10).getDesc\n\t  , isObject = __webpack_require__(28)\n\t  , anObject = __webpack_require__(29);\n\tvar check = function(O, proto){\n\t  anObject(O);\n\t  if(!isObject(proto) && proto !== null)throw TypeError(proto + \": can't set as prototype!\");\n\t};\n\tmodule.exports = {\n\t  set: Object.setPrototypeOf || ('__proto__' in {} ? // eslint-disable-line no-proto\n\t    function(test, buggy, set){\n\t      try {\n\t        set = __webpack_require__(30)(Function.call, getDesc(Object.prototype, '__proto__').set, 2);\n\t        set(test, []);\n\t        buggy = !(test instanceof Array);\n\t      } catch(e){ buggy = true; }\n\t      return function setPrototypeOf(O, proto){\n\t        check(O, proto);\n\t        if(buggy)O.__proto__ = proto;\n\t        else set(O, proto);\n\t        return O;\n\t      };\n\t    }({}, false) : undefined),\n\t  check: check\n\t};\n\n/***/ },\n/* 28 */\n/***/ function(module, exports) {\n\n\tmodule.exports = function(it){\n\t  return typeof it === 'object' ? it !== null : typeof it === 'function';\n\t};\n\n/***/ },\n/* 29 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar isObject = __webpack_require__(28);\n\tmodule.exports = function(it){\n\t  if(!isObject(it))throw TypeError(it + ' is not an object!');\n\t  return it;\n\t};\n\n/***/ },\n/* 30 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t// optional / simple context binding\n\tvar aFunction = __webpack_require__(31);\n\tmodule.exports = function(fn, that, length){\n\t  aFunction(fn);\n\t  if(that === undefined)return fn;\n\t  switch(length){\n\t    case 1: return function(a){\n\t      return fn.call(that, a);\n\t    };\n\t    case 2: return function(a, b){\n\t      return fn.call(that, a, b);\n\t    };\n\t    case 3: return function(a, b, c){\n\t      return fn.call(that, a, b, c);\n\t    };\n\t  }\n\t  return function(/* ...args */){\n\t    return fn.apply(that, arguments);\n\t  };\n\t};\n\n/***/ },\n/* 31 */\n/***/ function(module, exports) {\n\n\tmodule.exports = function(it){\n\t  if(typeof it != 'function')throw TypeError(it + ' is not a function!');\n\t  return it;\n\t};\n\n/***/ },\n/* 32 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar _Object$defineProperty = __webpack_require__(33)[\"default\"];\n\t\n\texports[\"default\"] = (function () {\n\t  function defineProperties(target, props) {\n\t    for (var i = 0; i < props.length; i++) {\n\t      var descriptor = props[i];\n\t      descriptor.enumerable = descriptor.enumerable || false;\n\t      descriptor.configurable = true;\n\t      if (\"value\" in descriptor) descriptor.writable = true;\n\t\n\t      _Object$defineProperty(target, descriptor.key, descriptor);\n\t    }\n\t  }\n\t\n\t  return function (Constructor, protoProps, staticProps) {\n\t    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n\t    if (staticProps) defineProperties(Constructor, staticProps);\n\t    return Constructor;\n\t  };\n\t})();\n\t\n\texports.__esModule = true;\n\n/***/ },\n/* 33 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = { \"default\": __webpack_require__(34), __esModule: true };\n\n/***/ },\n/* 34 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar $ = __webpack_require__(10);\n\tmodule.exports = function defineProperty(it, key, desc){\n\t  return $.setDesc(it, key, desc);\n\t};\n\n/***/ },\n/* 35 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\texports[\"default\"] = function (instance, Constructor) {\n\t  if (!(instance instanceof Constructor)) {\n\t    throw new TypeError(\"Cannot call a class as a function\");\n\t  }\n\t};\n\t\n\texports.__esModule = true;\n\n/***/ },\n/* 36 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar _Array$from = __webpack_require__(37)[\"default\"];\n\t\n\texports[\"default\"] = function (arr) {\n\t  if (Array.isArray(arr)) {\n\t    for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) arr2[i] = arr[i];\n\t\n\t    return arr2;\n\t  } else {\n\t    return _Array$from(arr);\n\t  }\n\t};\n\t\n\texports.__esModule = true;\n\n/***/ },\n/* 37 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = { \"default\": __webpack_require__(38), __esModule: true };\n\n/***/ },\n/* 38 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t__webpack_require__(39);\n\t__webpack_require__(55);\n\tmodule.exports = __webpack_require__(19).Array.from;\n\n/***/ },\n/* 39 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\tvar $at  = __webpack_require__(40)(true);\n\t\n\t// 21.1.3.27 String.prototype[@@iterator]()\n\t__webpack_require__(42)(String, 'String', function(iterated){\n\t  this._t = String(iterated); // target\n\t  this._i = 0;                // next index\n\t// 21.1.5.2.1 %StringIteratorPrototype%.next()\n\t}, function(){\n\t  var O     = this._t\n\t    , index = this._i\n\t    , point;\n\t  if(index >= O.length)return {value: undefined, done: true};\n\t  point = $at(O, index);\n\t  this._i += point.length;\n\t  return {value: point, done: false};\n\t});\n\n/***/ },\n/* 40 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t// true  -> String#at\n\t// false -> String#codePointAt\n\tvar toInteger = __webpack_require__(41)\n\t  , defined   = __webpack_require__(15);\n\tmodule.exports = function(TO_STRING){\n\t  return function(that, pos){\n\t    var s = String(defined(that))\n\t      , i = toInteger(pos)\n\t      , l = s.length\n\t      , a, b;\n\t    if(i < 0 || i >= l)return TO_STRING ? '' : undefined;\n\t    a = s.charCodeAt(i);\n\t    return a < 0xd800 || a > 0xdbff || i + 1 === l\n\t      || (b = s.charCodeAt(i + 1)) < 0xdc00 || b > 0xdfff\n\t        ? TO_STRING ? s.charAt(i) : a\n\t        : TO_STRING ? s.slice(i, i + 2) : (a - 0xd800 << 10) + (b - 0xdc00) + 0x10000;\n\t  };\n\t};\n\n/***/ },\n/* 41 */\n/***/ function(module, exports) {\n\n\t// 7.1.4 ToInteger\n\tvar ceil  = Math.ceil\n\t  , floor = Math.floor;\n\tmodule.exports = function(it){\n\t  return isNaN(it = +it) ? 0 : (it > 0 ? floor : ceil)(it);\n\t};\n\n/***/ },\n/* 42 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\tvar LIBRARY         = __webpack_require__(43)\n\t  , $def            = __webpack_require__(17)\n\t  , $redef          = __webpack_require__(44)\n\t  , hide            = __webpack_require__(45)\n\t  , has             = __webpack_require__(48)\n\t  , SYMBOL_ITERATOR = __webpack_require__(49)('iterator')\n\t  , Iterators       = __webpack_require__(52)\n\t  , BUGGY           = !([].keys && 'next' in [].keys()) // Safari has buggy iterators w/o `next`\n\t  , FF_ITERATOR     = '@@iterator'\n\t  , KEYS            = 'keys'\n\t  , VALUES          = 'values';\n\tvar returnThis = function(){ return this; };\n\tmodule.exports = function(Base, NAME, Constructor, next, DEFAULT, IS_SET, FORCE){\n\t  __webpack_require__(53)(Constructor, NAME, next);\n\t  var createMethod = function(kind){\n\t    switch(kind){\n\t      case KEYS: return function keys(){ return new Constructor(this, kind); };\n\t      case VALUES: return function values(){ return new Constructor(this, kind); };\n\t    } return function entries(){ return new Constructor(this, kind); };\n\t  };\n\t  var TAG      = NAME + ' Iterator'\n\t    , proto    = Base.prototype\n\t    , _native  = proto[SYMBOL_ITERATOR] || proto[FF_ITERATOR] || DEFAULT && proto[DEFAULT]\n\t    , _default = _native || createMethod(DEFAULT)\n\t    , methods, key;\n\t  // Fix native\n\t  if(_native){\n\t    var IteratorPrototype = __webpack_require__(10).getProto(_default.call(new Base));\n\t    // Set @@toStringTag to native iterators\n\t    __webpack_require__(54)(IteratorPrototype, TAG, true);\n\t    // FF fix\n\t    if(!LIBRARY && has(proto, FF_ITERATOR))hide(IteratorPrototype, SYMBOL_ITERATOR, returnThis);\n\t  }\n\t  // Define iterator\n\t  if(!LIBRARY || FORCE)hide(proto, SYMBOL_ITERATOR, _default);\n\t  // Plug for library\n\t  Iterators[NAME] = _default;\n\t  Iterators[TAG]  = returnThis;\n\t  if(DEFAULT){\n\t    methods = {\n\t      keys:    IS_SET            ? _default : createMethod(KEYS),\n\t      values:  DEFAULT == VALUES ? _default : createMethod(VALUES),\n\t      entries: DEFAULT != VALUES ? _default : createMethod('entries')\n\t    };\n\t    if(FORCE)for(key in methods){\n\t      if(!(key in proto))$redef(proto, key, methods[key]);\n\t    } else $def($def.P + $def.F * BUGGY, NAME, methods);\n\t  }\n\t};\n\n/***/ },\n/* 43 */\n/***/ function(module, exports) {\n\n\tmodule.exports = true;\n\n/***/ },\n/* 44 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__(45);\n\n/***/ },\n/* 45 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar $          = __webpack_require__(10)\n\t  , createDesc = __webpack_require__(46);\n\tmodule.exports = __webpack_require__(47) ? function(object, key, value){\n\t  return $.setDesc(object, key, createDesc(1, value));\n\t} : function(object, key, value){\n\t  object[key] = value;\n\t  return object;\n\t};\n\n/***/ },\n/* 46 */\n/***/ function(module, exports) {\n\n\tmodule.exports = function(bitmap, value){\n\t  return {\n\t    enumerable  : !(bitmap & 1),\n\t    configurable: !(bitmap & 2),\n\t    writable    : !(bitmap & 4),\n\t    value       : value\n\t  };\n\t};\n\n/***/ },\n/* 47 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t// Thank's IE8 for his funny defineProperty\n\tmodule.exports = !__webpack_require__(20)(function(){\n\t  return Object.defineProperty({}, 'a', {get: function(){ return 7; }}).a != 7;\n\t});\n\n/***/ },\n/* 48 */\n/***/ function(module, exports) {\n\n\tvar hasOwnProperty = {}.hasOwnProperty;\n\tmodule.exports = function(it, key){\n\t  return hasOwnProperty.call(it, key);\n\t};\n\n/***/ },\n/* 49 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar store  = __webpack_require__(50)('wks')\n\t  , Symbol = __webpack_require__(18).Symbol;\n\tmodule.exports = function(name){\n\t  return store[name] || (store[name] =\n\t    Symbol && Symbol[name] || (Symbol || __webpack_require__(51))('Symbol.' + name));\n\t};\n\n/***/ },\n/* 50 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar global = __webpack_require__(18)\n\t  , SHARED = '__core-js_shared__'\n\t  , store  = global[SHARED] || (global[SHARED] = {});\n\tmodule.exports = function(key){\n\t  return store[key] || (store[key] = {});\n\t};\n\n/***/ },\n/* 51 */\n/***/ function(module, exports) {\n\n\tvar id = 0\n\t  , px = Math.random();\n\tmodule.exports = function(key){\n\t  return 'Symbol('.concat(key === undefined ? '' : key, ')_', (++id + px).toString(36));\n\t};\n\n/***/ },\n/* 52 */\n/***/ function(module, exports) {\n\n\tmodule.exports = {};\n\n/***/ },\n/* 53 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\tvar $ = __webpack_require__(10)\n\t  , IteratorPrototype = {};\n\t\n\t// 25.1.2.1.1 %IteratorPrototype%[@@iterator]()\n\t__webpack_require__(45)(IteratorPrototype, __webpack_require__(49)('iterator'), function(){ return this; });\n\t\n\tmodule.exports = function(Constructor, NAME, next){\n\t  Constructor.prototype = $.create(IteratorPrototype, {next: __webpack_require__(46)(1,next)});\n\t  __webpack_require__(54)(Constructor, NAME + ' Iterator');\n\t};\n\n/***/ },\n/* 54 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar has  = __webpack_require__(48)\n\t  , hide = __webpack_require__(45)\n\t  , TAG  = __webpack_require__(49)('toStringTag');\n\t\n\tmodule.exports = function(it, tag, stat){\n\t  if(it && !has(it = stat ? it : it.prototype, TAG))hide(it, TAG, tag);\n\t};\n\n/***/ },\n/* 55 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\tvar ctx         = __webpack_require__(30)\n\t  , $def        = __webpack_require__(17)\n\t  , toObject    = __webpack_require__(56)\n\t  , call        = __webpack_require__(57)\n\t  , isArrayIter = __webpack_require__(58)\n\t  , toLength    = __webpack_require__(59)\n\t  , getIterFn   = __webpack_require__(60);\n\t$def($def.S + $def.F * !__webpack_require__(62)(function(iter){ Array.from(iter); }), 'Array', {\n\t  // 22.1.2.1 Array.from(arrayLike, mapfn = undefined, thisArg = undefined)\n\t  from: function from(arrayLike/*, mapfn = undefined, thisArg = undefined*/){\n\t    var O       = toObject(arrayLike)\n\t      , C       = typeof this == 'function' ? this : Array\n\t      , mapfn   = arguments[1]\n\t      , mapping = mapfn !== undefined\n\t      , index   = 0\n\t      , iterFn  = getIterFn(O)\n\t      , length, result, step, iterator;\n\t    if(mapping)mapfn = ctx(mapfn, arguments[2], 2);\n\t    // if object isn't iterable or it's array with default iterator - use simple case\n\t    if(iterFn != undefined && !(C == Array && isArrayIter(iterFn))){\n\t      for(iterator = iterFn.call(O), result = new C; !(step = iterator.next()).done; index++){\n\t        result[index] = mapping ? call(iterator, mapfn, [step.value, index], true) : step.value;\n\t      }\n\t    } else {\n\t      length = toLength(O.length);\n\t      for(result = new C(length); length > index; index++){\n\t        result[index] = mapping ? mapfn(O[index], index) : O[index];\n\t      }\n\t    }\n\t    result.length = index;\n\t    return result;\n\t  }\n\t});\n\n\n/***/ },\n/* 56 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t// 7.1.13 ToObject(argument)\n\tvar defined = __webpack_require__(15);\n\tmodule.exports = function(it){\n\t  return Object(defined(it));\n\t};\n\n/***/ },\n/* 57 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t// call something on iterator step with safe closing on error\n\tvar anObject = __webpack_require__(29);\n\tmodule.exports = function(iterator, fn, value, entries){\n\t  try {\n\t    return entries ? fn(anObject(value)[0], value[1]) : fn(value);\n\t  // 7.4.6 IteratorClose(iterator, completion)\n\t  } catch(e){\n\t    var ret = iterator['return'];\n\t    if(ret !== undefined)anObject(ret.call(iterator));\n\t    throw e;\n\t  }\n\t};\n\n/***/ },\n/* 58 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t// check on default Array iterator\n\tvar Iterators = __webpack_require__(52)\n\t  , ITERATOR  = __webpack_require__(49)('iterator');\n\tmodule.exports = function(it){\n\t  return (Iterators.Array || Array.prototype[ITERATOR]) === it;\n\t};\n\n/***/ },\n/* 59 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t// 7.1.15 ToLength\n\tvar toInteger = __webpack_require__(41)\n\t  , min       = Math.min;\n\tmodule.exports = function(it){\n\t  return it > 0 ? min(toInteger(it), 0x1fffffffffffff) : 0; // pow(2, 53) - 1 == 9007199254740991\n\t};\n\n/***/ },\n/* 60 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar classof   = __webpack_require__(61)\n\t  , ITERATOR  = __webpack_require__(49)('iterator')\n\t  , Iterators = __webpack_require__(52);\n\tmodule.exports = __webpack_require__(19).getIteratorMethod = function(it){\n\t  if(it != undefined)return it[ITERATOR] || it['@@iterator'] || Iterators[classof(it)];\n\t};\n\n/***/ },\n/* 61 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t// getting tag from 19.1.3.6 Object.prototype.toString()\n\tvar cof = __webpack_require__(14)\n\t  , TAG = __webpack_require__(49)('toStringTag')\n\t  // ES3 wrong here\n\t  , ARG = cof(function(){ return arguments; }()) == 'Arguments';\n\t\n\tmodule.exports = function(it){\n\t  var O, T, B;\n\t  return it === undefined ? 'Undefined' : it === null ? 'Null'\n\t    // @@toStringTag case\n\t    : typeof (T = (O = Object(it))[TAG]) == 'string' ? T\n\t    // builtinTag case\n\t    : ARG ? cof(O)\n\t    // ES3 arguments fallback\n\t    : (B = cof(O)) == 'Object' && typeof O.callee == 'function' ? 'Arguments' : B;\n\t};\n\n/***/ },\n/* 62 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar SYMBOL_ITERATOR = __webpack_require__(49)('iterator')\n\t  , SAFE_CLOSING    = false;\n\ttry {\n\t  var riter = [7][SYMBOL_ITERATOR]();\n\t  riter['return'] = function(){ SAFE_CLOSING = true; };\n\t  Array.from(riter, function(){ throw 2; });\n\t} catch(e){ /* empty */ }\n\tmodule.exports = function(exec){\n\t  if(!SAFE_CLOSING)return false;\n\t  var safe = false;\n\t  try {\n\t    var arr  = [7]\n\t      , iter = arr[SYMBOL_ITERATOR]();\n\t    iter.next = function(){ safe = true; };\n\t    arr[SYMBOL_ITERATOR] = function(){ return iter; };\n\t    exec(arr);\n\t  } catch(e){ /* empty */ }\n\t  return safe;\n\t};\n\n/***/ },\n/* 63 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = { \"default\": __webpack_require__(64), __esModule: true };\n\n/***/ },\n/* 64 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t__webpack_require__(65);\n\t__webpack_require__(39);\n\t__webpack_require__(66);\n\t__webpack_require__(70);\n\tmodule.exports = __webpack_require__(19).Promise;\n\n/***/ },\n/* 65 */\n/***/ function(module, exports) {\n\n\n\n/***/ },\n/* 66 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t__webpack_require__(67);\n\tvar Iterators = __webpack_require__(52);\n\tIterators.NodeList = Iterators.HTMLCollection = Iterators.Array;\n\n/***/ },\n/* 67 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\tvar setUnscope = __webpack_require__(68)\n\t  , step       = __webpack_require__(69)\n\t  , Iterators  = __webpack_require__(52)\n\t  , toIObject  = __webpack_require__(12);\n\t\n\t// 22.1.3.4 Array.prototype.entries()\n\t// 22.1.3.13 Array.prototype.keys()\n\t// 22.1.3.29 Array.prototype.values()\n\t// 22.1.3.30 Array.prototype[@@iterator]()\n\t__webpack_require__(42)(Array, 'Array', function(iterated, kind){\n\t  this._t = toIObject(iterated); // target\n\t  this._i = 0;                   // next index\n\t  this._k = kind;                // kind\n\t// 22.1.5.2.1 %ArrayIteratorPrototype%.next()\n\t}, function(){\n\t  var O     = this._t\n\t    , kind  = this._k\n\t    , index = this._i++;\n\t  if(!O || index >= O.length){\n\t    this._t = undefined;\n\t    return step(1);\n\t  }\n\t  if(kind == 'keys'  )return step(0, index);\n\t  if(kind == 'values')return step(0, O[index]);\n\t  return step(0, [index, O[index]]);\n\t}, 'values');\n\t\n\t// argumentsList[@@iterator] is %ArrayProto_values% (9.4.4.6, 9.4.4.7)\n\tIterators.Arguments = Iterators.Array;\n\t\n\tsetUnscope('keys');\n\tsetUnscope('values');\n\tsetUnscope('entries');\n\n/***/ },\n/* 68 */\n/***/ function(module, exports) {\n\n\tmodule.exports = function(){ /* empty */ };\n\n/***/ },\n/* 69 */\n/***/ function(module, exports) {\n\n\tmodule.exports = function(done, value){\n\t  return {value: value, done: !!done};\n\t};\n\n/***/ },\n/* 70 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\tvar $          = __webpack_require__(10)\n\t  , LIBRARY    = __webpack_require__(43)\n\t  , global     = __webpack_require__(18)\n\t  , ctx        = __webpack_require__(30)\n\t  , classof    = __webpack_require__(61)\n\t  , $def       = __webpack_require__(17)\n\t  , isObject   = __webpack_require__(28)\n\t  , anObject   = __webpack_require__(29)\n\t  , aFunction  = __webpack_require__(31)\n\t  , strictNew  = __webpack_require__(71)\n\t  , forOf      = __webpack_require__(72)\n\t  , setProto   = __webpack_require__(27).set\n\t  , same       = __webpack_require__(73)\n\t  , species    = __webpack_require__(74)\n\t  , SPECIES    = __webpack_require__(49)('species')\n\t  , RECORD     = __webpack_require__(51)('record')\n\t  , asap       = __webpack_require__(75)\n\t  , PROMISE    = 'Promise'\n\t  , process    = global.process\n\t  , isNode     = classof(process) == 'process'\n\t  , P          = global[PROMISE]\n\t  , Wrapper;\n\t\n\tvar testResolve = function(sub){\n\t  var test = new P(function(){});\n\t  if(sub)test.constructor = Object;\n\t  return P.resolve(test) === test;\n\t};\n\t\n\tvar useNative = function(){\n\t  var works = false;\n\t  function P2(x){\n\t    var self = new P(x);\n\t    setProto(self, P2.prototype);\n\t    return self;\n\t  }\n\t  try {\n\t    works = P && P.resolve && testResolve();\n\t    setProto(P2, P);\n\t    P2.prototype = $.create(P.prototype, {constructor: {value: P2}});\n\t    // actual Firefox has broken subclass support, test that\n\t    if(!(P2.resolve(5).then(function(){}) instanceof P2)){\n\t      works = false;\n\t    }\n\t    // actual V8 bug, https://code.google.com/p/v8/issues/detail?id=4162\n\t    if(works && __webpack_require__(47)){\n\t      var thenableThenGotten = false;\n\t      P.resolve($.setDesc({}, 'then', {\n\t        get: function(){ thenableThenGotten = true; }\n\t      }));\n\t      works = thenableThenGotten;\n\t    }\n\t  } catch(e){ works = false; }\n\t  return works;\n\t}();\n\t\n\t// helpers\n\tvar isPromise = function(it){\n\t  return isObject(it) && (useNative ? classof(it) == 'Promise' : RECORD in it);\n\t};\n\tvar sameConstructor = function(a, b){\n\t  // library wrapper special case\n\t  if(LIBRARY && a === P && b === Wrapper)return true;\n\t  return same(a, b);\n\t};\n\tvar getConstructor = function(C){\n\t  var S = anObject(C)[SPECIES];\n\t  return S != undefined ? S : C;\n\t};\n\tvar isThenable = function(it){\n\t  var then;\n\t  return isObject(it) && typeof (then = it.then) == 'function' ? then : false;\n\t};\n\tvar notify = function(record, isReject){\n\t  if(record.n)return;\n\t  record.n = true;\n\t  var chain = record.c;\n\t  asap(function(){\n\t    var value = record.v\n\t      , ok    = record.s == 1\n\t      , i     = 0;\n\t    var run = function(react){\n\t      var cb = ok ? react.ok : react.fail\n\t        , ret, then;\n\t      try {\n\t        if(cb){\n\t          if(!ok)record.h = true;\n\t          ret = cb === true ? value : cb(value);\n\t          if(ret === react.P){\n\t            react.rej(TypeError('Promise-chain cycle'));\n\t          } else if(then = isThenable(ret)){\n\t            then.call(ret, react.res, react.rej);\n\t          } else react.res(ret);\n\t        } else react.rej(value);\n\t      } catch(err){\n\t        react.rej(err);\n\t      }\n\t    };\n\t    while(chain.length > i)run(chain[i++]); // variable length - can't use forEach\n\t    chain.length = 0;\n\t    record.n = false;\n\t    if(isReject)setTimeout(function(){\n\t      var promise = record.p\n\t        , handler, console;\n\t      if(isUnhandled(promise)){\n\t        if(isNode){\n\t          process.emit('unhandledRejection', value, promise);\n\t        } else if(handler = global.onunhandledrejection){\n\t          handler({promise: promise, reason: value});\n\t        } else if((console = global.console) && console.error){\n\t          console.error('Unhandled promise rejection', value);\n\t        }\n\t      } record.a = undefined;\n\t    }, 1);\n\t  });\n\t};\n\tvar isUnhandled = function(promise){\n\t  var record = promise[RECORD]\n\t    , chain  = record.a || record.c\n\t    , i      = 0\n\t    , react;\n\t  if(record.h)return false;\n\t  while(chain.length > i){\n\t    react = chain[i++];\n\t    if(react.fail || !isUnhandled(react.P))return false;\n\t  } return true;\n\t};\n\tvar $reject = function(value){\n\t  var record = this;\n\t  if(record.d)return;\n\t  record.d = true;\n\t  record = record.r || record; // unwrap\n\t  record.v = value;\n\t  record.s = 2;\n\t  record.a = record.c.slice();\n\t  notify(record, true);\n\t};\n\tvar $resolve = function(value){\n\t  var record = this\n\t    , then;\n\t  if(record.d)return;\n\t  record.d = true;\n\t  record = record.r || record; // unwrap\n\t  try {\n\t    if(then = isThenable(value)){\n\t      asap(function(){\n\t        var wrapper = {r: record, d: false}; // wrap\n\t        try {\n\t          then.call(value, ctx($resolve, wrapper, 1), ctx($reject, wrapper, 1));\n\t        } catch(e){\n\t          $reject.call(wrapper, e);\n\t        }\n\t      });\n\t    } else {\n\t      record.v = value;\n\t      record.s = 1;\n\t      notify(record, false);\n\t    }\n\t  } catch(e){\n\t    $reject.call({r: record, d: false}, e); // wrap\n\t  }\n\t};\n\t\n\t// constructor polyfill\n\tif(!useNative){\n\t  // 25.4.3.1 Promise(executor)\n\t  P = function Promise(executor){\n\t    aFunction(executor);\n\t    var record = {\n\t      p: strictNew(this, P, PROMISE),         // <- promise\n\t      c: [],                                  // <- awaiting reactions\n\t      a: undefined,                           // <- checked in isUnhandled reactions\n\t      s: 0,                                   // <- state\n\t      d: false,                               // <- done\n\t      v: undefined,                           // <- value\n\t      h: false,                               // <- handled rejection\n\t      n: false                                // <- notify\n\t    };\n\t    this[RECORD] = record;\n\t    try {\n\t      executor(ctx($resolve, record, 1), ctx($reject, record, 1));\n\t    } catch(err){\n\t      $reject.call(record, err);\n\t    }\n\t  };\n\t  __webpack_require__(80)(P.prototype, {\n\t    // 25.4.5.3 Promise.prototype.then(onFulfilled, onRejected)\n\t    then: function then(onFulfilled, onRejected){\n\t      var S = anObject(anObject(this).constructor)[SPECIES];\n\t      var react = {\n\t        ok:   typeof onFulfilled == 'function' ? onFulfilled : true,\n\t        fail: typeof onRejected == 'function'  ? onRejected  : false\n\t      };\n\t      var promise = react.P = new (S != undefined ? S : P)(function(res, rej){\n\t        react.res = res;\n\t        react.rej = rej;\n\t      });\n\t      aFunction(react.res);\n\t      aFunction(react.rej);\n\t      var record = this[RECORD];\n\t      record.c.push(react);\n\t      if(record.a)record.a.push(react);\n\t      if(record.s)notify(record, false);\n\t      return promise;\n\t    },\n\t    // 25.4.5.1 Promise.prototype.catch(onRejected)\n\t    'catch': function(onRejected){\n\t      return this.then(undefined, onRejected);\n\t    }\n\t  });\n\t}\n\t\n\t// export\n\t$def($def.G + $def.W + $def.F * !useNative, {Promise: P});\n\t__webpack_require__(54)(P, PROMISE);\n\tspecies(P);\n\tspecies(Wrapper = __webpack_require__(19)[PROMISE]);\n\t\n\t// statics\n\t$def($def.S + $def.F * !useNative, PROMISE, {\n\t  // 25.4.4.5 Promise.reject(r)\n\t  reject: function reject(r){\n\t    return new this(function(res, rej){ rej(r); });\n\t  }\n\t});\n\t$def($def.S + $def.F * (!useNative || testResolve(true)), PROMISE, {\n\t  // 25.4.4.6 Promise.resolve(x)\n\t  resolve: function resolve(x){\n\t    return isPromise(x) && sameConstructor(x.constructor, this)\n\t      ? x : new this(function(res){ res(x); });\n\t  }\n\t});\n\t$def($def.S + $def.F * !(useNative && __webpack_require__(62)(function(iter){\n\t  P.all(iter)['catch'](function(){});\n\t})), PROMISE, {\n\t  // 25.4.4.1 Promise.all(iterable)\n\t  all: function all(iterable){\n\t    var C      = getConstructor(this)\n\t      , values = [];\n\t    return new C(function(res, rej){\n\t      forOf(iterable, false, values.push, values);\n\t      var remaining = values.length\n\t        , results   = Array(remaining);\n\t      if(remaining)$.each.call(values, function(promise, index){\n\t        C.resolve(promise).then(function(value){\n\t          results[index] = value;\n\t          --remaining || res(results);\n\t        }, rej);\n\t      });\n\t      else res(results);\n\t    });\n\t  },\n\t  // 25.4.4.4 Promise.race(iterable)\n\t  race: function race(iterable){\n\t    var C = getConstructor(this);\n\t    return new C(function(res, rej){\n\t      forOf(iterable, false, function(promise){\n\t        C.resolve(promise).then(res, rej);\n\t      });\n\t    });\n\t  }\n\t});\n\n/***/ },\n/* 71 */\n/***/ function(module, exports) {\n\n\tmodule.exports = function(it, Constructor, name){\n\t  if(!(it instanceof Constructor))throw TypeError(name + \": use the 'new' operator!\");\n\t  return it;\n\t};\n\n/***/ },\n/* 72 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar ctx         = __webpack_require__(30)\n\t  , call        = __webpack_require__(57)\n\t  , isArrayIter = __webpack_require__(58)\n\t  , anObject    = __webpack_require__(29)\n\t  , toLength    = __webpack_require__(59)\n\t  , getIterFn   = __webpack_require__(60);\n\tmodule.exports = function(iterable, entries, fn, that){\n\t  var iterFn = getIterFn(iterable)\n\t    , f      = ctx(fn, that, entries ? 2 : 1)\n\t    , index  = 0\n\t    , length, step, iterator;\n\t  if(typeof iterFn != 'function')throw TypeError(iterable + ' is not iterable!');\n\t  // fast case for arrays with default iterator\n\t  if(isArrayIter(iterFn))for(length = toLength(iterable.length); length > index; index++){\n\t    entries ? f(anObject(step = iterable[index])[0], step[1]) : f(iterable[index]);\n\t  } else for(iterator = iterFn.call(iterable); !(step = iterator.next()).done; ){\n\t    call(iterator, f, step.value, entries);\n\t  }\n\t};\n\n/***/ },\n/* 73 */\n/***/ function(module, exports) {\n\n\tmodule.exports = Object.is || function is(x, y){\n\t  return x === y ? x !== 0 || 1 / x === 1 / y : x != x && y != y;\n\t};\n\n/***/ },\n/* 74 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\tvar $       = __webpack_require__(10)\n\t  , SPECIES = __webpack_require__(49)('species');\n\tmodule.exports = function(C){\n\t  if(__webpack_require__(47) && !(SPECIES in C))$.setDesc(C, SPECIES, {\n\t    configurable: true,\n\t    get: function(){ return this; }\n\t  });\n\t};\n\n/***/ },\n/* 75 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar global    = __webpack_require__(18)\r\n\t  , macrotask = __webpack_require__(76).set\r\n\t  , Observer  = global.MutationObserver || global.WebKitMutationObserver\r\n\t  , process   = global.process\r\n\t  , isNode    = __webpack_require__(14)(process) == 'process'\r\n\t  , head, last, notify;\r\n\t\r\n\tvar flush = function(){\r\n\t  var parent, domain;\r\n\t  if(isNode && (parent = process.domain)){\r\n\t    process.domain = null;\r\n\t    parent.exit();\r\n\t  }\r\n\t  while(head){\r\n\t    domain = head.domain;\r\n\t    if(domain)domain.enter();\r\n\t    head.fn.call(); // <- currently we use it only for Promise - try / catch not required\r\n\t    if(domain)domain.exit();\r\n\t    head = head.next;\r\n\t  } last = undefined;\r\n\t  if(parent)parent.enter();\r\n\t}\r\n\t\r\n\t// Node.js\r\n\tif(isNode){\r\n\t  notify = function(){\r\n\t    process.nextTick(flush);\r\n\t  };\r\n\t// browsers with MutationObserver\r\n\t} else if(Observer){\r\n\t  var toggle = 1\r\n\t    , node   = document.createTextNode('');\r\n\t  new Observer(flush).observe(node, {characterData: true}); // eslint-disable-line no-new\r\n\t  notify = function(){\r\n\t    node.data = toggle = -toggle;\r\n\t  };\r\n\t// for other environments - macrotask based on:\r\n\t// - setImmediate\r\n\t// - MessageChannel\r\n\t// - window.postMessag\r\n\t// - onreadystatechange\r\n\t// - setTimeout\r\n\t} else {\r\n\t  notify = function(){\r\n\t    // strange IE + webpack dev server bug - use .call(global)\r\n\t    macrotask.call(global, flush);\r\n\t  };\r\n\t}\r\n\t\r\n\tmodule.exports = function asap(fn){\r\n\t  var task = {fn: fn, next: undefined, domain: isNode && process.domain};\r\n\t  if(last)last.next = task;\r\n\t  if(!head){\r\n\t    head = task;\r\n\t    notify();\r\n\t  } last = task;\r\n\t};\n\n/***/ },\n/* 76 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\tvar ctx                = __webpack_require__(30)\n\t  , invoke             = __webpack_require__(77)\n\t  , html               = __webpack_require__(78)\n\t  , cel                = __webpack_require__(79)\n\t  , global             = __webpack_require__(18)\n\t  , process            = global.process\n\t  , setTask            = global.setImmediate\n\t  , clearTask          = global.clearImmediate\n\t  , MessageChannel     = global.MessageChannel\n\t  , counter            = 0\n\t  , queue              = {}\n\t  , ONREADYSTATECHANGE = 'onreadystatechange'\n\t  , defer, channel, port;\n\tvar run = function(){\n\t  var id = +this;\n\t  if(queue.hasOwnProperty(id)){\n\t    var fn = queue[id];\n\t    delete queue[id];\n\t    fn();\n\t  }\n\t};\n\tvar listner = function(event){\n\t  run.call(event.data);\n\t};\n\t// Node.js 0.9+ & IE10+ has setImmediate, otherwise:\n\tif(!setTask || !clearTask){\n\t  setTask = function setImmediate(fn){\n\t    var args = [], i = 1;\n\t    while(arguments.length > i)args.push(arguments[i++]);\n\t    queue[++counter] = function(){\n\t      invoke(typeof fn == 'function' ? fn : Function(fn), args);\n\t    };\n\t    defer(counter);\n\t    return counter;\n\t  };\n\t  clearTask = function clearImmediate(id){\n\t    delete queue[id];\n\t  };\n\t  // Node.js 0.8-\n\t  if(__webpack_require__(14)(process) == 'process'){\n\t    defer = function(id){\n\t      process.nextTick(ctx(run, id, 1));\n\t    };\n\t  // Browsers with MessageChannel, includes WebWorkers\n\t  } else if(MessageChannel){\n\t    channel = new MessageChannel;\n\t    port    = channel.port2;\n\t    channel.port1.onmessage = listner;\n\t    defer = ctx(port.postMessage, port, 1);\n\t  // Browsers with postMessage, skip WebWorkers\n\t  // IE8 has postMessage, but it's sync & typeof its postMessage is 'object'\n\t  } else if(global.addEventListener && typeof postMessage == 'function' && !global.importScripts){\n\t    defer = function(id){\n\t      global.postMessage(id + '', '*');\n\t    };\n\t    global.addEventListener('message', listner, false);\n\t  // IE8-\n\t  } else if(ONREADYSTATECHANGE in cel('script')){\n\t    defer = function(id){\n\t      html.appendChild(cel('script'))[ONREADYSTATECHANGE] = function(){\n\t        html.removeChild(this);\n\t        run.call(id);\n\t      };\n\t    };\n\t  // Rest old browsers\n\t  } else {\n\t    defer = function(id){\n\t      setTimeout(ctx(run, id, 1), 0);\n\t    };\n\t  }\n\t}\n\tmodule.exports = {\n\t  set:   setTask,\n\t  clear: clearTask\n\t};\n\n/***/ },\n/* 77 */\n/***/ function(module, exports) {\n\n\t// fast apply, http://jsperf.lnkit.com/fast-apply/5\n\tmodule.exports = function(fn, args, that){\n\t  var un = that === undefined;\n\t  switch(args.length){\n\t    case 0: return un ? fn()\n\t                      : fn.call(that);\n\t    case 1: return un ? fn(args[0])\n\t                      : fn.call(that, args[0]);\n\t    case 2: return un ? fn(args[0], args[1])\n\t                      : fn.call(that, args[0], args[1]);\n\t    case 3: return un ? fn(args[0], args[1], args[2])\n\t                      : fn.call(that, args[0], args[1], args[2]);\n\t    case 4: return un ? fn(args[0], args[1], args[2], args[3])\n\t                      : fn.call(that, args[0], args[1], args[2], args[3]);\n\t  } return              fn.apply(that, args);\n\t};\n\n/***/ },\n/* 78 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__(18).document && document.documentElement;\n\n/***/ },\n/* 79 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar isObject = __webpack_require__(28)\n\t  , document = __webpack_require__(18).document\n\t  // in old IE typeof document.createElement is 'object'\n\t  , is = isObject(document) && isObject(document.createElement);\n\tmodule.exports = function(it){\n\t  return is ? document.createElement(it) : {};\n\t};\n\n/***/ },\n/* 80 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar $redef = __webpack_require__(44);\n\tmodule.exports = function(target, src){\n\t  for(var key in src)$redef(target, key, src[key]);\n\t  return target;\n\t};\n\n/***/ },\n/* 81 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = { \"default\": __webpack_require__(82), __esModule: true };\n\n/***/ },\n/* 82 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t__webpack_require__(66);\n\t__webpack_require__(39);\n\tmodule.exports = __webpack_require__(83);\n\n/***/ },\n/* 83 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar anObject = __webpack_require__(29)\n\t  , get      = __webpack_require__(60);\n\tmodule.exports = __webpack_require__(19).getIterator = function(it){\n\t  var iterFn = get(it);\n\t  if(typeof iterFn != 'function')throw TypeError(it + ' is not iterable!');\n\t  return anObject(iterFn.call(it));\n\t};\n\n/***/ },\n/* 84 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _get = __webpack_require__(7)['default'];\n\t\n\tvar _inherits = __webpack_require__(21)['default'];\n\t\n\tvar _createClass = __webpack_require__(32)['default'];\n\t\n\tvar _classCallCheck = __webpack_require__(35)['default'];\n\t\n\tvar _interopRequireDefault = __webpack_require__(1)['default'];\n\t\n\tObject.defineProperty(exports, '__esModule', {\n\t\tvalue: true\n\t});\n\t\n\tvar _debug = __webpack_require__(3);\n\t\n\tvar _debug2 = _interopRequireDefault(_debug);\n\t\n\tvar _hedra = __webpack_require__(85);\n\t\n\tvar _hedra2 = _interopRequireDefault(_hedra);\n\t\n\tvar _three = __webpack_require__(87);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\t//import TWEEN from 'tween';\n\t\n\tvar debug = (0, _debug2['default'])('hedra:app');\n\t\n\tvar HedraApp = (function (_Hedra) {\n\t\t_inherits(HedraApp, _Hedra);\n\t\n\t\tfunction HedraApp(config) {\n\t\t\tvar _this = this;\n\t\n\t\t\t_classCallCheck(this, HedraApp);\n\t\n\t\t\tdebug('construct', config);\n\t\n\t\t\tconfig.make = false;\n\t\t\tconfig.parent = config.parent || document.body;\n\t\n\t\t\tif (!config.width && !config.height) {\n\t\t\t\tif (config.parent === document.body) {\n\t\t\t\t\tconfig.width = window.innerWidth;\n\t\t\t\t\tconfig.height = window.innerHeight;\n\t\t\t\t} else {\n\t\t\t\t\tconfig.width = config.parent.offsetWidth;\n\t\t\t\t\tconfig.height = config.parent.offsetHeight;\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tif (config.parent === document.body) {\n\t\t\t\tdocument.body.style.margin = '0';\n\t\t\t\tdocument.body.style.backgroundColor = 'gray';\n\t\t\t}\n\t\n\t\t\tvar scene = new _three2['default'].Scene();\n\t\n\t\t\tvar camera = new _three2['default'].PerspectiveCamera(75, config.width / config.height, 0.1, 1000);\n\t\t\tcamera.position.copy(config.camera || new _three2['default'].Vector3(0, 0, 0));\n\t\n\t\t\tvar renderer = new _three2['default'].WebGLRenderer({ alpha: true, antialias: true });\n\t\t\trenderer.setClearColor(0x000000, 0);\n\t\t\trenderer.setSize(config.width, config.height);\n\t\n\t\t\trenderer.domElement.style.display = 'block';\n\t\t\tconfig.parent.appendChild(renderer.domElement);\n\t\n\t\t\t_get(Object.getPrototypeOf(HedraApp.prototype), 'constructor', this).call(this, config);\n\t\n\t\t\tthis.scene = this._ = scene;\n\t\t\tthis.camera = camera;\n\t\t\tthis.renderer = renderer;\n\t\n\t\t\tthis.scene.add(this.camera);\n\t\n\t\t\tthis.clock = new _three2['default'].Clock(false);\n\t\n\t\t\tif (config.pause) {\n\t\t\t\twindow.addEventListener('focus', function () {\n\t\t\t\t\t_this.play();\n\t\t\t\t}, false);\n\t\n\t\t\t\twindow.addEventListener('blur', function () {\n\t\t\t\t\t_this.pause();\n\t\t\t\t}, false);\n\t\t\t}\n\t\n\t\t\tsetTimeout(function () {\n\t\t\t\t_this.play();\n\t\t\t}, 0);\n\t\n\t\t\tif (typeof window.Stats !== 'undefined') {\n\t\t\t\tthis.stats = new window.Stats();\n\t\n\t\t\t\tthis.stats.domElement.style.position = 'absolute';\n\t\t\t\tthis.stats.domElement.style.top = '0';\n\t\t\t\tthis.stats.domElement.style.left = '0';\n\t\t\t\tconfig.parent.appendChild(this.stats.domElement);\n\t\t\t}\n\t\n\t\t\tif (typeof TWEEN !== 'undefined') {\n\t\t\t\tTWEEN._time = 0;\n\t\t\t\tthis.on('update').then(function (e) {\n\t\t\t\t\tTWEEN._time = e.time;\n\t\t\t\t\tTWEEN.update(e.time);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\n\t\t_createClass(HedraApp, [{\n\t\t\tkey: 'play',\n\t\t\tvalue: function play() {\n\t\t\t\tvar _this2 = this;\n\t\n\t\t\t\tdebug('play');\n\t\n\t\t\t\tthis.clock.start();\n\t\t\t\trequestAnimationFrame(function () {\n\t\t\t\t\t_this2._animate();\n\t\t\t\t});\n\t\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'pause',\n\t\t\tvalue: function pause() {\n\t\t\t\tdebug('pause');\n\t\n\t\t\t\tthis.clock.stop();\n\t\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: '_animate',\n\t\t\tvalue: function _animate() {\n\t\t\t\tvar _this3 = this;\n\t\n\t\t\t\tif (this.clock.running) {\n\t\t\t\t\trequestAnimationFrame(function () {\n\t\t\t\t\t\t_this3._animate();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\n\t\t\t\tthis._frame(this.clock.getDelta(), this.clock.getElapsedTime());\n\t\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: '_frame',\n\t\t\tvalue: function _frame(delta, time) {\n\t\t\t\tthis.bubble('update', delta || 0, time || 0);\n\t\n\t\t\t\tthis.render();\n\t\n\t\t\t\tif (this.stats) {\n\t\t\t\t\tthis.stats.update();\n\t\t\t\t}\n\t\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'render',\n\t\t\tvalue: function render() {\n\t\t\t\tthis.renderer.render(this.scene, this.camera);\n\t\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn HedraApp;\n\t})(_hedra2['default']);\n\t\n\texports['default'] = HedraApp;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 85 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _get = __webpack_require__(7)['default'];\n\t\n\tvar _inherits = __webpack_require__(21)['default'];\n\t\n\tvar _createClass = __webpack_require__(32)['default'];\n\t\n\tvar _classCallCheck = __webpack_require__(35)['default'];\n\t\n\tvar _getIterator = __webpack_require__(81)['default'];\n\t\n\tvar _Promise = __webpack_require__(63)['default'];\n\t\n\tvar _interopRequireDefault = __webpack_require__(1)['default'];\n\t\n\tObject.defineProperty(exports, '__esModule', {\n\t\tvalue: true\n\t});\n\t\n\tvar _debug = __webpack_require__(3);\n\t\n\tvar _debug2 = _interopRequireDefault(_debug);\n\t\n\tvar _emitter = __webpack_require__(86);\n\t\n\tvar _emitter2 = _interopRequireDefault(_emitter);\n\t\n\tvar _three = __webpack_require__(87);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\t//import TWEEN from 'tween';\n\t\n\tvar debug = (0, _debug2['default'])('hedra');\n\t\n\tvar Hedra = (function (_Emitter) {\n\t\t_inherits(Hedra, _Emitter);\n\t\n\t\tfunction Hedra(config) {\n\t\t\t_classCallCheck(this, Hedra);\n\t\n\t\t\tdebug('construct', config);\n\t\n\t\t\tif (config.make === false) {\n\t\t\t\tdelete config.make;\n\t\t\t} else {\n\t\t\t\tif (config.geometry && config.material) {\n\t\t\t\t\tconfig.make = new _three2['default'].Mesh(config.geometry, config.material);\n\t\t\t\t} else {\n\t\t\t\t\tconfig.make = new _three2['default'].Object3D();\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t_get(Object.getPrototypeOf(Hedra.prototype), 'constructor', this).call(this);\n\t\n\t\t\tthis.children = [];\n\t\n\t\t\tif (config.make) {\n\t\t\t\tthis._ = config.make;\n\t\t\t\tthis._._ = this;\n\t\t\t}\n\t\t}\n\t\n\t\t_createClass(Hedra, [{\n\t\t\tkey: 'add',\n\t\t\tvalue: function add(child) {\n\t\t\t\tdebug('add', child);\n\t\n\t\t\t\tif (child instanceof Hedra) {\n\t\t\t\t\tthis.children.push(child);\n\t\t\t\t\tthis._.add(child._);\n\t\t\t\t} else if (child instanceof _three2['default'].Object3D) {\n\t\t\t\t\tthis._.add(child);\n\t\t\t\t} else {\n\t\t\t\t\tthrow new Error('Hedra.app.add: Child not an instance of `Hedra` or `THREE.Object3D`.');\n\t\t\t\t}\n\t\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'bubble',\n\t\t\tvalue: function bubble() {\n\t\t\t\tthis.emit.apply(this, arguments);\n\t\n\t\t\t\tvar _iteratorNormalCompletion = true;\n\t\t\t\tvar _didIteratorError = false;\n\t\t\t\tvar _iteratorError = undefined;\n\t\n\t\t\t\ttry {\n\t\t\t\t\tfor (var _iterator = _getIterator(this.children), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t\t\t\t\t\tvar child = _step.value;\n\t\n\t\t\t\t\t\tchild.bubble.apply(child, arguments);\n\t\t\t\t\t}\n\t\t\t\t} catch (err) {\n\t\t\t\t\t_didIteratorError = true;\n\t\t\t\t\t_iteratorError = err;\n\t\t\t\t} finally {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif (!_iteratorNormalCompletion && _iterator['return']) {\n\t\t\t\t\t\t\t_iterator['return']();\n\t\t\t\t\t\t}\n\t\t\t\t\t} finally {\n\t\t\t\t\t\tif (_didIteratorError) {\n\t\t\t\t\t\t\tthrow _iteratorError;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'tween',\n\t\t\tvalue: function tween(config) {\n\t\t\t\tdebug('tween', config);\n\t\n\t\t\t\tvar tween = new TWEEN.Tween(config.object || this);\n\t\n\t\t\t\tif (config.to && config.duration) {\n\t\t\t\t\ttween.to(config.to, config.duration);\n\t\t\t\t}\n\t\n\t\t\t\tif (config.easing) {\n\t\t\t\t\ttween.easing(config.easing);\n\t\t\t\t}\n\t\n\t\t\t\tvar promise = new _Promise(function (resolve) {\n\t\t\t\t\ttween.onComplete(resolve);\n\t\t\t\t\ttween.onStop(resolve);\n\t\t\t\t\ttween.start(TWEEN._time);\n\t\t\t\t});\n\t\n\t\t\t\tpromise.tween = tween;\n\t\n\t\t\t\treturn promise;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'position',\n\t\t\tget: function get() {\n\t\t\t\treturn this._.position;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'rotation',\n\t\t\tget: function get() {\n\t\t\t\treturn this._.rotation;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'quaternion',\n\t\t\tget: function get() {\n\t\t\t\treturn this._.quaternion;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'scale',\n\t\t\tget: function get() {\n\t\t\t\treturn this._.scale;\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Hedra;\n\t})(_emitter2['default']);\n\t\n\texports['default'] = Hedra;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 86 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/**\r\n\t * ES6-ified version of component-emitter\r\n\t * Original available at https://github.com/component/emitter\r\n\t */\n\t\n\t'use strict';\n\t\n\tvar _createClass = __webpack_require__(32)['default'];\n\t\n\tvar _classCallCheck = __webpack_require__(35)['default'];\n\t\n\tObject.defineProperty(exports, '__esModule', {\n\t\tvalue: true\n\t});\n\t\n\tvar Emitter = (function () {\n\t\t/**\r\n\t  * Initialize a new `Emitter`.\r\n\t  *\r\n\t  * @api public\r\n\t  */\n\t\n\t\tfunction Emitter() {\n\t\t\t_classCallCheck(this, Emitter);\n\t\n\t\t\tthis._emitters = {};\n\t\t\tthis._subscribers = [];\n\t\t}\n\t\n\t\t/**\r\n\t  * Register a handler `fn`.\r\n\t  */\n\t\n\t\t_createClass(Emitter, [{\n\t\t\tkey: 'then',\n\t\t\tvalue: function then(fn) {\n\t\t\t\tthis._subscribers.push(fn.bind(this));\n\t\n\t\t\t\treturn this;\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Return an emitter for the given `event`.\r\n\t   *\r\n\t   * @param {String} event\r\n\t   * @return {Emitter}\r\n\t   * @api public\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: 'on',\n\t\t\tvalue: function on() {\n\t\t\t\tvar _emitters$event;\n\t\n\t\t\t\tfor (var _len = arguments.length, items = Array(_len), _key = 0; _key < _len; _key++) {\n\t\t\t\t\titems[_key] = arguments[_key];\n\t\t\t\t}\n\t\n\t\t\t\tif (!items.length) {\n\t\t\t\t\treturn this;\n\t\t\t\t}\n\t\n\t\t\t\tvar event = items.shift();\n\t\n\t\t\t\tif (!this._emitters[event]) {\n\t\t\t\t\tthis._emitters[event] = new Emitter();\n\t\t\t\t}\n\t\n\t\t\t\treturn (_emitters$event = this._emitters[event]).on.apply(_emitters$event, items);\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Remove the emitters for `event` or all events.\r\n\t   *\r\n\t   * @param {String} event\r\n\t   * @return {Emitter}\r\n\t   * @api public\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: 'off',\n\t\t\tvalue: function off() {\n\t\t\t\tvar _emitters$event2;\n\t\n\t\t\t\tfor (var _len2 = arguments.length, items = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n\t\t\t\t\titems[_key2] = arguments[_key2];\n\t\t\t\t}\n\t\n\t\t\t\tif (!items.length) {\n\t\t\t\t\tthis._emitters = {};\n\t\t\t\t\treturn this;\n\t\t\t\t}\n\t\n\t\t\t\tvar event = items.shift();\n\t\n\t\t\t\tif (!this._emitters[event]) {\n\t\t\t\t\tthis._emitters[event] = new Emitter();\n\t\t\t\t}\n\t\n\t\t\t\treturn (_emitters$event2 = this._emitters[event]).off.apply(_emitters$event2, items);\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Emit `event` with the given args.\r\n\t   *\r\n\t   * @param {String} event\r\n\t   * @param {Mixed} ...\r\n\t   * @return {Emitter}\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: 'emit',\n\t\t\tvalue: function emit() {\n\t\t\t\tvar _this = this;\n\t\n\t\t\t\tfor (var _len3 = arguments.length, items = Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n\t\t\t\t\titems[_key3] = arguments[_key3];\n\t\t\t\t}\n\t\n\t\t\t\tthis._subscribers.map(function (fn) {\n\t\t\t\t\tfn.apply(_this, items);\n\t\t\t\t});\n\t\n\t\t\t\tvar event = items[0];\n\t\t\t\tif (typeof event === 'string') {\n\t\t\t\t\titems.shift();\n\t\t\t\t\tvar emitter = this._emitters[event];\n\t\n\t\t\t\t\tif (emitter) {\n\t\t\t\t\t\temitter.emit.apply(emitter, items);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\treturn this;\n\t\t\t}\n\t\n\t\t\t/**\r\n\t   * Check if this emitter has `event` emitters.\r\n\t   *\r\n\t   * @param {String} event\r\n\t   * @return {Boolean}\r\n\t   * @api public\r\n\t   */\n\t\n\t\t}, {\n\t\t\tkey: 'has',\n\t\t\tvalue: function has(event) {\n\t\t\t\treturn !!this._emitters[event];\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Emitter;\n\t})();\n\t\n\texports['default'] = Emitter;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 87 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_RESULT__;// File:src/Three.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */'use strict';var _Math$sign=__webpack_require__(88)['default'];var _Object$defineProperty=__webpack_require__(33)['default'];var _Object$defineProperties=__webpack_require__(92)['default'];var _Object$create=__webpack_require__(22)['default'];var THREE={REVISION:'72'}; //\n\tif(true){!(__WEBPACK_AMD_DEFINE_FACTORY__ = (THREE), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.call(exports, __webpack_require__, exports, module)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));}else if('undefined' !== typeof exports && 'undefined' !== typeof module){module.exports = THREE;} // polyfills\n\tif(self.requestAnimationFrame === undefined || self.cancelAnimationFrame === undefined){ // Missing in Android stock browser.\n\t(function(){var lastTime=0;var vendors=['ms','moz','webkit','o'];for(var x=0;x < vendors.length && !self.requestAnimationFrame;++x) {self.requestAnimationFrame = self[vendors[x] + 'RequestAnimationFrame'];self.cancelAnimationFrame = self[vendors[x] + 'CancelAnimationFrame'] || self[vendors[x] + 'CancelRequestAnimationFrame'];}if(self.requestAnimationFrame === undefined && self.setTimeout !== undefined){self.requestAnimationFrame = function(callback){var currTime=Date.now(),timeToCall=Math.max(0,16 - (currTime - lastTime));var id=self.setTimeout(function(){callback(currTime + timeToCall);},timeToCall);lastTime = currTime + timeToCall;return id;};}if(self.cancelAnimationFrame === undefined && self.clearTimeout !== undefined){self.cancelAnimationFrame = function(id){self.clearTimeout(id);};}})();}if(_Math$sign === undefined){ // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/sign\n\tMath.sign = function(x){return x < 0?-1:x > 0?1:+x;};}if(Function.prototype.name === undefined && _Object$defineProperty !== undefined){ // Missing in IE9-11.\n\t// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/name\n\tObject.defineProperty(Function.prototype,'name',{get:function get(){return this.toString().match(/^\\s*function\\s*(\\S*)\\s*\\(/)[1];}});} // https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent.button\n\tTHREE.MOUSE = {LEFT:0,MIDDLE:1,RIGHT:2}; // GL STATE CONSTANTS\n\tTHREE.CullFaceNone = 0;THREE.CullFaceBack = 1;THREE.CullFaceFront = 2;THREE.CullFaceFrontBack = 3;THREE.FrontFaceDirectionCW = 0;THREE.FrontFaceDirectionCCW = 1; // SHADOWING TYPES\n\tTHREE.BasicShadowMap = 0;THREE.PCFShadowMap = 1;THREE.PCFSoftShadowMap = 2; // MATERIAL CONSTANTS\n\t// side\n\tTHREE.FrontSide = 0;THREE.BackSide = 1;THREE.DoubleSide = 2; // shading\n\tTHREE.FlatShading = 1;THREE.SmoothShading = 2; // colors\n\tTHREE.NoColors = 0;THREE.FaceColors = 1;THREE.VertexColors = 2; // blending modes\n\tTHREE.NoBlending = 0;THREE.NormalBlending = 1;THREE.AdditiveBlending = 2;THREE.SubtractiveBlending = 3;THREE.MultiplyBlending = 4;THREE.CustomBlending = 5; // custom blending equations\n\t// (numbers start from 100 not to clash with other\n\t// mappings to OpenGL constants defined in Texture.js)\n\tTHREE.AddEquation = 100;THREE.SubtractEquation = 101;THREE.ReverseSubtractEquation = 102;THREE.MinEquation = 103;THREE.MaxEquation = 104; // custom blending destination factors\n\tTHREE.ZeroFactor = 200;THREE.OneFactor = 201;THREE.SrcColorFactor = 202;THREE.OneMinusSrcColorFactor = 203;THREE.SrcAlphaFactor = 204;THREE.OneMinusSrcAlphaFactor = 205;THREE.DstAlphaFactor = 206;THREE.OneMinusDstAlphaFactor = 207; // custom blending source factors\n\t//THREE.ZeroFactor = 200;\n\t//THREE.OneFactor = 201;\n\t//THREE.SrcAlphaFactor = 204;\n\t//THREE.OneMinusSrcAlphaFactor = 205;\n\t//THREE.DstAlphaFactor = 206;\n\t//THREE.OneMinusDstAlphaFactor = 207;\n\tTHREE.DstColorFactor = 208;THREE.OneMinusDstColorFactor = 209;THREE.SrcAlphaSaturateFactor = 210; // depth modes\n\tTHREE.NeverDepth = 0;THREE.AlwaysDepth = 1;THREE.LessDepth = 2;THREE.LessEqualDepth = 3;THREE.EqualDepth = 4;THREE.GreaterEqualDepth = 5;THREE.GreaterDepth = 6;THREE.NotEqualDepth = 7; // TEXTURE CONSTANTS\n\tTHREE.MultiplyOperation = 0;THREE.MixOperation = 1;THREE.AddOperation = 2; // Mapping modes\n\tTHREE.UVMapping = 300;THREE.CubeReflectionMapping = 301;THREE.CubeRefractionMapping = 302;THREE.EquirectangularReflectionMapping = 303;THREE.EquirectangularRefractionMapping = 304;THREE.SphericalReflectionMapping = 305; // Wrapping modes\n\tTHREE.RepeatWrapping = 1000;THREE.ClampToEdgeWrapping = 1001;THREE.MirroredRepeatWrapping = 1002; // Filters\n\tTHREE.NearestFilter = 1003;THREE.NearestMipMapNearestFilter = 1004;THREE.NearestMipMapLinearFilter = 1005;THREE.LinearFilter = 1006;THREE.LinearMipMapNearestFilter = 1007;THREE.LinearMipMapLinearFilter = 1008; // Data types\n\tTHREE.UnsignedByteType = 1009;THREE.ByteType = 1010;THREE.ShortType = 1011;THREE.UnsignedShortType = 1012;THREE.IntType = 1013;THREE.UnsignedIntType = 1014;THREE.FloatType = 1015;THREE.HalfFloatType = 1025; // Pixel types\n\t//THREE.UnsignedByteType = 1009;\n\tTHREE.UnsignedShort4444Type = 1016;THREE.UnsignedShort5551Type = 1017;THREE.UnsignedShort565Type = 1018; // Pixel formats\n\tTHREE.AlphaFormat = 1019;THREE.RGBFormat = 1020;THREE.RGBAFormat = 1021;THREE.LuminanceFormat = 1022;THREE.LuminanceAlphaFormat = 1023; // THREE.RGBEFormat handled as THREE.RGBAFormat in shaders\n\tTHREE.RGBEFormat = THREE.RGBAFormat; //1024;\n\t// DDS / ST3C Compressed texture formats\n\tTHREE.RGB_S3TC_DXT1_Format = 2001;THREE.RGBA_S3TC_DXT1_Format = 2002;THREE.RGBA_S3TC_DXT3_Format = 2003;THREE.RGBA_S3TC_DXT5_Format = 2004; // PVRTC compressed texture formats\n\tTHREE.RGB_PVRTC_4BPPV1_Format = 2100;THREE.RGB_PVRTC_2BPPV1_Format = 2101;THREE.RGBA_PVRTC_4BPPV1_Format = 2102;THREE.RGBA_PVRTC_2BPPV1_Format = 2103; // DEPRECATED\n\tTHREE.Projector = function(){console.error('THREE.Projector has been moved to /examples/js/renderers/Projector.js.');this.projectVector = function(vector,camera){console.warn('THREE.Projector: .projectVector() is now vector.project().');vector.project(camera);};this.unprojectVector = function(vector,camera){console.warn('THREE.Projector: .unprojectVector() is now vector.unproject().');vector.unproject(camera);};this.pickingRay = function(vector,camera){console.error('THREE.Projector: .pickingRay() is now raycaster.setFromCamera().');};};THREE.CanvasRenderer = function(){console.error('THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js');this.domElement = document.createElement('canvas');this.clear = function(){};this.render = function(){};this.setClearColor = function(){};this.setSize = function(){};}; // File:src/math/Color.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */THREE.Color = function(color){if(arguments.length === 3){return this.setRGB(arguments[0],arguments[1],arguments[2]);}return this.set(color);};THREE.Color.prototype = {constructor:THREE.Color,r:1,g:1,b:1,set:function set(value){if(value instanceof THREE.Color){this.copy(value);}else if(typeof value === 'number'){this.setHex(value);}else if(typeof value === 'string'){this.setStyle(value);}return this;},setHex:function setHex(hex){hex = Math.floor(hex);this.r = (hex >> 16 & 255) / 255;this.g = (hex >> 8 & 255) / 255;this.b = (hex & 255) / 255;return this;},setRGB:function setRGB(r,g,b){this.r = r;this.g = g;this.b = b;return this;},setHSL:(function(){function hue2rgb(p,q,t){if(t < 0)t += 1;if(t > 1)t -= 1;if(t < 1 / 6)return p + (q - p) * 6 * t;if(t < 1 / 2)return q;if(t < 2 / 3)return p + (q - p) * 6 * (2 / 3 - t);return p;}return function(h,s,l){ // h,s,l ranges are in 0.0 - 1.0\n\th = THREE.Math.euclideanModulo(h,1);s = THREE.Math.clamp(s,0,1);l = THREE.Math.clamp(l,0,1);if(s === 0){this.r = this.g = this.b = l;}else {var p=l <= 0.5?l * (1 + s):l + s - l * s;var q=2 * l - p;this.r = hue2rgb(q,p,h + 1 / 3);this.g = hue2rgb(q,p,h);this.b = hue2rgb(q,p,h - 1 / 3);}return this;};})(),setStyle:function setStyle(style){var parseAlpha=function parseAlpha(strAlpha){var alpha=parseFloat(strAlpha);if(alpha < 1){console.warn('THREE.Color: Alpha component of color ' + style + ' will be ignored.');}return alpha;};var m;if(m = /^((?:rgb|hsl)a?)\\(\\s*([^\\)]*)\\)/.exec(style)){ // rgb / hsl\n\tvar color;var name=m[1];var components=m[2];switch(name){case 'rgb':if(color = /^(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*$/.exec(components)){ // rgb(255,0,0)\n\tthis.r = Math.min(255,parseInt(color[1],10)) / 255;this.g = Math.min(255,parseInt(color[2],10)) / 255;this.b = Math.min(255,parseInt(color[3],10)) / 255;return this;}if(color = /^(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*$/.exec(components)){ // rgb(100%,0%,0%)\n\tthis.r = Math.min(100,parseInt(color[1],10)) / 100;this.g = Math.min(100,parseInt(color[2],10)) / 100;this.b = Math.min(100,parseInt(color[3],10)) / 100;return this;}break;case 'rgba':if(color = /^(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*([0-9]*\\.?[0-9]+)\\s*$/.exec(components)){ // rgba(255,0,0,0.5)\n\tthis.r = Math.min(255,parseInt(color[1],10)) / 255;this.g = Math.min(255,parseInt(color[2],10)) / 255;this.b = Math.min(255,parseInt(color[3],10)) / 255;parseAlpha(color[4]);return this;}if(color = /^(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*,\\s*([0-9]*\\.?[0-9]+)\\s*$/.exec(components)){ // rgba(100%,0%,0%,0.5)\n\tthis.r = Math.min(100,parseInt(color[1],10)) / 100;this.g = Math.min(100,parseInt(color[2],10)) / 100;this.b = Math.min(100,parseInt(color[3],10)) / 100;parseAlpha(color[4]);return this;}break;case 'hsl':if(color = /^([0-9]*\\.?[0-9]+)\\s*,\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*$/.exec(components)){ // hsl(120,50%,50%)\n\tvar h=parseFloat(color[1]);var s=parseInt(color[2],10) / 100;var l=parseInt(color[3],10) / 100;return this.setHSL(h,s,l);}break;case 'hsla':if(color = /^([0-9]*\\.?[0-9]+)\\s*,\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*,\\s*([0-9]*\\.?[0-9]+)\\s*$/.exec(components)){ // hsla(120,50%,50%,0.5)\n\tvar h=parseFloat(color[1]);var s=parseInt(color[2],10) / 100;var l=parseInt(color[3],10) / 100;parseAlpha(color[4]);return this.setHSL(h,s,l);}break;}}else if(m = /^\\#([A-Fa-f0-9]+)$/.exec(style)){ // hex color\n\tvar hex=m[1];var size=hex.length;if(size === 3){ // #ff0\n\tthis.r = parseInt(hex.charAt(0) + hex.charAt(0),16) / 255;this.g = parseInt(hex.charAt(1) + hex.charAt(1),16) / 255;this.b = parseInt(hex.charAt(2) + hex.charAt(2),16) / 255;return this;}else if(size === 6){ // #ff0000\n\tthis.r = parseInt(hex.charAt(0) + hex.charAt(1),16) / 255;this.g = parseInt(hex.charAt(2) + hex.charAt(3),16) / 255;this.b = parseInt(hex.charAt(4) + hex.charAt(5),16) / 255;return this;}}if(style && style.length > 0){ // color keywords\n\tvar hex=THREE.ColorKeywords[style];if(hex !== undefined){ // red\n\tthis.setHex(hex);}else { // unknown color\n\tconsole.warn('THREE.Color: Unknown color ' + style);}}return this;},clone:function clone(){return new this.constructor(this.r,this.g,this.b);},copy:function copy(color){this.r = color.r;this.g = color.g;this.b = color.b;return this;},copyGammaToLinear:function copyGammaToLinear(color,gammaFactor){if(gammaFactor === undefined)gammaFactor = 2.0;this.r = Math.pow(color.r,gammaFactor);this.g = Math.pow(color.g,gammaFactor);this.b = Math.pow(color.b,gammaFactor);return this;},copyLinearToGamma:function copyLinearToGamma(color,gammaFactor){if(gammaFactor === undefined)gammaFactor = 2.0;var safeInverse=gammaFactor > 0?1.0 / gammaFactor:1.0;this.r = Math.pow(color.r,safeInverse);this.g = Math.pow(color.g,safeInverse);this.b = Math.pow(color.b,safeInverse);return this;},convertGammaToLinear:function convertGammaToLinear(){var r=this.r,g=this.g,b=this.b;this.r = r * r;this.g = g * g;this.b = b * b;return this;},convertLinearToGamma:function convertLinearToGamma(){this.r = Math.sqrt(this.r);this.g = Math.sqrt(this.g);this.b = Math.sqrt(this.b);return this;},getHex:function getHex(){return this.r * 255 << 16 ^ this.g * 255 << 8 ^ this.b * 255 << 0;},getHexString:function getHexString(){return ('000000' + this.getHex().toString(16)).slice(-6);},getHSL:function getHSL(optionalTarget){ // h,s,l ranges are in 0.0 - 1.0\n\tvar hsl=optionalTarget || {h:0,s:0,l:0};var r=this.r,g=this.g,b=this.b;var max=Math.max(r,g,b);var min=Math.min(r,g,b);var hue,saturation;var lightness=(min + max) / 2.0;if(min === max){hue = 0;saturation = 0;}else {var delta=max - min;saturation = lightness <= 0.5?delta / (max + min):delta / (2 - max - min);switch(max){case r:hue = (g - b) / delta + (g < b?6:0);break;case g:hue = (b - r) / delta + 2;break;case b:hue = (r - g) / delta + 4;break;}hue /= 6;}hsl.h = hue;hsl.s = saturation;hsl.l = lightness;return hsl;},getStyle:function getStyle(){return 'rgb(' + (this.r * 255 | 0) + ',' + (this.g * 255 | 0) + ',' + (this.b * 255 | 0) + ')';},offsetHSL:function offsetHSL(h,s,l){var hsl=this.getHSL();hsl.h += h;hsl.s += s;hsl.l += l;this.setHSL(hsl.h,hsl.s,hsl.l);return this;},add:function add(color){this.r += color.r;this.g += color.g;this.b += color.b;return this;},addColors:function addColors(color1,color2){this.r = color1.r + color2.r;this.g = color1.g + color2.g;this.b = color1.b + color2.b;return this;},addScalar:function addScalar(s){this.r += s;this.g += s;this.b += s;return this;},multiply:function multiply(color){this.r *= color.r;this.g *= color.g;this.b *= color.b;return this;},multiplyScalar:function multiplyScalar(s){this.r *= s;this.g *= s;this.b *= s;return this;},lerp:function lerp(color,alpha){this.r += (color.r - this.r) * alpha;this.g += (color.g - this.g) * alpha;this.b += (color.b - this.b) * alpha;return this;},equals:function equals(c){return c.r === this.r && c.g === this.g && c.b === this.b;},fromArray:function fromArray(array){this.r = array[0];this.g = array[1];this.b = array[2];return this;},toArray:function toArray(array,offset){if(array === undefined)array = [];if(offset === undefined)offset = 0;array[offset] = this.r;array[offset + 1] = this.g;array[offset + 2] = this.b;return array;}};THREE.ColorKeywords = {'aliceblue':0xF0F8FF,'antiquewhite':0xFAEBD7,'aqua':0x00FFFF,'aquamarine':0x7FFFD4,'azure':0xF0FFFF,'beige':0xF5F5DC,'bisque':0xFFE4C4,'black':0x000000,'blanchedalmond':0xFFEBCD,'blue':0x0000FF,'blueviolet':0x8A2BE2,'brown':0xA52A2A,'burlywood':0xDEB887,'cadetblue':0x5F9EA0,'chartreuse':0x7FFF00,'chocolate':0xD2691E,'coral':0xFF7F50,'cornflowerblue':0x6495ED,'cornsilk':0xFFF8DC,'crimson':0xDC143C,'cyan':0x00FFFF,'darkblue':0x00008B,'darkcyan':0x008B8B,'darkgoldenrod':0xB8860B,'darkgray':0xA9A9A9,'darkgreen':0x006400,'darkgrey':0xA9A9A9,'darkkhaki':0xBDB76B,'darkmagenta':0x8B008B,'darkolivegreen':0x556B2F,'darkorange':0xFF8C00,'darkorchid':0x9932CC,'darkred':0x8B0000,'darksalmon':0xE9967A,'darkseagreen':0x8FBC8F,'darkslateblue':0x483D8B,'darkslategray':0x2F4F4F,'darkslategrey':0x2F4F4F,'darkturquoise':0x00CED1,'darkviolet':0x9400D3,'deeppink':0xFF1493,'deepskyblue':0x00BFFF,'dimgray':0x696969,'dimgrey':0x696969,'dodgerblue':0x1E90FF,'firebrick':0xB22222,'floralwhite':0xFFFAF0,'forestgreen':0x228B22,'fuchsia':0xFF00FF,'gainsboro':0xDCDCDC,'ghostwhite':0xF8F8FF,'gold':0xFFD700,'goldenrod':0xDAA520,'gray':0x808080,'green':0x008000,'greenyellow':0xADFF2F,'grey':0x808080,'honeydew':0xF0FFF0,'hotpink':0xFF69B4,'indianred':0xCD5C5C,'indigo':0x4B0082,'ivory':0xFFFFF0,'khaki':0xF0E68C,'lavender':0xE6E6FA,'lavenderblush':0xFFF0F5,'lawngreen':0x7CFC00,'lemonchiffon':0xFFFACD,'lightblue':0xADD8E6,'lightcoral':0xF08080,'lightcyan':0xE0FFFF,'lightgoldenrodyellow':0xFAFAD2,'lightgray':0xD3D3D3,'lightgreen':0x90EE90,'lightgrey':0xD3D3D3,'lightpink':0xFFB6C1,'lightsalmon':0xFFA07A,'lightseagreen':0x20B2AA,'lightskyblue':0x87CEFA,'lightslategray':0x778899,'lightslategrey':0x778899,'lightsteelblue':0xB0C4DE,'lightyellow':0xFFFFE0,'lime':0x00FF00,'limegreen':0x32CD32,'linen':0xFAF0E6,'magenta':0xFF00FF,'maroon':0x800000,'mediumaquamarine':0x66CDAA,'mediumblue':0x0000CD,'mediumorchid':0xBA55D3,'mediumpurple':0x9370DB,'mediumseagreen':0x3CB371,'mediumslateblue':0x7B68EE,'mediumspringgreen':0x00FA9A,'mediumturquoise':0x48D1CC,'mediumvioletred':0xC71585,'midnightblue':0x191970,'mintcream':0xF5FFFA,'mistyrose':0xFFE4E1,'moccasin':0xFFE4B5,'navajowhite':0xFFDEAD,'navy':0x000080,'oldlace':0xFDF5E6,'olive':0x808000,'olivedrab':0x6B8E23,'orange':0xFFA500,'orangered':0xFF4500,'orchid':0xDA70D6,'palegoldenrod':0xEEE8AA,'palegreen':0x98FB98,'paleturquoise':0xAFEEEE,'palevioletred':0xDB7093,'papayawhip':0xFFEFD5,'peachpuff':0xFFDAB9,'peru':0xCD853F,'pink':0xFFC0CB,'plum':0xDDA0DD,'powderblue':0xB0E0E6,'purple':0x800080,'red':0xFF0000,'rosybrown':0xBC8F8F,'royalblue':0x4169E1,'saddlebrown':0x8B4513,'salmon':0xFA8072,'sandybrown':0xF4A460,'seagreen':0x2E8B57,'seashell':0xFFF5EE,'sienna':0xA0522D,'silver':0xC0C0C0,'skyblue':0x87CEEB,'slateblue':0x6A5ACD,'slategray':0x708090,'slategrey':0x708090,'snow':0xFFFAFA,'springgreen':0x00FF7F,'steelblue':0x4682B4,'tan':0xD2B48C,'teal':0x008080,'thistle':0xD8BFD8,'tomato':0xFF6347,'turquoise':0x40E0D0,'violet':0xEE82EE,'wheat':0xF5DEB3,'white':0xFFFFFF,'whitesmoke':0xF5F5F5,'yellow':0xFFFF00,'yellowgreen':0x9ACD32}; // File:src/math/Quaternion.js\n\t/**\n\t * @author mikael emtinger / http://gomo.se/\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author WestLangley / http://github.com/WestLangley\n\t * @author bhouston / http://exocortex.com\n\t */THREE.Quaternion = function(x,y,z,w){this._x = x || 0;this._y = y || 0;this._z = z || 0;this._w = w !== undefined?w:1;};THREE.Quaternion.prototype = _Object$defineProperties({constructor:THREE.Quaternion,set:function set(x,y,z,w){this._x = x;this._y = y;this._z = z;this._w = w;this.onChangeCallback();return this;},clone:function clone(){return new this.constructor(this._x,this._y,this._z,this._w);},copy:function copy(quaternion){this._x = quaternion.x;this._y = quaternion.y;this._z = quaternion.z;this._w = quaternion.w;this.onChangeCallback();return this;},setFromEuler:function setFromEuler(euler,update){if(euler instanceof THREE.Euler === false){throw new Error('THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.');} // http://www.mathworks.com/matlabcentral/fileexchange/\n\t// \t20696-function-to-convert-between-dcm-euler-angles-quaternions-and-euler-vectors/\n\t//\tcontent/SpinCalc.m\n\tvar c1=Math.cos(euler._x / 2);var c2=Math.cos(euler._y / 2);var c3=Math.cos(euler._z / 2);var s1=Math.sin(euler._x / 2);var s2=Math.sin(euler._y / 2);var s3=Math.sin(euler._z / 2);var order=euler.order;if(order === 'XYZ'){this._x = s1 * c2 * c3 + c1 * s2 * s3;this._y = c1 * s2 * c3 - s1 * c2 * s3;this._z = c1 * c2 * s3 + s1 * s2 * c3;this._w = c1 * c2 * c3 - s1 * s2 * s3;}else if(order === 'YXZ'){this._x = s1 * c2 * c3 + c1 * s2 * s3;this._y = c1 * s2 * c3 - s1 * c2 * s3;this._z = c1 * c2 * s3 - s1 * s2 * c3;this._w = c1 * c2 * c3 + s1 * s2 * s3;}else if(order === 'ZXY'){this._x = s1 * c2 * c3 - c1 * s2 * s3;this._y = c1 * s2 * c3 + s1 * c2 * s3;this._z = c1 * c2 * s3 + s1 * s2 * c3;this._w = c1 * c2 * c3 - s1 * s2 * s3;}else if(order === 'ZYX'){this._x = s1 * c2 * c3 - c1 * s2 * s3;this._y = c1 * s2 * c3 + s1 * c2 * s3;this._z = c1 * c2 * s3 - s1 * s2 * c3;this._w = c1 * c2 * c3 + s1 * s2 * s3;}else if(order === 'YZX'){this._x = s1 * c2 * c3 + c1 * s2 * s3;this._y = c1 * s2 * c3 + s1 * c2 * s3;this._z = c1 * c2 * s3 - s1 * s2 * c3;this._w = c1 * c2 * c3 - s1 * s2 * s3;}else if(order === 'XZY'){this._x = s1 * c2 * c3 - c1 * s2 * s3;this._y = c1 * s2 * c3 - s1 * c2 * s3;this._z = c1 * c2 * s3 + s1 * s2 * c3;this._w = c1 * c2 * c3 + s1 * s2 * s3;}if(update !== false)this.onChangeCallback();return this;},setFromAxisAngle:function setFromAxisAngle(axis,angle){ // http://www.euclideanspace.com/maths/geometry/rotations/conversions/angleToQuaternion/index.htm\n\t// assumes axis is normalized\n\tvar halfAngle=angle / 2,s=Math.sin(halfAngle);this._x = axis.x * s;this._y = axis.y * s;this._z = axis.z * s;this._w = Math.cos(halfAngle);this.onChangeCallback();return this;},setFromRotationMatrix:function setFromRotationMatrix(m){ // http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToQuaternion/index.htm\n\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n\tvar te=m.elements,m11=te[0],m12=te[4],m13=te[8],m21=te[1],m22=te[5],m23=te[9],m31=te[2],m32=te[6],m33=te[10],trace=m11 + m22 + m33,s;if(trace > 0){s = 0.5 / Math.sqrt(trace + 1.0);this._w = 0.25 / s;this._x = (m32 - m23) * s;this._y = (m13 - m31) * s;this._z = (m21 - m12) * s;}else if(m11 > m22 && m11 > m33){s = 2.0 * Math.sqrt(1.0 + m11 - m22 - m33);this._w = (m32 - m23) / s;this._x = 0.25 * s;this._y = (m12 + m21) / s;this._z = (m13 + m31) / s;}else if(m22 > m33){s = 2.0 * Math.sqrt(1.0 + m22 - m11 - m33);this._w = (m13 - m31) / s;this._x = (m12 + m21) / s;this._y = 0.25 * s;this._z = (m23 + m32) / s;}else {s = 2.0 * Math.sqrt(1.0 + m33 - m11 - m22);this._w = (m21 - m12) / s;this._x = (m13 + m31) / s;this._y = (m23 + m32) / s;this._z = 0.25 * s;}this.onChangeCallback();return this;},setFromUnitVectors:(function(){ // http://lolengine.net/blog/2014/02/24/quaternion-from-two-vectors-final\n\t// assumes direction vectors vFrom and vTo are normalized\n\tvar v1,r;var EPS=0.000001;return function(vFrom,vTo){if(v1 === undefined)v1 = new THREE.Vector3();r = vFrom.dot(vTo) + 1;if(r < EPS){r = 0;if(Math.abs(vFrom.x) > Math.abs(vFrom.z)){v1.set(-vFrom.y,vFrom.x,0);}else {v1.set(0,-vFrom.z,vFrom.y);}}else {v1.crossVectors(vFrom,vTo);}this._x = v1.x;this._y = v1.y;this._z = v1.z;this._w = r;this.normalize();return this;};})(),inverse:function inverse(){this.conjugate().normalize();return this;},conjugate:function conjugate(){this._x *= -1;this._y *= -1;this._z *= -1;this.onChangeCallback();return this;},dot:function dot(v){return this._x * v._x + this._y * v._y + this._z * v._z + this._w * v._w;},lengthSq:function lengthSq(){return this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w;},length:function length(){return Math.sqrt(this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w);},normalize:function normalize(){var l=this.length();if(l === 0){this._x = 0;this._y = 0;this._z = 0;this._w = 1;}else {l = 1 / l;this._x = this._x * l;this._y = this._y * l;this._z = this._z * l;this._w = this._w * l;}this.onChangeCallback();return this;},multiply:function multiply(q,p){if(p !== undefined){console.warn('THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead.');return this.multiplyQuaternions(q,p);}return this.multiplyQuaternions(this,q);},multiplyQuaternions:function multiplyQuaternions(a,b){ // from http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/code/index.htm\n\tvar qax=a._x,qay=a._y,qaz=a._z,qaw=a._w;var qbx=b._x,qby=b._y,qbz=b._z,qbw=b._w;this._x = qax * qbw + qaw * qbx + qay * qbz - qaz * qby;this._y = qay * qbw + qaw * qby + qaz * qbx - qax * qbz;this._z = qaz * qbw + qaw * qbz + qax * qby - qay * qbx;this._w = qaw * qbw - qax * qbx - qay * qby - qaz * qbz;this.onChangeCallback();return this;},multiplyVector3:function multiplyVector3(vector){console.warn('THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.');return vector.applyQuaternion(this);},slerp:function slerp(qb,t){if(t === 0)return this;if(t === 1)return this.copy(qb);var x=this._x,y=this._y,z=this._z,w=this._w; // http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/slerp/\n\tvar cosHalfTheta=w * qb._w + x * qb._x + y * qb._y + z * qb._z;if(cosHalfTheta < 0){this._w = -qb._w;this._x = -qb._x;this._y = -qb._y;this._z = -qb._z;cosHalfTheta = -cosHalfTheta;}else {this.copy(qb);}if(cosHalfTheta >= 1.0){this._w = w;this._x = x;this._y = y;this._z = z;return this;}var halfTheta=Math.acos(cosHalfTheta);var sinHalfTheta=Math.sqrt(1.0 - cosHalfTheta * cosHalfTheta);if(Math.abs(sinHalfTheta) < 0.001){this._w = 0.5 * (w + this._w);this._x = 0.5 * (x + this._x);this._y = 0.5 * (y + this._y);this._z = 0.5 * (z + this._z);return this;}var ratioA=Math.sin((1 - t) * halfTheta) / sinHalfTheta,ratioB=Math.sin(t * halfTheta) / sinHalfTheta;this._w = w * ratioA + this._w * ratioB;this._x = x * ratioA + this._x * ratioB;this._y = y * ratioA + this._y * ratioB;this._z = z * ratioA + this._z * ratioB;this.onChangeCallback();return this;},equals:function equals(quaternion){return quaternion._x === this._x && quaternion._y === this._y && quaternion._z === this._z && quaternion._w === this._w;},fromArray:function fromArray(array,offset){if(offset === undefined)offset = 0;this._x = array[offset];this._y = array[offset + 1];this._z = array[offset + 2];this._w = array[offset + 3];this.onChangeCallback();return this;},toArray:function toArray(array,offset){if(array === undefined)array = [];if(offset === undefined)offset = 0;array[offset] = this._x;array[offset + 1] = this._y;array[offset + 2] = this._z;array[offset + 3] = this._w;return array;},onChange:function onChange(callback){this.onChangeCallback = callback;return this;},onChangeCallback:function onChangeCallback(){}},{x:{get:function get(){return this._x;},set:function set(value){this._x = value;this.onChangeCallback();},configurable:true,enumerable:true},y:{get:function get(){return this._y;},set:function set(value){this._y = value;this.onChangeCallback();},configurable:true,enumerable:true},z:{get:function get(){return this._z;},set:function set(value){this._z = value;this.onChangeCallback();},configurable:true,enumerable:true},w:{get:function get(){return this._w;},set:function set(value){this._w = value;this.onChangeCallback();},configurable:true,enumerable:true}});THREE.Quaternion.slerp = function(qa,qb,qm,t){return qm.copy(qa).slerp(qb,t);}; // File:src/math/Vector2.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author philogb / http://blog.thejit.org/\n\t * @author egraether / http://egraether.com/\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\n\t */THREE.Vector2 = function(x,y){this.x = x || 0;this.y = y || 0;};THREE.Vector2.prototype = {constructor:THREE.Vector2,set:function set(x,y){this.x = x;this.y = y;return this;},setX:function setX(x){this.x = x;return this;},setY:function setY(y){this.y = y;return this;},setComponent:function setComponent(index,value){switch(index){case 0:this.x = value;break;case 1:this.y = value;break;default:throw new Error('index is out of range: ' + index);}},getComponent:function getComponent(index){switch(index){case 0:return this.x;case 1:return this.y;default:throw new Error('index is out of range: ' + index);}},clone:function clone(){return new this.constructor(this.x,this.y);},copy:function copy(v){this.x = v.x;this.y = v.y;return this;},add:function add(v,w){if(w !== undefined){console.warn('THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead.');return this.addVectors(v,w);}this.x += v.x;this.y += v.y;return this;},addScalar:function addScalar(s){this.x += s;this.y += s;return this;},addVectors:function addVectors(a,b){this.x = a.x + b.x;this.y = a.y + b.y;return this;},addScaledVector:function addScaledVector(v,s){this.x += v.x * s;this.y += v.y * s;return this;},sub:function sub(v,w){if(w !== undefined){console.warn('THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.');return this.subVectors(v,w);}this.x -= v.x;this.y -= v.y;return this;},subScalar:function subScalar(s){this.x -= s;this.y -= s;return this;},subVectors:function subVectors(a,b){this.x = a.x - b.x;this.y = a.y - b.y;return this;},multiply:function multiply(v){this.x *= v.x;this.y *= v.y;return this;},multiplyScalar:function multiplyScalar(s){this.x *= s;this.y *= s;return this;},divide:function divide(v){this.x /= v.x;this.y /= v.y;return this;},divideScalar:function divideScalar(scalar){if(scalar !== 0){var invScalar=1 / scalar;this.x *= invScalar;this.y *= invScalar;}else {this.x = 0;this.y = 0;}return this;},min:function min(v){if(this.x > v.x){this.x = v.x;}if(this.y > v.y){this.y = v.y;}return this;},max:function max(v){if(this.x < v.x){this.x = v.x;}if(this.y < v.y){this.y = v.y;}return this;},clamp:function clamp(min,max){ // This function assumes min < max, if this assumption isn't true it will not operate correctly\n\tif(this.x < min.x){this.x = min.x;}else if(this.x > max.x){this.x = max.x;}if(this.y < min.y){this.y = min.y;}else if(this.y > max.y){this.y = max.y;}return this;},clampScalar:(function(){var min,max;return function clampScalar(minVal,maxVal){if(min === undefined){min = new THREE.Vector2();max = new THREE.Vector2();}min.set(minVal,minVal);max.set(maxVal,maxVal);return this.clamp(min,max);};})(),floor:function floor(){this.x = Math.floor(this.x);this.y = Math.floor(this.y);return this;},ceil:function ceil(){this.x = Math.ceil(this.x);this.y = Math.ceil(this.y);return this;},round:function round(){this.x = Math.round(this.x);this.y = Math.round(this.y);return this;},roundToZero:function roundToZero(){this.x = this.x < 0?Math.ceil(this.x):Math.floor(this.x);this.y = this.y < 0?Math.ceil(this.y):Math.floor(this.y);return this;},negate:function negate(){this.x = -this.x;this.y = -this.y;return this;},dot:function dot(v){return this.x * v.x + this.y * v.y;},lengthSq:function lengthSq(){return this.x * this.x + this.y * this.y;},length:function length(){return Math.sqrt(this.x * this.x + this.y * this.y);},lengthManhattan:function lengthManhattan(){return Math.abs(this.x) + Math.abs(this.y);},normalize:function normalize(){return this.divideScalar(this.length());},distanceTo:function distanceTo(v){return Math.sqrt(this.distanceToSquared(v));},distanceToSquared:function distanceToSquared(v){var dx=this.x - v.x,dy=this.y - v.y;return dx * dx + dy * dy;},setLength:function setLength(l){var oldLength=this.length();if(oldLength !== 0 && l !== oldLength){this.multiplyScalar(l / oldLength);}return this;},lerp:function lerp(v,alpha){this.x += (v.x - this.x) * alpha;this.y += (v.y - this.y) * alpha;return this;},lerpVectors:function lerpVectors(v1,v2,alpha){this.subVectors(v2,v1).multiplyScalar(alpha).add(v1);return this;},equals:function equals(v){return v.x === this.x && v.y === this.y;},fromArray:function fromArray(array,offset){if(offset === undefined)offset = 0;this.x = array[offset];this.y = array[offset + 1];return this;},toArray:function toArray(array,offset){if(array === undefined)array = [];if(offset === undefined)offset = 0;array[offset] = this.x;array[offset + 1] = this.y;return array;},fromAttribute:function fromAttribute(attribute,index,offset){if(offset === undefined)offset = 0;index = index * attribute.itemSize + offset;this.x = attribute.array[index];this.y = attribute.array[index + 1];return this;}}; // File:src/math/Vector3.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author *kile / http://kile.stravaganza.org/\n\t * @author philogb / http://blog.thejit.org/\n\t * @author mikael emtinger / http://gomo.se/\n\t * @author egraether / http://egraether.com/\n\t * @author WestLangley / http://github.com/WestLangley\n\t */THREE.Vector3 = function(x,y,z){this.x = x || 0;this.y = y || 0;this.z = z || 0;};THREE.Vector3.prototype = {constructor:THREE.Vector3,set:function set(x,y,z){this.x = x;this.y = y;this.z = z;return this;},setX:function setX(x){this.x = x;return this;},setY:function setY(y){this.y = y;return this;},setZ:function setZ(z){this.z = z;return this;},setComponent:function setComponent(index,value){switch(index){case 0:this.x = value;break;case 1:this.y = value;break;case 2:this.z = value;break;default:throw new Error('index is out of range: ' + index);}},getComponent:function getComponent(index){switch(index){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error('index is out of range: ' + index);}},clone:function clone(){return new this.constructor(this.x,this.y,this.z);},copy:function copy(v){this.x = v.x;this.y = v.y;this.z = v.z;return this;},add:function add(v,w){if(w !== undefined){console.warn('THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead.');return this.addVectors(v,w);}this.x += v.x;this.y += v.y;this.z += v.z;return this;},addScalar:function addScalar(s){this.x += s;this.y += s;this.z += s;return this;},addVectors:function addVectors(a,b){this.x = a.x + b.x;this.y = a.y + b.y;this.z = a.z + b.z;return this;},addScaledVector:function addScaledVector(v,s){this.x += v.x * s;this.y += v.y * s;this.z += v.z * s;return this;},sub:function sub(v,w){if(w !== undefined){console.warn('THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.');return this.subVectors(v,w);}this.x -= v.x;this.y -= v.y;this.z -= v.z;return this;},subScalar:function subScalar(s){this.x -= s;this.y -= s;this.z -= s;return this;},subVectors:function subVectors(a,b){this.x = a.x - b.x;this.y = a.y - b.y;this.z = a.z - b.z;return this;},multiply:function multiply(v,w){if(w !== undefined){console.warn('THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead.');return this.multiplyVectors(v,w);}this.x *= v.x;this.y *= v.y;this.z *= v.z;return this;},multiplyScalar:function multiplyScalar(scalar){this.x *= scalar;this.y *= scalar;this.z *= scalar;return this;},multiplyVectors:function multiplyVectors(a,b){this.x = a.x * b.x;this.y = a.y * b.y;this.z = a.z * b.z;return this;},applyEuler:(function(){var quaternion;return function applyEuler(euler){if(euler instanceof THREE.Euler === false){console.error('THREE.Vector3: .applyEuler() now expects a Euler rotation rather than a Vector3 and order.');}if(quaternion === undefined)quaternion = new THREE.Quaternion();this.applyQuaternion(quaternion.setFromEuler(euler));return this;};})(),applyAxisAngle:(function(){var quaternion;return function applyAxisAngle(axis,angle){if(quaternion === undefined)quaternion = new THREE.Quaternion();this.applyQuaternion(quaternion.setFromAxisAngle(axis,angle));return this;};})(),applyMatrix3:function applyMatrix3(m){var x=this.x;var y=this.y;var z=this.z;var e=m.elements;this.x = e[0] * x + e[3] * y + e[6] * z;this.y = e[1] * x + e[4] * y + e[7] * z;this.z = e[2] * x + e[5] * y + e[8] * z;return this;},applyMatrix4:function applyMatrix4(m){ // input: THREE.Matrix4 affine matrix\n\tvar x=this.x,y=this.y,z=this.z;var e=m.elements;this.x = e[0] * x + e[4] * y + e[8] * z + e[12];this.y = e[1] * x + e[5] * y + e[9] * z + e[13];this.z = e[2] * x + e[6] * y + e[10] * z + e[14];return this;},applyProjection:function applyProjection(m){ // input: THREE.Matrix4 projection matrix\n\tvar x=this.x,y=this.y,z=this.z;var e=m.elements;var d=1 / (e[3] * x + e[7] * y + e[11] * z + e[15]); // perspective divide\n\tthis.x = (e[0] * x + e[4] * y + e[8] * z + e[12]) * d;this.y = (e[1] * x + e[5] * y + e[9] * z + e[13]) * d;this.z = (e[2] * x + e[6] * y + e[10] * z + e[14]) * d;return this;},applyQuaternion:function applyQuaternion(q){var x=this.x;var y=this.y;var z=this.z;var qx=q.x;var qy=q.y;var qz=q.z;var qw=q.w; // calculate quat * vector\n\tvar ix=qw * x + qy * z - qz * y;var iy=qw * y + qz * x - qx * z;var iz=qw * z + qx * y - qy * x;var iw=-qx * x - qy * y - qz * z; // calculate result * inverse quat\n\tthis.x = ix * qw + iw * -qx + iy * -qz - iz * -qy;this.y = iy * qw + iw * -qy + iz * -qx - ix * -qz;this.z = iz * qw + iw * -qz + ix * -qy - iy * -qx;return this;},project:(function(){var matrix;return function project(camera){if(matrix === undefined)matrix = new THREE.Matrix4();matrix.multiplyMatrices(camera.projectionMatrix,matrix.getInverse(camera.matrixWorld));return this.applyProjection(matrix);};})(),unproject:(function(){var matrix;return function unproject(camera){if(matrix === undefined)matrix = new THREE.Matrix4();matrix.multiplyMatrices(camera.matrixWorld,matrix.getInverse(camera.projectionMatrix));return this.applyProjection(matrix);};})(),transformDirection:function transformDirection(m){ // input: THREE.Matrix4 affine matrix\n\t// vector interpreted as a direction\n\tvar x=this.x,y=this.y,z=this.z;var e=m.elements;this.x = e[0] * x + e[4] * y + e[8] * z;this.y = e[1] * x + e[5] * y + e[9] * z;this.z = e[2] * x + e[6] * y + e[10] * z;this.normalize();return this;},divide:function divide(v){this.x /= v.x;this.y /= v.y;this.z /= v.z;return this;},divideScalar:function divideScalar(scalar){if(scalar !== 0){var invScalar=1 / scalar;this.x *= invScalar;this.y *= invScalar;this.z *= invScalar;}else {this.x = 0;this.y = 0;this.z = 0;}return this;},min:function min(v){if(this.x > v.x){this.x = v.x;}if(this.y > v.y){this.y = v.y;}if(this.z > v.z){this.z = v.z;}return this;},max:function max(v){if(this.x < v.x){this.x = v.x;}if(this.y < v.y){this.y = v.y;}if(this.z < v.z){this.z = v.z;}return this;},clamp:function clamp(min,max){ // This function assumes min < max, if this assumption isn't true it will not operate correctly\n\tif(this.x < min.x){this.x = min.x;}else if(this.x > max.x){this.x = max.x;}if(this.y < min.y){this.y = min.y;}else if(this.y > max.y){this.y = max.y;}if(this.z < min.z){this.z = min.z;}else if(this.z > max.z){this.z = max.z;}return this;},clampScalar:(function(){var min,max;return function clampScalar(minVal,maxVal){if(min === undefined){min = new THREE.Vector3();max = new THREE.Vector3();}min.set(minVal,minVal,minVal);max.set(maxVal,maxVal,maxVal);return this.clamp(min,max);};})(),floor:function floor(){this.x = Math.floor(this.x);this.y = Math.floor(this.y);this.z = Math.floor(this.z);return this;},ceil:function ceil(){this.x = Math.ceil(this.x);this.y = Math.ceil(this.y);this.z = Math.ceil(this.z);return this;},round:function round(){this.x = Math.round(this.x);this.y = Math.round(this.y);this.z = Math.round(this.z);return this;},roundToZero:function roundToZero(){this.x = this.x < 0?Math.ceil(this.x):Math.floor(this.x);this.y = this.y < 0?Math.ceil(this.y):Math.floor(this.y);this.z = this.z < 0?Math.ceil(this.z):Math.floor(this.z);return this;},negate:function negate(){this.x = -this.x;this.y = -this.y;this.z = -this.z;return this;},dot:function dot(v){return this.x * v.x + this.y * v.y + this.z * v.z;},lengthSq:function lengthSq(){return this.x * this.x + this.y * this.y + this.z * this.z;},length:function length(){return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z);},lengthManhattan:function lengthManhattan(){return Math.abs(this.x) + Math.abs(this.y) + Math.abs(this.z);},normalize:function normalize(){return this.divideScalar(this.length());},setLength:function setLength(l){var oldLength=this.length();if(oldLength !== 0 && l !== oldLength){this.multiplyScalar(l / oldLength);}return this;},lerp:function lerp(v,alpha){this.x += (v.x - this.x) * alpha;this.y += (v.y - this.y) * alpha;this.z += (v.z - this.z) * alpha;return this;},lerpVectors:function lerpVectors(v1,v2,alpha){this.subVectors(v2,v1).multiplyScalar(alpha).add(v1);return this;},cross:function cross(v,w){if(w !== undefined){console.warn('THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead.');return this.crossVectors(v,w);}var x=this.x,y=this.y,z=this.z;this.x = y * v.z - z * v.y;this.y = z * v.x - x * v.z;this.z = x * v.y - y * v.x;return this;},crossVectors:function crossVectors(a,b){var ax=a.x,ay=a.y,az=a.z;var bx=b.x,by=b.y,bz=b.z;this.x = ay * bz - az * by;this.y = az * bx - ax * bz;this.z = ax * by - ay * bx;return this;},projectOnVector:(function(){var v1,dot;return function projectOnVector(vector){if(v1 === undefined)v1 = new THREE.Vector3();v1.copy(vector).normalize();dot = this.dot(v1);return this.copy(v1).multiplyScalar(dot);};})(),projectOnPlane:(function(){var v1;return function projectOnPlane(planeNormal){if(v1 === undefined)v1 = new THREE.Vector3();v1.copy(this).projectOnVector(planeNormal);return this.sub(v1);};})(),reflect:(function(){ // reflect incident vector off plane orthogonal to normal\n\t// normal is assumed to have unit length\n\tvar v1;return function reflect(normal){if(v1 === undefined)v1 = new THREE.Vector3();return this.sub(v1.copy(normal).multiplyScalar(2 * this.dot(normal)));};})(),angleTo:function angleTo(v){var theta=this.dot(v) / (this.length() * v.length()); // clamp, to handle numerical problems\n\treturn Math.acos(THREE.Math.clamp(theta,-1,1));},distanceTo:function distanceTo(v){return Math.sqrt(this.distanceToSquared(v));},distanceToSquared:function distanceToSquared(v){var dx=this.x - v.x;var dy=this.y - v.y;var dz=this.z - v.z;return dx * dx + dy * dy + dz * dz;},setEulerFromRotationMatrix:function setEulerFromRotationMatrix(m,order){console.error('THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.');},setEulerFromQuaternion:function setEulerFromQuaternion(q,order){console.error('THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.');},getPositionFromMatrix:function getPositionFromMatrix(m){console.warn('THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition().');return this.setFromMatrixPosition(m);},getScaleFromMatrix:function getScaleFromMatrix(m){console.warn('THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale().');return this.setFromMatrixScale(m);},getColumnFromMatrix:function getColumnFromMatrix(index,matrix){console.warn('THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn().');return this.setFromMatrixColumn(index,matrix);},setFromMatrixPosition:function setFromMatrixPosition(m){this.x = m.elements[12];this.y = m.elements[13];this.z = m.elements[14];return this;},setFromMatrixScale:function setFromMatrixScale(m){var sx=this.set(m.elements[0],m.elements[1],m.elements[2]).length();var sy=this.set(m.elements[4],m.elements[5],m.elements[6]).length();var sz=this.set(m.elements[8],m.elements[9],m.elements[10]).length();this.x = sx;this.y = sy;this.z = sz;return this;},setFromMatrixColumn:function setFromMatrixColumn(index,matrix){var offset=index * 4;var me=matrix.elements;this.x = me[offset];this.y = me[offset + 1];this.z = me[offset + 2];return this;},equals:function equals(v){return v.x === this.x && v.y === this.y && v.z === this.z;},fromArray:function fromArray(array,offset){if(offset === undefined)offset = 0;this.x = array[offset];this.y = array[offset + 1];this.z = array[offset + 2];return this;},toArray:function toArray(array,offset){if(array === undefined)array = [];if(offset === undefined)offset = 0;array[offset] = this.x;array[offset + 1] = this.y;array[offset + 2] = this.z;return array;},fromAttribute:function fromAttribute(attribute,index,offset){if(offset === undefined)offset = 0;index = index * attribute.itemSize + offset;this.x = attribute.array[index];this.y = attribute.array[index + 1];this.z = attribute.array[index + 2];return this;}}; // File:src/math/Vector4.js\n\t/**\n\t * @author supereggbert / http://www.paulbrunt.co.uk/\n\t * @author philogb / http://blog.thejit.org/\n\t * @author mikael emtinger / http://gomo.se/\n\t * @author egraether / http://egraether.com/\n\t * @author WestLangley / http://github.com/WestLangley\n\t */THREE.Vector4 = function(x,y,z,w){this.x = x || 0;this.y = y || 0;this.z = z || 0;this.w = w !== undefined?w:1;};THREE.Vector4.prototype = {constructor:THREE.Vector4,set:function set(x,y,z,w){this.x = x;this.y = y;this.z = z;this.w = w;return this;},setX:function setX(x){this.x = x;return this;},setY:function setY(y){this.y = y;return this;},setZ:function setZ(z){this.z = z;return this;},setW:function setW(w){this.w = w;return this;},setComponent:function setComponent(index,value){switch(index){case 0:this.x = value;break;case 1:this.y = value;break;case 2:this.z = value;break;case 3:this.w = value;break;default:throw new Error('index is out of range: ' + index);}},getComponent:function getComponent(index){switch(index){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error('index is out of range: ' + index);}},clone:function clone(){return new this.constructor(this.x,this.y,this.z,this.w);},copy:function copy(v){this.x = v.x;this.y = v.y;this.z = v.z;this.w = v.w !== undefined?v.w:1;return this;},add:function add(v,w){if(w !== undefined){console.warn('THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead.');return this.addVectors(v,w);}this.x += v.x;this.y += v.y;this.z += v.z;this.w += v.w;return this;},addScalar:function addScalar(s){this.x += s;this.y += s;this.z += s;this.w += s;return this;},addVectors:function addVectors(a,b){this.x = a.x + b.x;this.y = a.y + b.y;this.z = a.z + b.z;this.w = a.w + b.w;return this;},addScaledVector:function addScaledVector(v,s){this.x += v.x * s;this.y += v.y * s;this.z += v.z * s;this.w += v.w * s;return this;},sub:function sub(v,w){if(w !== undefined){console.warn('THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.');return this.subVectors(v,w);}this.x -= v.x;this.y -= v.y;this.z -= v.z;this.w -= v.w;return this;},subScalar:function subScalar(s){this.x -= s;this.y -= s;this.z -= s;this.w -= s;return this;},subVectors:function subVectors(a,b){this.x = a.x - b.x;this.y = a.y - b.y;this.z = a.z - b.z;this.w = a.w - b.w;return this;},multiplyScalar:function multiplyScalar(scalar){this.x *= scalar;this.y *= scalar;this.z *= scalar;this.w *= scalar;return this;},applyMatrix4:function applyMatrix4(m){var x=this.x;var y=this.y;var z=this.z;var w=this.w;var e=m.elements;this.x = e[0] * x + e[4] * y + e[8] * z + e[12] * w;this.y = e[1] * x + e[5] * y + e[9] * z + e[13] * w;this.z = e[2] * x + e[6] * y + e[10] * z + e[14] * w;this.w = e[3] * x + e[7] * y + e[11] * z + e[15] * w;return this;},divideScalar:function divideScalar(scalar){if(scalar !== 0){var invScalar=1 / scalar;this.x *= invScalar;this.y *= invScalar;this.z *= invScalar;this.w *= invScalar;}else {this.x = 0;this.y = 0;this.z = 0;this.w = 1;}return this;},setAxisAngleFromQuaternion:function setAxisAngleFromQuaternion(q){ // http://www.euclideanspace.com/maths/geometry/rotations/conversions/quaternionToAngle/index.htm\n\t// q is assumed to be normalized\n\tthis.w = 2 * Math.acos(q.w);var s=Math.sqrt(1 - q.w * q.w);if(s < 0.0001){this.x = 1;this.y = 0;this.z = 0;}else {this.x = q.x / s;this.y = q.y / s;this.z = q.z / s;}return this;},setAxisAngleFromRotationMatrix:function setAxisAngleFromRotationMatrix(m){ // http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToAngle/index.htm\n\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n\tvar angle,x,y,z, // variables for result\n\tepsilon=0.01, // margin to allow for rounding errors\n\tepsilon2=0.1, // margin to distinguish between 0 and 180 degrees\n\tte=m.elements,m11=te[0],m12=te[4],m13=te[8],m21=te[1],m22=te[5],m23=te[9],m31=te[2],m32=te[6],m33=te[10];if(Math.abs(m12 - m21) < epsilon && Math.abs(m13 - m31) < epsilon && Math.abs(m23 - m32) < epsilon){ // singularity found\n\t// first check for identity matrix which must have +1 for all terms\n\t// in leading diagonal and zero in other terms\n\tif(Math.abs(m12 + m21) < epsilon2 && Math.abs(m13 + m31) < epsilon2 && Math.abs(m23 + m32) < epsilon2 && Math.abs(m11 + m22 + m33 - 3) < epsilon2){ // this singularity is identity matrix so angle = 0\n\tthis.set(1,0,0,0);return this; // zero angle, arbitrary axis\n\t} // otherwise this singularity is angle = 180\n\tangle = Math.PI;var xx=(m11 + 1) / 2;var yy=(m22 + 1) / 2;var zz=(m33 + 1) / 2;var xy=(m12 + m21) / 4;var xz=(m13 + m31) / 4;var yz=(m23 + m32) / 4;if(xx > yy && xx > zz){ // m11 is the largest diagonal term\n\tif(xx < epsilon){x = 0;y = 0.707106781;z = 0.707106781;}else {x = Math.sqrt(xx);y = xy / x;z = xz / x;}}else if(yy > zz){ // m22 is the largest diagonal term\n\tif(yy < epsilon){x = 0.707106781;y = 0;z = 0.707106781;}else {y = Math.sqrt(yy);x = xy / y;z = yz / y;}}else { // m33 is the largest diagonal term so base result on this\n\tif(zz < epsilon){x = 0.707106781;y = 0.707106781;z = 0;}else {z = Math.sqrt(zz);x = xz / z;y = yz / z;}}this.set(x,y,z,angle);return this; // return 180 deg rotation\n\t} // as we have reached here there are no singularities so we can handle normally\n\tvar s=Math.sqrt((m32 - m23) * (m32 - m23) + (m13 - m31) * (m13 - m31) + (m21 - m12) * (m21 - m12)); // used to normalize\n\tif(Math.abs(s) < 0.001)s = 1; // prevent divide by zero, should not happen if matrix is orthogonal and should be\n\t// caught by singularity test above, but I've left it in just in case\n\tthis.x = (m32 - m23) / s;this.y = (m13 - m31) / s;this.z = (m21 - m12) / s;this.w = Math.acos((m11 + m22 + m33 - 1) / 2);return this;},min:function min(v){if(this.x > v.x){this.x = v.x;}if(this.y > v.y){this.y = v.y;}if(this.z > v.z){this.z = v.z;}if(this.w > v.w){this.w = v.w;}return this;},max:function max(v){if(this.x < v.x){this.x = v.x;}if(this.y < v.y){this.y = v.y;}if(this.z < v.z){this.z = v.z;}if(this.w < v.w){this.w = v.w;}return this;},clamp:function clamp(min,max){ // This function assumes min < max, if this assumption isn't true it will not operate correctly\n\tif(this.x < min.x){this.x = min.x;}else if(this.x > max.x){this.x = max.x;}if(this.y < min.y){this.y = min.y;}else if(this.y > max.y){this.y = max.y;}if(this.z < min.z){this.z = min.z;}else if(this.z > max.z){this.z = max.z;}if(this.w < min.w){this.w = min.w;}else if(this.w > max.w){this.w = max.w;}return this;},clampScalar:(function(){var min,max;return function clampScalar(minVal,maxVal){if(min === undefined){min = new THREE.Vector4();max = new THREE.Vector4();}min.set(minVal,minVal,minVal,minVal);max.set(maxVal,maxVal,maxVal,maxVal);return this.clamp(min,max);};})(),floor:function floor(){this.x = Math.floor(this.x);this.y = Math.floor(this.y);this.z = Math.floor(this.z);this.w = Math.floor(this.w);return this;},ceil:function ceil(){this.x = Math.ceil(this.x);this.y = Math.ceil(this.y);this.z = Math.ceil(this.z);this.w = Math.ceil(this.w);return this;},round:function round(){this.x = Math.round(this.x);this.y = Math.round(this.y);this.z = Math.round(this.z);this.w = Math.round(this.w);return this;},roundToZero:function roundToZero(){this.x = this.x < 0?Math.ceil(this.x):Math.floor(this.x);this.y = this.y < 0?Math.ceil(this.y):Math.floor(this.y);this.z = this.z < 0?Math.ceil(this.z):Math.floor(this.z);this.w = this.w < 0?Math.ceil(this.w):Math.floor(this.w);return this;},negate:function negate(){this.x = -this.x;this.y = -this.y;this.z = -this.z;this.w = -this.w;return this;},dot:function dot(v){return this.x * v.x + this.y * v.y + this.z * v.z + this.w * v.w;},lengthSq:function lengthSq(){return this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w;},length:function length(){return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w);},lengthManhattan:function lengthManhattan(){return Math.abs(this.x) + Math.abs(this.y) + Math.abs(this.z) + Math.abs(this.w);},normalize:function normalize(){return this.divideScalar(this.length());},setLength:function setLength(l){var oldLength=this.length();if(oldLength !== 0 && l !== oldLength){this.multiplyScalar(l / oldLength);}return this;},lerp:function lerp(v,alpha){this.x += (v.x - this.x) * alpha;this.y += (v.y - this.y) * alpha;this.z += (v.z - this.z) * alpha;this.w += (v.w - this.w) * alpha;return this;},lerpVectors:function lerpVectors(v1,v2,alpha){this.subVectors(v2,v1).multiplyScalar(alpha).add(v1);return this;},equals:function equals(v){return v.x === this.x && v.y === this.y && v.z === this.z && v.w === this.w;},fromArray:function fromArray(array,offset){if(offset === undefined)offset = 0;this.x = array[offset];this.y = array[offset + 1];this.z = array[offset + 2];this.w = array[offset + 3];return this;},toArray:function toArray(array,offset){if(array === undefined)array = [];if(offset === undefined)offset = 0;array[offset] = this.x;array[offset + 1] = this.y;array[offset + 2] = this.z;array[offset + 3] = this.w;return array;},fromAttribute:function fromAttribute(attribute,index,offset){if(offset === undefined)offset = 0;index = index * attribute.itemSize + offset;this.x = attribute.array[index];this.y = attribute.array[index + 1];this.z = attribute.array[index + 2];this.w = attribute.array[index + 3];return this;}}; // File:src/math/Euler.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author WestLangley / http://github.com/WestLangley\n\t * @author bhouston / http://exocortex.com\n\t */THREE.Euler = function(x,y,z,order){this._x = x || 0;this._y = y || 0;this._z = z || 0;this._order = order || THREE.Euler.DefaultOrder;};THREE.Euler.RotationOrders = ['XYZ','YZX','ZXY','XZY','YXZ','ZYX'];THREE.Euler.DefaultOrder = 'XYZ';THREE.Euler.prototype = _Object$defineProperties({constructor:THREE.Euler,set:function set(x,y,z,order){this._x = x;this._y = y;this._z = z;this._order = order || this._order;this.onChangeCallback();return this;},clone:function clone(){return new this.constructor(this._x,this._y,this._z,this._order);},copy:function copy(euler){this._x = euler._x;this._y = euler._y;this._z = euler._z;this._order = euler._order;this.onChangeCallback();return this;},setFromRotationMatrix:function setFromRotationMatrix(m,order,update){var clamp=THREE.Math.clamp; // assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n\tvar te=m.elements;var m11=te[0],m12=te[4],m13=te[8];var m21=te[1],m22=te[5],m23=te[9];var m31=te[2],m32=te[6],m33=te[10];order = order || this._order;if(order === 'XYZ'){this._y = Math.asin(clamp(m13,-1,1));if(Math.abs(m13) < 0.99999){this._x = Math.atan2(-m23,m33);this._z = Math.atan2(-m12,m11);}else {this._x = Math.atan2(m32,m22);this._z = 0;}}else if(order === 'YXZ'){this._x = Math.asin(-clamp(m23,-1,1));if(Math.abs(m23) < 0.99999){this._y = Math.atan2(m13,m33);this._z = Math.atan2(m21,m22);}else {this._y = Math.atan2(-m31,m11);this._z = 0;}}else if(order === 'ZXY'){this._x = Math.asin(clamp(m32,-1,1));if(Math.abs(m32) < 0.99999){this._y = Math.atan2(-m31,m33);this._z = Math.atan2(-m12,m22);}else {this._y = 0;this._z = Math.atan2(m21,m11);}}else if(order === 'ZYX'){this._y = Math.asin(-clamp(m31,-1,1));if(Math.abs(m31) < 0.99999){this._x = Math.atan2(m32,m33);this._z = Math.atan2(m21,m11);}else {this._x = 0;this._z = Math.atan2(-m12,m22);}}else if(order === 'YZX'){this._z = Math.asin(clamp(m21,-1,1));if(Math.abs(m21) < 0.99999){this._x = Math.atan2(-m23,m22);this._y = Math.atan2(-m31,m11);}else {this._x = 0;this._y = Math.atan2(m13,m33);}}else if(order === 'XZY'){this._z = Math.asin(-clamp(m12,-1,1));if(Math.abs(m12) < 0.99999){this._x = Math.atan2(m32,m22);this._y = Math.atan2(m13,m11);}else {this._x = Math.atan2(-m23,m33);this._y = 0;}}else {console.warn('THREE.Euler: .setFromRotationMatrix() given unsupported order: ' + order);}this._order = order;if(update !== false)this.onChangeCallback();return this;},setFromQuaternion:(function(){var matrix;return function(q,order,update){if(matrix === undefined)matrix = new THREE.Matrix4();matrix.makeRotationFromQuaternion(q);this.setFromRotationMatrix(matrix,order,update);return this;};})(),setFromVector3:function setFromVector3(v,order){return this.set(v.x,v.y,v.z,order || this._order);},reorder:(function(){ // WARNING: this discards revolution information -bhouston\n\tvar q=new THREE.Quaternion();return function(newOrder){q.setFromEuler(this);this.setFromQuaternion(q,newOrder);};})(),equals:function equals(euler){return euler._x === this._x && euler._y === this._y && euler._z === this._z && euler._order === this._order;},fromArray:function fromArray(array){this._x = array[0];this._y = array[1];this._z = array[2];if(array[3] !== undefined)this._order = array[3];this.onChangeCallback();return this;},toArray:function toArray(array,offset){if(array === undefined)array = [];if(offset === undefined)offset = 0;array[offset] = this._x;array[offset + 1] = this._y;array[offset + 2] = this._z;array[offset + 3] = this._order;return array;},toVector3:function toVector3(optionalResult){if(optionalResult){return optionalResult.set(this._x,this._y,this._z);}else {return new THREE.Vector3(this._x,this._y,this._z);}},onChange:function onChange(callback){this.onChangeCallback = callback;return this;},onChangeCallback:function onChangeCallback(){}},{x:{get:function get(){return this._x;},set:function set(value){this._x = value;this.onChangeCallback();},configurable:true,enumerable:true},y:{get:function get(){return this._y;},set:function set(value){this._y = value;this.onChangeCallback();},configurable:true,enumerable:true},z:{get:function get(){return this._z;},set:function set(value){this._z = value;this.onChangeCallback();},configurable:true,enumerable:true},order:{get:function get(){return this._order;},set:function set(value){this._order = value;this.onChangeCallback();},configurable:true,enumerable:true}}); // File:src/math/Line3.js\n\t/**\n\t * @author bhouston / http://exocortex.com\n\t */THREE.Line3 = function(start,end){this.start = start !== undefined?start:new THREE.Vector3();this.end = end !== undefined?end:new THREE.Vector3();};THREE.Line3.prototype = {constructor:THREE.Line3,set:function set(start,end){this.start.copy(start);this.end.copy(end);return this;},clone:function clone(){return new this.constructor().copy(this);},copy:function copy(line){this.start.copy(line.start);this.end.copy(line.end);return this;},center:function center(optionalTarget){var result=optionalTarget || new THREE.Vector3();return result.addVectors(this.start,this.end).multiplyScalar(0.5);},delta:function delta(optionalTarget){var result=optionalTarget || new THREE.Vector3();return result.subVectors(this.end,this.start);},distanceSq:function distanceSq(){return this.start.distanceToSquared(this.end);},distance:function distance(){return this.start.distanceTo(this.end);},at:function at(t,optionalTarget){var result=optionalTarget || new THREE.Vector3();return this.delta(result).multiplyScalar(t).add(this.start);},closestPointToPointParameter:(function(){var startP=new THREE.Vector3();var startEnd=new THREE.Vector3();return function(point,clampToLine){startP.subVectors(point,this.start);startEnd.subVectors(this.end,this.start);var startEnd2=startEnd.dot(startEnd);var startEnd_startP=startEnd.dot(startP);var t=startEnd_startP / startEnd2;if(clampToLine){t = THREE.Math.clamp(t,0,1);}return t;};})(),closestPointToPoint:function closestPointToPoint(point,clampToLine,optionalTarget){var t=this.closestPointToPointParameter(point,clampToLine);var result=optionalTarget || new THREE.Vector3();return this.delta(result).multiplyScalar(t).add(this.start);},applyMatrix4:function applyMatrix4(matrix){this.start.applyMatrix4(matrix);this.end.applyMatrix4(matrix);return this;},equals:function equals(line){return line.start.equals(this.start) && line.end.equals(this.end);}}; // File:src/math/Box2.js\n\t/**\n\t * @author bhouston / http://exocortex.com\n\t */THREE.Box2 = function(min,max){this.min = min !== undefined?min:new THREE.Vector2(Infinity,Infinity);this.max = max !== undefined?max:new THREE.Vector2(-Infinity,-Infinity);};THREE.Box2.prototype = {constructor:THREE.Box2,set:function set(min,max){this.min.copy(min);this.max.copy(max);return this;},setFromPoints:function setFromPoints(points){this.makeEmpty();for(var i=0,il=points.length;i < il;i++) {this.expandByPoint(points[i]);}return this;},setFromCenterAndSize:(function(){var v1=new THREE.Vector2();return function(center,size){var halfSize=v1.copy(size).multiplyScalar(0.5);this.min.copy(center).sub(halfSize);this.max.copy(center).add(halfSize);return this;};})(),clone:function clone(){return new this.constructor().copy(this);},copy:function copy(box){this.min.copy(box.min);this.max.copy(box.max);return this;},makeEmpty:function makeEmpty(){this.min.x = this.min.y = Infinity;this.max.x = this.max.y = -Infinity;return this;},empty:function empty(){ // this is a more robust check for empty than ( volume <= 0 ) because volume can get positive with two negative axes\n\treturn this.max.x < this.min.x || this.max.y < this.min.y;},center:function center(optionalTarget){var result=optionalTarget || new THREE.Vector2();return result.addVectors(this.min,this.max).multiplyScalar(0.5);},size:function size(optionalTarget){var result=optionalTarget || new THREE.Vector2();return result.subVectors(this.max,this.min);},expandByPoint:function expandByPoint(point){this.min.min(point);this.max.max(point);return this;},expandByVector:function expandByVector(vector){this.min.sub(vector);this.max.add(vector);return this;},expandByScalar:function expandByScalar(scalar){this.min.addScalar(-scalar);this.max.addScalar(scalar);return this;},containsPoint:function containsPoint(point){if(point.x < this.min.x || point.x > this.max.x || point.y < this.min.y || point.y > this.max.y){return false;}return true;},containsBox:function containsBox(box){if(this.min.x <= box.min.x && box.max.x <= this.max.x && this.min.y <= box.min.y && box.max.y <= this.max.y){return true;}return false;},getParameter:function getParameter(point,optionalTarget){ // This can potentially have a divide by zero if the box\n\t// has a size dimension of 0.\n\tvar result=optionalTarget || new THREE.Vector2();return result.set((point.x - this.min.x) / (this.max.x - this.min.x),(point.y - this.min.y) / (this.max.y - this.min.y));},isIntersectionBox:function isIntersectionBox(box){ // using 6 splitting planes to rule out intersections.\n\tif(box.max.x < this.min.x || box.min.x > this.max.x || box.max.y < this.min.y || box.min.y > this.max.y){return false;}return true;},clampPoint:function clampPoint(point,optionalTarget){var result=optionalTarget || new THREE.Vector2();return result.copy(point).clamp(this.min,this.max);},distanceToPoint:(function(){var v1=new THREE.Vector2();return function(point){var clampedPoint=v1.copy(point).clamp(this.min,this.max);return clampedPoint.sub(point).length();};})(),intersect:function intersect(box){this.min.max(box.min);this.max.min(box.max);return this;},union:function union(box){this.min.min(box.min);this.max.max(box.max);return this;},translate:function translate(offset){this.min.add(offset);this.max.add(offset);return this;},equals:function equals(box){return box.min.equals(this.min) && box.max.equals(this.max);}}; // File:src/math/Box3.js\n\t/**\n\t * @author bhouston / http://exocortex.com\n\t * @author WestLangley / http://github.com/WestLangley\n\t */THREE.Box3 = function(min,max){this.min = min !== undefined?min:new THREE.Vector3(Infinity,Infinity,Infinity);this.max = max !== undefined?max:new THREE.Vector3(-Infinity,-Infinity,-Infinity);};THREE.Box3.prototype = {constructor:THREE.Box3,set:function set(min,max){this.min.copy(min);this.max.copy(max);return this;},setFromPoints:function setFromPoints(points){this.makeEmpty();for(var i=0,il=points.length;i < il;i++) {this.expandByPoint(points[i]);}return this;},setFromCenterAndSize:(function(){var v1=new THREE.Vector3();return function(center,size){var halfSize=v1.copy(size).multiplyScalar(0.5);this.min.copy(center).sub(halfSize);this.max.copy(center).add(halfSize);return this;};})(),setFromObject:(function(){ // Computes the world-axis-aligned bounding box of an object (including its children),\n\t// accounting for both the object's, and children's, world transforms\n\tvar v1=new THREE.Vector3();return function(object){var scope=this;object.updateMatrixWorld(true);this.makeEmpty();object.traverse(function(node){var geometry=node.geometry;if(geometry !== undefined){if(geometry instanceof THREE.Geometry){var vertices=geometry.vertices;for(var i=0,il=vertices.length;i < il;i++) {v1.copy(vertices[i]);v1.applyMatrix4(node.matrixWorld);scope.expandByPoint(v1);}}else if(geometry instanceof THREE.BufferGeometry && geometry.attributes['position'] !== undefined){var positions=geometry.attributes['position'].array;for(var i=0,il=positions.length;i < il;i += 3) {v1.set(positions[i],positions[i + 1],positions[i + 2]);v1.applyMatrix4(node.matrixWorld);scope.expandByPoint(v1);}}}});return this;};})(),clone:function clone(){return new this.constructor().copy(this);},copy:function copy(box){this.min.copy(box.min);this.max.copy(box.max);return this;},makeEmpty:function makeEmpty(){this.min.x = this.min.y = this.min.z = Infinity;this.max.x = this.max.y = this.max.z = -Infinity;return this;},empty:function empty(){ // this is a more robust check for empty than ( volume <= 0 ) because volume can get positive with two negative axes\n\treturn this.max.x < this.min.x || this.max.y < this.min.y || this.max.z < this.min.z;},center:function center(optionalTarget){var result=optionalTarget || new THREE.Vector3();return result.addVectors(this.min,this.max).multiplyScalar(0.5);},size:function size(optionalTarget){var result=optionalTarget || new THREE.Vector3();return result.subVectors(this.max,this.min);},expandByPoint:function expandByPoint(point){this.min.min(point);this.max.max(point);return this;},expandByVector:function expandByVector(vector){this.min.sub(vector);this.max.add(vector);return this;},expandByScalar:function expandByScalar(scalar){this.min.addScalar(-scalar);this.max.addScalar(scalar);return this;},containsPoint:function containsPoint(point){if(point.x < this.min.x || point.x > this.max.x || point.y < this.min.y || point.y > this.max.y || point.z < this.min.z || point.z > this.max.z){return false;}return true;},containsBox:function containsBox(box){if(this.min.x <= box.min.x && box.max.x <= this.max.x && this.min.y <= box.min.y && box.max.y <= this.max.y && this.min.z <= box.min.z && box.max.z <= this.max.z){return true;}return false;},getParameter:function getParameter(point,optionalTarget){ // This can potentially have a divide by zero if the box\n\t// has a size dimension of 0.\n\tvar result=optionalTarget || new THREE.Vector3();return result.set((point.x - this.min.x) / (this.max.x - this.min.x),(point.y - this.min.y) / (this.max.y - this.min.y),(point.z - this.min.z) / (this.max.z - this.min.z));},isIntersectionBox:function isIntersectionBox(box){ // using 6 splitting planes to rule out intersections.\n\tif(box.max.x < this.min.x || box.min.x > this.max.x || box.max.y < this.min.y || box.min.y > this.max.y || box.max.z < this.min.z || box.min.z > this.max.z){return false;}return true;},clampPoint:function clampPoint(point,optionalTarget){var result=optionalTarget || new THREE.Vector3();return result.copy(point).clamp(this.min,this.max);},distanceToPoint:(function(){var v1=new THREE.Vector3();return function(point){var clampedPoint=v1.copy(point).clamp(this.min,this.max);return clampedPoint.sub(point).length();};})(),getBoundingSphere:(function(){var v1=new THREE.Vector3();return function(optionalTarget){var result=optionalTarget || new THREE.Sphere();result.center = this.center();result.radius = this.size(v1).length() * 0.5;return result;};})(),intersect:function intersect(box){this.min.max(box.min);this.max.min(box.max);return this;},union:function union(box){this.min.min(box.min);this.max.max(box.max);return this;},applyMatrix4:(function(){var points=[new THREE.Vector3(),new THREE.Vector3(),new THREE.Vector3(),new THREE.Vector3(),new THREE.Vector3(),new THREE.Vector3(),new THREE.Vector3(),new THREE.Vector3()];return function(matrix){ // NOTE: I am using a binary pattern to specify all 2^3 combinations below\n\tpoints[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(matrix); // 000\n\tpoints[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(matrix); // 001\n\tpoints[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(matrix); // 010\n\tpoints[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(matrix); // 011\n\tpoints[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(matrix); // 100\n\tpoints[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(matrix); // 101\n\tpoints[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(matrix); // 110\n\tpoints[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(matrix); // 111\n\tthis.makeEmpty();this.setFromPoints(points);return this;};})(),translate:function translate(offset){this.min.add(offset);this.max.add(offset);return this;},equals:function equals(box){return box.min.equals(this.min) && box.max.equals(this.max);}}; // File:src/math/Matrix3.js\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author WestLangley / http://github.com/WestLangley\n\t * @author bhouston / http://exocortex.com\n\t */THREE.Matrix3 = function(){this.elements = new Float32Array([1,0,0,0,1,0,0,0,1]);if(arguments.length > 0){console.error('THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.');}};THREE.Matrix3.prototype = {constructor:THREE.Matrix3,set:function set(n11,n12,n13,n21,n22,n23,n31,n32,n33){var te=this.elements;te[0] = n11;te[3] = n12;te[6] = n13;te[1] = n21;te[4] = n22;te[7] = n23;te[2] = n31;te[5] = n32;te[8] = n33;return this;},identity:function identity(){this.set(1,0,0,0,1,0,0,0,1);return this;},clone:function clone(){return new this.constructor().fromArray(this.elements);},copy:function copy(m){var me=m.elements;this.set(me[0],me[3],me[6],me[1],me[4],me[7],me[2],me[5],me[8]);return this;},multiplyVector3:function multiplyVector3(vector){console.warn('THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.');return vector.applyMatrix3(this);},multiplyVector3Array:function multiplyVector3Array(a){console.warn('THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.');return this.applyToVector3Array(a);},applyToVector3Array:(function(){var v1;return function(array,offset,length){if(v1 === undefined)v1 = new THREE.Vector3();if(offset === undefined)offset = 0;if(length === undefined)length = array.length;for(var i=0,j=offset;i < length;i += 3,j += 3) {v1.fromArray(array,j);v1.applyMatrix3(this);v1.toArray(array,j);}return array;};})(),applyToBuffer:(function(){var v1;return function applyToBuffer(buffer,offset,length){if(v1 === undefined)v1 = new THREE.Vector3();if(offset === undefined)offset = 0;if(length === undefined)length = buffer.length / buffer.itemSize;for(var i=0,j=offset;i < length;i++,j++) {v1.x = buffer.getX(j);v1.y = buffer.getY(j);v1.z = buffer.getZ(j);v1.applyMatrix3(this);buffer.setXYZ(v1.x,v1.y,v1.z);}return buffer;};})(),multiplyScalar:function multiplyScalar(s){var te=this.elements;te[0] *= s;te[3] *= s;te[6] *= s;te[1] *= s;te[4] *= s;te[7] *= s;te[2] *= s;te[5] *= s;te[8] *= s;return this;},determinant:function determinant(){var te=this.elements;var a=te[0],b=te[1],c=te[2],d=te[3],e=te[4],f=te[5],g=te[6],h=te[7],i=te[8];return a * e * i - a * f * h - b * d * i + b * f * g + c * d * h - c * e * g;},getInverse:function getInverse(matrix,throwOnInvertible){ // input: THREE.Matrix4\n\t// ( based on http://code.google.com/p/webgl-mjs/ )\n\tvar me=matrix.elements;var te=this.elements;te[0] = me[10] * me[5] - me[6] * me[9];te[1] = -me[10] * me[1] + me[2] * me[9];te[2] = me[6] * me[1] - me[2] * me[5];te[3] = -me[10] * me[4] + me[6] * me[8];te[4] = me[10] * me[0] - me[2] * me[8];te[5] = -me[6] * me[0] + me[2] * me[4];te[6] = me[9] * me[4] - me[5] * me[8];te[7] = -me[9] * me[0] + me[1] * me[8];te[8] = me[5] * me[0] - me[1] * me[4];var det=me[0] * te[0] + me[1] * te[3] + me[2] * te[6]; // no inverse\n\tif(det === 0){var msg=\"Matrix3.getInverse(): can't invert matrix, determinant is 0\";if(throwOnInvertible || false){throw new Error(msg);}else {console.warn(msg);}this.identity();return this;}this.multiplyScalar(1.0 / det);return this;},transpose:function transpose(){var tmp,m=this.elements;tmp = m[1];m[1] = m[3];m[3] = tmp;tmp = m[2];m[2] = m[6];m[6] = tmp;tmp = m[5];m[5] = m[7];m[7] = tmp;return this;},flattenToArrayOffset:function flattenToArrayOffset(array,offset){var te=this.elements;array[offset] = te[0];array[offset + 1] = te[1];array[offset + 2] = te[2];array[offset + 3] = te[3];array[offset + 4] = te[4];array[offset + 5] = te[5];array[offset + 6] = te[6];array[offset + 7] = te[7];array[offset + 8] = te[8];return array;},getNormalMatrix:function getNormalMatrix(m){ // input: THREE.Matrix4\n\tthis.getInverse(m).transpose();return this;},transposeIntoArray:function transposeIntoArray(r){var m=this.elements;r[0] = m[0];r[1] = m[3];r[2] = m[6];r[3] = m[1];r[4] = m[4];r[5] = m[7];r[6] = m[2];r[7] = m[5];r[8] = m[8];return this;},fromArray:function fromArray(array){this.elements.set(array);return this;},toArray:function toArray(){var te=this.elements;return [te[0],te[1],te[2],te[3],te[4],te[5],te[6],te[7],te[8]];}}; // File:src/math/Matrix4.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author supereggbert / http://www.paulbrunt.co.uk/\n\t * @author philogb / http://blog.thejit.org/\n\t * @author jordi_ros / http://plattsoft.com\n\t * @author D1plo1d / http://github.com/D1plo1d\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author mikael emtinger / http://gomo.se/\n\t * @author timknip / http://www.floorplanner.com/\n\t * @author bhouston / http://exocortex.com\n\t * @author WestLangley / http://github.com/WestLangley\n\t */THREE.Matrix4 = function(){this.elements = new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);if(arguments.length > 0){console.error('THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.');}};THREE.Matrix4.prototype = {constructor:THREE.Matrix4,set:function set(n11,n12,n13,n14,n21,n22,n23,n24,n31,n32,n33,n34,n41,n42,n43,n44){var te=this.elements;te[0] = n11;te[4] = n12;te[8] = n13;te[12] = n14;te[1] = n21;te[5] = n22;te[9] = n23;te[13] = n24;te[2] = n31;te[6] = n32;te[10] = n33;te[14] = n34;te[3] = n41;te[7] = n42;te[11] = n43;te[15] = n44;return this;},identity:function identity(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this;},clone:function clone(){return new THREE.Matrix4().fromArray(this.elements);},copy:function copy(m){this.elements.set(m.elements);return this;},extractPosition:function extractPosition(m){console.warn('THREE.Matrix4: .extractPosition() has been renamed to .copyPosition().');return this.copyPosition(m);},copyPosition:function copyPosition(m){var te=this.elements;var me=m.elements;te[12] = me[12];te[13] = me[13];te[14] = me[14];return this;},extractBasis:function extractBasis(xAxis,yAxis,zAxis){var te=this.elements;xAxis.set(te[0],te[1],te[2]);yAxis.set(te[4],te[5],te[6]);zAxis.set(te[8],te[9],te[10]);return this;},makeBasis:function makeBasis(xAxis,yAxis,zAxis){this.set(xAxis.x,yAxis.x,zAxis.x,0,xAxis.y,yAxis.y,zAxis.y,0,xAxis.z,yAxis.z,zAxis.z,0,0,0,0,1);return this;},extractRotation:(function(){var v1;return function(m){if(v1 === undefined)v1 = new THREE.Vector3();var te=this.elements;var me=m.elements;var scaleX=1 / v1.set(me[0],me[1],me[2]).length();var scaleY=1 / v1.set(me[4],me[5],me[6]).length();var scaleZ=1 / v1.set(me[8],me[9],me[10]).length();te[0] = me[0] * scaleX;te[1] = me[1] * scaleX;te[2] = me[2] * scaleX;te[4] = me[4] * scaleY;te[5] = me[5] * scaleY;te[6] = me[6] * scaleY;te[8] = me[8] * scaleZ;te[9] = me[9] * scaleZ;te[10] = me[10] * scaleZ;return this;};})(),makeRotationFromEuler:function makeRotationFromEuler(euler){if(euler instanceof THREE.Euler === false){console.error('THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.');}var te=this.elements;var x=euler.x,y=euler.y,z=euler.z;var a=Math.cos(x),b=Math.sin(x);var c=Math.cos(y),d=Math.sin(y);var e=Math.cos(z),f=Math.sin(z);if(euler.order === 'XYZ'){var ae=a * e,af=a * f,be=b * e,bf=b * f;te[0] = c * e;te[4] = -c * f;te[8] = d;te[1] = af + be * d;te[5] = ae - bf * d;te[9] = -b * c;te[2] = bf - ae * d;te[6] = be + af * d;te[10] = a * c;}else if(euler.order === 'YXZ'){var ce=c * e,cf=c * f,de=d * e,df=d * f;te[0] = ce + df * b;te[4] = de * b - cf;te[8] = a * d;te[1] = a * f;te[5] = a * e;te[9] = -b;te[2] = cf * b - de;te[6] = df + ce * b;te[10] = a * c;}else if(euler.order === 'ZXY'){var ce=c * e,cf=c * f,de=d * e,df=d * f;te[0] = ce - df * b;te[4] = -a * f;te[8] = de + cf * b;te[1] = cf + de * b;te[5] = a * e;te[9] = df - ce * b;te[2] = -a * d;te[6] = b;te[10] = a * c;}else if(euler.order === 'ZYX'){var ae=a * e,af=a * f,be=b * e,bf=b * f;te[0] = c * e;te[4] = be * d - af;te[8] = ae * d + bf;te[1] = c * f;te[5] = bf * d + ae;te[9] = af * d - be;te[2] = -d;te[6] = b * c;te[10] = a * c;}else if(euler.order === 'YZX'){var ac=a * c,ad=a * d,bc=b * c,bd=b * d;te[0] = c * e;te[4] = bd - ac * f;te[8] = bc * f + ad;te[1] = f;te[5] = a * e;te[9] = -b * e;te[2] = -d * e;te[6] = ad * f + bc;te[10] = ac - bd * f;}else if(euler.order === 'XZY'){var ac=a * c,ad=a * d,bc=b * c,bd=b * d;te[0] = c * e;te[4] = -f;te[8] = d * e;te[1] = ac * f + bd;te[5] = a * e;te[9] = ad * f - bc;te[2] = bc * f - ad;te[6] = b * e;te[10] = bd * f + ac;} // last column\n\tte[3] = 0;te[7] = 0;te[11] = 0; // bottom row\n\tte[12] = 0;te[13] = 0;te[14] = 0;te[15] = 1;return this;},setRotationFromQuaternion:function setRotationFromQuaternion(q){console.warn('THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion().');return this.makeRotationFromQuaternion(q);},makeRotationFromQuaternion:function makeRotationFromQuaternion(q){var te=this.elements;var x=q.x,y=q.y,z=q.z,w=q.w;var x2=x + x,y2=y + y,z2=z + z;var xx=x * x2,xy=x * y2,xz=x * z2;var yy=y * y2,yz=y * z2,zz=z * z2;var wx=w * x2,wy=w * y2,wz=w * z2;te[0] = 1 - (yy + zz);te[4] = xy - wz;te[8] = xz + wy;te[1] = xy + wz;te[5] = 1 - (xx + zz);te[9] = yz - wx;te[2] = xz - wy;te[6] = yz + wx;te[10] = 1 - (xx + yy); // last column\n\tte[3] = 0;te[7] = 0;te[11] = 0; // bottom row\n\tte[12] = 0;te[13] = 0;te[14] = 0;te[15] = 1;return this;},lookAt:(function(){var x,y,z;return function(eye,target,up){if(x === undefined)x = new THREE.Vector3();if(y === undefined)y = new THREE.Vector3();if(z === undefined)z = new THREE.Vector3();var te=this.elements;z.subVectors(eye,target).normalize();if(z.length() === 0){z.z = 1;}x.crossVectors(up,z).normalize();if(x.length() === 0){z.x += 0.0001;x.crossVectors(up,z).normalize();}y.crossVectors(z,x);te[0] = x.x;te[4] = y.x;te[8] = z.x;te[1] = x.y;te[5] = y.y;te[9] = z.y;te[2] = x.z;te[6] = y.z;te[10] = z.z;return this;};})(),multiply:function multiply(m,n){if(n !== undefined){console.warn('THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead.');return this.multiplyMatrices(m,n);}return this.multiplyMatrices(this,m);},multiplyMatrices:function multiplyMatrices(a,b){var ae=a.elements;var be=b.elements;var te=this.elements;var a11=ae[0],a12=ae[4],a13=ae[8],a14=ae[12];var a21=ae[1],a22=ae[5],a23=ae[9],a24=ae[13];var a31=ae[2],a32=ae[6],a33=ae[10],a34=ae[14];var a41=ae[3],a42=ae[7],a43=ae[11],a44=ae[15];var b11=be[0],b12=be[4],b13=be[8],b14=be[12];var b21=be[1],b22=be[5],b23=be[9],b24=be[13];var b31=be[2],b32=be[6],b33=be[10],b34=be[14];var b41=be[3],b42=be[7],b43=be[11],b44=be[15];te[0] = a11 * b11 + a12 * b21 + a13 * b31 + a14 * b41;te[4] = a11 * b12 + a12 * b22 + a13 * b32 + a14 * b42;te[8] = a11 * b13 + a12 * b23 + a13 * b33 + a14 * b43;te[12] = a11 * b14 + a12 * b24 + a13 * b34 + a14 * b44;te[1] = a21 * b11 + a22 * b21 + a23 * b31 + a24 * b41;te[5] = a21 * b12 + a22 * b22 + a23 * b32 + a24 * b42;te[9] = a21 * b13 + a22 * b23 + a23 * b33 + a24 * b43;te[13] = a21 * b14 + a22 * b24 + a23 * b34 + a24 * b44;te[2] = a31 * b11 + a32 * b21 + a33 * b31 + a34 * b41;te[6] = a31 * b12 + a32 * b22 + a33 * b32 + a34 * b42;te[10] = a31 * b13 + a32 * b23 + a33 * b33 + a34 * b43;te[14] = a31 * b14 + a32 * b24 + a33 * b34 + a34 * b44;te[3] = a41 * b11 + a42 * b21 + a43 * b31 + a44 * b41;te[7] = a41 * b12 + a42 * b22 + a43 * b32 + a44 * b42;te[11] = a41 * b13 + a42 * b23 + a43 * b33 + a44 * b43;te[15] = a41 * b14 + a42 * b24 + a43 * b34 + a44 * b44;return this;},multiplyToArray:function multiplyToArray(a,b,r){var te=this.elements;this.multiplyMatrices(a,b);r[0] = te[0];r[1] = te[1];r[2] = te[2];r[3] = te[3];r[4] = te[4];r[5] = te[5];r[6] = te[6];r[7] = te[7];r[8] = te[8];r[9] = te[9];r[10] = te[10];r[11] = te[11];r[12] = te[12];r[13] = te[13];r[14] = te[14];r[15] = te[15];return this;},multiplyScalar:function multiplyScalar(s){var te=this.elements;te[0] *= s;te[4] *= s;te[8] *= s;te[12] *= s;te[1] *= s;te[5] *= s;te[9] *= s;te[13] *= s;te[2] *= s;te[6] *= s;te[10] *= s;te[14] *= s;te[3] *= s;te[7] *= s;te[11] *= s;te[15] *= s;return this;},multiplyVector3:function multiplyVector3(vector){console.warn('THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead.');return vector.applyProjection(this);},multiplyVector4:function multiplyVector4(vector){console.warn('THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.');return vector.applyMatrix4(this);},multiplyVector3Array:function multiplyVector3Array(a){console.warn('THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.');return this.applyToVector3Array(a);},applyToVector3Array:(function(){var v1;return function(array,offset,length){if(v1 === undefined)v1 = new THREE.Vector3();if(offset === undefined)offset = 0;if(length === undefined)length = array.length;for(var i=0,j=offset;i < length;i += 3,j += 3) {v1.fromArray(array,j);v1.applyMatrix4(this);v1.toArray(array,j);}return array;};})(),applyToBuffer:(function(){var v1;return function applyToBuffer(buffer,offset,length){if(v1 === undefined)v1 = new THREE.Vector3();if(offset === undefined)offset = 0;if(length === undefined)length = buffer.length / buffer.itemSize;for(var i=0,j=offset;i < length;i++,j++) {v1.x = buffer.getX(j);v1.y = buffer.getY(j);v1.z = buffer.getZ(j);v1.applyMatrix4(this);buffer.setXYZ(v1.x,v1.y,v1.z);}return buffer;};})(),rotateAxis:function rotateAxis(v){console.warn('THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.');v.transformDirection(this);},crossVector:function crossVector(vector){console.warn('THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.');return vector.applyMatrix4(this);},determinant:function determinant(){var te=this.elements;var n11=te[0],n12=te[4],n13=te[8],n14=te[12];var n21=te[1],n22=te[5],n23=te[9],n24=te[13];var n31=te[2],n32=te[6],n33=te[10],n34=te[14];var n41=te[3],n42=te[7],n43=te[11],n44=te[15]; //TODO: make this more efficient\n\t//( based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm )\n\treturn n41 * (+n14 * n23 * n32 - n13 * n24 * n32 - n14 * n22 * n33 + n12 * n24 * n33 + n13 * n22 * n34 - n12 * n23 * n34) + n42 * (+n11 * n23 * n34 - n11 * n24 * n33 + n14 * n21 * n33 - n13 * n21 * n34 + n13 * n24 * n31 - n14 * n23 * n31) + n43 * (+n11 * n24 * n32 - n11 * n22 * n34 - n14 * n21 * n32 + n12 * n21 * n34 + n14 * n22 * n31 - n12 * n24 * n31) + n44 * (-n13 * n22 * n31 - n11 * n23 * n32 + n11 * n22 * n33 + n13 * n21 * n32 - n12 * n21 * n33 + n12 * n23 * n31);},transpose:function transpose(){var te=this.elements;var tmp;tmp = te[1];te[1] = te[4];te[4] = tmp;tmp = te[2];te[2] = te[8];te[8] = tmp;tmp = te[6];te[6] = te[9];te[9] = tmp;tmp = te[3];te[3] = te[12];te[12] = tmp;tmp = te[7];te[7] = te[13];te[13] = tmp;tmp = te[11];te[11] = te[14];te[14] = tmp;return this;},flattenToArrayOffset:function flattenToArrayOffset(array,offset){var te=this.elements;array[offset] = te[0];array[offset + 1] = te[1];array[offset + 2] = te[2];array[offset + 3] = te[3];array[offset + 4] = te[4];array[offset + 5] = te[5];array[offset + 6] = te[6];array[offset + 7] = te[7];array[offset + 8] = te[8];array[offset + 9] = te[9];array[offset + 10] = te[10];array[offset + 11] = te[11];array[offset + 12] = te[12];array[offset + 13] = te[13];array[offset + 14] = te[14];array[offset + 15] = te[15];return array;},getPosition:(function(){var v1;return function(){if(v1 === undefined)v1 = new THREE.Vector3();console.warn('THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.');var te=this.elements;return v1.set(te[12],te[13],te[14]);};})(),setPosition:function setPosition(v){var te=this.elements;te[12] = v.x;te[13] = v.y;te[14] = v.z;return this;},getInverse:function getInverse(m,throwOnInvertible){ // based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm\n\tvar te=this.elements;var me=m.elements;var n11=me[0],n12=me[4],n13=me[8],n14=me[12];var n21=me[1],n22=me[5],n23=me[9],n24=me[13];var n31=me[2],n32=me[6],n33=me[10],n34=me[14];var n41=me[3],n42=me[7],n43=me[11],n44=me[15];te[0] = n23 * n34 * n42 - n24 * n33 * n42 + n24 * n32 * n43 - n22 * n34 * n43 - n23 * n32 * n44 + n22 * n33 * n44;te[4] = n14 * n33 * n42 - n13 * n34 * n42 - n14 * n32 * n43 + n12 * n34 * n43 + n13 * n32 * n44 - n12 * n33 * n44;te[8] = n13 * n24 * n42 - n14 * n23 * n42 + n14 * n22 * n43 - n12 * n24 * n43 - n13 * n22 * n44 + n12 * n23 * n44;te[12] = n14 * n23 * n32 - n13 * n24 * n32 - n14 * n22 * n33 + n12 * n24 * n33 + n13 * n22 * n34 - n12 * n23 * n34;te[1] = n24 * n33 * n41 - n23 * n34 * n41 - n24 * n31 * n43 + n21 * n34 * n43 + n23 * n31 * n44 - n21 * n33 * n44;te[5] = n13 * n34 * n41 - n14 * n33 * n41 + n14 * n31 * n43 - n11 * n34 * n43 - n13 * n31 * n44 + n11 * n33 * n44;te[9] = n14 * n23 * n41 - n13 * n24 * n41 - n14 * n21 * n43 + n11 * n24 * n43 + n13 * n21 * n44 - n11 * n23 * n44;te[13] = n13 * n24 * n31 - n14 * n23 * n31 + n14 * n21 * n33 - n11 * n24 * n33 - n13 * n21 * n34 + n11 * n23 * n34;te[2] = n22 * n34 * n41 - n24 * n32 * n41 + n24 * n31 * n42 - n21 * n34 * n42 - n22 * n31 * n44 + n21 * n32 * n44;te[6] = n14 * n32 * n41 - n12 * n34 * n41 - n14 * n31 * n42 + n11 * n34 * n42 + n12 * n31 * n44 - n11 * n32 * n44;te[10] = n12 * n24 * n41 - n14 * n22 * n41 + n14 * n21 * n42 - n11 * n24 * n42 - n12 * n21 * n44 + n11 * n22 * n44;te[14] = n14 * n22 * n31 - n12 * n24 * n31 - n14 * n21 * n32 + n11 * n24 * n32 + n12 * n21 * n34 - n11 * n22 * n34;te[3] = n23 * n32 * n41 - n22 * n33 * n41 - n23 * n31 * n42 + n21 * n33 * n42 + n22 * n31 * n43 - n21 * n32 * n43;te[7] = n12 * n33 * n41 - n13 * n32 * n41 + n13 * n31 * n42 - n11 * n33 * n42 - n12 * n31 * n43 + n11 * n32 * n43;te[11] = n13 * n22 * n41 - n12 * n23 * n41 - n13 * n21 * n42 + n11 * n23 * n42 + n12 * n21 * n43 - n11 * n22 * n43;te[15] = n12 * n23 * n31 - n13 * n22 * n31 + n13 * n21 * n32 - n11 * n23 * n32 - n12 * n21 * n33 + n11 * n22 * n33;var det=n11 * te[0] + n21 * te[4] + n31 * te[8] + n41 * te[12];if(det === 0){var msg=\"THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0\";if(throwOnInvertible || false){throw new Error(msg);}else {console.warn(msg);}this.identity();return this;}this.multiplyScalar(1 / det);return this;},translate:function translate(v){console.error('THREE.Matrix4: .translate() has been removed.');},rotateX:function rotateX(angle){console.error('THREE.Matrix4: .rotateX() has been removed.');},rotateY:function rotateY(angle){console.error('THREE.Matrix4: .rotateY() has been removed.');},rotateZ:function rotateZ(angle){console.error('THREE.Matrix4: .rotateZ() has been removed.');},rotateByAxis:function rotateByAxis(axis,angle){console.error('THREE.Matrix4: .rotateByAxis() has been removed.');},scale:function scale(v){var te=this.elements;var x=v.x,y=v.y,z=v.z;te[0] *= x;te[4] *= y;te[8] *= z;te[1] *= x;te[5] *= y;te[9] *= z;te[2] *= x;te[6] *= y;te[10] *= z;te[3] *= x;te[7] *= y;te[11] *= z;return this;},getMaxScaleOnAxis:function getMaxScaleOnAxis(){var te=this.elements;var scaleXSq=te[0] * te[0] + te[1] * te[1] + te[2] * te[2];var scaleYSq=te[4] * te[4] + te[5] * te[5] + te[6] * te[6];var scaleZSq=te[8] * te[8] + te[9] * te[9] + te[10] * te[10];return Math.sqrt(Math.max(scaleXSq,Math.max(scaleYSq,scaleZSq)));},makeTranslation:function makeTranslation(x,y,z){this.set(1,0,0,x,0,1,0,y,0,0,1,z,0,0,0,1);return this;},makeRotationX:function makeRotationX(theta){var c=Math.cos(theta),s=Math.sin(theta);this.set(1,0,0,0,0,c,-s,0,0,s,c,0,0,0,0,1);return this;},makeRotationY:function makeRotationY(theta){var c=Math.cos(theta),s=Math.sin(theta);this.set(c,0,s,0,0,1,0,0,-s,0,c,0,0,0,0,1);return this;},makeRotationZ:function makeRotationZ(theta){var c=Math.cos(theta),s=Math.sin(theta);this.set(c,-s,0,0,s,c,0,0,0,0,1,0,0,0,0,1);return this;},makeRotationAxis:function makeRotationAxis(axis,angle){ // Based on http://www.gamedev.net/reference/articles/article1199.asp\n\tvar c=Math.cos(angle);var s=Math.sin(angle);var t=1 - c;var x=axis.x,y=axis.y,z=axis.z;var tx=t * x,ty=t * y;this.set(tx * x + c,tx * y - s * z,tx * z + s * y,0,tx * y + s * z,ty * y + c,ty * z - s * x,0,tx * z - s * y,ty * z + s * x,t * z * z + c,0,0,0,0,1);return this;},makeScale:function makeScale(x,y,z){this.set(x,0,0,0,0,y,0,0,0,0,z,0,0,0,0,1);return this;},compose:function compose(position,quaternion,scale){this.makeRotationFromQuaternion(quaternion);this.scale(scale);this.setPosition(position);return this;},decompose:(function(){var vector,matrix;return function(position,quaternion,scale){if(vector === undefined)vector = new THREE.Vector3();if(matrix === undefined)matrix = new THREE.Matrix4();var te=this.elements;var sx=vector.set(te[0],te[1],te[2]).length();var sy=vector.set(te[4],te[5],te[6]).length();var sz=vector.set(te[8],te[9],te[10]).length(); // if determine is negative, we need to invert one scale\n\tvar det=this.determinant();if(det < 0){sx = -sx;}position.x = te[12];position.y = te[13];position.z = te[14]; // scale the rotation part\n\tmatrix.elements.set(this.elements); // at this point matrix is incomplete so we can't use .copy()\n\tvar invSX=1 / sx;var invSY=1 / sy;var invSZ=1 / sz;matrix.elements[0] *= invSX;matrix.elements[1] *= invSX;matrix.elements[2] *= invSX;matrix.elements[4] *= invSY;matrix.elements[5] *= invSY;matrix.elements[6] *= invSY;matrix.elements[8] *= invSZ;matrix.elements[9] *= invSZ;matrix.elements[10] *= invSZ;quaternion.setFromRotationMatrix(matrix);scale.x = sx;scale.y = sy;scale.z = sz;return this;};})(),makeFrustum:function makeFrustum(left,right,bottom,top,near,far){var te=this.elements;var x=2 * near / (right - left);var y=2 * near / (top - bottom);var a=(right + left) / (right - left);var b=(top + bottom) / (top - bottom);var c=-(far + near) / (far - near);var d=-2 * far * near / (far - near);te[0] = x;te[4] = 0;te[8] = a;te[12] = 0;te[1] = 0;te[5] = y;te[9] = b;te[13] = 0;te[2] = 0;te[6] = 0;te[10] = c;te[14] = d;te[3] = 0;te[7] = 0;te[11] = -1;te[15] = 0;return this;},makePerspective:function makePerspective(fov,aspect,near,far){var ymax=near * Math.tan(THREE.Math.degToRad(fov * 0.5));var ymin=-ymax;var xmin=ymin * aspect;var xmax=ymax * aspect;return this.makeFrustum(xmin,xmax,ymin,ymax,near,far);},makeOrthographic:function makeOrthographic(left,right,top,bottom,near,far){var te=this.elements;var w=right - left;var h=top - bottom;var p=far - near;var x=(right + left) / w;var y=(top + bottom) / h;var z=(far + near) / p;te[0] = 2 / w;te[4] = 0;te[8] = 0;te[12] = -x;te[1] = 0;te[5] = 2 / h;te[9] = 0;te[13] = -y;te[2] = 0;te[6] = 0;te[10] = -2 / p;te[14] = -z;te[3] = 0;te[7] = 0;te[11] = 0;te[15] = 1;return this;},equals:function equals(matrix){var te=this.elements;var me=matrix.elements;for(var i=0;i < 16;i++) {if(te[i] !== me[i])return false;}return true;},fromArray:function fromArray(array){this.elements.set(array);return this;},toArray:function toArray(){var te=this.elements;return [te[0],te[1],te[2],te[3],te[4],te[5],te[6],te[7],te[8],te[9],te[10],te[11],te[12],te[13],te[14],te[15]];}}; // File:src/math/Ray.js\n\t/**\n\t * @author bhouston / http://exocortex.com\n\t */THREE.Ray = function(origin,direction){this.origin = origin !== undefined?origin:new THREE.Vector3();this.direction = direction !== undefined?direction:new THREE.Vector3();};THREE.Ray.prototype = {constructor:THREE.Ray,set:function set(origin,direction){this.origin.copy(origin);this.direction.copy(direction);return this;},clone:function clone(){return new this.constructor().copy(this);},copy:function copy(ray){this.origin.copy(ray.origin);this.direction.copy(ray.direction);return this;},at:function at(t,optionalTarget){var result=optionalTarget || new THREE.Vector3();return result.copy(this.direction).multiplyScalar(t).add(this.origin);},recast:(function(){var v1=new THREE.Vector3();return function(t){this.origin.copy(this.at(t,v1));return this;};})(),closestPointToPoint:function closestPointToPoint(point,optionalTarget){var result=optionalTarget || new THREE.Vector3();result.subVectors(point,this.origin);var directionDistance=result.dot(this.direction);if(directionDistance < 0){return result.copy(this.origin);}return result.copy(this.direction).multiplyScalar(directionDistance).add(this.origin);},distanceToPoint:function distanceToPoint(point){return Math.sqrt(this.distanceSqToPoint(point));},distanceSqToPoint:(function(){var v1=new THREE.Vector3();return function(point){var directionDistance=v1.subVectors(point,this.origin).dot(this.direction); // point behind the ray\n\tif(directionDistance < 0){return this.origin.distanceToSquared(point);}v1.copy(this.direction).multiplyScalar(directionDistance).add(this.origin);return v1.distanceToSquared(point);};})(),distanceSqToSegment:(function(){var segCenter=new THREE.Vector3();var segDir=new THREE.Vector3();var diff=new THREE.Vector3();return function(v0,v1,optionalPointOnRay,optionalPointOnSegment){ // from http://www.geometrictools.com/LibMathematics/Distance/Wm5DistRay3Segment3.cpp\n\t// It returns the min distance between the ray and the segment\n\t// defined by v0 and v1\n\t// It can also set two optional targets :\n\t// - The closest point on the ray\n\t// - The closest point on the segment\n\tsegCenter.copy(v0).add(v1).multiplyScalar(0.5);segDir.copy(v1).sub(v0).normalize();diff.copy(this.origin).sub(segCenter);var segExtent=v0.distanceTo(v1) * 0.5;var a01=-this.direction.dot(segDir);var b0=diff.dot(this.direction);var b1=-diff.dot(segDir);var c=diff.lengthSq();var det=Math.abs(1 - a01 * a01);var s0,s1,sqrDist,extDet;if(det > 0){ // The ray and segment are not parallel.\n\ts0 = a01 * b1 - b0;s1 = a01 * b0 - b1;extDet = segExtent * det;if(s0 >= 0){if(s1 >= -extDet){if(s1 <= extDet){ // region 0\n\t// Minimum at interior points of ray and segment.\n\tvar invDet=1 / det;s0 *= invDet;s1 *= invDet;sqrDist = s0 * (s0 + a01 * s1 + 2 * b0) + s1 * (a01 * s0 + s1 + 2 * b1) + c;}else { // region 1\n\ts1 = segExtent;s0 = Math.max(0,-(a01 * s1 + b0));sqrDist = -s0 * s0 + s1 * (s1 + 2 * b1) + c;}}else { // region 5\n\ts1 = -segExtent;s0 = Math.max(0,-(a01 * s1 + b0));sqrDist = -s0 * s0 + s1 * (s1 + 2 * b1) + c;}}else {if(s1 <= -extDet){ // region 4\n\ts0 = Math.max(0,-(-a01 * segExtent + b0));s1 = s0 > 0?-segExtent:Math.min(Math.max(-segExtent,-b1),segExtent);sqrDist = -s0 * s0 + s1 * (s1 + 2 * b1) + c;}else if(s1 <= extDet){ // region 3\n\ts0 = 0;s1 = Math.min(Math.max(-segExtent,-b1),segExtent);sqrDist = s1 * (s1 + 2 * b1) + c;}else { // region 2\n\ts0 = Math.max(0,-(a01 * segExtent + b0));s1 = s0 > 0?segExtent:Math.min(Math.max(-segExtent,-b1),segExtent);sqrDist = -s0 * s0 + s1 * (s1 + 2 * b1) + c;}}}else { // Ray and segment are parallel.\n\ts1 = a01 > 0?-segExtent:segExtent;s0 = Math.max(0,-(a01 * s1 + b0));sqrDist = -s0 * s0 + s1 * (s1 + 2 * b1) + c;}if(optionalPointOnRay){optionalPointOnRay.copy(this.direction).multiplyScalar(s0).add(this.origin);}if(optionalPointOnSegment){optionalPointOnSegment.copy(segDir).multiplyScalar(s1).add(segCenter);}return sqrDist;};})(),isIntersectionSphere:function isIntersectionSphere(sphere){return this.distanceToPoint(sphere.center) <= sphere.radius;},intersectSphere:(function(){ // from http://www.scratchapixel.com/lessons/3d-basic-lessons/lesson-7-intersecting-simple-shapes/ray-sphere-intersection/\n\tvar v1=new THREE.Vector3();return function(sphere,optionalTarget){v1.subVectors(sphere.center,this.origin);var tca=v1.dot(this.direction);var d2=v1.dot(v1) - tca * tca;var radius2=sphere.radius * sphere.radius;if(d2 > radius2)return null;var thc=Math.sqrt(radius2 - d2); // t0 = first intersect point - entrance on front of sphere\n\tvar t0=tca - thc; // t1 = second intersect point - exit point on back of sphere\n\tvar t1=tca + thc; // test to see if both t0 and t1 are behind the ray - if so, return null\n\tif(t0 < 0 && t1 < 0)return null; // test to see if t0 is behind the ray:\n\t// if it is, the ray is inside the sphere, so return the second exit point scaled by t1,\n\t// in order to always return an intersect point that is in front of the ray.\n\tif(t0 < 0)return this.at(t1,optionalTarget); // else t0 is in front of the ray, so return the first collision point scaled by t0\n\treturn this.at(t0,optionalTarget);};})(),isIntersectionPlane:function isIntersectionPlane(plane){ // check if the ray lies on the plane first\n\tvar distToPoint=plane.distanceToPoint(this.origin);if(distToPoint === 0){return true;}var denominator=plane.normal.dot(this.direction);if(denominator * distToPoint < 0){return true;} // ray origin is behind the plane (and is pointing behind it)\n\treturn false;},distanceToPlane:function distanceToPlane(plane){var denominator=plane.normal.dot(this.direction);if(denominator === 0){ // line is coplanar, return origin\n\tif(plane.distanceToPoint(this.origin) === 0){return 0;} // Null is preferable to undefined since undefined means.... it is undefined\n\treturn null;}var t=-(this.origin.dot(plane.normal) + plane.constant) / denominator; // Return if the ray never intersects the plane\n\treturn t >= 0?t:null;},intersectPlane:function intersectPlane(plane,optionalTarget){var t=this.distanceToPlane(plane);if(t === null){return null;}return this.at(t,optionalTarget);},isIntersectionBox:(function(){var v=new THREE.Vector3();return function(box){return this.intersectBox(box,v) !== null;};})(),intersectBox:function intersectBox(box,optionalTarget){ // http://www.scratchapixel.com/lessons/3d-basic-lessons/lesson-7-intersecting-simple-shapes/ray-box-intersection/\n\tvar tmin,tmax,tymin,tymax,tzmin,tzmax;var invdirx=1 / this.direction.x,invdiry=1 / this.direction.y,invdirz=1 / this.direction.z;var origin=this.origin;if(invdirx >= 0){tmin = (box.min.x - origin.x) * invdirx;tmax = (box.max.x - origin.x) * invdirx;}else {tmin = (box.max.x - origin.x) * invdirx;tmax = (box.min.x - origin.x) * invdirx;}if(invdiry >= 0){tymin = (box.min.y - origin.y) * invdiry;tymax = (box.max.y - origin.y) * invdiry;}else {tymin = (box.max.y - origin.y) * invdiry;tymax = (box.min.y - origin.y) * invdiry;}if(tmin > tymax || tymin > tmax)return null; // These lines also handle the case where tmin or tmax is NaN\n\t// (result of 0 * Infinity). x !== x returns true if x is NaN\n\tif(tymin > tmin || tmin !== tmin)tmin = tymin;if(tymax < tmax || tmax !== tmax)tmax = tymax;if(invdirz >= 0){tzmin = (box.min.z - origin.z) * invdirz;tzmax = (box.max.z - origin.z) * invdirz;}else {tzmin = (box.max.z - origin.z) * invdirz;tzmax = (box.min.z - origin.z) * invdirz;}if(tmin > tzmax || tzmin > tmax)return null;if(tzmin > tmin || tmin !== tmin)tmin = tzmin;if(tzmax < tmax || tmax !== tmax)tmax = tzmax; //return point closest to the ray (positive side)\n\tif(tmax < 0)return null;return this.at(tmin >= 0?tmin:tmax,optionalTarget);},intersectTriangle:(function(){ // Compute the offset origin, edges, and normal.\n\tvar diff=new THREE.Vector3();var edge1=new THREE.Vector3();var edge2=new THREE.Vector3();var normal=new THREE.Vector3();return function(a,b,c,backfaceCulling,optionalTarget){ // from http://www.geometrictools.com/LibMathematics/Intersection/Wm5IntrRay3Triangle3.cpp\n\tedge1.subVectors(b,a);edge2.subVectors(c,a);normal.crossVectors(edge1,edge2); // Solve Q + t*D = b1*E1 + b2*E2 (Q = kDiff, D = ray direction,\n\t// E1 = kEdge1, E2 = kEdge2, N = Cross(E1,E2)) by\n\t//   |Dot(D,N)|*b1 = sign(Dot(D,N))*Dot(D,Cross(Q,E2))\n\t//   |Dot(D,N)|*b2 = sign(Dot(D,N))*Dot(D,Cross(E1,Q))\n\t//   |Dot(D,N)|*t = -sign(Dot(D,N))*Dot(Q,N)\n\tvar DdN=this.direction.dot(normal);var sign;if(DdN > 0){if(backfaceCulling)return null;sign = 1;}else if(DdN < 0){sign = -1;DdN = -DdN;}else {return null;}diff.subVectors(this.origin,a);var DdQxE2=sign * this.direction.dot(edge2.crossVectors(diff,edge2)); // b1 < 0, no intersection\n\tif(DdQxE2 < 0){return null;}var DdE1xQ=sign * this.direction.dot(edge1.cross(diff)); // b2 < 0, no intersection\n\tif(DdE1xQ < 0){return null;} // b1+b2 > 1, no intersection\n\tif(DdQxE2 + DdE1xQ > DdN){return null;} // Line intersects triangle, check if ray does.\n\tvar QdN=-sign * diff.dot(normal); // t < 0, no intersection\n\tif(QdN < 0){return null;} // Ray intersects triangle.\n\treturn this.at(QdN / DdN,optionalTarget);};})(),applyMatrix4:function applyMatrix4(matrix4){this.direction.add(this.origin).applyMatrix4(matrix4);this.origin.applyMatrix4(matrix4);this.direction.sub(this.origin);this.direction.normalize();return this;},equals:function equals(ray){return ray.origin.equals(this.origin) && ray.direction.equals(this.direction);}}; // File:src/math/Sphere.js\n\t/**\n\t * @author bhouston / http://exocortex.com\n\t * @author mrdoob / http://mrdoob.com/\n\t */THREE.Sphere = function(center,radius){this.center = center !== undefined?center:new THREE.Vector3();this.radius = radius !== undefined?radius:0;};THREE.Sphere.prototype = {constructor:THREE.Sphere,set:function set(center,radius){this.center.copy(center);this.radius = radius;return this;},setFromPoints:(function(){var box=new THREE.Box3();return function(points,optionalCenter){var center=this.center;if(optionalCenter !== undefined){center.copy(optionalCenter);}else {box.setFromPoints(points).center(center);}var maxRadiusSq=0;for(var i=0,il=points.length;i < il;i++) {maxRadiusSq = Math.max(maxRadiusSq,center.distanceToSquared(points[i]));}this.radius = Math.sqrt(maxRadiusSq);return this;};})(),clone:function clone(){return new this.constructor().copy(this);},copy:function copy(sphere){this.center.copy(sphere.center);this.radius = sphere.radius;return this;},empty:function empty(){return this.radius <= 0;},containsPoint:function containsPoint(point){return point.distanceToSquared(this.center) <= this.radius * this.radius;},distanceToPoint:function distanceToPoint(point){return point.distanceTo(this.center) - this.radius;},intersectsSphere:function intersectsSphere(sphere){var radiusSum=this.radius + sphere.radius;return sphere.center.distanceToSquared(this.center) <= radiusSum * radiusSum;},clampPoint:function clampPoint(point,optionalTarget){var deltaLengthSq=this.center.distanceToSquared(point);var result=optionalTarget || new THREE.Vector3();result.copy(point);if(deltaLengthSq > this.radius * this.radius){result.sub(this.center).normalize();result.multiplyScalar(this.radius).add(this.center);}return result;},getBoundingBox:function getBoundingBox(optionalTarget){var box=optionalTarget || new THREE.Box3();box.set(this.center,this.center);box.expandByScalar(this.radius);return box;},applyMatrix4:function applyMatrix4(matrix){this.center.applyMatrix4(matrix);this.radius = this.radius * matrix.getMaxScaleOnAxis();return this;},translate:function translate(offset){this.center.add(offset);return this;},equals:function equals(sphere){return sphere.center.equals(this.center) && sphere.radius === this.radius;}}; // File:src/math/Frustum.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author bhouston / http://exocortex.com\n\t */THREE.Frustum = function(p0,p1,p2,p3,p4,p5){this.planes = [p0 !== undefined?p0:new THREE.Plane(),p1 !== undefined?p1:new THREE.Plane(),p2 !== undefined?p2:new THREE.Plane(),p3 !== undefined?p3:new THREE.Plane(),p4 !== undefined?p4:new THREE.Plane(),p5 !== undefined?p5:new THREE.Plane()];};THREE.Frustum.prototype = {constructor:THREE.Frustum,set:function set(p0,p1,p2,p3,p4,p5){var planes=this.planes;planes[0].copy(p0);planes[1].copy(p1);planes[2].copy(p2);planes[3].copy(p3);planes[4].copy(p4);planes[5].copy(p5);return this;},clone:function clone(){return new this.constructor().copy(this);},copy:function copy(frustum){var planes=this.planes;for(var i=0;i < 6;i++) {planes[i].copy(frustum.planes[i]);}return this;},setFromMatrix:function setFromMatrix(m){var planes=this.planes;var me=m.elements;var me0=me[0],me1=me[1],me2=me[2],me3=me[3];var me4=me[4],me5=me[5],me6=me[6],me7=me[7];var me8=me[8],me9=me[9],me10=me[10],me11=me[11];var me12=me[12],me13=me[13],me14=me[14],me15=me[15];planes[0].setComponents(me3 - me0,me7 - me4,me11 - me8,me15 - me12).normalize();planes[1].setComponents(me3 + me0,me7 + me4,me11 + me8,me15 + me12).normalize();planes[2].setComponents(me3 + me1,me7 + me5,me11 + me9,me15 + me13).normalize();planes[3].setComponents(me3 - me1,me7 - me5,me11 - me9,me15 - me13).normalize();planes[4].setComponents(me3 - me2,me7 - me6,me11 - me10,me15 - me14).normalize();planes[5].setComponents(me3 + me2,me7 + me6,me11 + me10,me15 + me14).normalize();return this;},intersectsObject:(function(){var sphere=new THREE.Sphere();return function(object){var geometry=object.geometry;if(geometry.boundingSphere === null)geometry.computeBoundingSphere();sphere.copy(geometry.boundingSphere);sphere.applyMatrix4(object.matrixWorld);return this.intersectsSphere(sphere);};})(),intersectsSphere:function intersectsSphere(sphere){var planes=this.planes;var center=sphere.center;var negRadius=-sphere.radius;for(var i=0;i < 6;i++) {var distance=planes[i].distanceToPoint(center);if(distance < negRadius){return false;}}return true;},intersectsBox:(function(){var p1=new THREE.Vector3(),p2=new THREE.Vector3();return function(box){var planes=this.planes;for(var i=0;i < 6;i++) {var plane=planes[i];p1.x = plane.normal.x > 0?box.min.x:box.max.x;p2.x = plane.normal.x > 0?box.max.x:box.min.x;p1.y = plane.normal.y > 0?box.min.y:box.max.y;p2.y = plane.normal.y > 0?box.max.y:box.min.y;p1.z = plane.normal.z > 0?box.min.z:box.max.z;p2.z = plane.normal.z > 0?box.max.z:box.min.z;var d1=plane.distanceToPoint(p1);var d2=plane.distanceToPoint(p2); // if both outside plane, no intersection\n\tif(d1 < 0 && d2 < 0){return false;}}return true;};})(),containsPoint:function containsPoint(point){var planes=this.planes;for(var i=0;i < 6;i++) {if(planes[i].distanceToPoint(point) < 0){return false;}}return true;}}; // File:src/math/Plane.js\n\t/**\n\t * @author bhouston / http://exocortex.com\n\t */THREE.Plane = function(normal,constant){this.normal = normal !== undefined?normal:new THREE.Vector3(1,0,0);this.constant = constant !== undefined?constant:0;};THREE.Plane.prototype = {constructor:THREE.Plane,set:function set(normal,constant){this.normal.copy(normal);this.constant = constant;return this;},setComponents:function setComponents(x,y,z,w){this.normal.set(x,y,z);this.constant = w;return this;},setFromNormalAndCoplanarPoint:function setFromNormalAndCoplanarPoint(normal,point){this.normal.copy(normal);this.constant = -point.dot(this.normal); // must be this.normal, not normal, as this.normal is normalized\n\treturn this;},setFromCoplanarPoints:(function(){var v1=new THREE.Vector3();var v2=new THREE.Vector3();return function(a,b,c){var normal=v1.subVectors(c,b).cross(v2.subVectors(a,b)).normalize(); // Q: should an error be thrown if normal is zero (e.g. degenerate plane)?\n\tthis.setFromNormalAndCoplanarPoint(normal,a);return this;};})(),clone:function clone(){return new this.constructor().copy(this);},copy:function copy(plane){this.normal.copy(plane.normal);this.constant = plane.constant;return this;},normalize:function normalize(){ // Note: will lead to a divide by zero if the plane is invalid.\n\tvar inverseNormalLength=1.0 / this.normal.length();this.normal.multiplyScalar(inverseNormalLength);this.constant *= inverseNormalLength;return this;},negate:function negate(){this.constant *= -1;this.normal.negate();return this;},distanceToPoint:function distanceToPoint(point){return this.normal.dot(point) + this.constant;},distanceToSphere:function distanceToSphere(sphere){return this.distanceToPoint(sphere.center) - sphere.radius;},projectPoint:function projectPoint(point,optionalTarget){return this.orthoPoint(point,optionalTarget).sub(point).negate();},orthoPoint:function orthoPoint(point,optionalTarget){var perpendicularMagnitude=this.distanceToPoint(point);var result=optionalTarget || new THREE.Vector3();return result.copy(this.normal).multiplyScalar(perpendicularMagnitude);},isIntersectionLine:function isIntersectionLine(line){ // Note: this tests if a line intersects the plane, not whether it (or its end-points) are coplanar with it.\n\tvar startSign=this.distanceToPoint(line.start);var endSign=this.distanceToPoint(line.end);return startSign < 0 && endSign > 0 || endSign < 0 && startSign > 0;},intersectLine:(function(){var v1=new THREE.Vector3();return function(line,optionalTarget){var result=optionalTarget || new THREE.Vector3();var direction=line.delta(v1);var denominator=this.normal.dot(direction);if(denominator === 0){ // line is coplanar, return origin\n\tif(this.distanceToPoint(line.start) === 0){return result.copy(line.start);} // Unsure if this is the correct method to handle this case.\n\treturn undefined;}var t=-(line.start.dot(this.normal) + this.constant) / denominator;if(t < 0 || t > 1){return undefined;}return result.copy(direction).multiplyScalar(t).add(line.start);};})(),coplanarPoint:function coplanarPoint(optionalTarget){var result=optionalTarget || new THREE.Vector3();return result.copy(this.normal).multiplyScalar(-this.constant);},applyMatrix4:(function(){var v1=new THREE.Vector3();var v2=new THREE.Vector3();var m1=new THREE.Matrix3();return function(matrix,optionalNormalMatrix){ // compute new normal based on theory here:\n\t// http://www.songho.ca/opengl/gl_normaltransform.html\n\tvar normalMatrix=optionalNormalMatrix || m1.getNormalMatrix(matrix);var newNormal=v1.copy(this.normal).applyMatrix3(normalMatrix);var newCoplanarPoint=this.coplanarPoint(v2);newCoplanarPoint.applyMatrix4(matrix);this.setFromNormalAndCoplanarPoint(newNormal,newCoplanarPoint);return this;};})(),translate:function translate(offset){this.constant = this.constant - offset.dot(this.normal);return this;},equals:function equals(plane){return plane.normal.equals(this.normal) && plane.constant === this.constant;}}; // File:src/math/Math.js\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author mrdoob / http://mrdoob.com/\n\t */THREE.Math = {generateUUID:(function(){ // http://www.broofa.com/Tools/Math.uuid.htm\n\tvar chars='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.split('');var uuid=new Array(36);var rnd=0,r;return function(){for(var i=0;i < 36;i++) {if(i === 8 || i === 13 || i === 18 || i === 23){uuid[i] = '-';}else if(i === 14){uuid[i] = '4';}else {if(rnd <= 0x02)rnd = 0x2000000 + Math.random() * 0x1000000 | 0;r = rnd & 0xf;rnd = rnd >> 4;uuid[i] = chars[i === 19?r & 0x3 | 0x8:r];}}return uuid.join('');};})(), // Clamp value to range <a, b>\n\tclamp:function clamp(x,a,b){return x < a?a:x > b?b:x;}, // Clamp value to range <a, inf)\n\tclampBottom:function clampBottom(x,a){return x < a?a:x;}, // compute euclidian modulo of m % n\n\t// https://en.wikipedia.org/wiki/Modulo_operation\n\teuclideanModulo:function euclideanModulo(n,m){return (n % m + m) % m;}, // Linear mapping from range <a1, a2> to range <b1, b2>\n\tmapLinear:function mapLinear(x,a1,a2,b1,b2){return b1 + (x - a1) * (b2 - b1) / (a2 - a1);}, // http://en.wikipedia.org/wiki/Smoothstep\n\tsmoothstep:function smoothstep(x,min,max){if(x <= min)return 0;if(x >= max)return 1;x = (x - min) / (max - min);return x * x * (3 - 2 * x);},smootherstep:function smootherstep(x,min,max){if(x <= min)return 0;if(x >= max)return 1;x = (x - min) / (max - min);return x * x * x * (x * (x * 6 - 15) + 10);}, // Random float from <0, 1> with 16 bits of randomness\n\t// (standard Math.random() creates repetitive patterns when applied over larger space)\n\trandom16:function random16(){return (65280 * Math.random() + 255 * Math.random()) / 65535;}, // Random integer from <low, high> interval\n\trandInt:function randInt(low,high){return low + Math.floor(Math.random() * (high - low + 1));}, // Random float from <low, high> interval\n\trandFloat:function randFloat(low,high){return low + Math.random() * (high - low);}, // Random float from <-range/2, range/2> interval\n\trandFloatSpread:function randFloatSpread(range){return range * (0.5 - Math.random());},degToRad:(function(){var degreeToRadiansFactor=Math.PI / 180;return function(degrees){return degrees * degreeToRadiansFactor;};})(),radToDeg:(function(){var radianToDegreesFactor=180 / Math.PI;return function(radians){return radians * radianToDegreesFactor;};})(),isPowerOfTwo:function isPowerOfTwo(value){return (value & value - 1) === 0 && value !== 0;},nextPowerOfTwo:function nextPowerOfTwo(value){value--;value |= value >> 1;value |= value >> 2;value |= value >> 4;value |= value >> 8;value |= value >> 16;value++;return value;}}; // File:src/math/Spline.js\n\t/**\n\t * Spline from Tween.js, slightly optimized (and trashed)\n\t * http://sole.github.com/tween.js/examples/05_spline.html\n\t *\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author alteredq / http://alteredqualia.com/\n\t */THREE.Spline = function(points){this.points = points;var c=[],v3={x:0,y:0,z:0},point,intPoint,weight,w2,w3,pa,pb,pc,pd;this.initFromArray = function(a){this.points = [];for(var i=0;i < a.length;i++) {this.points[i] = {x:a[i][0],y:a[i][1],z:a[i][2]};}};this.getPoint = function(k){point = (this.points.length - 1) * k;intPoint = Math.floor(point);weight = point - intPoint;c[0] = intPoint === 0?intPoint:intPoint - 1;c[1] = intPoint;c[2] = intPoint > this.points.length - 2?this.points.length - 1:intPoint + 1;c[3] = intPoint > this.points.length - 3?this.points.length - 1:intPoint + 2;pa = this.points[c[0]];pb = this.points[c[1]];pc = this.points[c[2]];pd = this.points[c[3]];w2 = weight * weight;w3 = weight * w2;v3.x = interpolate(pa.x,pb.x,pc.x,pd.x,weight,w2,w3);v3.y = interpolate(pa.y,pb.y,pc.y,pd.y,weight,w2,w3);v3.z = interpolate(pa.z,pb.z,pc.z,pd.z,weight,w2,w3);return v3;};this.getControlPointsArray = function(){var i,p,l=this.points.length,coords=[];for(i = 0;i < l;i++) {p = this.points[i];coords[i] = [p.x,p.y,p.z];}return coords;}; // approximate length by summing linear segments\n\tthis.getLength = function(nSubDivisions){var i,index,nSamples,position,point=0,intPoint=0,oldIntPoint=0,oldPosition=new THREE.Vector3(),tmpVec=new THREE.Vector3(),chunkLengths=[],totalLength=0; // first point has 0 length\n\tchunkLengths[0] = 0;if(!nSubDivisions)nSubDivisions = 100;nSamples = this.points.length * nSubDivisions;oldPosition.copy(this.points[0]);for(i = 1;i < nSamples;i++) {index = i / nSamples;position = this.getPoint(index);tmpVec.copy(position);totalLength += tmpVec.distanceTo(oldPosition);oldPosition.copy(position);point = (this.points.length - 1) * index;intPoint = Math.floor(point);if(intPoint !== oldIntPoint){chunkLengths[intPoint] = totalLength;oldIntPoint = intPoint;}} // last point ends with total length\n\tchunkLengths[chunkLengths.length] = totalLength;return {chunks:chunkLengths,total:totalLength};};this.reparametrizeByArcLength = function(samplingCoef){var i,j,index,indexCurrent,indexNext,realDistance,sampling,position,newpoints=[],tmpVec=new THREE.Vector3(),sl=this.getLength();newpoints.push(tmpVec.copy(this.points[0]).clone());for(i = 1;i < this.points.length;i++) { //tmpVec.copy( this.points[ i - 1 ] );\n\t//linearDistance = tmpVec.distanceTo( this.points[ i ] );\n\trealDistance = sl.chunks[i] - sl.chunks[i - 1];sampling = Math.ceil(samplingCoef * realDistance / sl.total);indexCurrent = (i - 1) / (this.points.length - 1);indexNext = i / (this.points.length - 1);for(j = 1;j < sampling - 1;j++) {index = indexCurrent + j * (1 / sampling) * (indexNext - indexCurrent);position = this.getPoint(index);newpoints.push(tmpVec.copy(position).clone());}newpoints.push(tmpVec.copy(this.points[i]).clone());}this.points = newpoints;}; // Catmull-Rom\n\tfunction interpolate(p0,p1,p2,p3,t,t2,t3){var v0=(p2 - p0) * 0.5,v1=(p3 - p1) * 0.5;return (2 * (p1 - p2) + v0 + v1) * t3 + (-3 * (p1 - p2) - 2 * v0 - v1) * t2 + v0 * t + p1;}}; // File:src/math/Triangle.js\n\t/**\n\t * @author bhouston / http://exocortex.com\n\t * @author mrdoob / http://mrdoob.com/\n\t */THREE.Triangle = function(a,b,c){this.a = a !== undefined?a:new THREE.Vector3();this.b = b !== undefined?b:new THREE.Vector3();this.c = c !== undefined?c:new THREE.Vector3();};THREE.Triangle.normal = (function(){var v0=new THREE.Vector3();return function(a,b,c,optionalTarget){var result=optionalTarget || new THREE.Vector3();result.subVectors(c,b);v0.subVectors(a,b);result.cross(v0);var resultLengthSq=result.lengthSq();if(resultLengthSq > 0){return result.multiplyScalar(1 / Math.sqrt(resultLengthSq));}return result.set(0,0,0);};})(); // static/instance method to calculate barycentric coordinates\n\t// based on: http://www.blackpawn.com/texts/pointinpoly/default.html\n\tTHREE.Triangle.barycoordFromPoint = (function(){var v0=new THREE.Vector3();var v1=new THREE.Vector3();var v2=new THREE.Vector3();return function(point,a,b,c,optionalTarget){v0.subVectors(c,a);v1.subVectors(b,a);v2.subVectors(point,a);var dot00=v0.dot(v0);var dot01=v0.dot(v1);var dot02=v0.dot(v2);var dot11=v1.dot(v1);var dot12=v1.dot(v2);var denom=dot00 * dot11 - dot01 * dot01;var result=optionalTarget || new THREE.Vector3(); // collinear or singular triangle\n\tif(denom === 0){ // arbitrary location outside of triangle?\n\t// not sure if this is the best idea, maybe should be returning undefined\n\treturn result.set(-2,-1,-1);}var invDenom=1 / denom;var u=(dot11 * dot02 - dot01 * dot12) * invDenom;var v=(dot00 * dot12 - dot01 * dot02) * invDenom; // barycentric coordinates must always sum to 1\n\treturn result.set(1 - u - v,v,u);};})();THREE.Triangle.containsPoint = (function(){var v1=new THREE.Vector3();return function(point,a,b,c){var result=THREE.Triangle.barycoordFromPoint(point,a,b,c,v1);return result.x >= 0 && result.y >= 0 && result.x + result.y <= 1;};})();THREE.Triangle.prototype = {constructor:THREE.Triangle,set:function set(a,b,c){this.a.copy(a);this.b.copy(b);this.c.copy(c);return this;},setFromPointsAndIndices:function setFromPointsAndIndices(points,i0,i1,i2){this.a.copy(points[i0]);this.b.copy(points[i1]);this.c.copy(points[i2]);return this;},clone:function clone(){return new this.constructor().copy(this);},copy:function copy(triangle){this.a.copy(triangle.a);this.b.copy(triangle.b);this.c.copy(triangle.c);return this;},area:(function(){var v0=new THREE.Vector3();var v1=new THREE.Vector3();return function(){v0.subVectors(this.c,this.b);v1.subVectors(this.a,this.b);return v0.cross(v1).length() * 0.5;};})(),midpoint:function midpoint(optionalTarget){var result=optionalTarget || new THREE.Vector3();return result.addVectors(this.a,this.b).add(this.c).multiplyScalar(1 / 3);},normal:function normal(optionalTarget){return THREE.Triangle.normal(this.a,this.b,this.c,optionalTarget);},plane:function plane(optionalTarget){var result=optionalTarget || new THREE.Plane();return result.setFromCoplanarPoints(this.a,this.b,this.c);},barycoordFromPoint:function barycoordFromPoint(point,optionalTarget){return THREE.Triangle.barycoordFromPoint(point,this.a,this.b,this.c,optionalTarget);},containsPoint:function containsPoint(point){return THREE.Triangle.containsPoint(point,this.a,this.b,this.c);},equals:function equals(triangle){return triangle.a.equals(this.a) && triangle.b.equals(this.b) && triangle.c.equals(this.c);}}; // File:src/core/Clock.js\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t */THREE.Clock = function(autoStart){this.autoStart = autoStart !== undefined?autoStart:true;this.startTime = 0;this.oldTime = 0;this.elapsedTime = 0;this.running = false;};THREE.Clock.prototype = {constructor:THREE.Clock,start:function start(){this.startTime = self.performance !== undefined && self.performance.now !== undefined?self.performance.now():Date.now();this.oldTime = this.startTime;this.running = true;},stop:function stop(){this.getElapsedTime();this.running = false;},getElapsedTime:function getElapsedTime(){this.getDelta();return this.elapsedTime;},getDelta:function getDelta(){var diff=0;if(this.autoStart && !this.running){this.start();}if(this.running){var newTime=self.performance !== undefined && self.performance.now !== undefined?self.performance.now():Date.now();diff = 0.001 * (newTime - this.oldTime);this.oldTime = newTime;this.elapsedTime += diff;}return diff;}}; // File:src/core/EventDispatcher.js\n\t/**\n\t * https://github.com/mrdoob/eventdispatcher.js/\n\t */THREE.EventDispatcher = function(){};THREE.EventDispatcher.prototype = {constructor:THREE.EventDispatcher,apply:function apply(object){object.addEventListener = THREE.EventDispatcher.prototype.addEventListener;object.hasEventListener = THREE.EventDispatcher.prototype.hasEventListener;object.removeEventListener = THREE.EventDispatcher.prototype.removeEventListener;object.dispatchEvent = THREE.EventDispatcher.prototype.dispatchEvent;},addEventListener:function addEventListener(type,listener){if(this._listeners === undefined)this._listeners = {};var listeners=this._listeners;if(listeners[type] === undefined){listeners[type] = [];}if(listeners[type].indexOf(listener) === -1){listeners[type].push(listener);}},hasEventListener:function hasEventListener(type,listener){if(this._listeners === undefined)return false;var listeners=this._listeners;if(listeners[type] !== undefined && listeners[type].indexOf(listener) !== -1){return true;}return false;},removeEventListener:function removeEventListener(type,listener){if(this._listeners === undefined)return;var listeners=this._listeners;var listenerArray=listeners[type];if(listenerArray !== undefined){var index=listenerArray.indexOf(listener);if(index !== -1){listenerArray.splice(index,1);}}},dispatchEvent:function dispatchEvent(event){if(this._listeners === undefined)return;var listeners=this._listeners;var listenerArray=listeners[event.type];if(listenerArray !== undefined){event.target = this;var array=[];var length=listenerArray.length;for(var i=0;i < length;i++) {array[i] = listenerArray[i];}for(var i=0;i < length;i++) {array[i].call(this,event);}}}}; // File:src/core/Raycaster.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author bhouston / http://exocortex.com/\n\t * @author stephomi / http://stephaneginier.com/\n\t */(function(THREE){THREE.Raycaster = function(origin,direction,near,far){this.ray = new THREE.Ray(origin,direction); // direction is assumed to be normalized (for accurate distance calculations)\n\tthis.near = near || 0;this.far = far || Infinity;this.params = {Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}};_Object$defineProperties(this.params,{PointCloud:{get:function get(){console.warn('THREE.Raycaster: params.PointCloud has been renamed to params.Points.');return this.Points;}}});};function descSort(a,b){return a.distance - b.distance;}var _intersectObject=function _intersectObject(object,raycaster,intersects,recursive){if(object.visible === false)return;object.raycast(raycaster,intersects);if(recursive === true){var children=object.children;for(var i=0,l=children.length;i < l;i++) {_intersectObject(children[i],raycaster,intersects,true);}}}; //\n\tTHREE.Raycaster.prototype = {constructor:THREE.Raycaster,linePrecision:1,set:function set(origin,direction){ // direction is assumed to be normalized (for accurate distance calculations)\n\tthis.ray.set(origin,direction);},setFromCamera:function setFromCamera(coords,camera){if(camera instanceof THREE.PerspectiveCamera){this.ray.origin.setFromMatrixPosition(camera.matrixWorld);this.ray.direction.set(coords.x,coords.y,0.5).unproject(camera).sub(this.ray.origin).normalize();}else if(camera instanceof THREE.OrthographicCamera){this.ray.origin.set(coords.x,coords.y,-1).unproject(camera);this.ray.direction.set(0,0,-1).transformDirection(camera.matrixWorld);}else {console.error('THREE.Raycaster: Unsupported camera type.');}},intersectObject:function intersectObject(object,recursive){var intersects=[];_intersectObject(object,this,intersects,recursive);intersects.sort(descSort);return intersects;},intersectObjects:function intersectObjects(objects,recursive){var intersects=[];if(Array.isArray(objects) === false){console.warn('THREE.Raycaster.intersectObjects: objects is not an Array.');return intersects;}for(var i=0,l=objects.length;i < l;i++) {_intersectObject(objects[i],this,intersects,recursive);}intersects.sort(descSort);return intersects;}};})(THREE); // File:src/core/Object3D.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author mikael emtinger / http://gomo.se/\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author WestLangley / http://github.com/WestLangley\n\t * @author elephantatwork / www.elephantatwork.ch\n\t */THREE.Object3D = function(){Object.defineProperty(this,'id',{value:THREE.Object3DIdCount++});this.uuid = THREE.Math.generateUUID();this.name = '';this.type = 'Object3D';this.parent = null;this.children = [];this.up = THREE.Object3D.DefaultUp.clone();var position=new THREE.Vector3();var rotation=new THREE.Euler();var quaternion=new THREE.Quaternion();var scale=new THREE.Vector3(1,1,1);var onRotationChange=function onRotationChange(){quaternion.setFromEuler(rotation,false);};var onQuaternionChange=function onQuaternionChange(){rotation.setFromQuaternion(quaternion,undefined,false);};rotation.onChange(onRotationChange);quaternion.onChange(onQuaternionChange);_Object$defineProperties(this,{position:{enumerable:true,value:position},rotation:{enumerable:true,value:rotation},quaternion:{enumerable:true,value:quaternion},scale:{enumerable:true,value:scale},modelViewMatrix:{value:new THREE.Matrix4()},normalMatrix:{value:new THREE.Matrix3()}});this.rotationAutoUpdate = true;this.matrix = new THREE.Matrix4();this.matrixWorld = new THREE.Matrix4();this.matrixAutoUpdate = THREE.Object3D.DefaultMatrixAutoUpdate;this.matrixWorldNeedsUpdate = false;this.visible = true;this.castShadow = false;this.receiveShadow = false;this.frustumCulled = true;this.renderOrder = 0;this.userData = {};};THREE.Object3D.DefaultUp = new THREE.Vector3(0,1,0);THREE.Object3D.DefaultMatrixAutoUpdate = true;THREE.Object3D.prototype = _Object$defineProperties({constructor:THREE.Object3D,applyMatrix:function applyMatrix(matrix){this.matrix.multiplyMatrices(matrix,this.matrix);this.matrix.decompose(this.position,this.quaternion,this.scale);},setRotationFromAxisAngle:function setRotationFromAxisAngle(axis,angle){ // assumes axis is normalized\n\tthis.quaternion.setFromAxisAngle(axis,angle);},setRotationFromEuler:function setRotationFromEuler(euler){this.quaternion.setFromEuler(euler,true);},setRotationFromMatrix:function setRotationFromMatrix(m){ // assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n\tthis.quaternion.setFromRotationMatrix(m);},setRotationFromQuaternion:function setRotationFromQuaternion(q){ // assumes q is normalized\n\tthis.quaternion.copy(q);},rotateOnAxis:(function(){ // rotate object on axis in object space\n\t// axis is assumed to be normalized\n\tvar q1=new THREE.Quaternion();return function(axis,angle){q1.setFromAxisAngle(axis,angle);this.quaternion.multiply(q1);return this;};})(),rotateX:(function(){var v1=new THREE.Vector3(1,0,0);return function(angle){return this.rotateOnAxis(v1,angle);};})(),rotateY:(function(){var v1=new THREE.Vector3(0,1,0);return function(angle){return this.rotateOnAxis(v1,angle);};})(),rotateZ:(function(){var v1=new THREE.Vector3(0,0,1);return function(angle){return this.rotateOnAxis(v1,angle);};})(),translateOnAxis:(function(){ // translate object by distance along axis in object space\n\t// axis is assumed to be normalized\n\tvar v1=new THREE.Vector3();return function(axis,distance){v1.copy(axis).applyQuaternion(this.quaternion);this.position.add(v1.multiplyScalar(distance));return this;};})(),translate:function translate(distance,axis){console.warn('THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead.');return this.translateOnAxis(axis,distance);},translateX:(function(){var v1=new THREE.Vector3(1,0,0);return function(distance){return this.translateOnAxis(v1,distance);};})(),translateY:(function(){var v1=new THREE.Vector3(0,1,0);return function(distance){return this.translateOnAxis(v1,distance);};})(),translateZ:(function(){var v1=new THREE.Vector3(0,0,1);return function(distance){return this.translateOnAxis(v1,distance);};})(),localToWorld:function localToWorld(vector){return vector.applyMatrix4(this.matrixWorld);},worldToLocal:(function(){var m1=new THREE.Matrix4();return function(vector){return vector.applyMatrix4(m1.getInverse(this.matrixWorld));};})(),lookAt:(function(){ // This routine does not support objects with rotated and/or translated parent(s)\n\tvar m1=new THREE.Matrix4();return function(vector){m1.lookAt(vector,this.position,this.up);this.quaternion.setFromRotationMatrix(m1);};})(),add:function add(object){if(arguments.length > 1){for(var i=0;i < arguments.length;i++) {this.add(arguments[i]);}return this;}if(object === this){console.error(\"THREE.Object3D.add: object can't be added as a child of itself.\",object);return this;}if(object instanceof THREE.Object3D){if(object.parent !== null){object.parent.remove(object);}object.parent = this;object.dispatchEvent({type:'added'});this.children.push(object);}else {console.error(\"THREE.Object3D.add: object not an instance of THREE.Object3D.\",object);}return this;},remove:function remove(object){if(arguments.length > 1){for(var i=0;i < arguments.length;i++) {this.remove(arguments[i]);}}var index=this.children.indexOf(object);if(index !== -1){object.parent = null;object.dispatchEvent({type:'removed'});this.children.splice(index,1);}},getChildByName:function getChildByName(name){console.warn('THREE.Object3D: .getChildByName() has been renamed to .getObjectByName().');return this.getObjectByName(name);},getObjectById:function getObjectById(id){return this.getObjectByProperty('id',id);},getObjectByName:function getObjectByName(name){return this.getObjectByProperty('name',name);},getObjectByProperty:function getObjectByProperty(name,value){if(this[name] === value)return this;for(var i=0,l=this.children.length;i < l;i++) {var child=this.children[i];var object=child.getObjectByProperty(name,value);if(object !== undefined){return object;}}return undefined;},getWorldPosition:function getWorldPosition(optionalTarget){var result=optionalTarget || new THREE.Vector3();this.updateMatrixWorld(true);return result.setFromMatrixPosition(this.matrixWorld);},getWorldQuaternion:(function(){var position=new THREE.Vector3();var scale=new THREE.Vector3();return function(optionalTarget){var result=optionalTarget || new THREE.Quaternion();this.updateMatrixWorld(true);this.matrixWorld.decompose(position,result,scale);return result;};})(),getWorldRotation:(function(){var quaternion=new THREE.Quaternion();return function(optionalTarget){var result=optionalTarget || new THREE.Euler();this.getWorldQuaternion(quaternion);return result.setFromQuaternion(quaternion,this.rotation.order,false);};})(),getWorldScale:(function(){var position=new THREE.Vector3();var quaternion=new THREE.Quaternion();return function(optionalTarget){var result=optionalTarget || new THREE.Vector3();this.updateMatrixWorld(true);this.matrixWorld.decompose(position,quaternion,result);return result;};})(),getWorldDirection:(function(){var quaternion=new THREE.Quaternion();return function(optionalTarget){var result=optionalTarget || new THREE.Vector3();this.getWorldQuaternion(quaternion);return result.set(0,0,1).applyQuaternion(quaternion);};})(),raycast:function raycast(){},traverse:function traverse(callback){callback(this);var children=this.children;for(var i=0,l=children.length;i < l;i++) {children[i].traverse(callback);}},traverseVisible:function traverseVisible(callback){if(this.visible === false)return;callback(this);var children=this.children;for(var i=0,l=children.length;i < l;i++) {children[i].traverseVisible(callback);}},traverseAncestors:function traverseAncestors(callback){var parent=this.parent;if(parent !== null){callback(parent);parent.traverseAncestors(callback);}},updateMatrix:function updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate = true;},updateMatrixWorld:function updateMatrixWorld(force){if(this.matrixAutoUpdate === true)this.updateMatrix();if(this.matrixWorldNeedsUpdate === true || force === true){if(this.parent === null){this.matrixWorld.copy(this.matrix);}else {this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix);}this.matrixWorldNeedsUpdate = false;force = true;} // update children\n\tfor(var i=0,l=this.children.length;i < l;i++) {this.children[i].updateMatrixWorld(force);}},toJSON:function toJSON(meta){var isRootObject=meta === undefined;var data={}; // meta is a hash used to collect geometries, materials.\n\t// not providing it implies that this is the root object\n\t// being serialized.\n\tif(isRootObject){ // initialize meta obj\n\tmeta = {geometries:{},materials:{},textures:{},images:{}};data.metadata = {version:4.4,type:'Object',generator:'Object3D.toJSON'};} // standard Object3D serialization\n\tdata.uuid = this.uuid;data.type = this.type;if(this.name !== '')data.name = this.name;if(JSON.stringify(this.userData) !== '{}')data.userData = this.userData;if(this.visible !== true)data.visible = this.visible;data.matrix = this.matrix.toArray();if(this.children.length > 0){data.children = [];for(var i=0;i < this.children.length;i++) {data.children.push(this.children[i].toJSON(meta).object);}}var output={};if(isRootObject){var geometries=extractFromCache(meta.geometries);var materials=extractFromCache(meta.materials);var textures=extractFromCache(meta.textures);var images=extractFromCache(meta.images);if(geometries.length > 0)output.geometries = geometries;if(materials.length > 0)output.materials = materials;if(textures.length > 0)output.textures = textures;if(images.length > 0)output.images = images;}output.object = data;return output; // extract data from the cache hash\n\t// remove metadata on each item\n\t// and return as array\n\tfunction extractFromCache(cache){var values=[];for(var key in cache) {var data=cache[key];delete data.metadata;values.push(data);}return values;}},clone:function clone(recursive){return new this.constructor().copy(this,recursive);},copy:function copy(source,recursive){if(recursive === undefined)recursive = true;this.name = source.name;this.up.copy(source.up);this.position.copy(source.position);this.quaternion.copy(source.quaternion);this.scale.copy(source.scale);this.rotationAutoUpdate = source.rotationAutoUpdate;this.matrix.copy(source.matrix);this.matrixWorld.copy(source.matrixWorld);this.matrixAutoUpdate = source.matrixAutoUpdate;this.matrixWorldNeedsUpdate = source.matrixWorldNeedsUpdate;this.visible = source.visible;this.castShadow = source.castShadow;this.receiveShadow = source.receiveShadow;this.frustumCulled = source.frustumCulled;this.renderOrder = source.renderOrder;this.userData = JSON.parse(JSON.stringify(source.userData));if(recursive === true){for(var i=0;i < source.children.length;i++) {var child=source.children[i];this.add(child.clone());}}return this;}},{eulerOrder:{get:function get(){console.warn('THREE.Object3D: .eulerOrder has been moved to .rotation.order.');return this.rotation.order;},set:function set(value){console.warn('THREE.Object3D: .eulerOrder has been moved to .rotation.order.');this.rotation.order = value;},configurable:true,enumerable:true},useQuaternion:{get:function get(){console.warn('THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.');},set:function set(value){console.warn('THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.');},configurable:true,enumerable:true},renderDepth:{set:function set(value){console.warn('THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.');},configurable:true,enumerable:true}});THREE.EventDispatcher.prototype.apply(THREE.Object3D.prototype);THREE.Object3DIdCount = 0; // File:src/core/Face3.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author alteredq / http://alteredqualia.com/\n\t */THREE.Face3 = function(a,b,c,normal,color,materialIndex){this.a = a;this.b = b;this.c = c;this.normal = normal instanceof THREE.Vector3?normal:new THREE.Vector3();this.vertexNormals = Array.isArray(normal)?normal:[];this.color = color instanceof THREE.Color?color:new THREE.Color();this.vertexColors = Array.isArray(color)?color:[];this.materialIndex = materialIndex !== undefined?materialIndex:0;};THREE.Face3.prototype = {constructor:THREE.Face3,clone:function clone(){return new this.constructor().copy(this);},copy:function copy(source){this.a = source.a;this.b = source.b;this.c = source.c;this.normal.copy(source.normal);this.color.copy(source.color);this.materialIndex = source.materialIndex;for(var i=0,il=source.vertexNormals.length;i < il;i++) {this.vertexNormals[i] = source.vertexNormals[i].clone();}for(var i=0,il=source.vertexColors.length;i < il;i++) {this.vertexColors[i] = source.vertexColors[i].clone();}return this;}}; // File:src/core/Face4.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */THREE.Face4 = function(a,b,c,d,normal,color,materialIndex){console.warn('THREE.Face4 has been removed. A THREE.Face3 will be created instead.');return new THREE.Face3(a,b,c,normal,color,materialIndex);}; // File:src/core/BufferAttribute.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */THREE.BufferAttribute = function(array,itemSize){this.uuid = THREE.Math.generateUUID();this.array = array;this.itemSize = itemSize;this.dynamic = false;this.updateRange = {offset:0,count:-1};this.version = 0;};THREE.BufferAttribute.prototype = _Object$defineProperties({constructor:THREE.BufferAttribute,setDynamic:function setDynamic(value){this.dynamic = value;return this;},copy:function copy(source){this.array = new source.array.constructor(source.array);this.itemSize = source.itemSize;this.dynamic = source.dynamic;return this;},copyAt:function copyAt(index1,attribute,index2){index1 *= this.itemSize;index2 *= attribute.itemSize;for(var i=0,l=this.itemSize;i < l;i++) {this.array[index1 + i] = attribute.array[index2 + i];}return this;},copyArray:function copyArray(array){this.array.set(array);return this;},copyColorsArray:function copyColorsArray(colors){var array=this.array,offset=0;for(var i=0,l=colors.length;i < l;i++) {var color=colors[i];if(color === undefined){console.warn('THREE.BufferAttribute.copyColorsArray(): color is undefined',i);color = new THREE.Color();}array[offset++] = color.r;array[offset++] = color.g;array[offset++] = color.b;}return this;},copyIndicesArray:function copyIndicesArray(indices){var array=this.array,offset=0;for(var i=0,l=indices.length;i < l;i++) {var index=indices[i];array[offset++] = index.a;array[offset++] = index.b;array[offset++] = index.c;}return this;},copyVector2sArray:function copyVector2sArray(vectors){var array=this.array,offset=0;for(var i=0,l=vectors.length;i < l;i++) {var vector=vectors[i];if(vector === undefined){console.warn('THREE.BufferAttribute.copyVector2sArray(): vector is undefined',i);vector = new THREE.Vector2();}array[offset++] = vector.x;array[offset++] = vector.y;}return this;},copyVector3sArray:function copyVector3sArray(vectors){var array=this.array,offset=0;for(var i=0,l=vectors.length;i < l;i++) {var vector=vectors[i];if(vector === undefined){console.warn('THREE.BufferAttribute.copyVector3sArray(): vector is undefined',i);vector = new THREE.Vector3();}array[offset++] = vector.x;array[offset++] = vector.y;array[offset++] = vector.z;}return this;},copyVector4sArray:function copyVector4sArray(vectors){var array=this.array,offset=0;for(var i=0,l=vectors.length;i < l;i++) {var vector=vectors[i];if(vector === undefined){console.warn('THREE.BufferAttribute.copyVector4sArray(): vector is undefined',i);vector = new THREE.Vector4();}array[offset++] = vector.x;array[offset++] = vector.y;array[offset++] = vector.z;array[offset++] = vector.w;}return this;},set:function set(value,offset){if(offset === undefined)offset = 0;this.array.set(value,offset);return this;},getX:function getX(index){return this.array[index * this.itemSize];},setX:function setX(index,x){this.array[index * this.itemSize] = x;return this;},getY:function getY(index){return this.array[index * this.itemSize + 1];},setY:function setY(index,y){this.array[index * this.itemSize + 1] = y;return this;},getZ:function getZ(index){return this.array[index * this.itemSize + 2];},setZ:function setZ(index,z){this.array[index * this.itemSize + 2] = z;return this;},getW:function getW(index){return this.array[index * this.itemSize + 3];},setW:function setW(index,w){this.array[index * this.itemSize + 3] = w;return this;},setXY:function setXY(index,x,y){index *= this.itemSize;this.array[index + 0] = x;this.array[index + 1] = y;return this;},setXYZ:function setXYZ(index,x,y,z){index *= this.itemSize;this.array[index + 0] = x;this.array[index + 1] = y;this.array[index + 2] = z;return this;},setXYZW:function setXYZW(index,x,y,z,w){index *= this.itemSize;this.array[index + 0] = x;this.array[index + 1] = y;this.array[index + 2] = z;this.array[index + 3] = w;return this;},clone:function clone(){return new this.constructor().copy(this);}},{length:{get:function get(){console.warn('THREE.BufferAttribute: .length has been deprecated. Please use .count.');return this.array.length;},configurable:true,enumerable:true},count:{get:function get(){return this.array.length / this.itemSize;},configurable:true,enumerable:true},needsUpdate:{set:function set(value){if(value === true)this.version++;},configurable:true,enumerable:true}}); //\n\tTHREE.Int8Attribute = function(array,itemSize){return new THREE.BufferAttribute(new Int8Array(array),itemSize);};THREE.Uint8Attribute = function(array,itemSize){return new THREE.BufferAttribute(new Uint8Array(array),itemSize);};THREE.Uint8ClampedAttribute = function(array,itemSize){return new THREE.BufferAttribute(new Uint8ClampedArray(array),itemSize);};THREE.Int16Attribute = function(array,itemSize){return new THREE.BufferAttribute(new Int16Array(array),itemSize);};THREE.Uint16Attribute = function(array,itemSize){return new THREE.BufferAttribute(new Uint16Array(array),itemSize);};THREE.Int32Attribute = function(array,itemSize){return new THREE.BufferAttribute(new Int32Array(array),itemSize);};THREE.Uint32Attribute = function(array,itemSize){return new THREE.BufferAttribute(new Uint32Array(array),itemSize);};THREE.Float32Attribute = function(array,itemSize){return new THREE.BufferAttribute(new Float32Array(array),itemSize);};THREE.Float64Attribute = function(array,itemSize){return new THREE.BufferAttribute(new Float64Array(array),itemSize);}; // Deprecated\n\tTHREE.DynamicBufferAttribute = function(array,itemSize){console.warn('THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead.');return new THREE.BufferAttribute(array,itemSize).setDynamic(true);}; // File:src/core/InstancedBufferAttribute.js\n\t/**\n\t * @author benaadams / https://twitter.com/ben_a_adams\n\t */THREE.InstancedBufferAttribute = function(array,itemSize,meshPerAttribute){THREE.BufferAttribute.call(this,array,itemSize);this.meshPerAttribute = meshPerAttribute || 1;};THREE.InstancedBufferAttribute.prototype = _Object$create(THREE.BufferAttribute.prototype);THREE.InstancedBufferAttribute.prototype.constructor = THREE.InstancedBufferAttribute;THREE.InstancedBufferAttribute.prototype.copy = function(source){THREE.BufferAttribute.prototype.copy.call(this,source);this.meshPerAttribute = source.meshPerAttribute;return this;}; // File:src/core/InterleavedBuffer.js\n\t/**\n\t * @author benaadams / https://twitter.com/ben_a_adams\n\t */THREE.InterleavedBuffer = function(array,stride){this.uuid = THREE.Math.generateUUID();this.array = array;this.stride = stride;this.dynamic = false;this.updateRange = {offset:0,count:-1};this.version = 0;};THREE.InterleavedBuffer.prototype = _Object$defineProperties({constructor:THREE.InterleavedBuffer,setDynamic:function setDynamic(value){this.dynamic = value;return this;},copy:function copy(source){this.array = new source.array.constructor(source.array);this.stride = source.stride;this.dynamic = source.dynamic;},copyAt:function copyAt(index1,attribute,index2){index1 *= this.stride;index2 *= attribute.stride;for(var i=0,l=this.stride;i < l;i++) {this.array[index1 + i] = attribute.array[index2 + i];}return this;},set:function set(value,offset){if(offset === undefined)offset = 0;this.array.set(value,offset);return this;},clone:function clone(){return new this.constructor().copy(this);}},{length:{get:function get(){return this.array.length;},configurable:true,enumerable:true},count:{get:function get(){return this.array.length / this.stride;},configurable:true,enumerable:true},needsUpdate:{set:function set(value){if(value === true)this.version++;},configurable:true,enumerable:true}}); // File:src/core/InstancedInterleavedBuffer.js\n\t/**\n\t * @author benaadams / https://twitter.com/ben_a_adams\n\t */THREE.InstancedInterleavedBuffer = function(array,stride,meshPerAttribute){THREE.InterleavedBuffer.call(this,array,stride);this.meshPerAttribute = meshPerAttribute || 1;};THREE.InstancedInterleavedBuffer.prototype = _Object$create(THREE.InterleavedBuffer.prototype);THREE.InstancedInterleavedBuffer.prototype.constructor = THREE.InstancedInterleavedBuffer;THREE.InstancedInterleavedBuffer.prototype.copy = function(source){THREE.InterleavedBuffer.prototype.copy.call(this,source);this.meshPerAttribute = source.meshPerAttribute;return this;}; // File:src/core/InterleavedBufferAttribute.js\n\t/**\n\t * @author benaadams / https://twitter.com/ben_a_adams\n\t */THREE.InterleavedBufferAttribute = function(interleavedBuffer,itemSize,offset){this.uuid = THREE.Math.generateUUID();this.data = interleavedBuffer;this.itemSize = itemSize;this.offset = offset;};THREE.InterleavedBufferAttribute.prototype = _Object$defineProperties({constructor:THREE.InterleavedBufferAttribute,setX:function setX(index,x){this.data.array[index * this.data.stride + this.offset] = x;return this;},setY:function setY(index,y){this.data.array[index * this.data.stride + this.offset + 1] = y;return this;},setZ:function setZ(index,z){this.data.array[index * this.data.stride + this.offset + 2] = z;return this;},setW:function setW(index,w){this.data.array[index * this.data.stride + this.offset + 3] = w;return this;},getX:function getX(index){return this.data.array[index * this.data.stride + this.offset];},getY:function getY(index){return this.data.array[index * this.data.stride + this.offset + 1];},getZ:function getZ(index){return this.data.array[index * this.data.stride + this.offset + 2];},getW:function getW(index){return this.data.array[index * this.data.stride + this.offset + 3];},setXY:function setXY(index,x,y){index = index * this.data.stride + this.offset;this.data.array[index + 0] = x;this.data.array[index + 1] = y;return this;},setXYZ:function setXYZ(index,x,y,z){index = index * this.data.stride + this.offset;this.data.array[index + 0] = x;this.data.array[index + 1] = y;this.data.array[index + 2] = z;return this;},setXYZW:function setXYZW(index,x,y,z,w){index = index * this.data.stride + this.offset;this.data.array[index + 0] = x;this.data.array[index + 1] = y;this.data.array[index + 2] = z;this.data.array[index + 3] = w;return this;}},{length:{get:function get(){console.warn('THREE.BufferAttribute: .length has been deprecated. Please use .count.');return this.array.length;},configurable:true,enumerable:true},count:{get:function get(){return this.data.array.length / this.data.stride;},configurable:true,enumerable:true}}); // File:src/core/Geometry.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author kile / http://kile.stravaganza.org/\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author mikael emtinger / http://gomo.se/\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\n\t * @author bhouston / http://exocortex.com\n\t */THREE.Geometry = function(){Object.defineProperty(this,'id',{value:THREE.GeometryIdCount++});this.uuid = THREE.Math.generateUUID();this.name = '';this.type = 'Geometry';this.vertices = [];this.colors = [];this.faces = [];this.faceVertexUvs = [[]];this.morphTargets = [];this.morphColors = [];this.morphNormals = [];this.skinWeights = [];this.skinIndices = [];this.lineDistances = [];this.boundingBox = null;this.boundingSphere = null; // update flags\n\tthis.verticesNeedUpdate = false;this.elementsNeedUpdate = false;this.uvsNeedUpdate = false;this.normalsNeedUpdate = false;this.colorsNeedUpdate = false;this.lineDistancesNeedUpdate = false;this.groupsNeedUpdate = false;};THREE.Geometry.prototype = {constructor:THREE.Geometry,applyMatrix:function applyMatrix(matrix){var normalMatrix=new THREE.Matrix3().getNormalMatrix(matrix);for(var i=0,il=this.vertices.length;i < il;i++) {var vertex=this.vertices[i];vertex.applyMatrix4(matrix);}for(var i=0,il=this.faces.length;i < il;i++) {var face=this.faces[i];face.normal.applyMatrix3(normalMatrix).normalize();for(var j=0,jl=face.vertexNormals.length;j < jl;j++) {face.vertexNormals[j].applyMatrix3(normalMatrix).normalize();}}if(this.boundingBox !== null){this.computeBoundingBox();}if(this.boundingSphere !== null){this.computeBoundingSphere();}this.verticesNeedUpdate = true;this.normalsNeedUpdate = true;},rotateX:(function(){ // rotate geometry around world x-axis\n\tvar m1;return function rotateX(angle){if(m1 === undefined)m1 = new THREE.Matrix4();m1.makeRotationX(angle);this.applyMatrix(m1);return this;};})(),rotateY:(function(){ // rotate geometry around world y-axis\n\tvar m1;return function rotateY(angle){if(m1 === undefined)m1 = new THREE.Matrix4();m1.makeRotationY(angle);this.applyMatrix(m1);return this;};})(),rotateZ:(function(){ // rotate geometry around world z-axis\n\tvar m1;return function rotateZ(angle){if(m1 === undefined)m1 = new THREE.Matrix4();m1.makeRotationZ(angle);this.applyMatrix(m1);return this;};})(),translate:(function(){ // translate geometry\n\tvar m1;return function translate(x,y,z){if(m1 === undefined)m1 = new THREE.Matrix4();m1.makeTranslation(x,y,z);this.applyMatrix(m1);return this;};})(),scale:(function(){ // scale geometry\n\tvar m1;return function scale(x,y,z){if(m1 === undefined)m1 = new THREE.Matrix4();m1.makeScale(x,y,z);this.applyMatrix(m1);return this;};})(),lookAt:(function(){var obj;return function lookAt(vector){if(obj === undefined)obj = new THREE.Object3D();obj.lookAt(vector);obj.updateMatrix();this.applyMatrix(obj.matrix);};})(),fromBufferGeometry:function fromBufferGeometry(geometry){var scope=this;var indices=geometry.index !== null?geometry.index.array:undefined;var attributes=geometry.attributes;var vertices=attributes.position.array;var normals=attributes.normal !== undefined?attributes.normal.array:undefined;var colors=attributes.color !== undefined?attributes.color.array:undefined;var uvs=attributes.uv !== undefined?attributes.uv.array:undefined;var uvs2=attributes.uv2 !== undefined?attributes.uv2.array:undefined;if(uvs2 !== undefined)this.faceVertexUvs[1] = [];var tempNormals=[];var tempUVs=[];var tempUVs2=[];for(var i=0,j=0,k=0;i < vertices.length;i += 3,j += 2,k += 4) {scope.vertices.push(new THREE.Vector3(vertices[i],vertices[i + 1],vertices[i + 2]));if(normals !== undefined){tempNormals.push(new THREE.Vector3(normals[i],normals[i + 1],normals[i + 2]));}if(colors !== undefined){scope.colors.push(new THREE.Color(colors[i],colors[i + 1],colors[i + 2]));}if(uvs !== undefined){tempUVs.push(new THREE.Vector2(uvs[j],uvs[j + 1]));}if(uvs2 !== undefined){tempUVs2.push(new THREE.Vector2(uvs2[j],uvs2[j + 1]));}}var addFace=function addFace(a,b,c){var vertexNormals=normals !== undefined?[tempNormals[a].clone(),tempNormals[b].clone(),tempNormals[c].clone()]:[];var vertexColors=colors !== undefined?[scope.colors[a].clone(),scope.colors[b].clone(),scope.colors[c].clone()]:[];var face=new THREE.Face3(a,b,c,vertexNormals,vertexColors);scope.faces.push(face);if(uvs !== undefined){scope.faceVertexUvs[0].push([tempUVs[a].clone(),tempUVs[b].clone(),tempUVs[c].clone()]);}if(uvs2 !== undefined){scope.faceVertexUvs[1].push([tempUVs2[a].clone(),tempUVs2[b].clone(),tempUVs2[c].clone()]);}};if(indices !== undefined){var groups=geometry.groups;if(groups.length > 0){for(var i=0;i < groups.length;i++) {var group=groups[i];var start=group.start;var count=group.count;for(var j=start,jl=start + count;j < jl;j += 3) {addFace(indices[j],indices[j + 1],indices[j + 2]);}}}else {for(var i=0;i < indices.length;i += 3) {addFace(indices[i],indices[i + 1],indices[i + 2]);}}}else {for(var i=0;i < vertices.length / 3;i += 3) {addFace(i,i + 1,i + 2);}}this.computeFaceNormals();if(geometry.boundingBox !== null){this.boundingBox = geometry.boundingBox.clone();}if(geometry.boundingSphere !== null){this.boundingSphere = geometry.boundingSphere.clone();}return this;},center:function center(){this.computeBoundingBox();var offset=this.boundingBox.center().negate();this.translate(offset.x,offset.y,offset.z);return offset;},normalize:function normalize(){this.computeBoundingSphere();var center=this.boundingSphere.center;var radius=this.boundingSphere.radius;var s=radius === 0?1:1.0 / radius;var matrix=new THREE.Matrix4();matrix.set(s,0,0,-s * center.x,0,s,0,-s * center.y,0,0,s,-s * center.z,0,0,0,1);this.applyMatrix(matrix);return this;},computeFaceNormals:function computeFaceNormals(){var cb=new THREE.Vector3(),ab=new THREE.Vector3();for(var f=0,fl=this.faces.length;f < fl;f++) {var face=this.faces[f];var vA=this.vertices[face.a];var vB=this.vertices[face.b];var vC=this.vertices[face.c];cb.subVectors(vC,vB);ab.subVectors(vA,vB);cb.cross(ab);cb.normalize();face.normal.copy(cb);}},computeVertexNormals:function computeVertexNormals(areaWeighted){var v,vl,f,fl,face,vertices;vertices = new Array(this.vertices.length);for(v = 0,vl = this.vertices.length;v < vl;v++) {vertices[v] = new THREE.Vector3();}if(areaWeighted){ // vertex normals weighted by triangle areas\n\t// http://www.iquilezles.org/www/articles/normals/normals.htm\n\tvar vA,vB,vC;var cb=new THREE.Vector3(),ab=new THREE.Vector3();for(f = 0,fl = this.faces.length;f < fl;f++) {face = this.faces[f];vA = this.vertices[face.a];vB = this.vertices[face.b];vC = this.vertices[face.c];cb.subVectors(vC,vB);ab.subVectors(vA,vB);cb.cross(ab);vertices[face.a].add(cb);vertices[face.b].add(cb);vertices[face.c].add(cb);}}else {for(f = 0,fl = this.faces.length;f < fl;f++) {face = this.faces[f];vertices[face.a].add(face.normal);vertices[face.b].add(face.normal);vertices[face.c].add(face.normal);}}for(v = 0,vl = this.vertices.length;v < vl;v++) {vertices[v].normalize();}for(f = 0,fl = this.faces.length;f < fl;f++) {face = this.faces[f];var vertexNormals=face.vertexNormals;if(vertexNormals.length === 3){vertexNormals[0].copy(vertices[face.a]);vertexNormals[1].copy(vertices[face.b]);vertexNormals[2].copy(vertices[face.c]);}else {vertexNormals[0] = vertices[face.a].clone();vertexNormals[1] = vertices[face.b].clone();vertexNormals[2] = vertices[face.c].clone();}}},computeMorphNormals:function computeMorphNormals(){var i,il,f,fl,face; // save original normals\n\t// - create temp variables on first access\n\t//   otherwise just copy (for faster repeated calls)\n\tfor(f = 0,fl = this.faces.length;f < fl;f++) {face = this.faces[f];if(!face.__originalFaceNormal){face.__originalFaceNormal = face.normal.clone();}else {face.__originalFaceNormal.copy(face.normal);}if(!face.__originalVertexNormals)face.__originalVertexNormals = [];for(i = 0,il = face.vertexNormals.length;i < il;i++) {if(!face.__originalVertexNormals[i]){face.__originalVertexNormals[i] = face.vertexNormals[i].clone();}else {face.__originalVertexNormals[i].copy(face.vertexNormals[i]);}}} // use temp geometry to compute face and vertex normals for each morph\n\tvar tmpGeo=new THREE.Geometry();tmpGeo.faces = this.faces;for(i = 0,il = this.morphTargets.length;i < il;i++) { // create on first access\n\tif(!this.morphNormals[i]){this.morphNormals[i] = {};this.morphNormals[i].faceNormals = [];this.morphNormals[i].vertexNormals = [];var dstNormalsFace=this.morphNormals[i].faceNormals;var dstNormalsVertex=this.morphNormals[i].vertexNormals;var faceNormal,vertexNormals;for(f = 0,fl = this.faces.length;f < fl;f++) {faceNormal = new THREE.Vector3();vertexNormals = {a:new THREE.Vector3(),b:new THREE.Vector3(),c:new THREE.Vector3()};dstNormalsFace.push(faceNormal);dstNormalsVertex.push(vertexNormals);}}var morphNormals=this.morphNormals[i]; // set vertices to morph target\n\ttmpGeo.vertices = this.morphTargets[i].vertices; // compute morph normals\n\ttmpGeo.computeFaceNormals();tmpGeo.computeVertexNormals(); // store morph normals\n\tvar faceNormal,vertexNormals;for(f = 0,fl = this.faces.length;f < fl;f++) {face = this.faces[f];faceNormal = morphNormals.faceNormals[f];vertexNormals = morphNormals.vertexNormals[f];faceNormal.copy(face.normal);vertexNormals.a.copy(face.vertexNormals[0]);vertexNormals.b.copy(face.vertexNormals[1]);vertexNormals.c.copy(face.vertexNormals[2]);}} // restore original normals\n\tfor(f = 0,fl = this.faces.length;f < fl;f++) {face = this.faces[f];face.normal = face.__originalFaceNormal;face.vertexNormals = face.__originalVertexNormals;}},computeTangents:function computeTangents(){console.warn('THREE.Geometry: .computeTangents() has been removed.');},computeLineDistances:function computeLineDistances(){var d=0;var vertices=this.vertices;for(var i=0,il=vertices.length;i < il;i++) {if(i > 0){d += vertices[i].distanceTo(vertices[i - 1]);}this.lineDistances[i] = d;}},computeBoundingBox:function computeBoundingBox(){if(this.boundingBox === null){this.boundingBox = new THREE.Box3();}this.boundingBox.setFromPoints(this.vertices);},computeBoundingSphere:function computeBoundingSphere(){if(this.boundingSphere === null){this.boundingSphere = new THREE.Sphere();}this.boundingSphere.setFromPoints(this.vertices);},merge:function merge(geometry,matrix,materialIndexOffset){if(geometry instanceof THREE.Geometry === false){console.error('THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.',geometry);return;}var normalMatrix,vertexOffset=this.vertices.length,vertices1=this.vertices,vertices2=geometry.vertices,faces1=this.faces,faces2=geometry.faces,uvs1=this.faceVertexUvs[0],uvs2=geometry.faceVertexUvs[0];if(materialIndexOffset === undefined)materialIndexOffset = 0;if(matrix !== undefined){normalMatrix = new THREE.Matrix3().getNormalMatrix(matrix);} // vertices\n\tfor(var i=0,il=vertices2.length;i < il;i++) {var vertex=vertices2[i];var vertexCopy=vertex.clone();if(matrix !== undefined)vertexCopy.applyMatrix4(matrix);vertices1.push(vertexCopy);} // faces\n\tfor(i = 0,il = faces2.length;i < il;i++) {var face=faces2[i],faceCopy,normal,color,faceVertexNormals=face.vertexNormals,faceVertexColors=face.vertexColors;faceCopy = new THREE.Face3(face.a + vertexOffset,face.b + vertexOffset,face.c + vertexOffset);faceCopy.normal.copy(face.normal);if(normalMatrix !== undefined){faceCopy.normal.applyMatrix3(normalMatrix).normalize();}for(var j=0,jl=faceVertexNormals.length;j < jl;j++) {normal = faceVertexNormals[j].clone();if(normalMatrix !== undefined){normal.applyMatrix3(normalMatrix).normalize();}faceCopy.vertexNormals.push(normal);}faceCopy.color.copy(face.color);for(var j=0,jl=faceVertexColors.length;j < jl;j++) {color = faceVertexColors[j];faceCopy.vertexColors.push(color.clone());}faceCopy.materialIndex = face.materialIndex + materialIndexOffset;faces1.push(faceCopy);} // uvs\n\tfor(i = 0,il = uvs2.length;i < il;i++) {var uv=uvs2[i],uvCopy=[];if(uv === undefined){continue;}for(var j=0,jl=uv.length;j < jl;j++) {uvCopy.push(uv[j].clone());}uvs1.push(uvCopy);}},mergeMesh:function mergeMesh(mesh){if(mesh instanceof THREE.Mesh === false){console.error('THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.',mesh);return;}mesh.matrixAutoUpdate && mesh.updateMatrix();this.merge(mesh.geometry,mesh.matrix);}, /*\n\t\t * Checks for duplicate vertices with hashmap.\n\t\t * Duplicated vertices are removed\n\t\t * and faces' vertices are updated.\n\t\t */mergeVertices:function mergeVertices(){var verticesMap={}; // Hashmap for looking up vertices by position coordinates (and making sure they are unique)\n\tvar unique=[],changes=[];var v,key;var precisionPoints=4; // number of decimal points, e.g. 4 for epsilon of 0.0001\n\tvar precision=Math.pow(10,precisionPoints);var i,il,face;var indices,j,jl;for(i = 0,il = this.vertices.length;i < il;i++) {v = this.vertices[i];key = Math.round(v.x * precision) + '_' + Math.round(v.y * precision) + '_' + Math.round(v.z * precision);if(verticesMap[key] === undefined){verticesMap[key] = i;unique.push(this.vertices[i]);changes[i] = unique.length - 1;}else { //console.log('Duplicate vertex found. ', i, ' could be using ', verticesMap[key]);\n\tchanges[i] = changes[verticesMap[key]];}} // if faces are completely degenerate after merging vertices, we\n\t// have to remove them from the geometry.\n\tvar faceIndicesToRemove=[];for(i = 0,il = this.faces.length;i < il;i++) {face = this.faces[i];face.a = changes[face.a];face.b = changes[face.b];face.c = changes[face.c];indices = [face.a,face.b,face.c];var dupIndex=-1; // if any duplicate vertices are found in a Face3\n\t// we have to remove the face as nothing can be saved\n\tfor(var n=0;n < 3;n++) {if(indices[n] === indices[(n + 1) % 3]){dupIndex = n;faceIndicesToRemove.push(i);break;}}}for(i = faceIndicesToRemove.length - 1;i >= 0;i--) {var idx=faceIndicesToRemove[i];this.faces.splice(idx,1);for(j = 0,jl = this.faceVertexUvs.length;j < jl;j++) {this.faceVertexUvs[j].splice(idx,1);}} // Use unique set of vertices\n\tvar diff=this.vertices.length - unique.length;this.vertices = unique;return diff;},toJSON:function toJSON(){var data={metadata:{version:4.4,type:'Geometry',generator:'Geometry.toJSON'}}; // standard Geometry serialization\n\tdata.uuid = this.uuid;data.type = this.type;if(this.name !== '')data.name = this.name;if(this.parameters !== undefined){var parameters=this.parameters;for(var key in parameters) {if(parameters[key] !== undefined)data[key] = parameters[key];}return data;}var vertices=[];for(var i=0;i < this.vertices.length;i++) {var vertex=this.vertices[i];vertices.push(vertex.x,vertex.y,vertex.z);}var faces=[];var normals=[];var normalsHash={};var colors=[];var colorsHash={};var uvs=[];var uvsHash={};for(var i=0;i < this.faces.length;i++) {var face=this.faces[i];var hasMaterial=false; // face.materialIndex !== undefined;\n\tvar hasFaceUv=false; // deprecated\n\tvar hasFaceVertexUv=this.faceVertexUvs[0][i] !== undefined;var hasFaceNormal=face.normal.length() > 0;var hasFaceVertexNormal=face.vertexNormals.length > 0;var hasFaceColor=face.color.r !== 1 || face.color.g !== 1 || face.color.b !== 1;var hasFaceVertexColor=face.vertexColors.length > 0;var faceType=0;faceType = setBit(faceType,0,0);faceType = setBit(faceType,1,hasMaterial);faceType = setBit(faceType,2,hasFaceUv);faceType = setBit(faceType,3,hasFaceVertexUv);faceType = setBit(faceType,4,hasFaceNormal);faceType = setBit(faceType,5,hasFaceVertexNormal);faceType = setBit(faceType,6,hasFaceColor);faceType = setBit(faceType,7,hasFaceVertexColor);faces.push(faceType);faces.push(face.a,face.b,face.c);if(hasFaceVertexUv){var faceVertexUvs=this.faceVertexUvs[0][i];faces.push(getUvIndex(faceVertexUvs[0]),getUvIndex(faceVertexUvs[1]),getUvIndex(faceVertexUvs[2]));}if(hasFaceNormal){faces.push(getNormalIndex(face.normal));}if(hasFaceVertexNormal){var vertexNormals=face.vertexNormals;faces.push(getNormalIndex(vertexNormals[0]),getNormalIndex(vertexNormals[1]),getNormalIndex(vertexNormals[2]));}if(hasFaceColor){faces.push(getColorIndex(face.color));}if(hasFaceVertexColor){var vertexColors=face.vertexColors;faces.push(getColorIndex(vertexColors[0]),getColorIndex(vertexColors[1]),getColorIndex(vertexColors[2]));}}function setBit(value,position,enabled){return enabled?value | 1 << position:value & ~(1 << position);}function getNormalIndex(normal){var hash=normal.x.toString() + normal.y.toString() + normal.z.toString();if(normalsHash[hash] !== undefined){return normalsHash[hash];}normalsHash[hash] = normals.length / 3;normals.push(normal.x,normal.y,normal.z);return normalsHash[hash];}function getColorIndex(color){var hash=color.r.toString() + color.g.toString() + color.b.toString();if(colorsHash[hash] !== undefined){return colorsHash[hash];}colorsHash[hash] = colors.length;colors.push(color.getHex());return colorsHash[hash];}function getUvIndex(uv){var hash=uv.x.toString() + uv.y.toString();if(uvsHash[hash] !== undefined){return uvsHash[hash];}uvsHash[hash] = uvs.length / 2;uvs.push(uv.x,uv.y);return uvsHash[hash];}data.data = {};data.data.vertices = vertices;data.data.normals = normals;if(colors.length > 0)data.data.colors = colors;if(uvs.length > 0)data.data.uvs = [uvs]; // temporal backward compatibility\n\tdata.data.faces = faces;return data;},clone:function clone(){return new this.constructor().copy(this);},copy:function copy(source){this.vertices = [];this.faces = [];this.faceVertexUvs = [[]];var vertices=source.vertices;for(var i=0,il=vertices.length;i < il;i++) {this.vertices.push(vertices[i].clone());}var faces=source.faces;for(var i=0,il=faces.length;i < il;i++) {this.faces.push(faces[i].clone());}for(var i=0,il=source.faceVertexUvs.length;i < il;i++) {var faceVertexUvs=source.faceVertexUvs[i];if(this.faceVertexUvs[i] === undefined){this.faceVertexUvs[i] = [];}for(var j=0,jl=faceVertexUvs.length;j < jl;j++) {var uvs=faceVertexUvs[j],uvsCopy=[];for(var k=0,kl=uvs.length;k < kl;k++) {var uv=uvs[k];uvsCopy.push(uv.clone());}this.faceVertexUvs[i].push(uvsCopy);}}return this;},dispose:function dispose(){this.dispatchEvent({type:'dispose'});}};THREE.EventDispatcher.prototype.apply(THREE.Geometry.prototype);THREE.GeometryIdCount = 0; // File:src/core/DirectGeometry.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */THREE.DirectGeometry = function(){Object.defineProperty(this,'id',{value:THREE.GeometryIdCount++});this.uuid = THREE.Math.generateUUID();this.name = '';this.type = 'DirectGeometry';this.indices = [];this.vertices = [];this.normals = [];this.colors = [];this.uvs = [];this.uvs2 = [];this.groups = [];this.morphTargets = {};this.skinWeights = [];this.skinIndices = []; // this.lineDistances = [];\n\tthis.boundingBox = null;this.boundingSphere = null; // update flags\n\tthis.verticesNeedUpdate = false;this.normalsNeedUpdate = false;this.colorsNeedUpdate = false;this.uvsNeedUpdate = false;this.groupsNeedUpdate = false;};THREE.DirectGeometry.prototype = {constructor:THREE.DirectGeometry,computeBoundingBox:THREE.Geometry.prototype.computeBoundingBox,computeBoundingSphere:THREE.Geometry.prototype.computeBoundingSphere,computeFaceNormals:function computeFaceNormals(){console.warn('THREE.DirectGeometry: computeFaceNormals() is not a method of this type of geometry.');},computeVertexNormals:function computeVertexNormals(){console.warn('THREE.DirectGeometry: computeVertexNormals() is not a method of this type of geometry.');},computeGroups:function computeGroups(geometry){var group;var groups=[];var materialIndex;var faces=geometry.faces;for(var i=0;i < faces.length;i++) {var face=faces[i]; // materials\n\tif(face.materialIndex !== materialIndex){materialIndex = face.materialIndex;if(group !== undefined){group.count = i * 3 - group.start;groups.push(group);}group = {start:i * 3,materialIndex:materialIndex};}}if(group !== undefined){group.count = i * 3 - group.start;groups.push(group);}this.groups = groups;},fromGeometry:function fromGeometry(geometry){var faces=geometry.faces;var vertices=geometry.vertices;var faceVertexUvs=geometry.faceVertexUvs;var hasFaceVertexUv=faceVertexUvs[0] && faceVertexUvs[0].length > 0;var hasFaceVertexUv2=faceVertexUvs[1] && faceVertexUvs[1].length > 0; // morphs\n\tvar morphTargets=geometry.morphTargets;var morphTargetsLength=morphTargets.length;if(morphTargetsLength > 0){var morphTargetsPosition=[];for(var i=0;i < morphTargetsLength;i++) {morphTargetsPosition[i] = [];}this.morphTargets.position = morphTargetsPosition;}var morphNormals=geometry.morphNormals;var morphNormalsLength=morphNormals.length;if(morphNormalsLength > 0){var morphTargetsNormal=[];for(var i=0;i < morphNormalsLength;i++) {morphTargetsNormal[i] = [];}this.morphTargets.normal = morphTargetsNormal;} // skins\n\tvar skinIndices=geometry.skinIndices;var skinWeights=geometry.skinWeights;var hasSkinIndices=skinIndices.length === vertices.length;var hasSkinWeights=skinWeights.length === vertices.length; //\n\tfor(var i=0;i < faces.length;i++) {var face=faces[i];this.vertices.push(vertices[face.a],vertices[face.b],vertices[face.c]);var vertexNormals=face.vertexNormals;if(vertexNormals.length === 3){this.normals.push(vertexNormals[0],vertexNormals[1],vertexNormals[2]);}else {var normal=face.normal;this.normals.push(normal,normal,normal);}var vertexColors=face.vertexColors;if(vertexColors.length === 3){this.colors.push(vertexColors[0],vertexColors[1],vertexColors[2]);}else {var color=face.color;this.colors.push(color,color,color);}if(hasFaceVertexUv === true){var vertexUvs=faceVertexUvs[0][i];if(vertexUvs !== undefined){this.uvs.push(vertexUvs[0],vertexUvs[1],vertexUvs[2]);}else {console.warn('THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ',i);this.uvs.push(new THREE.Vector2(),new THREE.Vector2(),new THREE.Vector2());}}if(hasFaceVertexUv2 === true){var vertexUvs=faceVertexUvs[1][i];if(vertexUvs !== undefined){this.uvs2.push(vertexUvs[0],vertexUvs[1],vertexUvs[2]);}else {console.warn('THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ',i);this.uvs2.push(new THREE.Vector2(),new THREE.Vector2(),new THREE.Vector2());}} // morphs\n\tfor(var j=0;j < morphTargetsLength;j++) {var morphTarget=morphTargets[j].vertices;morphTargetsPosition[j].push(morphTarget[face.a],morphTarget[face.b],morphTarget[face.c]);}for(var j=0;j < morphNormalsLength;j++) {var morphNormal=morphNormals[j].vertexNormals[i];morphTargetsNormal[j].push(morphNormal.a,morphNormal.b,morphNormal.c);} // skins\n\tif(hasSkinIndices){this.skinIndices.push(skinIndices[face.a],skinIndices[face.b],skinIndices[face.c]);}if(hasSkinWeights){this.skinWeights.push(skinWeights[face.a],skinWeights[face.b],skinWeights[face.c]);}}this.computeGroups(geometry);this.verticesNeedUpdate = geometry.verticesNeedUpdate;this.normalsNeedUpdate = geometry.normalsNeedUpdate;this.colorsNeedUpdate = geometry.colorsNeedUpdate;this.uvsNeedUpdate = geometry.uvsNeedUpdate;this.groupsNeedUpdate = geometry.groupsNeedUpdate;return this;},dispose:function dispose(){this.dispatchEvent({type:'dispose'});}};THREE.EventDispatcher.prototype.apply(THREE.DirectGeometry.prototype); // File:src/core/BufferGeometry.js\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author mrdoob / http://mrdoob.com/\n\t */THREE.BufferGeometry = function(){Object.defineProperty(this,'id',{value:THREE.GeometryIdCount++});this.uuid = THREE.Math.generateUUID();this.name = '';this.type = 'BufferGeometry';this.index = null;this.attributes = {};this.morphAttributes = {};this.groups = [];this.boundingBox = null;this.boundingSphere = null;this.drawRange = {start:0,count:Infinity};};THREE.BufferGeometry.prototype = _Object$defineProperties({constructor:THREE.BufferGeometry,addIndex:function addIndex(index){console.warn('THREE.BufferGeometry: .addIndex() has been renamed to .setIndex().');this.setIndex(index);},getIndex:function getIndex(){return this.index;},setIndex:function setIndex(index){this.index = index;},addAttribute:function addAttribute(name,attribute){if(attribute instanceof THREE.BufferAttribute === false && attribute instanceof THREE.InterleavedBufferAttribute === false){console.warn('THREE.BufferGeometry: .addAttribute() now expects ( name, attribute ).');this.addAttribute(name,new THREE.BufferAttribute(arguments[1],arguments[2]));return;}if(name === 'index'){console.warn('THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute.');this.setIndex(attribute);}this.attributes[name] = attribute;},getAttribute:function getAttribute(name){return this.attributes[name];},removeAttribute:function removeAttribute(name){delete this.attributes[name];},addDrawCall:function addDrawCall(start,count,indexOffset){if(indexOffset !== undefined){console.warn('THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset.');}console.warn('THREE.BufferGeometry: .addDrawCall() is now .addGroup().');this.addGroup(start,count);},clearDrawCalls:function clearDrawCalls(){console.warn('THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups().');this.clearGroups();},addGroup:function addGroup(start,count,materialIndex){this.groups.push({start:start,count:count,materialIndex:materialIndex !== undefined?materialIndex:0});},clearGroups:function clearGroups(){this.groups = [];},setDrawRange:function setDrawRange(start,count){this.drawRange.start = start;this.drawRange.count = count;},applyMatrix:function applyMatrix(matrix){var position=this.attributes.position;if(position !== undefined){matrix.applyToVector3Array(position.array);position.needsUpdate = true;}var normal=this.attributes.normal;if(normal !== undefined){var normalMatrix=new THREE.Matrix3().getNormalMatrix(matrix);normalMatrix.applyToVector3Array(normal.array);normal.needsUpdate = true;}if(this.boundingBox !== null){this.computeBoundingBox();}if(this.boundingSphere !== null){this.computeBoundingSphere();}},rotateX:(function(){ // rotate geometry around world x-axis\n\tvar m1;return function rotateX(angle){if(m1 === undefined)m1 = new THREE.Matrix4();m1.makeRotationX(angle);this.applyMatrix(m1);return this;};})(),rotateY:(function(){ // rotate geometry around world y-axis\n\tvar m1;return function rotateY(angle){if(m1 === undefined)m1 = new THREE.Matrix4();m1.makeRotationY(angle);this.applyMatrix(m1);return this;};})(),rotateZ:(function(){ // rotate geometry around world z-axis\n\tvar m1;return function rotateZ(angle){if(m1 === undefined)m1 = new THREE.Matrix4();m1.makeRotationZ(angle);this.applyMatrix(m1);return this;};})(),translate:(function(){ // translate geometry\n\tvar m1;return function translate(x,y,z){if(m1 === undefined)m1 = new THREE.Matrix4();m1.makeTranslation(x,y,z);this.applyMatrix(m1);return this;};})(),scale:(function(){ // scale geometry\n\tvar m1;return function scale(x,y,z){if(m1 === undefined)m1 = new THREE.Matrix4();m1.makeScale(x,y,z);this.applyMatrix(m1);return this;};})(),lookAt:(function(){var obj;return function lookAt(vector){if(obj === undefined)obj = new THREE.Object3D();obj.lookAt(vector);obj.updateMatrix();this.applyMatrix(obj.matrix);};})(),center:function center(){this.computeBoundingBox();var offset=this.boundingBox.center().negate();this.translate(offset.x,offset.y,offset.z);return offset;},setFromObject:function setFromObject(object){ // console.log( 'THREE.BufferGeometry.setFromObject(). Converting', object, this );\n\tvar geometry=object.geometry;if(object instanceof THREE.Points || object instanceof THREE.Line){var positions=new THREE.Float32Attribute(geometry.vertices.length * 3,3);var colors=new THREE.Float32Attribute(geometry.colors.length * 3,3);this.addAttribute('position',positions.copyVector3sArray(geometry.vertices));this.addAttribute('color',colors.copyColorsArray(geometry.colors));if(geometry.lineDistances && geometry.lineDistances.length === geometry.vertices.length){var lineDistances=new THREE.Float32Attribute(geometry.lineDistances.length,1);this.addAttribute('lineDistance',lineDistances.copyArray(geometry.lineDistances));}if(geometry.boundingSphere !== null){this.boundingSphere = geometry.boundingSphere.clone();}if(geometry.boundingBox !== null){this.boundingBox = geometry.boundingBox.clone();}}else if(object instanceof THREE.Mesh){if(geometry instanceof THREE.Geometry){this.fromGeometry(geometry);}}return this;},updateFromObject:function updateFromObject(object){var geometry=object.geometry;if(object instanceof THREE.Mesh){var direct=geometry.__directGeometry;if(direct === undefined){return this.fromGeometry(geometry);}direct.verticesNeedUpdate = geometry.verticesNeedUpdate;direct.normalsNeedUpdate = geometry.normalsNeedUpdate;direct.colorsNeedUpdate = geometry.colorsNeedUpdate;direct.uvsNeedUpdate = geometry.uvsNeedUpdate;direct.groupsNeedUpdate = geometry.groupsNeedUpdate;geometry.verticesNeedUpdate = false;geometry.normalsNeedUpdate = false;geometry.colorsNeedUpdate = false;geometry.uvsNeedUpdate = false;geometry.groupsNeedUpdate = false;geometry = direct;}if(geometry.verticesNeedUpdate === true){var attribute=this.attributes.position;if(attribute !== undefined){attribute.copyVector3sArray(geometry.vertices);attribute.needsUpdate = true;}geometry.verticesNeedUpdate = false;}if(geometry.normalsNeedUpdate === true){var attribute=this.attributes.normal;if(attribute !== undefined){attribute.copyVector3sArray(geometry.normals);attribute.needsUpdate = true;}geometry.normalsNeedUpdate = false;}if(geometry.colorsNeedUpdate === true){var attribute=this.attributes.color;if(attribute !== undefined){attribute.copyColorsArray(geometry.colors);attribute.needsUpdate = true;}geometry.colorsNeedUpdate = false;}if(geometry.lineDistancesNeedUpdate){var attribute=this.attributes.lineDistance;if(attribute !== undefined){attribute.copyArray(geometry.lineDistances);attribute.needsUpdate = true;}geometry.lineDistancesNeedUpdate = false;}if(geometry.groupsNeedUpdate){geometry.computeGroups(object.geometry);this.groups = geometry.groups;geometry.groupsNeedUpdate = false;}return this;},fromGeometry:function fromGeometry(geometry){geometry.__directGeometry = new THREE.DirectGeometry().fromGeometry(geometry);return this.fromDirectGeometry(geometry.__directGeometry);},fromDirectGeometry:function fromDirectGeometry(geometry){var positions=new Float32Array(geometry.vertices.length * 3);this.addAttribute('position',new THREE.BufferAttribute(positions,3).copyVector3sArray(geometry.vertices));if(geometry.normals.length > 0){var normals=new Float32Array(geometry.normals.length * 3);this.addAttribute('normal',new THREE.BufferAttribute(normals,3).copyVector3sArray(geometry.normals));}if(geometry.colors.length > 0){var colors=new Float32Array(geometry.colors.length * 3);this.addAttribute('color',new THREE.BufferAttribute(colors,3).copyColorsArray(geometry.colors));}if(geometry.uvs.length > 0){var uvs=new Float32Array(geometry.uvs.length * 2);this.addAttribute('uv',new THREE.BufferAttribute(uvs,2).copyVector2sArray(geometry.uvs));}if(geometry.uvs2.length > 0){var uvs2=new Float32Array(geometry.uvs2.length * 2);this.addAttribute('uv2',new THREE.BufferAttribute(uvs2,2).copyVector2sArray(geometry.uvs2));}if(geometry.indices.length > 0){var TypeArray=geometry.vertices.length > 65535?Uint32Array:Uint16Array;var indices=new TypeArray(geometry.indices.length * 3);this.setIndex(new THREE.BufferAttribute(indices,1).copyIndicesArray(geometry.indices));} // groups\n\tthis.groups = geometry.groups; // morphs\n\tfor(var name in geometry.morphTargets) {var array=[];var morphTargets=geometry.morphTargets[name];for(var i=0,l=morphTargets.length;i < l;i++) {var morphTarget=morphTargets[i];var attribute=new THREE.Float32Attribute(morphTarget.length * 3,3);array.push(attribute.copyVector3sArray(morphTarget));}this.morphAttributes[name] = array;} // skinning\n\tif(geometry.skinIndices.length > 0){var skinIndices=new THREE.Float32Attribute(geometry.skinIndices.length * 4,4);this.addAttribute('skinIndex',skinIndices.copyVector4sArray(geometry.skinIndices));}if(geometry.skinWeights.length > 0){var skinWeights=new THREE.Float32Attribute(geometry.skinWeights.length * 4,4);this.addAttribute('skinWeight',skinWeights.copyVector4sArray(geometry.skinWeights));} //\n\tif(geometry.boundingSphere !== null){this.boundingSphere = geometry.boundingSphere.clone();}if(geometry.boundingBox !== null){this.boundingBox = geometry.boundingBox.clone();}return this;},computeBoundingBox:(function(){var vector=new THREE.Vector3();return function(){if(this.boundingBox === null){this.boundingBox = new THREE.Box3();}var positions=this.attributes.position.array;if(positions){var bb=this.boundingBox;bb.makeEmpty();for(var i=0,il=positions.length;i < il;i += 3) {vector.fromArray(positions,i);bb.expandByPoint(vector);}}if(positions === undefined || positions.length === 0){this.boundingBox.min.set(0,0,0);this.boundingBox.max.set(0,0,0);}if(isNaN(this.boundingBox.min.x) || isNaN(this.boundingBox.min.y) || isNaN(this.boundingBox.min.z)){console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The \"position\" attribute is likely to have NaN values.',this);}};})(),computeBoundingSphere:(function(){var box=new THREE.Box3();var vector=new THREE.Vector3();return function(){if(this.boundingSphere === null){this.boundingSphere = new THREE.Sphere();}var positions=this.attributes.position.array;if(positions){box.makeEmpty();var center=this.boundingSphere.center;for(var i=0,il=positions.length;i < il;i += 3) {vector.fromArray(positions,i);box.expandByPoint(vector);}box.center(center); // hoping to find a boundingSphere with a radius smaller than the\n\t// boundingSphere of the boundingBox: sqrt(3) smaller in the best case\n\tvar maxRadiusSq=0;for(var i=0,il=positions.length;i < il;i += 3) {vector.fromArray(positions,i);maxRadiusSq = Math.max(maxRadiusSq,center.distanceToSquared(vector));}this.boundingSphere.radius = Math.sqrt(maxRadiusSq);if(isNaN(this.boundingSphere.radius)){console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The \"position\" attribute is likely to have NaN values.',this);}}};})(),computeFaceNormals:function computeFaceNormals(){ // backwards compatibility\n\t},computeVertexNormals:function computeVertexNormals(){var index=this.index;var attributes=this.attributes;var groups=this.groups;if(attributes.position){var positions=attributes.position.array;if(attributes.normal === undefined){this.addAttribute('normal',new THREE.BufferAttribute(new Float32Array(positions.length),3));}else { // reset existing normals to zero\n\tvar normals=attributes.normal.array;for(var i=0,il=normals.length;i < il;i++) {normals[i] = 0;}}var normals=attributes.normal.array;var vA,vB,vC,pA=new THREE.Vector3(),pB=new THREE.Vector3(),pC=new THREE.Vector3(),cb=new THREE.Vector3(),ab=new THREE.Vector3(); // indexed elements\n\tif(index){var indices=index.array;if(groups.length === 0){this.addGroup(0,indices.length);}for(var j=0,jl=groups.length;j < jl;++j) {var group=groups[j];var start=group.start;var count=group.count;for(var i=start,il=start + count;i < il;i += 3) {vA = indices[i + 0] * 3;vB = indices[i + 1] * 3;vC = indices[i + 2] * 3;pA.fromArray(positions,vA);pB.fromArray(positions,vB);pC.fromArray(positions,vC);cb.subVectors(pC,pB);ab.subVectors(pA,pB);cb.cross(ab);normals[vA] += cb.x;normals[vA + 1] += cb.y;normals[vA + 2] += cb.z;normals[vB] += cb.x;normals[vB + 1] += cb.y;normals[vB + 2] += cb.z;normals[vC] += cb.x;normals[vC + 1] += cb.y;normals[vC + 2] += cb.z;}}}else { // non-indexed elements (unconnected triangle soup)\n\tfor(var i=0,il=positions.length;i < il;i += 9) {pA.fromArray(positions,i);pB.fromArray(positions,i + 3);pC.fromArray(positions,i + 6);cb.subVectors(pC,pB);ab.subVectors(pA,pB);cb.cross(ab);normals[i] = cb.x;normals[i + 1] = cb.y;normals[i + 2] = cb.z;normals[i + 3] = cb.x;normals[i + 4] = cb.y;normals[i + 5] = cb.z;normals[i + 6] = cb.x;normals[i + 7] = cb.y;normals[i + 8] = cb.z;}}this.normalizeNormals();attributes.normal.needsUpdate = true;}},computeTangents:function computeTangents(){console.warn('THREE.BufferGeometry: .computeTangents() has been removed.');},computeOffsets:function computeOffsets(size){console.warn('THREE.BufferGeometry: .computeOffsets() has been removed.');},merge:function merge(geometry,offset){if(geometry instanceof THREE.BufferGeometry === false){console.error('THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.',geometry);return;}if(offset === undefined)offset = 0;var attributes=this.attributes;for(var key in attributes) {if(geometry.attributes[key] === undefined)continue;var attribute1=attributes[key];var attributeArray1=attribute1.array;var attribute2=geometry.attributes[key];var attributeArray2=attribute2.array;var attributeSize=attribute2.itemSize;for(var i=0,j=attributeSize * offset;i < attributeArray2.length;i++,j++) {attributeArray1[j] = attributeArray2[i];}}return this;},normalizeNormals:function normalizeNormals(){var normals=this.attributes.normal.array;var x,y,z,n;for(var i=0,il=normals.length;i < il;i += 3) {x = normals[i];y = normals[i + 1];z = normals[i + 2];n = 1.0 / Math.sqrt(x * x + y * y + z * z);normals[i] *= n;normals[i + 1] *= n;normals[i + 2] *= n;}},toJSON:function toJSON(){var data={metadata:{version:4.4,type:'BufferGeometry',generator:'BufferGeometry.toJSON'}}; // standard BufferGeometry serialization\n\tdata.uuid = this.uuid;data.type = this.type;if(this.name !== '')data.name = this.name;if(this.parameters !== undefined){var parameters=this.parameters;for(var key in parameters) {if(parameters[key] !== undefined)data[key] = parameters[key];}return data;}data.data = {attributes:{}};var index=this.index;if(index !== null){var array=Array.prototype.slice.call(index.array);data.data.index = {type:index.array.constructor.name,array:array};}var attributes=this.attributes;for(var key in attributes) {var attribute=attributes[key];var array=Array.prototype.slice.call(attribute.array);data.data.attributes[key] = {itemSize:attribute.itemSize,type:attribute.array.constructor.name,array:array};}var groups=this.groups;if(groups.length > 0){data.data.groups = JSON.parse(JSON.stringify(groups));}var boundingSphere=this.boundingSphere;if(boundingSphere !== null){data.data.boundingSphere = {center:boundingSphere.center.toArray(),radius:boundingSphere.radius};}return data;},clone:function clone(){return new this.constructor().copy(this);},copy:function copy(source){var index=source.index;if(index !== null){this.setIndex(index.clone());}var attributes=source.attributes;for(var name in attributes) {var attribute=attributes[name];this.addAttribute(name,attribute.clone());}var groups=source.groups;for(var i=0,l=groups.length;i < l;i++) {var group=groups[i];this.addGroup(group.start,group.count);}return this;},dispose:function dispose(){this.dispatchEvent({type:'dispose'});}},{drawcalls:{get:function get(){console.error('THREE.BufferGeometry: .drawcalls has been renamed to .groups.');return this.groups;},configurable:true,enumerable:true},offsets:{get:function get(){console.warn('THREE.BufferGeometry: .offsets has been renamed to .groups.');return this.groups;},configurable:true,enumerable:true}});THREE.EventDispatcher.prototype.apply(THREE.BufferGeometry.prototype);THREE.BufferGeometry.MaxIndex = 65535; // File:src/core/InstancedBufferGeometry.js\n\t/**\n\t * @author benaadams / https://twitter.com/ben_a_adams\n\t */THREE.InstancedBufferGeometry = function(){THREE.BufferGeometry.call(this);this.type = 'InstancedBufferGeometry';this.maxInstancedCount = undefined;};THREE.InstancedBufferGeometry.prototype = _Object$create(THREE.BufferGeometry.prototype);THREE.InstancedBufferGeometry.prototype.constructor = THREE.InstancedBufferGeometry;THREE.InstancedBufferGeometry.prototype.addGroup = function(start,count,instances){this.groups.push({start:start,count:count,instances:instances});};THREE.InstancedBufferGeometry.prototype.copy = function(source){var index=source.index;if(index !== null){this.setIndex(index.clone());}var attributes=source.attributes;for(var name in attributes) {var attribute=attributes[name];this.addAttribute(name,attribute.clone());}var groups=source.groups;for(var i=0,l=groups.length;i < l;i++) {var group=groups[i];this.addGroup(group.start,group.count,group.instances);}return this;};THREE.EventDispatcher.prototype.apply(THREE.InstancedBufferGeometry.prototype); // File:src/cameras/Camera.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author mikael emtinger / http://gomo.se/\n\t * @author WestLangley / http://github.com/WestLangley\n\t*/THREE.Camera = function(){THREE.Object3D.call(this);this.type = 'Camera';this.matrixWorldInverse = new THREE.Matrix4();this.projectionMatrix = new THREE.Matrix4();};THREE.Camera.prototype = _Object$create(THREE.Object3D.prototype);THREE.Camera.prototype.constructor = THREE.Camera;THREE.Camera.prototype.getWorldDirection = (function(){var quaternion=new THREE.Quaternion();return function(optionalTarget){var result=optionalTarget || new THREE.Vector3();this.getWorldQuaternion(quaternion);return result.set(0,0,-1).applyQuaternion(quaternion);};})();THREE.Camera.prototype.lookAt = (function(){ // This routine does not support cameras with rotated and/or translated parent(s)\n\tvar m1=new THREE.Matrix4();return function(vector){m1.lookAt(this.position,vector,this.up);this.quaternion.setFromRotationMatrix(m1);};})();THREE.Camera.prototype.clone = function(){return new this.constructor().copy(this);};THREE.Camera.prototype.copy = function(source){THREE.Object3D.prototype.copy.call(this,source);this.matrixWorldInverse.copy(source.matrixWorldInverse);this.projectionMatrix.copy(source.projectionMatrix);return this;}; // File:src/cameras/CubeCamera.js\n\t/**\n\t * Camera for rendering cube maps\n\t *\t- renders scene into axis-aligned cube\n\t *\n\t * @author alteredq / http://alteredqualia.com/\n\t */THREE.CubeCamera = function(near,far,cubeResolution){THREE.Object3D.call(this);this.type = 'CubeCamera';var fov=90,aspect=1;var cameraPX=new THREE.PerspectiveCamera(fov,aspect,near,far);cameraPX.up.set(0,-1,0);cameraPX.lookAt(new THREE.Vector3(1,0,0));this.add(cameraPX);var cameraNX=new THREE.PerspectiveCamera(fov,aspect,near,far);cameraNX.up.set(0,-1,0);cameraNX.lookAt(new THREE.Vector3(-1,0,0));this.add(cameraNX);var cameraPY=new THREE.PerspectiveCamera(fov,aspect,near,far);cameraPY.up.set(0,0,1);cameraPY.lookAt(new THREE.Vector3(0,1,0));this.add(cameraPY);var cameraNY=new THREE.PerspectiveCamera(fov,aspect,near,far);cameraNY.up.set(0,0,-1);cameraNY.lookAt(new THREE.Vector3(0,-1,0));this.add(cameraNY);var cameraPZ=new THREE.PerspectiveCamera(fov,aspect,near,far);cameraPZ.up.set(0,-1,0);cameraPZ.lookAt(new THREE.Vector3(0,0,1));this.add(cameraPZ);var cameraNZ=new THREE.PerspectiveCamera(fov,aspect,near,far);cameraNZ.up.set(0,-1,0);cameraNZ.lookAt(new THREE.Vector3(0,0,-1));this.add(cameraNZ);this.renderTarget = new THREE.WebGLRenderTargetCube(cubeResolution,cubeResolution,{format:THREE.RGBFormat,magFilter:THREE.LinearFilter,minFilter:THREE.LinearFilter});this.updateCubeMap = function(renderer,scene){if(this.parent === null)this.updateMatrixWorld();var renderTarget=this.renderTarget;var generateMipmaps=renderTarget.generateMipmaps;renderTarget.generateMipmaps = false;renderTarget.activeCubeFace = 0;renderer.render(scene,cameraPX,renderTarget);renderTarget.activeCubeFace = 1;renderer.render(scene,cameraNX,renderTarget);renderTarget.activeCubeFace = 2;renderer.render(scene,cameraPY,renderTarget);renderTarget.activeCubeFace = 3;renderer.render(scene,cameraNY,renderTarget);renderTarget.activeCubeFace = 4;renderer.render(scene,cameraPZ,renderTarget);renderTarget.generateMipmaps = generateMipmaps;renderTarget.activeCubeFace = 5;renderer.render(scene,cameraNZ,renderTarget);renderer.setRenderTarget(null);};};THREE.CubeCamera.prototype = _Object$create(THREE.Object3D.prototype);THREE.CubeCamera.prototype.constructor = THREE.CubeCamera; // File:src/cameras/OrthographicCamera.js\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t */THREE.OrthographicCamera = function(left,right,top,bottom,near,far){THREE.Camera.call(this);this.type = 'OrthographicCamera';this.zoom = 1;this.left = left;this.right = right;this.top = top;this.bottom = bottom;this.near = near !== undefined?near:0.1;this.far = far !== undefined?far:2000;this.updateProjectionMatrix();};THREE.OrthographicCamera.prototype = _Object$create(THREE.Camera.prototype);THREE.OrthographicCamera.prototype.constructor = THREE.OrthographicCamera;THREE.OrthographicCamera.prototype.updateProjectionMatrix = function(){var dx=(this.right - this.left) / (2 * this.zoom);var dy=(this.top - this.bottom) / (2 * this.zoom);var cx=(this.right + this.left) / 2;var cy=(this.top + this.bottom) / 2;this.projectionMatrix.makeOrthographic(cx - dx,cx + dx,cy + dy,cy - dy,this.near,this.far);};THREE.OrthographicCamera.prototype.copy = function(source){THREE.Camera.prototype.copy.call(this,source);this.left = source.left;this.right = source.right;this.top = source.top;this.bottom = source.bottom;this.near = source.near;this.far = source.far;this.zoom = source.zoom;return this;};THREE.OrthographicCamera.prototype.toJSON = function(meta){var data=THREE.Object3D.prototype.toJSON.call(this,meta);data.object.zoom = this.zoom;data.object.left = this.left;data.object.right = this.right;data.object.top = this.top;data.object.bottom = this.bottom;data.object.near = this.near;data.object.far = this.far;return data;}; // File:src/cameras/PerspectiveCamera.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author greggman / http://games.greggman.com/\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\n\t */THREE.PerspectiveCamera = function(fov,aspect,near,far){THREE.Camera.call(this);this.type = 'PerspectiveCamera';this.zoom = 1;this.fov = fov !== undefined?fov:50;this.aspect = aspect !== undefined?aspect:1;this.near = near !== undefined?near:0.1;this.far = far !== undefined?far:2000;this.updateProjectionMatrix();};THREE.PerspectiveCamera.prototype = _Object$create(THREE.Camera.prototype);THREE.PerspectiveCamera.prototype.constructor = THREE.PerspectiveCamera; /**\n\t * Uses Focal Length (in mm) to estimate and set FOV\n\t * 35mm (full-frame) camera is used if frame size is not specified;\n\t * Formula based on http://www.bobatkins.com/photography/technical/field_of_view.html\n\t */THREE.PerspectiveCamera.prototype.setLens = function(focalLength,frameHeight){if(frameHeight === undefined)frameHeight = 24;this.fov = 2 * THREE.Math.radToDeg(Math.atan(frameHeight / (focalLength * 2)));this.updateProjectionMatrix();}; /**\n\t * Sets an offset in a larger frustum. This is useful for multi-window or\n\t * multi-monitor/multi-machine setups.\n\t *\n\t * For example, if you have 3x2 monitors and each monitor is 1920x1080 and\n\t * the monitors are in grid like this\n\t *\n\t *   +---+---+---+\n\t *   | A | B | C |\n\t *   +---+---+---+\n\t *   | D | E | F |\n\t *   +---+---+---+\n\t *\n\t * then for each monitor you would call it like this\n\t *\n\t *   var w = 1920;\n\t *   var h = 1080;\n\t *   var fullWidth = w * 3;\n\t *   var fullHeight = h * 2;\n\t *\n\t *   --A--\n\t *   camera.setOffset( fullWidth, fullHeight, w * 0, h * 0, w, h );\n\t *   --B--\n\t *   camera.setOffset( fullWidth, fullHeight, w * 1, h * 0, w, h );\n\t *   --C--\n\t *   camera.setOffset( fullWidth, fullHeight, w * 2, h * 0, w, h );\n\t *   --D--\n\t *   camera.setOffset( fullWidth, fullHeight, w * 0, h * 1, w, h );\n\t *   --E--\n\t *   camera.setOffset( fullWidth, fullHeight, w * 1, h * 1, w, h );\n\t *   --F--\n\t *   camera.setOffset( fullWidth, fullHeight, w * 2, h * 1, w, h );\n\t *\n\t *   Note there is no reason monitors have to be the same size or in a grid.\n\t */THREE.PerspectiveCamera.prototype.setViewOffset = function(fullWidth,fullHeight,x,y,width,height){this.fullWidth = fullWidth;this.fullHeight = fullHeight;this.x = x;this.y = y;this.width = width;this.height = height;this.updateProjectionMatrix();};THREE.PerspectiveCamera.prototype.updateProjectionMatrix = function(){var fov=THREE.Math.radToDeg(2 * Math.atan(Math.tan(THREE.Math.degToRad(this.fov) * 0.5) / this.zoom));if(this.fullWidth){var aspect=this.fullWidth / this.fullHeight;var top=Math.tan(THREE.Math.degToRad(fov * 0.5)) * this.near;var bottom=-top;var left=aspect * bottom;var right=aspect * top;var width=Math.abs(right - left);var height=Math.abs(top - bottom);this.projectionMatrix.makeFrustum(left + this.x * width / this.fullWidth,left + (this.x + this.width) * width / this.fullWidth,top - (this.y + this.height) * height / this.fullHeight,top - this.y * height / this.fullHeight,this.near,this.far);}else {this.projectionMatrix.makePerspective(fov,this.aspect,this.near,this.far);}};THREE.PerspectiveCamera.prototype.copy = function(source){THREE.Camera.prototype.copy.call(this,source);this.fov = source.fov;this.aspect = source.aspect;this.near = source.near;this.far = source.far;this.zoom = source.zoom;return this;};THREE.PerspectiveCamera.prototype.toJSON = function(meta){var data=THREE.Object3D.prototype.toJSON.call(this,meta);data.object.zoom = this.zoom;data.object.fov = this.fov;data.object.aspect = this.aspect;data.object.near = this.near;data.object.far = this.far;return data;}; // File:src/lights/Light.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author alteredq / http://alteredqualia.com/\n\t */THREE.Light = function(color){THREE.Object3D.call(this);this.type = 'Light';this.color = new THREE.Color(color);};THREE.Light.prototype = _Object$create(THREE.Object3D.prototype);THREE.Light.prototype.constructor = THREE.Light;THREE.Light.prototype.copy = function(source){THREE.Object3D.prototype.copy.call(this,source);this.color.copy(source.color);return this;}; // File:src/lights/AmbientLight.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */THREE.AmbientLight = function(color){THREE.Light.call(this,color);this.type = 'AmbientLight';};THREE.AmbientLight.prototype = _Object$create(THREE.Light.prototype);THREE.AmbientLight.prototype.constructor = THREE.AmbientLight;THREE.AmbientLight.prototype.toJSON = function(meta){var data=THREE.Object3D.prototype.toJSON.call(this,meta);data.object.color = this.color.getHex();return data;}; // File:src/lights/DirectionalLight.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author alteredq / http://alteredqualia.com/\n\t */THREE.DirectionalLight = function(color,intensity){THREE.Light.call(this,color);this.type = 'DirectionalLight';this.position.set(0,1,0);this.updateMatrix();this.target = new THREE.Object3D();this.intensity = intensity !== undefined?intensity:1;this.castShadow = false;this.onlyShadow = false;this.shadowCameraNear = 50;this.shadowCameraFar = 5000;this.shadowCameraLeft = -500;this.shadowCameraRight = 500;this.shadowCameraTop = 500;this.shadowCameraBottom = -500;this.shadowCameraVisible = false;this.shadowBias = 0;this.shadowDarkness = 0.5;this.shadowMapWidth = 512;this.shadowMapHeight = 512;this.shadowMap = null;this.shadowMapSize = null;this.shadowCamera = null;this.shadowMatrix = null;};THREE.DirectionalLight.prototype = _Object$create(THREE.Light.prototype);THREE.DirectionalLight.prototype.constructor = THREE.DirectionalLight;THREE.DirectionalLight.prototype.copy = function(source){THREE.Light.prototype.copy.call(this,source);this.intensity = source.intensity;this.target = source.target.clone();this.castShadow = source.castShadow;this.onlyShadow = source.onlyShadow;this.shadowCameraNear = source.shadowCameraNear;this.shadowCameraFar = source.shadowCameraFar;this.shadowCameraLeft = source.shadowCameraLeft;this.shadowCameraRight = source.shadowCameraRight;this.shadowCameraTop = source.shadowCameraTop;this.shadowCameraBottom = source.shadowCameraBottom;this.shadowCameraVisible = source.shadowCameraVisible;this.shadowBias = source.shadowBias;this.shadowDarkness = source.shadowDarkness;this.shadowMapWidth = source.shadowMapWidth;this.shadowMapHeight = source.shadowMapHeight;return this;};THREE.DirectionalLight.prototype.toJSON = function(meta){var data=THREE.Object3D.prototype.toJSON.call(this,meta);data.object.color = this.color.getHex();data.object.intensity = this.intensity;return data;}; // File:src/lights/HemisphereLight.js\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t */THREE.HemisphereLight = function(skyColor,groundColor,intensity){THREE.Light.call(this,skyColor);this.type = 'HemisphereLight';this.position.set(0,1,0);this.updateMatrix();this.groundColor = new THREE.Color(groundColor);this.intensity = intensity !== undefined?intensity:1;};THREE.HemisphereLight.prototype = _Object$create(THREE.Light.prototype);THREE.HemisphereLight.prototype.constructor = THREE.HemisphereLight;THREE.HemisphereLight.prototype.copy = function(source){THREE.Light.prototype.copy.call(this,source);this.groundColor.copy(source.groundColor);this.intensity = source.intensity;return this;};THREE.HemisphereLight.prototype.toJSON = function(meta){var data=THREE.Object3D.prototype.toJSON.call(this,meta);data.object.color = this.color.getHex();data.object.groundColor = this.groundColor.getHex();data.object.intensity = this.intensity;return data;}; // File:src/lights/PointLight.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */THREE.PointLight = function(color,intensity,distance,decay){THREE.Light.call(this,color);this.type = 'PointLight';this.intensity = intensity !== undefined?intensity:1;this.distance = distance !== undefined?distance:0;this.decay = decay !== undefined?decay:1; // for physically correct lights, should be 2.\n\t};THREE.PointLight.prototype = _Object$create(THREE.Light.prototype);THREE.PointLight.prototype.constructor = THREE.PointLight;THREE.PointLight.prototype.copy = function(source){THREE.Light.prototype.copy.call(this,source);this.intensity = source.intensity;this.distance = source.distance;this.decay = source.decay;return this;};THREE.PointLight.prototype.toJSON = function(meta){var data=THREE.Object3D.prototype.toJSON.call(this,meta);data.object.color = this.color.getHex();data.object.intensity = this.intensity;data.object.distance = this.distance;data.object.decay = this.decay;return data;}; // File:src/lights/SpotLight.js\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t */THREE.SpotLight = function(color,intensity,distance,angle,exponent,decay){THREE.Light.call(this,color);this.type = 'SpotLight';this.position.set(0,1,0);this.updateMatrix();this.target = new THREE.Object3D();this.intensity = intensity !== undefined?intensity:1;this.distance = distance !== undefined?distance:0;this.angle = angle !== undefined?angle:Math.PI / 3;this.exponent = exponent !== undefined?exponent:10;this.decay = decay !== undefined?decay:1; // for physically correct lights, should be 2.\n\tthis.castShadow = false;this.onlyShadow = false;this.shadowCameraNear = 50;this.shadowCameraFar = 5000;this.shadowCameraFov = 50;this.shadowCameraVisible = false;this.shadowBias = 0;this.shadowDarkness = 0.5;this.shadowMapWidth = 512;this.shadowMapHeight = 512;this.shadowMap = null;this.shadowMapSize = null;this.shadowCamera = null;this.shadowMatrix = null;};THREE.SpotLight.prototype = _Object$create(THREE.Light.prototype);THREE.SpotLight.prototype.constructor = THREE.SpotLight;THREE.SpotLight.prototype.copy = function(source){THREE.Light.prototype.copy.call(this,source);this.intensity = source.intensity;this.distance = source.distance;this.angle = source.angle;this.exponent = source.exponent;this.decay = source.decay;this.target = source.target.clone();this.castShadow = source.castShadow;this.onlyShadow = source.onlyShadow;this.shadowCameraNear = source.shadowCameraNear;this.shadowCameraFar = source.shadowCameraFar;this.shadowCameraFov = source.shadowCameraFov;this.shadowCameraVisible = source.shadowCameraVisible;this.shadowBias = source.shadowBias;this.shadowDarkness = source.shadowDarkness;this.shadowMapWidth = source.shadowMapWidth;this.shadowMapHeight = source.shadowMapHeight;return this;};THREE.SpotLight.prototype.toJSON = function(meta){var data=THREE.Object3D.prototype.toJSON.call(this,meta);data.object.color = this.color.getHex();data.object.intensity = this.intensity;data.object.distance = this.distance;data.object.angle = this.angle;data.object.exponent = this.exponent;data.object.decay = this.decay;return data;}; // File:src/loaders/Cache.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */THREE.Cache = {enabled:false,files:{},add:function add(key,file){if(this.enabled === false)return; // console.log( 'THREE.Cache', 'Adding key:', key );\n\tthis.files[key] = file;},get:function get(key){if(this.enabled === false)return; // console.log( 'THREE.Cache', 'Checking key:', key );\n\treturn this.files[key];},remove:function remove(key){delete this.files[key];},clear:function clear(){this.files = {};}}; // File:src/loaders/Loader.js\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t */THREE.Loader = function(){this.onLoadStart = function(){};this.onLoadProgress = function(){};this.onLoadComplete = function(){};};THREE.Loader.prototype = {constructor:THREE.Loader,crossOrigin:undefined,extractUrlBase:function extractUrlBase(url){var parts=url.split('/');if(parts.length === 1)return './';parts.pop();return parts.join('/') + '/';},initMaterials:function initMaterials(materials,texturePath,crossOrigin){var array=[];for(var i=0;i < materials.length;++i) {array[i] = this.createMaterial(materials[i],texturePath,crossOrigin);}return array;},createMaterial:(function(){var imageLoader;return function createMaterial(m,texturePath,crossOrigin){var scope=this;if(crossOrigin === undefined && scope.crossOrigin !== undefined)crossOrigin = scope.crossOrigin;if(imageLoader === undefined)imageLoader = new THREE.ImageLoader();function nearest_pow2(n){var l=Math.log(n) / Math.LN2;return Math.pow(2,Math.round(l));}function create_texture(where,name,sourceFile,repeat,offset,wrap,anisotropy){var fullPath=texturePath + sourceFile;var texture;var loader=THREE.Loader.Handlers.get(fullPath);if(loader !== null){texture = loader.load(fullPath);}else {texture = new THREE.Texture();loader = imageLoader;loader.setCrossOrigin(crossOrigin);loader.load(fullPath,function(image){if(THREE.Math.isPowerOfTwo(image.width) === false || THREE.Math.isPowerOfTwo(image.height) === false){var width=nearest_pow2(image.width);var height=nearest_pow2(image.height);var canvas=document.createElement('canvas');canvas.width = width;canvas.height = height;var context=canvas.getContext('2d');context.drawImage(image,0,0,width,height);texture.image = canvas;}else {texture.image = image;}texture.needsUpdate = true;});}texture.sourceFile = sourceFile;if(repeat){texture.repeat.set(repeat[0],repeat[1]);if(repeat[0] !== 1)texture.wrapS = THREE.RepeatWrapping;if(repeat[1] !== 1)texture.wrapT = THREE.RepeatWrapping;}if(offset){texture.offset.set(offset[0],offset[1]);}if(wrap){var wrapMap={'repeat':THREE.RepeatWrapping,'mirror':THREE.MirroredRepeatWrapping};if(wrapMap[wrap[0]] !== undefined)texture.wrapS = wrapMap[wrap[0]];if(wrapMap[wrap[1]] !== undefined)texture.wrapT = wrapMap[wrap[1]];}if(anisotropy){texture.anisotropy = anisotropy;}where[name] = texture;}function rgb2hex(rgb){return (rgb[0] * 255 << 16) + (rgb[1] * 255 << 8) + rgb[2] * 255;} // defaults\n\tvar mtype='MeshLambertMaterial';var mpars={}; // parameters from model file\n\tif(m.shading){var shading=m.shading.toLowerCase();if(shading === 'phong')mtype = 'MeshPhongMaterial';else if(shading === 'basic')mtype = 'MeshBasicMaterial';}if(m.blending !== undefined && THREE[m.blending] !== undefined){mpars.blending = THREE[m.blending];}if(m.transparent !== undefined){mpars.transparent = m.transparent;}if(m.opacity !== undefined && m.opacity < 1.0){mpars.transparent = true;}if(m.depthTest !== undefined){mpars.depthTest = m.depthTest;}if(m.depthWrite !== undefined){mpars.depthWrite = m.depthWrite;}if(m.visible !== undefined){mpars.visible = m.visible;}if(m.flipSided !== undefined){mpars.side = THREE.BackSide;}if(m.doubleSided !== undefined){mpars.side = THREE.DoubleSide;}if(m.wireframe !== undefined){mpars.wireframe = m.wireframe;}if(m.vertexColors !== undefined){if(m.vertexColors === 'face'){mpars.vertexColors = THREE.FaceColors;}else if(m.vertexColors){mpars.vertexColors = THREE.VertexColors;}} // colors\n\tif(m.colorDiffuse){mpars.color = rgb2hex(m.colorDiffuse);}else if(m.DbgColor){mpars.color = m.DbgColor;}if(m.colorEmissive){mpars.emissive = rgb2hex(m.colorEmissive);}if(mtype === 'MeshPhongMaterial'){if(m.colorSpecular){mpars.specular = rgb2hex(m.colorSpecular);}if(m.specularCoef){mpars.shininess = m.specularCoef;}} // modifiers\n\tif(m.transparency !== undefined){console.warn('THREE.Loader: transparency has been renamed to opacity');m.opacity = m.transparency;}if(m.opacity !== undefined){mpars.opacity = m.opacity;} // textures\n\tif(texturePath){if(m.mapDiffuse){create_texture(mpars,'map',m.mapDiffuse,m.mapDiffuseRepeat,m.mapDiffuseOffset,m.mapDiffuseWrap,m.mapDiffuseAnisotropy);}if(m.mapLight){create_texture(mpars,'lightMap',m.mapLight,m.mapLightRepeat,m.mapLightOffset,m.mapLightWrap,m.mapLightAnisotropy);}if(m.mapAO){create_texture(mpars,'aoMap',m.mapAO,m.mapAORepeat,m.mapAOOffset,m.mapAOWrap,m.mapAOAnisotropy);}if(m.mapBump){create_texture(mpars,'bumpMap',m.mapBump,m.mapBumpRepeat,m.mapBumpOffset,m.mapBumpWrap,m.mapBumpAnisotropy);}if(m.mapNormal){create_texture(mpars,'normalMap',m.mapNormal,m.mapNormalRepeat,m.mapNormalOffset,m.mapNormalWrap,m.mapNormalAnisotropy);}if(m.mapSpecular){create_texture(mpars,'specularMap',m.mapSpecular,m.mapSpecularRepeat,m.mapSpecularOffset,m.mapSpecularWrap,m.mapSpecularAnisotropy);}if(m.mapAlpha){create_texture(mpars,'alphaMap',m.mapAlpha,m.mapAlphaRepeat,m.mapAlphaOffset,m.mapAlphaWrap,m.mapAlphaAnisotropy);}} //\n\tif(m.mapBumpScale){mpars.bumpScale = m.mapBumpScale;}if(m.mapNormalFactor){mpars.normalScale = new THREE.Vector2(m.mapNormalFactor,m.mapNormalFactor);}var material=new THREE[mtype](mpars);if(m.DbgName !== undefined)material.name = m.DbgName;return material;};})()};THREE.Loader.Handlers = {handlers:[],add:function add(regex,loader){this.handlers.push(regex,loader);},get:function get(file){for(var i=0,l=this.handlers.length;i < l;i += 2) {var regex=this.handlers[i];var loader=this.handlers[i + 1];if(regex.test(file)){return loader;}}return null;}}; // File:src/loaders/XHRLoader.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */THREE.XHRLoader = function(manager){this.manager = manager !== undefined?manager:THREE.DefaultLoadingManager;};THREE.XHRLoader.prototype = {constructor:THREE.XHRLoader,load:function load(url,onLoad,onProgress,onError){var scope=this;var cached=THREE.Cache.get(url);if(cached !== undefined){if(onLoad){setTimeout(function(){onLoad(cached);},0);}return cached;}var request=new XMLHttpRequest();request.open('GET',url,true);request.addEventListener('load',function(event){THREE.Cache.add(url,this.response);if(onLoad)onLoad(this.response);scope.manager.itemEnd(url);},false);if(onProgress !== undefined){request.addEventListener('progress',function(event){onProgress(event);},false);}request.addEventListener('error',function(event){if(onError)onError(event);scope.manager.itemError(url);},false);if(this.crossOrigin !== undefined)request.crossOrigin = this.crossOrigin;if(this.responseType !== undefined)request.responseType = this.responseType;if(this.withCredentials !== undefined)request.withCredentials = this.withCredentials;request.send(null);scope.manager.itemStart(url);return request;},setResponseType:function setResponseType(value){this.responseType = value;},setCrossOrigin:function setCrossOrigin(value){this.crossOrigin = value;},setWithCredentials:function setWithCredentials(value){this.withCredentials = value;}}; // File:src/loaders/ImageLoader.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */THREE.ImageLoader = function(manager){this.manager = manager !== undefined?manager:THREE.DefaultLoadingManager;};THREE.ImageLoader.prototype = {constructor:THREE.ImageLoader,load:function load(url,onLoad,onProgress,onError){var scope=this;var cached=THREE.Cache.get(url);if(cached !== undefined){if(onLoad){setTimeout(function(){onLoad(cached);},0);}return cached;}var image=document.createElement('img');image.addEventListener('load',function(event){THREE.Cache.add(url,this);if(onLoad)onLoad(this);scope.manager.itemEnd(url);},false);if(onProgress !== undefined){image.addEventListener('progress',function(event){onProgress(event);},false);}image.addEventListener('error',function(event){if(onError)onError(event);scope.manager.itemError(url);},false);if(this.crossOrigin !== undefined)image.crossOrigin = this.crossOrigin;scope.manager.itemStart(url);image.src = url;return image;},setCrossOrigin:function setCrossOrigin(value){this.crossOrigin = value;}}; // File:src/loaders/JSONLoader.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author alteredq / http://alteredqualia.com/\n\t */THREE.JSONLoader = function(manager){if(typeof manager === 'boolean'){console.warn('THREE.JSONLoader: showStatus parameter has been removed from constructor.');manager = undefined;}this.manager = manager !== undefined?manager:THREE.DefaultLoadingManager;this.withCredentials = false;};THREE.JSONLoader.prototype = _Object$defineProperties({constructor:THREE.JSONLoader,load:function load(url,onLoad,onProgress,onError){var scope=this;var texturePath=this.texturePath && typeof this.texturePath === \"string\"?this.texturePath:THREE.Loader.prototype.extractUrlBase(url);var loader=new THREE.XHRLoader(this.manager);loader.setCrossOrigin(this.crossOrigin);loader.setWithCredentials(this.withCredentials);loader.load(url,function(text){var json=JSON.parse(text);var metadata=json.metadata;if(metadata !== undefined){if(metadata.type === 'object'){console.error('THREE.JSONLoader: ' + url + ' should be loaded with THREE.ObjectLoader instead.');return;}if(metadata.type === 'scene'){console.error('THREE.JSONLoader: ' + url + ' should be loaded with THREE.SceneLoader instead.');return;}}var object=scope.parse(json,texturePath);onLoad(object.geometry,object.materials);});},setCrossOrigin:function setCrossOrigin(value){this.crossOrigin = value;},setTexturePath:function setTexturePath(value){this.texturePath = value;},parse:function parse(json,texturePath){var geometry=new THREE.Geometry(),scale=json.scale !== undefined?1.0 / json.scale:1.0;parseModel(scale);parseSkin();parseMorphing(scale);geometry.computeFaceNormals();geometry.computeBoundingSphere();function parseModel(scale){function isBitSet(value,position){return value & 1 << position;}var i,j,fi,offset,zLength,colorIndex,normalIndex,uvIndex,materialIndex,type,isQuad,hasMaterial,hasFaceVertexUv,hasFaceNormal,hasFaceVertexNormal,hasFaceColor,hasFaceVertexColor,vertex,face,faceA,faceB,hex,normal,uvLayer,uv,u,v,faces=json.faces,vertices=json.vertices,normals=json.normals,colors=json.colors,nUvLayers=0;if(json.uvs !== undefined){ // disregard empty arrays\n\tfor(i = 0;i < json.uvs.length;i++) {if(json.uvs[i].length)nUvLayers++;}for(i = 0;i < nUvLayers;i++) {geometry.faceVertexUvs[i] = [];}}offset = 0;zLength = vertices.length;while(offset < zLength) {vertex = new THREE.Vector3();vertex.x = vertices[offset++] * scale;vertex.y = vertices[offset++] * scale;vertex.z = vertices[offset++] * scale;geometry.vertices.push(vertex);}offset = 0;zLength = faces.length;while(offset < zLength) {type = faces[offset++];isQuad = isBitSet(type,0);hasMaterial = isBitSet(type,1);hasFaceVertexUv = isBitSet(type,3);hasFaceNormal = isBitSet(type,4);hasFaceVertexNormal = isBitSet(type,5);hasFaceColor = isBitSet(type,6);hasFaceVertexColor = isBitSet(type,7); // console.log(\"type\", type, \"bits\", isQuad, hasMaterial, hasFaceVertexUv, hasFaceNormal, hasFaceVertexNormal, hasFaceColor, hasFaceVertexColor);\n\tif(isQuad){faceA = new THREE.Face3();faceA.a = faces[offset];faceA.b = faces[offset + 1];faceA.c = faces[offset + 3];faceB = new THREE.Face3();faceB.a = faces[offset + 1];faceB.b = faces[offset + 2];faceB.c = faces[offset + 3];offset += 4;if(hasMaterial){materialIndex = faces[offset++];faceA.materialIndex = materialIndex;faceB.materialIndex = materialIndex;} // to get face <=> uv index correspondence\n\tfi = geometry.faces.length;if(hasFaceVertexUv){for(i = 0;i < nUvLayers;i++) {uvLayer = json.uvs[i];geometry.faceVertexUvs[i][fi] = [];geometry.faceVertexUvs[i][fi + 1] = [];for(j = 0;j < 4;j++) {uvIndex = faces[offset++];u = uvLayer[uvIndex * 2];v = uvLayer[uvIndex * 2 + 1];uv = new THREE.Vector2(u,v);if(j !== 2)geometry.faceVertexUvs[i][fi].push(uv);if(j !== 0)geometry.faceVertexUvs[i][fi + 1].push(uv);}}}if(hasFaceNormal){normalIndex = faces[offset++] * 3;faceA.normal.set(normals[normalIndex++],normals[normalIndex++],normals[normalIndex]);faceB.normal.copy(faceA.normal);}if(hasFaceVertexNormal){for(i = 0;i < 4;i++) {normalIndex = faces[offset++] * 3;normal = new THREE.Vector3(normals[normalIndex++],normals[normalIndex++],normals[normalIndex]);if(i !== 2)faceA.vertexNormals.push(normal);if(i !== 0)faceB.vertexNormals.push(normal);}}if(hasFaceColor){colorIndex = faces[offset++];hex = colors[colorIndex];faceA.color.setHex(hex);faceB.color.setHex(hex);}if(hasFaceVertexColor){for(i = 0;i < 4;i++) {colorIndex = faces[offset++];hex = colors[colorIndex];if(i !== 2)faceA.vertexColors.push(new THREE.Color(hex));if(i !== 0)faceB.vertexColors.push(new THREE.Color(hex));}}geometry.faces.push(faceA);geometry.faces.push(faceB);}else {face = new THREE.Face3();face.a = faces[offset++];face.b = faces[offset++];face.c = faces[offset++];if(hasMaterial){materialIndex = faces[offset++];face.materialIndex = materialIndex;} // to get face <=> uv index correspondence\n\tfi = geometry.faces.length;if(hasFaceVertexUv){for(i = 0;i < nUvLayers;i++) {uvLayer = json.uvs[i];geometry.faceVertexUvs[i][fi] = [];for(j = 0;j < 3;j++) {uvIndex = faces[offset++];u = uvLayer[uvIndex * 2];v = uvLayer[uvIndex * 2 + 1];uv = new THREE.Vector2(u,v);geometry.faceVertexUvs[i][fi].push(uv);}}}if(hasFaceNormal){normalIndex = faces[offset++] * 3;face.normal.set(normals[normalIndex++],normals[normalIndex++],normals[normalIndex]);}if(hasFaceVertexNormal){for(i = 0;i < 3;i++) {normalIndex = faces[offset++] * 3;normal = new THREE.Vector3(normals[normalIndex++],normals[normalIndex++],normals[normalIndex]);face.vertexNormals.push(normal);}}if(hasFaceColor){colorIndex = faces[offset++];face.color.setHex(colors[colorIndex]);}if(hasFaceVertexColor){for(i = 0;i < 3;i++) {colorIndex = faces[offset++];face.vertexColors.push(new THREE.Color(colors[colorIndex]));}}geometry.faces.push(face);}}};function parseSkin(){var influencesPerVertex=json.influencesPerVertex !== undefined?json.influencesPerVertex:2;if(json.skinWeights){for(var i=0,l=json.skinWeights.length;i < l;i += influencesPerVertex) {var x=json.skinWeights[i];var y=influencesPerVertex > 1?json.skinWeights[i + 1]:0;var z=influencesPerVertex > 2?json.skinWeights[i + 2]:0;var w=influencesPerVertex > 3?json.skinWeights[i + 3]:0;geometry.skinWeights.push(new THREE.Vector4(x,y,z,w));}}if(json.skinIndices){for(var i=0,l=json.skinIndices.length;i < l;i += influencesPerVertex) {var a=json.skinIndices[i];var b=influencesPerVertex > 1?json.skinIndices[i + 1]:0;var c=influencesPerVertex > 2?json.skinIndices[i + 2]:0;var d=influencesPerVertex > 3?json.skinIndices[i + 3]:0;geometry.skinIndices.push(new THREE.Vector4(a,b,c,d));}}geometry.bones = json.bones;if(geometry.bones && geometry.bones.length > 0 && (geometry.skinWeights.length !== geometry.skinIndices.length || geometry.skinIndices.length !== geometry.vertices.length)){console.warn('When skinning, number of vertices (' + geometry.vertices.length + '), skinIndices (' + geometry.skinIndices.length + '), and skinWeights (' + geometry.skinWeights.length + ') should match.');} // could change this to json.animations[0] or remove completely\n\tgeometry.animation = json.animation;geometry.animations = json.animations;};function parseMorphing(scale){if(json.morphTargets !== undefined){var i,l,v,vl,dstVertices,srcVertices;for(i = 0,l = json.morphTargets.length;i < l;i++) {geometry.morphTargets[i] = {};geometry.morphTargets[i].name = json.morphTargets[i].name;geometry.morphTargets[i].vertices = [];dstVertices = geometry.morphTargets[i].vertices;srcVertices = json.morphTargets[i].vertices;for(v = 0,vl = srcVertices.length;v < vl;v += 3) {var vertex=new THREE.Vector3();vertex.x = srcVertices[v] * scale;vertex.y = srcVertices[v + 1] * scale;vertex.z = srcVertices[v + 2] * scale;dstVertices.push(vertex);}}}if(json.morphColors !== undefined){var i,l,c,cl,dstColors,srcColors,color;for(i = 0,l = json.morphColors.length;i < l;i++) {geometry.morphColors[i] = {};geometry.morphColors[i].name = json.morphColors[i].name;geometry.morphColors[i].colors = [];dstColors = geometry.morphColors[i].colors;srcColors = json.morphColors[i].colors;for(c = 0,cl = srcColors.length;c < cl;c += 3) {color = new THREE.Color(0xffaa00);color.setRGB(srcColors[c],srcColors[c + 1],srcColors[c + 2]);dstColors.push(color);}}}};if(json.materials === undefined || json.materials.length === 0){return {geometry:geometry};}else {var materials=THREE.Loader.prototype.initMaterials(json.materials,texturePath,this.crossOrigin);return {geometry:geometry,materials:materials};}}},{statusDomElement:{ // Deprecated\n\tget:function get(){if(this._statusDomElement === undefined){this._statusDomElement = document.createElement('div');}console.warn('THREE.JSONLoader: .statusDomElement has been removed.');return this._statusDomElement;},configurable:true,enumerable:true}}); // File:src/loaders/LoadingManager.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */THREE.LoadingManager = function(onLoad,onProgress,onError){var scope=this;var isLoading=false,itemsLoaded=0,itemsTotal=0;this.onStart = undefined;this.onLoad = onLoad;this.onProgress = onProgress;this.onError = onError;this.itemStart = function(url){itemsTotal++;if(isLoading === false){if(scope.onStart !== undefined){scope.onStart(url,itemsLoaded,itemsTotal);}}isLoading = true;};this.itemEnd = function(url){itemsLoaded++;if(scope.onProgress !== undefined){scope.onProgress(url,itemsLoaded,itemsTotal);}if(itemsLoaded === itemsTotal){isLoading = false;if(scope.onLoad !== undefined){scope.onLoad();}}};this.itemError = function(url){if(scope.onError !== undefined){scope.onError(url);}};};THREE.DefaultLoadingManager = new THREE.LoadingManager(); // File:src/loaders/BufferGeometryLoader.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */THREE.BufferGeometryLoader = function(manager){this.manager = manager !== undefined?manager:THREE.DefaultLoadingManager;};THREE.BufferGeometryLoader.prototype = {constructor:THREE.BufferGeometryLoader,load:function load(url,onLoad,onProgress,onError){var scope=this;var loader=new THREE.XHRLoader(scope.manager);loader.setCrossOrigin(this.crossOrigin);loader.load(url,function(text){onLoad(scope.parse(JSON.parse(text)));},onProgress,onError);},setCrossOrigin:function setCrossOrigin(value){this.crossOrigin = value;},parse:function parse(json){var geometry=new THREE.BufferGeometry();var index=json.data.index;if(index !== undefined){var typedArray=new self[index.type](index.array);geometry.setIndex(new THREE.BufferAttribute(typedArray,1));}var attributes=json.data.attributes;for(var key in attributes) {var attribute=attributes[key];var typedArray=new self[attribute.type](attribute.array);geometry.addAttribute(key,new THREE.BufferAttribute(typedArray,attribute.itemSize));}var groups=json.data.groups || json.data.drawcalls || json.data.offsets;if(groups !== undefined){for(var i=0,n=groups.length;i !== n;++i) {var group=groups[i];geometry.addGroup(group.start,group.count);}}var boundingSphere=json.data.boundingSphere;if(boundingSphere !== undefined){var center=new THREE.Vector3();if(boundingSphere.center !== undefined){center.fromArray(boundingSphere.center);}geometry.boundingSphere = new THREE.Sphere(center,boundingSphere.radius);}return geometry;}}; // File:src/loaders/MaterialLoader.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */THREE.MaterialLoader = function(manager){this.manager = manager !== undefined?manager:THREE.DefaultLoadingManager;this.textures = {};};THREE.MaterialLoader.prototype = {constructor:THREE.MaterialLoader,load:function load(url,onLoad,onProgress,onError){var scope=this;var loader=new THREE.XHRLoader(scope.manager);loader.setCrossOrigin(this.crossOrigin);loader.load(url,function(text){onLoad(scope.parse(JSON.parse(text)));},onProgress,onError);},setCrossOrigin:function setCrossOrigin(value){this.crossOrigin = value;},setTextures:function setTextures(value){this.textures = value;},getTexture:function getTexture(name){var textures=this.textures;if(textures[name] === undefined){console.warn('THREE.MaterialLoader: Undefined texture',name);}return textures[name];},parse:function parse(json){var material=new THREE[json.type]();material.uuid = json.uuid;if(json.name !== undefined)material.name = json.name;if(json.color !== undefined)material.color.setHex(json.color);if(json.emissive !== undefined)material.emissive.setHex(json.emissive);if(json.specular !== undefined)material.specular.setHex(json.specular);if(json.shininess !== undefined)material.shininess = json.shininess;if(json.uniforms !== undefined)material.uniforms = json.uniforms;if(json.vertexShader !== undefined)material.vertexShader = json.vertexShader;if(json.fragmentShader !== undefined)material.fragmentShader = json.fragmentShader;if(json.vertexColors !== undefined)material.vertexColors = json.vertexColors;if(json.shading !== undefined)material.shading = json.shading;if(json.blending !== undefined)material.blending = json.blending;if(json.side !== undefined)material.side = json.side;if(json.opacity !== undefined)material.opacity = json.opacity;if(json.transparent !== undefined)material.transparent = json.transparent;if(json.alphaTest !== undefined)material.alphaTest = json.alphaTest;if(json.depthTest !== undefined)material.depthTest = json.depthTest;if(json.depthWrite !== undefined)material.depthWrite = json.depthWrite;if(json.wireframe !== undefined)material.wireframe = json.wireframe;if(json.wireframeLinewidth !== undefined)material.wireframeLinewidth = json.wireframeLinewidth; // for PointsMaterial\n\tif(json.size !== undefined)material.size = json.size;if(json.sizeAttenuation !== undefined)material.sizeAttenuation = json.sizeAttenuation; // maps\n\tif(json.map !== undefined)material.map = this.getTexture(json.map);if(json.alphaMap !== undefined){material.alphaMap = this.getTexture(json.alphaMap);material.transparent = true;}if(json.bumpMap !== undefined)material.bumpMap = this.getTexture(json.bumpMap);if(json.bumpScale !== undefined)material.bumpScale = json.bumpScale;if(json.normalMap !== undefined)material.normalMap = this.getTexture(json.normalMap);if(json.normalScale)material.normalScale = new THREE.Vector2(json.normalScale,json.normalScale);if(json.displacementMap !== undefined)material.displacementMap = this.getTexture(json.displacementMap);if(json.displacementScale !== undefined)material.displacementScale = json.displacementScale;if(json.displacementBias !== undefined)material.displacementBias = json.displacementBias;if(json.specularMap !== undefined)material.specularMap = this.getTexture(json.specularMap);if(json.envMap !== undefined){material.envMap = this.getTexture(json.envMap);material.combine = THREE.MultiplyOperation;}if(json.reflectivity)material.reflectivity = json.reflectivity;if(json.lightMap !== undefined)material.lightMap = this.getTexture(json.lightMap);if(json.lightMapIntensity !== undefined)material.lightMapIntensity = json.lightMapIntensity;if(json.aoMap !== undefined)material.aoMap = this.getTexture(json.aoMap);if(json.aoMapIntensity !== undefined)material.aoMapIntensity = json.aoMapIntensity; // MeshFaceMaterial\n\tif(json.materials !== undefined){for(var i=0,l=json.materials.length;i < l;i++) {material.materials.push(this.parse(json.materials[i]));}}return material;}}; // File:src/loaders/ObjectLoader.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */THREE.ObjectLoader = function(manager){this.manager = manager !== undefined?manager:THREE.DefaultLoadingManager;this.texturePath = '';};THREE.ObjectLoader.prototype = {constructor:THREE.ObjectLoader,load:function load(url,onLoad,onProgress,onError){if(this.texturePath === ''){this.texturePath = url.substring(0,url.lastIndexOf('/') + 1);}var scope=this;var loader=new THREE.XHRLoader(scope.manager);loader.setCrossOrigin(this.crossOrigin);loader.load(url,function(text){scope.parse(JSON.parse(text),onLoad);},onProgress,onError);},setTexturePath:function setTexturePath(value){this.texturePath = value;},setCrossOrigin:function setCrossOrigin(value){this.crossOrigin = value;},parse:function parse(json,onLoad){var geometries=this.parseGeometries(json.geometries);var images=this.parseImages(json.images,function(){if(onLoad !== undefined)onLoad(object);});var textures=this.parseTextures(json.textures,images);var materials=this.parseMaterials(json.materials,textures);var object=this.parseObject(json.object,geometries,materials);if(json.images === undefined || json.images.length === 0){if(onLoad !== undefined)onLoad(object);}return object;},parseGeometries:function parseGeometries(json){var geometries={};if(json !== undefined){var geometryLoader=new THREE.JSONLoader();var bufferGeometryLoader=new THREE.BufferGeometryLoader();for(var i=0,l=json.length;i < l;i++) {var geometry;var data=json[i];switch(data.type){case 'PlaneGeometry':case 'PlaneBufferGeometry':geometry = new THREE[data.type](data.width,data.height,data.widthSegments,data.heightSegments);break;case 'BoxGeometry':case 'CubeGeometry': // backwards compatible\n\tgeometry = new THREE.BoxGeometry(data.width,data.height,data.depth,data.widthSegments,data.heightSegments,data.depthSegments);break;case 'CircleBufferGeometry':geometry = new THREE.CircleBufferGeometry(data.radius,data.segments,data.thetaStart,data.thetaLength);break;case 'CircleGeometry':geometry = new THREE.CircleGeometry(data.radius,data.segments,data.thetaStart,data.thetaLength);break;case 'CylinderGeometry':geometry = new THREE.CylinderGeometry(data.radiusTop,data.radiusBottom,data.height,data.radialSegments,data.heightSegments,data.openEnded,data.thetaStart,data.thetaLength);break;case 'SphereGeometry':geometry = new THREE.SphereGeometry(data.radius,data.widthSegments,data.heightSegments,data.phiStart,data.phiLength,data.thetaStart,data.thetaLength);break;case 'SphereBufferGeometry':geometry = new THREE.SphereBufferGeometry(data.radius,data.widthSegments,data.heightSegments,data.phiStart,data.phiLength,data.thetaStart,data.thetaLength);break;case 'DodecahedronGeometry':geometry = new THREE.DodecahedronGeometry(data.radius,data.detail);break;case 'IcosahedronGeometry':geometry = new THREE.IcosahedronGeometry(data.radius,data.detail);break;case 'OctahedronGeometry':geometry = new THREE.OctahedronGeometry(data.radius,data.detail);break;case 'TetrahedronGeometry':geometry = new THREE.TetrahedronGeometry(data.radius,data.detail);break;case 'RingGeometry':geometry = new THREE.RingGeometry(data.innerRadius,data.outerRadius,data.thetaSegments,data.phiSegments,data.thetaStart,data.thetaLength);break;case 'TorusGeometry':geometry = new THREE.TorusGeometry(data.radius,data.tube,data.radialSegments,data.tubularSegments,data.arc);break;case 'TorusKnotGeometry':geometry = new THREE.TorusKnotGeometry(data.radius,data.tube,data.radialSegments,data.tubularSegments,data.p,data.q,data.heightScale);break;case 'TextGeometry':geometry = new THREE.TextGeometry(data.text,data.data);break;case 'BufferGeometry':geometry = bufferGeometryLoader.parse(data);break;case 'Geometry':geometry = geometryLoader.parse(data.data,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type \"' + data.type + '\"');continue;}geometry.uuid = data.uuid;if(data.name !== undefined)geometry.name = data.name;geometries[data.uuid] = geometry;}}return geometries;},parseMaterials:function parseMaterials(json,textures){var materials={};if(json !== undefined){var loader=new THREE.MaterialLoader();loader.setTextures(textures);for(var i=0,l=json.length;i < l;i++) {var material=loader.parse(json[i]);materials[material.uuid] = material;}}return materials;},parseImages:function parseImages(json,onLoad){var scope=this;var images={};function loadImage(url){scope.manager.itemStart(url);return loader.load(url,function(){scope.manager.itemEnd(url);});}if(json !== undefined && json.length > 0){var manager=new THREE.LoadingManager(onLoad);var loader=new THREE.ImageLoader(manager);loader.setCrossOrigin(this.crossOrigin);for(var i=0,l=json.length;i < l;i++) {var image=json[i];var path=/^(\\/\\/)|([a-z]+:(\\/\\/)?)/i.test(image.url)?image.url:scope.texturePath + image.url;images[image.uuid] = loadImage(path);}}return images;},parseTextures:function parseTextures(json,images){function parseConstant(value){if(typeof value === 'number')return value;console.warn('THREE.ObjectLoader.parseTexture: Constant should be in numeric form.',value);return THREE[value];}var textures={};if(json !== undefined){for(var i=0,l=json.length;i < l;i++) {var data=json[i];if(data.image === undefined){console.warn('THREE.ObjectLoader: No \"image\" specified for',data.uuid);}if(images[data.image] === undefined){console.warn('THREE.ObjectLoader: Undefined image',data.image);}var texture=new THREE.Texture(images[data.image]);texture.needsUpdate = true;texture.uuid = data.uuid;if(data.name !== undefined)texture.name = data.name;if(data.mapping !== undefined)texture.mapping = parseConstant(data.mapping);if(data.offset !== undefined)texture.offset = new THREE.Vector2(data.offset[0],data.offset[1]);if(data.repeat !== undefined)texture.repeat = new THREE.Vector2(data.repeat[0],data.repeat[1]);if(data.minFilter !== undefined)texture.minFilter = parseConstant(data.minFilter);if(data.magFilter !== undefined)texture.magFilter = parseConstant(data.magFilter);if(data.anisotropy !== undefined)texture.anisotropy = data.anisotropy;if(Array.isArray(data.wrap)){texture.wrapS = parseConstant(data.wrap[0]);texture.wrapT = parseConstant(data.wrap[1]);}textures[data.uuid] = texture;}}return textures;},parseObject:(function(){var matrix=new THREE.Matrix4();return function(data,geometries,materials){var object;var getGeometry=function getGeometry(name){if(geometries[name] === undefined){console.warn('THREE.ObjectLoader: Undefined geometry',name);}return geometries[name];};var getMaterial=function getMaterial(name){if(materials[name] === undefined){console.warn('THREE.ObjectLoader: Undefined material',name);}return materials[name];};switch(data.type){case 'Scene':object = new THREE.Scene();break;case 'PerspectiveCamera':object = new THREE.PerspectiveCamera(data.fov,data.aspect,data.near,data.far);break;case 'OrthographicCamera':object = new THREE.OrthographicCamera(data.left,data.right,data.top,data.bottom,data.near,data.far);break;case 'AmbientLight':object = new THREE.AmbientLight(data.color);break;case 'DirectionalLight':object = new THREE.DirectionalLight(data.color,data.intensity);break;case 'PointLight':object = new THREE.PointLight(data.color,data.intensity,data.distance,data.decay);break;case 'SpotLight':object = new THREE.SpotLight(data.color,data.intensity,data.distance,data.angle,data.exponent,data.decay);break;case 'HemisphereLight':object = new THREE.HemisphereLight(data.color,data.groundColor,data.intensity);break;case 'Mesh':object = new THREE.Mesh(getGeometry(data.geometry),getMaterial(data.material));break;case 'LOD':object = new THREE.LOD();break;case 'Line':object = new THREE.Line(getGeometry(data.geometry),getMaterial(data.material),data.mode);break;case 'PointCloud':case 'Points':object = new THREE.Points(getGeometry(data.geometry),getMaterial(data.material));break;case 'Sprite':object = new THREE.Sprite(getMaterial(data.material));break;case 'Group':object = new THREE.Group();break;default:object = new THREE.Object3D();}object.uuid = data.uuid;if(data.name !== undefined)object.name = data.name;if(data.matrix !== undefined){matrix.fromArray(data.matrix);matrix.decompose(object.position,object.quaternion,object.scale);}else {if(data.position !== undefined)object.position.fromArray(data.position);if(data.rotation !== undefined)object.rotation.fromArray(data.rotation);if(data.scale !== undefined)object.scale.fromArray(data.scale);}if(data.castShadow !== undefined)object.castShadow = data.castShadow;if(data.receiveShadow !== undefined)object.receiveShadow = data.receiveShadow;if(data.visible !== undefined)object.visible = data.visible;if(data.userData !== undefined)object.userData = data.userData;if(data.children !== undefined){for(var child in data.children) {object.add(this.parseObject(data.children[child],geometries,materials));}}if(data.type === 'LOD'){var levels=data.levels;for(var l=0;l < levels.length;l++) {var level=levels[l];var child=object.getObjectByProperty('uuid',level.object);if(child !== undefined){object.addLevel(child,level.distance);}}}return object;};})()}; // File:src/loaders/TextureLoader.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */THREE.TextureLoader = function(manager){this.manager = manager !== undefined?manager:THREE.DefaultLoadingManager;};THREE.TextureLoader.prototype = {constructor:THREE.TextureLoader,load:function load(url,onLoad,onProgress,onError){var scope=this;var loader=new THREE.ImageLoader(scope.manager);loader.setCrossOrigin(this.crossOrigin);loader.load(url,function(image){var texture=new THREE.Texture(image);texture.needsUpdate = true;if(onLoad !== undefined){onLoad(texture);}},onProgress,onError);},setCrossOrigin:function setCrossOrigin(value){this.crossOrigin = value;}}; // File:src/loaders/BinaryTextureLoader.js\n\t/**\n\t * @author Nikos M. / https://github.com/foo123/\n\t *\n\t * Abstract Base class to load generic binary textures formats (rgbe, hdr, ...)\n\t */THREE.DataTextureLoader = THREE.BinaryTextureLoader = function(manager){this.manager = manager !== undefined?manager:THREE.DefaultLoadingManager; // override in sub classes\n\tthis._parser = null;};THREE.BinaryTextureLoader.prototype = {constructor:THREE.BinaryTextureLoader,load:function load(url,onLoad,onProgress,onError){var scope=this;var texture=new THREE.DataTexture();var loader=new THREE.XHRLoader(this.manager);loader.setCrossOrigin(this.crossOrigin);loader.setResponseType('arraybuffer');loader.load(url,function(buffer){var texData=scope._parser(buffer);if(!texData)return;if(undefined !== texData.image){texture.image = texData.image;}else if(undefined !== texData.data){texture.image.width = texData.width;texture.image.height = texData.height;texture.image.data = texData.data;}texture.wrapS = undefined !== texData.wrapS?texData.wrapS:THREE.ClampToEdgeWrapping;texture.wrapT = undefined !== texData.wrapT?texData.wrapT:THREE.ClampToEdgeWrapping;texture.magFilter = undefined !== texData.magFilter?texData.magFilter:THREE.LinearFilter;texture.minFilter = undefined !== texData.minFilter?texData.minFilter:THREE.LinearMipMapLinearFilter;texture.anisotropy = undefined !== texData.anisotropy?texData.anisotropy:1;if(undefined !== texData.format){texture.format = texData.format;}if(undefined !== texData.type){texture.type = texData.type;}if(undefined !== texData.mipmaps){texture.mipmaps = texData.mipmaps;}if(1 === texData.mipmapCount){texture.minFilter = THREE.LinearFilter;}texture.needsUpdate = true;if(onLoad)onLoad(texture,texData);},onProgress,onError);return texture;},setCrossOrigin:function setCrossOrigin(value){this.crossOrigin = value;}}; // File:src/loaders/CompressedTextureLoader.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t *\n\t * Abstract Base class to block based textures loader (dds, pvr, ...)\n\t */THREE.CompressedTextureLoader = function(manager){this.manager = manager !== undefined?manager:THREE.DefaultLoadingManager; // override in sub classes\n\tthis._parser = null;};THREE.CompressedTextureLoader.prototype = {constructor:THREE.CompressedTextureLoader,load:function load(url,onLoad,onProgress,onError){var scope=this;var images=[];var texture=new THREE.CompressedTexture();texture.image = images;var loader=new THREE.XHRLoader(this.manager);loader.setCrossOrigin(this.crossOrigin);loader.setResponseType('arraybuffer');if(Array.isArray(url)){var loaded=0;var loadTexture=function loadTexture(i){loader.load(url[i],function(buffer){var texDatas=scope._parser(buffer,true);images[i] = {width:texDatas.width,height:texDatas.height,format:texDatas.format,mipmaps:texDatas.mipmaps};loaded += 1;if(loaded === 6){if(texDatas.mipmapCount === 1)texture.minFilter = THREE.LinearFilter;texture.format = texDatas.format;texture.needsUpdate = true;if(onLoad)onLoad(texture);}},onProgress,onError);};for(var i=0,il=url.length;i < il;++i) {loadTexture(i);}}else { // compressed cubemap texture stored in a single DDS file\n\tloader.load(url,function(buffer){var texDatas=scope._parser(buffer,true);if(texDatas.isCubemap){var faces=texDatas.mipmaps.length / texDatas.mipmapCount;for(var f=0;f < faces;f++) {images[f] = {mipmaps:[]};for(var i=0;i < texDatas.mipmapCount;i++) {images[f].mipmaps.push(texDatas.mipmaps[f * texDatas.mipmapCount + i]);images[f].format = texDatas.format;images[f].width = texDatas.width;images[f].height = texDatas.height;}}}else {texture.image.width = texDatas.width;texture.image.height = texDatas.height;texture.mipmaps = texDatas.mipmaps;}if(texDatas.mipmapCount === 1){texture.minFilter = THREE.LinearFilter;}texture.format = texDatas.format;texture.needsUpdate = true;if(onLoad)onLoad(texture);},onProgress,onError);}return texture;},setCrossOrigin:function setCrossOrigin(value){this.crossOrigin = value;}}; // File:src/materials/Material.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author alteredq / http://alteredqualia.com/\n\t */THREE.Material = function(){Object.defineProperty(this,'id',{value:THREE.MaterialIdCount++});this.uuid = THREE.Math.generateUUID();this.name = '';this.type = 'Material';this.side = THREE.FrontSide;this.opacity = 1;this.transparent = false;this.blending = THREE.NormalBlending;this.blendSrc = THREE.SrcAlphaFactor;this.blendDst = THREE.OneMinusSrcAlphaFactor;this.blendEquation = THREE.AddEquation;this.blendSrcAlpha = null;this.blendDstAlpha = null;this.blendEquationAlpha = null;this.depthFunc = THREE.LessEqualDepth;this.depthTest = true;this.depthWrite = true;this.colorWrite = true;this.precision = null; // override the renderer's default precision for this material\n\tthis.polygonOffset = false;this.polygonOffsetFactor = 0;this.polygonOffsetUnits = 0;this.alphaTest = 0;this.overdraw = 0; // Overdrawn pixels (typically between 0 and 1) for fixing antialiasing gaps in CanvasRenderer\n\tthis.visible = true;this._needsUpdate = true;};THREE.Material.prototype = _Object$defineProperties({constructor:THREE.Material,setValues:function setValues(values){if(values === undefined)return;for(var key in values) {var newValue=values[key];if(newValue === undefined){console.warn(\"THREE.Material: '\" + key + \"' parameter is undefined.\");continue;}var currentValue=this[key];if(currentValue === undefined){console.warn(\"THREE.\" + this.type + \": '\" + key + \"' is not a property of this material.\");continue;}if(currentValue instanceof THREE.Color){currentValue.set(newValue);}else if(currentValue instanceof THREE.Vector3 && newValue instanceof THREE.Vector3){currentValue.copy(newValue);}else if(key === 'overdraw'){ // ensure overdraw is backwards-compatible with legacy boolean type\n\tthis[key] = Number(newValue);}else {this[key] = newValue;}}},toJSON:function toJSON(meta){var data={metadata:{version:4.4,type:'Material',generator:'Material.toJSON'}}; // standard Material serialization\n\tdata.uuid = this.uuid;data.type = this.type;if(this.name !== '')data.name = this.name;if(this.color instanceof THREE.Color)data.color = this.color.getHex();if(this.emissive instanceof THREE.Color)data.emissive = this.emissive.getHex();if(this.specular instanceof THREE.Color)data.specular = this.specular.getHex();if(this.shininess !== undefined)data.shininess = this.shininess;if(this.map instanceof THREE.Texture)data.map = this.map.toJSON(meta).uuid;if(this.alphaMap instanceof THREE.Texture)data.alphaMap = this.alphaMap.toJSON(meta).uuid;if(this.lightMap instanceof THREE.Texture)data.lightMap = this.lightMap.toJSON(meta).uuid;if(this.bumpMap instanceof THREE.Texture){data.bumpMap = this.bumpMap.toJSON(meta).uuid;data.bumpScale = this.bumpScale;}if(this.normalMap instanceof THREE.Texture){data.normalMap = this.normalMap.toJSON(meta).uuid;data.normalScale = this.normalScale; // Removed for now, causes issue in editor ui.js\n\t}if(this.displacementMap instanceof THREE.Texture){data.displacementMap = this.displacementMap.toJSON(meta).uuid;data.displacementScale = this.displacementScale;data.displacementBias = this.displacementBias;}if(this.specularMap instanceof THREE.Texture)data.specularMap = this.specularMap.toJSON(meta).uuid;if(this.envMap instanceof THREE.Texture){data.envMap = this.envMap.toJSON(meta).uuid;data.reflectivity = this.reflectivity; // Scale behind envMap\n\t}if(this.size !== undefined)data.size = this.size;if(this.sizeAttenuation !== undefined)data.sizeAttenuation = this.sizeAttenuation;if(this.vertexColors !== undefined && this.vertexColors !== THREE.NoColors)data.vertexColors = this.vertexColors;if(this.shading !== undefined && this.shading !== THREE.SmoothShading)data.shading = this.shading;if(this.blending !== undefined && this.blending !== THREE.NormalBlending)data.blending = this.blending;if(this.side !== undefined && this.side !== THREE.FrontSide)data.side = this.side;if(this.opacity < 1)data.opacity = this.opacity;if(this.transparent === true)data.transparent = this.transparent;if(this.alphaTest > 0)data.alphaTest = this.alphaTest;if(this.wireframe === true)data.wireframe = this.wireframe;if(this.wireframeLinewidth > 1)data.wireframeLinewidth = this.wireframeLinewidth;return data;},clone:function clone(){return new this.constructor().copy(this);},copy:function copy(source){this.name = source.name;this.side = source.side;this.opacity = source.opacity;this.transparent = source.transparent;this.blending = source.blending;this.blendSrc = source.blendSrc;this.blendDst = source.blendDst;this.blendEquation = source.blendEquation;this.blendSrcAlpha = source.blendSrcAlpha;this.blendDstAlpha = source.blendDstAlpha;this.blendEquationAlpha = source.blendEquationAlpha;this.depthFunc = source.depthFunc;this.depthTest = source.depthTest;this.depthWrite = source.depthWrite;this.precision = source.precision;this.polygonOffset = source.polygonOffset;this.polygonOffsetFactor = source.polygonOffsetFactor;this.polygonOffsetUnits = source.polygonOffsetUnits;this.alphaTest = source.alphaTest;this.overdraw = source.overdraw;this.visible = source.visible;return this;},update:function update(){this.dispatchEvent({type:'update'});},dispose:function dispose(){this.dispatchEvent({type:'dispose'});}},{needsUpdate:{get:function get(){return this._needsUpdate;},set:function set(value){if(value === true)this.update();this._needsUpdate = value;},configurable:true,enumerable:true},wrapAround:{ // Deprecated\n\tget:function get(){console.warn('THREE.' + this.type + ': .wrapAround has been removed.');},set:function set(boolean){console.warn('THREE.' + this.type + ': .wrapAround has been removed.');},configurable:true,enumerable:true},wrapRGB:{get:function get(){console.warn('THREE.' + this.type + ': .wrapRGB has been removed.');return new THREE.Color();},configurable:true,enumerable:true}});THREE.EventDispatcher.prototype.apply(THREE.Material.prototype);THREE.MaterialIdCount = 0; // File:src/materials/LineBasicMaterial.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author alteredq / http://alteredqualia.com/\n\t *\n\t * parameters = {\n\t *  color: <hex>,\n\t *  opacity: <float>,\n\t *\n\t *  blending: THREE.NormalBlending,\n\t *  depthTest: <bool>,\n\t *  depthWrite: <bool>,\n\t *\n\t *  linewidth: <float>,\n\t *  linecap: \"round\",\n\t *  linejoin: \"round\",\n\t *\n\t *  vertexColors: <bool>\n\t *\n\t *  fog: <bool>\n\t * }\n\t */THREE.LineBasicMaterial = function(parameters){THREE.Material.call(this);this.type = 'LineBasicMaterial';this.color = new THREE.Color(0xffffff);this.linewidth = 1;this.linecap = 'round';this.linejoin = 'round';this.vertexColors = THREE.NoColors;this.fog = true;this.setValues(parameters);};THREE.LineBasicMaterial.prototype = _Object$create(THREE.Material.prototype);THREE.LineBasicMaterial.prototype.constructor = THREE.LineBasicMaterial;THREE.LineBasicMaterial.prototype.copy = function(source){THREE.Material.prototype.copy.call(this,source);this.color.copy(source.color);this.linewidth = source.linewidth;this.linecap = source.linecap;this.linejoin = source.linejoin;this.vertexColors = source.vertexColors;this.fog = source.fog;return this;}; // File:src/materials/LineDashedMaterial.js\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t *\n\t * parameters = {\n\t *  color: <hex>,\n\t *  opacity: <float>,\n\t *\n\t *  blending: THREE.NormalBlending,\n\t *  depthTest: <bool>,\n\t *  depthWrite: <bool>,\n\t *\n\t *  linewidth: <float>,\n\t *\n\t *  scale: <float>,\n\t *  dashSize: <float>,\n\t *  gapSize: <float>,\n\t *\n\t *  vertexColors: <bool>\n\t *\n\t *  fog: <bool>\n\t * }\n\t */THREE.LineDashedMaterial = function(parameters){THREE.Material.call(this);this.type = 'LineDashedMaterial';this.color = new THREE.Color(0xffffff);this.linewidth = 1;this.scale = 1;this.dashSize = 3;this.gapSize = 1;this.vertexColors = false;this.fog = true;this.setValues(parameters);};THREE.LineDashedMaterial.prototype = _Object$create(THREE.Material.prototype);THREE.LineDashedMaterial.prototype.constructor = THREE.LineDashedMaterial;THREE.LineDashedMaterial.prototype.copy = function(source){THREE.Material.prototype.copy.call(this,source);this.color.copy(source.color);this.linewidth = source.linewidth;this.scale = source.scale;this.dashSize = source.dashSize;this.gapSize = source.gapSize;this.vertexColors = source.vertexColors;this.fog = source.fog;return this;}; // File:src/materials/MeshBasicMaterial.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author alteredq / http://alteredqualia.com/\n\t *\n\t * parameters = {\n\t *  color: <hex>,\n\t *  opacity: <float>,\n\t *  map: new THREE.Texture( <Image> ),\n\t *\n\t *  aoMap: new THREE.Texture( <Image> ),\n\t *  aoMapIntensity: <float>\n\t *\n\t *  specularMap: new THREE.Texture( <Image> ),\n\t *\n\t *  alphaMap: new THREE.Texture( <Image> ),\n\t *\n\t *  envMap: new THREE.TextureCube( [posx, negx, posy, negy, posz, negz] ),\n\t *  combine: THREE.Multiply,\n\t *  reflectivity: <float>,\n\t *  refractionRatio: <float>,\n\t *\n\t *  shading: THREE.SmoothShading,\n\t *  blending: THREE.NormalBlending,\n\t *  depthTest: <bool>,\n\t *  depthWrite: <bool>,\n\t *\n\t *  wireframe: <boolean>,\n\t *  wireframeLinewidth: <float>,\n\t *\n\t *  vertexColors: THREE.NoColors / THREE.VertexColors / THREE.FaceColors,\n\t *\n\t *  skinning: <bool>,\n\t *  morphTargets: <bool>,\n\t *\n\t *  fog: <bool>\n\t * }\n\t */THREE.MeshBasicMaterial = function(parameters){THREE.Material.call(this);this.type = 'MeshBasicMaterial';this.color = new THREE.Color(0xffffff); // emissive\n\tthis.map = null;this.aoMap = null;this.aoMapIntensity = 1.0;this.specularMap = null;this.alphaMap = null;this.envMap = null;this.combine = THREE.MultiplyOperation;this.reflectivity = 1;this.refractionRatio = 0.98;this.fog = true;this.shading = THREE.SmoothShading;this.wireframe = false;this.wireframeLinewidth = 1;this.wireframeLinecap = 'round';this.wireframeLinejoin = 'round';this.vertexColors = THREE.NoColors;this.skinning = false;this.morphTargets = false;this.setValues(parameters);};THREE.MeshBasicMaterial.prototype = _Object$create(THREE.Material.prototype);THREE.MeshBasicMaterial.prototype.constructor = THREE.MeshBasicMaterial;THREE.MeshBasicMaterial.prototype.copy = function(source){THREE.Material.prototype.copy.call(this,source);this.color.copy(source.color);this.map = source.map;this.aoMap = source.aoMap;this.aoMapIntensity = source.aoMapIntensity;this.specularMap = source.specularMap;this.alphaMap = source.alphaMap;this.envMap = source.envMap;this.combine = source.combine;this.reflectivity = source.reflectivity;this.refractionRatio = source.refractionRatio;this.fog = source.fog;this.shading = source.shading;this.wireframe = source.wireframe;this.wireframeLinewidth = source.wireframeLinewidth;this.wireframeLinecap = source.wireframeLinecap;this.wireframeLinejoin = source.wireframeLinejoin;this.vertexColors = source.vertexColors;this.skinning = source.skinning;this.morphTargets = source.morphTargets;return this;}; // File:src/materials/MeshLambertMaterial.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author alteredq / http://alteredqualia.com/\n\t *\n\t * parameters = {\n\t *  color: <hex>,\n\t *  emissive: <hex>,\n\t *  opacity: <float>,\n\t *\n\t *  map: new THREE.Texture( <Image> ),\n\t *\n\t *  specularMap: new THREE.Texture( <Image> ),\n\t *\n\t *  alphaMap: new THREE.Texture( <Image> ),\n\t *\n\t *  envMap: new THREE.TextureCube( [posx, negx, posy, negy, posz, negz] ),\n\t *  combine: THREE.Multiply,\n\t *  reflectivity: <float>,\n\t *  refractionRatio: <float>,\n\t *\n\t *  blending: THREE.NormalBlending,\n\t *  depthTest: <bool>,\n\t *  depthWrite: <bool>,\n\t *\n\t *  wireframe: <boolean>,\n\t *  wireframeLinewidth: <float>,\n\t *\n\t *  vertexColors: THREE.NoColors / THREE.VertexColors / THREE.FaceColors,\n\t *\n\t *  skinning: <bool>,\n\t *  morphTargets: <bool>,\n\t *  morphNormals: <bool>,\n\t *\n\t *\tfog: <bool>\n\t * }\n\t */THREE.MeshLambertMaterial = function(parameters){THREE.Material.call(this);this.type = 'MeshLambertMaterial';this.color = new THREE.Color(0xffffff); // diffuse\n\tthis.emissive = new THREE.Color(0x000000);this.map = null;this.specularMap = null;this.alphaMap = null;this.envMap = null;this.combine = THREE.MultiplyOperation;this.reflectivity = 1;this.refractionRatio = 0.98;this.fog = true;this.wireframe = false;this.wireframeLinewidth = 1;this.wireframeLinecap = 'round';this.wireframeLinejoin = 'round';this.vertexColors = THREE.NoColors;this.skinning = false;this.morphTargets = false;this.morphNormals = false;this.setValues(parameters);};THREE.MeshLambertMaterial.prototype = _Object$create(THREE.Material.prototype);THREE.MeshLambertMaterial.prototype.constructor = THREE.MeshLambertMaterial;THREE.MeshLambertMaterial.prototype.copy = function(source){THREE.Material.prototype.copy.call(this,source);this.color.copy(source.color);this.emissive.copy(source.emissive);this.map = source.map;this.specularMap = source.specularMap;this.alphaMap = source.alphaMap;this.envMap = source.envMap;this.combine = source.combine;this.reflectivity = source.reflectivity;this.refractionRatio = source.refractionRatio;this.fog = source.fog;this.wireframe = source.wireframe;this.wireframeLinewidth = source.wireframeLinewidth;this.wireframeLinecap = source.wireframeLinecap;this.wireframeLinejoin = source.wireframeLinejoin;this.vertexColors = source.vertexColors;this.skinning = source.skinning;this.morphTargets = source.morphTargets;this.morphNormals = source.morphNormals;return this;}; // File:src/materials/MeshPhongMaterial.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author alteredq / http://alteredqualia.com/\n\t *\n\t * parameters = {\n\t *  color: <hex>,\n\t *  emissive: <hex>,\n\t *  specular: <hex>,\n\t *  shininess: <float>,\n\t *  opacity: <float>,\n\t *\n\t *  map: new THREE.Texture( <Image> ),\n\t *\n\t *  lightMap: new THREE.Texture( <Image> ),\n\t *  lightMapIntensity: <float>\n\t *\n\t *  aoMap: new THREE.Texture( <Image> ),\n\t *  aoMapIntensity: <float>\n\t *\n\t *  emissiveMap: new THREE.Texture( <Image> ),\n\t *\n\t *  bumpMap: new THREE.Texture( <Image> ),\n\t *  bumpScale: <float>,\n\t *\n\t *  normalMap: new THREE.Texture( <Image> ),\n\t *  normalScale: <Vector2>,\n\t *\n\t *  displacementMap: new THREE.Texture( <Image> ),\n\t *  displacementScale: <float>,\n\t *  displacementBias: <float>,\n\t *\n\t *  specularMap: new THREE.Texture( <Image> ),\n\t *\n\t *  alphaMap: new THREE.Texture( <Image> ),\n\t *\n\t *  envMap: new THREE.TextureCube( [posx, negx, posy, negy, posz, negz] ),\n\t *  combine: THREE.Multiply,\n\t *  reflectivity: <float>,\n\t *  refractionRatio: <float>,\n\t *\n\t *  shading: THREE.SmoothShading,\n\t *  blending: THREE.NormalBlending,\n\t *  depthTest: <bool>,\n\t *  depthWrite: <bool>,\n\t *\n\t *  wireframe: <boolean>,\n\t *  wireframeLinewidth: <float>,\n\t *\n\t *  vertexColors: THREE.NoColors / THREE.VertexColors / THREE.FaceColors,\n\t *\n\t *  skinning: <bool>,\n\t *  morphTargets: <bool>,\n\t *  morphNormals: <bool>,\n\t *\n\t *\tfog: <bool>\n\t * }\n\t */THREE.MeshPhongMaterial = function(parameters){THREE.Material.call(this);this.type = 'MeshPhongMaterial';this.color = new THREE.Color(0xffffff); // diffuse\n\tthis.emissive = new THREE.Color(0x000000);this.specular = new THREE.Color(0x111111);this.shininess = 30;this.metal = false;this.map = null;this.lightMap = null;this.lightMapIntensity = 1.0;this.aoMap = null;this.aoMapIntensity = 1.0;this.emissiveMap = null;this.bumpMap = null;this.bumpScale = 1;this.normalMap = null;this.normalScale = new THREE.Vector2(1,1);this.displacementMap = null;this.displacementScale = 1;this.displacementBias = 0;this.specularMap = null;this.alphaMap = null;this.envMap = null;this.combine = THREE.MultiplyOperation;this.reflectivity = 1;this.refractionRatio = 0.98;this.fog = true;this.shading = THREE.SmoothShading;this.wireframe = false;this.wireframeLinewidth = 1;this.wireframeLinecap = 'round';this.wireframeLinejoin = 'round';this.vertexColors = THREE.NoColors;this.skinning = false;this.morphTargets = false;this.morphNormals = false;this.setValues(parameters);};THREE.MeshPhongMaterial.prototype = _Object$create(THREE.Material.prototype);THREE.MeshPhongMaterial.prototype.constructor = THREE.MeshPhongMaterial;THREE.MeshPhongMaterial.prototype.copy = function(source){THREE.Material.prototype.copy.call(this,source);this.color.copy(source.color);this.emissive.copy(source.emissive);this.specular.copy(source.specular);this.shininess = source.shininess;this.metal = source.metal;this.map = source.map;this.lightMap = source.lightMap;this.lightMapIntensity = source.lightMapIntensity;this.aoMap = source.aoMap;this.aoMapIntensity = source.aoMapIntensity;this.emissiveMap = source.emissiveMap;this.bumpMap = source.bumpMap;this.bumpScale = source.bumpScale;this.normalMap = source.normalMap;this.normalScale.copy(source.normalScale);this.displacementMap = source.displacementMap;this.displacementScale = source.displacementScale;this.displacementBias = source.displacementBias;this.specularMap = source.specularMap;this.alphaMap = source.alphaMap;this.envMap = source.envMap;this.combine = source.combine;this.reflectivity = source.reflectivity;this.refractionRatio = source.refractionRatio;this.fog = source.fog;this.shading = source.shading;this.wireframe = source.wireframe;this.wireframeLinewidth = source.wireframeLinewidth;this.wireframeLinecap = source.wireframeLinecap;this.wireframeLinejoin = source.wireframeLinejoin;this.vertexColors = source.vertexColors;this.skinning = source.skinning;this.morphTargets = source.morphTargets;this.morphNormals = source.morphNormals;return this;}; // File:src/materials/MeshDepthMaterial.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author alteredq / http://alteredqualia.com/\n\t *\n\t * parameters = {\n\t *  opacity: <float>,\n\t *\n\t *  blending: THREE.NormalBlending,\n\t *  depthTest: <bool>,\n\t *  depthWrite: <bool>,\n\t *\n\t *  wireframe: <boolean>,\n\t *  wireframeLinewidth: <float>\n\t * }\n\t */THREE.MeshDepthMaterial = function(parameters){THREE.Material.call(this);this.type = 'MeshDepthMaterial';this.morphTargets = false;this.wireframe = false;this.wireframeLinewidth = 1;this.setValues(parameters);};THREE.MeshDepthMaterial.prototype = _Object$create(THREE.Material.prototype);THREE.MeshDepthMaterial.prototype.constructor = THREE.MeshDepthMaterial;THREE.MeshDepthMaterial.prototype.copy = function(source){THREE.Material.prototype.copy.call(this,source);this.wireframe = source.wireframe;this.wireframeLinewidth = source.wireframeLinewidth;return this;}; // File:src/materials/MeshNormalMaterial.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t *\n\t * parameters = {\n\t *  opacity: <float>,\n\t *\n\t *  shading: THREE.FlatShading,\n\t *  blending: THREE.NormalBlending,\n\t *  depthTest: <bool>,\n\t *  depthWrite: <bool>,\n\t *\n\t *  wireframe: <boolean>,\n\t *  wireframeLinewidth: <float>\n\t * }\n\t */THREE.MeshNormalMaterial = function(parameters){THREE.Material.call(this,parameters);this.type = 'MeshNormalMaterial';this.wireframe = false;this.wireframeLinewidth = 1;this.morphTargets = false;this.setValues(parameters);};THREE.MeshNormalMaterial.prototype = _Object$create(THREE.Material.prototype);THREE.MeshNormalMaterial.prototype.constructor = THREE.MeshNormalMaterial;THREE.MeshNormalMaterial.prototype.copy = function(source){THREE.Material.prototype.copy.call(this,source);this.wireframe = source.wireframe;this.wireframeLinewidth = source.wireframeLinewidth;return this;}; // File:src/materials/MultiMaterial.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */THREE.MultiMaterial = function(materials){this.uuid = THREE.Math.generateUUID();this.type = 'MultiMaterial';this.materials = materials instanceof Array?materials:[];this.visible = true;};THREE.MultiMaterial.prototype = {constructor:THREE.MultiMaterial,toJSON:function toJSON(){var output={metadata:{version:4.2,type:'material',generator:'MaterialExporter'},uuid:this.uuid,type:this.type,materials:[]};for(var i=0,l=this.materials.length;i < l;i++) {output.materials.push(this.materials[i].toJSON());}output.visible = this.visible;return output;},clone:function clone(){var material=new this.constructor();for(var i=0;i < this.materials.length;i++) {material.materials.push(this.materials[i].clone());}material.visible = this.visible;return material;}}; // backwards compatibility\n\tTHREE.MeshFaceMaterial = THREE.MultiMaterial; // File:src/materials/PointsMaterial.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author alteredq / http://alteredqualia.com/\n\t *\n\t * parameters = {\n\t *  color: <hex>,\n\t *  opacity: <float>,\n\t *  map: new THREE.Texture( <Image> ),\n\t *\n\t *  size: <float>,\n\t *  sizeAttenuation: <bool>,\n\t *\n\t *  blending: THREE.NormalBlending,\n\t *  depthTest: <bool>,\n\t *  depthWrite: <bool>,\n\t *\n\t *  vertexColors: <bool>,\n\t *\n\t *  fog: <bool>\n\t * }\n\t */THREE.PointsMaterial = function(parameters){THREE.Material.call(this);this.type = 'PointsMaterial';this.color = new THREE.Color(0xffffff);this.map = null;this.size = 1;this.sizeAttenuation = true;this.vertexColors = THREE.NoColors;this.fog = true;this.setValues(parameters);};THREE.PointsMaterial.prototype = _Object$create(THREE.Material.prototype);THREE.PointsMaterial.prototype.constructor = THREE.PointsMaterial;THREE.PointsMaterial.prototype.copy = function(source){THREE.Material.prototype.copy.call(this,source);this.color.copy(source.color);this.map = source.map;this.size = source.size;this.sizeAttenuation = source.sizeAttenuation;this.vertexColors = source.vertexColors;this.fog = source.fog;return this;}; // backwards compatibility\n\tTHREE.PointCloudMaterial = function(parameters){console.warn('THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial.');return new THREE.PointsMaterial(parameters);};THREE.ParticleBasicMaterial = function(parameters){console.warn('THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial.');return new THREE.PointsMaterial(parameters);};THREE.ParticleSystemMaterial = function(parameters){console.warn('THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial.');return new THREE.PointsMaterial(parameters);}; // File:src/materials/ShaderMaterial.js\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t *\n\t * parameters = {\n\t *  defines: { \"label\" : \"value\" },\n\t *  uniforms: { \"parameter1\": { type: \"f\", value: 1.0 }, \"parameter2\": { type: \"i\" value2: 2 } },\n\t *\n\t *  fragmentShader: <string>,\n\t *  vertexShader: <string>,\n\t *\n\t *  shading: THREE.SmoothShading,\n\t *  blending: THREE.NormalBlending,\n\t *  depthTest: <bool>,\n\t *  depthWrite: <bool>,\n\t *\n\t *  wireframe: <boolean>,\n\t *  wireframeLinewidth: <float>,\n\t *\n\t *  lights: <bool>,\n\t *\n\t *  vertexColors: THREE.NoColors / THREE.VertexColors / THREE.FaceColors,\n\t *\n\t *  skinning: <bool>,\n\t *  morphTargets: <bool>,\n\t *  morphNormals: <bool>,\n\t *\n\t *\tfog: <bool>\n\t * }\n\t */THREE.ShaderMaterial = function(parameters){THREE.Material.call(this);this.type = 'ShaderMaterial';this.defines = {};this.uniforms = {};this.vertexShader = 'void main() {\\n\\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\\n}';this.fragmentShader = 'void main() {\\n\\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\\n}';this.shading = THREE.SmoothShading;this.linewidth = 1;this.wireframe = false;this.wireframeLinewidth = 1;this.fog = false; // set to use scene fog\n\tthis.lights = false; // set to use scene lights\n\tthis.vertexColors = THREE.NoColors; // set to use \"color\" attribute stream\n\tthis.skinning = false; // set to use skinning attribute streams\n\tthis.morphTargets = false; // set to use morph targets\n\tthis.morphNormals = false; // set to use morph normals\n\tthis.derivatives = false; // set to use derivatives\n\t// When rendered geometry doesn't include these attributes but the material does,\n\t// use these default values in WebGL. This avoids errors when buffer data is missing.\n\tthis.defaultAttributeValues = {'color':[1,1,1],'uv':[0,0],'uv2':[0,0]};this.index0AttributeName = undefined;if(parameters !== undefined){if(parameters.attributes !== undefined){console.error('THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead.');}this.setValues(parameters);}};THREE.ShaderMaterial.prototype = _Object$create(THREE.Material.prototype);THREE.ShaderMaterial.prototype.constructor = THREE.ShaderMaterial;THREE.ShaderMaterial.prototype.copy = function(source){THREE.Material.prototype.copy.call(this,source);this.fragmentShader = source.fragmentShader;this.vertexShader = source.vertexShader;this.uniforms = THREE.UniformsUtils.clone(source.uniforms);this.attributes = source.attributes;this.defines = source.defines;this.shading = source.shading;this.wireframe = source.wireframe;this.wireframeLinewidth = source.wireframeLinewidth;this.fog = source.fog;this.lights = source.lights;this.vertexColors = source.vertexColors;this.skinning = source.skinning;this.morphTargets = source.morphTargets;this.morphNormals = source.morphNormals;this.derivatives = source.derivatives;return this;};THREE.ShaderMaterial.prototype.toJSON = function(meta){var data=THREE.Material.prototype.toJSON.call(this,meta);data.uniforms = this.uniforms;data.attributes = this.attributes;data.vertexShader = this.vertexShader;data.fragmentShader = this.fragmentShader;return data;}; // File:src/materials/RawShaderMaterial.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */THREE.RawShaderMaterial = function(parameters){THREE.ShaderMaterial.call(this,parameters);this.type = 'RawShaderMaterial';};THREE.RawShaderMaterial.prototype = _Object$create(THREE.ShaderMaterial.prototype);THREE.RawShaderMaterial.prototype.constructor = THREE.RawShaderMaterial; // File:src/materials/SpriteMaterial.js\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t *\n\t * parameters = {\n\t *  color: <hex>,\n\t *  opacity: <float>,\n\t *  map: new THREE.Texture( <Image> ),\n\t *\n\t *  blending: THREE.NormalBlending,\n\t *  depthTest: <bool>,\n\t *  depthWrite: <bool>,\n\t *\n\t *\tuvOffset: new THREE.Vector2(),\n\t *\tuvScale: new THREE.Vector2(),\n\t *\n\t *  fog: <bool>\n\t * }\n\t */THREE.SpriteMaterial = function(parameters){THREE.Material.call(this);this.type = 'SpriteMaterial';this.color = new THREE.Color(0xffffff);this.map = null;this.rotation = 0;this.fog = false; // set parameters\n\tthis.setValues(parameters);};THREE.SpriteMaterial.prototype = _Object$create(THREE.Material.prototype);THREE.SpriteMaterial.prototype.constructor = THREE.SpriteMaterial;THREE.SpriteMaterial.prototype.copy = function(source){THREE.Material.prototype.copy.call(this,source);this.color.copy(source.color);this.map = source.map;this.rotation = source.rotation;this.fog = source.fog;return this;}; // File:src/textures/Texture.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author szimek / https://github.com/szimek/\n\t */THREE.Texture = function(image,mapping,wrapS,wrapT,magFilter,minFilter,format,type,anisotropy){Object.defineProperty(this,'id',{value:THREE.TextureIdCount++});this.uuid = THREE.Math.generateUUID();this.name = '';this.sourceFile = '';this.image = image !== undefined?image:THREE.Texture.DEFAULT_IMAGE;this.mipmaps = [];this.mapping = mapping !== undefined?mapping:THREE.Texture.DEFAULT_MAPPING;this.wrapS = wrapS !== undefined?wrapS:THREE.ClampToEdgeWrapping;this.wrapT = wrapT !== undefined?wrapT:THREE.ClampToEdgeWrapping;this.magFilter = magFilter !== undefined?magFilter:THREE.LinearFilter;this.minFilter = minFilter !== undefined?minFilter:THREE.LinearMipMapLinearFilter;this.anisotropy = anisotropy !== undefined?anisotropy:1;this.format = format !== undefined?format:THREE.RGBAFormat;this.type = type !== undefined?type:THREE.UnsignedByteType;this.offset = new THREE.Vector2(0,0);this.repeat = new THREE.Vector2(1,1);this.generateMipmaps = true;this.premultiplyAlpha = false;this.flipY = true;this.unpackAlignment = 4; // valid values: 1, 2, 4, 8 (see http://www.khronos.org/opengles/sdk/docs/man/xhtml/glPixelStorei.xml)\n\tthis.version = 0;this.onUpdate = null;};THREE.Texture.DEFAULT_IMAGE = undefined;THREE.Texture.DEFAULT_MAPPING = THREE.UVMapping;THREE.Texture.prototype = _Object$defineProperties({constructor:THREE.Texture,clone:function clone(){return new this.constructor().copy(this);},copy:function copy(source){this.image = source.image;this.mipmaps = source.mipmaps.slice(0);this.mapping = source.mapping;this.wrapS = source.wrapS;this.wrapT = source.wrapT;this.magFilter = source.magFilter;this.minFilter = source.minFilter;this.anisotropy = source.anisotropy;this.format = source.format;this.type = source.type;this.offset.copy(source.offset);this.repeat.copy(source.repeat);this.generateMipmaps = source.generateMipmaps;this.premultiplyAlpha = source.premultiplyAlpha;this.flipY = source.flipY;this.unpackAlignment = source.unpackAlignment;return this;},toJSON:function toJSON(meta){if(meta.textures[this.uuid] !== undefined){return meta.textures[this.uuid];}function getDataURL(image){var canvas;if(image.toDataURL !== undefined){canvas = image;}else {canvas = document.createElement('canvas');canvas.width = image.width;canvas.height = image.height;canvas.getContext('2d').drawImage(image,0,0,image.width,image.height);}if(canvas.width > 2048 || canvas.height > 2048){return canvas.toDataURL('image/jpeg',0.6);}else {return canvas.toDataURL('image/png');}}var output={metadata:{version:4.4,type:'Texture',generator:'Texture.toJSON'},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy};if(this.image !== undefined){ // TODO: Move to THREE.Image\n\tvar image=this.image;if(image.uuid === undefined){image.uuid = THREE.Math.generateUUID(); // UGH\n\t}if(meta.images[image.uuid] === undefined){meta.images[image.uuid] = {uuid:image.uuid,url:getDataURL(image)};}output.image = image.uuid;}meta.textures[this.uuid] = output;return output;},dispose:function dispose(){this.dispatchEvent({type:'dispose'});},transformUv:function transformUv(uv){if(this.mapping !== THREE.UVMapping)return;uv.multiply(this.repeat);uv.add(this.offset);if(uv.x < 0 || uv.x > 1){switch(this.wrapS){case THREE.RepeatWrapping:uv.x = uv.x - Math.floor(uv.x);break;case THREE.ClampToEdgeWrapping:uv.x = uv.x < 0?0:1;break;case THREE.MirroredRepeatWrapping:if(Math.abs(Math.floor(uv.x) % 2) === 1){uv.x = Math.ceil(uv.x) - uv.x;}else {uv.x = uv.x - Math.floor(uv.x);}break;}}if(uv.y < 0 || uv.y > 1){switch(this.wrapT){case THREE.RepeatWrapping:uv.y = uv.y - Math.floor(uv.y);break;case THREE.ClampToEdgeWrapping:uv.y = uv.y < 0?0:1;break;case THREE.MirroredRepeatWrapping:if(Math.abs(Math.floor(uv.y) % 2) === 1){uv.y = Math.ceil(uv.y) - uv.y;}else {uv.y = uv.y - Math.floor(uv.y);}break;}}if(this.flipY){uv.y = 1 - uv.y;}}},{needsUpdate:{set:function set(value){if(value === true)this.version++;},configurable:true,enumerable:true}});THREE.EventDispatcher.prototype.apply(THREE.Texture.prototype);THREE.TextureIdCount = 0; // File:src/textures/CanvasTexture.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */THREE.CanvasTexture = function(canvas,mapping,wrapS,wrapT,magFilter,minFilter,format,type,anisotropy){THREE.Texture.call(this,canvas,mapping,wrapS,wrapT,magFilter,minFilter,format,type,anisotropy);this.needsUpdate = true;};THREE.CanvasTexture.prototype = _Object$create(THREE.Texture.prototype);THREE.CanvasTexture.prototype.constructor = THREE.CanvasTexture; // File:src/textures/CubeTexture.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */THREE.CubeTexture = function(images,mapping,wrapS,wrapT,magFilter,minFilter,format,type,anisotropy){mapping = mapping !== undefined?mapping:THREE.CubeReflectionMapping;THREE.Texture.call(this,images,mapping,wrapS,wrapT,magFilter,minFilter,format,type,anisotropy);this.images = images;this.flipY = false;};THREE.CubeTexture.prototype = _Object$create(THREE.Texture.prototype);THREE.CubeTexture.prototype.constructor = THREE.CubeTexture;THREE.CubeTexture.prototype.copy = function(source){THREE.Texture.prototype.copy.call(this,source);this.images = source.images;return this;}; // File:src/textures/CompressedTexture.js\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t */THREE.CompressedTexture = function(mipmaps,width,height,format,type,mapping,wrapS,wrapT,magFilter,minFilter,anisotropy){THREE.Texture.call(this,null,mapping,wrapS,wrapT,magFilter,minFilter,format,type,anisotropy);this.image = {width:width,height:height};this.mipmaps = mipmaps; // no flipping for cube textures\n\t// (also flipping doesn't work for compressed textures )\n\tthis.flipY = false; // can't generate mipmaps for compressed textures\n\t// mips must be embedded in DDS files\n\tthis.generateMipmaps = false;};THREE.CompressedTexture.prototype = _Object$create(THREE.Texture.prototype);THREE.CompressedTexture.prototype.constructor = THREE.CompressedTexture; // File:src/textures/DataTexture.js\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t */THREE.DataTexture = function(data,width,height,format,type,mapping,wrapS,wrapT,magFilter,minFilter,anisotropy){THREE.Texture.call(this,null,mapping,wrapS,wrapT,magFilter,minFilter,format,type,anisotropy);this.image = {data:data,width:width,height:height};this.magFilter = magFilter !== undefined?magFilter:THREE.NearestFilter;this.minFilter = minFilter !== undefined?minFilter:THREE.NearestFilter;this.flipY = false;this.generateMipmaps = false;};THREE.DataTexture.prototype = _Object$create(THREE.Texture.prototype);THREE.DataTexture.prototype.constructor = THREE.DataTexture; // File:src/textures/VideoTexture.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */THREE.VideoTexture = function(video,mapping,wrapS,wrapT,magFilter,minFilter,format,type,anisotropy){THREE.Texture.call(this,video,mapping,wrapS,wrapT,magFilter,minFilter,format,type,anisotropy);this.generateMipmaps = false;var scope=this;var update=function update(){requestAnimationFrame(update);if(video.readyState === video.HAVE_ENOUGH_DATA){scope.needsUpdate = true;}};update();};THREE.VideoTexture.prototype = _Object$create(THREE.Texture.prototype);THREE.VideoTexture.prototype.constructor = THREE.VideoTexture; // File:src/objects/Group.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */THREE.Group = function(){THREE.Object3D.call(this);this.type = 'Group';};THREE.Group.prototype = _Object$create(THREE.Object3D.prototype);THREE.Group.prototype.constructor = THREE.Group; // File:src/objects/Points.js\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t */THREE.Points = function(geometry,material){THREE.Object3D.call(this);this.type = 'Points';this.geometry = geometry !== undefined?geometry:new THREE.Geometry();this.material = material !== undefined?material:new THREE.PointsMaterial({color:Math.random() * 0xffffff});};THREE.Points.prototype = _Object$create(THREE.Object3D.prototype);THREE.Points.prototype.constructor = THREE.Points;THREE.Points.prototype.raycast = (function(){var inverseMatrix=new THREE.Matrix4();var ray=new THREE.Ray();return function raycast(raycaster,intersects){var object=this;var geometry=object.geometry;var threshold=raycaster.params.Points.threshold;inverseMatrix.getInverse(this.matrixWorld);ray.copy(raycaster.ray).applyMatrix4(inverseMatrix);if(geometry.boundingBox !== null){if(ray.isIntersectionBox(geometry.boundingBox) === false){return;}}var localThreshold=threshold / ((this.scale.x + this.scale.y + this.scale.z) / 3);var localThresholdSq=localThreshold * localThreshold;var position=new THREE.Vector3();function testPoint(point,index){var rayPointDistanceSq=ray.distanceSqToPoint(point);if(rayPointDistanceSq < localThresholdSq){var intersectPoint=ray.closestPointToPoint(point);intersectPoint.applyMatrix4(object.matrixWorld);var distance=raycaster.ray.origin.distanceTo(intersectPoint);if(distance < raycaster.near || distance > raycaster.far)return;intersects.push({distance:distance,distanceToRay:Math.sqrt(rayPointDistanceSq),point:intersectPoint.clone(),index:index,face:null,object:object});}}if(geometry instanceof THREE.BufferGeometry){var index=geometry.index;var attributes=geometry.attributes;var positions=attributes.position.array;if(index !== null){var indices=index.array;for(var i=0,il=indices.length;i < il;i++) {var a=indices[i];position.fromArray(positions,a * 3);testPoint(position,a);}}else {for(var i=0,l=positions.length / 3;i < l;i++) {position.fromArray(positions,i * 3);testPoint(position,i);}}}else {var vertices=geometry.vertices;for(var i=0,l=vertices.length;i < l;i++) {testPoint(vertices[i],i);}}};})();THREE.Points.prototype.clone = function(){return new this.constructor(this.geometry,this.material).copy(this);};THREE.Points.prototype.toJSON = function(meta){var data=THREE.Object3D.prototype.toJSON.call(this,meta); // only serialize if not in meta geometries cache\n\tif(meta.geometries[this.geometry.uuid] === undefined){meta.geometries[this.geometry.uuid] = this.geometry.toJSON();} // only serialize if not in meta materials cache\n\tif(meta.materials[this.material.uuid] === undefined){meta.materials[this.material.uuid] = this.material.toJSON();}data.object.geometry = this.geometry.uuid;data.object.material = this.material.uuid;return data;}; // Backwards compatibility\n\tTHREE.PointCloud = function(geometry,material){console.warn('THREE.PointCloud has been renamed to THREE.Points.');return new THREE.Points(geometry,material);};THREE.ParticleSystem = function(geometry,material){console.warn('THREE.ParticleSystem has been renamed to THREE.Points.');return new THREE.Points(geometry,material);}; // File:src/objects/Line.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */THREE.Line = function(geometry,material,mode){if(mode === 1){console.warn('THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead.');return new THREE.LineSegments(geometry,material);}THREE.Object3D.call(this);this.type = 'Line';this.geometry = geometry !== undefined?geometry:new THREE.Geometry();this.material = material !== undefined?material:new THREE.LineBasicMaterial({color:Math.random() * 0xffffff});};THREE.Line.prototype = _Object$create(THREE.Object3D.prototype);THREE.Line.prototype.constructor = THREE.Line;THREE.Line.prototype.raycast = (function(){var inverseMatrix=new THREE.Matrix4();var ray=new THREE.Ray();var sphere=new THREE.Sphere();return function raycast(raycaster,intersects){var precision=raycaster.linePrecision;var precisionSq=precision * precision;var geometry=this.geometry;if(geometry.boundingSphere === null)geometry.computeBoundingSphere(); // Checking boundingSphere distance to ray\n\tsphere.copy(geometry.boundingSphere);sphere.applyMatrix4(this.matrixWorld);if(raycaster.ray.isIntersectionSphere(sphere) === false){return;}inverseMatrix.getInverse(this.matrixWorld);ray.copy(raycaster.ray).applyMatrix4(inverseMatrix);var vStart=new THREE.Vector3();var vEnd=new THREE.Vector3();var interSegment=new THREE.Vector3();var interRay=new THREE.Vector3();var step=this instanceof THREE.LineSegments?2:1;if(geometry instanceof THREE.BufferGeometry){var index=geometry.index;var attributes=geometry.attributes;if(index !== null){var indices=index.array;var positions=attributes.position.array;for(var i=0,l=indices.length - 1;i < l;i += step) {var a=indices[i];var b=indices[i + 1];vStart.fromArray(positions,a * 3);vEnd.fromArray(positions,b * 3);var distSq=ray.distanceSqToSegment(vStart,vEnd,interRay,interSegment);if(distSq > precisionSq)continue;interRay.applyMatrix4(this.matrixWorld); //Move back to world space for distance calculation\n\tvar distance=raycaster.ray.origin.distanceTo(interRay);if(distance < raycaster.near || distance > raycaster.far)continue;intersects.push({distance:distance, // What do we want? intersection point on the ray or on the segment??\n\t// point: raycaster.ray.at( distance ),\n\tpoint:interSegment.clone().applyMatrix4(this.matrixWorld),index:i,face:null,faceIndex:null,object:this});}}else {var positions=attributes.position.array;for(var i=0,l=positions.length / 3 - 1;i < l;i += step) {vStart.fromArray(positions,3 * i);vEnd.fromArray(positions,3 * i + 3);var distSq=ray.distanceSqToSegment(vStart,vEnd,interRay,interSegment);if(distSq > precisionSq)continue;interRay.applyMatrix4(this.matrixWorld); //Move back to world space for distance calculation\n\tvar distance=raycaster.ray.origin.distanceTo(interRay);if(distance < raycaster.near || distance > raycaster.far)continue;intersects.push({distance:distance, // What do we want? intersection point on the ray or on the segment??\n\t// point: raycaster.ray.at( distance ),\n\tpoint:interSegment.clone().applyMatrix4(this.matrixWorld),index:i,face:null,faceIndex:null,object:this});}}}else if(geometry instanceof THREE.Geometry){var vertices=geometry.vertices;var nbVertices=vertices.length;for(var i=0;i < nbVertices - 1;i += step) {var distSq=ray.distanceSqToSegment(vertices[i],vertices[i + 1],interRay,interSegment);if(distSq > precisionSq)continue;interRay.applyMatrix4(this.matrixWorld); //Move back to world space for distance calculation\n\tvar distance=raycaster.ray.origin.distanceTo(interRay);if(distance < raycaster.near || distance > raycaster.far)continue;intersects.push({distance:distance, // What do we want? intersection point on the ray or on the segment??\n\t// point: raycaster.ray.at( distance ),\n\tpoint:interSegment.clone().applyMatrix4(this.matrixWorld),index:i,face:null,faceIndex:null,object:this});}}};})();THREE.Line.prototype.clone = function(){return new this.constructor(this.geometry,this.material).copy(this);};THREE.Line.prototype.toJSON = function(meta){var data=THREE.Object3D.prototype.toJSON.call(this,meta); // only serialize if not in meta geometries cache\n\tif(meta.geometries[this.geometry.uuid] === undefined){meta.geometries[this.geometry.uuid] = this.geometry.toJSON();} // only serialize if not in meta materials cache\n\tif(meta.materials[this.material.uuid] === undefined){meta.materials[this.material.uuid] = this.material.toJSON();}data.object.geometry = this.geometry.uuid;data.object.material = this.material.uuid;return data;}; // DEPRECATED\n\tTHREE.LineStrip = 0;THREE.LinePieces = 1; // File:src/objects/LineSegments.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */THREE.LineSegments = function(geometry,material){THREE.Line.call(this,geometry,material);this.type = 'LineSegments';};THREE.LineSegments.prototype = _Object$create(THREE.Line.prototype);THREE.LineSegments.prototype.constructor = THREE.LineSegments; // File:src/objects/Mesh.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author mikael emtinger / http://gomo.se/\n\t * @author jonobr1 / http://jonobr1.com/\n\t */THREE.Mesh = function(geometry,material){THREE.Object3D.call(this);this.type = 'Mesh';this.geometry = geometry !== undefined?geometry:new THREE.Geometry();this.material = material !== undefined?material:new THREE.MeshBasicMaterial({color:Math.random() * 0xffffff});this.updateMorphTargets();};THREE.Mesh.prototype = _Object$create(THREE.Object3D.prototype);THREE.Mesh.prototype.constructor = THREE.Mesh;THREE.Mesh.prototype.updateMorphTargets = function(){if(this.geometry.morphTargets !== undefined && this.geometry.morphTargets.length > 0){this.morphTargetBase = -1;this.morphTargetInfluences = [];this.morphTargetDictionary = {};for(var m=0,ml=this.geometry.morphTargets.length;m < ml;m++) {this.morphTargetInfluences.push(0);this.morphTargetDictionary[this.geometry.morphTargets[m].name] = m;}}};THREE.Mesh.prototype.getMorphTargetIndexByName = function(name){if(this.morphTargetDictionary[name] !== undefined){return this.morphTargetDictionary[name];}console.warn('THREE.Mesh.getMorphTargetIndexByName: morph target ' + name + ' does not exist. Returning 0.');return 0;};THREE.Mesh.prototype.raycast = (function(){var inverseMatrix=new THREE.Matrix4();var ray=new THREE.Ray();var sphere=new THREE.Sphere();var vA=new THREE.Vector3();var vB=new THREE.Vector3();var vC=new THREE.Vector3();var tempA=new THREE.Vector3();var tempB=new THREE.Vector3();var tempC=new THREE.Vector3();var uvA=new THREE.Vector2();var uvB=new THREE.Vector2();var uvC=new THREE.Vector2();var barycoord=new THREE.Vector3();var intersectionPoint=new THREE.Vector3();var intersectionPointWorld=new THREE.Vector3();function uvIntersection(point,p1,p2,p3,uv1,uv2,uv3){THREE.Triangle.barycoordFromPoint(point,p1,p2,p3,barycoord);uv1.multiplyScalar(barycoord.x);uv2.multiplyScalar(barycoord.y);uv3.multiplyScalar(barycoord.z);uv1.add(uv2).add(uv3);return uv1.clone();}return function raycast(raycaster,intersects){var geometry=this.geometry;var material=this.material;if(material === undefined)return; // Checking boundingSphere distance to ray\n\tif(geometry.boundingSphere === null)geometry.computeBoundingSphere();sphere.copy(geometry.boundingSphere);sphere.applyMatrix4(this.matrixWorld);if(raycaster.ray.isIntersectionSphere(sphere) === false){return;} // Check boundingBox before continuing\n\tinverseMatrix.getInverse(this.matrixWorld);ray.copy(raycaster.ray).applyMatrix4(inverseMatrix);if(geometry.boundingBox !== null){if(ray.isIntersectionBox(geometry.boundingBox) === false){return;}}var a,b,c;if(geometry instanceof THREE.BufferGeometry){var index=geometry.index;var attributes=geometry.attributes;if(index !== null){var indices=index.array;var positions=attributes.position.array;for(var i=0,l=indices.length;i < l;i += 3) {a = indices[i];b = indices[i + 1];c = indices[i + 2];vA.fromArray(positions,a * 3);vB.fromArray(positions,b * 3);vC.fromArray(positions,c * 3);if(material.side === THREE.BackSide){if(ray.intersectTriangle(vC,vB,vA,true,intersectionPoint) === null)continue;}else {if(ray.intersectTriangle(vA,vB,vC,material.side !== THREE.DoubleSide,intersectionPoint) === null)continue;}intersectionPointWorld.copy(intersectionPoint);intersectionPointWorld.applyMatrix4(this.matrixWorld);var distance=raycaster.ray.origin.distanceTo(intersectionPointWorld);if(distance < raycaster.near || distance > raycaster.far)continue;var uv;if(attributes.uv !== undefined){var uvs=attributes.uv.array;uvA.fromArray(uvs,a * 2);uvB.fromArray(uvs,b * 2);uvC.fromArray(uvs,c * 2);uv = uvIntersection(intersectionPoint,vA,vB,vC,uvA,uvB,uvC);}intersects.push({distance:distance,point:intersectionPointWorld.clone(),uv:uv,face:new THREE.Face3(a,b,c,THREE.Triangle.normal(vA,vB,vC)),faceIndex:Math.floor(i / 3), // triangle number in indices buffer semantics\n\tobject:this});}}else {var positions=attributes.position.array;for(var i=0,l=positions.length;i < l;i += 9) {vA.fromArray(positions,i);vB.fromArray(positions,i + 3);vC.fromArray(positions,i + 6);if(material.side === THREE.BackSide){if(ray.intersectTriangle(vC,vB,vA,true,intersectionPoint) === null)continue;}else {if(ray.intersectTriangle(vA,vB,vC,material.side !== THREE.DoubleSide,intersectionPoint) === null)continue;}intersectionPointWorld.copy(intersectionPoint);intersectionPointWorld.applyMatrix4(this.matrixWorld);var distance=raycaster.ray.origin.distanceTo(intersectionPointWorld);if(distance < raycaster.near || distance > raycaster.far)continue;var uv;if(attributes.uv !== undefined){var uvs=attributes.uv.array;uvA.fromArray(uvs,i);uvB.fromArray(uvs,i + 2);uvC.fromArray(uvs,i + 4);uv = uvIntersection(intersectionPoint,vA,vB,vC,uvA,uvB,uvC);}a = i / 3;b = a + 1;c = a + 2;intersects.push({distance:distance,point:intersectionPointWorld.clone(),uv:uv,face:new THREE.Face3(a,b,c,THREE.Triangle.normal(vA,vB,vC)),index:a, // triangle number in positions buffer semantics\n\tobject:this});}}}else if(geometry instanceof THREE.Geometry){var isFaceMaterial=material instanceof THREE.MeshFaceMaterial;var materials=isFaceMaterial === true?material.materials:null;var vertices=geometry.vertices;var faces=geometry.faces;for(var f=0,fl=faces.length;f < fl;f++) {var face=faces[f];var faceMaterial=isFaceMaterial === true?materials[face.materialIndex]:material;if(faceMaterial === undefined)continue;a = vertices[face.a];b = vertices[face.b];c = vertices[face.c];if(faceMaterial.morphTargets === true){var morphTargets=geometry.morphTargets;var morphInfluences=this.morphTargetInfluences;vA.set(0,0,0);vB.set(0,0,0);vC.set(0,0,0);for(var t=0,tl=morphTargets.length;t < tl;t++) {var influence=morphInfluences[t];if(influence === 0)continue;var targets=morphTargets[t].vertices;vA.addScaledVector(tempA.subVectors(targets[face.a],a),influence);vB.addScaledVector(tempB.subVectors(targets[face.b],b),influence);vC.addScaledVector(tempC.subVectors(targets[face.c],c),influence);}vA.add(a);vB.add(b);vC.add(c);a = vA;b = vB;c = vC;}if(faceMaterial.side === THREE.BackSide){if(ray.intersectTriangle(c,b,a,true,intersectionPoint) === null)continue;}else {if(ray.intersectTriangle(a,b,c,faceMaterial.side !== THREE.DoubleSide,intersectionPoint) === null)continue;}intersectionPointWorld.copy(intersectionPoint);intersectionPointWorld.applyMatrix4(this.matrixWorld);var distance=raycaster.ray.origin.distanceTo(intersectionPointWorld);if(distance < raycaster.near || distance > raycaster.far)continue;var uv;if(geometry.faceVertexUvs[0].length > 0){var uvs=geometry.faceVertexUvs[0][f];uvA.copy(uvs[0]);uvB.copy(uvs[1]);uvC.copy(uvs[2]);uv = uvIntersection(intersectionPoint,a,b,c,uvA,uvB,uvC);}intersects.push({distance:distance,point:intersectionPointWorld.clone(),uv:uv,face:face,faceIndex:f,object:this});}}};})();THREE.Mesh.prototype.clone = function(){return new this.constructor(this.geometry,this.material).copy(this);};THREE.Mesh.prototype.toJSON = function(meta){var data=THREE.Object3D.prototype.toJSON.call(this,meta); // only serialize if not in meta geometries cache\n\tif(meta.geometries[this.geometry.uuid] === undefined){meta.geometries[this.geometry.uuid] = this.geometry.toJSON(meta);} // only serialize if not in meta materials cache\n\tif(meta.materials[this.material.uuid] === undefined){meta.materials[this.material.uuid] = this.material.toJSON(meta);}data.object.geometry = this.geometry.uuid;data.object.material = this.material.uuid;return data;}; // File:src/objects/Bone.js\n\t/**\n\t * @author mikael emtinger / http://gomo.se/\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author ikerr / http://verold.com\n\t */THREE.Bone = function(skin){THREE.Object3D.call(this);this.type = 'Bone';this.skin = skin;};THREE.Bone.prototype = _Object$create(THREE.Object3D.prototype);THREE.Bone.prototype.constructor = THREE.Bone;THREE.Bone.prototype.copy = function(source){THREE.Object3D.prototype.copy.call(this,source);this.skin = source.skin;return this;}; // File:src/objects/Skeleton.js\n\t/**\n\t * @author mikael emtinger / http://gomo.se/\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author michael guerrero / http://realitymeltdown.com\n\t * @author ikerr / http://verold.com\n\t */THREE.Skeleton = function(bones,boneInverses,useVertexTexture){this.useVertexTexture = useVertexTexture !== undefined?useVertexTexture:true;this.identityMatrix = new THREE.Matrix4(); // copy the bone array\n\tbones = bones || [];this.bones = bones.slice(0); // create a bone texture or an array of floats\n\tif(this.useVertexTexture){ // layout (1 matrix = 4 pixels)\n\t//      RGBA RGBA RGBA RGBA (=> column1, column2, column3, column4)\n\t//  with  8x8  pixel texture max   16 bones * 4 pixels =  (8 * 8)\n\t//       16x16 pixel texture max   64 bones * 4 pixels = (16 * 16)\n\t//       32x32 pixel texture max  256 bones * 4 pixels = (32 * 32)\n\t//       64x64 pixel texture max 1024 bones * 4 pixels = (64 * 64)\n\tvar size=Math.sqrt(this.bones.length * 4); // 4 pixels needed for 1 matrix\n\tsize = THREE.Math.nextPowerOfTwo(Math.ceil(size));size = Math.max(size,4);this.boneTextureWidth = size;this.boneTextureHeight = size;this.boneMatrices = new Float32Array(this.boneTextureWidth * this.boneTextureHeight * 4); // 4 floats per RGBA pixel\n\tthis.boneTexture = new THREE.DataTexture(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,THREE.RGBAFormat,THREE.FloatType);}else {this.boneMatrices = new Float32Array(16 * this.bones.length);} // use the supplied bone inverses or calculate the inverses\n\tif(boneInverses === undefined){this.calculateInverses();}else {if(this.bones.length === boneInverses.length){this.boneInverses = boneInverses.slice(0);}else {console.warn('THREE.Skeleton bonInverses is the wrong length.');this.boneInverses = [];for(var b=0,bl=this.bones.length;b < bl;b++) {this.boneInverses.push(new THREE.Matrix4());}}}};THREE.Skeleton.prototype.calculateInverses = function(){this.boneInverses = [];for(var b=0,bl=this.bones.length;b < bl;b++) {var inverse=new THREE.Matrix4();if(this.bones[b]){inverse.getInverse(this.bones[b].matrixWorld);}this.boneInverses.push(inverse);}};THREE.Skeleton.prototype.pose = function(){var bone; // recover the bind-time world matrices\n\tfor(var b=0,bl=this.bones.length;b < bl;b++) {bone = this.bones[b];if(bone){bone.matrixWorld.getInverse(this.boneInverses[b]);}} // compute the local matrices, positions, rotations and scales\n\tfor(var b=0,bl=this.bones.length;b < bl;b++) {bone = this.bones[b];if(bone){if(bone.parent){bone.matrix.getInverse(bone.parent.matrixWorld);bone.matrix.multiply(bone.matrixWorld);}else {bone.matrix.copy(bone.matrixWorld);}bone.matrix.decompose(bone.position,bone.quaternion,bone.scale);}}};THREE.Skeleton.prototype.update = (function(){var offsetMatrix=new THREE.Matrix4();return function update(){ // flatten bone matrices to array\n\tfor(var b=0,bl=this.bones.length;b < bl;b++) { // compute the offset between the current and the original transform\n\tvar matrix=this.bones[b]?this.bones[b].matrixWorld:this.identityMatrix;offsetMatrix.multiplyMatrices(matrix,this.boneInverses[b]);offsetMatrix.flattenToArrayOffset(this.boneMatrices,b * 16);}if(this.useVertexTexture){this.boneTexture.needsUpdate = true;}};})();THREE.Skeleton.prototype.clone = function(){return new THREE.Skeleton(this.bones,this.boneInverses,this.useVertexTexture);}; // File:src/objects/SkinnedMesh.js\n\t/**\n\t * @author mikael emtinger / http://gomo.se/\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author ikerr / http://verold.com\n\t */THREE.SkinnedMesh = function(geometry,material,useVertexTexture){THREE.Mesh.call(this,geometry,material);this.type = 'SkinnedMesh';this.bindMode = \"attached\";this.bindMatrix = new THREE.Matrix4();this.bindMatrixInverse = new THREE.Matrix4(); // init bones\n\t// TODO: remove bone creation as there is no reason (other than\n\t// convenience) for THREE.SkinnedMesh to do this.\n\tvar bones=[];if(this.geometry && this.geometry.bones !== undefined){var bone,gbone;for(var b=0,bl=this.geometry.bones.length;b < bl;++b) {gbone = this.geometry.bones[b];bone = new THREE.Bone(this);bones.push(bone);bone.name = gbone.name;bone.position.fromArray(gbone.pos);bone.quaternion.fromArray(gbone.rotq);if(gbone.scl !== undefined)bone.scale.fromArray(gbone.scl);}for(var b=0,bl=this.geometry.bones.length;b < bl;++b) {gbone = this.geometry.bones[b];if(gbone.parent !== -1){bones[gbone.parent].add(bones[b]);}else {this.add(bones[b]);}}}this.normalizeSkinWeights();this.updateMatrixWorld(true);this.bind(new THREE.Skeleton(bones,undefined,useVertexTexture),this.matrixWorld);};THREE.SkinnedMesh.prototype = _Object$create(THREE.Mesh.prototype);THREE.SkinnedMesh.prototype.constructor = THREE.SkinnedMesh;THREE.SkinnedMesh.prototype.bind = function(skeleton,bindMatrix){this.skeleton = skeleton;if(bindMatrix === undefined){this.updateMatrixWorld(true);this.skeleton.calculateInverses();bindMatrix = this.matrixWorld;}this.bindMatrix.copy(bindMatrix);this.bindMatrixInverse.getInverse(bindMatrix);};THREE.SkinnedMesh.prototype.pose = function(){this.skeleton.pose();};THREE.SkinnedMesh.prototype.normalizeSkinWeights = function(){if(this.geometry instanceof THREE.Geometry){for(var i=0;i < this.geometry.skinIndices.length;i++) {var sw=this.geometry.skinWeights[i];var scale=1.0 / sw.lengthManhattan();if(scale !== Infinity){sw.multiplyScalar(scale);}else {sw.set(1); // this will be normalized by the shader anyway\n\t}}}else { // skinning weights assumed to be normalized for THREE.BufferGeometry\n\t}};THREE.SkinnedMesh.prototype.updateMatrixWorld = function(force){THREE.Mesh.prototype.updateMatrixWorld.call(this,true);if(this.bindMode === \"attached\"){this.bindMatrixInverse.getInverse(this.matrixWorld);}else if(this.bindMode === \"detached\"){this.bindMatrixInverse.getInverse(this.bindMatrix);}else {console.warn('THREE.SkinnedMesh unrecognized bindMode: ' + this.bindMode);}};THREE.SkinnedMesh.prototype.clone = function(){return new this.constructor(this.geometry,this.material,this.useVertexTexture).copy(this);}; // File:src/objects/MorphAnimMesh.js\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t */THREE.MorphAnimMesh = function(geometry,material){THREE.Mesh.call(this,geometry,material);this.type = 'MorphAnimMesh'; // API\n\tthis.duration = 1000; // milliseconds\n\tthis.mirroredLoop = false;this.time = 0; // internals\n\tthis.lastKeyframe = 0;this.currentKeyframe = 0;this.direction = 1;this.directionBackwards = false;this.setFrameRange(0,geometry.morphTargets.length - 1);};THREE.MorphAnimMesh.prototype = _Object$create(THREE.Mesh.prototype);THREE.MorphAnimMesh.prototype.constructor = THREE.MorphAnimMesh;THREE.MorphAnimMesh.prototype.setFrameRange = function(start,end){this.startKeyframe = start;this.endKeyframe = end;this.length = this.endKeyframe - this.startKeyframe + 1;};THREE.MorphAnimMesh.prototype.setDirectionForward = function(){this.direction = 1;this.directionBackwards = false;};THREE.MorphAnimMesh.prototype.setDirectionBackward = function(){this.direction = -1;this.directionBackwards = true;};THREE.MorphAnimMesh.prototype.parseAnimations = function(){var geometry=this.geometry;if(!geometry.animations)geometry.animations = {};var firstAnimation,animations=geometry.animations;var pattern=/([a-z]+)_?(\\d+)/;for(var i=0,il=geometry.morphTargets.length;i < il;i++) {var morph=geometry.morphTargets[i];var parts=morph.name.match(pattern);if(parts && parts.length > 1){var label=parts[1];if(!animations[label])animations[label] = {start:Infinity,end:-Infinity};var animation=animations[label];if(i < animation.start)animation.start = i;if(i > animation.end)animation.end = i;if(!firstAnimation)firstAnimation = label;}}geometry.firstAnimation = firstAnimation;};THREE.MorphAnimMesh.prototype.setAnimationLabel = function(label,start,end){if(!this.geometry.animations)this.geometry.animations = {};this.geometry.animations[label] = {start:start,end:end};};THREE.MorphAnimMesh.prototype.playAnimation = function(label,fps){var animation=this.geometry.animations[label];if(animation){this.setFrameRange(animation.start,animation.end);this.duration = 1000 * ((animation.end - animation.start) / fps);this.time = 0;}else {console.warn('THREE.MorphAnimMesh: animation[' + label + '] undefined in .playAnimation()');}};THREE.MorphAnimMesh.prototype.updateAnimation = function(delta){var frameTime=this.duration / this.length;this.time += this.direction * delta;if(this.mirroredLoop){if(this.time > this.duration || this.time < 0){this.direction *= -1;if(this.time > this.duration){this.time = this.duration;this.directionBackwards = true;}if(this.time < 0){this.time = 0;this.directionBackwards = false;}}}else {this.time = this.time % this.duration;if(this.time < 0)this.time += this.duration;}var keyframe=this.startKeyframe + THREE.Math.clamp(Math.floor(this.time / frameTime),0,this.length - 1);var influences=this.morphTargetInfluences;if(keyframe !== this.currentKeyframe){influences[this.lastKeyframe] = 0;influences[this.currentKeyframe] = 1;influences[keyframe] = 0;this.lastKeyframe = this.currentKeyframe;this.currentKeyframe = keyframe;}var mix=this.time % frameTime / frameTime;if(this.directionBackwards){mix = 1 - mix;}influences[this.currentKeyframe] = mix;influences[this.lastKeyframe] = 1 - mix;};THREE.MorphAnimMesh.prototype.interpolateTargets = function(a,b,t){var influences=this.morphTargetInfluences;for(var i=0,l=influences.length;i < l;i++) {influences[i] = 0;}if(a > -1)influences[a] = 1 - t;if(b > -1)influences[b] = t;};THREE.MorphAnimMesh.prototype.copy = function(source){THREE.Mesh.prototype.copy.call(this,source);this.duration = source.duration;this.mirroredLoop = source.mirroredLoop;this.time = source.time;this.lastKeyframe = source.lastKeyframe;this.currentKeyframe = source.currentKeyframe;this.direction = source.direction;this.directionBackwards = source.directionBackwards;return this;}; // File:src/objects/LOD.js\n\t/**\n\t * @author mikael emtinger / http://gomo.se/\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author mrdoob / http://mrdoob.com/\n\t */THREE.LOD = function(){THREE.Object3D.call(this);this.type = 'LOD';_Object$defineProperties(this,{levels:{enumerable:true,value:[]},objects:{get:function get(){console.warn('THREE.LOD: .objects has been renamed to .levels.');return this.levels;}}});};THREE.LOD.prototype = _Object$create(THREE.Object3D.prototype);THREE.LOD.prototype.constructor = THREE.LOD;THREE.LOD.prototype.addLevel = function(object,distance){if(distance === undefined)distance = 0;distance = Math.abs(distance);var levels=this.levels;for(var l=0;l < levels.length;l++) {if(distance < levels[l].distance){break;}}levels.splice(l,0,{distance:distance,object:object});this.add(object);};THREE.LOD.prototype.getObjectForDistance = function(distance){var levels=this.levels;for(var i=1,l=levels.length;i < l;i++) {if(distance < levels[i].distance){break;}}return levels[i - 1].object;};THREE.LOD.prototype.raycast = (function(){var matrixPosition=new THREE.Vector3();return function raycast(raycaster,intersects){matrixPosition.setFromMatrixPosition(this.matrixWorld);var distance=raycaster.ray.origin.distanceTo(matrixPosition);this.getObjectForDistance(distance).raycast(raycaster,intersects);};})();THREE.LOD.prototype.update = (function(){var v1=new THREE.Vector3();var v2=new THREE.Vector3();return function update(camera){var levels=this.levels;if(levels.length > 1){v1.setFromMatrixPosition(camera.matrixWorld);v2.setFromMatrixPosition(this.matrixWorld);var distance=v1.distanceTo(v2);levels[0].object.visible = true;for(var i=1,l=levels.length;i < l;i++) {if(distance >= levels[i].distance){levels[i - 1].object.visible = false;levels[i].object.visible = true;}else {break;}}for(;i < l;i++) {levels[i].object.visible = false;}}};})();THREE.LOD.prototype.copy = function(source){THREE.Object3D.prototype.copy.call(this,source,false);var levels=source.levels;for(var i=0,l=levels.length;i < l;i++) {var level=levels[i];this.addLevel(level.object.clone(),level.distance);}return this;};THREE.LOD.prototype.toJSON = function(meta){var data=THREE.Object3D.prototype.toJSON.call(this,meta);data.object.levels = [];var levels=this.levels;for(var i=0,l=levels.length;i < l;i++) {var level=levels[i];data.object.levels.push({object:level.object.uuid,distance:level.distance});}return data;}; // File:src/objects/Sprite.js\n\t/**\n\t * @author mikael emtinger / http://gomo.se/\n\t * @author alteredq / http://alteredqualia.com/\n\t */THREE.Sprite = (function(){var indices=new Uint16Array([0,1,2,0,2,3]);var vertices=new Float32Array([-0.5,-0.5,0,0.5,-0.5,0,0.5,0.5,0,-0.5,0.5,0]);var uvs=new Float32Array([0,0,1,0,1,1,0,1]);var geometry=new THREE.BufferGeometry();geometry.setIndex(new THREE.BufferAttribute(indices,1));geometry.addAttribute('position',new THREE.BufferAttribute(vertices,3));geometry.addAttribute('uv',new THREE.BufferAttribute(uvs,2));return function Sprite(material){THREE.Object3D.call(this);this.type = 'Sprite';this.geometry = geometry;this.material = material !== undefined?material:new THREE.SpriteMaterial();};})();THREE.Sprite.prototype = _Object$create(THREE.Object3D.prototype);THREE.Sprite.prototype.constructor = THREE.Sprite;THREE.Sprite.prototype.raycast = (function(){var matrixPosition=new THREE.Vector3();return function raycast(raycaster,intersects){matrixPosition.setFromMatrixPosition(this.matrixWorld);var distanceSq=raycaster.ray.distanceSqToPoint(matrixPosition);var guessSizeSq=this.scale.x * this.scale.y;if(distanceSq > guessSizeSq){return;}intersects.push({distance:Math.sqrt(distanceSq),point:this.position,face:null,object:this});};})();THREE.Sprite.prototype.clone = function(){return new this.constructor(this.material).copy(this);};THREE.Sprite.prototype.toJSON = function(meta){var data=THREE.Object3D.prototype.toJSON.call(this,meta); // only serialize if not in meta materials cache\n\tif(meta.materials[this.material.uuid] === undefined){meta.materials[this.material.uuid] = this.material.toJSON();}data.object.material = this.material.uuid;return data;}; // Backwards compatibility\n\tTHREE.Particle = THREE.Sprite; // File:src/objects/LensFlare.js\n\t/**\n\t * @author mikael emtinger / http://gomo.se/\n\t * @author alteredq / http://alteredqualia.com/\n\t */THREE.LensFlare = function(texture,size,distance,blending,color){THREE.Object3D.call(this);this.lensFlares = [];this.positionScreen = new THREE.Vector3();this.customUpdateCallback = undefined;if(texture !== undefined){this.add(texture,size,distance,blending,color);}};THREE.LensFlare.prototype = _Object$create(THREE.Object3D.prototype);THREE.LensFlare.prototype.constructor = THREE.LensFlare; /*\n\t * Add: adds another flare\n\t */THREE.LensFlare.prototype.add = function(texture,size,distance,blending,color,opacity){if(size === undefined)size = -1;if(distance === undefined)distance = 0;if(opacity === undefined)opacity = 1;if(color === undefined)color = new THREE.Color(0xffffff);if(blending === undefined)blending = THREE.NormalBlending;distance = Math.min(distance,Math.max(0,distance));this.lensFlares.push({texture:texture, // THREE.Texture\n\tsize:size, // size in pixels (-1 = use texture.width)\n\tdistance:distance, // distance (0-1) from light source (0=at light source)\n\tx:0,y:0,z:0, // screen position (-1 => 1) z = 0 is in front z = 1 is back\n\tscale:1, // scale\n\trotation:0, // rotation\n\topacity:opacity, // opacity\n\tcolor:color, // color\n\tblending:blending // blending\n\t});}; /*\n\t * Update lens flares update positions on all flares based on the screen position\n\t * Set myLensFlare.customUpdateCallback to alter the flares in your project specific way.\n\t */THREE.LensFlare.prototype.updateLensFlares = function(){var f,fl=this.lensFlares.length;var flare;var vecX=-this.positionScreen.x * 2;var vecY=-this.positionScreen.y * 2;for(f = 0;f < fl;f++) {flare = this.lensFlares[f];flare.x = this.positionScreen.x + vecX * flare.distance;flare.y = this.positionScreen.y + vecY * flare.distance;flare.wantedRotation = flare.x * Math.PI * 0.25;flare.rotation += (flare.wantedRotation - flare.rotation) * 0.25;}};THREE.LensFlare.prototype.copy = function(source){THREE.Object3D.prototype.copy.call(this,source);this.positionScreen.copy(source.positionScreen);this.customUpdateCallback = source.customUpdateCallback;for(var i=0,l=source.lensFlares.length;i < l;i++) {this.lensFlares.push(source.lensFlares[i]);}return this;}; // File:src/scenes/Scene.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */THREE.Scene = function(){THREE.Object3D.call(this);this.type = 'Scene';this.fog = null;this.overrideMaterial = null;this.autoUpdate = true; // checked by the renderer\n\t};THREE.Scene.prototype = _Object$create(THREE.Object3D.prototype);THREE.Scene.prototype.constructor = THREE.Scene;THREE.Scene.prototype.copy = function(source){THREE.Object3D.prototype.copy.call(this,source);if(source.fog !== null)this.fog = source.fog.clone();if(source.overrideMaterial !== null)this.overrideMaterial = source.overrideMaterial.clone();this.autoUpdate = source.autoUpdate;this.matrixAutoUpdate = source.matrixAutoUpdate;return this;}; // File:src/scenes/Fog.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author alteredq / http://alteredqualia.com/\n\t */THREE.Fog = function(color,near,far){this.name = '';this.color = new THREE.Color(color);this.near = near !== undefined?near:1;this.far = far !== undefined?far:1000;};THREE.Fog.prototype.clone = function(){return new THREE.Fog(this.color.getHex(),this.near,this.far);}; // File:src/scenes/FogExp2.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author alteredq / http://alteredqualia.com/\n\t */THREE.FogExp2 = function(color,density){this.name = '';this.color = new THREE.Color(color);this.density = density !== undefined?density:0.00025;};THREE.FogExp2.prototype.clone = function(){return new THREE.FogExp2(this.color.getHex(),this.density);}; // File:src/renderers/shaders/ShaderChunk.js\n\tTHREE.ShaderChunk = {}; // File:src/renderers/shaders/ShaderChunk/alphamap_fragment.glsl\n\tTHREE.ShaderChunk['alphamap_fragment'] = \"#ifdef USE_ALPHAMAP\\n\\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\\n\\n#endif\\n\"; // File:src/renderers/shaders/ShaderChunk/alphamap_pars_fragment.glsl\n\tTHREE.ShaderChunk['alphamap_pars_fragment'] = \"#ifdef USE_ALPHAMAP\\n\\n\tuniform sampler2D alphaMap;\\n\\n#endif\\n\"; // File:src/renderers/shaders/ShaderChunk/alphatest_fragment.glsl\n\tTHREE.ShaderChunk['alphatest_fragment'] = \"#ifdef ALPHATEST\\n\\n\tif ( diffuseColor.a < ALPHATEST ) discard;\\n\\n#endif\\n\"; // File:src/renderers/shaders/ShaderChunk/aomap_fragment.glsl\n\tTHREE.ShaderChunk['aomap_fragment'] = \"#ifdef USE_AOMAP\\n\\n\ttotalAmbientLight *= ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\\n\\n#endif\\n\"; // File:src/renderers/shaders/ShaderChunk/aomap_pars_fragment.glsl\n\tTHREE.ShaderChunk['aomap_pars_fragment'] = \"#ifdef USE_AOMAP\\n\\n\tuniform sampler2D aoMap;\\n\tuniform float aoMapIntensity;\\n\\n#endif\"; // File:src/renderers/shaders/ShaderChunk/begin_vertex.glsl\n\tTHREE.ShaderChunk['begin_vertex'] = \"\\nvec3 transformed = vec3( position );\\n\"; // File:src/renderers/shaders/ShaderChunk/beginnormal_vertex.glsl\n\tTHREE.ShaderChunk['beginnormal_vertex'] = \"\\nvec3 objectNormal = vec3( normal );\\n\"; // File:src/renderers/shaders/ShaderChunk/bumpmap_pars_fragment.glsl\n\tTHREE.ShaderChunk['bumpmap_pars_fragment'] = \"#ifdef USE_BUMPMAP\\n\\n\tuniform sampler2D bumpMap;\\n\tuniform float bumpScale;\\n\\n\t// Derivative maps - bump mapping unparametrized surfaces by Morten Mikkelsen\\n\t// http://mmikkelsen3d.blogspot.sk/2011/07/derivative-maps.html\\n\\n\t// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)\\n\\n\tvec2 dHdxy_fwd() {\\n\\n\t\tvec2 dSTdx = dFdx( vUv );\\n\t\tvec2 dSTdy = dFdy( vUv );\\n\\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\\n\\n\t\treturn vec2( dBx, dBy );\\n\\n\t}\\n\\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\\n\\n\t\tvec3 vSigmaX = dFdx( surf_pos );\\n\t\tvec3 vSigmaY = dFdy( surf_pos );\\n\t\tvec3 vN = surf_norm;\t\t// normalized\\n\\n\t\tvec3 R1 = cross( vSigmaY, vN );\\n\t\tvec3 R2 = cross( vN, vSigmaX );\\n\\n\t\tfloat fDet = dot( vSigmaX, R1 );\\n\\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\\n\\n\t}\\n\\n#endif\\n\"; // File:src/renderers/shaders/ShaderChunk/color_fragment.glsl\n\tTHREE.ShaderChunk['color_fragment'] = \"#ifdef USE_COLOR\\n\\n\tdiffuseColor.rgb *= vColor;\\n\\n#endif\"; // File:src/renderers/shaders/ShaderChunk/color_pars_fragment.glsl\n\tTHREE.ShaderChunk['color_pars_fragment'] = \"#ifdef USE_COLOR\\n\\n\tvarying vec3 vColor;\\n\\n#endif\\n\"; // File:src/renderers/shaders/ShaderChunk/color_pars_vertex.glsl\n\tTHREE.ShaderChunk['color_pars_vertex'] = \"#ifdef USE_COLOR\\n\\n\tvarying vec3 vColor;\\n\\n#endif\"; // File:src/renderers/shaders/ShaderChunk/color_vertex.glsl\n\tTHREE.ShaderChunk['color_vertex'] = \"#ifdef USE_COLOR\\n\\n\tvColor.xyz = color.xyz;\\n\\n#endif\"; // File:src/renderers/shaders/ShaderChunk/common.glsl\n\tTHREE.ShaderChunk['common'] = \"#define PI 3.14159\\n#define PI2 6.28318\\n#define RECIPROCAL_PI2 0.15915494\\n#define LOG2 1.442695\\n#define EPSILON 1e-6\\n\\n#define saturate(a) clamp( a, 0.0, 1.0 )\\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\\n\\nvec3 transformDirection( in vec3 normal, in mat4 matrix ) {\\n\\n\treturn normalize( ( matrix * vec4( normal, 0.0 ) ).xyz );\\n\\n}\\n\\n// http://en.wikibooks.org/wiki/GLSL_Programming/Applying_Matrix_Transformations\\nvec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {\\n\\n\treturn normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );\\n\\n}\\n\\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\\n\\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\\n\\n\treturn - distance * planeNormal + point;\\n\\n}\\n\\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\\n\\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\\n\\n}\\n\\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\\n\\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\\n\\n}\\n\\nfloat calcLightAttenuation( float lightDistance, float cutoffDistance, float decayExponent ) {\\n\\n\tif ( decayExponent > 0.0 ) {\\n\\n\t  return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\\n\\n\t}\\n\\n\treturn 1.0;\\n\\n}\\n\\nvec3 F_Schlick( in vec3 specularColor, in float dotLH ) {\\n\\n\t// Original approximation by Christophe Schlick '94\\n\t//;float fresnel = pow( 1.0 - dotLH, 5.0 );\\n\\n\t// Optimized variant (presented by Epic at SIGGRAPH '13)\\n\tfloat fresnel = exp2( ( -5.55437 * dotLH - 6.98316 ) * dotLH );\\n\\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\\n\\n}\\n\\nfloat G_BlinnPhong_Implicit( /* in float dotNL, in float dotNV */ ) {\\n\\n\t// geometry term is (nl)(nv) / 4(nl)(nv)\\n\\n\treturn 0.25;\\n\\n}\\n\\nfloat D_BlinnPhong( in float shininess, in float dotNH ) {\\n\\n\t// factor of 1/PI in distribution term omitted\\n\\n\treturn ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\\n\\n}\\n\\nvec3 BRDF_BlinnPhong( in vec3 specularColor, in float shininess, in vec3 normal, in vec3 lightDir, in vec3 viewDir ) {\\n\\n\tvec3 halfDir = normalize( lightDir + viewDir );\\n\\n\t//float dotNL = saturate( dot( normal, lightDir ) );\\n\t//float dotNV = saturate( dot( normal, viewDir ) );\\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\\n\tfloat dotLH = saturate( dot( lightDir, halfDir ) );\\n\\n\tvec3 F = F_Schlick( specularColor, dotLH );\\n\\n\tfloat G = G_BlinnPhong_Implicit( /* dotNL, dotNV */ );\\n\\n\tfloat D = D_BlinnPhong( shininess, dotNH );\\n\\n\treturn F * G * D;\\n\\n}\\n\\nvec3 inputToLinear( in vec3 a ) {\\n\\n\t#ifdef GAMMA_INPUT\\n\\n\t\treturn pow( a, vec3( float( GAMMA_FACTOR ) ) );\\n\\n\t#else\\n\\n\t\treturn a;\\n\\n\t#endif\\n\\n}\\n\\nvec3 linearToOutput( in vec3 a ) {\\n\\n\t#ifdef GAMMA_OUTPUT\\n\\n\t\treturn pow( a, vec3( 1.0 / float( GAMMA_FACTOR ) ) );\\n\\n\t#else\\n\\n\t\treturn a;\\n\\n\t#endif\\n\\n}\\n\"; // File:src/renderers/shaders/ShaderChunk/defaultnormal_vertex.glsl\n\tTHREE.ShaderChunk['defaultnormal_vertex'] = \"#ifdef FLIP_SIDED\\n\\n\tobjectNormal = -objectNormal;\\n\\n#endif\\n\\nvec3 transformedNormal = normalMatrix * objectNormal;\\n\"; // File:src/renderers/shaders/ShaderChunk/displacementmap_vertex.glsl\n\tTHREE.ShaderChunk['displacementmap_vertex'] = \"#ifdef USE_DISPLACEMENTMAP\\n\\n\ttransformed += normal * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\\n\\n#endif\\n\"; // File:src/renderers/shaders/ShaderChunk/displacementmap_pars_vertex.glsl\n\tTHREE.ShaderChunk['displacementmap_pars_vertex'] = \"#ifdef USE_DISPLACEMENTMAP\\n\\n\tuniform sampler2D displacementMap;\\n\tuniform float displacementScale;\\n\tuniform float displacementBias;\\n\\n#endif\\n\"; // File:src/renderers/shaders/ShaderChunk/emissivemap_fragment.glsl\n\tTHREE.ShaderChunk['emissivemap_fragment'] = \"#ifdef USE_EMISSIVEMAP\\n\\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\\n\\n\temissiveColor.rgb = inputToLinear( emissiveColor.rgb );\\n\\n\ttotalEmissiveLight *= emissiveColor.rgb;\\n\\n#endif\\n\"; // File:src/renderers/shaders/ShaderChunk/emissivemap_pars_fragment.glsl\n\tTHREE.ShaderChunk['emissivemap_pars_fragment'] = \"#ifdef USE_EMISSIVEMAP\\n\\n\tuniform sampler2D emissiveMap;\\n\\n#endif\\n\"; // File:src/renderers/shaders/ShaderChunk/envmap_fragment.glsl\n\tTHREE.ShaderChunk['envmap_fragment'] = \"#ifdef USE_ENVMAP\\n\\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\\n\\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\\n\\n\t\t// Transforming Normal Vectors with the Inverse Transformation\\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\\n\\n\t\t#ifdef ENVMAP_MODE_REFLECTION\\n\\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\\n\\n\t\t#else\\n\\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\\n\\n\t\t#endif\\n\\n\t#else\\n\\n\t\tvec3 reflectVec = vReflect;\\n\\n\t#endif\\n\\n\t#ifdef DOUBLE_SIDED\\n\t\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\\n\t#else\\n\t\tfloat flipNormal = 1.0;\\n\t#endif\\n\\n\t#ifdef ENVMAP_TYPE_CUBE\\n\t\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\\n\\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\\n\t\tvec2 sampleUV;\\n\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\\n\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\\n\\n\t#elif defined( ENVMAP_TYPE_SPHERE )\\n\t\tvec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\\n\t#endif\\n\\n\tenvColor.xyz = inputToLinear( envColor.xyz );\\n\\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\\n\\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\\n\\n\t#elif defined( ENVMAP_BLENDING_MIX )\\n\\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\\n\\n\t#elif defined( ENVMAP_BLENDING_ADD )\\n\\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\\n\\n\t#endif\\n\\n#endif\\n\"; // File:src/renderers/shaders/ShaderChunk/envmap_pars_fragment.glsl\n\tTHREE.ShaderChunk['envmap_pars_fragment'] = \"#ifdef USE_ENVMAP\\n\\n\tuniform float reflectivity;\\n\t#ifdef ENVMAP_TYPE_CUBE\\n\t\tuniform samplerCube envMap;\\n\t#else\\n\t\tuniform sampler2D envMap;\\n\t#endif\\n\tuniform float flipEnvMap;\\n\\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\\n\\n\t\tuniform float refractionRatio;\\n\\n\t#else\\n\\n\t\tvarying vec3 vReflect;\\n\\n\t#endif\\n\\n#endif\\n\"; // File:src/renderers/shaders/ShaderChunk/envmap_pars_vertex.glsl\n\tTHREE.ShaderChunk['envmap_pars_vertex'] = \"#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\\n\\n\tvarying vec3 vReflect;\\n\\n\tuniform float refractionRatio;\\n\\n#endif\\n\"; // File:src/renderers/shaders/ShaderChunk/envmap_vertex.glsl\n\tTHREE.ShaderChunk['envmap_vertex'] = \"#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\\n\\n\tvec3 worldNormal = transformDirection( objectNormal, modelMatrix );\\n\\n\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\\n\\n\t#ifdef ENVMAP_MODE_REFLECTION\\n\\n\t\tvReflect = reflect( cameraToVertex, worldNormal );\\n\\n\t#else\\n\\n\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\\n\\n\t#endif\\n\\n#endif\\n\"; // File:src/renderers/shaders/ShaderChunk/fog_fragment.glsl\n\tTHREE.ShaderChunk['fog_fragment'] = \"#ifdef USE_FOG\\n\\n\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\\n\\n\t#else\\n\\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\\n\\n\t#endif\\n\\n\t#ifdef FOG_EXP2\\n\\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * depth * depth * LOG2 ) );\\n\\n\t#else\\n\\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, depth );\\n\\n\t#endif\\n\t\\n\toutgoingLight = mix( outgoingLight, fogColor, fogFactor );\\n\\n#endif\"; // File:src/renderers/shaders/ShaderChunk/fog_pars_fragment.glsl\n\tTHREE.ShaderChunk['fog_pars_fragment'] = \"#ifdef USE_FOG\\n\\n\tuniform vec3 fogColor;\\n\\n\t#ifdef FOG_EXP2\\n\\n\t\tuniform float fogDensity;\\n\\n\t#else\\n\\n\t\tuniform float fogNear;\\n\t\tuniform float fogFar;\\n\t#endif\\n\\n#endif\"; // File:src/renderers/shaders/ShaderChunk/lightmap_fragment.glsl\n\tTHREE.ShaderChunk['lightmap_fragment'] = \"#ifdef USE_LIGHTMAP\\n\\n\ttotalAmbientLight += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\\n\\n#endif\\n\"; // File:src/renderers/shaders/ShaderChunk/lightmap_pars_fragment.glsl\n\tTHREE.ShaderChunk['lightmap_pars_fragment'] = \"#ifdef USE_LIGHTMAP\\n\\n\tuniform sampler2D lightMap;\\n\tuniform float lightMapIntensity;\\n\\n#endif\"; // File:src/renderers/shaders/ShaderChunk/lights_lambert_pars_vertex.glsl\n\tTHREE.ShaderChunk['lights_lambert_pars_vertex'] = \"uniform vec3 ambientLightColor;\\n\\n#if MAX_DIR_LIGHTS > 0\\n\\n\tuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\\n\tuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_HEMI_LIGHTS > 0\\n\\n\tuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\\n\tuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\\n\tuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_POINT_LIGHTS > 0\\n\\n\tuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\\n\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\\n\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\\n\tuniform float pointLightDecay[ MAX_POINT_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0\\n\\n\tuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\\n\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\\n\tuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\\n\\n#endif\\n\"; // File:src/renderers/shaders/ShaderChunk/lights_lambert_vertex.glsl\n\tTHREE.ShaderChunk['lights_lambert_vertex'] = \"vLightFront = vec3( 0.0 );\\n\\n#ifdef DOUBLE_SIDED\\n\\n\tvLightBack = vec3( 0.0 );\\n\\n#endif\\n\\nvec3 normal = normalize( transformedNormal );\\n\\n#if MAX_POINT_LIGHTS > 0\\n\\n\tfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\\n\\n\t\tvec3 lightColor = pointLightColor[ i ];\\n\\n\t\tvec3 lVector = pointLightPosition[ i ] - mvPosition.xyz;\\n\t\tvec3 lightDir = normalize( lVector );\\n\\n\t\t// attenuation\\n\\n\t\tfloat attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\\n\\n\t\t// diffuse\\n\\n\t\tfloat dotProduct = dot( normal, lightDir );\\n\\n\t\tvLightFront += lightColor * attenuation * saturate( dotProduct );\\n\\n\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\tvLightBack += lightColor * attenuation * saturate( - dotProduct );\\n\\n\t\t#endif\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0\\n\\n\tfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\\n\\n\t\tvec3 lightColor = spotLightColor[ i ];\\n\\n\t\tvec3 lightPosition = spotLightPosition[ i ];\\n\t\tvec3 lVector = lightPosition - mvPosition.xyz;\\n\t\tvec3 lightDir = normalize( lVector );\\n\\n\t\tfloat spotEffect = dot( spotLightDirection[ i ], lightDir );\\n\\n\t\tif ( spotEffect > spotLightAngleCos[ i ] ) {\\n\\n\t\t\tspotEffect = saturate( pow( saturate( spotEffect ), spotLightExponent[ i ] ) );\\n\\n\t\t\t// attenuation\\n\\n\t\t\tfloat attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\\n\\n\t\t\tattenuation *= spotEffect;\\n\\n\t\t\t// diffuse\\n\\n\t\t\tfloat dotProduct = dot( normal, lightDir );\\n\\n\t\t\tvLightFront += lightColor * attenuation * saturate( dotProduct );\\n\\n\t\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\t\tvLightBack += lightColor * attenuation * saturate( - dotProduct );\\n\\n\t\t\t#endif\\n\\n\t\t}\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_DIR_LIGHTS > 0\\n\\n\tfor ( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\\n\\n\t\tvec3 lightColor = directionalLightColor[ i ];\\n\\n\t\tvec3 lightDir = directionalLightDirection[ i ];\\n\\n\t\t// diffuse\\n\\n\t\tfloat dotProduct = dot( normal, lightDir );\\n\\n\t\tvLightFront += lightColor * saturate( dotProduct );\\n\\n\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\tvLightBack += lightColor * saturate( - dotProduct );\\n\\n\t\t#endif\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_HEMI_LIGHTS > 0\\n\\n\tfor ( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\\n\\n\t\tvec3 lightDir = hemisphereLightDirection[ i ];\\n\\n\t\t// diffuse\\n\\n\t\tfloat dotProduct = dot( normal, lightDir );\\n\\n\t\tfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\\n\\n\t\tvLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\\n\\n\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\tfloat hemiDiffuseWeightBack = - 0.5 * dotProduct + 0.5;\\n\\n\t\t\tvLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );\\n\\n\t\t#endif\\n\\n\t}\\n\\n#endif\\n\\nvLightFront += ambientLightColor;\\n\\n#ifdef DOUBLE_SIDED\\n\\n\tvLightBack += ambientLightColor;\\n\\n#endif\\n\"; // File:src/renderers/shaders/ShaderChunk/lights_phong_fragment.glsl\n\tTHREE.ShaderChunk['lights_phong_fragment'] = \"#ifndef FLAT_SHADED\\n\\n\tvec3 normal = normalize( vNormal );\\n\\n\t#ifdef DOUBLE_SIDED\\n\\n\t\tnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\\n\\n\t#endif\\n\\n#else\\n\\n\tvec3 fdx = dFdx( vViewPosition );\\n\tvec3 fdy = dFdy( vViewPosition );\\n\tvec3 normal = normalize( cross( fdx, fdy ) );\\n\\n#endif\\n\\n#ifdef USE_NORMALMAP\\n\\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\\n\\n#elif defined( USE_BUMPMAP )\\n\\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\\n\\n#endif\\n\\nvec3 viewDir = normalize( vViewPosition );\\n\\nvec3 totalDiffuseLight = vec3( 0.0 );\\nvec3 totalSpecularLight = vec3( 0.0 );\\n\\n#if MAX_POINT_LIGHTS > 0\\n\\n\tfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\\n\\n\t\tvec3 lightColor = pointLightColor[ i ];\\n\\n\t\tvec3 lightPosition = pointLightPosition[ i ];\\n\t\tvec3 lVector = lightPosition + vViewPosition.xyz;\\n\t\tvec3 lightDir = normalize( lVector );\\n\\n\t\t// attenuation\\n\\n\t\tfloat attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\\n\\n\t\t// diffuse\\n\\n\t\tfloat cosineTerm = saturate( dot( normal, lightDir ) );\\n\\n\t\ttotalDiffuseLight += lightColor * attenuation * cosineTerm;\\n\\n\t\t// specular\\n\\n\t\tvec3 brdf = BRDF_BlinnPhong( specular, shininess, normal, lightDir, viewDir );\\n\\n\t\ttotalSpecularLight += brdf * specularStrength * lightColor * attenuation * cosineTerm;\\n\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0\\n\\n\tfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\\n\\n\t\tvec3 lightColor = spotLightColor[ i ];\\n\\n\t\tvec3 lightPosition = spotLightPosition[ i ];\\n\t\tvec3 lVector = lightPosition + vViewPosition.xyz;\\n\t\tvec3 lightDir = normalize( lVector );\\n\\n\t\tfloat spotEffect = dot( spotLightDirection[ i ], lightDir );\\n\\n\t\tif ( spotEffect > spotLightAngleCos[ i ] ) {\\n\\n\t\t\tspotEffect = saturate( pow( saturate( spotEffect ), spotLightExponent[ i ] ) );\\n\\n\t\t\t// attenuation\\n\\n\t\t\tfloat attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\\n\\n\t\t\tattenuation *= spotEffect;\\n\\n\t\t\t// diffuse\\n\\n\t\t\tfloat cosineTerm = saturate( dot( normal, lightDir ) );\\n\\n\t\t\ttotalDiffuseLight += lightColor * attenuation * cosineTerm;\\n\\n\t\t\t// specular\\n\\n\t\t\tvec3 brdf = BRDF_BlinnPhong( specular, shininess, normal, lightDir, viewDir );\\n\\n\t\t\ttotalSpecularLight += brdf * specularStrength * lightColor * attenuation * cosineTerm;\\n\\n\t\t}\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_DIR_LIGHTS > 0\\n\\n\tfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\\n\\n\t\tvec3 lightColor = directionalLightColor[ i ];\\n\\n\t\tvec3 lightDir = directionalLightDirection[ i ];\\n\\n\t\t// diffuse\\n\\n\t\tfloat cosineTerm = saturate( dot( normal, lightDir ) );\\n\\n\t\ttotalDiffuseLight += lightColor * cosineTerm;\\n\\n\t\t// specular\\n\\n\t\tvec3 brdf = BRDF_BlinnPhong( specular, shininess, normal, lightDir, viewDir );\\n\\n\t\ttotalSpecularLight += brdf * specularStrength * lightColor * cosineTerm;\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_HEMI_LIGHTS > 0\\n\\n\tfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\\n\\n\t\tvec3 lightDir = hemisphereLightDirection[ i ];\\n\\n\t\t// diffuse\\n\\n\t\tfloat dotProduct = dot( normal, lightDir );\\n\\n\t\tfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\\n\\n\t\tvec3 lightColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\\n\\n\t\ttotalDiffuseLight += lightColor;\\n\\n\t\t// specular (sky term only)\\n\\n\t\tvec3 brdf = BRDF_BlinnPhong( specular, shininess, normal, lightDir, viewDir );\\n\\n\t\ttotalSpecularLight += brdf * specularStrength * lightColor * max( dotProduct, 0.0 );\\n\\n\t}\\n\\n#endif\\n\\n#ifdef METAL\\n\\n\toutgoingLight += diffuseColor.rgb * ( totalDiffuseLight + totalAmbientLight ) * specular + totalSpecularLight + totalEmissiveLight;\\n\\n#else\\n\\n\toutgoingLight += diffuseColor.rgb * ( totalDiffuseLight + totalAmbientLight ) + totalSpecularLight + totalEmissiveLight;\\n\\n#endif\\n\"; // File:src/renderers/shaders/ShaderChunk/lights_phong_pars_fragment.glsl\n\tTHREE.ShaderChunk['lights_phong_pars_fragment'] = \"uniform vec3 ambientLightColor;\\n\\n#if MAX_DIR_LIGHTS > 0\\n\\n\tuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\\n\tuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_HEMI_LIGHTS > 0\\n\\n\tuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\\n\tuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\\n\tuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_POINT_LIGHTS > 0\\n\\n\tuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\\n\\n\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\\n\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\\n\tuniform float pointLightDecay[ MAX_POINT_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0\\n\\n\tuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\\n\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\\n\tuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_ENVMAP )\\n\\n\tvarying vec3 vWorldPosition;\\n\\n#endif\\n\\nvarying vec3 vViewPosition;\\n\\n#ifndef FLAT_SHADED\\n\\n\tvarying vec3 vNormal;\\n\\n#endif\\n\"; // File:src/renderers/shaders/ShaderChunk/lights_phong_pars_vertex.glsl\n\tTHREE.ShaderChunk['lights_phong_pars_vertex'] = \"#if MAX_SPOT_LIGHTS > 0 || defined( USE_ENVMAP )\\n\\n\tvarying vec3 vWorldPosition;\\n\\n#endif\\n\"; // File:src/renderers/shaders/ShaderChunk/lights_phong_vertex.glsl\n\tTHREE.ShaderChunk['lights_phong_vertex'] = \"#if MAX_SPOT_LIGHTS > 0 || defined( USE_ENVMAP )\\n\\n\tvWorldPosition = worldPosition.xyz;\\n\\n#endif\\n\"; // File:src/renderers/shaders/ShaderChunk/linear_to_gamma_fragment.glsl\n\tTHREE.ShaderChunk['linear_to_gamma_fragment'] = \"\\n\toutgoingLight = linearToOutput( outgoingLight );\\n\"; // File:src/renderers/shaders/ShaderChunk/logdepthbuf_fragment.glsl\n\tTHREE.ShaderChunk['logdepthbuf_fragment'] = \"#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\\n\\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\\n\\n#endif\"; // File:src/renderers/shaders/ShaderChunk/logdepthbuf_pars_fragment.glsl\n\tTHREE.ShaderChunk['logdepthbuf_pars_fragment'] = \"#ifdef USE_LOGDEPTHBUF\\n\\n\tuniform float logDepthBufFC;\\n\\n\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\n\t\tvarying float vFragDepth;\\n\\n\t#endif\\n\\n#endif\\n\"; // File:src/renderers/shaders/ShaderChunk/logdepthbuf_pars_vertex.glsl\n\tTHREE.ShaderChunk['logdepthbuf_pars_vertex'] = \"#ifdef USE_LOGDEPTHBUF\\n\\n\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\n\t\tvarying float vFragDepth;\\n\\n\t#endif\\n\\n\tuniform float logDepthBufFC;\\n\\n#endif\"; // File:src/renderers/shaders/ShaderChunk/logdepthbuf_vertex.glsl\n\tTHREE.ShaderChunk['logdepthbuf_vertex'] = \"#ifdef USE_LOGDEPTHBUF\\n\\n\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\\n\\n\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\n\t\tvFragDepth = 1.0 + gl_Position.w;\\n\\n#else\\n\\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\\n\\n\t#endif\\n\\n#endif\"; // File:src/renderers/shaders/ShaderChunk/map_fragment.glsl\n\tTHREE.ShaderChunk['map_fragment'] = \"#ifdef USE_MAP\\n\\n\tvec4 texelColor = texture2D( map, vUv );\\n\\n\ttexelColor.xyz = inputToLinear( texelColor.xyz );\\n\\n\tdiffuseColor *= texelColor;\\n\\n#endif\\n\"; // File:src/renderers/shaders/ShaderChunk/map_pars_fragment.glsl\n\tTHREE.ShaderChunk['map_pars_fragment'] = \"#ifdef USE_MAP\\n\\n\tuniform sampler2D map;\\n\\n#endif\"; // File:src/renderers/shaders/ShaderChunk/map_particle_fragment.glsl\n\tTHREE.ShaderChunk['map_particle_fragment'] = \"#ifdef USE_MAP\\n\\n\tdiffuseColor *= texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\\n\\n#endif\\n\"; // File:src/renderers/shaders/ShaderChunk/map_particle_pars_fragment.glsl\n\tTHREE.ShaderChunk['map_particle_pars_fragment'] = \"#ifdef USE_MAP\\n\\n\tuniform vec4 offsetRepeat;\\n\tuniform sampler2D map;\\n\\n#endif\\n\"; // File:src/renderers/shaders/ShaderChunk/morphnormal_vertex.glsl\n\tTHREE.ShaderChunk['morphnormal_vertex'] = \"#ifdef USE_MORPHNORMALS\\n\\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\\n\\n#endif\\n\"; // File:src/renderers/shaders/ShaderChunk/morphtarget_pars_vertex.glsl\n\tTHREE.ShaderChunk['morphtarget_pars_vertex'] = \"#ifdef USE_MORPHTARGETS\\n\\n\t#ifndef USE_MORPHNORMALS\\n\\n\tuniform float morphTargetInfluences[ 8 ];\\n\\n\t#else\\n\\n\tuniform float morphTargetInfluences[ 4 ];\\n\\n\t#endif\\n\\n#endif\"; // File:src/renderers/shaders/ShaderChunk/morphtarget_vertex.glsl\n\tTHREE.ShaderChunk['morphtarget_vertex'] = \"#ifdef USE_MORPHTARGETS\\n\\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\\n\\n\t#ifndef USE_MORPHNORMALS\\n\\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\\n\\n\t#endif\\n\\n#endif\\n\"; // File:src/renderers/shaders/ShaderChunk/normalmap_pars_fragment.glsl\n\tTHREE.ShaderChunk['normalmap_pars_fragment'] = \"#ifdef USE_NORMALMAP\\n\\n\tuniform sampler2D normalMap;\\n\tuniform vec2 normalScale;\\n\\n\t// Per-Pixel Tangent Space Normal Mapping\\n\t// http://hacksoflife.blogspot.ch/2009/11/per-pixel-tangent-space-normal-mapping.html\\n\\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\\n\\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\\n\t\tvec2 st0 = dFdx( vUv.st );\\n\t\tvec2 st1 = dFdy( vUv.st );\\n\\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\\n\t\tvec3 N = normalize( surf_norm );\\n\\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\\n\t\tmapN.xy = normalScale * mapN.xy;\\n\t\tmat3 tsn = mat3( S, T, N );\\n\t\treturn normalize( tsn * mapN );\\n\\n\t}\\n\\n#endif\\n\"; // File:src/renderers/shaders/ShaderChunk/project_vertex.glsl\n\tTHREE.ShaderChunk['project_vertex'] = \"#ifdef USE_SKINNING\\n\\n\tvec4 mvPosition = modelViewMatrix * skinned;\\n\\n#else\\n\\n\tvec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\\n\\n#endif\\n\\ngl_Position = projectionMatrix * mvPosition;\\n\"; // File:src/renderers/shaders/ShaderChunk/shadowmap_fragment.glsl\n\tTHREE.ShaderChunk['shadowmap_fragment'] = \"#ifdef USE_SHADOWMAP\\n\\n\t#ifdef SHADOWMAP_DEBUG\\n\\n\t\tvec3 frustumColors[3];\\n\t\tfrustumColors[0] = vec3( 1.0, 0.5, 0.0 );\\n\t\tfrustumColors[1] = vec3( 0.0, 1.0, 0.8 );\\n\t\tfrustumColors[2] = vec3( 0.0, 0.5, 1.0 );\\n\\n\t#endif\\n\\n\tfloat fDepth;\\n\tvec3 shadowColor = vec3( 1.0 );\\n\\n\tfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\\n\\n\t\tvec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\\n\\n\t\t\t\t// if ( something && something ) breaks ATI OpenGL shader compiler\\n\t\t\t\t// if ( all( something, something ) ) using this instead\\n\\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\\n\t\tbool inFrustum = all( inFrustumVec );\\n\\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\\n\\n\t\tbool frustumTest = all( frustumTestVec );\\n\\n\t\tif ( frustumTest ) {\\n\\n\t\t\tshadowCoord.z += shadowBias[ i ];\\n\\n\t\t\t#if defined( SHADOWMAP_TYPE_PCF )\\n\\n\t\t\t\t\t\t// Percentage-close filtering\\n\t\t\t\t\t\t// (9 pixel kernel)\\n\t\t\t\t\t\t// http://fabiensanglard.net/shadowmappingPCF/\\n\\n\t\t\t\tfloat shadow = 0.0;\\n\\n\t\t/*\\n\t\t\t\t\t\t// nested loops breaks shader compiler / validator on some ATI cards when using OpenGL\\n\t\t\t\t\t\t// must enroll loop manually\\n\\n\t\t\t\tfor ( float y = -1.25; y <= 1.25; y += 1.25 )\\n\t\t\t\t\tfor ( float x = -1.25; x <= 1.25; x += 1.25 ) {\\n\\n\t\t\t\t\t\tvec4 rgbaDepth = texture2D( shadowMap[ i ], vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy );\\n\\n\t\t\t\t\t\t\t\t// doesn't seem to produce any noticeable visual difference compared to simple texture2D lookup\\n\t\t\t\t\t\t\t\t//vec4 rgbaDepth = texture2DProj( shadowMap[ i ], vec4( vShadowCoord[ i ].w * ( vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy ), 0.05, vShadowCoord[ i ].w ) );\\n\\n\t\t\t\t\t\tfloat fDepth = unpackDepth( rgbaDepth );\\n\\n\t\t\t\t\t\tif ( fDepth < shadowCoord.z )\\n\t\t\t\t\t\t\tshadow += 1.0;\\n\\n\t\t\t\t}\\n\\n\t\t\t\tshadow /= 9.0;\\n\\n\t\t*/\\n\\n\t\t\t\tconst float shadowDelta = 1.0 / 9.0;\\n\\n\t\t\t\tfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\\n\t\t\t\tfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\\n\\n\t\t\t\tfloat dx0 = -1.25 * xPixelOffset;\\n\t\t\t\tfloat dy0 = -1.25 * yPixelOffset;\\n\t\t\t\tfloat dx1 = 1.25 * xPixelOffset;\\n\t\t\t\tfloat dy1 = 1.25 * yPixelOffset;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\\n\\n\t\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\\n\\n\t\t\t\t\t\t// Percentage-close filtering\\n\t\t\t\t\t\t// (9 pixel kernel)\\n\t\t\t\t\t\t// http://fabiensanglard.net/shadowmappingPCF/\\n\\n\t\t\t\tfloat shadow = 0.0;\\n\\n\t\t\t\tfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\\n\t\t\t\tfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\\n\\n\t\t\t\tfloat dx0 = -1.0 * xPixelOffset;\\n\t\t\t\tfloat dy0 = -1.0 * yPixelOffset;\\n\t\t\t\tfloat dx1 = 1.0 * xPixelOffset;\\n\t\t\t\tfloat dy1 = 1.0 * yPixelOffset;\\n\\n\t\t\t\tmat3 shadowKernel;\\n\t\t\t\tmat3 depthKernel;\\n\\n\t\t\t\tdepthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\\n\t\t\t\tdepthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\\n\t\t\t\tdepthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\\n\t\t\t\tdepthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\\n\t\t\t\tdepthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\\n\t\t\t\tdepthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\\n\t\t\t\tdepthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\\n\t\t\t\tdepthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\\n\t\t\t\tdepthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\\n\\n\t\t\t\tvec3 shadowZ = vec3( shadowCoord.z );\\n\t\t\t\tshadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));\\n\t\t\t\tshadowKernel[0] *= vec3(0.25);\\n\\n\t\t\t\tshadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));\\n\t\t\t\tshadowKernel[1] *= vec3(0.25);\\n\\n\t\t\t\tshadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));\\n\t\t\t\tshadowKernel[2] *= vec3(0.25);\\n\\n\t\t\t\tvec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );\\n\\n\t\t\t\tshadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );\\n\t\t\t\tshadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );\\n\\n\t\t\t\tvec4 shadowValues;\\n\t\t\t\tshadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );\\n\t\t\t\tshadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );\\n\t\t\t\tshadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );\\n\t\t\t\tshadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );\\n\\n\t\t\t\tshadow = dot( shadowValues, vec4( 1.0 ) );\\n\\n\t\t\t\tshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\\n\\n\t\t\t#else\\n\\n\t\t\t\tvec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\\n\t\t\t\tfloat fDepth = unpackDepth( rgbaDepth );\\n\\n\t\t\t\tif ( fDepth < shadowCoord.z )\\n\\n\t\t// spot with multiple shadows is darker\\n\\n\t\t\t\t\tshadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );\\n\\n\t\t// spot with multiple shadows has the same color as single shadow spot\\n\\n\t\t// \t\t\t\t\tshadowColor = min( shadowColor, vec3( shadowDarkness[ i ] ) );\\n\\n\t\t\t#endif\\n\\n\t\t}\\n\\n\\n\t\t#ifdef SHADOWMAP_DEBUG\\n\\n\t\t\tif ( inFrustum ) outgoingLight *= frustumColors[ i ];\\n\\n\t\t#endif\\n\\n\t}\\n\\n\toutgoingLight = outgoingLight * shadowColor;\\n\\n#endif\\n\"; // File:src/renderers/shaders/ShaderChunk/shadowmap_pars_fragment.glsl\n\tTHREE.ShaderChunk['shadowmap_pars_fragment'] = \"#ifdef USE_SHADOWMAP\\n\\n\tuniform sampler2D shadowMap[ MAX_SHADOWS ];\\n\tuniform vec2 shadowMapSize[ MAX_SHADOWS ];\\n\\n\tuniform float shadowDarkness[ MAX_SHADOWS ];\\n\tuniform float shadowBias[ MAX_SHADOWS ];\\n\\n\tvarying vec4 vShadowCoord[ MAX_SHADOWS ];\\n\\n\tfloat unpackDepth( const in vec4 rgba_depth ) {\\n\\n\t\tconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\\n\t\tfloat depth = dot( rgba_depth, bit_shift );\\n\t\treturn depth;\\n\\n\t}\\n\\n#endif\"; // File:src/renderers/shaders/ShaderChunk/shadowmap_pars_vertex.glsl\n\tTHREE.ShaderChunk['shadowmap_pars_vertex'] = \"#ifdef USE_SHADOWMAP\\n\\n\tvarying vec4 vShadowCoord[ MAX_SHADOWS ];\\n\tuniform mat4 shadowMatrix[ MAX_SHADOWS ];\\n\\n#endif\"; // File:src/renderers/shaders/ShaderChunk/shadowmap_vertex.glsl\n\tTHREE.ShaderChunk['shadowmap_vertex'] = \"#ifdef USE_SHADOWMAP\\n\\n\tfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\\n\\n\t\tvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\\n\\n\t}\\n\\n#endif\"; // File:src/renderers/shaders/ShaderChunk/skinbase_vertex.glsl\n\tTHREE.ShaderChunk['skinbase_vertex'] = \"#ifdef USE_SKINNING\\n\\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\\n\\n#endif\"; // File:src/renderers/shaders/ShaderChunk/skinning_pars_vertex.glsl\n\tTHREE.ShaderChunk['skinning_pars_vertex'] = \"#ifdef USE_SKINNING\\n\\n\tuniform mat4 bindMatrix;\\n\tuniform mat4 bindMatrixInverse;\\n\\n\t#ifdef BONE_TEXTURE\\n\\n\t\tuniform sampler2D boneTexture;\\n\t\tuniform int boneTextureWidth;\\n\t\tuniform int boneTextureHeight;\\n\\n\t\tmat4 getBoneMatrix( const in float i ) {\\n\\n\t\t\tfloat j = i * 4.0;\\n\t\t\tfloat x = mod( j, float( boneTextureWidth ) );\\n\t\t\tfloat y = floor( j / float( boneTextureWidth ) );\\n\\n\t\t\tfloat dx = 1.0 / float( boneTextureWidth );\\n\t\t\tfloat dy = 1.0 / float( boneTextureHeight );\\n\\n\t\t\ty = dy * ( y + 0.5 );\\n\\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\\n\\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\\n\\n\t\t\treturn bone;\\n\\n\t\t}\\n\\n\t#else\\n\\n\t\tuniform mat4 boneGlobalMatrices[ MAX_BONES ];\\n\\n\t\tmat4 getBoneMatrix( const in float i ) {\\n\\n\t\t\tmat4 bone = boneGlobalMatrices[ int(i) ];\\n\t\t\treturn bone;\\n\\n\t\t}\\n\\n\t#endif\\n\\n#endif\\n\"; // File:src/renderers/shaders/ShaderChunk/skinning_vertex.glsl\n\tTHREE.ShaderChunk['skinning_vertex'] = \"#ifdef USE_SKINNING\\n\\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\\n\\n\tvec4 skinned = vec4( 0.0 );\\n\tskinned += boneMatX * skinVertex * skinWeight.x;\\n\tskinned += boneMatY * skinVertex * skinWeight.y;\\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\\n\tskinned += boneMatW * skinVertex * skinWeight.w;\\n\tskinned  = bindMatrixInverse * skinned;\\n\\n#endif\\n\"; // File:src/renderers/shaders/ShaderChunk/skinnormal_vertex.glsl\n\tTHREE.ShaderChunk['skinnormal_vertex'] = \"#ifdef USE_SKINNING\\n\\n\tmat4 skinMatrix = mat4( 0.0 );\\n\tskinMatrix += skinWeight.x * boneMatX;\\n\tskinMatrix += skinWeight.y * boneMatY;\\n\tskinMatrix += skinWeight.z * boneMatZ;\\n\tskinMatrix += skinWeight.w * boneMatW;\\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\\n\\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\\n\\n#endif\\n\"; // File:src/renderers/shaders/ShaderChunk/specularmap_fragment.glsl\n\tTHREE.ShaderChunk['specularmap_fragment'] = \"float specularStrength;\\n\\n#ifdef USE_SPECULARMAP\\n\\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\\n\tspecularStrength = texelSpecular.r;\\n\\n#else\\n\\n\tspecularStrength = 1.0;\\n\\n#endif\"; // File:src/renderers/shaders/ShaderChunk/specularmap_pars_fragment.glsl\n\tTHREE.ShaderChunk['specularmap_pars_fragment'] = \"#ifdef USE_SPECULARMAP\\n\\n\tuniform sampler2D specularMap;\\n\\n#endif\"; // File:src/renderers/shaders/ShaderChunk/uv2_pars_fragment.glsl\n\tTHREE.ShaderChunk['uv2_pars_fragment'] = \"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\n\\n\tvarying vec2 vUv2;\\n\\n#endif\"; // File:src/renderers/shaders/ShaderChunk/uv2_pars_vertex.glsl\n\tTHREE.ShaderChunk['uv2_pars_vertex'] = \"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\n\\n\tattribute vec2 uv2;\\n\tvarying vec2 vUv2;\\n\\n#endif\"; // File:src/renderers/shaders/ShaderChunk/uv2_vertex.glsl\n\tTHREE.ShaderChunk['uv2_vertex'] = \"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\n\\n\tvUv2 = uv2;\\n\\n#endif\"; // File:src/renderers/shaders/ShaderChunk/uv_pars_fragment.glsl\n\tTHREE.ShaderChunk['uv_pars_fragment'] = \"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP )\\n\\n\tvarying vec2 vUv;\\n\\n#endif\"; // File:src/renderers/shaders/ShaderChunk/uv_pars_vertex.glsl\n\tTHREE.ShaderChunk['uv_pars_vertex'] = \"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP )\\n\\n\tvarying vec2 vUv;\\n\tuniform vec4 offsetRepeat;\\n\\n#endif\\n\"; // File:src/renderers/shaders/ShaderChunk/uv_vertex.glsl\n\tTHREE.ShaderChunk['uv_vertex'] = \"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP )\\n\\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\\n\\n#endif\"; // File:src/renderers/shaders/ShaderChunk/worldpos_vertex.glsl\n\tTHREE.ShaderChunk['worldpos_vertex'] = \"#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\\n\\n\t#ifdef USE_SKINNING\\n\\n\t\tvec4 worldPosition = modelMatrix * skinned;\\n\\n\t#else\\n\\n\t\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\\n\\n\t#endif\\n\\n#endif\\n\"; // File:src/renderers/shaders/UniformsUtils.js\n\t/**\n\t * Uniform Utilities\n\t */THREE.UniformsUtils = {merge:function merge(uniforms){var merged={};for(var u=0;u < uniforms.length;u++) {var tmp=this.clone(uniforms[u]);for(var p in tmp) {merged[p] = tmp[p];}}return merged;},clone:function clone(uniforms_src){var uniforms_dst={};for(var u in uniforms_src) {uniforms_dst[u] = {};for(var p in uniforms_src[u]) {var parameter_src=uniforms_src[u][p];if(parameter_src instanceof THREE.Color || parameter_src instanceof THREE.Vector2 || parameter_src instanceof THREE.Vector3 || parameter_src instanceof THREE.Vector4 || parameter_src instanceof THREE.Matrix3 || parameter_src instanceof THREE.Matrix4 || parameter_src instanceof THREE.Texture){uniforms_dst[u][p] = parameter_src.clone();}else if(Array.isArray(parameter_src)){uniforms_dst[u][p] = parameter_src.slice();}else {uniforms_dst[u][p] = parameter_src;}}}return uniforms_dst;}}; // File:src/renderers/shaders/UniformsLib.js\n\t/**\n\t * Uniforms library for shared webgl shaders\n\t */THREE.UniformsLib = {common:{\"diffuse\":{type:\"c\",value:new THREE.Color(0xeeeeee)},\"opacity\":{type:\"f\",value:1.0},\"map\":{type:\"t\",value:null},\"offsetRepeat\":{type:\"v4\",value:new THREE.Vector4(0,0,1,1)},\"specularMap\":{type:\"t\",value:null},\"alphaMap\":{type:\"t\",value:null},\"envMap\":{type:\"t\",value:null},\"flipEnvMap\":{type:\"f\",value:-1},\"reflectivity\":{type:\"f\",value:1.0},\"refractionRatio\":{type:\"f\",value:0.98}},aomap:{\"aoMap\":{type:\"t\",value:null},\"aoMapIntensity\":{type:\"f\",value:1}},lightmap:{\"lightMap\":{type:\"t\",value:null},\"lightMapIntensity\":{type:\"f\",value:1}},emissivemap:{\"emissiveMap\":{type:\"t\",value:null}},bumpmap:{\"bumpMap\":{type:\"t\",value:null},\"bumpScale\":{type:\"f\",value:1}},normalmap:{\"normalMap\":{type:\"t\",value:null},\"normalScale\":{type:\"v2\",value:new THREE.Vector2(1,1)}},displacementmap:{\"displacementMap\":{type:\"t\",value:null},\"displacementScale\":{type:\"f\",value:1},\"displacementBias\":{type:\"f\",value:0}},fog:{\"fogDensity\":{type:\"f\",value:0.00025},\"fogNear\":{type:\"f\",value:1},\"fogFar\":{type:\"f\",value:2000},\"fogColor\":{type:\"c\",value:new THREE.Color(0xffffff)}},lights:{\"ambientLightColor\":{type:\"fv\",value:[]},\"directionalLightDirection\":{type:\"fv\",value:[]},\"directionalLightColor\":{type:\"fv\",value:[]},\"hemisphereLightDirection\":{type:\"fv\",value:[]},\"hemisphereLightSkyColor\":{type:\"fv\",value:[]},\"hemisphereLightGroundColor\":{type:\"fv\",value:[]},\"pointLightColor\":{type:\"fv\",value:[]},\"pointLightPosition\":{type:\"fv\",value:[]},\"pointLightDistance\":{type:\"fv1\",value:[]},\"pointLightDecay\":{type:\"fv1\",value:[]},\"spotLightColor\":{type:\"fv\",value:[]},\"spotLightPosition\":{type:\"fv\",value:[]},\"spotLightDirection\":{type:\"fv\",value:[]},\"spotLightDistance\":{type:\"fv1\",value:[]},\"spotLightAngleCos\":{type:\"fv1\",value:[]},\"spotLightExponent\":{type:\"fv1\",value:[]},\"spotLightDecay\":{type:\"fv1\",value:[]}},points:{\"psColor\":{type:\"c\",value:new THREE.Color(0xeeeeee)},\"opacity\":{type:\"f\",value:1.0},\"size\":{type:\"f\",value:1.0},\"scale\":{type:\"f\",value:1.0},\"map\":{type:\"t\",value:null},\"offsetRepeat\":{type:\"v4\",value:new THREE.Vector4(0,0,1,1)},\"fogDensity\":{type:\"f\",value:0.00025},\"fogNear\":{type:\"f\",value:1},\"fogFar\":{type:\"f\",value:2000},\"fogColor\":{type:\"c\",value:new THREE.Color(0xffffff)}},shadowmap:{\"shadowMap\":{type:\"tv\",value:[]},\"shadowMapSize\":{type:\"v2v\",value:[]},\"shadowBias\":{type:\"fv1\",value:[]},\"shadowDarkness\":{type:\"fv1\",value:[]},\"shadowMatrix\":{type:\"m4v\",value:[]}}}; // File:src/renderers/shaders/ShaderLib.js\n\t/**\n\t * Webgl Shader Library for three.js\n\t *\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author mikael emtinger / http://gomo.se/\n\t */THREE.ShaderLib = {'basic':{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib[\"common\"],THREE.UniformsLib[\"aomap\"],THREE.UniformsLib[\"fog\"],THREE.UniformsLib[\"shadowmap\"]]),vertexShader:[THREE.ShaderChunk[\"common\"],THREE.ShaderChunk[\"uv_pars_vertex\"],THREE.ShaderChunk[\"uv2_pars_vertex\"],THREE.ShaderChunk[\"envmap_pars_vertex\"],THREE.ShaderChunk[\"color_pars_vertex\"],THREE.ShaderChunk[\"morphtarget_pars_vertex\"],THREE.ShaderChunk[\"skinning_pars_vertex\"],THREE.ShaderChunk[\"shadowmap_pars_vertex\"],THREE.ShaderChunk[\"logdepthbuf_pars_vertex\"],\"void main() {\",THREE.ShaderChunk[\"uv_vertex\"],THREE.ShaderChunk[\"uv2_vertex\"],THREE.ShaderChunk[\"color_vertex\"],THREE.ShaderChunk[\"skinbase_vertex\"],\"\t#ifdef USE_ENVMAP\",THREE.ShaderChunk[\"beginnormal_vertex\"],THREE.ShaderChunk[\"morphnormal_vertex\"],THREE.ShaderChunk[\"skinnormal_vertex\"],THREE.ShaderChunk[\"defaultnormal_vertex\"],\"\t#endif\",THREE.ShaderChunk[\"begin_vertex\"],THREE.ShaderChunk[\"morphtarget_vertex\"],THREE.ShaderChunk[\"skinning_vertex\"],THREE.ShaderChunk[\"project_vertex\"],THREE.ShaderChunk[\"logdepthbuf_vertex\"],THREE.ShaderChunk[\"worldpos_vertex\"],THREE.ShaderChunk[\"envmap_vertex\"],THREE.ShaderChunk[\"shadowmap_vertex\"],\"}\"].join(\"\\n\"),fragmentShader:[\"uniform vec3 diffuse;\",\"uniform float opacity;\",THREE.ShaderChunk[\"common\"],THREE.ShaderChunk[\"color_pars_fragment\"],THREE.ShaderChunk[\"uv_pars_fragment\"],THREE.ShaderChunk[\"uv2_pars_fragment\"],THREE.ShaderChunk[\"map_pars_fragment\"],THREE.ShaderChunk[\"alphamap_pars_fragment\"],THREE.ShaderChunk[\"aomap_pars_fragment\"],THREE.ShaderChunk[\"envmap_pars_fragment\"],THREE.ShaderChunk[\"fog_pars_fragment\"],THREE.ShaderChunk[\"shadowmap_pars_fragment\"],THREE.ShaderChunk[\"specularmap_pars_fragment\"],THREE.ShaderChunk[\"logdepthbuf_pars_fragment\"],\"void main() {\",\"\tvec3 outgoingLight = vec3( 0.0 );\",\"\tvec4 diffuseColor = vec4( diffuse, opacity );\",\"\tvec3 totalAmbientLight = vec3( 1.0 );\", // hardwired\n\tTHREE.ShaderChunk[\"logdepthbuf_fragment\"],THREE.ShaderChunk[\"map_fragment\"],THREE.ShaderChunk[\"color_fragment\"],THREE.ShaderChunk[\"alphamap_fragment\"],THREE.ShaderChunk[\"alphatest_fragment\"],THREE.ShaderChunk[\"specularmap_fragment\"],THREE.ShaderChunk[\"aomap_fragment\"],\"\toutgoingLight = diffuseColor.rgb * totalAmbientLight;\", // simple shader\n\tTHREE.ShaderChunk[\"envmap_fragment\"],THREE.ShaderChunk[\"shadowmap_fragment\"], // TODO: Shadows on an otherwise unlit surface doesn't make sense.\n\tTHREE.ShaderChunk[\"linear_to_gamma_fragment\"],THREE.ShaderChunk[\"fog_fragment\"],\"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\",\"}\"].join(\"\\n\")},'lambert':{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib[\"common\"],THREE.UniformsLib[\"fog\"],THREE.UniformsLib[\"lights\"],THREE.UniformsLib[\"shadowmap\"],{\"emissive\":{type:\"c\",value:new THREE.Color(0x000000)}}]),vertexShader:[\"#define LAMBERT\",\"varying vec3 vLightFront;\",\"#ifdef DOUBLE_SIDED\",\"\tvarying vec3 vLightBack;\",\"#endif\",THREE.ShaderChunk[\"common\"],THREE.ShaderChunk[\"uv_pars_vertex\"],THREE.ShaderChunk[\"uv2_pars_vertex\"],THREE.ShaderChunk[\"envmap_pars_vertex\"],THREE.ShaderChunk[\"lights_lambert_pars_vertex\"],THREE.ShaderChunk[\"color_pars_vertex\"],THREE.ShaderChunk[\"morphtarget_pars_vertex\"],THREE.ShaderChunk[\"skinning_pars_vertex\"],THREE.ShaderChunk[\"shadowmap_pars_vertex\"],THREE.ShaderChunk[\"logdepthbuf_pars_vertex\"],\"void main() {\",THREE.ShaderChunk[\"uv_vertex\"],THREE.ShaderChunk[\"uv2_vertex\"],THREE.ShaderChunk[\"color_vertex\"],THREE.ShaderChunk[\"beginnormal_vertex\"],THREE.ShaderChunk[\"morphnormal_vertex\"],THREE.ShaderChunk[\"skinbase_vertex\"],THREE.ShaderChunk[\"skinnormal_vertex\"],THREE.ShaderChunk[\"defaultnormal_vertex\"],THREE.ShaderChunk[\"begin_vertex\"],THREE.ShaderChunk[\"morphtarget_vertex\"],THREE.ShaderChunk[\"skinning_vertex\"],THREE.ShaderChunk[\"project_vertex\"],THREE.ShaderChunk[\"logdepthbuf_vertex\"],THREE.ShaderChunk[\"worldpos_vertex\"],THREE.ShaderChunk[\"envmap_vertex\"],THREE.ShaderChunk[\"lights_lambert_vertex\"],THREE.ShaderChunk[\"shadowmap_vertex\"],\"}\"].join(\"\\n\"),fragmentShader:[\"uniform vec3 diffuse;\",\"uniform vec3 emissive;\",\"uniform float opacity;\",\"varying vec3 vLightFront;\",\"#ifdef DOUBLE_SIDED\",\"\tvarying vec3 vLightBack;\",\"#endif\",THREE.ShaderChunk[\"common\"],THREE.ShaderChunk[\"color_pars_fragment\"],THREE.ShaderChunk[\"uv_pars_fragment\"],THREE.ShaderChunk[\"uv2_pars_fragment\"],THREE.ShaderChunk[\"map_pars_fragment\"],THREE.ShaderChunk[\"alphamap_pars_fragment\"],THREE.ShaderChunk[\"envmap_pars_fragment\"],THREE.ShaderChunk[\"fog_pars_fragment\"],THREE.ShaderChunk[\"shadowmap_pars_fragment\"],THREE.ShaderChunk[\"specularmap_pars_fragment\"],THREE.ShaderChunk[\"logdepthbuf_pars_fragment\"],\"void main() {\",\"\tvec3 outgoingLight = vec3( 0.0 );\", // outgoing light does not have an alpha, the surface does\n\t\"\tvec4 diffuseColor = vec4( diffuse, opacity );\",THREE.ShaderChunk[\"logdepthbuf_fragment\"],THREE.ShaderChunk[\"map_fragment\"],THREE.ShaderChunk[\"color_fragment\"],THREE.ShaderChunk[\"alphamap_fragment\"],THREE.ShaderChunk[\"alphatest_fragment\"],THREE.ShaderChunk[\"specularmap_fragment\"],\"\t#ifdef DOUBLE_SIDED\",\"\t\tif ( gl_FrontFacing )\",\"\t\t\toutgoingLight += diffuseColor.rgb * vLightFront + emissive;\",\"\t\telse\",\"\t\t\toutgoingLight += diffuseColor.rgb * vLightBack + emissive;\",\"\t#else\",\"\t\toutgoingLight += diffuseColor.rgb * vLightFront + emissive;\",\"\t#endif\",THREE.ShaderChunk[\"envmap_fragment\"],THREE.ShaderChunk[\"shadowmap_fragment\"],THREE.ShaderChunk[\"linear_to_gamma_fragment\"],THREE.ShaderChunk[\"fog_fragment\"],\"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\",\"}\"].join(\"\\n\")},'phong':{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib[\"common\"],THREE.UniformsLib[\"aomap\"],THREE.UniformsLib[\"lightmap\"],THREE.UniformsLib[\"emissivemap\"],THREE.UniformsLib[\"bumpmap\"],THREE.UniformsLib[\"normalmap\"],THREE.UniformsLib[\"displacementmap\"],THREE.UniformsLib[\"fog\"],THREE.UniformsLib[\"lights\"],THREE.UniformsLib[\"shadowmap\"],{\"emissive\":{type:\"c\",value:new THREE.Color(0x000000)},\"specular\":{type:\"c\",value:new THREE.Color(0x111111)},\"shininess\":{type:\"f\",value:30}}]),vertexShader:[\"#define PHONG\",\"varying vec3 vViewPosition;\",\"#ifndef FLAT_SHADED\",\"\tvarying vec3 vNormal;\",\"#endif\",THREE.ShaderChunk[\"common\"],THREE.ShaderChunk[\"uv_pars_vertex\"],THREE.ShaderChunk[\"uv2_pars_vertex\"],THREE.ShaderChunk[\"displacementmap_pars_vertex\"],THREE.ShaderChunk[\"envmap_pars_vertex\"],THREE.ShaderChunk[\"lights_phong_pars_vertex\"],THREE.ShaderChunk[\"color_pars_vertex\"],THREE.ShaderChunk[\"morphtarget_pars_vertex\"],THREE.ShaderChunk[\"skinning_pars_vertex\"],THREE.ShaderChunk[\"shadowmap_pars_vertex\"],THREE.ShaderChunk[\"logdepthbuf_pars_vertex\"],\"void main() {\",THREE.ShaderChunk[\"uv_vertex\"],THREE.ShaderChunk[\"uv2_vertex\"],THREE.ShaderChunk[\"color_vertex\"],THREE.ShaderChunk[\"beginnormal_vertex\"],THREE.ShaderChunk[\"morphnormal_vertex\"],THREE.ShaderChunk[\"skinbase_vertex\"],THREE.ShaderChunk[\"skinnormal_vertex\"],THREE.ShaderChunk[\"defaultnormal_vertex\"],\"#ifndef FLAT_SHADED\", // Normal computed with derivatives when FLAT_SHADED\n\t\"\tvNormal = normalize( transformedNormal );\",\"#endif\",THREE.ShaderChunk[\"begin_vertex\"],THREE.ShaderChunk[\"displacementmap_vertex\"],THREE.ShaderChunk[\"morphtarget_vertex\"],THREE.ShaderChunk[\"skinning_vertex\"],THREE.ShaderChunk[\"project_vertex\"],THREE.ShaderChunk[\"logdepthbuf_vertex\"],\"\tvViewPosition = - mvPosition.xyz;\",THREE.ShaderChunk[\"worldpos_vertex\"],THREE.ShaderChunk[\"envmap_vertex\"],THREE.ShaderChunk[\"lights_phong_vertex\"],THREE.ShaderChunk[\"shadowmap_vertex\"],\"}\"].join(\"\\n\"),fragmentShader:[\"#define PHONG\",\"uniform vec3 diffuse;\",\"uniform vec3 emissive;\",\"uniform vec3 specular;\",\"uniform float shininess;\",\"uniform float opacity;\",THREE.ShaderChunk[\"common\"],THREE.ShaderChunk[\"color_pars_fragment\"],THREE.ShaderChunk[\"uv_pars_fragment\"],THREE.ShaderChunk[\"uv2_pars_fragment\"],THREE.ShaderChunk[\"map_pars_fragment\"],THREE.ShaderChunk[\"alphamap_pars_fragment\"],THREE.ShaderChunk[\"aomap_pars_fragment\"],THREE.ShaderChunk[\"lightmap_pars_fragment\"],THREE.ShaderChunk[\"emissivemap_pars_fragment\"],THREE.ShaderChunk[\"envmap_pars_fragment\"],THREE.ShaderChunk[\"fog_pars_fragment\"],THREE.ShaderChunk[\"lights_phong_pars_fragment\"],THREE.ShaderChunk[\"shadowmap_pars_fragment\"],THREE.ShaderChunk[\"bumpmap_pars_fragment\"],THREE.ShaderChunk[\"normalmap_pars_fragment\"],THREE.ShaderChunk[\"specularmap_pars_fragment\"],THREE.ShaderChunk[\"logdepthbuf_pars_fragment\"],\"void main() {\",\"\tvec3 outgoingLight = vec3( 0.0 );\",\"\tvec4 diffuseColor = vec4( diffuse, opacity );\",\"\tvec3 totalAmbientLight = ambientLightColor;\",\"\tvec3 totalEmissiveLight = emissive;\",THREE.ShaderChunk[\"logdepthbuf_fragment\"],THREE.ShaderChunk[\"map_fragment\"],THREE.ShaderChunk[\"color_fragment\"],THREE.ShaderChunk[\"alphamap_fragment\"],THREE.ShaderChunk[\"alphatest_fragment\"],THREE.ShaderChunk[\"specularmap_fragment\"],THREE.ShaderChunk[\"lightmap_fragment\"],THREE.ShaderChunk[\"aomap_fragment\"],THREE.ShaderChunk[\"emissivemap_fragment\"],THREE.ShaderChunk[\"lights_phong_fragment\"],THREE.ShaderChunk[\"envmap_fragment\"],THREE.ShaderChunk[\"shadowmap_fragment\"],THREE.ShaderChunk[\"linear_to_gamma_fragment\"],THREE.ShaderChunk[\"fog_fragment\"],\"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\",\"}\"].join(\"\\n\")},'points':{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib[\"points\"],THREE.UniformsLib[\"shadowmap\"]]),vertexShader:[\"uniform float size;\",\"uniform float scale;\",THREE.ShaderChunk[\"common\"],THREE.ShaderChunk[\"color_pars_vertex\"],THREE.ShaderChunk[\"shadowmap_pars_vertex\"],THREE.ShaderChunk[\"logdepthbuf_pars_vertex\"],\"void main() {\",THREE.ShaderChunk[\"color_vertex\"],\"\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\",\"\t#ifdef USE_SIZEATTENUATION\",\"\t\tgl_PointSize = size * ( scale / length( mvPosition.xyz ) );\",\"\t#else\",\"\t\tgl_PointSize = size;\",\"\t#endif\",\"\tgl_Position = projectionMatrix * mvPosition;\",THREE.ShaderChunk[\"logdepthbuf_vertex\"],THREE.ShaderChunk[\"worldpos_vertex\"],THREE.ShaderChunk[\"shadowmap_vertex\"],\"}\"].join(\"\\n\"),fragmentShader:[\"uniform vec3 psColor;\",\"uniform float opacity;\",THREE.ShaderChunk[\"common\"],THREE.ShaderChunk[\"color_pars_fragment\"],THREE.ShaderChunk[\"map_particle_pars_fragment\"],THREE.ShaderChunk[\"fog_pars_fragment\"],THREE.ShaderChunk[\"shadowmap_pars_fragment\"],THREE.ShaderChunk[\"logdepthbuf_pars_fragment\"],\"void main() {\",\"\tvec3 outgoingLight = vec3( 0.0 );\",\"\tvec4 diffuseColor = vec4( psColor, opacity );\",THREE.ShaderChunk[\"logdepthbuf_fragment\"],THREE.ShaderChunk[\"map_particle_fragment\"],THREE.ShaderChunk[\"color_fragment\"],THREE.ShaderChunk[\"alphatest_fragment\"],\"\toutgoingLight = diffuseColor.rgb;\", // simple shader\n\tTHREE.ShaderChunk[\"shadowmap_fragment\"],THREE.ShaderChunk[\"fog_fragment\"],\"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\",\"}\"].join(\"\\n\")},'dashed':{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib[\"common\"],THREE.UniformsLib[\"fog\"],{\"scale\":{type:\"f\",value:1},\"dashSize\":{type:\"f\",value:1},\"totalSize\":{type:\"f\",value:2}}]),vertexShader:[\"uniform float scale;\",\"attribute float lineDistance;\",\"varying float vLineDistance;\",THREE.ShaderChunk[\"common\"],THREE.ShaderChunk[\"color_pars_vertex\"],THREE.ShaderChunk[\"logdepthbuf_pars_vertex\"],\"void main() {\",THREE.ShaderChunk[\"color_vertex\"],\"\tvLineDistance = scale * lineDistance;\",\"\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\",\"\tgl_Position = projectionMatrix * mvPosition;\",THREE.ShaderChunk[\"logdepthbuf_vertex\"],\"}\"].join(\"\\n\"),fragmentShader:[\"uniform vec3 diffuse;\",\"uniform float opacity;\",\"uniform float dashSize;\",\"uniform float totalSize;\",\"varying float vLineDistance;\",THREE.ShaderChunk[\"common\"],THREE.ShaderChunk[\"color_pars_fragment\"],THREE.ShaderChunk[\"fog_pars_fragment\"],THREE.ShaderChunk[\"logdepthbuf_pars_fragment\"],\"void main() {\",\"\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\",\"\t\tdiscard;\",\"\t}\",\"\tvec3 outgoingLight = vec3( 0.0 );\",\"\tvec4 diffuseColor = vec4( diffuse, opacity );\",THREE.ShaderChunk[\"logdepthbuf_fragment\"],THREE.ShaderChunk[\"color_fragment\"],\"\toutgoingLight = diffuseColor.rgb;\", // simple shader\n\tTHREE.ShaderChunk[\"fog_fragment\"],\"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\",\"}\"].join(\"\\n\")},'depth':{uniforms:{\"mNear\":{type:\"f\",value:1.0},\"mFar\":{type:\"f\",value:2000.0},\"opacity\":{type:\"f\",value:1.0}},vertexShader:[THREE.ShaderChunk[\"common\"],THREE.ShaderChunk[\"morphtarget_pars_vertex\"],THREE.ShaderChunk[\"logdepthbuf_pars_vertex\"],\"void main() {\",THREE.ShaderChunk[\"begin_vertex\"],THREE.ShaderChunk[\"morphtarget_vertex\"],THREE.ShaderChunk[\"project_vertex\"],THREE.ShaderChunk[\"logdepthbuf_vertex\"],\"}\"].join(\"\\n\"),fragmentShader:[\"uniform float mNear;\",\"uniform float mFar;\",\"uniform float opacity;\",THREE.ShaderChunk[\"common\"],THREE.ShaderChunk[\"logdepthbuf_pars_fragment\"],\"void main() {\",THREE.ShaderChunk[\"logdepthbuf_fragment\"],\"\t#ifdef USE_LOGDEPTHBUF_EXT\",\"\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\",\"\t#else\",\"\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\",\"\t#endif\",\"\tfloat color = 1.0 - smoothstep( mNear, mFar, depth );\",\"\tgl_FragColor = vec4( vec3( color ), opacity );\",\"}\"].join(\"\\n\")},'normal':{uniforms:{\"opacity\":{type:\"f\",value:1.0}},vertexShader:[\"varying vec3 vNormal;\",THREE.ShaderChunk[\"common\"],THREE.ShaderChunk[\"morphtarget_pars_vertex\"],THREE.ShaderChunk[\"logdepthbuf_pars_vertex\"],\"void main() {\",\"\tvNormal = normalize( normalMatrix * normal );\",THREE.ShaderChunk[\"begin_vertex\"],THREE.ShaderChunk[\"morphtarget_vertex\"],THREE.ShaderChunk[\"project_vertex\"],THREE.ShaderChunk[\"logdepthbuf_vertex\"],\"}\"].join(\"\\n\"),fragmentShader:[\"uniform float opacity;\",\"varying vec3 vNormal;\",THREE.ShaderChunk[\"common\"],THREE.ShaderChunk[\"logdepthbuf_pars_fragment\"],\"void main() {\",\"\tgl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );\",THREE.ShaderChunk[\"logdepthbuf_fragment\"],\"}\"].join(\"\\n\")}, /* -------------------------------------------------------------------------\n\t\t//\tCube map shader\n\t\t ------------------------------------------------------------------------- */'cube':{uniforms:{\"tCube\":{type:\"t\",value:null},\"tFlip\":{type:\"f\",value:-1}},vertexShader:[\"varying vec3 vWorldPosition;\",THREE.ShaderChunk[\"common\"],THREE.ShaderChunk[\"logdepthbuf_pars_vertex\"],\"void main() {\",\"\tvWorldPosition = transformDirection( position, modelMatrix );\",\"\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",THREE.ShaderChunk[\"logdepthbuf_vertex\"],\"}\"].join(\"\\n\"),fragmentShader:[\"uniform samplerCube tCube;\",\"uniform float tFlip;\",\"varying vec3 vWorldPosition;\",THREE.ShaderChunk[\"common\"],THREE.ShaderChunk[\"logdepthbuf_pars_fragment\"],\"void main() {\",\"\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\",THREE.ShaderChunk[\"logdepthbuf_fragment\"],\"}\"].join(\"\\n\")}, /* -------------------------------------------------------------------------\n\t\t//\tCube map shader\n\t\t ------------------------------------------------------------------------- */'equirect':{uniforms:{\"tEquirect\":{type:\"t\",value:null},\"tFlip\":{type:\"f\",value:-1}},vertexShader:[\"varying vec3 vWorldPosition;\",THREE.ShaderChunk[\"common\"],THREE.ShaderChunk[\"logdepthbuf_pars_vertex\"],\"void main() {\",\"\tvWorldPosition = transformDirection( position, modelMatrix );\",\"\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",THREE.ShaderChunk[\"logdepthbuf_vertex\"],\"}\"].join(\"\\n\"),fragmentShader:[\"uniform sampler2D tEquirect;\",\"uniform float tFlip;\",\"varying vec3 vWorldPosition;\",THREE.ShaderChunk[\"common\"],THREE.ShaderChunk[\"logdepthbuf_pars_fragment\"],\"void main() {\", // \"\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\",\n\t\"vec3 direction = normalize( vWorldPosition );\",\"vec2 sampleUV;\",\"sampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );\",\"sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\",\"gl_FragColor = texture2D( tEquirect, sampleUV );\",THREE.ShaderChunk[\"logdepthbuf_fragment\"],\"}\"].join(\"\\n\")}, /* Depth encoding into RGBA texture\n\t\t *\n\t\t * based on SpiderGL shadow map example\n\t\t * http://spidergl.org/example.php?id=6\n\t\t *\n\t\t * originally from\n\t\t * http://www.gamedev.net/topic/442138-packing-a-float-into-a-a8r8g8b8-texture-shader/page__whichpage__1%25EF%25BF%25BD\n\t\t *\n\t\t * see also\n\t\t * http://aras-p.info/blog/2009/07/30/encoding-floats-to-rgba-the-final/\n\t\t */'depthRGBA':{uniforms:{},vertexShader:[THREE.ShaderChunk[\"common\"],THREE.ShaderChunk[\"morphtarget_pars_vertex\"],THREE.ShaderChunk[\"skinning_pars_vertex\"],THREE.ShaderChunk[\"logdepthbuf_pars_vertex\"],\"void main() {\",THREE.ShaderChunk[\"skinbase_vertex\"],THREE.ShaderChunk[\"begin_vertex\"],THREE.ShaderChunk[\"morphtarget_vertex\"],THREE.ShaderChunk[\"skinning_vertex\"],THREE.ShaderChunk[\"project_vertex\"],THREE.ShaderChunk[\"logdepthbuf_vertex\"],\"}\"].join(\"\\n\"),fragmentShader:[THREE.ShaderChunk[\"common\"],THREE.ShaderChunk[\"logdepthbuf_pars_fragment\"],\"vec4 pack_depth( const in float depth ) {\",\"\tconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\",\"\tconst vec4 bit_mask = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\",\"\tvec4 res = mod( depth * bit_shift * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );\", // \"\tvec4 res = fract( depth * bit_shift );\",\n\t\"\tres -= res.xxyz * bit_mask;\",\"\treturn res;\",\"}\",\"void main() {\",THREE.ShaderChunk[\"logdepthbuf_fragment\"],\"\t#ifdef USE_LOGDEPTHBUF_EXT\",\"\t\tgl_FragData[ 0 ] = pack_depth( gl_FragDepthEXT );\",\"\t#else\",\"\t\tgl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );\",\"\t#endif\", //\"gl_FragData[ 0 ] = pack_depth( gl_FragCoord.z / gl_FragCoord.w );\",\n\t//\"float z = ( ( gl_FragCoord.z / gl_FragCoord.w ) - 3.0 ) / ( 4000.0 - 3.0 );\",\n\t//\"gl_FragData[ 0 ] = pack_depth( z );\",\n\t//\"gl_FragData[ 0 ] = vec4( z, z, z, 1.0 );\",\n\t\"}\"].join(\"\\n\")}}; // File:src/renderers/WebGLRenderer.js\n\t/**\n\t * @author supereggbert / http://www.paulbrunt.co.uk/\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author szimek / https://github.com/szimek/\n\t */THREE.WebGLRenderer = function(parameters){console.log('THREE.WebGLRenderer',THREE.REVISION);parameters = parameters || {};var _canvas=parameters.canvas !== undefined?parameters.canvas:document.createElement('canvas'),_context=parameters.context !== undefined?parameters.context:null,_width=_canvas.width,_height=_canvas.height,pixelRatio=1,_alpha=parameters.alpha !== undefined?parameters.alpha:false,_depth=parameters.depth !== undefined?parameters.depth:true,_stencil=parameters.stencil !== undefined?parameters.stencil:true,_antialias=parameters.antialias !== undefined?parameters.antialias:false,_premultipliedAlpha=parameters.premultipliedAlpha !== undefined?parameters.premultipliedAlpha:true,_preserveDrawingBuffer=parameters.preserveDrawingBuffer !== undefined?parameters.preserveDrawingBuffer:false,_clearColor=new THREE.Color(0x000000),_clearAlpha=0;var lights=[];var opaqueObjects=[];var opaqueObjectsLastIndex=-1;var transparentObjects=[];var transparentObjectsLastIndex=-1;var opaqueImmediateObjects=[];var opaqueImmediateObjectsLastIndex=-1;var transparentImmediateObjects=[];var transparentImmediateObjectsLastIndex=-1;var morphInfluences=new Float32Array(8);var sprites=[];var lensFlares=[]; // public properties\n\tthis.domElement = _canvas;this.context = null; // clearing\n\tthis.autoClear = true;this.autoClearColor = true;this.autoClearDepth = true;this.autoClearStencil = true; // scene graph\n\tthis.sortObjects = true; // physically based shading\n\tthis.gammaFactor = 2.0; // for backwards compatibility\n\tthis.gammaInput = false;this.gammaOutput = false; // morphs\n\tthis.maxMorphTargets = 8;this.maxMorphNormals = 4; // flags\n\tthis.autoScaleCubemaps = true; // internal properties\n\tvar _this=this, // internal state cache\n\t_currentProgram=null,_currentFramebuffer=null,_currentMaterialId=-1,_currentGeometryProgram='',_currentCamera=null,_usedTextureUnits=0,_viewportX=0,_viewportY=0,_viewportWidth=_canvas.width,_viewportHeight=_canvas.height,_currentWidth=0,_currentHeight=0, // frustum\n\t_frustum=new THREE.Frustum(), // camera matrices cache\n\t_projScreenMatrix=new THREE.Matrix4(),_vector3=new THREE.Vector3(), // light arrays cache\n\t_direction=new THREE.Vector3(),_lightsNeedUpdate=true,_lights={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[],decays:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[],decays:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}}, // info\n\t_infoMemory={geometries:0,textures:0},_infoRender={calls:0,vertices:0,faces:0,points:0};this.info = {render:_infoRender,memory:_infoMemory,programs:null}; // initialize\n\tvar _gl;try{var attributes={alpha:_alpha,depth:_depth,stencil:_stencil,antialias:_antialias,premultipliedAlpha:_premultipliedAlpha,preserveDrawingBuffer:_preserveDrawingBuffer};_gl = _context || _canvas.getContext('webgl',attributes) || _canvas.getContext('experimental-webgl',attributes);if(_gl === null){if(_canvas.getContext('webgl') !== null){throw 'Error creating WebGL context with your selected attributes.';}else {throw 'Error creating WebGL context.';}}_canvas.addEventListener('webglcontextlost',onContextLost,false);}catch(error) {console.error('THREE.WebGLRenderer: ' + error);}var extensions=new THREE.WebGLExtensions(_gl);extensions.get('OES_texture_float');extensions.get('OES_texture_float_linear');extensions.get('OES_texture_half_float');extensions.get('OES_texture_half_float_linear');extensions.get('OES_standard_derivatives');extensions.get('ANGLE_instanced_arrays');if(extensions.get('OES_element_index_uint')){THREE.BufferGeometry.MaxIndex = 4294967296;}var capabilities=new THREE.WebGLCapabilities(_gl,extensions,parameters);var state=new THREE.WebGLState(_gl,extensions,paramThreeToGL);var properties=new THREE.WebGLProperties();var objects=new THREE.WebGLObjects(_gl,properties,this.info);var programCache=new THREE.WebGLPrograms(this,capabilities);this.info.programs = programCache.programs;var bufferRenderer=new THREE.WebGLBufferRenderer(_gl,extensions,_infoRender);var indexedBufferRenderer=new THREE.WebGLIndexedBufferRenderer(_gl,extensions,_infoRender); //\n\tfunction glClearColor(r,g,b,a){if(_premultipliedAlpha === true){r *= a;g *= a;b *= a;}_gl.clearColor(r,g,b,a);}function setDefaultGLState(){state.init();_gl.viewport(_viewportX,_viewportY,_viewportWidth,_viewportHeight);glClearColor(_clearColor.r,_clearColor.g,_clearColor.b,_clearAlpha);}function resetGLState(){_currentProgram = null;_currentCamera = null;_currentGeometryProgram = '';_currentMaterialId = -1;_lightsNeedUpdate = true;state.reset();}setDefaultGLState();this.context = _gl;this.capabilities = capabilities;this.extensions = extensions;this.state = state; // shadow map\n\tvar shadowMap=new THREE.WebGLShadowMap(this,lights,objects);this.shadowMap = shadowMap; // Plugins\n\tvar spritePlugin=new THREE.SpritePlugin(this,sprites);var lensFlarePlugin=new THREE.LensFlarePlugin(this,lensFlares); // API\n\tthis.getContext = function(){return _gl;};this.getContextAttributes = function(){return _gl.getContextAttributes();};this.forceContextLoss = function(){extensions.get('WEBGL_lose_context').loseContext();};this.getMaxAnisotropy = (function(){var value;return function getMaxAnisotropy(){if(value !== undefined)return value;var extension=extensions.get('EXT_texture_filter_anisotropic');if(extension !== null){value = _gl.getParameter(extension.MAX_TEXTURE_MAX_ANISOTROPY_EXT);}else {value = 0;}return value;};})();this.getPrecision = function(){return capabilities.precision;};this.getPixelRatio = function(){return pixelRatio;};this.setPixelRatio = function(value){if(value !== undefined)pixelRatio = value;};this.getSize = function(){return {width:_width,height:_height};};this.setSize = function(width,height,updateStyle){_width = width;_height = height;_canvas.width = width * pixelRatio;_canvas.height = height * pixelRatio;if(updateStyle !== false){_canvas.style.width = width + 'px';_canvas.style.height = height + 'px';}this.setViewport(0,0,width,height);};this.setViewport = function(x,y,width,height){_viewportX = x * pixelRatio;_viewportY = y * pixelRatio;_viewportWidth = width * pixelRatio;_viewportHeight = height * pixelRatio;_gl.viewport(_viewportX,_viewportY,_viewportWidth,_viewportHeight);};this.setScissor = function(x,y,width,height){_gl.scissor(x * pixelRatio,y * pixelRatio,width * pixelRatio,height * pixelRatio);};this.enableScissorTest = function(boolean){state.setScissorTest(boolean);}; // Clearing\n\tthis.getClearColor = function(){return _clearColor;};this.setClearColor = function(color,alpha){_clearColor.set(color);_clearAlpha = alpha !== undefined?alpha:1;glClearColor(_clearColor.r,_clearColor.g,_clearColor.b,_clearAlpha);};this.getClearAlpha = function(){return _clearAlpha;};this.setClearAlpha = function(alpha){_clearAlpha = alpha;glClearColor(_clearColor.r,_clearColor.g,_clearColor.b,_clearAlpha);};this.clear = function(color,depth,stencil){var bits=0;if(color === undefined || color)bits |= _gl.COLOR_BUFFER_BIT;if(depth === undefined || depth)bits |= _gl.DEPTH_BUFFER_BIT;if(stencil === undefined || stencil)bits |= _gl.STENCIL_BUFFER_BIT;_gl.clear(bits);};this.clearColor = function(){_gl.clear(_gl.COLOR_BUFFER_BIT);};this.clearDepth = function(){_gl.clear(_gl.DEPTH_BUFFER_BIT);};this.clearStencil = function(){_gl.clear(_gl.STENCIL_BUFFER_BIT);};this.clearTarget = function(renderTarget,color,depth,stencil){this.setRenderTarget(renderTarget);this.clear(color,depth,stencil);}; // Reset\n\tthis.resetGLState = resetGLState;this.dispose = function(){_canvas.removeEventListener('webglcontextlost',onContextLost,false);}; // Events\n\tfunction onContextLost(event){event.preventDefault();resetGLState();setDefaultGLState();properties.clear();};function onTextureDispose(event){var texture=event.target;texture.removeEventListener('dispose',onTextureDispose);deallocateTexture(texture);_infoMemory.textures--;}function onRenderTargetDispose(event){var renderTarget=event.target;renderTarget.removeEventListener('dispose',onRenderTargetDispose);deallocateRenderTarget(renderTarget);_infoMemory.textures--;}function onMaterialDispose(event){var material=event.target;material.removeEventListener('dispose',onMaterialDispose);deallocateMaterial(material);} // Buffer deallocation\n\tfunction deallocateTexture(texture){var textureProperties=properties.get(texture);if(texture.image && textureProperties.__image__webglTextureCube){ // cube texture\n\t_gl.deleteTexture(textureProperties.__image__webglTextureCube);}else { // 2D texture\n\tif(textureProperties.__webglInit === undefined)return;_gl.deleteTexture(textureProperties.__webglTexture);} // remove all webgl properties\n\tproperties['delete'](texture);}function deallocateRenderTarget(renderTarget){var renderTargetProperties=properties.get(renderTarget);if(!renderTarget || renderTargetProperties.__webglTexture === undefined)return;_gl.deleteTexture(renderTargetProperties.__webglTexture);if(renderTarget instanceof THREE.WebGLRenderTargetCube){for(var i=0;i < 6;i++) {_gl.deleteFramebuffer(renderTargetProperties.__webglFramebuffer[i]);_gl.deleteRenderbuffer(renderTargetProperties.__webglRenderbuffer[i]);}}else {_gl.deleteFramebuffer(renderTargetProperties.__webglFramebuffer);_gl.deleteRenderbuffer(renderTargetProperties.__webglRenderbuffer);}properties['delete'](renderTarget);}function deallocateMaterial(material){releaseMaterialProgramReference(material);properties['delete'](material);}function releaseMaterialProgramReference(material){var programInfo=properties.get(material).program;material.program = undefined;if(programInfo !== undefined){programCache.releaseProgram(programInfo);}} // Buffer rendering\n\tthis.renderBufferImmediate = function(object,program,material){state.initAttributes();var buffers=properties.get(object);if(object.hasPositions && !buffers.position)buffers.position = _gl.createBuffer();if(object.hasNormals && !buffers.normal)buffers.normal = _gl.createBuffer();if(object.hasUvs && !buffers.uv)buffers.uv = _gl.createBuffer();if(object.hasColors && !buffers.color)buffers.color = _gl.createBuffer();var attributes=program.getAttributes();if(object.hasPositions){_gl.bindBuffer(_gl.ARRAY_BUFFER,buffers.position);_gl.bufferData(_gl.ARRAY_BUFFER,object.positionArray,_gl.DYNAMIC_DRAW);state.enableAttribute(attributes.position);_gl.vertexAttribPointer(attributes.position,3,_gl.FLOAT,false,0,0);}if(object.hasNormals){_gl.bindBuffer(_gl.ARRAY_BUFFER,buffers.normal);if(material.type !== 'MeshPhongMaterial' && material.shading === THREE.FlatShading){for(var i=0,l=object.count * 3;i < l;i += 9) {var array=object.normalArray;var nx=(array[i + 0] + array[i + 3] + array[i + 6]) / 3;var ny=(array[i + 1] + array[i + 4] + array[i + 7]) / 3;var nz=(array[i + 2] + array[i + 5] + array[i + 8]) / 3;array[i + 0] = nx;array[i + 1] = ny;array[i + 2] = nz;array[i + 3] = nx;array[i + 4] = ny;array[i + 5] = nz;array[i + 6] = nx;array[i + 7] = ny;array[i + 8] = nz;}}_gl.bufferData(_gl.ARRAY_BUFFER,object.normalArray,_gl.DYNAMIC_DRAW);state.enableAttribute(attributes.normal);_gl.vertexAttribPointer(attributes.normal,3,_gl.FLOAT,false,0,0);}if(object.hasUvs && material.map){_gl.bindBuffer(_gl.ARRAY_BUFFER,buffers.uv);_gl.bufferData(_gl.ARRAY_BUFFER,object.uvArray,_gl.DYNAMIC_DRAW);state.enableAttribute(attributes.uv);_gl.vertexAttribPointer(attributes.uv,2,_gl.FLOAT,false,0,0);}if(object.hasColors && material.vertexColors !== THREE.NoColors){_gl.bindBuffer(_gl.ARRAY_BUFFER,buffers.color);_gl.bufferData(_gl.ARRAY_BUFFER,object.colorArray,_gl.DYNAMIC_DRAW);state.enableAttribute(attributes.color);_gl.vertexAttribPointer(attributes.color,3,_gl.FLOAT,false,0,0);}state.disableUnusedAttributes();_gl.drawArrays(_gl.TRIANGLES,0,object.count);object.count = 0;};this.renderBufferDirect = function(camera,lights,fog,geometry,material,object,group){setMaterial(material);var program=setProgram(camera,lights,fog,material,object);var updateBuffers=false;var geometryProgram=geometry.id + '_' + program.id + '_' + material.wireframe;if(geometryProgram !== _currentGeometryProgram){_currentGeometryProgram = geometryProgram;updateBuffers = true;} // morph targets\n\tvar morphTargetInfluences=object.morphTargetInfluences;if(morphTargetInfluences !== undefined){var activeInfluences=[];for(var i=0,l=morphTargetInfluences.length;i < l;i++) {var influence=morphTargetInfluences[i];activeInfluences.push([influence,i]);}activeInfluences.sort(numericalSort);if(activeInfluences.length > 8){activeInfluences.length = 8;}var morphAttributes=geometry.morphAttributes;for(var i=0,l=activeInfluences.length;i < l;i++) {var influence=activeInfluences[i];morphInfluences[i] = influence[0];if(influence[0] !== 0){var index=influence[1];if(material.morphTargets === true && morphAttributes.position)geometry.addAttribute('morphTarget' + i,morphAttributes.position[index]);if(material.morphNormals === true && morphAttributes.normal)geometry.addAttribute('morphNormal' + i,morphAttributes.normal[index]);}else {if(material.morphTargets === true)geometry.removeAttribute('morphTarget' + i);if(material.morphNormals === true)geometry.removeAttribute('morphNormal' + i);}}var uniforms=program.getUniforms();if(uniforms.morphTargetInfluences !== null){_gl.uniform1fv(uniforms.morphTargetInfluences,morphInfluences);}updateBuffers = true;} //\n\tvar index=geometry.index;var position=geometry.attributes.position;if(material.wireframe === true){index = objects.getWireframeAttribute(geometry);}var renderer;if(index !== null){renderer = indexedBufferRenderer;renderer.setIndex(index);}else {renderer = bufferRenderer;}if(updateBuffers){setupVertexAttributes(material,program,geometry);if(index !== null){_gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER,objects.getAttributeBuffer(index));}}if(group === undefined){var count;if(index !== null){count = index.count;}else if(position instanceof THREE.InterleavedBufferAttribute){count = position.data.array.length / 3;}else {count = position.count;}var drawRange=geometry.drawRange;group = {start:drawRange.start,count:Math.min(drawRange.count,count)};}if(object instanceof THREE.Mesh){if(material.wireframe === true){state.setLineWidth(material.wireframeLinewidth * pixelRatio);renderer.setMode(_gl.LINES);}else {renderer.setMode(_gl.TRIANGLES);}if(geometry instanceof THREE.InstancedBufferGeometry && geometry.maxInstancedCount > 0){renderer.renderInstances(geometry);}else {renderer.render(group.start,group.count);}}else if(object instanceof THREE.Line){var lineWidth=material.linewidth;if(lineWidth === undefined)lineWidth = 1; // Not using Line*Material\n\tstate.setLineWidth(lineWidth * pixelRatio);if(object instanceof THREE.LineSegments){renderer.setMode(_gl.LINES);}else {renderer.setMode(_gl.LINE_STRIP);}renderer.render(group.start,group.count);}else if(object instanceof THREE.Points){renderer.setMode(_gl.POINTS);renderer.render(group.start,group.count);}};function setupVertexAttributes(material,program,geometry,startIndex){var extension;if(geometry instanceof THREE.InstancedBufferGeometry){extension = extensions.get('ANGLE_instanced_arrays');if(extension === null){console.error('THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.');return;}}if(startIndex === undefined)startIndex = 0;state.initAttributes();var geometryAttributes=geometry.attributes;var programAttributes=program.getAttributes();var materialDefaultAttributeValues=material.defaultAttributeValues;for(var name in programAttributes) {var programAttribute=programAttributes[name];if(programAttribute >= 0){var geometryAttribute=geometryAttributes[name];if(geometryAttribute !== undefined){state.enableAttribute(programAttribute);var size=geometryAttribute.itemSize;var buffer=objects.getAttributeBuffer(geometryAttribute);if(geometryAttribute instanceof THREE.InterleavedBufferAttribute){var data=geometryAttribute.data;var stride=data.stride;var offset=geometryAttribute.offset;_gl.bindBuffer(_gl.ARRAY_BUFFER,buffer);_gl.vertexAttribPointer(programAttribute,size,_gl.FLOAT,false,stride * data.array.BYTES_PER_ELEMENT,(startIndex * stride + offset) * data.array.BYTES_PER_ELEMENT);if(data instanceof THREE.InstancedInterleavedBuffer){if(extension === null){console.error('THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferAttribute but hardware does not support extension ANGLE_instanced_arrays.');return;}extension.vertexAttribDivisorANGLE(programAttribute,data.meshPerAttribute);if(geometry.maxInstancedCount === undefined){geometry.maxInstancedCount = data.meshPerAttribute * data.count;}}}else {_gl.bindBuffer(_gl.ARRAY_BUFFER,buffer);_gl.vertexAttribPointer(programAttribute,size,_gl.FLOAT,false,0,startIndex * size * 4); // 4 bytes per Float32\n\tif(geometryAttribute instanceof THREE.InstancedBufferAttribute){if(extension === null){console.error('THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferAttribute but hardware does not support extension ANGLE_instanced_arrays.');return;}extension.vertexAttribDivisorANGLE(programAttribute,geometryAttribute.meshPerAttribute);if(geometry.maxInstancedCount === undefined){geometry.maxInstancedCount = geometryAttribute.meshPerAttribute * geometryAttribute.count;}}}}else if(materialDefaultAttributeValues !== undefined){var value=materialDefaultAttributeValues[name];if(value !== undefined){switch(value.length){case 2:_gl.vertexAttrib2fv(programAttribute,value);break;case 3:_gl.vertexAttrib3fv(programAttribute,value);break;case 4:_gl.vertexAttrib4fv(programAttribute,value);break;default:_gl.vertexAttrib1fv(programAttribute,value);}}}}}state.disableUnusedAttributes();} // Sorting\n\tfunction numericalSort(a,b){return b[0] - a[0];}function painterSortStable(a,b){if(a.object.renderOrder !== b.object.renderOrder){return a.object.renderOrder - b.object.renderOrder;}else if(a.material.id !== b.material.id){return a.material.id - b.material.id;}else if(a.z !== b.z){return a.z - b.z;}else {return a.id - b.id;}}function reversePainterSortStable(a,b){if(a.object.renderOrder !== b.object.renderOrder){return a.object.renderOrder - b.object.renderOrder;}if(a.z !== b.z){return b.z - a.z;}else {return a.id - b.id;}} // Rendering\n\tthis.render = function(scene,camera,renderTarget,forceClear){if(camera instanceof THREE.Camera === false){console.error('THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.');return;}var fog=scene.fog; // reset caching for this frame\n\t_currentGeometryProgram = '';_currentMaterialId = -1;_currentCamera = null;_lightsNeedUpdate = true; // update scene graph\n\tif(scene.autoUpdate === true)scene.updateMatrixWorld(); // update camera matrices and frustum\n\tif(camera.parent === null)camera.updateMatrixWorld();camera.matrixWorldInverse.getInverse(camera.matrixWorld);_projScreenMatrix.multiplyMatrices(camera.projectionMatrix,camera.matrixWorldInverse);_frustum.setFromMatrix(_projScreenMatrix);lights.length = 0;opaqueObjectsLastIndex = -1;transparentObjectsLastIndex = -1;opaqueImmediateObjectsLastIndex = -1;transparentImmediateObjectsLastIndex = -1;sprites.length = 0;lensFlares.length = 0;projectObject(scene);opaqueObjects.length = opaqueObjectsLastIndex + 1;transparentObjects.length = transparentObjectsLastIndex + 1;opaqueImmediateObjects.length = opaqueImmediateObjectsLastIndex + 1;transparentImmediateObjects.length = transparentImmediateObjectsLastIndex + 1;if(_this.sortObjects === true){opaqueObjects.sort(painterSortStable);transparentObjects.sort(reversePainterSortStable);} //\n\tshadowMap.render(scene,camera); //\n\t_infoRender.calls = 0;_infoRender.vertices = 0;_infoRender.faces = 0;_infoRender.points = 0;this.setRenderTarget(renderTarget);if(this.autoClear || forceClear){this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil);} //\n\tif(scene.overrideMaterial){var overrideMaterial=scene.overrideMaterial;renderObjects(opaqueObjects,camera,lights,fog,overrideMaterial);renderObjects(transparentObjects,camera,lights,fog,overrideMaterial);renderObjectsImmediate(opaqueImmediateObjects,camera,lights,fog,overrideMaterial);renderObjectsImmediate(transparentImmediateObjects,camera,lights,fog,overrideMaterial);}else { // opaque pass (front-to-back order)\n\tstate.setBlending(THREE.NoBlending);renderObjects(opaqueObjects,camera,lights,fog);renderObjectsImmediate(opaqueImmediateObjects,camera,lights,fog); // transparent pass (back-to-front order)\n\trenderObjects(transparentObjects,camera,lights,fog);renderObjectsImmediate(transparentImmediateObjects,camera,lights,fog);} // custom render plugins (post pass)\n\tspritePlugin.render(scene,camera);lensFlarePlugin.render(scene,camera,_currentWidth,_currentHeight); // Generate mipmap if we're using any kind of mipmap filtering\n\tif(renderTarget && renderTarget.generateMipmaps && renderTarget.minFilter !== THREE.NearestFilter && renderTarget.minFilter !== THREE.LinearFilter){updateRenderTargetMipmap(renderTarget);} // Ensure depth buffer writing is enabled so it can be cleared on next render\n\tstate.setDepthTest(true);state.setDepthWrite(true);state.setColorWrite(true); // _gl.finish();\n\t};function pushImmediateRenderItem(object){var array,index; // allocate the next position in the appropriate array\n\tif(object.material.transparent){array = transparentImmediateObjects;index = ++transparentImmediateObjectsLastIndex;}else {array = opaqueImmediateObjects;index = ++opaqueImmediateObjectsLastIndex;} // recycle existing position or grow the array\n\tif(index < array.length){array[index] = object;}else { // assert( index === array.length );\n\tarray.push(object);}}function pushRenderItem(object,geometry,material,z,group){var array,index; // allocate the next position in the appropriate array\n\tif(material.transparent){array = transparentObjects;index = ++transparentObjectsLastIndex;}else {array = opaqueObjects;index = ++opaqueObjectsLastIndex;} // recycle existing render item or grow the array\n\tvar renderItem=array[index];if(renderItem !== undefined){renderItem.id = object.id;renderItem.object = object;renderItem.geometry = geometry;renderItem.material = material;renderItem.z = _vector3.z;renderItem.group = group;}else {renderItem = {id:object.id,object:object,geometry:geometry,material:material,z:_vector3.z,group:group}; // assert( index === array.length );\n\tarray.push(renderItem);}}function projectObject(object){if(object.visible === false)return;if(object instanceof THREE.Light){lights.push(object);}else if(object instanceof THREE.Sprite){sprites.push(object);}else if(object instanceof THREE.LensFlare){lensFlares.push(object);}else if(object instanceof THREE.ImmediateRenderObject){pushImmediateRenderItem(object);}else if(object instanceof THREE.Mesh || object instanceof THREE.Line || object instanceof THREE.Points){if(object instanceof THREE.SkinnedMesh){object.skeleton.update();}if(object.frustumCulled === false || _frustum.intersectsObject(object) === true){var material=object.material;if(material.visible === true){if(_this.sortObjects === true){_vector3.setFromMatrixPosition(object.matrixWorld);_vector3.applyProjection(_projScreenMatrix);}var geometry=objects.update(object);if(material instanceof THREE.MeshFaceMaterial){var groups=geometry.groups;var materials=material.materials;for(var i=0,l=groups.length;i < l;i++) {var group=groups[i];var groupMaterial=materials[group.materialIndex];if(groupMaterial.visible === true){pushRenderItem(object,geometry,groupMaterial,_vector3.z,group);}}}else {pushRenderItem(object,geometry,material,_vector3.z);}}}}var children=object.children;for(var i=0,l=children.length;i < l;i++) {projectObject(children[i]);}}function renderObjects(renderList,camera,lights,fog,overrideMaterial){for(var i=0,l=renderList.length;i < l;i++) {var renderItem=renderList[i];var object=renderItem.object;var geometry=renderItem.geometry;var material=overrideMaterial === undefined?renderItem.material:overrideMaterial;var group=renderItem.group;object.modelViewMatrix.multiplyMatrices(camera.matrixWorldInverse,object.matrixWorld);object.normalMatrix.getNormalMatrix(object.modelViewMatrix);_this.renderBufferDirect(camera,lights,fog,geometry,material,object,group);}}function renderObjectsImmediate(renderList,camera,lights,fog,overrideMaterial){var material=overrideMaterial;for(var i=0,l=renderList.length;i < l;i++) {var object=renderList[i];object.modelViewMatrix.multiplyMatrices(camera.matrixWorldInverse,object.matrixWorld);object.normalMatrix.getNormalMatrix(object.modelViewMatrix);if(overrideMaterial === undefined)material = object.material;setMaterial(material);var program=setProgram(camera,lights,fog,material,object);_currentGeometryProgram = '';object.render(function(object){_this.renderBufferImmediate(object,program,material);});}}function initMaterial(material,lights,fog,object){var materialProperties=properties.get(material);var parameters=programCache.getParameters(material,lights,fog,object);var code=programCache.getProgramCode(material,parameters);var program=materialProperties.program;var programChange=true;if(program === undefined){ // new material\n\tmaterial.addEventListener('dispose',onMaterialDispose);}else if(program.code !== code){ // changed glsl or parameters\n\treleaseMaterialProgramReference(material);}else if(parameters.shaderID !== undefined){ // same glsl and uniform list\n\treturn;}else { // only rebuild uniform list\n\tprogramChange = false;}if(programChange){if(parameters.shaderID){var shader=THREE.ShaderLib[parameters.shaderID];materialProperties.__webglShader = {name:material.type,uniforms:THREE.UniformsUtils.clone(shader.uniforms),vertexShader:shader.vertexShader,fragmentShader:shader.fragmentShader};}else {materialProperties.__webglShader = {name:material.type,uniforms:material.uniforms,vertexShader:material.vertexShader,fragmentShader:material.fragmentShader};}material.__webglShader = materialProperties.__webglShader;program = programCache.acquireProgram(material,parameters,code);materialProperties.program = program;material.program = program;}var attributes=program.getAttributes();if(material.morphTargets){material.numSupportedMorphTargets = 0;for(var i=0;i < _this.maxMorphTargets;i++) {if(attributes['morphTarget' + i] >= 0){material.numSupportedMorphTargets++;}}}if(material.morphNormals){material.numSupportedMorphNormals = 0;for(i = 0;i < _this.maxMorphNormals;i++) {if(attributes['morphNormal' + i] >= 0){material.numSupportedMorphNormals++;}}}materialProperties.uniformsList = [];var uniformLocations=materialProperties.program.getUniforms();for(var u in materialProperties.__webglShader.uniforms) {var location=uniformLocations[u];if(location){materialProperties.uniformsList.push([materialProperties.__webglShader.uniforms[u],location]);}}}function setMaterial(material){setMaterialFaces(material);if(material.transparent === true){state.setBlending(material.blending,material.blendEquation,material.blendSrc,material.blendDst,material.blendEquationAlpha,material.blendSrcAlpha,material.blendDstAlpha);}else {state.setBlending(THREE.NoBlending);}state.setDepthFunc(material.depthFunc);state.setDepthTest(material.depthTest);state.setDepthWrite(material.depthWrite);state.setColorWrite(material.colorWrite);state.setPolygonOffset(material.polygonOffset,material.polygonOffsetFactor,material.polygonOffsetUnits);}function setMaterialFaces(material){material.side !== THREE.DoubleSide?state.enable(_gl.CULL_FACE):state.disable(_gl.CULL_FACE);state.setFlipSided(material.side === THREE.BackSide);}function setProgram(camera,lights,fog,material,object){_usedTextureUnits = 0;var materialProperties=properties.get(material);if(material.needsUpdate || !materialProperties.program){initMaterial(material,lights,fog,object);material.needsUpdate = false;}var refreshProgram=false;var refreshMaterial=false;var refreshLights=false;var program=materialProperties.program,p_uniforms=program.getUniforms(),m_uniforms=materialProperties.__webglShader.uniforms;if(program.id !== _currentProgram){_gl.useProgram(program.program);_currentProgram = program.id;refreshProgram = true;refreshMaterial = true;refreshLights = true;}if(material.id !== _currentMaterialId){if(_currentMaterialId === -1)refreshLights = true;_currentMaterialId = material.id;refreshMaterial = true;}if(refreshProgram || camera !== _currentCamera){_gl.uniformMatrix4fv(p_uniforms.projectionMatrix,false,camera.projectionMatrix.elements);if(capabilities.logarithmicDepthBuffer){_gl.uniform1f(p_uniforms.logDepthBufFC,2.0 / (Math.log(camera.far + 1.0) / Math.LN2));}if(camera !== _currentCamera)_currentCamera = camera; // load material specific uniforms\n\t// (shader material also gets them for the sake of genericity)\n\tif(material instanceof THREE.ShaderMaterial || material instanceof THREE.MeshPhongMaterial || material.envMap){if(p_uniforms.cameraPosition !== undefined){_vector3.setFromMatrixPosition(camera.matrixWorld);_gl.uniform3f(p_uniforms.cameraPosition,_vector3.x,_vector3.y,_vector3.z);}}if(material instanceof THREE.MeshPhongMaterial || material instanceof THREE.MeshLambertMaterial || material instanceof THREE.MeshBasicMaterial || material instanceof THREE.ShaderMaterial || material.skinning){if(p_uniforms.viewMatrix !== undefined){_gl.uniformMatrix4fv(p_uniforms.viewMatrix,false,camera.matrixWorldInverse.elements);}}} // skinning uniforms must be set even if material didn't change\n\t// auto-setting of texture unit for bone texture must go before other textures\n\t// not sure why, but otherwise weird things happen\n\tif(material.skinning){if(object.bindMatrix && p_uniforms.bindMatrix !== undefined){_gl.uniformMatrix4fv(p_uniforms.bindMatrix,false,object.bindMatrix.elements);}if(object.bindMatrixInverse && p_uniforms.bindMatrixInverse !== undefined){_gl.uniformMatrix4fv(p_uniforms.bindMatrixInverse,false,object.bindMatrixInverse.elements);}if(capabilities.floatVertexTextures && object.skeleton && object.skeleton.useVertexTexture){if(p_uniforms.boneTexture !== undefined){var textureUnit=getTextureUnit();_gl.uniform1i(p_uniforms.boneTexture,textureUnit);_this.setTexture(object.skeleton.boneTexture,textureUnit);}if(p_uniforms.boneTextureWidth !== undefined){_gl.uniform1i(p_uniforms.boneTextureWidth,object.skeleton.boneTextureWidth);}if(p_uniforms.boneTextureHeight !== undefined){_gl.uniform1i(p_uniforms.boneTextureHeight,object.skeleton.boneTextureHeight);}}else if(object.skeleton && object.skeleton.boneMatrices){if(p_uniforms.boneGlobalMatrices !== undefined){_gl.uniformMatrix4fv(p_uniforms.boneGlobalMatrices,false,object.skeleton.boneMatrices);}}}if(refreshMaterial){ // refresh uniforms common to several materials\n\tif(fog && material.fog){refreshUniformsFog(m_uniforms,fog);}if(material instanceof THREE.MeshPhongMaterial || material instanceof THREE.MeshLambertMaterial || material.lights){if(_lightsNeedUpdate){refreshLights = true;setupLights(lights,camera);_lightsNeedUpdate = false;}if(refreshLights){refreshUniformsLights(m_uniforms,_lights);markUniformsLightsNeedsUpdate(m_uniforms,true);}else {markUniformsLightsNeedsUpdate(m_uniforms,false);}}if(material instanceof THREE.MeshBasicMaterial || material instanceof THREE.MeshLambertMaterial || material instanceof THREE.MeshPhongMaterial){refreshUniformsCommon(m_uniforms,material);} // refresh single material specific uniforms\n\tif(material instanceof THREE.LineBasicMaterial){refreshUniformsLine(m_uniforms,material);}else if(material instanceof THREE.LineDashedMaterial){refreshUniformsLine(m_uniforms,material);refreshUniformsDash(m_uniforms,material);}else if(material instanceof THREE.PointsMaterial){refreshUniformsParticle(m_uniforms,material);}else if(material instanceof THREE.MeshPhongMaterial){refreshUniformsPhong(m_uniforms,material);}else if(material instanceof THREE.MeshDepthMaterial){m_uniforms.mNear.value = camera.near;m_uniforms.mFar.value = camera.far;m_uniforms.opacity.value = material.opacity;}else if(material instanceof THREE.MeshNormalMaterial){m_uniforms.opacity.value = material.opacity;}if(object.receiveShadow && !material._shadowPass){refreshUniformsShadow(m_uniforms,lights);} // load common uniforms\n\tloadUniformsGeneric(materialProperties.uniformsList);}loadUniformsMatrices(p_uniforms,object);if(p_uniforms.modelMatrix !== undefined){_gl.uniformMatrix4fv(p_uniforms.modelMatrix,false,object.matrixWorld.elements);}return program;} // Uniforms (refresh uniforms objects)\n\tfunction refreshUniformsCommon(uniforms,material){uniforms.opacity.value = material.opacity;uniforms.diffuse.value = material.color;if(material.emissive){uniforms.emissive.value = material.emissive;}uniforms.map.value = material.map;uniforms.specularMap.value = material.specularMap;uniforms.alphaMap.value = material.alphaMap;if(material.aoMap){uniforms.aoMap.value = material.aoMap;uniforms.aoMapIntensity.value = material.aoMapIntensity;} // uv repeat and offset setting priorities\n\t// 1. color map\n\t// 2. specular map\n\t// 3. normal map\n\t// 4. bump map\n\t// 5. alpha map\n\t// 6. emissive map\n\tvar uvScaleMap;if(material.map){uvScaleMap = material.map;}else if(material.specularMap){uvScaleMap = material.specularMap;}else if(material.displacementMap){uvScaleMap = material.displacementMap;}else if(material.normalMap){uvScaleMap = material.normalMap;}else if(material.bumpMap){uvScaleMap = material.bumpMap;}else if(material.alphaMap){uvScaleMap = material.alphaMap;}else if(material.emissiveMap){uvScaleMap = material.emissiveMap;}if(uvScaleMap !== undefined){var offset=uvScaleMap.offset;var repeat=uvScaleMap.repeat;uniforms.offsetRepeat.value.set(offset.x,offset.y,repeat.x,repeat.y);}uniforms.envMap.value = material.envMap;uniforms.flipEnvMap.value = material.envMap instanceof THREE.WebGLRenderTargetCube?1:-1;uniforms.reflectivity.value = material.reflectivity;uniforms.refractionRatio.value = material.refractionRatio;}function refreshUniformsLine(uniforms,material){uniforms.diffuse.value = material.color;uniforms.opacity.value = material.opacity;}function refreshUniformsDash(uniforms,material){uniforms.dashSize.value = material.dashSize;uniforms.totalSize.value = material.dashSize + material.gapSize;uniforms.scale.value = material.scale;}function refreshUniformsParticle(uniforms,material){uniforms.psColor.value = material.color;uniforms.opacity.value = material.opacity;uniforms.size.value = material.size;uniforms.scale.value = _canvas.height / 2.0; // TODO: Cache this.\n\tuniforms.map.value = material.map;if(material.map !== null){var offset=material.map.offset;var repeat=material.map.repeat;uniforms.offsetRepeat.value.set(offset.x,offset.y,repeat.x,repeat.y);}}function refreshUniformsFog(uniforms,fog){uniforms.fogColor.value = fog.color;if(fog instanceof THREE.Fog){uniforms.fogNear.value = fog.near;uniforms.fogFar.value = fog.far;}else if(fog instanceof THREE.FogExp2){uniforms.fogDensity.value = fog.density;}}function refreshUniformsPhong(uniforms,material){uniforms.specular.value = material.specular;uniforms.shininess.value = material.shininess;if(material.lightMap){uniforms.lightMap.value = material.lightMap;uniforms.lightMapIntensity.value = material.lightMapIntensity;}if(material.emissiveMap){uniforms.emissiveMap.value = material.emissiveMap;}if(material.bumpMap){uniforms.bumpMap.value = material.bumpMap;uniforms.bumpScale.value = material.bumpScale;}if(material.normalMap){uniforms.normalMap.value = material.normalMap;uniforms.normalScale.value.copy(material.normalScale);}if(material.displacementMap){uniforms.displacementMap.value = material.displacementMap;uniforms.displacementScale.value = material.displacementScale;uniforms.displacementBias.value = material.displacementBias;}}function refreshUniformsLights(uniforms,lights){uniforms.ambientLightColor.value = lights.ambient;uniforms.directionalLightColor.value = lights.directional.colors;uniforms.directionalLightDirection.value = lights.directional.positions;uniforms.pointLightColor.value = lights.point.colors;uniforms.pointLightPosition.value = lights.point.positions;uniforms.pointLightDistance.value = lights.point.distances;uniforms.pointLightDecay.value = lights.point.decays;uniforms.spotLightColor.value = lights.spot.colors;uniforms.spotLightPosition.value = lights.spot.positions;uniforms.spotLightDistance.value = lights.spot.distances;uniforms.spotLightDirection.value = lights.spot.directions;uniforms.spotLightAngleCos.value = lights.spot.anglesCos;uniforms.spotLightExponent.value = lights.spot.exponents;uniforms.spotLightDecay.value = lights.spot.decays;uniforms.hemisphereLightSkyColor.value = lights.hemi.skyColors;uniforms.hemisphereLightGroundColor.value = lights.hemi.groundColors;uniforms.hemisphereLightDirection.value = lights.hemi.positions;} // If uniforms are marked as clean, they don't need to be loaded to the GPU.\n\tfunction markUniformsLightsNeedsUpdate(uniforms,value){uniforms.ambientLightColor.needsUpdate = value;uniforms.directionalLightColor.needsUpdate = value;uniforms.directionalLightDirection.needsUpdate = value;uniforms.pointLightColor.needsUpdate = value;uniforms.pointLightPosition.needsUpdate = value;uniforms.pointLightDistance.needsUpdate = value;uniforms.pointLightDecay.needsUpdate = value;uniforms.spotLightColor.needsUpdate = value;uniforms.spotLightPosition.needsUpdate = value;uniforms.spotLightDistance.needsUpdate = value;uniforms.spotLightDirection.needsUpdate = value;uniforms.spotLightAngleCos.needsUpdate = value;uniforms.spotLightExponent.needsUpdate = value;uniforms.spotLightDecay.needsUpdate = value;uniforms.hemisphereLightSkyColor.needsUpdate = value;uniforms.hemisphereLightGroundColor.needsUpdate = value;uniforms.hemisphereLightDirection.needsUpdate = value;}function refreshUniformsShadow(uniforms,lights){if(uniforms.shadowMatrix){var j=0;for(var i=0,il=lights.length;i < il;i++) {var light=lights[i];if(!light.castShadow)continue;if(light instanceof THREE.SpotLight || light instanceof THREE.DirectionalLight){uniforms.shadowMap.value[j] = light.shadowMap;uniforms.shadowMapSize.value[j] = light.shadowMapSize;uniforms.shadowMatrix.value[j] = light.shadowMatrix;uniforms.shadowDarkness.value[j] = light.shadowDarkness;uniforms.shadowBias.value[j] = light.shadowBias;j++;}}}} // Uniforms (load to GPU)\n\tfunction loadUniformsMatrices(uniforms,object){_gl.uniformMatrix4fv(uniforms.modelViewMatrix,false,object.modelViewMatrix.elements);if(uniforms.normalMatrix){_gl.uniformMatrix3fv(uniforms.normalMatrix,false,object.normalMatrix.elements);}}function getTextureUnit(){var textureUnit=_usedTextureUnits;if(textureUnit >= capabilities.maxTextures){console.warn('WebGLRenderer: trying to use ' + textureUnit + ' texture units while this GPU supports only ' + capabilities.maxTextures);}_usedTextureUnits += 1;return textureUnit;}function loadUniformsGeneric(uniforms){var texture,textureUnit;for(var j=0,jl=uniforms.length;j < jl;j++) {var uniform=uniforms[j][0]; // needsUpdate property is not added to all uniforms.\n\tif(uniform.needsUpdate === false)continue;var type=uniform.type;var value=uniform.value;var location=uniforms[j][1];switch(type){case '1i':_gl.uniform1i(location,value);break;case '1f':_gl.uniform1f(location,value);break;case '2f':_gl.uniform2f(location,value[0],value[1]);break;case '3f':_gl.uniform3f(location,value[0],value[1],value[2]);break;case '4f':_gl.uniform4f(location,value[0],value[1],value[2],value[3]);break;case '1iv':_gl.uniform1iv(location,value);break;case '3iv':_gl.uniform3iv(location,value);break;case '1fv':_gl.uniform1fv(location,value);break;case '2fv':_gl.uniform2fv(location,value);break;case '3fv':_gl.uniform3fv(location,value);break;case '4fv':_gl.uniform4fv(location,value);break;case 'Matrix3fv':_gl.uniformMatrix3fv(location,false,value);break;case 'Matrix4fv':_gl.uniformMatrix4fv(location,false,value);break; //\n\tcase 'i': // single integer\n\t_gl.uniform1i(location,value);break;case 'f': // single float\n\t_gl.uniform1f(location,value);break;case 'v2': // single THREE.Vector2\n\t_gl.uniform2f(location,value.x,value.y);break;case 'v3': // single THREE.Vector3\n\t_gl.uniform3f(location,value.x,value.y,value.z);break;case 'v4': // single THREE.Vector4\n\t_gl.uniform4f(location,value.x,value.y,value.z,value.w);break;case 'c': // single THREE.Color\n\t_gl.uniform3f(location,value.r,value.g,value.b);break;case 'iv1': // flat array of integers (JS or typed array)\n\t_gl.uniform1iv(location,value);break;case 'iv': // flat array of integers with 3 x N size (JS or typed array)\n\t_gl.uniform3iv(location,value);break;case 'fv1': // flat array of floats (JS or typed array)\n\t_gl.uniform1fv(location,value);break;case 'fv': // flat array of floats with 3 x N size (JS or typed array)\n\t_gl.uniform3fv(location,value);break;case 'v2v': // array of THREE.Vector2\n\tif(uniform._array === undefined){uniform._array = new Float32Array(2 * value.length);}for(var i=0,i2=0,il=value.length;i < il;i++,i2 += 2) {uniform._array[i2 + 0] = value[i].x;uniform._array[i2 + 1] = value[i].y;}_gl.uniform2fv(location,uniform._array);break;case 'v3v': // array of THREE.Vector3\n\tif(uniform._array === undefined){uniform._array = new Float32Array(3 * value.length);}for(var i=0,i3=0,il=value.length;i < il;i++,i3 += 3) {uniform._array[i3 + 0] = value[i].x;uniform._array[i3 + 1] = value[i].y;uniform._array[i3 + 2] = value[i].z;}_gl.uniform3fv(location,uniform._array);break;case 'v4v': // array of THREE.Vector4\n\tif(uniform._array === undefined){uniform._array = new Float32Array(4 * value.length);}for(var i=0,i4=0,il=value.length;i < il;i++,i4 += 4) {uniform._array[i4 + 0] = value[i].x;uniform._array[i4 + 1] = value[i].y;uniform._array[i4 + 2] = value[i].z;uniform._array[i4 + 3] = value[i].w;}_gl.uniform4fv(location,uniform._array);break;case 'm3': // single THREE.Matrix3\n\t_gl.uniformMatrix3fv(location,false,value.elements);break;case 'm3v': // array of THREE.Matrix3\n\tif(uniform._array === undefined){uniform._array = new Float32Array(9 * value.length);}for(var i=0,il=value.length;i < il;i++) {value[i].flattenToArrayOffset(uniform._array,i * 9);}_gl.uniformMatrix3fv(location,false,uniform._array);break;case 'm4': // single THREE.Matrix4\n\t_gl.uniformMatrix4fv(location,false,value.elements);break;case 'm4v': // array of THREE.Matrix4\n\tif(uniform._array === undefined){uniform._array = new Float32Array(16 * value.length);}for(var i=0,il=value.length;i < il;i++) {value[i].flattenToArrayOffset(uniform._array,i * 16);}_gl.uniformMatrix4fv(location,false,uniform._array);break;case 't': // single THREE.Texture (2d or cube)\n\ttexture = value;textureUnit = getTextureUnit();_gl.uniform1i(location,textureUnit);if(!texture)continue;if(texture instanceof THREE.CubeTexture || Array.isArray(texture.image) && texture.image.length === 6){ // CompressedTexture can have Array in image :/\n\tsetCubeTexture(texture,textureUnit);}else if(texture instanceof THREE.WebGLRenderTargetCube){setCubeTextureDynamic(texture,textureUnit);}else {_this.setTexture(texture,textureUnit);}break;case 'tv': // array of THREE.Texture (2d)\n\tif(uniform._array === undefined){uniform._array = [];}for(var i=0,il=uniform.value.length;i < il;i++) {uniform._array[i] = getTextureUnit();}_gl.uniform1iv(location,uniform._array);for(var i=0,il=uniform.value.length;i < il;i++) {texture = uniform.value[i];textureUnit = uniform._array[i];if(!texture)continue;_this.setTexture(texture,textureUnit);}break;default:console.warn('THREE.WebGLRenderer: Unknown uniform type: ' + type);}}}function setColorLinear(array,offset,color,intensity){array[offset + 0] = color.r * intensity;array[offset + 1] = color.g * intensity;array[offset + 2] = color.b * intensity;}function setupLights(lights,camera){var l,ll,light,r=0,g=0,b=0,color,skyColor,groundColor,intensity,distance,zlights=_lights,viewMatrix=camera.matrixWorldInverse,dirColors=zlights.directional.colors,dirPositions=zlights.directional.positions,pointColors=zlights.point.colors,pointPositions=zlights.point.positions,pointDistances=zlights.point.distances,pointDecays=zlights.point.decays,spotColors=zlights.spot.colors,spotPositions=zlights.spot.positions,spotDistances=zlights.spot.distances,spotDirections=zlights.spot.directions,spotAnglesCos=zlights.spot.anglesCos,spotExponents=zlights.spot.exponents,spotDecays=zlights.spot.decays,hemiSkyColors=zlights.hemi.skyColors,hemiGroundColors=zlights.hemi.groundColors,hemiPositions=zlights.hemi.positions,dirLength=0,pointLength=0,spotLength=0,hemiLength=0,dirCount=0,pointCount=0,spotCount=0,hemiCount=0,dirOffset=0,pointOffset=0,spotOffset=0,hemiOffset=0;for(l = 0,ll = lights.length;l < ll;l++) {light = lights[l];if(light.onlyShadow)continue;color = light.color;intensity = light.intensity;distance = light.distance;if(light instanceof THREE.AmbientLight){if(!light.visible)continue;r += color.r;g += color.g;b += color.b;}else if(light instanceof THREE.DirectionalLight){dirCount += 1;if(!light.visible)continue;_direction.setFromMatrixPosition(light.matrixWorld);_vector3.setFromMatrixPosition(light.target.matrixWorld);_direction.sub(_vector3);_direction.transformDirection(viewMatrix);dirOffset = dirLength * 3;dirPositions[dirOffset + 0] = _direction.x;dirPositions[dirOffset + 1] = _direction.y;dirPositions[dirOffset + 2] = _direction.z;setColorLinear(dirColors,dirOffset,color,intensity);dirLength += 1;}else if(light instanceof THREE.PointLight){pointCount += 1;if(!light.visible)continue;pointOffset = pointLength * 3;setColorLinear(pointColors,pointOffset,color,intensity);_vector3.setFromMatrixPosition(light.matrixWorld);_vector3.applyMatrix4(viewMatrix);pointPositions[pointOffset + 0] = _vector3.x;pointPositions[pointOffset + 1] = _vector3.y;pointPositions[pointOffset + 2] = _vector3.z; // distance is 0 if decay is 0, because there is no attenuation at all.\n\tpointDistances[pointLength] = distance;pointDecays[pointLength] = light.distance === 0?0.0:light.decay;pointLength += 1;}else if(light instanceof THREE.SpotLight){spotCount += 1;if(!light.visible)continue;spotOffset = spotLength * 3;setColorLinear(spotColors,spotOffset,color,intensity);_direction.setFromMatrixPosition(light.matrixWorld);_vector3.copy(_direction).applyMatrix4(viewMatrix);spotPositions[spotOffset + 0] = _vector3.x;spotPositions[spotOffset + 1] = _vector3.y;spotPositions[spotOffset + 2] = _vector3.z;spotDistances[spotLength] = distance;_vector3.setFromMatrixPosition(light.target.matrixWorld);_direction.sub(_vector3);_direction.transformDirection(viewMatrix);spotDirections[spotOffset + 0] = _direction.x;spotDirections[spotOffset + 1] = _direction.y;spotDirections[spotOffset + 2] = _direction.z;spotAnglesCos[spotLength] = Math.cos(light.angle);spotExponents[spotLength] = light.exponent;spotDecays[spotLength] = light.distance === 0?0.0:light.decay;spotLength += 1;}else if(light instanceof THREE.HemisphereLight){hemiCount += 1;if(!light.visible)continue;_direction.setFromMatrixPosition(light.matrixWorld);_direction.transformDirection(viewMatrix);hemiOffset = hemiLength * 3;hemiPositions[hemiOffset + 0] = _direction.x;hemiPositions[hemiOffset + 1] = _direction.y;hemiPositions[hemiOffset + 2] = _direction.z;skyColor = light.color;groundColor = light.groundColor;setColorLinear(hemiSkyColors,hemiOffset,skyColor,intensity);setColorLinear(hemiGroundColors,hemiOffset,groundColor,intensity);hemiLength += 1;}} // null eventual remains from removed lights\n\t// (this is to avoid if in shader)\n\tfor(l = dirLength * 3,ll = Math.max(dirColors.length,dirCount * 3);l < ll;l++) dirColors[l] = 0.0;for(l = pointLength * 3,ll = Math.max(pointColors.length,pointCount * 3);l < ll;l++) pointColors[l] = 0.0;for(l = spotLength * 3,ll = Math.max(spotColors.length,spotCount * 3);l < ll;l++) spotColors[l] = 0.0;for(l = hemiLength * 3,ll = Math.max(hemiSkyColors.length,hemiCount * 3);l < ll;l++) hemiSkyColors[l] = 0.0;for(l = hemiLength * 3,ll = Math.max(hemiGroundColors.length,hemiCount * 3);l < ll;l++) hemiGroundColors[l] = 0.0;zlights.directional.length = dirLength;zlights.point.length = pointLength;zlights.spot.length = spotLength;zlights.hemi.length = hemiLength;zlights.ambient[0] = r;zlights.ambient[1] = g;zlights.ambient[2] = b;} // GL state setting\n\tthis.setFaceCulling = function(cullFace,frontFaceDirection){if(cullFace === THREE.CullFaceNone){state.disable(_gl.CULL_FACE);}else {if(frontFaceDirection === THREE.FrontFaceDirectionCW){_gl.frontFace(_gl.CW);}else {_gl.frontFace(_gl.CCW);}if(cullFace === THREE.CullFaceBack){_gl.cullFace(_gl.BACK);}else if(cullFace === THREE.CullFaceFront){_gl.cullFace(_gl.FRONT);}else {_gl.cullFace(_gl.FRONT_AND_BACK);}state.enable(_gl.CULL_FACE);}}; // Textures\n\tfunction setTextureParameters(textureType,texture,isImagePowerOfTwo){var extension;if(isImagePowerOfTwo){_gl.texParameteri(textureType,_gl.TEXTURE_WRAP_S,paramThreeToGL(texture.wrapS));_gl.texParameteri(textureType,_gl.TEXTURE_WRAP_T,paramThreeToGL(texture.wrapT));_gl.texParameteri(textureType,_gl.TEXTURE_MAG_FILTER,paramThreeToGL(texture.magFilter));_gl.texParameteri(textureType,_gl.TEXTURE_MIN_FILTER,paramThreeToGL(texture.minFilter));}else {_gl.texParameteri(textureType,_gl.TEXTURE_WRAP_S,_gl.CLAMP_TO_EDGE);_gl.texParameteri(textureType,_gl.TEXTURE_WRAP_T,_gl.CLAMP_TO_EDGE);if(texture.wrapS !== THREE.ClampToEdgeWrapping || texture.wrapT !== THREE.ClampToEdgeWrapping){console.warn('THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping. ( ' + texture.sourceFile + ' )');}_gl.texParameteri(textureType,_gl.TEXTURE_MAG_FILTER,filterFallback(texture.magFilter));_gl.texParameteri(textureType,_gl.TEXTURE_MIN_FILTER,filterFallback(texture.minFilter));if(texture.minFilter !== THREE.NearestFilter && texture.minFilter !== THREE.LinearFilter){console.warn('THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter. ( ' + texture.sourceFile + ' )');}}extension = extensions.get('EXT_texture_filter_anisotropic');if(extension){if(texture.type === THREE.FloatType && extensions.get('OES_texture_float_linear') === null)return;if(texture.type === THREE.HalfFloatType && extensions.get('OES_texture_half_float_linear') === null)return;if(texture.anisotropy > 1 || properties.get(texture).__currentAnisotropy){_gl.texParameterf(textureType,extension.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(texture.anisotropy,_this.getMaxAnisotropy()));properties.get(texture).__currentAnisotropy = texture.anisotropy;}}}function uploadTexture(textureProperties,texture,slot){if(textureProperties.__webglInit === undefined){textureProperties.__webglInit = true;texture.__webglInit = true;texture.addEventListener('dispose',onTextureDispose);textureProperties.__webglTexture = _gl.createTexture();_infoMemory.textures++;}state.activeTexture(_gl.TEXTURE0 + slot);state.bindTexture(_gl.TEXTURE_2D,textureProperties.__webglTexture);_gl.pixelStorei(_gl.UNPACK_FLIP_Y_WEBGL,texture.flipY);_gl.pixelStorei(_gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,texture.premultiplyAlpha);_gl.pixelStorei(_gl.UNPACK_ALIGNMENT,texture.unpackAlignment);texture.image = clampToMaxSize(texture.image,capabilities.maxTextureSize);var image=texture.image,isImagePowerOfTwo=THREE.Math.isPowerOfTwo(image.width) && THREE.Math.isPowerOfTwo(image.height),glFormat=paramThreeToGL(texture.format),glType=paramThreeToGL(texture.type);setTextureParameters(_gl.TEXTURE_2D,texture,isImagePowerOfTwo);var mipmap,mipmaps=texture.mipmaps;if(texture instanceof THREE.DataTexture){ // use manually created mipmaps if available\n\t// if there are no manual mipmaps\n\t// set 0 level mipmap and then use GL to generate other mipmap levels\n\tif(mipmaps.length > 0 && isImagePowerOfTwo){for(var i=0,il=mipmaps.length;i < il;i++) {mipmap = mipmaps[i];state.texImage2D(_gl.TEXTURE_2D,i,glFormat,mipmap.width,mipmap.height,0,glFormat,glType,mipmap.data);}texture.generateMipmaps = false;}else {state.texImage2D(_gl.TEXTURE_2D,0,glFormat,image.width,image.height,0,glFormat,glType,image.data);}}else if(texture instanceof THREE.CompressedTexture){for(var i=0,il=mipmaps.length;i < il;i++) {mipmap = mipmaps[i];if(texture.format !== THREE.RGBAFormat && texture.format !== THREE.RGBFormat){if(state.getCompressedTextureFormats().indexOf(glFormat) > -1){state.compressedTexImage2D(_gl.TEXTURE_2D,i,glFormat,mipmap.width,mipmap.height,0,mipmap.data);}else {console.warn(\"THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()\");}}else {state.texImage2D(_gl.TEXTURE_2D,i,glFormat,mipmap.width,mipmap.height,0,glFormat,glType,mipmap.data);}}}else { // regular Texture (image, video, canvas)\n\t// use manually created mipmaps if available\n\t// if there are no manual mipmaps\n\t// set 0 level mipmap and then use GL to generate other mipmap levels\n\tif(mipmaps.length > 0 && isImagePowerOfTwo){for(var i=0,il=mipmaps.length;i < il;i++) {mipmap = mipmaps[i];state.texImage2D(_gl.TEXTURE_2D,i,glFormat,glFormat,glType,mipmap);}texture.generateMipmaps = false;}else {state.texImage2D(_gl.TEXTURE_2D,0,glFormat,glFormat,glType,texture.image);}}if(texture.generateMipmaps && isImagePowerOfTwo)_gl.generateMipmap(_gl.TEXTURE_2D);textureProperties.__version = texture.version;if(texture.onUpdate)texture.onUpdate(texture);}this.setTexture = function(texture,slot){var textureProperties=properties.get(texture);if(texture.version > 0 && textureProperties.__version !== texture.version){var image=texture.image;if(image === undefined){console.warn('THREE.WebGLRenderer: Texture marked for update but image is undefined',texture);return;}if(image.complete === false){console.warn('THREE.WebGLRenderer: Texture marked for update but image is incomplete',texture);return;}uploadTexture(textureProperties,texture,slot);return;}state.activeTexture(_gl.TEXTURE0 + slot);state.bindTexture(_gl.TEXTURE_2D,textureProperties.__webglTexture);};function clampToMaxSize(image,maxSize){if(image.width > maxSize || image.height > maxSize){ // Warning: Scaling through the canvas will only work with images that use\n\t// premultiplied alpha.\n\tvar scale=maxSize / Math.max(image.width,image.height);var canvas=document.createElement('canvas');canvas.width = Math.floor(image.width * scale);canvas.height = Math.floor(image.height * scale);var context=canvas.getContext('2d');context.drawImage(image,0,0,image.width,image.height,0,0,canvas.width,canvas.height);console.warn('THREE.WebGLRenderer: image is too big (' + image.width + 'x' + image.height + '). Resized to ' + canvas.width + 'x' + canvas.height,image);return canvas;}return image;}function setCubeTexture(texture,slot){var textureProperties=properties.get(texture);if(texture.image.length === 6){if(texture.version > 0 && textureProperties.__version !== texture.version){if(!textureProperties.__image__webglTextureCube){texture.addEventListener('dispose',onTextureDispose);textureProperties.__image__webglTextureCube = _gl.createTexture();_infoMemory.textures++;}state.activeTexture(_gl.TEXTURE0 + slot);state.bindTexture(_gl.TEXTURE_CUBE_MAP,textureProperties.__image__webglTextureCube);_gl.pixelStorei(_gl.UNPACK_FLIP_Y_WEBGL,texture.flipY);var isCompressed=texture instanceof THREE.CompressedTexture;var isDataTexture=texture.image[0] instanceof THREE.DataTexture;var cubeImage=[];for(var i=0;i < 6;i++) {if(_this.autoScaleCubemaps && !isCompressed && !isDataTexture){cubeImage[i] = clampToMaxSize(texture.image[i],capabilities.maxCubemapSize);}else {cubeImage[i] = isDataTexture?texture.image[i].image:texture.image[i];}}var image=cubeImage[0],isImagePowerOfTwo=THREE.Math.isPowerOfTwo(image.width) && THREE.Math.isPowerOfTwo(image.height),glFormat=paramThreeToGL(texture.format),glType=paramThreeToGL(texture.type);setTextureParameters(_gl.TEXTURE_CUBE_MAP,texture,isImagePowerOfTwo);for(var i=0;i < 6;i++) {if(!isCompressed){if(isDataTexture){state.texImage2D(_gl.TEXTURE_CUBE_MAP_POSITIVE_X + i,0,glFormat,cubeImage[i].width,cubeImage[i].height,0,glFormat,glType,cubeImage[i].data);}else {state.texImage2D(_gl.TEXTURE_CUBE_MAP_POSITIVE_X + i,0,glFormat,glFormat,glType,cubeImage[i]);}}else {var mipmap,mipmaps=cubeImage[i].mipmaps;for(var j=0,jl=mipmaps.length;j < jl;j++) {mipmap = mipmaps[j];if(texture.format !== THREE.RGBAFormat && texture.format !== THREE.RGBFormat){if(state.getCompressedTextureFormats().indexOf(glFormat) > -1){state.compressedTexImage2D(_gl.TEXTURE_CUBE_MAP_POSITIVE_X + i,j,glFormat,mipmap.width,mipmap.height,0,mipmap.data);}else {console.warn(\"THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setCubeTexture()\");}}else {state.texImage2D(_gl.TEXTURE_CUBE_MAP_POSITIVE_X + i,j,glFormat,mipmap.width,mipmap.height,0,glFormat,glType,mipmap.data);}}}}if(texture.generateMipmaps && isImagePowerOfTwo){_gl.generateMipmap(_gl.TEXTURE_CUBE_MAP);}textureProperties.__version = texture.version;if(texture.onUpdate)texture.onUpdate(texture);}else {state.activeTexture(_gl.TEXTURE0 + slot);state.bindTexture(_gl.TEXTURE_CUBE_MAP,textureProperties.__image__webglTextureCube);}}}function setCubeTextureDynamic(texture,slot){state.activeTexture(_gl.TEXTURE0 + slot);state.bindTexture(_gl.TEXTURE_CUBE_MAP,properties.get(texture).__webglTexture);} // Render targets\n\tfunction setupFrameBuffer(framebuffer,renderTarget,textureTarget){_gl.bindFramebuffer(_gl.FRAMEBUFFER,framebuffer);_gl.framebufferTexture2D(_gl.FRAMEBUFFER,_gl.COLOR_ATTACHMENT0,textureTarget,properties.get(renderTarget).__webglTexture,0);}function setupRenderBuffer(renderbuffer,renderTarget){_gl.bindRenderbuffer(_gl.RENDERBUFFER,renderbuffer);if(renderTarget.depthBuffer && !renderTarget.stencilBuffer){_gl.renderbufferStorage(_gl.RENDERBUFFER,_gl.DEPTH_COMPONENT16,renderTarget.width,renderTarget.height);_gl.framebufferRenderbuffer(_gl.FRAMEBUFFER,_gl.DEPTH_ATTACHMENT,_gl.RENDERBUFFER,renderbuffer); /* For some reason this is not working. Defaulting to RGBA4.\n\t\t\t} else if ( ! renderTarget.depthBuffer && renderTarget.stencilBuffer ) {\n\t\n\t\t\t\t_gl.renderbufferStorage( _gl.RENDERBUFFER, _gl.STENCIL_INDEX8, renderTarget.width, renderTarget.height );\n\t\t\t\t_gl.framebufferRenderbuffer( _gl.FRAMEBUFFER, _gl.STENCIL_ATTACHMENT, _gl.RENDERBUFFER, renderbuffer );\n\t\t\t*/}else if(renderTarget.depthBuffer && renderTarget.stencilBuffer){_gl.renderbufferStorage(_gl.RENDERBUFFER,_gl.DEPTH_STENCIL,renderTarget.width,renderTarget.height);_gl.framebufferRenderbuffer(_gl.FRAMEBUFFER,_gl.DEPTH_STENCIL_ATTACHMENT,_gl.RENDERBUFFER,renderbuffer);}else {_gl.renderbufferStorage(_gl.RENDERBUFFER,_gl.RGBA4,renderTarget.width,renderTarget.height);}}this.setRenderTarget = function(renderTarget){var isCube=renderTarget instanceof THREE.WebGLRenderTargetCube;if(renderTarget && properties.get(renderTarget).__webglFramebuffer === undefined){var renderTargetProperties=properties.get(renderTarget);if(renderTarget.depthBuffer === undefined)renderTarget.depthBuffer = true;if(renderTarget.stencilBuffer === undefined)renderTarget.stencilBuffer = true;renderTarget.addEventListener('dispose',onRenderTargetDispose);renderTargetProperties.__webglTexture = _gl.createTexture();_infoMemory.textures++; // Setup texture, create render and frame buffers\n\tvar isTargetPowerOfTwo=THREE.Math.isPowerOfTwo(renderTarget.width) && THREE.Math.isPowerOfTwo(renderTarget.height),glFormat=paramThreeToGL(renderTarget.format),glType=paramThreeToGL(renderTarget.type);if(isCube){renderTargetProperties.__webglFramebuffer = [];renderTargetProperties.__webglRenderbuffer = [];state.bindTexture(_gl.TEXTURE_CUBE_MAP,renderTargetProperties.__webglTexture);setTextureParameters(_gl.TEXTURE_CUBE_MAP,renderTarget,isTargetPowerOfTwo);for(var i=0;i < 6;i++) {renderTargetProperties.__webglFramebuffer[i] = _gl.createFramebuffer();renderTargetProperties.__webglRenderbuffer[i] = _gl.createRenderbuffer();state.texImage2D(_gl.TEXTURE_CUBE_MAP_POSITIVE_X + i,0,glFormat,renderTarget.width,renderTarget.height,0,glFormat,glType,null);setupFrameBuffer(renderTargetProperties.__webglFramebuffer[i],renderTarget,_gl.TEXTURE_CUBE_MAP_POSITIVE_X + i);setupRenderBuffer(renderTargetProperties.__webglRenderbuffer[i],renderTarget);}if(renderTarget.generateMipmaps && isTargetPowerOfTwo)_gl.generateMipmap(_gl.TEXTURE_CUBE_MAP);}else {renderTargetProperties.__webglFramebuffer = _gl.createFramebuffer();if(renderTarget.shareDepthFrom){renderTargetProperties.__webglRenderbuffer = renderTarget.shareDepthFrom.__webglRenderbuffer;}else {renderTargetProperties.__webglRenderbuffer = _gl.createRenderbuffer();}state.bindTexture(_gl.TEXTURE_2D,renderTargetProperties.__webglTexture);setTextureParameters(_gl.TEXTURE_2D,renderTarget,isTargetPowerOfTwo);state.texImage2D(_gl.TEXTURE_2D,0,glFormat,renderTarget.width,renderTarget.height,0,glFormat,glType,null);setupFrameBuffer(renderTargetProperties.__webglFramebuffer,renderTarget,_gl.TEXTURE_2D);if(renderTarget.shareDepthFrom){if(renderTarget.depthBuffer && !renderTarget.stencilBuffer){_gl.framebufferRenderbuffer(_gl.FRAMEBUFFER,_gl.DEPTH_ATTACHMENT,_gl.RENDERBUFFER,renderTargetProperties.__webglRenderbuffer);}else if(renderTarget.depthBuffer && renderTarget.stencilBuffer){_gl.framebufferRenderbuffer(_gl.FRAMEBUFFER,_gl.DEPTH_STENCIL_ATTACHMENT,_gl.RENDERBUFFER,renderTargetProperties.__webglRenderbuffer);}}else {setupRenderBuffer(renderTargetProperties.__webglRenderbuffer,renderTarget);}if(renderTarget.generateMipmaps && isTargetPowerOfTwo)_gl.generateMipmap(_gl.TEXTURE_2D);} // Release everything\n\tif(isCube){state.bindTexture(_gl.TEXTURE_CUBE_MAP,null);}else {state.bindTexture(_gl.TEXTURE_2D,null);}_gl.bindRenderbuffer(_gl.RENDERBUFFER,null);_gl.bindFramebuffer(_gl.FRAMEBUFFER,null);}var framebuffer,width,height,vx,vy;if(renderTarget){var renderTargetProperties=properties.get(renderTarget);if(isCube){framebuffer = renderTargetProperties.__webglFramebuffer[renderTarget.activeCubeFace];}else {framebuffer = renderTargetProperties.__webglFramebuffer;}width = renderTarget.width;height = renderTarget.height;vx = 0;vy = 0;}else {framebuffer = null;width = _viewportWidth;height = _viewportHeight;vx = _viewportX;vy = _viewportY;}if(framebuffer !== _currentFramebuffer){_gl.bindFramebuffer(_gl.FRAMEBUFFER,framebuffer);_gl.viewport(vx,vy,width,height);_currentFramebuffer = framebuffer;}_currentWidth = width;_currentHeight = height;};this.readRenderTargetPixels = function(renderTarget,x,y,width,height,buffer){if(!(renderTarget instanceof THREE.WebGLRenderTarget)){console.error('THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.');return;}if(properties.get(renderTarget).__webglFramebuffer){if(renderTarget.format !== THREE.RGBAFormat){console.error('THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA format. readPixels can read only RGBA format.');return;}var restore=false;if(properties.get(renderTarget).__webglFramebuffer !== _currentFramebuffer){_gl.bindFramebuffer(_gl.FRAMEBUFFER,properties.get(renderTarget).__webglFramebuffer);restore = true;}if(_gl.checkFramebufferStatus(_gl.FRAMEBUFFER) === _gl.FRAMEBUFFER_COMPLETE){_gl.readPixels(x,y,width,height,_gl.RGBA,_gl.UNSIGNED_BYTE,buffer);}else {console.error('THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.');}if(restore){_gl.bindFramebuffer(_gl.FRAMEBUFFER,_currentFramebuffer);}}};function updateRenderTargetMipmap(renderTarget){if(renderTarget instanceof THREE.WebGLRenderTargetCube){state.bindTexture(_gl.TEXTURE_CUBE_MAP,properties.get(renderTarget).__webglTexture);_gl.generateMipmap(_gl.TEXTURE_CUBE_MAP);state.bindTexture(_gl.TEXTURE_CUBE_MAP,null);}else {state.bindTexture(_gl.TEXTURE_2D,properties.get(renderTarget).__webglTexture);_gl.generateMipmap(_gl.TEXTURE_2D);state.bindTexture(_gl.TEXTURE_2D,null);}} // Fallback filters for non-power-of-2 textures\n\tfunction filterFallback(f){if(f === THREE.NearestFilter || f === THREE.NearestMipMapNearestFilter || f === THREE.NearestMipMapLinearFilter){return _gl.NEAREST;}return _gl.LINEAR;} // Map three.js constants to WebGL constants\n\tfunction paramThreeToGL(p){var extension;if(p === THREE.RepeatWrapping)return _gl.REPEAT;if(p === THREE.ClampToEdgeWrapping)return _gl.CLAMP_TO_EDGE;if(p === THREE.MirroredRepeatWrapping)return _gl.MIRRORED_REPEAT;if(p === THREE.NearestFilter)return _gl.NEAREST;if(p === THREE.NearestMipMapNearestFilter)return _gl.NEAREST_MIPMAP_NEAREST;if(p === THREE.NearestMipMapLinearFilter)return _gl.NEAREST_MIPMAP_LINEAR;if(p === THREE.LinearFilter)return _gl.LINEAR;if(p === THREE.LinearMipMapNearestFilter)return _gl.LINEAR_MIPMAP_NEAREST;if(p === THREE.LinearMipMapLinearFilter)return _gl.LINEAR_MIPMAP_LINEAR;if(p === THREE.UnsignedByteType)return _gl.UNSIGNED_BYTE;if(p === THREE.UnsignedShort4444Type)return _gl.UNSIGNED_SHORT_4_4_4_4;if(p === THREE.UnsignedShort5551Type)return _gl.UNSIGNED_SHORT_5_5_5_1;if(p === THREE.UnsignedShort565Type)return _gl.UNSIGNED_SHORT_5_6_5;if(p === THREE.ByteType)return _gl.BYTE;if(p === THREE.ShortType)return _gl.SHORT;if(p === THREE.UnsignedShortType)return _gl.UNSIGNED_SHORT;if(p === THREE.IntType)return _gl.INT;if(p === THREE.UnsignedIntType)return _gl.UNSIGNED_INT;if(p === THREE.FloatType)return _gl.FLOAT;extension = extensions.get('OES_texture_half_float');if(extension !== null){if(p === THREE.HalfFloatType)return extension.HALF_FLOAT_OES;}if(p === THREE.AlphaFormat)return _gl.ALPHA;if(p === THREE.RGBFormat)return _gl.RGB;if(p === THREE.RGBAFormat)return _gl.RGBA;if(p === THREE.LuminanceFormat)return _gl.LUMINANCE;if(p === THREE.LuminanceAlphaFormat)return _gl.LUMINANCE_ALPHA;if(p === THREE.AddEquation)return _gl.FUNC_ADD;if(p === THREE.SubtractEquation)return _gl.FUNC_SUBTRACT;if(p === THREE.ReverseSubtractEquation)return _gl.FUNC_REVERSE_SUBTRACT;if(p === THREE.ZeroFactor)return _gl.ZERO;if(p === THREE.OneFactor)return _gl.ONE;if(p === THREE.SrcColorFactor)return _gl.SRC_COLOR;if(p === THREE.OneMinusSrcColorFactor)return _gl.ONE_MINUS_SRC_COLOR;if(p === THREE.SrcAlphaFactor)return _gl.SRC_ALPHA;if(p === THREE.OneMinusSrcAlphaFactor)return _gl.ONE_MINUS_SRC_ALPHA;if(p === THREE.DstAlphaFactor)return _gl.DST_ALPHA;if(p === THREE.OneMinusDstAlphaFactor)return _gl.ONE_MINUS_DST_ALPHA;if(p === THREE.DstColorFactor)return _gl.DST_COLOR;if(p === THREE.OneMinusDstColorFactor)return _gl.ONE_MINUS_DST_COLOR;if(p === THREE.SrcAlphaSaturateFactor)return _gl.SRC_ALPHA_SATURATE;extension = extensions.get('WEBGL_compressed_texture_s3tc');if(extension !== null){if(p === THREE.RGB_S3TC_DXT1_Format)return extension.COMPRESSED_RGB_S3TC_DXT1_EXT;if(p === THREE.RGBA_S3TC_DXT1_Format)return extension.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(p === THREE.RGBA_S3TC_DXT3_Format)return extension.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(p === THREE.RGBA_S3TC_DXT5_Format)return extension.COMPRESSED_RGBA_S3TC_DXT5_EXT;}extension = extensions.get('WEBGL_compressed_texture_pvrtc');if(extension !== null){if(p === THREE.RGB_PVRTC_4BPPV1_Format)return extension.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(p === THREE.RGB_PVRTC_2BPPV1_Format)return extension.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(p === THREE.RGBA_PVRTC_4BPPV1_Format)return extension.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(p === THREE.RGBA_PVRTC_2BPPV1_Format)return extension.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG;}extension = extensions.get('EXT_blend_minmax');if(extension !== null){if(p === THREE.MinEquation)return extension.MIN_EXT;if(p === THREE.MaxEquation)return extension.MAX_EXT;}return 0;} // DEPRECATED\n\tthis.supportsFloatTextures = function(){console.warn('THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( \\'OES_texture_float\\' ).');return extensions.get('OES_texture_float');};this.supportsHalfFloatTextures = function(){console.warn('THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( \\'OES_texture_half_float\\' ).');return extensions.get('OES_texture_half_float');};this.supportsStandardDerivatives = function(){console.warn('THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( \\'OES_standard_derivatives\\' ).');return extensions.get('OES_standard_derivatives');};this.supportsCompressedTextureS3TC = function(){console.warn('THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( \\'WEBGL_compressed_texture_s3tc\\' ).');return extensions.get('WEBGL_compressed_texture_s3tc');};this.supportsCompressedTexturePVRTC = function(){console.warn('THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( \\'WEBGL_compressed_texture_pvrtc\\' ).');return extensions.get('WEBGL_compressed_texture_pvrtc');};this.supportsBlendMinMax = function(){console.warn('THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( \\'EXT_blend_minmax\\' ).');return extensions.get('EXT_blend_minmax');};this.supportsVertexTextures = function(){return capabilities.vertexTextures;};this.supportsInstancedArrays = function(){console.warn('THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( \\'ANGLE_instanced_arrays\\' ).');return extensions.get('ANGLE_instanced_arrays');}; //\n\tthis.initMaterial = function(){console.warn('THREE.WebGLRenderer: .initMaterial() has been removed.');};this.addPrePlugin = function(){console.warn('THREE.WebGLRenderer: .addPrePlugin() has been removed.');};this.addPostPlugin = function(){console.warn('THREE.WebGLRenderer: .addPostPlugin() has been removed.');};this.updateShadowMap = function(){console.warn('THREE.WebGLRenderer: .updateShadowMap() has been removed.');};_Object$defineProperties(this,{shadowMapEnabled:{get:function get(){return shadowMap.enabled;},set:function set(value){console.warn('THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled.');shadowMap.enabled = value;}},shadowMapType:{get:function get(){return shadowMap.type;},set:function set(value){console.warn('THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type.');shadowMap.type = value;}},shadowMapCullFace:{get:function get(){return shadowMap.cullFace;},set:function set(value){console.warn('THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace.');shadowMap.cullFace = value;}},shadowMapDebug:{get:function get(){return shadowMap.debug;},set:function set(value){console.warn('THREE.WebGLRenderer: .shadowMapDebug is now .shadowMap.debug.');shadowMap.debug = value;}}});}; // File:src/renderers/WebGLRenderTarget.js\n\t/**\n\t * @author szimek / https://github.com/szimek/\n\t * @author alteredq / http://alteredqualia.com/\n\t */THREE.WebGLRenderTarget = function(width,height,options){this.uuid = THREE.Math.generateUUID();this.width = width;this.height = height;options = options || {};this.wrapS = options.wrapS !== undefined?options.wrapS:THREE.ClampToEdgeWrapping;this.wrapT = options.wrapT !== undefined?options.wrapT:THREE.ClampToEdgeWrapping;this.magFilter = options.magFilter !== undefined?options.magFilter:THREE.LinearFilter;this.minFilter = options.minFilter !== undefined?options.minFilter:THREE.LinearMipMapLinearFilter;this.anisotropy = options.anisotropy !== undefined?options.anisotropy:1;this.offset = new THREE.Vector2(0,0);this.repeat = new THREE.Vector2(1,1);this.format = options.format !== undefined?options.format:THREE.RGBAFormat;this.type = options.type !== undefined?options.type:THREE.UnsignedByteType;this.depthBuffer = options.depthBuffer !== undefined?options.depthBuffer:true;this.stencilBuffer = options.stencilBuffer !== undefined?options.stencilBuffer:true;this.generateMipmaps = true;this.shareDepthFrom = options.shareDepthFrom !== undefined?options.shareDepthFrom:null;};THREE.WebGLRenderTarget.prototype = {constructor:THREE.WebGLRenderTarget,setSize:function setSize(width,height){if(this.width !== width || this.height !== height){this.width = width;this.height = height;this.dispose();}},clone:function clone(){return new this.constructor().copy(this);},copy:function copy(source){this.width = source.width;this.height = source.height;this.wrapS = source.wrapS;this.wrapT = source.wrapT;this.magFilter = source.magFilter;this.minFilter = source.minFilter;this.anisotropy = source.anisotropy;this.offset.copy(source.offset);this.repeat.copy(source.repeat);this.format = source.format;this.type = source.type;this.depthBuffer = source.depthBuffer;this.stencilBuffer = source.stencilBuffer;this.generateMipmaps = source.generateMipmaps;this.shareDepthFrom = source.shareDepthFrom;return this;},dispose:function dispose(){this.dispatchEvent({type:'dispose'});}};THREE.EventDispatcher.prototype.apply(THREE.WebGLRenderTarget.prototype); // File:src/renderers/WebGLRenderTargetCube.js\n\t/**\n\t * @author alteredq / http://alteredqualia.com\n\t */THREE.WebGLRenderTargetCube = function(width,height,options){THREE.WebGLRenderTarget.call(this,width,height,options);this.activeCubeFace = 0; // PX 0, NX 1, PY 2, NY 3, PZ 4, NZ 5\n\t};THREE.WebGLRenderTargetCube.prototype = _Object$create(THREE.WebGLRenderTarget.prototype);THREE.WebGLRenderTargetCube.prototype.constructor = THREE.WebGLRenderTargetCube; // File:src/renderers/webgl/WebGLBufferRenderer.js\n\t/**\n\t* @author mrdoob / http://mrdoob.com/\n\t*/THREE.WebGLBufferRenderer = function(_gl,extensions,_infoRender){var mode;function setMode(value){mode = value;}function render(start,count){_gl.drawArrays(mode,start,count);_infoRender.calls++;_infoRender.vertices += count;if(mode === _gl.TRIANGLES)_infoRender.faces += count / 3;}function renderInstances(geometry){var extension=extensions.get('ANGLE_instanced_arrays');if(extension === null){console.error('THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.');return;}var position=geometry.attributes.position;if(position instanceof THREE.InterleavedBufferAttribute){extension.drawArraysInstancedANGLE(mode,0,position.data.count,geometry.maxInstancedCount);}else {extension.drawArraysInstancedANGLE(mode,0,position.count,geometry.maxInstancedCount);}}this.setMode = setMode;this.render = render;this.renderInstances = renderInstances;}; // File:src/renderers/webgl/WebGLIndexedBufferRenderer.js\n\t/**\n\t* @author mrdoob / http://mrdoob.com/\n\t*/THREE.WebGLIndexedBufferRenderer = function(_gl,extensions,_infoRender){var mode;function setMode(value){mode = value;}var type,size;function setIndex(index){if(index.array instanceof Uint32Array && extensions.get('OES_element_index_uint')){type = _gl.UNSIGNED_INT;size = 4;}else {type = _gl.UNSIGNED_SHORT;size = 2;}}function render(start,count){_gl.drawElements(mode,count,type,start * size);_infoRender.calls++;_infoRender.vertices += count;if(mode === _gl.TRIANGLES)_infoRender.faces += count / 3;}function renderInstances(geometry){var extension=extensions.get('ANGLE_instanced_arrays');if(extension === null){console.error('THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.');return;}var index=geometry.index;extension.drawElementsInstancedANGLE(mode,index.array.length,type,0,geometry.maxInstancedCount);}this.setMode = setMode;this.setIndex = setIndex;this.render = render;this.renderInstances = renderInstances;}; // File:src/renderers/webgl/WebGLExtensions.js\n\t/**\n\t* @author mrdoob / http://mrdoob.com/\n\t*/THREE.WebGLExtensions = function(gl){var extensions={};this.get = function(name){if(extensions[name] !== undefined){return extensions[name];}var extension;switch(name){case 'EXT_texture_filter_anisotropic':extension = gl.getExtension('EXT_texture_filter_anisotropic') || gl.getExtension('MOZ_EXT_texture_filter_anisotropic') || gl.getExtension('WEBKIT_EXT_texture_filter_anisotropic');break;case 'WEBGL_compressed_texture_s3tc':extension = gl.getExtension('WEBGL_compressed_texture_s3tc') || gl.getExtension('MOZ_WEBGL_compressed_texture_s3tc') || gl.getExtension('WEBKIT_WEBGL_compressed_texture_s3tc');break;case 'WEBGL_compressed_texture_pvrtc':extension = gl.getExtension('WEBGL_compressed_texture_pvrtc') || gl.getExtension('WEBKIT_WEBGL_compressed_texture_pvrtc');break;default:extension = gl.getExtension(name);}if(extension === null){console.warn('THREE.WebGLRenderer: ' + name + ' extension not supported.');}extensions[name] = extension;return extension;};}; // File:src/renderers/webgl/WebGLCapabilities.js\n\tTHREE.WebGLCapabilities = function(gl,extensions,parameters){function getMaxPrecision(precision){if(precision === 'highp'){if(gl.getShaderPrecisionFormat(gl.VERTEX_SHADER,gl.HIGH_FLOAT).precision > 0 && gl.getShaderPrecisionFormat(gl.FRAGMENT_SHADER,gl.HIGH_FLOAT).precision > 0){return 'highp';}precision = 'mediump';}if(precision === 'mediump'){if(gl.getShaderPrecisionFormat(gl.VERTEX_SHADER,gl.MEDIUM_FLOAT).precision > 0 && gl.getShaderPrecisionFormat(gl.FRAGMENT_SHADER,gl.MEDIUM_FLOAT).precision > 0){return 'mediump';}}return 'lowp';}this.getMaxPrecision = getMaxPrecision;this.precision = parameters.precision !== undefined?parameters.precision:'highp',this.logarithmicDepthBuffer = parameters.logarithmicDepthBuffer !== undefined?parameters.logarithmicDepthBuffer:false;this.maxTextures = gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS);this.maxVertexTextures = gl.getParameter(gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS);this.maxTextureSize = gl.getParameter(gl.MAX_TEXTURE_SIZE);this.maxCubemapSize = gl.getParameter(gl.MAX_CUBE_MAP_TEXTURE_SIZE);this.maxAttributes = gl.getParameter(gl.MAX_VERTEX_ATTRIBS);this.maxVertexUniforms = gl.getParameter(gl.MAX_VERTEX_UNIFORM_VECTORS);this.maxVaryings = gl.getParameter(gl.MAX_VARYING_VECTORS);this.maxFragmentUniforms = gl.getParameter(gl.MAX_FRAGMENT_UNIFORM_VECTORS);this.vertexTextures = this.maxVertexTextures > 0;this.floatFragmentTextures = !!extensions.get('OES_texture_float');this.floatVertexTextures = this.vertexTextures && this.floatFragmentTextures;var _maxPrecision=getMaxPrecision(this.precision);if(_maxPrecision !== this.precision){console.warn('THREE.WebGLRenderer:',this.precision,'not supported, using',_maxPrecision,'instead.');this.precision = _maxPrecision;}if(this.logarithmicDepthBuffer){this.logarithmicDepthBuffer = !!extensions.get('EXT_frag_depth');}}; // File:src/renderers/webgl/WebGLGeometries.js\n\t/**\n\t* @author mrdoob / http://mrdoob.com/\n\t*/THREE.WebGLGeometries = function(gl,properties,info){var geometries={};function get(object){var geometry=object.geometry;if(geometries[geometry.id] !== undefined){return geometries[geometry.id];}geometry.addEventListener('dispose',onGeometryDispose);var buffergeometry;if(geometry instanceof THREE.BufferGeometry){buffergeometry = geometry;}else if(geometry instanceof THREE.Geometry){if(geometry._bufferGeometry === undefined){geometry._bufferGeometry = new THREE.BufferGeometry().setFromObject(object);}buffergeometry = geometry._bufferGeometry;}geometries[geometry.id] = buffergeometry;info.memory.geometries++;return buffergeometry;}function onGeometryDispose(event){var geometry=event.target;var buffergeometry=geometries[geometry.id];deleteAttributes(buffergeometry.attributes);geometry.removeEventListener('dispose',onGeometryDispose);delete geometries[geometry.id];var property=properties.get(geometry);if(property.wireframe)deleteAttribute(property.wireframe);info.memory.geometries--;}function getAttributeBuffer(attribute){if(attribute instanceof THREE.InterleavedBufferAttribute){return properties.get(attribute.data).__webglBuffer;}return properties.get(attribute).__webglBuffer;}function deleteAttribute(attribute){var buffer=getAttributeBuffer(attribute);if(buffer !== undefined){gl.deleteBuffer(buffer);removeAttributeBuffer(attribute);}}function deleteAttributes(attributes){for(var name in attributes) {deleteAttribute(attributes[name]);}}function removeAttributeBuffer(attribute){if(attribute instanceof THREE.InterleavedBufferAttribute){properties['delete'](attribute.data);}else {properties['delete'](attribute);}}this.get = get;}; // File:src/renderers/webgl/WebGLObjects.js\n\t/**\n\t* @author mrdoob / http://mrdoob.com/\n\t*/THREE.WebGLObjects = function(gl,properties,info){var geometries=new THREE.WebGLGeometries(gl,properties,info); //\n\tfunction update(object){ // TODO: Avoid updating twice (when using shadowMap). Maybe add frame counter.\n\tvar geometry=geometries.get(object);if(object.geometry instanceof THREE.Geometry){geometry.updateFromObject(object);}var index=geometry.index;var attributes=geometry.attributes;if(index !== null){updateAttribute(index,gl.ELEMENT_ARRAY_BUFFER);}for(var name in attributes) {updateAttribute(attributes[name],gl.ARRAY_BUFFER);} // morph targets\n\tvar morphAttributes=geometry.morphAttributes;for(var name in morphAttributes) {var array=morphAttributes[name];for(var i=0,l=array.length;i < l;i++) {updateAttribute(array[i],gl.ARRAY_BUFFER);}}return geometry;}function updateAttribute(attribute,bufferType){var data=attribute instanceof THREE.InterleavedBufferAttribute?attribute.data:attribute;var attributeProperties=properties.get(data);if(attributeProperties.__webglBuffer === undefined){createBuffer(attributeProperties,data,bufferType);}else if(attributeProperties.version !== data.version){updateBuffer(attributeProperties,data,bufferType);}}function createBuffer(attributeProperties,data,bufferType){attributeProperties.__webglBuffer = gl.createBuffer();gl.bindBuffer(bufferType,attributeProperties.__webglBuffer);var usage=data.dynamic?gl.DYNAMIC_DRAW:gl.STATIC_DRAW;gl.bufferData(bufferType,data.array,usage);attributeProperties.version = data.version;}function updateBuffer(attributeProperties,data,bufferType){gl.bindBuffer(bufferType,attributeProperties.__webglBuffer);if(data.dynamic === false || data.updateRange.count === -1){ // Not using update ranges\n\tgl.bufferSubData(bufferType,0,data.array);}else if(data.updateRange.count === 0){console.error('THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually.');}else {gl.bufferSubData(bufferType,data.updateRange.offset * data.array.BYTES_PER_ELEMENT,data.array.subarray(data.updateRange.offset,data.updateRange.offset + data.updateRange.count));data.updateRange.count = 0; // reset range\n\t}attributeProperties.version = data.version;}function getAttributeBuffer(attribute){if(attribute instanceof THREE.InterleavedBufferAttribute){return properties.get(attribute.data).__webglBuffer;}return properties.get(attribute).__webglBuffer;}function getWireframeAttribute(geometry){var property=properties.get(geometry);if(property.wireframe !== undefined){return property.wireframe;}var indices=[];var index=geometry.index;var attributes=geometry.attributes;var position=attributes.position; // console.time( 'wireframe' );\n\tif(index !== null){var edges={};var array=index.array;for(var i=0,l=array.length;i < l;i += 3) {var a=array[i + 0];var b=array[i + 1];var c=array[i + 2];if(checkEdge(edges,a,b))indices.push(a,b);if(checkEdge(edges,b,c))indices.push(b,c);if(checkEdge(edges,c,a))indices.push(c,a);}}else {var array=attributes.position.array;for(var i=0,l=array.length / 3 - 1;i < l;i += 3) {var a=i + 0;var b=i + 1;var c=i + 2;indices.push(a,b,b,c,c,a);}} // console.timeEnd( 'wireframe' );\n\tvar TypeArray=position.count > 65535?Uint32Array:Uint16Array;var attribute=new THREE.BufferAttribute(new TypeArray(indices),1);updateAttribute(attribute,gl.ELEMENT_ARRAY_BUFFER);property.wireframe = attribute;return attribute;}function checkEdge(edges,a,b){if(a > b){var tmp=a;a = b;b = tmp;}var list=edges[a];if(list === undefined){edges[a] = [b];return true;}else if(list.indexOf(b) === -1){list.push(b);return true;}return false;}this.getAttributeBuffer = getAttributeBuffer;this.getWireframeAttribute = getWireframeAttribute;this.update = update;}; // File:src/renderers/webgl/WebGLProgram.js\n\tTHREE.WebGLProgram = (function(){var programIdCount=0;function generateDefines(defines){var chunks=[];for(var name in defines) {var value=defines[name];if(value === false)continue;chunks.push('#define ' + name + ' ' + value);}return chunks.join('\\n');}function fetchUniformLocations(gl,program,identifiers){var uniforms={};var n=gl.getProgramParameter(program,gl.ACTIVE_UNIFORMS);for(var i=0;i < n;i++) {var info=gl.getActiveUniform(program,i);var name=info.name;var location=gl.getUniformLocation(program,name); // console.log(\"THREE.WebGLProgram: ACTIVE UNIFORM:\", name);\n\tvar suffixPos=name.lastIndexOf('[0]');if(suffixPos !== -1 && suffixPos === name.length - 3){uniforms[name.substr(0,suffixPos)] = location;}uniforms[name] = location;}return uniforms;}function fetchAttributeLocations(gl,program,identifiers){var attributes={};var n=gl.getProgramParameter(program,gl.ACTIVE_ATTRIBUTES);for(var i=0;i < n;i++) {var info=gl.getActiveAttrib(program,i);var name=info.name; // console.log(\"THREE.WebGLProgram: ACTIVE VERTEX ATTRIBUTE:\", name, i );\n\tattributes[name] = gl.getAttribLocation(program,name);}return attributes;}function filterEmptyLine(string){return string !== '';}return function WebGLProgram(renderer,code,material,parameters){var gl=renderer.context;var defines=material.defines;var vertexShader=material.__webglShader.vertexShader;var fragmentShader=material.__webglShader.fragmentShader;var shadowMapTypeDefine='SHADOWMAP_TYPE_BASIC';if(parameters.shadowMapType === THREE.PCFShadowMap){shadowMapTypeDefine = 'SHADOWMAP_TYPE_PCF';}else if(parameters.shadowMapType === THREE.PCFSoftShadowMap){shadowMapTypeDefine = 'SHADOWMAP_TYPE_PCF_SOFT';}var envMapTypeDefine='ENVMAP_TYPE_CUBE';var envMapModeDefine='ENVMAP_MODE_REFLECTION';var envMapBlendingDefine='ENVMAP_BLENDING_MULTIPLY';if(parameters.envMap){switch(material.envMap.mapping){case THREE.CubeReflectionMapping:case THREE.CubeRefractionMapping:envMapTypeDefine = 'ENVMAP_TYPE_CUBE';break;case THREE.EquirectangularReflectionMapping:case THREE.EquirectangularRefractionMapping:envMapTypeDefine = 'ENVMAP_TYPE_EQUIREC';break;case THREE.SphericalReflectionMapping:envMapTypeDefine = 'ENVMAP_TYPE_SPHERE';break;}switch(material.envMap.mapping){case THREE.CubeRefractionMapping:case THREE.EquirectangularRefractionMapping:envMapModeDefine = 'ENVMAP_MODE_REFRACTION';break;}switch(material.combine){case THREE.MultiplyOperation:envMapBlendingDefine = 'ENVMAP_BLENDING_MULTIPLY';break;case THREE.MixOperation:envMapBlendingDefine = 'ENVMAP_BLENDING_MIX';break;case THREE.AddOperation:envMapBlendingDefine = 'ENVMAP_BLENDING_ADD';break;}}var gammaFactorDefine=renderer.gammaFactor > 0?renderer.gammaFactor:1.0; // console.log( 'building new program ' );\n\t//\n\tvar customDefines=generateDefines(defines); //\n\tvar program=gl.createProgram();var prefixVertex,prefixFragment;if(material instanceof THREE.RawShaderMaterial){prefixVertex = '';prefixFragment = '';}else {prefixVertex = ['precision ' + parameters.precision + ' float;','precision ' + parameters.precision + ' int;','#define SHADER_NAME ' + material.__webglShader.name,customDefines,parameters.supportsVertexTextures?'#define VERTEX_TEXTURES':'',renderer.gammaInput?'#define GAMMA_INPUT':'',renderer.gammaOutput?'#define GAMMA_OUTPUT':'','#define GAMMA_FACTOR ' + gammaFactorDefine,'#define MAX_DIR_LIGHTS ' + parameters.maxDirLights,'#define MAX_POINT_LIGHTS ' + parameters.maxPointLights,'#define MAX_SPOT_LIGHTS ' + parameters.maxSpotLights,'#define MAX_HEMI_LIGHTS ' + parameters.maxHemiLights,'#define MAX_SHADOWS ' + parameters.maxShadows,'#define MAX_BONES ' + parameters.maxBones,parameters.map?'#define USE_MAP':'',parameters.envMap?'#define USE_ENVMAP':'',parameters.envMap?'#define ' + envMapModeDefine:'',parameters.lightMap?'#define USE_LIGHTMAP':'',parameters.aoMap?'#define USE_AOMAP':'',parameters.emissiveMap?'#define USE_EMISSIVEMAP':'',parameters.bumpMap?'#define USE_BUMPMAP':'',parameters.normalMap?'#define USE_NORMALMAP':'',parameters.displacementMap && parameters.supportsVertexTextures?'#define USE_DISPLACEMENTMAP':'',parameters.specularMap?'#define USE_SPECULARMAP':'',parameters.alphaMap?'#define USE_ALPHAMAP':'',parameters.vertexColors?'#define USE_COLOR':'',parameters.flatShading?'#define FLAT_SHADED':'',parameters.skinning?'#define USE_SKINNING':'',parameters.useVertexTexture?'#define BONE_TEXTURE':'',parameters.morphTargets?'#define USE_MORPHTARGETS':'',parameters.morphNormals && parameters.flatShading === false?'#define USE_MORPHNORMALS':'',parameters.doubleSided?'#define DOUBLE_SIDED':'',parameters.flipSided?'#define FLIP_SIDED':'',parameters.shadowMapEnabled?'#define USE_SHADOWMAP':'',parameters.shadowMapEnabled?'#define ' + shadowMapTypeDefine:'',parameters.shadowMapDebug?'#define SHADOWMAP_DEBUG':'',parameters.sizeAttenuation?'#define USE_SIZEATTENUATION':'',parameters.logarithmicDepthBuffer?'#define USE_LOGDEPTHBUF':'',parameters.logarithmicDepthBuffer && renderer.extensions.get('EXT_frag_depth')?'#define USE_LOGDEPTHBUF_EXT':'','uniform mat4 modelMatrix;','uniform mat4 modelViewMatrix;','uniform mat4 projectionMatrix;','uniform mat4 viewMatrix;','uniform mat3 normalMatrix;','uniform vec3 cameraPosition;','attribute vec3 position;','attribute vec3 normal;','attribute vec2 uv;','#ifdef USE_COLOR','\tattribute vec3 color;','#endif','#ifdef USE_MORPHTARGETS','\tattribute vec3 morphTarget0;','\tattribute vec3 morphTarget1;','\tattribute vec3 morphTarget2;','\tattribute vec3 morphTarget3;','\t#ifdef USE_MORPHNORMALS','\t\tattribute vec3 morphNormal0;','\t\tattribute vec3 morphNormal1;','\t\tattribute vec3 morphNormal2;','\t\tattribute vec3 morphNormal3;','\t#else','\t\tattribute vec3 morphTarget4;','\t\tattribute vec3 morphTarget5;','\t\tattribute vec3 morphTarget6;','\t\tattribute vec3 morphTarget7;','\t#endif','#endif','#ifdef USE_SKINNING','\tattribute vec4 skinIndex;','\tattribute vec4 skinWeight;','#endif','\\n'].filter(filterEmptyLine).join('\\n');prefixFragment = [parameters.bumpMap || parameters.normalMap || parameters.flatShading || material.derivatives?'#extension GL_OES_standard_derivatives : enable':'',parameters.logarithmicDepthBuffer && renderer.extensions.get('EXT_frag_depth')?'#extension GL_EXT_frag_depth : enable':'','precision ' + parameters.precision + ' float;','precision ' + parameters.precision + ' int;','#define SHADER_NAME ' + material.__webglShader.name,customDefines,'#define MAX_DIR_LIGHTS ' + parameters.maxDirLights,'#define MAX_POINT_LIGHTS ' + parameters.maxPointLights,'#define MAX_SPOT_LIGHTS ' + parameters.maxSpotLights,'#define MAX_HEMI_LIGHTS ' + parameters.maxHemiLights,'#define MAX_SHADOWS ' + parameters.maxShadows,parameters.alphaTest?'#define ALPHATEST ' + parameters.alphaTest:'',renderer.gammaInput?'#define GAMMA_INPUT':'',renderer.gammaOutput?'#define GAMMA_OUTPUT':'','#define GAMMA_FACTOR ' + gammaFactorDefine,parameters.useFog && parameters.fog?'#define USE_FOG':'',parameters.useFog && parameters.fogExp?'#define FOG_EXP2':'',parameters.map?'#define USE_MAP':'',parameters.envMap?'#define USE_ENVMAP':'',parameters.envMap?'#define ' + envMapTypeDefine:'',parameters.envMap?'#define ' + envMapModeDefine:'',parameters.envMap?'#define ' + envMapBlendingDefine:'',parameters.lightMap?'#define USE_LIGHTMAP':'',parameters.aoMap?'#define USE_AOMAP':'',parameters.emissiveMap?'#define USE_EMISSIVEMAP':'',parameters.bumpMap?'#define USE_BUMPMAP':'',parameters.normalMap?'#define USE_NORMALMAP':'',parameters.specularMap?'#define USE_SPECULARMAP':'',parameters.alphaMap?'#define USE_ALPHAMAP':'',parameters.vertexColors?'#define USE_COLOR':'',parameters.flatShading?'#define FLAT_SHADED':'',parameters.metal?'#define METAL':'',parameters.doubleSided?'#define DOUBLE_SIDED':'',parameters.flipSided?'#define FLIP_SIDED':'',parameters.shadowMapEnabled?'#define USE_SHADOWMAP':'',parameters.shadowMapEnabled?'#define ' + shadowMapTypeDefine:'',parameters.shadowMapDebug?'#define SHADOWMAP_DEBUG':'',parameters.logarithmicDepthBuffer?'#define USE_LOGDEPTHBUF':'',parameters.logarithmicDepthBuffer && renderer.extensions.get('EXT_frag_depth')?'#define USE_LOGDEPTHBUF_EXT':'','uniform mat4 viewMatrix;','uniform vec3 cameraPosition;','\\n'].filter(filterEmptyLine).join('\\n');}var vertexGlsl=prefixVertex + vertexShader;var fragmentGlsl=prefixFragment + fragmentShader;var glVertexShader=THREE.WebGLShader(gl,gl.VERTEX_SHADER,vertexGlsl);var glFragmentShader=THREE.WebGLShader(gl,gl.FRAGMENT_SHADER,fragmentGlsl);gl.attachShader(program,glVertexShader);gl.attachShader(program,glFragmentShader); // Force a particular attribute to index 0.\n\tif(material.index0AttributeName !== undefined){gl.bindAttribLocation(program,0,material.index0AttributeName);}else if(parameters.morphTargets === true){ // programs with morphTargets displace position out of attribute 0\n\tgl.bindAttribLocation(program,0,'position');}gl.linkProgram(program);var programLog=gl.getProgramInfoLog(program);var vertexLog=gl.getShaderInfoLog(glVertexShader);var fragmentLog=gl.getShaderInfoLog(glFragmentShader);var runnable=true;var haveDiagnostics=true;if(gl.getProgramParameter(program,gl.LINK_STATUS) === false){runnable = false;console.error('THREE.WebGLProgram: shader error: ',gl.getError(),'gl.VALIDATE_STATUS',gl.getProgramParameter(program,gl.VALIDATE_STATUS),'gl.getProgramInfoLog',programLog,vertexLog,fragmentLog);}else if(programLog !== ''){console.warn('THREE.WebGLProgram: gl.getProgramInfoLog()',programLog);}else if(vertexLog === '' || fragmentLog === ''){haveDiagnostics = false;}if(haveDiagnostics){this.diagnostics = {runnable:runnable,material:material,programLog:programLog,vertexShader:{log:vertexLog,prefix:prefixVertex},fragmentShader:{log:fragmentLog,prefix:prefixFragment}};} // clean up\n\tgl.deleteShader(glVertexShader);gl.deleteShader(glFragmentShader); // set up caching for uniform locations\n\tvar cachedUniforms;this.getUniforms = function(){if(cachedUniforms === undefined){cachedUniforms = fetchUniformLocations(gl,program);}return cachedUniforms;}; // set up caching for attribute locations\n\tvar cachedAttributes;this.getAttributes = function(){if(cachedAttributes === undefined){cachedAttributes = fetchAttributeLocations(gl,program);}return cachedAttributes;}; // free resource\n\tthis.destroy = function(){gl.deleteProgram(program);this.program = undefined;}; // DEPRECATED\n\t_Object$defineProperties(this,{uniforms:{get:function get(){console.warn('THREE.WebGLProgram: .uniforms is now .getUniforms().');return this.getUniforms();}},attributes:{get:function get(){console.warn('THREE.WebGLProgram: .attributes is now .getAttributes().');return this.getAttributes();}}}); //\n\tthis.id = programIdCount++;this.code = code;this.usedTimes = 1;this.program = program;this.vertexShader = glVertexShader;this.fragmentShader = glFragmentShader;return this;};})(); // File:src/renderers/webgl/WebGLPrograms.js\n\tTHREE.WebGLPrograms = function(renderer,capabilities){var programs=[];var shaderIDs={MeshDepthMaterial:'depth',MeshNormalMaterial:'normal',MeshBasicMaterial:'basic',MeshLambertMaterial:'lambert',MeshPhongMaterial:'phong',LineBasicMaterial:'basic',LineDashedMaterial:'dashed',PointsMaterial:'points'};var parameterNames=[\"precision\",\"supportsVertexTextures\",\"map\",\"envMap\",\"envMapMode\",\"lightMap\",\"aoMap\",\"emissiveMap\",\"bumpMap\",\"normalMap\",\"specularMap\",\"alphaMap\",\"combine\",\"vertexColors\",\"fog\",\"useFog\",\"fogExp\",\"flatShading\",\"sizeAttenuation\",\"logarithmicDepthBuffer\",\"skinning\",\"maxBones\",\"useVertexTexture\",\"morphTargets\",\"morphNormals\",\"maxMorphTargets\",\"maxMorphNormals\",\"maxDirLights\",\"maxPointLights\",\"maxSpotLights\",\"maxHemiLights\",\"maxShadows\",\"shadowMapEnabled\",\"shadowMapType\",\"shadowMapDebug\",\"alphaTest\",\"metal\",\"doubleSided\",\"flipSided\"];function allocateBones(object){if(capabilities.floatVertexTextures && object && object.skeleton && object.skeleton.useVertexTexture){return 1024;}else { // default for when object is not specified\n\t// ( for example when prebuilding shader to be used with multiple objects )\n\t//\n\t//  - leave some extra space for other uniforms\n\t//  - limit here is ANGLE's 254 max uniform vectors\n\t//    (up to 54 should be safe)\n\tvar nVertexUniforms=capabilities.maxVertexUniforms;var nVertexMatrices=Math.floor((nVertexUniforms - 20) / 4);var maxBones=nVertexMatrices;if(object !== undefined && object instanceof THREE.SkinnedMesh){maxBones = Math.min(object.skeleton.bones.length,maxBones);if(maxBones < object.skeleton.bones.length){console.warn('WebGLRenderer: too many bones - ' + object.skeleton.bones.length + ', this GPU supports just ' + maxBones + ' (try OpenGL instead of ANGLE)');}}return maxBones;}}function allocateLights(lights){var dirLights=0;var pointLights=0;var spotLights=0;var hemiLights=0;for(var l=0,ll=lights.length;l < ll;l++) {var light=lights[l];if(light.onlyShadow || light.visible === false)continue;if(light instanceof THREE.DirectionalLight)dirLights++;if(light instanceof THREE.PointLight)pointLights++;if(light instanceof THREE.SpotLight)spotLights++;if(light instanceof THREE.HemisphereLight)hemiLights++;}return {'directional':dirLights,'point':pointLights,'spot':spotLights,'hemi':hemiLights};}function allocateShadows(lights){var maxShadows=0;for(var l=0,ll=lights.length;l < ll;l++) {var light=lights[l];if(!light.castShadow)continue;if(light instanceof THREE.SpotLight)maxShadows++;if(light instanceof THREE.DirectionalLight)maxShadows++;}return maxShadows;}this.getParameters = function(material,lights,fog,object){var shaderID=shaderIDs[material.type]; // heuristics to create shader parameters according to lights in the scene\n\t// (not to blow over maxLights budget)\n\tvar maxLightCount=allocateLights(lights);var maxShadows=allocateShadows(lights);var maxBones=allocateBones(object);var precision=renderer.getPrecision();if(material.precision !== null){precision = capabilities.getMaxPrecision(material.precision);if(precision !== material.precision){console.warn('THREE.WebGLRenderer.initMaterial:',material.precision,'not supported, using',precision,'instead.');}}var parameters={shaderID:shaderID,precision:precision,supportsVertexTextures:capabilities.vertexTextures,map:!!material.map,envMap:!!material.envMap,envMapMode:material.envMap && material.envMap.mapping,lightMap:!!material.lightMap,aoMap:!!material.aoMap,emissiveMap:!!material.emissiveMap,bumpMap:!!material.bumpMap,normalMap:!!material.normalMap,displacementMap:!!material.displacementMap,specularMap:!!material.specularMap,alphaMap:!!material.alphaMap,combine:material.combine,vertexColors:material.vertexColors,fog:fog,useFog:material.fog,fogExp:fog instanceof THREE.FogExp2,flatShading:material.shading === THREE.FlatShading,sizeAttenuation:material.sizeAttenuation,logarithmicDepthBuffer:renderer.logarithmicDepthBuffer,skinning:material.skinning,maxBones:maxBones,useVertexTexture:capabilities.floatVertexTextures && object && object.skeleton && object.skeleton.useVertexTexture,morphTargets:material.morphTargets,morphNormals:material.morphNormals,maxMorphTargets:renderer.maxMorphTargets,maxMorphNormals:renderer.maxMorphNormals,maxDirLights:maxLightCount.directional,maxPointLights:maxLightCount.point,maxSpotLights:maxLightCount.spot,maxHemiLights:maxLightCount.hemi,maxShadows:maxShadows,shadowMapEnabled:renderer.shadowMap.enabled && object.receiveShadow && maxShadows > 0,shadowMapType:renderer.shadowMap.type,shadowMapDebug:renderer.shadowMap.debug,alphaTest:material.alphaTest,metal:material.metal,doubleSided:material.side === THREE.DoubleSide,flipSided:material.side === THREE.BackSide};return parameters;};this.getProgramCode = function(material,parameters){var chunks=[];if(parameters.shaderID){chunks.push(parameters.shaderID);}else {chunks.push(material.fragmentShader);chunks.push(material.vertexShader);}if(material.defines !== undefined){for(var name in material.defines) {chunks.push(name);chunks.push(material.defines[name]);}}for(var i=0;i < parameterNames.length;i++) {var parameterName=parameterNames[i];chunks.push(parameterName);chunks.push(parameters[parameterName]);}return chunks.join();};this.acquireProgram = function(material,parameters,code){var program; // Check if code has been already compiled\n\tfor(var p=0,pl=programs.length;p < pl;p++) {var programInfo=programs[p];if(programInfo.code === code){program = programInfo;++program.usedTimes;break;}}if(program === undefined){program = new THREE.WebGLProgram(renderer,code,material,parameters);programs.push(program);}return program;};this.releaseProgram = function(program){if(--program.usedTimes === 0){ // Remove from unordered set\n\tvar i=programs.indexOf(program);programs[i] = programs[programs.length - 1];programs.pop(); // Free WebGL resources\n\tprogram.destroy();}}; // Exposed for resource monitoring & error feedback via renderer.info:\n\tthis.programs = programs;}; // File:src/renderers/webgl/WebGLProperties.js\n\t/**\n\t* @author fordacious / fordacious.github.io\n\t*/THREE.WebGLProperties = function(){var properties={};this.get = function(object){var uuid=object.uuid;var map=properties[uuid];if(map === undefined){map = {};properties[uuid] = map;}return map;};this['delete'] = function(object){delete properties[object.uuid];};this.clear = function(){properties = {};};}; // File:src/renderers/webgl/WebGLShader.js\n\tTHREE.WebGLShader = (function(){var addLineNumbers=function addLineNumbers(string){var lines=string.split('\\n');for(var i=0;i < lines.length;i++) {lines[i] = i + 1 + ': ' + lines[i];}return lines.join('\\n');};return function WebGLShader(gl,type,string){var shader=gl.createShader(type);gl.shaderSource(shader,string);gl.compileShader(shader);if(gl.getShaderParameter(shader,gl.COMPILE_STATUS) === false){console.error('THREE.WebGLShader: Shader couldn\\'t compile.');}if(gl.getShaderInfoLog(shader) !== ''){console.warn('THREE.WebGLShader: gl.getShaderInfoLog()',type === gl.VERTEX_SHADER?'vertex':'fragment',gl.getShaderInfoLog(shader),addLineNumbers(string));} // --enable-privileged-webgl-extension\n\t// console.log( type, gl.getExtension( 'WEBGL_debug_shaders' ).getTranslatedShaderSource( shader ) );\n\treturn shader;};})(); // File:src/renderers/webgl/WebGLShadowMap.js\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author mrdoob / http://mrdoob.com/\n\t */THREE.WebGLShadowMap = function(_renderer,_lights,_objects){var _gl=_renderer.context,_state=_renderer.state,_frustum=new THREE.Frustum(),_projScreenMatrix=new THREE.Matrix4(),_min=new THREE.Vector3(),_max=new THREE.Vector3(),_matrixPosition=new THREE.Vector3(),_renderList=[]; // init\n\tvar depthShader=THREE.ShaderLib[\"depthRGBA\"];var depthUniforms=THREE.UniformsUtils.clone(depthShader.uniforms);var _depthMaterial=new THREE.ShaderMaterial({uniforms:depthUniforms,vertexShader:depthShader.vertexShader,fragmentShader:depthShader.fragmentShader});var _depthMaterialMorph=new THREE.ShaderMaterial({uniforms:depthUniforms,vertexShader:depthShader.vertexShader,fragmentShader:depthShader.fragmentShader,morphTargets:true});var _depthMaterialSkin=new THREE.ShaderMaterial({uniforms:depthUniforms,vertexShader:depthShader.vertexShader,fragmentShader:depthShader.fragmentShader,skinning:true});var _depthMaterialMorphSkin=new THREE.ShaderMaterial({uniforms:depthUniforms,vertexShader:depthShader.vertexShader,fragmentShader:depthShader.fragmentShader,morphTargets:true,skinning:true});_depthMaterial._shadowPass = true;_depthMaterialMorph._shadowPass = true;_depthMaterialSkin._shadowPass = true;_depthMaterialMorphSkin._shadowPass = true; //\n\tvar scope=this;this.enabled = false;this.autoUpdate = true;this.needsUpdate = false;this.type = THREE.PCFShadowMap;this.cullFace = THREE.CullFaceFront;this.render = function(scene,camera){if(scope.enabled === false)return;if(scope.autoUpdate === false && scope.needsUpdate === false)return; // set GL state for depth map\n\t_gl.clearColor(1,1,1,1);_state.disable(_gl.BLEND);_state.enable(_gl.CULL_FACE);_gl.frontFace(_gl.CCW);if(scope.cullFace === THREE.CullFaceFront){_gl.cullFace(_gl.FRONT);}else {_gl.cullFace(_gl.BACK);}_state.setDepthTest(true); // render depth map\n\tfor(var i=0,il=_lights.length;i < il;i++) {var light=_lights[i];if(!light.castShadow)continue;if(!light.shadowMap){var shadowFilter=THREE.LinearFilter;if(scope.type === THREE.PCFSoftShadowMap){shadowFilter = THREE.NearestFilter;}var pars={minFilter:shadowFilter,magFilter:shadowFilter,format:THREE.RGBAFormat};light.shadowMap = new THREE.WebGLRenderTarget(light.shadowMapWidth,light.shadowMapHeight,pars);light.shadowMapSize = new THREE.Vector2(light.shadowMapWidth,light.shadowMapHeight);light.shadowMatrix = new THREE.Matrix4();}if(!light.shadowCamera){if(light instanceof THREE.SpotLight){light.shadowCamera = new THREE.PerspectiveCamera(light.shadowCameraFov,light.shadowMapWidth / light.shadowMapHeight,light.shadowCameraNear,light.shadowCameraFar);}else if(light instanceof THREE.DirectionalLight){light.shadowCamera = new THREE.OrthographicCamera(light.shadowCameraLeft,light.shadowCameraRight,light.shadowCameraTop,light.shadowCameraBottom,light.shadowCameraNear,light.shadowCameraFar);}else {console.error(\"THREE.ShadowMapPlugin: Unsupported light type for shadow\",light);continue;}scene.add(light.shadowCamera);if(scene.autoUpdate === true)scene.updateMatrixWorld();}if(light.shadowCameraVisible && !light.cameraHelper){light.cameraHelper = new THREE.CameraHelper(light.shadowCamera);scene.add(light.cameraHelper);}var shadowMap=light.shadowMap;var shadowMatrix=light.shadowMatrix;var shadowCamera=light.shadowCamera; //\n\tshadowCamera.position.setFromMatrixPosition(light.matrixWorld);_matrixPosition.setFromMatrixPosition(light.target.matrixWorld);shadowCamera.lookAt(_matrixPosition);shadowCamera.updateMatrixWorld();shadowCamera.matrixWorldInverse.getInverse(shadowCamera.matrixWorld); //\n\tif(light.cameraHelper)light.cameraHelper.visible = light.shadowCameraVisible;if(light.shadowCameraVisible)light.cameraHelper.update(); // compute shadow matrix\n\tshadowMatrix.set(0.5,0.0,0.0,0.5,0.0,0.5,0.0,0.5,0.0,0.0,0.5,0.5,0.0,0.0,0.0,1.0);shadowMatrix.multiply(shadowCamera.projectionMatrix);shadowMatrix.multiply(shadowCamera.matrixWorldInverse); // update camera matrices and frustum\n\t_projScreenMatrix.multiplyMatrices(shadowCamera.projectionMatrix,shadowCamera.matrixWorldInverse);_frustum.setFromMatrix(_projScreenMatrix); // render shadow map\n\t_renderer.setRenderTarget(shadowMap);_renderer.clear(); // set object matrices & frustum culling\n\t_renderList.length = 0;projectObject(scene,shadowCamera); // render regular objects\n\tfor(var j=0,jl=_renderList.length;j < jl;j++) {var object=_renderList[j];var geometry=_objects.update(object);var material=object.material;if(material instanceof THREE.MeshFaceMaterial){var groups=geometry.groups;var materials=material.materials;for(var k=0,kl=groups.length;k < kl;k++) {var group=groups[k];var groupMaterial=materials[group.materialIndex];if(groupMaterial.visible === true){_renderer.renderBufferDirect(shadowCamera,_lights,null,geometry,getDepthMaterial(object,groupMaterial),object,group);}}}else {_renderer.renderBufferDirect(shadowCamera,_lights,null,geometry,getDepthMaterial(object,material),object);}}} // restore GL state\n\tvar clearColor=_renderer.getClearColor(),clearAlpha=_renderer.getClearAlpha();_renderer.setClearColor(clearColor,clearAlpha);_state.enable(_gl.BLEND);if(scope.cullFace === THREE.CullFaceFront){_gl.cullFace(_gl.BACK);}_renderer.resetGLState();scope.needsUpdate = false;};function getDepthMaterial(object,material){var geometry=object.geometry;var useMorphing=geometry.morphTargets !== undefined && geometry.morphTargets.length > 0 && material.morphTargets;var useSkinning=object instanceof THREE.SkinnedMesh && material.skinning;var depthMaterial;if(object.customDepthMaterial){depthMaterial = object.customDepthMaterial;}else if(useSkinning){depthMaterial = useMorphing?_depthMaterialMorphSkin:_depthMaterialSkin;}else if(useMorphing){depthMaterial = _depthMaterialMorph;}else {depthMaterial = _depthMaterial;}depthMaterial.visible = material.visible;depthMaterial.wireframe = material.wireframe;depthMaterial.wireframeLinewidth = material.wireframeLinewidth;return depthMaterial;}function projectObject(object,camera){if(object.visible === false)return;if(object instanceof THREE.Mesh || object instanceof THREE.Line || object instanceof THREE.Points){if(object.castShadow && (object.frustumCulled === false || _frustum.intersectsObject(object) === true)){var material=object.material;if(material.visible === true){object.modelViewMatrix.multiplyMatrices(camera.matrixWorldInverse,object.matrixWorld);_renderList.push(object);}}}var children=object.children;for(var i=0,l=children.length;i < l;i++) {projectObject(children[i],camera);}}}; // File:src/renderers/webgl/WebGLState.js\n\t/**\n\t* @author mrdoob / http://mrdoob.com/\n\t*/THREE.WebGLState = function(gl,extensions,paramThreeToGL){var _this=this;var newAttributes=new Uint8Array(16);var enabledAttributes=new Uint8Array(16);var capabilities={};var compressedTextureFormats=null;var currentBlending=null;var currentBlendEquation=null;var currentBlendSrc=null;var currentBlendDst=null;var currentBlendEquationAlpha=null;var currentBlendSrcAlpha=null;var currentBlendDstAlpha=null;var currentDepthFunc=null;var currentDepthWrite=null;var currentColorWrite=null;var currentFlipSided=null;var currentLineWidth=null;var currentPolygonOffsetFactor=null;var currentPolygonOffsetUnits=null;var maxTextures=gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS);var currentTextureSlot=undefined;var currentBoundTextures={};this.init = function(){gl.clearColor(0,0,0,1);gl.clearDepth(1);gl.clearStencil(0);this.enable(gl.DEPTH_TEST);gl.depthFunc(gl.LEQUAL);gl.frontFace(gl.CCW);gl.cullFace(gl.BACK);this.enable(gl.CULL_FACE);this.enable(gl.BLEND);gl.blendEquation(gl.FUNC_ADD);gl.blendFunc(gl.SRC_ALPHA,gl.ONE_MINUS_SRC_ALPHA);};this.initAttributes = function(){for(var i=0,l=newAttributes.length;i < l;i++) {newAttributes[i] = 0;}};this.enableAttribute = function(attribute){newAttributes[attribute] = 1;if(enabledAttributes[attribute] === 0){gl.enableVertexAttribArray(attribute);enabledAttributes[attribute] = 1;}};this.disableUnusedAttributes = function(){for(var i=0,l=enabledAttributes.length;i < l;i++) {if(enabledAttributes[i] !== newAttributes[i]){gl.disableVertexAttribArray(i);enabledAttributes[i] = 0;}}};this.enable = function(id){if(capabilities[id] !== true){gl.enable(id);capabilities[id] = true;}};this.disable = function(id){if(capabilities[id] !== false){gl.disable(id);capabilities[id] = false;}};this.getCompressedTextureFormats = function(){if(compressedTextureFormats === null){compressedTextureFormats = [];if(extensions.get('WEBGL_compressed_texture_pvrtc') || extensions.get('WEBGL_compressed_texture_s3tc')){var formats=gl.getParameter(gl.COMPRESSED_TEXTURE_FORMATS);for(var i=0;i < formats.length;i++) {compressedTextureFormats.push(formats[i]);}}}return compressedTextureFormats;};this.setBlending = function(blending,blendEquation,blendSrc,blendDst,blendEquationAlpha,blendSrcAlpha,blendDstAlpha){if(blending !== currentBlending){if(blending === THREE.NoBlending){this.disable(gl.BLEND);}else if(blending === THREE.AdditiveBlending){this.enable(gl.BLEND);gl.blendEquation(gl.FUNC_ADD);gl.blendFunc(gl.SRC_ALPHA,gl.ONE);}else if(blending === THREE.SubtractiveBlending){ // TODO: Find blendFuncSeparate() combination\n\tthis.enable(gl.BLEND);gl.blendEquation(gl.FUNC_ADD);gl.blendFunc(gl.ZERO,gl.ONE_MINUS_SRC_COLOR);}else if(blending === THREE.MultiplyBlending){ // TODO: Find blendFuncSeparate() combination\n\tthis.enable(gl.BLEND);gl.blendEquation(gl.FUNC_ADD);gl.blendFunc(gl.ZERO,gl.SRC_COLOR);}else if(blending === THREE.CustomBlending){this.enable(gl.BLEND);}else {this.enable(gl.BLEND);gl.blendEquationSeparate(gl.FUNC_ADD,gl.FUNC_ADD);gl.blendFuncSeparate(gl.SRC_ALPHA,gl.ONE_MINUS_SRC_ALPHA,gl.ONE,gl.ONE_MINUS_SRC_ALPHA);}currentBlending = blending;}if(blending === THREE.CustomBlending){blendEquationAlpha = blendEquationAlpha || blendEquation;blendSrcAlpha = blendSrcAlpha || blendSrc;blendDstAlpha = blendDstAlpha || blendDst;if(blendEquation !== currentBlendEquation || blendEquationAlpha !== currentBlendEquationAlpha){gl.blendEquationSeparate(paramThreeToGL(blendEquation),paramThreeToGL(blendEquationAlpha));currentBlendEquation = blendEquation;currentBlendEquationAlpha = blendEquationAlpha;}if(blendSrc !== currentBlendSrc || blendDst !== currentBlendDst || blendSrcAlpha !== currentBlendSrcAlpha || blendDstAlpha !== currentBlendDstAlpha){gl.blendFuncSeparate(paramThreeToGL(blendSrc),paramThreeToGL(blendDst),paramThreeToGL(blendSrcAlpha),paramThreeToGL(blendDstAlpha));currentBlendSrc = blendSrc;currentBlendDst = blendDst;currentBlendSrcAlpha = blendSrcAlpha;currentBlendDstAlpha = blendDstAlpha;}}else {currentBlendEquation = null;currentBlendSrc = null;currentBlendDst = null;currentBlendEquationAlpha = null;currentBlendSrcAlpha = null;currentBlendDstAlpha = null;}};this.setDepthFunc = function(depthFunc){if(currentDepthFunc !== depthFunc){if(depthFunc){switch(depthFunc){case THREE.NeverDepth:gl.depthFunc(gl.NEVER);break;case THREE.AlwaysDepth:gl.depthFunc(gl.ALWAYS);break;case THREE.LessDepth:gl.depthFunc(gl.LESS);break;case THREE.LessEqualDepth:gl.depthFunc(gl.LEQUAL);break;case THREE.EqualDepth:gl.depthFunc(gl.EQUAL);break;case THREE.GreaterEqualDepth:gl.depthFunc(gl.GEQUAL);break;case THREE.GreaterDepth:gl.depthFunc(gl.GREATER);break;case THREE.NotEqualDepth:gl.depthFunc(gl.NOTEQUAL);break;default:gl.depthFunc(gl.LEQUAL);}}else {gl.depthFunc(gl.LEQUAL);}currentDepthFunc = depthFunc;}};this.setDepthTest = function(depthTest){if(depthTest){this.enable(gl.DEPTH_TEST);}else {this.disable(gl.DEPTH_TEST);}};this.setDepthWrite = function(depthWrite){if(currentDepthWrite !== depthWrite){gl.depthMask(depthWrite);currentDepthWrite = depthWrite;}};this.setColorWrite = function(colorWrite){if(currentColorWrite !== colorWrite){gl.colorMask(colorWrite,colorWrite,colorWrite,colorWrite);currentColorWrite = colorWrite;}};this.setFlipSided = function(flipSided){if(currentFlipSided !== flipSided){if(flipSided){gl.frontFace(gl.CW);}else {gl.frontFace(gl.CCW);}currentFlipSided = flipSided;}};this.setLineWidth = function(width){if(width !== currentLineWidth){gl.lineWidth(width);currentLineWidth = width;}};this.setPolygonOffset = function(polygonOffset,factor,units){if(polygonOffset){this.enable(gl.POLYGON_OFFSET_FILL);}else {this.disable(gl.POLYGON_OFFSET_FILL);}if(polygonOffset && (currentPolygonOffsetFactor !== factor || currentPolygonOffsetUnits !== units)){gl.polygonOffset(factor,units);currentPolygonOffsetFactor = factor;currentPolygonOffsetUnits = units;}};this.setScissorTest = function(scissorTest){if(scissorTest){this.enable(gl.SCISSOR_TEST);}else {this.disable(gl.SCISSOR_TEST);}}; // texture\n\tthis.activeTexture = function(webglSlot){if(webglSlot === undefined)webglSlot = gl.TEXTURE0 + maxTextures - 1;if(currentTextureSlot !== webglSlot){gl.activeTexture(webglSlot);currentTextureSlot = webglSlot;}};this.bindTexture = function(webglType,webglTexture){if(currentTextureSlot === undefined){_this.activeTexture();}var boundTexture=currentBoundTextures[currentTextureSlot];if(boundTexture === undefined){boundTexture = {type:undefined,texture:undefined};currentBoundTextures[currentTextureSlot] = boundTexture;}if(boundTexture.type !== webglType || boundTexture.texture !== webglTexture){gl.bindTexture(webglType,webglTexture);boundTexture.type = webglType;boundTexture.texture = webglTexture;}};this.compressedTexImage2D = function(){try{gl.compressedTexImage2D.apply(gl,arguments);}catch(error) {console.error(error);}};this.texImage2D = function(){try{gl.texImage2D.apply(gl,arguments);}catch(error) {console.error(error);}}; //\n\tthis.reset = function(){for(var i=0;i < enabledAttributes.length;i++) {if(enabledAttributes[i] === 1){gl.disableVertexAttribArray(i);enabledAttributes[i] = 0;}}capabilities = {};compressedTextureFormats = null;currentBlending = null;currentDepthWrite = null;currentColorWrite = null;currentFlipSided = null;};}; // File:src/renderers/webgl/plugins/LensFlarePlugin.js\n\t/**\n\t * @author mikael emtinger / http://gomo.se/\n\t * @author alteredq / http://alteredqualia.com/\n\t */THREE.LensFlarePlugin = function(renderer,flares){var gl=renderer.context;var state=renderer.state;var vertexBuffer,elementBuffer;var program,attributes,uniforms;var hasVertexTexture;var tempTexture,occlusionTexture;var init=function init(){var vertices=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]);var faces=new Uint16Array([0,1,2,0,2,3]); // buffers\n\tvertexBuffer = gl.createBuffer();elementBuffer = gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,vertexBuffer);gl.bufferData(gl.ARRAY_BUFFER,vertices,gl.STATIC_DRAW);gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,elementBuffer);gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,faces,gl.STATIC_DRAW); // textures\n\ttempTexture = gl.createTexture();occlusionTexture = gl.createTexture();state.bindTexture(gl.TEXTURE_2D,tempTexture);gl.texImage2D(gl.TEXTURE_2D,0,gl.RGB,16,16,0,gl.RGB,gl.UNSIGNED_BYTE,null);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.NEAREST);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.NEAREST);state.bindTexture(gl.TEXTURE_2D,occlusionTexture);gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,16,16,0,gl.RGBA,gl.UNSIGNED_BYTE,null);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.NEAREST);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.NEAREST);hasVertexTexture = gl.getParameter(gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS) > 0;var shader;if(hasVertexTexture){shader = {vertexShader:[\"uniform lowp int renderType;\",\"uniform vec3 screenPosition;\",\"uniform vec2 scale;\",\"uniform float rotation;\",\"uniform sampler2D occlusionMap;\",\"attribute vec2 position;\",\"attribute vec2 uv;\",\"varying vec2 vUV;\",\"varying float vVisibility;\",\"void main() {\",\"vUV = uv;\",\"vec2 pos = position;\",\"if( renderType == 2 ) {\",\"vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );\",\"visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );\",\"visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );\",\"visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );\",\"visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );\",\"visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );\",\"visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );\",\"visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );\",\"visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );\",\"vVisibility =        visibility.r / 9.0;\",\"vVisibility *= 1.0 - visibility.g / 9.0;\",\"vVisibility *=       visibility.b / 9.0;\",\"vVisibility *= 1.0 - visibility.a / 9.0;\",\"pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\",\"pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\",\"}\",\"gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\",\"}\"].join(\"\\n\"),fragmentShader:[\"uniform lowp int renderType;\",\"uniform sampler2D map;\",\"uniform float opacity;\",\"uniform vec3 color;\",\"varying vec2 vUV;\",\"varying float vVisibility;\",\"void main() {\", // pink square\n\t\"if( renderType == 0 ) {\",\"gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\", // restore\n\t\"} else if( renderType == 1 ) {\",\"gl_FragColor = texture2D( map, vUV );\", // flare\n\t\"} else {\",\"vec4 texture = texture2D( map, vUV );\",\"texture.a *= opacity * vVisibility;\",\"gl_FragColor = texture;\",\"gl_FragColor.rgb *= color;\",\"}\",\"}\"].join(\"\\n\")};}else {shader = {vertexShader:[\"uniform lowp int renderType;\",\"uniform vec3 screenPosition;\",\"uniform vec2 scale;\",\"uniform float rotation;\",\"attribute vec2 position;\",\"attribute vec2 uv;\",\"varying vec2 vUV;\",\"void main() {\",\"vUV = uv;\",\"vec2 pos = position;\",\"if( renderType == 2 ) {\",\"pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\",\"pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\",\"}\",\"gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\",\"}\"].join(\"\\n\"),fragmentShader:[\"precision mediump float;\",\"uniform lowp int renderType;\",\"uniform sampler2D map;\",\"uniform sampler2D occlusionMap;\",\"uniform float opacity;\",\"uniform vec3 color;\",\"varying vec2 vUV;\",\"void main() {\", // pink square\n\t\"if( renderType == 0 ) {\",\"gl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );\", // restore\n\t\"} else if( renderType == 1 ) {\",\"gl_FragColor = texture2D( map, vUV );\", // flare\n\t\"} else {\",\"float visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a;\",\"visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a;\",\"visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a;\",\"visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;\",\"visibility = ( 1.0 - visibility / 4.0 );\",\"vec4 texture = texture2D( map, vUV );\",\"texture.a *= opacity * visibility;\",\"gl_FragColor = texture;\",\"gl_FragColor.rgb *= color;\",\"}\",\"}\"].join(\"\\n\")};}program = createProgram(shader);attributes = {vertex:gl.getAttribLocation(program,\"position\"),uv:gl.getAttribLocation(program,\"uv\")};uniforms = {renderType:gl.getUniformLocation(program,\"renderType\"),map:gl.getUniformLocation(program,\"map\"),occlusionMap:gl.getUniformLocation(program,\"occlusionMap\"),opacity:gl.getUniformLocation(program,\"opacity\"),color:gl.getUniformLocation(program,\"color\"),scale:gl.getUniformLocation(program,\"scale\"),rotation:gl.getUniformLocation(program,\"rotation\"),screenPosition:gl.getUniformLocation(program,\"screenPosition\")};}; /*\n\t\t * Render lens flares\n\t\t * Method: renders 16x16 0xff00ff-colored points scattered over the light source area,\n\t\t *         reads these back and calculates occlusion.\n\t\t */this.render = function(scene,camera,viewportWidth,viewportHeight){if(flares.length === 0)return;var tempPosition=new THREE.Vector3();var invAspect=viewportHeight / viewportWidth,halfViewportWidth=viewportWidth * 0.5,halfViewportHeight=viewportHeight * 0.5;var size=16 / viewportHeight,scale=new THREE.Vector2(size * invAspect,size);var screenPosition=new THREE.Vector3(1,1,0),screenPositionPixels=new THREE.Vector2(1,1);if(program === undefined){init();}gl.useProgram(program);state.initAttributes();state.enableAttribute(attributes.vertex);state.enableAttribute(attributes.uv);state.disableUnusedAttributes(); // loop through all lens flares to update their occlusion and positions\n\t// setup gl and common used attribs/uniforms\n\tgl.uniform1i(uniforms.occlusionMap,0);gl.uniform1i(uniforms.map,1);gl.bindBuffer(gl.ARRAY_BUFFER,vertexBuffer);gl.vertexAttribPointer(attributes.vertex,2,gl.FLOAT,false,2 * 8,0);gl.vertexAttribPointer(attributes.uv,2,gl.FLOAT,false,2 * 8,8);gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,elementBuffer);state.disable(gl.CULL_FACE);gl.depthMask(false);for(var i=0,l=flares.length;i < l;i++) {size = 16 / viewportHeight;scale.set(size * invAspect,size); // calc object screen position\n\tvar flare=flares[i];tempPosition.set(flare.matrixWorld.elements[12],flare.matrixWorld.elements[13],flare.matrixWorld.elements[14]);tempPosition.applyMatrix4(camera.matrixWorldInverse);tempPosition.applyProjection(camera.projectionMatrix); // setup arrays for gl programs\n\tscreenPosition.copy(tempPosition);screenPositionPixels.x = screenPosition.x * halfViewportWidth + halfViewportWidth;screenPositionPixels.y = screenPosition.y * halfViewportHeight + halfViewportHeight; // screen cull\n\tif(hasVertexTexture || screenPositionPixels.x > 0 && screenPositionPixels.x < viewportWidth && screenPositionPixels.y > 0 && screenPositionPixels.y < viewportHeight){ // save current RGB to temp texture\n\tstate.activeTexture(gl.TEXTURE0);state.bindTexture(gl.TEXTURE_2D,null);state.activeTexture(gl.TEXTURE1);state.bindTexture(gl.TEXTURE_2D,tempTexture);gl.copyTexImage2D(gl.TEXTURE_2D,0,gl.RGB,screenPositionPixels.x - 8,screenPositionPixels.y - 8,16,16,0); // render pink quad\n\tgl.uniform1i(uniforms.renderType,0);gl.uniform2f(uniforms.scale,scale.x,scale.y);gl.uniform3f(uniforms.screenPosition,screenPosition.x,screenPosition.y,screenPosition.z);state.disable(gl.BLEND);state.enable(gl.DEPTH_TEST);gl.drawElements(gl.TRIANGLES,6,gl.UNSIGNED_SHORT,0); // copy result to occlusionMap\n\tstate.activeTexture(gl.TEXTURE0);state.bindTexture(gl.TEXTURE_2D,occlusionTexture);gl.copyTexImage2D(gl.TEXTURE_2D,0,gl.RGBA,screenPositionPixels.x - 8,screenPositionPixels.y - 8,16,16,0); // restore graphics\n\tgl.uniform1i(uniforms.renderType,1);state.disable(gl.DEPTH_TEST);state.activeTexture(gl.TEXTURE1);state.bindTexture(gl.TEXTURE_2D,tempTexture);gl.drawElements(gl.TRIANGLES,6,gl.UNSIGNED_SHORT,0); // update object positions\n\tflare.positionScreen.copy(screenPosition);if(flare.customUpdateCallback){flare.customUpdateCallback(flare);}else {flare.updateLensFlares();} // render flares\n\tgl.uniform1i(uniforms.renderType,2);state.enable(gl.BLEND);for(var j=0,jl=flare.lensFlares.length;j < jl;j++) {var sprite=flare.lensFlares[j];if(sprite.opacity > 0.001 && sprite.scale > 0.001){screenPosition.x = sprite.x;screenPosition.y = sprite.y;screenPosition.z = sprite.z;size = sprite.size * sprite.scale / viewportHeight;scale.x = size * invAspect;scale.y = size;gl.uniform3f(uniforms.screenPosition,screenPosition.x,screenPosition.y,screenPosition.z);gl.uniform2f(uniforms.scale,scale.x,scale.y);gl.uniform1f(uniforms.rotation,sprite.rotation);gl.uniform1f(uniforms.opacity,sprite.opacity);gl.uniform3f(uniforms.color,sprite.color.r,sprite.color.g,sprite.color.b);state.setBlending(sprite.blending,sprite.blendEquation,sprite.blendSrc,sprite.blendDst);renderer.setTexture(sprite.texture,1);gl.drawElements(gl.TRIANGLES,6,gl.UNSIGNED_SHORT,0);}}}} // restore gl\n\tstate.enable(gl.CULL_FACE);state.enable(gl.DEPTH_TEST);gl.depthMask(true);renderer.resetGLState();};function createProgram(shader){var program=gl.createProgram();var fragmentShader=gl.createShader(gl.FRAGMENT_SHADER);var vertexShader=gl.createShader(gl.VERTEX_SHADER);var prefix=\"precision \" + renderer.getPrecision() + \" float;\\n\";gl.shaderSource(fragmentShader,prefix + shader.fragmentShader);gl.shaderSource(vertexShader,prefix + shader.vertexShader);gl.compileShader(fragmentShader);gl.compileShader(vertexShader);gl.attachShader(program,fragmentShader);gl.attachShader(program,vertexShader);gl.linkProgram(program);return program;}}; // File:src/renderers/webgl/plugins/SpritePlugin.js\n\t/**\n\t * @author mikael emtinger / http://gomo.se/\n\t * @author alteredq / http://alteredqualia.com/\n\t */THREE.SpritePlugin = function(renderer,sprites){var gl=renderer.context;var state=renderer.state;var vertexBuffer,elementBuffer;var program,attributes,uniforms;var texture; // decompose matrixWorld\n\tvar spritePosition=new THREE.Vector3();var spriteRotation=new THREE.Quaternion();var spriteScale=new THREE.Vector3();var init=function init(){var vertices=new Float32Array([-0.5,-0.5,0,0,0.5,-0.5,1,0,0.5,0.5,1,1,-0.5,0.5,0,1]);var faces=new Uint16Array([0,1,2,0,2,3]);vertexBuffer = gl.createBuffer();elementBuffer = gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,vertexBuffer);gl.bufferData(gl.ARRAY_BUFFER,vertices,gl.STATIC_DRAW);gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,elementBuffer);gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,faces,gl.STATIC_DRAW);program = createProgram();attributes = {position:gl.getAttribLocation(program,'position'),uv:gl.getAttribLocation(program,'uv')};uniforms = {uvOffset:gl.getUniformLocation(program,'uvOffset'),uvScale:gl.getUniformLocation(program,'uvScale'),rotation:gl.getUniformLocation(program,'rotation'),scale:gl.getUniformLocation(program,'scale'),color:gl.getUniformLocation(program,'color'),map:gl.getUniformLocation(program,'map'),opacity:gl.getUniformLocation(program,'opacity'),modelViewMatrix:gl.getUniformLocation(program,'modelViewMatrix'),projectionMatrix:gl.getUniformLocation(program,'projectionMatrix'),fogType:gl.getUniformLocation(program,'fogType'),fogDensity:gl.getUniformLocation(program,'fogDensity'),fogNear:gl.getUniformLocation(program,'fogNear'),fogFar:gl.getUniformLocation(program,'fogFar'),fogColor:gl.getUniformLocation(program,'fogColor'),alphaTest:gl.getUniformLocation(program,'alphaTest')};var canvas=document.createElement('canvas');canvas.width = 8;canvas.height = 8;var context=canvas.getContext('2d');context.fillStyle = 'white';context.fillRect(0,0,8,8);texture = new THREE.Texture(canvas);texture.needsUpdate = true;};this.render = function(scene,camera){if(sprites.length === 0)return; // setup gl\n\tif(program === undefined){init();}gl.useProgram(program);state.initAttributes();state.enableAttribute(attributes.position);state.enableAttribute(attributes.uv);state.disableUnusedAttributes();state.disable(gl.CULL_FACE);state.enable(gl.BLEND);gl.bindBuffer(gl.ARRAY_BUFFER,vertexBuffer);gl.vertexAttribPointer(attributes.position,2,gl.FLOAT,false,2 * 8,0);gl.vertexAttribPointer(attributes.uv,2,gl.FLOAT,false,2 * 8,8);gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,elementBuffer);gl.uniformMatrix4fv(uniforms.projectionMatrix,false,camera.projectionMatrix.elements);state.activeTexture(gl.TEXTURE0);gl.uniform1i(uniforms.map,0);var oldFogType=0;var sceneFogType=0;var fog=scene.fog;if(fog){gl.uniform3f(uniforms.fogColor,fog.color.r,fog.color.g,fog.color.b);if(fog instanceof THREE.Fog){gl.uniform1f(uniforms.fogNear,fog.near);gl.uniform1f(uniforms.fogFar,fog.far);gl.uniform1i(uniforms.fogType,1);oldFogType = 1;sceneFogType = 1;}else if(fog instanceof THREE.FogExp2){gl.uniform1f(uniforms.fogDensity,fog.density);gl.uniform1i(uniforms.fogType,2);oldFogType = 2;sceneFogType = 2;}}else {gl.uniform1i(uniforms.fogType,0);oldFogType = 0;sceneFogType = 0;} // update positions and sort\n\tfor(var i=0,l=sprites.length;i < l;i++) {var sprite=sprites[i];sprite.modelViewMatrix.multiplyMatrices(camera.matrixWorldInverse,sprite.matrixWorld);sprite.z = -sprite.modelViewMatrix.elements[14];}sprites.sort(painterSortStable); // render all sprites\n\tvar scale=[];for(var i=0,l=sprites.length;i < l;i++) {var sprite=sprites[i];var material=sprite.material;gl.uniform1f(uniforms.alphaTest,material.alphaTest);gl.uniformMatrix4fv(uniforms.modelViewMatrix,false,sprite.modelViewMatrix.elements);sprite.matrixWorld.decompose(spritePosition,spriteRotation,spriteScale);scale[0] = spriteScale.x;scale[1] = spriteScale.y;var fogType=0;if(scene.fog && material.fog){fogType = sceneFogType;}if(oldFogType !== fogType){gl.uniform1i(uniforms.fogType,fogType);oldFogType = fogType;}if(material.map !== null){gl.uniform2f(uniforms.uvOffset,material.map.offset.x,material.map.offset.y);gl.uniform2f(uniforms.uvScale,material.map.repeat.x,material.map.repeat.y);}else {gl.uniform2f(uniforms.uvOffset,0,0);gl.uniform2f(uniforms.uvScale,1,1);}gl.uniform1f(uniforms.opacity,material.opacity);gl.uniform3f(uniforms.color,material.color.r,material.color.g,material.color.b);gl.uniform1f(uniforms.rotation,material.rotation);gl.uniform2fv(uniforms.scale,scale);state.setBlending(material.blending,material.blendEquation,material.blendSrc,material.blendDst);state.setDepthTest(material.depthTest);state.setDepthWrite(material.depthWrite);if(material.map && material.map.image && material.map.image.width){renderer.setTexture(material.map,0);}else {renderer.setTexture(texture,0);}gl.drawElements(gl.TRIANGLES,6,gl.UNSIGNED_SHORT,0);} // restore gl\n\tstate.enable(gl.CULL_FACE);renderer.resetGLState();};function createProgram(){var program=gl.createProgram();var vertexShader=gl.createShader(gl.VERTEX_SHADER);var fragmentShader=gl.createShader(gl.FRAGMENT_SHADER);gl.shaderSource(vertexShader,['precision ' + renderer.getPrecision() + ' float;','uniform mat4 modelViewMatrix;','uniform mat4 projectionMatrix;','uniform float rotation;','uniform vec2 scale;','uniform vec2 uvOffset;','uniform vec2 uvScale;','attribute vec2 position;','attribute vec2 uv;','varying vec2 vUV;','void main() {','vUV = uvOffset + uv * uvScale;','vec2 alignedPosition = position * scale;','vec2 rotatedPosition;','rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;','rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;','vec4 finalPosition;','finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );','finalPosition.xy += rotatedPosition;','finalPosition = projectionMatrix * finalPosition;','gl_Position = finalPosition;','}'].join('\\n'));gl.shaderSource(fragmentShader,['precision ' + renderer.getPrecision() + ' float;','uniform vec3 color;','uniform sampler2D map;','uniform float opacity;','uniform int fogType;','uniform vec3 fogColor;','uniform float fogDensity;','uniform float fogNear;','uniform float fogFar;','uniform float alphaTest;','varying vec2 vUV;','void main() {','vec4 texture = texture2D( map, vUV );','if ( texture.a < alphaTest ) discard;','gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );','if ( fogType > 0 ) {','float depth = gl_FragCoord.z / gl_FragCoord.w;','float fogFactor = 0.0;','if ( fogType == 1 ) {','fogFactor = smoothstep( fogNear, fogFar, depth );','} else {','const float LOG2 = 1.442695;','fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );','fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );','}','gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );','}','}'].join('\\n'));gl.compileShader(vertexShader);gl.compileShader(fragmentShader);gl.attachShader(program,vertexShader);gl.attachShader(program,fragmentShader);gl.linkProgram(program);return program;}function painterSortStable(a,b){if(a.z !== b.z){return b.z - a.z;}else {return b.id - a.id;}}}; // File:src/extras/GeometryUtils.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */THREE.GeometryUtils = {merge:function merge(geometry1,geometry2,materialIndexOffset){console.warn('THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.');var matrix;if(geometry2 instanceof THREE.Mesh){geometry2.matrixAutoUpdate && geometry2.updateMatrix();matrix = geometry2.matrix;geometry2 = geometry2.geometry;}geometry1.merge(geometry2,matrix,materialIndexOffset);},center:function center(geometry){console.warn('THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead.');return geometry.center();}}; // File:src/extras/ImageUtils.js\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author Daosheng Mu / https://github.com/DaoshengMu/\n\t */THREE.ImageUtils = {crossOrigin:undefined,loadTexture:function loadTexture(url,mapping,onLoad,onError){var loader=new THREE.ImageLoader();loader.crossOrigin = this.crossOrigin;var texture=new THREE.Texture(undefined,mapping);loader.load(url,function(image){texture.image = image;texture.needsUpdate = true;if(onLoad)onLoad(texture);},undefined,function(event){if(onError)onError(event);});texture.sourceFile = url;return texture;},loadTextureCube:function loadTextureCube(array,mapping,onLoad,onError){var images=[];var loader=new THREE.ImageLoader();loader.crossOrigin = this.crossOrigin;var texture=new THREE.CubeTexture(images,mapping);var loaded=0;var loadTexture=function loadTexture(i){loader.load(array[i],function(image){texture.images[i] = image;loaded += 1;if(loaded === 6){texture.needsUpdate = true;if(onLoad)onLoad(texture);}},undefined,onError);};for(var i=0,il=array.length;i < il;++i) {loadTexture(i);}return texture;},loadCompressedTexture:function loadCompressedTexture(){console.error('THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.');},loadCompressedTextureCube:function loadCompressedTextureCube(){console.error('THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.');},getNormalMap:function getNormalMap(image,depth){ // Adapted from http://www.paulbrunt.co.uk/lab/heightnormal/\n\tvar cross=function cross(a,b){return [a[1] * b[2] - a[2] * b[1],a[2] * b[0] - a[0] * b[2],a[0] * b[1] - a[1] * b[0]];};var subtract=function subtract(a,b){return [a[0] - b[0],a[1] - b[1],a[2] - b[2]];};var normalize=function normalize(a){var l=Math.sqrt(a[0] * a[0] + a[1] * a[1] + a[2] * a[2]);return [a[0] / l,a[1] / l,a[2] / l];};depth = depth | 1;var width=image.width;var height=image.height;var canvas=document.createElement('canvas');canvas.width = width;canvas.height = height;var context=canvas.getContext('2d');context.drawImage(image,0,0);var data=context.getImageData(0,0,width,height).data;var imageData=context.createImageData(width,height);var output=imageData.data;for(var x=0;x < width;x++) {for(var y=0;y < height;y++) {var ly=y - 1 < 0?0:y - 1;var uy=y + 1 > height - 1?height - 1:y + 1;var lx=x - 1 < 0?0:x - 1;var ux=x + 1 > width - 1?width - 1:x + 1;var points=[];var origin=[0,0,data[(y * width + x) * 4] / 255 * depth];points.push([-1,0,data[(y * width + lx) * 4] / 255 * depth]);points.push([-1,-1,data[(ly * width + lx) * 4] / 255 * depth]);points.push([0,-1,data[(ly * width + x) * 4] / 255 * depth]);points.push([1,-1,data[(ly * width + ux) * 4] / 255 * depth]);points.push([1,0,data[(y * width + ux) * 4] / 255 * depth]);points.push([1,1,data[(uy * width + ux) * 4] / 255 * depth]);points.push([0,1,data[(uy * width + x) * 4] / 255 * depth]);points.push([-1,1,data[(uy * width + lx) * 4] / 255 * depth]);var normals=[];var num_points=points.length;for(var i=0;i < num_points;i++) {var v1=points[i];var v2=points[(i + 1) % num_points];v1 = subtract(v1,origin);v2 = subtract(v2,origin);normals.push(normalize(cross(v1,v2)));}var normal=[0,0,0];for(var i=0;i < normals.length;i++) {normal[0] += normals[i][0];normal[1] += normals[i][1];normal[2] += normals[i][2];}normal[0] /= normals.length;normal[1] /= normals.length;normal[2] /= normals.length;var idx=(y * width + x) * 4;output[idx] = (normal[0] + 1.0) / 2.0 * 255 | 0;output[idx + 1] = (normal[1] + 1.0) / 2.0 * 255 | 0;output[idx + 2] = normal[2] * 255 | 0;output[idx + 3] = 255;}}context.putImageData(imageData,0,0);return canvas;},generateDataTexture:function generateDataTexture(width,height,color){var size=width * height;var data=new Uint8Array(3 * size);var r=Math.floor(color.r * 255);var g=Math.floor(color.g * 255);var b=Math.floor(color.b * 255);for(var i=0;i < size;i++) {data[i * 3] = r;data[i * 3 + 1] = g;data[i * 3 + 2] = b;}var texture=new THREE.DataTexture(data,width,height,THREE.RGBFormat);texture.needsUpdate = true;return texture;}}; // File:src/extras/SceneUtils.js\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t */THREE.SceneUtils = {createMultiMaterialObject:function createMultiMaterialObject(geometry,materials){var group=new THREE.Group();for(var i=0,l=materials.length;i < l;i++) {group.add(new THREE.Mesh(geometry,materials[i]));}return group;},detach:function detach(child,parent,scene){child.applyMatrix(parent.matrixWorld);parent.remove(child);scene.add(child);},attach:function attach(child,scene,parent){var matrixWorldInverse=new THREE.Matrix4();matrixWorldInverse.getInverse(parent.matrixWorld);child.applyMatrix(matrixWorldInverse);scene.remove(child);parent.add(child);}}; // File:src/extras/FontUtils.js\n\t/**\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\n\t * @author alteredq / http://alteredqualia.com/\n\t *\n\t * For Text operations in three.js (See TextGeometry)\n\t *\n\t * It uses techniques used in:\n\t *\n\t *\tTriangulation ported from AS3\n\t *\t\tSimple Polygon Triangulation\n\t *\t\thttp://actionsnippet.com/?p=1462\n\t *\n\t * \tA Method to triangulate shapes with holes\n\t *\t\thttp://www.sakri.net/blog/2009/06/12/an-approach-to-triangulating-polygons-with-holes/\n\t *\n\t */THREE.FontUtils = {faces:{}, // Just for now. face[weight][style]\n\tface:'helvetiker',weight:'normal',style:'normal',size:150,divisions:10,getFace:function getFace(){try{return this.faces[this.face.toLowerCase()][this.weight][this.style];}catch(e) {throw \"The font \" + this.face + \" with \" + this.weight + \" weight and \" + this.style + \" style is missing.\";}},loadFace:function loadFace(data){var family=data.familyName.toLowerCase();var ThreeFont=this;ThreeFont.faces[family] = ThreeFont.faces[family] || {};ThreeFont.faces[family][data.cssFontWeight] = ThreeFont.faces[family][data.cssFontWeight] || {};ThreeFont.faces[family][data.cssFontWeight][data.cssFontStyle] = data;ThreeFont.faces[family][data.cssFontWeight][data.cssFontStyle] = data;return data;},drawText:function drawText(text){ // RenderText\n\tvar i,face=this.getFace(),scale=this.size / face.resolution,offset=0,chars=String(text).split(''),length=chars.length;var fontPaths=[];for(i = 0;i < length;i++) {var path=new THREE.Path();var ret=this.extractGlyphPoints(chars[i],face,scale,offset,path);offset += ret.offset;fontPaths.push(ret.path);} // get the width\n\tvar width=offset / 2; //\n\t// for ( p = 0; p < allPts.length; p++ ) {\n\t//\n\t// \tallPts[ p ].x -= width;\n\t//\n\t// }\n\t//var extract = this.extractPoints( allPts, characterPts );\n\t//extract.contour = allPts;\n\t//extract.paths = fontPaths;\n\t//extract.offset = width;\n\treturn {paths:fontPaths,offset:width};},extractGlyphPoints:function extractGlyphPoints(c,face,scale,offset,path){var pts=[];var i,i2,divisions,outline,action,length,scaleX,scaleY,x,y,cpx,cpy,cpx0,cpy0,cpx1,cpy1,cpx2,cpy2,laste,glyph=face.glyphs[c] || face.glyphs['?'];if(!glyph)return;if(glyph.o){outline = glyph._cachedOutline || (glyph._cachedOutline = glyph.o.split(' '));length = outline.length;scaleX = scale;scaleY = scale;for(i = 0;i < length;) {action = outline[i++]; //console.log( action );\n\tswitch(action){case 'm': // Move To\n\tx = outline[i++] * scaleX + offset;y = outline[i++] * scaleY;path.moveTo(x,y);break;case 'l': // Line To\n\tx = outline[i++] * scaleX + offset;y = outline[i++] * scaleY;path.lineTo(x,y);break;case 'q': // QuadraticCurveTo\n\tcpx = outline[i++] * scaleX + offset;cpy = outline[i++] * scaleY;cpx1 = outline[i++] * scaleX + offset;cpy1 = outline[i++] * scaleY;path.quadraticCurveTo(cpx1,cpy1,cpx,cpy);laste = pts[pts.length - 1];if(laste){cpx0 = laste.x;cpy0 = laste.y;for(i2 = 1,divisions = this.divisions;i2 <= divisions;i2++) {var t=i2 / divisions;THREE.Shape.Utils.b2(t,cpx0,cpx1,cpx);THREE.Shape.Utils.b2(t,cpy0,cpy1,cpy);}}break;case 'b': // Cubic Bezier Curve\n\tcpx = outline[i++] * scaleX + offset;cpy = outline[i++] * scaleY;cpx1 = outline[i++] * scaleX + offset;cpy1 = outline[i++] * scaleY;cpx2 = outline[i++] * scaleX + offset;cpy2 = outline[i++] * scaleY;path.bezierCurveTo(cpx1,cpy1,cpx2,cpy2,cpx,cpy);laste = pts[pts.length - 1];if(laste){cpx0 = laste.x;cpy0 = laste.y;for(i2 = 1,divisions = this.divisions;i2 <= divisions;i2++) {var t=i2 / divisions;THREE.Shape.Utils.b3(t,cpx0,cpx1,cpx2,cpx);THREE.Shape.Utils.b3(t,cpy0,cpy1,cpy2,cpy);}}break;}}}return {offset:glyph.ha * scale,path:path};}};THREE.FontUtils.generateShapes = function(text,parameters){ // Parameters\n\tparameters = parameters || {};var size=parameters.size !== undefined?parameters.size:100;var curveSegments=parameters.curveSegments !== undefined?parameters.curveSegments:4;var font=parameters.font !== undefined?parameters.font:'helvetiker';var weight=parameters.weight !== undefined?parameters.weight:'normal';var style=parameters.style !== undefined?parameters.style:'normal';THREE.FontUtils.size = size;THREE.FontUtils.divisions = curveSegments;THREE.FontUtils.face = font;THREE.FontUtils.weight = weight;THREE.FontUtils.style = style; // Get a Font data json object\n\tvar data=THREE.FontUtils.drawText(text);var paths=data.paths;var shapes=[];for(var p=0,pl=paths.length;p < pl;p++) {Array.prototype.push.apply(shapes,paths[p].toShapes());}return shapes;}; /**\n\t * This code is a quick port of code written in C++ which was submitted to\n\t * flipcode.com by John W. Ratcliff  // July 22, 2000\n\t * See original code and more information here:\n\t * http://www.flipcode.com/archives/Efficient_Polygon_Triangulation.shtml\n\t *\n\t * ported to actionscript by Zevan Rosser\n\t * www.actionsnippet.com\n\t *\n\t * ported to javascript by Joshua Koo\n\t * http://www.lab4games.net/zz85/blog\n\t *\n\t */(function(namespace){var EPSILON=0.0000000001; // takes in an contour array and returns\n\tvar process=function process(contour,indices){var n=contour.length;if(n < 3)return null;var result=[],verts=[],vertIndices=[]; /* we want a counter-clockwise polygon in verts */var u,v,w;if(area(contour) > 0.0){for(v = 0;v < n;v++) verts[v] = v;}else {for(v = 0;v < n;v++) verts[v] = n - 1 - v;}var nv=n; /*  remove nv - 2 vertices, creating 1 triangle every time */var count=2 * nv; /* error detection */for(v = nv - 1;nv > 2;) { /* if we loop, it is probably a non-simple polygon */if(count-- <= 0){ //** Triangulate: ERROR - probable bad polygon!\n\t//throw ( \"Warning, unable to triangulate polygon!\" );\n\t//return null;\n\t// Sometimes warning is fine, especially polygons are triangulated in reverse.\n\tconsole.warn('THREE.FontUtils: Warning, unable to triangulate polygon! in Triangulate.process()');if(indices)return vertIndices;return result;} /* three consecutive vertices in current polygon, <u,v,w> */u = v;if(nv <= u)u = 0; /* previous */v = u + 1;if(nv <= v)v = 0; /* new v    */w = v + 1;if(nv <= w)w = 0; /* next     */if(snip(contour,u,v,w,nv,verts)){var a,b,c,s,t; /* true names of the vertices */a = verts[u];b = verts[v];c = verts[w]; /* output Triangle */result.push([contour[a],contour[b],contour[c]]);vertIndices.push([verts[u],verts[v],verts[w]]); /* remove v from the remaining polygon */for(s = v,t = v + 1;t < nv;s++,t++) {verts[s] = verts[t];}nv--; /* reset error detection counter */count = 2 * nv;}}if(indices)return vertIndices;return result;}; // calculate area of the contour polygon\n\tvar area=function area(contour){var n=contour.length;var a=0.0;for(var p=n - 1,q=0;q < n;p = q++) {a += contour[p].x * contour[q].y - contour[q].x * contour[p].y;}return a * 0.5;};var snip=function snip(contour,u,v,w,n,verts){var p;var ax,ay,bx,by;var cx,cy,px,py;ax = contour[verts[u]].x;ay = contour[verts[u]].y;bx = contour[verts[v]].x;by = contour[verts[v]].y;cx = contour[verts[w]].x;cy = contour[verts[w]].y;if(EPSILON > (bx - ax) * (cy - ay) - (by - ay) * (cx - ax))return false;var aX,aY,bX,bY,cX,cY;var apx,apy,bpx,bpy,cpx,cpy;var cCROSSap,bCROSScp,aCROSSbp;aX = cx - bx;aY = cy - by;bX = ax - cx;bY = ay - cy;cX = bx - ax;cY = by - ay;for(p = 0;p < n;p++) {px = contour[verts[p]].x;py = contour[verts[p]].y;if(px === ax && py === ay || px === bx && py === by || px === cx && py === cy)continue;apx = px - ax;apy = py - ay;bpx = px - bx;bpy = py - by;cpx = px - cx;cpy = py - cy; // see if p is inside triangle abc\n\taCROSSbp = aX * bpy - aY * bpx;cCROSSap = cX * apy - cY * apx;bCROSScp = bX * cpy - bY * cpx;if(aCROSSbp >= -EPSILON && bCROSScp >= -EPSILON && cCROSSap >= -EPSILON)return false;}return true;};namespace.Triangulate = process;namespace.Triangulate.area = area;return namespace;})(THREE.FontUtils); // To use the typeface.js face files, hook up the API\n\tTHREE.typeface_js = {faces:THREE.FontUtils.faces,loadFace:THREE.FontUtils.loadFace};if(typeof self !== 'undefined')self._typeface_js = THREE.typeface_js; // File:src/extras/audio/Audio.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */THREE.Audio = function(listener){THREE.Object3D.call(this);this.type = 'Audio';this.context = listener.context;this.source = this.context.createBufferSource();this.source.onended = this.onEnded.bind(this);this.gain = this.context.createGain();this.gain.connect(this.context.destination);this.panner = this.context.createPanner();this.panner.connect(this.gain);this.autoplay = false;this.startTime = 0;this.playbackRate = 1;this.isPlaying = false;};THREE.Audio.prototype = _Object$create(THREE.Object3D.prototype);THREE.Audio.prototype.constructor = THREE.Audio;THREE.Audio.prototype.load = function(file){var scope=this;var request=new XMLHttpRequest();request.open('GET',file,true);request.responseType = 'arraybuffer';request.onload = function(e){scope.context.decodeAudioData(this.response,function(buffer){scope.source.buffer = buffer;if(scope.autoplay)scope.play();});};request.send();return this;};THREE.Audio.prototype.play = function(){if(this.isPlaying === true){console.warn('THREE.Audio: Audio is already playing.');return;}var source=this.context.createBufferSource();source.buffer = this.source.buffer;source.loop = this.source.loop;source.onended = this.source.onended;source.start(0,this.startTime);source.playbackRate.value = this.playbackRate;this.isPlaying = true;this.source = source;this.connect();};THREE.Audio.prototype.pause = function(){this.source.stop();this.startTime = this.context.currentTime;};THREE.Audio.prototype.stop = function(){this.source.stop();this.startTime = 0;};THREE.Audio.prototype.connect = function(){if(this.filter !== undefined){this.source.connect(this.filter);this.filter.connect(this.panner);}else {this.source.connect(this.panner);}};THREE.Audio.prototype.disconnect = function(){if(this.filter !== undefined){this.source.disconnect(this.filter);this.filter.disconnect(this.panner);}else {this.source.disconnect(this.panner);}};THREE.Audio.prototype.setFilter = function(value){if(this.isPlaying === true){this.disconnect();this.filter = value;this.connect();}else {this.filter = value;}};THREE.Audio.prototype.getFilter = function(){return this.filter;};THREE.Audio.prototype.setPlaybackRate = function(value){this.playbackRate = value;if(this.isPlaying === true){this.source.playbackRate.value = this.playbackRate;}};THREE.Audio.prototype.getPlaybackRate = function(){return this.playbackRate;};THREE.Audio.prototype.onEnded = function(){this.isPlaying = false;};THREE.Audio.prototype.setLoop = function(value){this.source.loop = value;};THREE.Audio.prototype.getLoop = function(){return this.source.loop;};THREE.Audio.prototype.setRefDistance = function(value){this.panner.refDistance = value;};THREE.Audio.prototype.getRefDistance = function(){return this.panner.refDistance;};THREE.Audio.prototype.setRolloffFactor = function(value){this.panner.rolloffFactor = value;};THREE.Audio.prototype.getRolloffFactor = function(){return this.panner.rolloffFactor;};THREE.Audio.prototype.setVolume = function(value){this.gain.gain.value = value;};THREE.Audio.prototype.getVolume = function(){return this.gain.gain.value;};THREE.Audio.prototype.updateMatrixWorld = (function(){var position=new THREE.Vector3();return function updateMatrixWorld(force){THREE.Object3D.prototype.updateMatrixWorld.call(this,force);position.setFromMatrixPosition(this.matrixWorld);this.panner.setPosition(position.x,position.y,position.z);};})(); // File:src/extras/audio/AudioListener.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */THREE.AudioListener = function(){THREE.Object3D.call(this);this.type = 'AudioListener';this.context = new (window.AudioContext || window.webkitAudioContext)();};THREE.AudioListener.prototype = _Object$create(THREE.Object3D.prototype);THREE.AudioListener.prototype.constructor = THREE.AudioListener;THREE.AudioListener.prototype.updateMatrixWorld = (function(){var position=new THREE.Vector3();var quaternion=new THREE.Quaternion();var scale=new THREE.Vector3();var orientation=new THREE.Vector3();return function updateMatrixWorld(force){THREE.Object3D.prototype.updateMatrixWorld.call(this,force);var listener=this.context.listener;var up=this.up;this.matrixWorld.decompose(position,quaternion,scale);orientation.set(0,0,-1).applyQuaternion(quaternion);listener.setPosition(position.x,position.y,position.z);listener.setOrientation(orientation.x,orientation.y,orientation.z,up.x,up.y,up.z);};})(); // File:src/extras/core/Curve.js\n\t/**\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\n\t * Extensible curve object\n\t *\n\t * Some common of Curve methods\n\t * .getPoint(t), getTangent(t)\n\t * .getPointAt(u), getTagentAt(u)\n\t * .getPoints(), .getSpacedPoints()\n\t * .getLength()\n\t * .updateArcLengths()\n\t *\n\t * This following classes subclasses THREE.Curve:\n\t *\n\t * -- 2d classes --\n\t * THREE.LineCurve\n\t * THREE.QuadraticBezierCurve\n\t * THREE.CubicBezierCurve\n\t * THREE.SplineCurve\n\t * THREE.ArcCurve\n\t * THREE.EllipseCurve\n\t *\n\t * -- 3d classes --\n\t * THREE.LineCurve3\n\t * THREE.QuadraticBezierCurve3\n\t * THREE.CubicBezierCurve3\n\t * THREE.SplineCurve3\n\t * THREE.ClosedSplineCurve3\n\t *\n\t * A series of curves can be represented as a THREE.CurvePath\n\t *\n\t **/ /**************************************************************\n\t *\tAbstract Curve base class\n\t **************************************************************/THREE.Curve = function(){}; // Virtual base class method to overwrite and implement in subclasses\n\t//\t- t [0 .. 1]\n\tTHREE.Curve.prototype.getPoint = function(t){console.warn(\"THREE.Curve: Warning, getPoint() not implemented!\");return null;}; // Get point at relative position in curve according to arc length\n\t// - u [0 .. 1]\n\tTHREE.Curve.prototype.getPointAt = function(u){var t=this.getUtoTmapping(u);return this.getPoint(t);}; // Get sequence of points using getPoint( t )\n\tTHREE.Curve.prototype.getPoints = function(divisions){if(!divisions)divisions = 5;var d,pts=[];for(d = 0;d <= divisions;d++) {pts.push(this.getPoint(d / divisions));}return pts;}; // Get sequence of points using getPointAt( u )\n\tTHREE.Curve.prototype.getSpacedPoints = function(divisions){if(!divisions)divisions = 5;var d,pts=[];for(d = 0;d <= divisions;d++) {pts.push(this.getPointAt(d / divisions));}return pts;}; // Get total curve arc length\n\tTHREE.Curve.prototype.getLength = function(){var lengths=this.getLengths();return lengths[lengths.length - 1];}; // Get list of cumulative segment lengths\n\tTHREE.Curve.prototype.getLengths = function(divisions){if(!divisions)divisions = this.__arcLengthDivisions?this.__arcLengthDivisions:200;if(this.cacheArcLengths && this.cacheArcLengths.length === divisions + 1 && !this.needsUpdate){ //console.log( \"cached\", this.cacheArcLengths );\n\treturn this.cacheArcLengths;}this.needsUpdate = false;var cache=[];var current,last=this.getPoint(0);var p,sum=0;cache.push(0);for(p = 1;p <= divisions;p++) {current = this.getPoint(p / divisions);sum += current.distanceTo(last);cache.push(sum);last = current;}this.cacheArcLengths = cache;return cache; // { sums: cache, sum:sum }; Sum is in the last element.\n\t};THREE.Curve.prototype.updateArcLengths = function(){this.needsUpdate = true;this.getLengths();}; // Given u ( 0 .. 1 ), get a t to find p. This gives you points which are equidistant\n\tTHREE.Curve.prototype.getUtoTmapping = function(u,distance){var arcLengths=this.getLengths();var i=0,il=arcLengths.length;var targetArcLength; // The targeted u distance value to get\n\tif(distance){targetArcLength = distance;}else {targetArcLength = u * arcLengths[il - 1];} //var time = Date.now();\n\t// binary search for the index with largest value smaller than target u distance\n\tvar low=0,high=il - 1,comparison;while(low <= high) {i = Math.floor(low + (high - low) / 2); // less likely to overflow, though probably not issue here, JS doesn't really have integers, all numbers are floats\n\tcomparison = arcLengths[i] - targetArcLength;if(comparison < 0){low = i + 1;}else if(comparison > 0){high = i - 1;}else {high = i;break; // DONE\n\t}}i = high; //console.log('b' , i, low, high, Date.now()- time);\n\tif(arcLengths[i] === targetArcLength){var t=i / (il - 1);return t;} // we could get finer grain at lengths, or use simple interpolation between two points\n\tvar lengthBefore=arcLengths[i];var lengthAfter=arcLengths[i + 1];var segmentLength=lengthAfter - lengthBefore; // determine where we are between the 'before' and 'after' points\n\tvar segmentFraction=(targetArcLength - lengthBefore) / segmentLength; // add that fractional amount to t\n\tvar t=(i + segmentFraction) / (il - 1);return t;}; // Returns a unit vector tangent at t\n\t// In case any sub curve does not implement its tangent derivation,\n\t// 2 points a small delta apart will be used to find its gradient\n\t// which seems to give a reasonable approximation\n\tTHREE.Curve.prototype.getTangent = function(t){var delta=0.0001;var t1=t - delta;var t2=t + delta; // Capping in case of danger\n\tif(t1 < 0)t1 = 0;if(t2 > 1)t2 = 1;var pt1=this.getPoint(t1);var pt2=this.getPoint(t2);var vec=pt2.clone().sub(pt1);return vec.normalize();};THREE.Curve.prototype.getTangentAt = function(u){var t=this.getUtoTmapping(u);return this.getTangent(t);}; /**************************************************************\n\t *\tUtils\n\t **************************************************************/THREE.Curve.Utils = {tangentQuadraticBezier:function tangentQuadraticBezier(t,p0,p1,p2){return 2 * (1 - t) * (p1 - p0) + 2 * t * (p2 - p1);}, // Puay Bing, thanks for helping with this derivative!\n\ttangentCubicBezier:function tangentCubicBezier(t,p0,p1,p2,p3){return -3 * p0 * (1 - t) * (1 - t) + 3 * p1 * (1 - t) * (1 - t) - 6 * t * p1 * (1 - t) + 6 * t * p2 * (1 - t) - 3 * t * t * p2 + 3 * t * t * p3;},tangentSpline:function tangentSpline(t,p0,p1,p2,p3){ // To check if my formulas are correct\n\tvar h00=6 * t * t - 6 * t; // derived from 2t^3  3t^2 + 1\n\tvar h10=3 * t * t - 4 * t + 1; // t^3  2t^2 + t\n\tvar h01=-6 * t * t + 6 * t; //  2t3 + 3t2\n\tvar h11=3 * t * t - 2 * t; // t3  t2\n\treturn h00 + h10 + h01 + h11;}, // Catmull-Rom\n\tinterpolate:function interpolate(p0,p1,p2,p3,t){var v0=(p2 - p0) * 0.5;var v1=(p3 - p1) * 0.5;var t2=t * t;var t3=t * t2;return (2 * p1 - 2 * p2 + v0 + v1) * t3 + (-3 * p1 + 3 * p2 - 2 * v0 - v1) * t2 + v0 * t + p1;}}; // TODO: Transformation for Curves?\n\t/**************************************************************\n\t *\t3D Curves\n\t **************************************************************/ // A Factory method for creating new curve subclasses\n\tTHREE.Curve.create = function(constructor,getPointFunc){constructor.prototype = _Object$create(THREE.Curve.prototype);constructor.prototype.constructor = constructor;constructor.prototype.getPoint = getPointFunc;return constructor;}; // File:src/extras/core/CurvePath.js\n\t/**\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\n\t *\n\t **/ /**************************************************************\n\t *\tCurved Path - a curve path is simply a array of connected\n\t *  curves, but retains the api of a curve\n\t **************************************************************/THREE.CurvePath = function(){this.curves = [];this.bends = [];this.autoClose = false; // Automatically closes the path\n\t};THREE.CurvePath.prototype = _Object$create(THREE.Curve.prototype);THREE.CurvePath.prototype.constructor = THREE.CurvePath;THREE.CurvePath.prototype.add = function(curve){this.curves.push(curve);};THREE.CurvePath.prototype.checkConnection = function(){ // TODO\n\t// If the ending of curve is not connected to the starting\n\t// or the next curve, then, this is not a real path\n\t};THREE.CurvePath.prototype.closePath = function(){ // TODO Test\n\t// and verify for vector3 (needs to implement equals)\n\t// Add a line curve if start and end of lines are not connected\n\tvar startPoint=this.curves[0].getPoint(0);var endPoint=this.curves[this.curves.length - 1].getPoint(1);if(!startPoint.equals(endPoint)){this.curves.push(new THREE.LineCurve(endPoint,startPoint));}}; // To get accurate point with reference to\n\t// entire path distance at time t,\n\t// following has to be done:\n\t// 1. Length of each sub path have to be known\n\t// 2. Locate and identify type of curve\n\t// 3. Get t for the curve\n\t// 4. Return curve.getPointAt(t')\n\tTHREE.CurvePath.prototype.getPoint = function(t){var d=t * this.getLength();var curveLengths=this.getCurveLengths();var i=0,diff,curve; // To think about boundaries points.\n\twhile(i < curveLengths.length) {if(curveLengths[i] >= d){diff = curveLengths[i] - d;curve = this.curves[i];var u=1 - diff / curve.getLength();return curve.getPointAt(u);}i++;}return null; // loop where sum != 0, sum > d , sum+1 <d\n\t}; /*\n\tTHREE.CurvePath.prototype.getTangent = function( t ) {\n\t};*/ // We cannot use the default THREE.Curve getPoint() with getLength() because in\n\t// THREE.Curve, getLength() depends on getPoint() but in THREE.CurvePath\n\t// getPoint() depends on getLength\n\tTHREE.CurvePath.prototype.getLength = function(){var lens=this.getCurveLengths();return lens[lens.length - 1];}; // Compute lengths and cache them\n\t// We cannot overwrite getLengths() because UtoT mapping uses it.\n\tTHREE.CurvePath.prototype.getCurveLengths = function(){ // We use cache values if curves and cache array are same length\n\tif(this.cacheLengths && this.cacheLengths.length === this.curves.length){return this.cacheLengths;} // Get length of sub-curve\n\t// Push sums into cached array\n\tvar lengths=[],sums=0;var i,il=this.curves.length;for(i = 0;i < il;i++) {sums += this.curves[i].getLength();lengths.push(sums);}this.cacheLengths = lengths;return lengths;}; // Returns min and max coordinates\n\tTHREE.CurvePath.prototype.getBoundingBox = function(){var points=this.getPoints();var maxX,maxY,maxZ;var minX,minY,minZ;maxX = maxY = Number.NEGATIVE_INFINITY;minX = minY = Number.POSITIVE_INFINITY;var p,i,il,sum;var v3=points[0] instanceof THREE.Vector3;sum = v3?new THREE.Vector3():new THREE.Vector2();for(i = 0,il = points.length;i < il;i++) {p = points[i];if(p.x > maxX)maxX = p.x;else if(p.x < minX)minX = p.x;if(p.y > maxY)maxY = p.y;else if(p.y < minY)minY = p.y;if(v3){if(p.z > maxZ)maxZ = p.z;else if(p.z < minZ)minZ = p.z;}sum.add(p);}var ret={minX:minX,minY:minY,maxX:maxX,maxY:maxY};if(v3){ret.maxZ = maxZ;ret.minZ = minZ;}return ret;}; /**************************************************************\n\t *\tCreate Geometries Helpers\n\t **************************************************************/ /// Generate geometry from path points (for Line or Points objects)\n\tTHREE.CurvePath.prototype.createPointsGeometry = function(divisions){var pts=this.getPoints(divisions,true);return this.createGeometry(pts);}; // Generate geometry from equidistant sampling along the path\n\tTHREE.CurvePath.prototype.createSpacedPointsGeometry = function(divisions){var pts=this.getSpacedPoints(divisions,true);return this.createGeometry(pts);};THREE.CurvePath.prototype.createGeometry = function(points){var geometry=new THREE.Geometry();for(var i=0;i < points.length;i++) {geometry.vertices.push(new THREE.Vector3(points[i].x,points[i].y,points[i].z || 0));}return geometry;}; /**************************************************************\n\t *\tBend / Wrap Helper Methods\n\t **************************************************************/ // Wrap path / Bend modifiers?\n\tTHREE.CurvePath.prototype.addWrapPath = function(bendpath){this.bends.push(bendpath);};THREE.CurvePath.prototype.getTransformedPoints = function(segments,bends){var oldPts=this.getPoints(segments); // getPoints getSpacedPoints\n\tvar i,il;if(!bends){bends = this.bends;}for(i = 0,il = bends.length;i < il;i++) {oldPts = this.getWrapPoints(oldPts,bends[i]);}return oldPts;};THREE.CurvePath.prototype.getTransformedSpacedPoints = function(segments,bends){var oldPts=this.getSpacedPoints(segments);var i,il;if(!bends){bends = this.bends;}for(i = 0,il = bends.length;i < il;i++) {oldPts = this.getWrapPoints(oldPts,bends[i]);}return oldPts;}; // This returns getPoints() bend/wrapped around the contour of a path.\n\t// Read http://www.planetclegg.com/projects/WarpingTextToSplines.html\n\tTHREE.CurvePath.prototype.getWrapPoints = function(oldPts,path){var bounds=this.getBoundingBox();var i,il,p,oldX,oldY,xNorm;for(i = 0,il = oldPts.length;i < il;i++) {p = oldPts[i];oldX = p.x;oldY = p.y;xNorm = oldX / bounds.maxX; // If using actual distance, for length > path, requires line extrusions\n\t//xNorm = path.getUtoTmapping(xNorm, oldX); // 3 styles. 1) wrap stretched. 2) wrap stretch by arc length 3) warp by actual distance\n\txNorm = path.getUtoTmapping(xNorm,oldX); // check for out of bounds?\n\tvar pathPt=path.getPoint(xNorm);var normal=path.getTangent(xNorm);normal.set(-normal.y,normal.x).multiplyScalar(oldY);p.x = pathPt.x + normal.x;p.y = pathPt.y + normal.y;}return oldPts;}; // File:src/extras/core/Path.js\n\t/**\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\n\t * Creates free form 2d path using series of points, lines or curves.\n\t *\n\t **/THREE.Path = function(points){THREE.CurvePath.call(this);this.actions = [];if(points){this.fromPoints(points);}};THREE.Path.prototype = _Object$create(THREE.CurvePath.prototype);THREE.Path.prototype.constructor = THREE.Path;THREE.PathActions = {MOVE_TO:'moveTo',LINE_TO:'lineTo',QUADRATIC_CURVE_TO:'quadraticCurveTo', // Bezier quadratic curve\n\tBEZIER_CURVE_TO:'bezierCurveTo', // Bezier cubic curve\n\tCSPLINE_THRU:'splineThru', // Catmull-Rom spline\n\tARC:'arc', // Circle\n\tELLIPSE:'ellipse'}; // TODO Clean up PATH API\n\t// Create path using straight lines to connect all points\n\t// - vectors: array of Vector2\n\tTHREE.Path.prototype.fromPoints = function(vectors){this.moveTo(vectors[0].x,vectors[0].y);for(var v=1,vlen=vectors.length;v < vlen;v++) {this.lineTo(vectors[v].x,vectors[v].y);}}; // startPath() endPath()?\n\tTHREE.Path.prototype.moveTo = function(x,y){var args=Array.prototype.slice.call(arguments);this.actions.push({action:THREE.PathActions.MOVE_TO,args:args});};THREE.Path.prototype.lineTo = function(x,y){var args=Array.prototype.slice.call(arguments);var lastargs=this.actions[this.actions.length - 1].args;var x0=lastargs[lastargs.length - 2];var y0=lastargs[lastargs.length - 1];var curve=new THREE.LineCurve(new THREE.Vector2(x0,y0),new THREE.Vector2(x,y));this.curves.push(curve);this.actions.push({action:THREE.PathActions.LINE_TO,args:args});};THREE.Path.prototype.quadraticCurveTo = function(aCPx,aCPy,aX,aY){var args=Array.prototype.slice.call(arguments);var lastargs=this.actions[this.actions.length - 1].args;var x0=lastargs[lastargs.length - 2];var y0=lastargs[lastargs.length - 1];var curve=new THREE.QuadraticBezierCurve(new THREE.Vector2(x0,y0),new THREE.Vector2(aCPx,aCPy),new THREE.Vector2(aX,aY));this.curves.push(curve);this.actions.push({action:THREE.PathActions.QUADRATIC_CURVE_TO,args:args});};THREE.Path.prototype.bezierCurveTo = function(aCP1x,aCP1y,aCP2x,aCP2y,aX,aY){var args=Array.prototype.slice.call(arguments);var lastargs=this.actions[this.actions.length - 1].args;var x0=lastargs[lastargs.length - 2];var y0=lastargs[lastargs.length - 1];var curve=new THREE.CubicBezierCurve(new THREE.Vector2(x0,y0),new THREE.Vector2(aCP1x,aCP1y),new THREE.Vector2(aCP2x,aCP2y),new THREE.Vector2(aX,aY));this.curves.push(curve);this.actions.push({action:THREE.PathActions.BEZIER_CURVE_TO,args:args});};THREE.Path.prototype.splineThru = function(pts /*Array of Vector*/){var args=Array.prototype.slice.call(arguments);var lastargs=this.actions[this.actions.length - 1].args;var x0=lastargs[lastargs.length - 2];var y0=lastargs[lastargs.length - 1]; //---\n\tvar npts=[new THREE.Vector2(x0,y0)];Array.prototype.push.apply(npts,pts);var curve=new THREE.SplineCurve(npts);this.curves.push(curve);this.actions.push({action:THREE.PathActions.CSPLINE_THRU,args:args});}; // FUTURE: Change the API or follow canvas API?\n\tTHREE.Path.prototype.arc = function(aX,aY,aRadius,aStartAngle,aEndAngle,aClockwise){var lastargs=this.actions[this.actions.length - 1].args;var x0=lastargs[lastargs.length - 2];var y0=lastargs[lastargs.length - 1];this.absarc(aX + x0,aY + y0,aRadius,aStartAngle,aEndAngle,aClockwise);};THREE.Path.prototype.absarc = function(aX,aY,aRadius,aStartAngle,aEndAngle,aClockwise){this.absellipse(aX,aY,aRadius,aRadius,aStartAngle,aEndAngle,aClockwise);};THREE.Path.prototype.ellipse = function(aX,aY,xRadius,yRadius,aStartAngle,aEndAngle,aClockwise,aRotation){var lastargs=this.actions[this.actions.length - 1].args;var x0=lastargs[lastargs.length - 2];var y0=lastargs[lastargs.length - 1];this.absellipse(aX + x0,aY + y0,xRadius,yRadius,aStartAngle,aEndAngle,aClockwise,aRotation);};THREE.Path.prototype.absellipse = function(aX,aY,xRadius,yRadius,aStartAngle,aEndAngle,aClockwise,aRotation){var args=[aX,aY,xRadius,yRadius,aStartAngle,aEndAngle,aClockwise,aRotation || 0 // aRotation is optional.\n\t];var curve=new THREE.EllipseCurve(aX,aY,xRadius,yRadius,aStartAngle,aEndAngle,aClockwise,aRotation);this.curves.push(curve);var lastPoint=curve.getPoint(1);args.push(lastPoint.x);args.push(lastPoint.y);this.actions.push({action:THREE.PathActions.ELLIPSE,args:args});};THREE.Path.prototype.getSpacedPoints = function(divisions,closedPath){if(!divisions)divisions = 40;var points=[];for(var i=0;i < divisions;i++) {points.push(this.getPoint(i / divisions)); //if( !this.getPoint( i / divisions ) ) throw \"DIE\";\n\t} // if ( closedPath ) {\n\t//\n\t// \tpoints.push( points[ 0 ] );\n\t//\n\t// }\n\treturn points;}; /* Return an array of vectors based on contour of the path */THREE.Path.prototype.getPoints = function(divisions,closedPath){if(this.useSpacedPoints){return this.getSpacedPoints(divisions,closedPath);}divisions = divisions || 12;var points=[];var i,il,item,action,args;var cpx,cpy,cpx2,cpy2,cpx1,cpy1,cpx0,cpy0,laste,j,t,tx,ty;for(i = 0,il = this.actions.length;i < il;i++) {item = this.actions[i];action = item.action;args = item.args;switch(action){case THREE.PathActions.MOVE_TO:points.push(new THREE.Vector2(args[0],args[1]));break;case THREE.PathActions.LINE_TO:points.push(new THREE.Vector2(args[0],args[1]));break;case THREE.PathActions.QUADRATIC_CURVE_TO:cpx = args[2];cpy = args[3];cpx1 = args[0];cpy1 = args[1];if(points.length > 0){laste = points[points.length - 1];cpx0 = laste.x;cpy0 = laste.y;}else {laste = this.actions[i - 1].args;cpx0 = laste[laste.length - 2];cpy0 = laste[laste.length - 1];}for(j = 1;j <= divisions;j++) {t = j / divisions;tx = THREE.Shape.Utils.b2(t,cpx0,cpx1,cpx);ty = THREE.Shape.Utils.b2(t,cpy0,cpy1,cpy);points.push(new THREE.Vector2(tx,ty));}break;case THREE.PathActions.BEZIER_CURVE_TO:cpx = args[4];cpy = args[5];cpx1 = args[0];cpy1 = args[1];cpx2 = args[2];cpy2 = args[3];if(points.length > 0){laste = points[points.length - 1];cpx0 = laste.x;cpy0 = laste.y;}else {laste = this.actions[i - 1].args;cpx0 = laste[laste.length - 2];cpy0 = laste[laste.length - 1];}for(j = 1;j <= divisions;j++) {t = j / divisions;tx = THREE.Shape.Utils.b3(t,cpx0,cpx1,cpx2,cpx);ty = THREE.Shape.Utils.b3(t,cpy0,cpy1,cpy2,cpy);points.push(new THREE.Vector2(tx,ty));}break;case THREE.PathActions.CSPLINE_THRU:laste = this.actions[i - 1].args;var last=new THREE.Vector2(laste[laste.length - 2],laste[laste.length - 1]);var spts=[last];var n=divisions * args[0].length;spts = spts.concat(args[0]);var spline=new THREE.SplineCurve(spts);for(j = 1;j <= n;j++) {points.push(spline.getPointAt(j / n));}break;case THREE.PathActions.ARC:var aX=args[0],aY=args[1],aRadius=args[2],aStartAngle=args[3],aEndAngle=args[4],aClockwise=!!args[5];var deltaAngle=aEndAngle - aStartAngle;var angle;var tdivisions=divisions * 2;for(j = 1;j <= tdivisions;j++) {t = j / tdivisions;if(!aClockwise){t = 1 - t;}angle = aStartAngle + t * deltaAngle;tx = aX + aRadius * Math.cos(angle);ty = aY + aRadius * Math.sin(angle); //console.log('t', t, 'angle', angle, 'tx', tx, 'ty', ty);\n\tpoints.push(new THREE.Vector2(tx,ty));} //console.log(points);\n\tbreak;case THREE.PathActions.ELLIPSE:var aX=args[0],aY=args[1],xRadius=args[2],yRadius=args[3],aStartAngle=args[4],aEndAngle=args[5],aClockwise=!!args[6],aRotation=args[7];var deltaAngle=aEndAngle - aStartAngle;var angle;var tdivisions=divisions * 2;var cos,sin;if(aRotation !== 0){cos = Math.cos(aRotation);sin = Math.sin(aRotation);}for(j = 1;j <= tdivisions;j++) {t = j / tdivisions;if(!aClockwise){t = 1 - t;}angle = aStartAngle + t * deltaAngle;tx = aX + xRadius * Math.cos(angle);ty = aY + yRadius * Math.sin(angle);if(aRotation !== 0){var x=tx,y=ty; // Rotate the point about the center of the ellipse.\n\ttx = (x - aX) * cos - (y - aY) * sin + aX;ty = (x - aX) * sin + (y - aY) * cos + aY;} //console.log('t', t, 'angle', angle, 'tx', tx, 'ty', ty);\n\tpoints.push(new THREE.Vector2(tx,ty));} //console.log(points);\n\tbreak;} // end switch\n\t} // Normalize to remove the closing point by default.\n\tvar lastPoint=points[points.length - 1];var EPSILON=0.0000000001;if(Math.abs(lastPoint.x - points[0].x) < EPSILON && Math.abs(lastPoint.y - points[0].y) < EPSILON)points.splice(points.length - 1,1);if(closedPath){points.push(points[0]);}return points;}; //\n\t// Breaks path into shapes\n\t//\n\t//\tAssumptions (if parameter isCCW==true the opposite holds):\n\t//\t- solid shapes are defined clockwise (CW)\n\t//\t- holes are defined counterclockwise (CCW)\n\t//\n\t//\tIf parameter noHoles==true:\n\t//  - all subPaths are regarded as solid shapes\n\t//  - definition order CW/CCW has no relevance\n\t//\n\tTHREE.Path.prototype.toShapes = function(isCCW,noHoles){function extractSubpaths(inActions){var i,il,item,action,args;var subPaths=[],lastPath=new THREE.Path();for(i = 0,il = inActions.length;i < il;i++) {item = inActions[i];args = item.args;action = item.action;if(action === THREE.PathActions.MOVE_TO){if(lastPath.actions.length !== 0){subPaths.push(lastPath);lastPath = new THREE.Path();}}lastPath[action].apply(lastPath,args);}if(lastPath.actions.length !== 0){subPaths.push(lastPath);} // console.log(subPaths);\n\treturn subPaths;}function toShapesNoHoles(inSubpaths){var shapes=[];for(var i=0,il=inSubpaths.length;i < il;i++) {var tmpPath=inSubpaths[i];var tmpShape=new THREE.Shape();tmpShape.actions = tmpPath.actions;tmpShape.curves = tmpPath.curves;shapes.push(tmpShape);} //console.log(\"shape\", shapes);\n\treturn shapes;}function isPointInsidePolygon(inPt,inPolygon){var EPSILON=0.0000000001;var polyLen=inPolygon.length; // inPt on polygon contour => immediate success    or\n\t// toggling of inside/outside at every single! intersection point of an edge\n\t//  with the horizontal line through inPt, left of inPt\n\t//  not counting lowerY endpoints of edges and whole edges on that line\n\tvar inside=false;for(var p=polyLen - 1,q=0;q < polyLen;p = q++) {var edgeLowPt=inPolygon[p];var edgeHighPt=inPolygon[q];var edgeDx=edgeHighPt.x - edgeLowPt.x;var edgeDy=edgeHighPt.y - edgeLowPt.y;if(Math.abs(edgeDy) > EPSILON){ // not parallel\n\tif(edgeDy < 0){edgeLowPt = inPolygon[q];edgeDx = -edgeDx;edgeHighPt = inPolygon[p];edgeDy = -edgeDy;}if(inPt.y < edgeLowPt.y || inPt.y > edgeHighPt.y)continue;if(inPt.y === edgeLowPt.y){if(inPt.x === edgeLowPt.x)return true; // inPt is on contour ?\n\t// continue;\t\t\t\t// no intersection or edgeLowPt => doesn't count !!!\n\t}else {var perpEdge=edgeDy * (inPt.x - edgeLowPt.x) - edgeDx * (inPt.y - edgeLowPt.y);if(perpEdge === 0)return true; // inPt is on contour ?\n\tif(perpEdge < 0)continue;inside = !inside; // true intersection left of inPt\n\t}}else { // parallel or collinear\n\tif(inPt.y !== edgeLowPt.y)continue; // parallel\n\t// edge lies on the same horizontal line as inPt\n\tif(edgeHighPt.x <= inPt.x && inPt.x <= edgeLowPt.x || edgeLowPt.x <= inPt.x && inPt.x <= edgeHighPt.x)return true; // inPt: Point on contour !\n\t// continue;\n\t}}return inside;}var subPaths=extractSubpaths(this.actions);if(subPaths.length === 0)return [];if(noHoles === true)return toShapesNoHoles(subPaths);var solid,tmpPath,tmpShape,shapes=[];if(subPaths.length === 1){tmpPath = subPaths[0];tmpShape = new THREE.Shape();tmpShape.actions = tmpPath.actions;tmpShape.curves = tmpPath.curves;shapes.push(tmpShape);return shapes;}var holesFirst=!THREE.Shape.Utils.isClockWise(subPaths[0].getPoints());holesFirst = isCCW?!holesFirst:holesFirst; // console.log(\"Holes first\", holesFirst);\n\tvar betterShapeHoles=[];var newShapes=[];var newShapeHoles=[];var mainIdx=0;var tmpPoints;newShapes[mainIdx] = undefined;newShapeHoles[mainIdx] = [];var i,il;for(i = 0,il = subPaths.length;i < il;i++) {tmpPath = subPaths[i];tmpPoints = tmpPath.getPoints();solid = THREE.Shape.Utils.isClockWise(tmpPoints);solid = isCCW?!solid:solid;if(solid){if(!holesFirst && newShapes[mainIdx])mainIdx++;newShapes[mainIdx] = {s:new THREE.Shape(),p:tmpPoints};newShapes[mainIdx].s.actions = tmpPath.actions;newShapes[mainIdx].s.curves = tmpPath.curves;if(holesFirst)mainIdx++;newShapeHoles[mainIdx] = []; //console.log('cw', i);\n\t}else {newShapeHoles[mainIdx].push({h:tmpPath,p:tmpPoints[0]}); //console.log('ccw', i);\n\t}} // only Holes? -> probably all Shapes with wrong orientation\n\tif(!newShapes[0])return toShapesNoHoles(subPaths);if(newShapes.length > 1){var ambiguous=false;var toChange=[];for(var sIdx=0,sLen=newShapes.length;sIdx < sLen;sIdx++) {betterShapeHoles[sIdx] = [];}for(var sIdx=0,sLen=newShapes.length;sIdx < sLen;sIdx++) {var sho=newShapeHoles[sIdx];for(var hIdx=0;hIdx < sho.length;hIdx++) {var ho=sho[hIdx];var hole_unassigned=true;for(var s2Idx=0;s2Idx < newShapes.length;s2Idx++) {if(isPointInsidePolygon(ho.p,newShapes[s2Idx].p)){if(sIdx !== s2Idx)toChange.push({froms:sIdx,tos:s2Idx,hole:hIdx});if(hole_unassigned){hole_unassigned = false;betterShapeHoles[s2Idx].push(ho);}else {ambiguous = true;}}}if(hole_unassigned){betterShapeHoles[sIdx].push(ho);}}} // console.log(\"ambiguous: \", ambiguous);\n\tif(toChange.length > 0){ // console.log(\"to change: \", toChange);\n\tif(!ambiguous)newShapeHoles = betterShapeHoles;}}var tmpHoles,j,jl;for(i = 0,il = newShapes.length;i < il;i++) {tmpShape = newShapes[i].s;shapes.push(tmpShape);tmpHoles = newShapeHoles[i];for(j = 0,jl = tmpHoles.length;j < jl;j++) {tmpShape.holes.push(tmpHoles[j].h);}} //console.log(\"shape\", shapes);\n\treturn shapes;}; // File:src/extras/core/Shape.js\n\t/**\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\n\t * Defines a 2d shape plane using paths.\n\t **/ // STEP 1 Create a path.\n\t// STEP 2 Turn path into shape.\n\t// STEP 3 ExtrudeGeometry takes in Shape/Shapes\n\t// STEP 3a - Extract points from each shape, turn to vertices\n\t// STEP 3b - Triangulate each shape, add faces.\n\tTHREE.Shape = function(){THREE.Path.apply(this,arguments);this.holes = [];};THREE.Shape.prototype = _Object$create(THREE.Path.prototype);THREE.Shape.prototype.constructor = THREE.Shape; // Convenience method to return ExtrudeGeometry\n\tTHREE.Shape.prototype.extrude = function(options){var extruded=new THREE.ExtrudeGeometry(this,options);return extruded;}; // Convenience method to return ShapeGeometry\n\tTHREE.Shape.prototype.makeGeometry = function(options){var geometry=new THREE.ShapeGeometry(this,options);return geometry;}; // Get points of holes\n\tTHREE.Shape.prototype.getPointsHoles = function(divisions){var i,il=this.holes.length,holesPts=[];for(i = 0;i < il;i++) {holesPts[i] = this.holes[i].getTransformedPoints(divisions,this.bends);}return holesPts;}; // Get points of holes (spaced by regular distance)\n\tTHREE.Shape.prototype.getSpacedPointsHoles = function(divisions){var i,il=this.holes.length,holesPts=[];for(i = 0;i < il;i++) {holesPts[i] = this.holes[i].getTransformedSpacedPoints(divisions,this.bends);}return holesPts;}; // Get points of shape and holes (keypoints based on segments parameter)\n\tTHREE.Shape.prototype.extractAllPoints = function(divisions){return {shape:this.getTransformedPoints(divisions),holes:this.getPointsHoles(divisions)};};THREE.Shape.prototype.extractPoints = function(divisions){if(this.useSpacedPoints){return this.extractAllSpacedPoints(divisions);}return this.extractAllPoints(divisions);}; //\n\t// THREE.Shape.prototype.extractAllPointsWithBend = function ( divisions, bend ) {\n\t//\n\t// \treturn {\n\t//\n\t// \t\tshape: this.transform( bend, divisions ),\n\t// \t\tholes: this.getPointsHoles( divisions, bend )\n\t//\n\t// \t};\n\t//\n\t// };\n\t// Get points of shape and holes (spaced by regular distance)\n\tTHREE.Shape.prototype.extractAllSpacedPoints = function(divisions){return {shape:this.getTransformedSpacedPoints(divisions),holes:this.getSpacedPointsHoles(divisions)};}; /**************************************************************\n\t *\tUtils\n\t **************************************************************/THREE.Shape.Utils = {triangulateShape:function triangulateShape(contour,holes){function point_in_segment_2D_colin(inSegPt1,inSegPt2,inOtherPt){ // inOtherPt needs to be collinear to the inSegment\n\tif(inSegPt1.x !== inSegPt2.x){if(inSegPt1.x < inSegPt2.x){return inSegPt1.x <= inOtherPt.x && inOtherPt.x <= inSegPt2.x;}else {return inSegPt2.x <= inOtherPt.x && inOtherPt.x <= inSegPt1.x;}}else {if(inSegPt1.y < inSegPt2.y){return inSegPt1.y <= inOtherPt.y && inOtherPt.y <= inSegPt2.y;}else {return inSegPt2.y <= inOtherPt.y && inOtherPt.y <= inSegPt1.y;}}}function intersect_segments_2D(inSeg1Pt1,inSeg1Pt2,inSeg2Pt1,inSeg2Pt2,inExcludeAdjacentSegs){var EPSILON=0.0000000001;var seg1dx=inSeg1Pt2.x - inSeg1Pt1.x,seg1dy=inSeg1Pt2.y - inSeg1Pt1.y;var seg2dx=inSeg2Pt2.x - inSeg2Pt1.x,seg2dy=inSeg2Pt2.y - inSeg2Pt1.y;var seg1seg2dx=inSeg1Pt1.x - inSeg2Pt1.x;var seg1seg2dy=inSeg1Pt1.y - inSeg2Pt1.y;var limit=seg1dy * seg2dx - seg1dx * seg2dy;var perpSeg1=seg1dy * seg1seg2dx - seg1dx * seg1seg2dy;if(Math.abs(limit) > EPSILON){ // not parallel\n\tvar perpSeg2;if(limit > 0){if(perpSeg1 < 0 || perpSeg1 > limit)return [];perpSeg2 = seg2dy * seg1seg2dx - seg2dx * seg1seg2dy;if(perpSeg2 < 0 || perpSeg2 > limit)return [];}else {if(perpSeg1 > 0 || perpSeg1 < limit)return [];perpSeg2 = seg2dy * seg1seg2dx - seg2dx * seg1seg2dy;if(perpSeg2 > 0 || perpSeg2 < limit)return [];} // i.e. to reduce rounding errors\n\t// intersection at endpoint of segment#1?\n\tif(perpSeg2 === 0){if(inExcludeAdjacentSegs && (perpSeg1 === 0 || perpSeg1 === limit))return [];return [inSeg1Pt1];}if(perpSeg2 === limit){if(inExcludeAdjacentSegs && (perpSeg1 === 0 || perpSeg1 === limit))return [];return [inSeg1Pt2];} // intersection at endpoint of segment#2?\n\tif(perpSeg1 === 0)return [inSeg2Pt1];if(perpSeg1 === limit)return [inSeg2Pt2]; // return real intersection point\n\tvar factorSeg1=perpSeg2 / limit;return [{x:inSeg1Pt1.x + factorSeg1 * seg1dx,y:inSeg1Pt1.y + factorSeg1 * seg1dy}];}else { // parallel or collinear\n\tif(perpSeg1 !== 0 || seg2dy * seg1seg2dx !== seg2dx * seg1seg2dy)return []; // they are collinear or degenerate\n\tvar seg1Pt=seg1dx === 0 && seg1dy === 0; // segment1 is just a point?\n\tvar seg2Pt=seg2dx === 0 && seg2dy === 0; // segment2 is just a point?\n\t// both segments are points\n\tif(seg1Pt && seg2Pt){if(inSeg1Pt1.x !== inSeg2Pt1.x || inSeg1Pt1.y !== inSeg2Pt1.y)return []; // they are distinct  points\n\treturn [inSeg1Pt1]; // they are the same point\n\t} // segment#1  is a single point\n\tif(seg1Pt){if(!point_in_segment_2D_colin(inSeg2Pt1,inSeg2Pt2,inSeg1Pt1))return []; // but not in segment#2\n\treturn [inSeg1Pt1];} // segment#2  is a single point\n\tif(seg2Pt){if(!point_in_segment_2D_colin(inSeg1Pt1,inSeg1Pt2,inSeg2Pt1))return []; // but not in segment#1\n\treturn [inSeg2Pt1];} // they are collinear segments, which might overlap\n\tvar seg1min,seg1max,seg1minVal,seg1maxVal;var seg2min,seg2max,seg2minVal,seg2maxVal;if(seg1dx !== 0){ // the segments are NOT on a vertical line\n\tif(inSeg1Pt1.x < inSeg1Pt2.x){seg1min = inSeg1Pt1;seg1minVal = inSeg1Pt1.x;seg1max = inSeg1Pt2;seg1maxVal = inSeg1Pt2.x;}else {seg1min = inSeg1Pt2;seg1minVal = inSeg1Pt2.x;seg1max = inSeg1Pt1;seg1maxVal = inSeg1Pt1.x;}if(inSeg2Pt1.x < inSeg2Pt2.x){seg2min = inSeg2Pt1;seg2minVal = inSeg2Pt1.x;seg2max = inSeg2Pt2;seg2maxVal = inSeg2Pt2.x;}else {seg2min = inSeg2Pt2;seg2minVal = inSeg2Pt2.x;seg2max = inSeg2Pt1;seg2maxVal = inSeg2Pt1.x;}}else { // the segments are on a vertical line\n\tif(inSeg1Pt1.y < inSeg1Pt2.y){seg1min = inSeg1Pt1;seg1minVal = inSeg1Pt1.y;seg1max = inSeg1Pt2;seg1maxVal = inSeg1Pt2.y;}else {seg1min = inSeg1Pt2;seg1minVal = inSeg1Pt2.y;seg1max = inSeg1Pt1;seg1maxVal = inSeg1Pt1.y;}if(inSeg2Pt1.y < inSeg2Pt2.y){seg2min = inSeg2Pt1;seg2minVal = inSeg2Pt1.y;seg2max = inSeg2Pt2;seg2maxVal = inSeg2Pt2.y;}else {seg2min = inSeg2Pt2;seg2minVal = inSeg2Pt2.y;seg2max = inSeg2Pt1;seg2maxVal = inSeg2Pt1.y;}}if(seg1minVal <= seg2minVal){if(seg1maxVal < seg2minVal)return [];if(seg1maxVal === seg2minVal){if(inExcludeAdjacentSegs)return [];return [seg2min];}if(seg1maxVal <= seg2maxVal)return [seg2min,seg1max];return [seg2min,seg2max];}else {if(seg1minVal > seg2maxVal)return [];if(seg1minVal === seg2maxVal){if(inExcludeAdjacentSegs)return [];return [seg1min];}if(seg1maxVal <= seg2maxVal)return [seg1min,seg1max];return [seg1min,seg2max];}}}function isPointInsideAngle(inVertex,inLegFromPt,inLegToPt,inOtherPt){ // The order of legs is important\n\tvar EPSILON=0.0000000001; // translation of all points, so that Vertex is at (0,0)\n\tvar legFromPtX=inLegFromPt.x - inVertex.x,legFromPtY=inLegFromPt.y - inVertex.y;var legToPtX=inLegToPt.x - inVertex.x,legToPtY=inLegToPt.y - inVertex.y;var otherPtX=inOtherPt.x - inVertex.x,otherPtY=inOtherPt.y - inVertex.y; // main angle >0: < 180 deg.; 0: 180 deg.; <0: > 180 deg.\n\tvar from2toAngle=legFromPtX * legToPtY - legFromPtY * legToPtX;var from2otherAngle=legFromPtX * otherPtY - legFromPtY * otherPtX;if(Math.abs(from2toAngle) > EPSILON){ // angle != 180 deg.\n\tvar other2toAngle=otherPtX * legToPtY - otherPtY * legToPtX; // console.log( \"from2to: \" + from2toAngle + \", from2other: \" + from2otherAngle + \", other2to: \" + other2toAngle );\n\tif(from2toAngle > 0){ // main angle < 180 deg.\n\treturn from2otherAngle >= 0 && other2toAngle >= 0;}else { // main angle > 180 deg.\n\treturn from2otherAngle >= 0 || other2toAngle >= 0;}}else { // angle == 180 deg.\n\t// console.log( \"from2to: 180 deg., from2other: \" + from2otherAngle  );\n\treturn from2otherAngle > 0;}}function removeHoles(contour,holes){var shape=contour.concat(); // work on this shape\n\tvar hole;function isCutLineInsideAngles(inShapeIdx,inHoleIdx){ // Check if hole point lies within angle around shape point\n\tvar lastShapeIdx=shape.length - 1;var prevShapeIdx=inShapeIdx - 1;if(prevShapeIdx < 0)prevShapeIdx = lastShapeIdx;var nextShapeIdx=inShapeIdx + 1;if(nextShapeIdx > lastShapeIdx)nextShapeIdx = 0;var insideAngle=isPointInsideAngle(shape[inShapeIdx],shape[prevShapeIdx],shape[nextShapeIdx],hole[inHoleIdx]);if(!insideAngle){ // console.log( \"Vertex (Shape): \" + inShapeIdx + \", Point: \" + hole[inHoleIdx].x + \"/\" + hole[inHoleIdx].y );\n\treturn false;} // Check if shape point lies within angle around hole point\n\tvar lastHoleIdx=hole.length - 1;var prevHoleIdx=inHoleIdx - 1;if(prevHoleIdx < 0)prevHoleIdx = lastHoleIdx;var nextHoleIdx=inHoleIdx + 1;if(nextHoleIdx > lastHoleIdx)nextHoleIdx = 0;insideAngle = isPointInsideAngle(hole[inHoleIdx],hole[prevHoleIdx],hole[nextHoleIdx],shape[inShapeIdx]);if(!insideAngle){ // console.log( \"Vertex (Hole): \" + inHoleIdx + \", Point: \" + shape[inShapeIdx].x + \"/\" + shape[inShapeIdx].y );\n\treturn false;}return true;}function intersectsShapeEdge(inShapePt,inHolePt){ // checks for intersections with shape edges\n\tvar sIdx,nextIdx,intersection;for(sIdx = 0;sIdx < shape.length;sIdx++) {nextIdx = sIdx + 1;nextIdx %= shape.length;intersection = intersect_segments_2D(inShapePt,inHolePt,shape[sIdx],shape[nextIdx],true);if(intersection.length > 0)return true;}return false;}var indepHoles=[];function intersectsHoleEdge(inShapePt,inHolePt){ // checks for intersections with hole edges\n\tvar ihIdx,chkHole,hIdx,nextIdx,intersection;for(ihIdx = 0;ihIdx < indepHoles.length;ihIdx++) {chkHole = holes[indepHoles[ihIdx]];for(hIdx = 0;hIdx < chkHole.length;hIdx++) {nextIdx = hIdx + 1;nextIdx %= chkHole.length;intersection = intersect_segments_2D(inShapePt,inHolePt,chkHole[hIdx],chkHole[nextIdx],true);if(intersection.length > 0)return true;}}return false;}var holeIndex,shapeIndex,shapePt,holePt,holeIdx,cutKey,failedCuts=[],tmpShape1,tmpShape2,tmpHole1,tmpHole2;for(var h=0,hl=holes.length;h < hl;h++) {indepHoles.push(h);}var minShapeIndex=0;var counter=indepHoles.length * 2;while(indepHoles.length > 0) {counter--;if(counter < 0){console.log(\"Infinite Loop! Holes left:\" + indepHoles.length + \", Probably Hole outside Shape!\");break;} // search for shape-vertex and hole-vertex,\n\t// which can be connected without intersections\n\tfor(shapeIndex = minShapeIndex;shapeIndex < shape.length;shapeIndex++) {shapePt = shape[shapeIndex];holeIndex = -1; // search for hole which can be reached without intersections\n\tfor(var h=0;h < indepHoles.length;h++) {holeIdx = indepHoles[h]; // prevent multiple checks\n\tcutKey = shapePt.x + \":\" + shapePt.y + \":\" + holeIdx;if(failedCuts[cutKey] !== undefined)continue;hole = holes[holeIdx];for(var h2=0;h2 < hole.length;h2++) {holePt = hole[h2];if(!isCutLineInsideAngles(shapeIndex,h2))continue;if(intersectsShapeEdge(shapePt,holePt))continue;if(intersectsHoleEdge(shapePt,holePt))continue;holeIndex = h2;indepHoles.splice(h,1);tmpShape1 = shape.slice(0,shapeIndex + 1);tmpShape2 = shape.slice(shapeIndex);tmpHole1 = hole.slice(holeIndex);tmpHole2 = hole.slice(0,holeIndex + 1);shape = tmpShape1.concat(tmpHole1).concat(tmpHole2).concat(tmpShape2);minShapeIndex = shapeIndex; // Debug only, to show the selected cuts\n\t// glob_CutLines.push( [ shapePt, holePt ] );\n\tbreak;}if(holeIndex >= 0)break; // hole-vertex found\n\tfailedCuts[cutKey] = true; // remember failure\n\t}if(holeIndex >= 0)break; // hole-vertex found\n\t}}return shape; /* shape with no holes */}var i,il,f,face,key,index,allPointsMap={}; // To maintain reference to old shape, one must match coordinates, or offset the indices from original arrays. It's probably easier to do the first.\n\tvar allpoints=contour.concat();for(var h=0,hl=holes.length;h < hl;h++) {Array.prototype.push.apply(allpoints,holes[h]);} //console.log( \"allpoints\",allpoints, allpoints.length );\n\t// prepare all points map\n\tfor(i = 0,il = allpoints.length;i < il;i++) {key = allpoints[i].x + \":\" + allpoints[i].y;if(allPointsMap[key] !== undefined){console.warn(\"THREE.Shape: Duplicate point\",key);}allPointsMap[key] = i;} // remove holes by cutting paths to holes and adding them to the shape\n\tvar shapeWithoutHoles=removeHoles(contour,holes);var triangles=THREE.FontUtils.Triangulate(shapeWithoutHoles,false); // True returns indices for points of spooled shape\n\t//console.log( \"triangles\",triangles, triangles.length );\n\t// check all face vertices against all points map\n\tfor(i = 0,il = triangles.length;i < il;i++) {face = triangles[i];for(f = 0;f < 3;f++) {key = face[f].x + \":\" + face[f].y;index = allPointsMap[key];if(index !== undefined){face[f] = index;}}}return triangles.concat();},isClockWise:function isClockWise(pts){return THREE.FontUtils.Triangulate.area(pts) < 0;}, // Bezier Curves formulas obtained from\n\t// http://en.wikipedia.org/wiki/B%C3%A9zier_curve\n\t// Quad Bezier Functions\n\tb2p0:function b2p0(t,p){var k=1 - t;return k * k * p;},b2p1:function b2p1(t,p){return 2 * (1 - t) * t * p;},b2p2:function b2p2(t,p){return t * t * p;},b2:function b2(t,p0,p1,p2){return this.b2p0(t,p0) + this.b2p1(t,p1) + this.b2p2(t,p2);}, // Cubic Bezier Functions\n\tb3p0:function b3p0(t,p){var k=1 - t;return k * k * k * p;},b3p1:function b3p1(t,p){var k=1 - t;return 3 * k * k * t * p;},b3p2:function b3p2(t,p){var k=1 - t;return 3 * k * t * t * p;},b3p3:function b3p3(t,p){return t * t * t * p;},b3:function b3(t,p0,p1,p2,p3){return this.b3p0(t,p0) + this.b3p1(t,p1) + this.b3p2(t,p2) + this.b3p3(t,p3);}}; // File:src/extras/curves/LineCurve.js\n\t/**************************************************************\n\t *\tLine\n\t **************************************************************/THREE.LineCurve = function(v1,v2){this.v1 = v1;this.v2 = v2;};THREE.LineCurve.prototype = _Object$create(THREE.Curve.prototype);THREE.LineCurve.prototype.constructor = THREE.LineCurve;THREE.LineCurve.prototype.getPoint = function(t){var point=this.v2.clone().sub(this.v1);point.multiplyScalar(t).add(this.v1);return point;}; // Line curve is linear, so we can overwrite default getPointAt\n\tTHREE.LineCurve.prototype.getPointAt = function(u){return this.getPoint(u);};THREE.LineCurve.prototype.getTangent = function(t){var tangent=this.v2.clone().sub(this.v1);return tangent.normalize();}; // File:src/extras/curves/QuadraticBezierCurve.js\n\t/**************************************************************\n\t *\tQuadratic Bezier curve\n\t **************************************************************/THREE.QuadraticBezierCurve = function(v0,v1,v2){this.v0 = v0;this.v1 = v1;this.v2 = v2;};THREE.QuadraticBezierCurve.prototype = _Object$create(THREE.Curve.prototype);THREE.QuadraticBezierCurve.prototype.constructor = THREE.QuadraticBezierCurve;THREE.QuadraticBezierCurve.prototype.getPoint = function(t){var vector=new THREE.Vector2();vector.x = THREE.Shape.Utils.b2(t,this.v0.x,this.v1.x,this.v2.x);vector.y = THREE.Shape.Utils.b2(t,this.v0.y,this.v1.y,this.v2.y);return vector;};THREE.QuadraticBezierCurve.prototype.getTangent = function(t){var vector=new THREE.Vector2();vector.x = THREE.Curve.Utils.tangentQuadraticBezier(t,this.v0.x,this.v1.x,this.v2.x);vector.y = THREE.Curve.Utils.tangentQuadraticBezier(t,this.v0.y,this.v1.y,this.v2.y); // returns unit vector\n\treturn vector.normalize();}; // File:src/extras/curves/CubicBezierCurve.js\n\t/**************************************************************\n\t *\tCubic Bezier curve\n\t **************************************************************/THREE.CubicBezierCurve = function(v0,v1,v2,v3){this.v0 = v0;this.v1 = v1;this.v2 = v2;this.v3 = v3;};THREE.CubicBezierCurve.prototype = _Object$create(THREE.Curve.prototype);THREE.CubicBezierCurve.prototype.constructor = THREE.CubicBezierCurve;THREE.CubicBezierCurve.prototype.getPoint = function(t){var tx,ty;tx = THREE.Shape.Utils.b3(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x);ty = THREE.Shape.Utils.b3(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y);return new THREE.Vector2(tx,ty);};THREE.CubicBezierCurve.prototype.getTangent = function(t){var tx,ty;tx = THREE.Curve.Utils.tangentCubicBezier(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x);ty = THREE.Curve.Utils.tangentCubicBezier(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y);var tangent=new THREE.Vector2(tx,ty);tangent.normalize();return tangent;}; // File:src/extras/curves/SplineCurve.js\n\t/**************************************************************\n\t *\tSpline curve\n\t **************************************************************/THREE.SplineCurve = function(points /* array of Vector2 */){this.points = points == undefined?[]:points;};THREE.SplineCurve.prototype = _Object$create(THREE.Curve.prototype);THREE.SplineCurve.prototype.constructor = THREE.SplineCurve;THREE.SplineCurve.prototype.getPoint = function(t){var points=this.points;var point=(points.length - 1) * t;var intPoint=Math.floor(point);var weight=point - intPoint;var point0=points[intPoint === 0?intPoint:intPoint - 1];var point1=points[intPoint];var point2=points[intPoint > points.length - 2?points.length - 1:intPoint + 1];var point3=points[intPoint > points.length - 3?points.length - 1:intPoint + 2];var vector=new THREE.Vector2();vector.x = THREE.Curve.Utils.interpolate(point0.x,point1.x,point2.x,point3.x,weight);vector.y = THREE.Curve.Utils.interpolate(point0.y,point1.y,point2.y,point3.y,weight);return vector;}; // File:src/extras/curves/EllipseCurve.js\n\t/**************************************************************\n\t *\tEllipse curve\n\t **************************************************************/THREE.EllipseCurve = function(aX,aY,xRadius,yRadius,aStartAngle,aEndAngle,aClockwise,aRotation){this.aX = aX;this.aY = aY;this.xRadius = xRadius;this.yRadius = yRadius;this.aStartAngle = aStartAngle;this.aEndAngle = aEndAngle;this.aClockwise = aClockwise;this.aRotation = aRotation || 0;};THREE.EllipseCurve.prototype = _Object$create(THREE.Curve.prototype);THREE.EllipseCurve.prototype.constructor = THREE.EllipseCurve;THREE.EllipseCurve.prototype.getPoint = function(t){var deltaAngle=this.aEndAngle - this.aStartAngle;if(deltaAngle < 0)deltaAngle += Math.PI * 2;if(deltaAngle > Math.PI * 2)deltaAngle -= Math.PI * 2;var angle;if(this.aClockwise === true){angle = this.aEndAngle + (1 - t) * (Math.PI * 2 - deltaAngle);}else {angle = this.aStartAngle + t * deltaAngle;}var x=this.aX + this.xRadius * Math.cos(angle);var y=this.aY + this.yRadius * Math.sin(angle);if(this.aRotation !== 0){var cos=Math.cos(this.aRotation);var sin=Math.sin(this.aRotation);var tx=x,ty=y; // Rotate the point about the center of the ellipse.\n\tx = (tx - this.aX) * cos - (ty - this.aY) * sin + this.aX;y = (tx - this.aX) * sin + (ty - this.aY) * cos + this.aY;}return new THREE.Vector2(x,y);}; // File:src/extras/curves/ArcCurve.js\n\t/**************************************************************\n\t *\tArc curve\n\t **************************************************************/THREE.ArcCurve = function(aX,aY,aRadius,aStartAngle,aEndAngle,aClockwise){THREE.EllipseCurve.call(this,aX,aY,aRadius,aRadius,aStartAngle,aEndAngle,aClockwise);};THREE.ArcCurve.prototype = _Object$create(THREE.EllipseCurve.prototype);THREE.ArcCurve.prototype.constructor = THREE.ArcCurve; // File:src/extras/curves/LineCurve3.js\n\t/**************************************************************\n\t *\tLine3D\n\t **************************************************************/THREE.LineCurve3 = THREE.Curve.create(function(v1,v2){this.v1 = v1;this.v2 = v2;},function(t){var vector=new THREE.Vector3();vector.subVectors(this.v2,this.v1); // diff\n\tvector.multiplyScalar(t);vector.add(this.v1);return vector;}); // File:src/extras/curves/QuadraticBezierCurve3.js\n\t/**************************************************************\n\t *\tQuadratic Bezier 3D curve\n\t **************************************************************/THREE.QuadraticBezierCurve3 = THREE.Curve.create(function(v0,v1,v2){this.v0 = v0;this.v1 = v1;this.v2 = v2;},function(t){var vector=new THREE.Vector3();vector.x = THREE.Shape.Utils.b2(t,this.v0.x,this.v1.x,this.v2.x);vector.y = THREE.Shape.Utils.b2(t,this.v0.y,this.v1.y,this.v2.y);vector.z = THREE.Shape.Utils.b2(t,this.v0.z,this.v1.z,this.v2.z);return vector;}); // File:src/extras/curves/CubicBezierCurve3.js\n\t/**************************************************************\n\t *\tCubic Bezier 3D curve\n\t **************************************************************/THREE.CubicBezierCurve3 = THREE.Curve.create(function(v0,v1,v2,v3){this.v0 = v0;this.v1 = v1;this.v2 = v2;this.v3 = v3;},function(t){var vector=new THREE.Vector3();vector.x = THREE.Shape.Utils.b3(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x);vector.y = THREE.Shape.Utils.b3(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y);vector.z = THREE.Shape.Utils.b3(t,this.v0.z,this.v1.z,this.v2.z,this.v3.z);return vector;}); // File:src/extras/curves/SplineCurve3.js\n\t/**************************************************************\n\t *\tSpline 3D curve\n\t **************************************************************/THREE.SplineCurve3 = THREE.Curve.create(function(points /* array of Vector3 */){console.warn('THREE.SplineCurve3 will be deprecated. Please use THREE.CatmullRomCurve3');this.points = points == undefined?[]:points;},function(t){var points=this.points;var point=(points.length - 1) * t;var intPoint=Math.floor(point);var weight=point - intPoint;var point0=points[intPoint == 0?intPoint:intPoint - 1];var point1=points[intPoint];var point2=points[intPoint > points.length - 2?points.length - 1:intPoint + 1];var point3=points[intPoint > points.length - 3?points.length - 1:intPoint + 2];var vector=new THREE.Vector3();vector.x = THREE.Curve.Utils.interpolate(point0.x,point1.x,point2.x,point3.x,weight);vector.y = THREE.Curve.Utils.interpolate(point0.y,point1.y,point2.y,point3.y,weight);vector.z = THREE.Curve.Utils.interpolate(point0.z,point1.z,point2.z,point3.z,weight);return vector;}); // File:src/extras/curves/CatmullRomCurve3.js\n\t/**\n\t * @author zz85 https://github.com/zz85\n\t *\n\t * Centripetal CatmullRom Curve - which is useful for avoiding\n\t * cusps and self-intersections in non-uniform catmull rom curves.\n\t * http://www.cemyuksel.com/research/catmullrom_param/catmullrom.pdf\n\t *\n\t * curve.type accepts centripetal(default), chordal and catmullrom\n\t * curve.tension is used for catmullrom which defaults to 0.5\n\t */THREE.CatmullRomCurve3 = (function(){var tmp=new THREE.Vector3(),px=new CubicPoly(),py=new CubicPoly(),pz=new CubicPoly(); /*\n\t\tBased on an optimized c++ solution in\n\t\t - http://stackoverflow.com/questions/9489736/catmull-rom-curve-with-no-cusps-and-no-self-intersections/\n\t\t - http://ideone.com/NoEbVM\n\t\n\t\tThis CubicPoly class could be used for reusing some variables and calculations,\n\t\tbut for three.js curve use, it could be possible inlined and flatten into a single function call\n\t\twhich can be placed in CurveUtils.\n\t\t*/function CubicPoly(){} /*\n\t\t * Compute coefficients for a cubic polynomial\n\t\t *   p(s) = c0 + c1*s + c2*s^2 + c3*s^3\n\t\t * such that\n\t\t *   p(0) = x0, p(1) = x1\n\t\t *  and\n\t\t *   p'(0) = t0, p'(1) = t1.\n\t\t */CubicPoly.prototype.init = function(x0,x1,t0,t1){this.c0 = x0;this.c1 = t0;this.c2 = -3 * x0 + 3 * x1 - 2 * t0 - t1;this.c3 = 2 * x0 - 2 * x1 + t0 + t1;};CubicPoly.prototype.initNonuniformCatmullRom = function(x0,x1,x2,x3,dt0,dt1,dt2){ // compute tangents when parameterized in [t1,t2]\n\tvar t1=(x1 - x0) / dt0 - (x2 - x0) / (dt0 + dt1) + (x2 - x1) / dt1;var t2=(x2 - x1) / dt1 - (x3 - x1) / (dt1 + dt2) + (x3 - x2) / dt2; // rescale tangents for parametrization in [0,1]\n\tt1 *= dt1;t2 *= dt1; // initCubicPoly\n\tthis.init(x1,x2,t1,t2);}; // standard Catmull-Rom spline: interpolate between x1 and x2 with previous/following points x1/x4\n\tCubicPoly.prototype.initCatmullRom = function(x0,x1,x2,x3,tension){this.init(x1,x2,tension * (x2 - x0),tension * (x3 - x1));};CubicPoly.prototype.calc = function(t){var t2=t * t;var t3=t2 * t;return this.c0 + this.c1 * t + this.c2 * t2 + this.c3 * t3;}; // Subclass Three.js curve\n\treturn THREE.Curve.create(function(p /* array of Vector3 */){this.points = p || [];},function(t){var points=this.points,point,intPoint,weight,l;l = points.length;if(l < 2)console.log('duh, you need at least 2 points');point = (l - 1) * t;intPoint = Math.floor(point);weight = point - intPoint;if(weight === 0 && intPoint === l - 1){intPoint = l - 2;weight = 1;}var p0,p1,p2,p3;if(intPoint === 0){ // extrapolate first point\n\ttmp.subVectors(points[0],points[1]).add(points[0]);p0 = tmp;}else {p0 = points[intPoint - 1];}p1 = points[intPoint];p2 = points[intPoint + 1];if(intPoint + 2 < l){p3 = points[intPoint + 2];}else { // extrapolate last point\n\ttmp.subVectors(points[l - 1],points[l - 2]).add(points[l - 2]);p3 = tmp;}if(this.type === undefined || this.type === 'centripetal' || this.type === 'chordal'){ // init Centripetal / Chordal Catmull-Rom\n\tvar pow=this.type === 'chordal'?0.5:0.25;var dt0=Math.pow(p0.distanceToSquared(p1),pow);var dt1=Math.pow(p1.distanceToSquared(p2),pow);var dt2=Math.pow(p2.distanceToSquared(p3),pow); // safety check for repeated points\n\tif(dt1 < 1e-4)dt1 = 1.0;if(dt0 < 1e-4)dt0 = dt1;if(dt2 < 1e-4)dt2 = dt1;px.initNonuniformCatmullRom(p0.x,p1.x,p2.x,p3.x,dt0,dt1,dt2);py.initNonuniformCatmullRom(p0.y,p1.y,p2.y,p3.y,dt0,dt1,dt2);pz.initNonuniformCatmullRom(p0.z,p1.z,p2.z,p3.z,dt0,dt1,dt2);}else if(this.type === 'catmullrom'){var tension=this.tension !== undefined?this.tension:0.5;px.initCatmullRom(p0.x,p1.x,p2.x,p3.x,tension);py.initCatmullRom(p0.y,p1.y,p2.y,p3.y,tension);pz.initCatmullRom(p0.z,p1.z,p2.z,p3.z,tension);}var v=new THREE.Vector3(px.calc(weight),py.calc(weight),pz.calc(weight));return v;});})(); // File:src/extras/curves/ClosedSplineCurve3.js\n\t/**************************************************************\n\t *\tClosed Spline 3D curve\n\t **************************************************************/THREE.ClosedSplineCurve3 = THREE.Curve.create(function(points /* array of Vector3 */){this.points = points == undefined?[]:points;},function(t){var points=this.points;var point=(points.length - 0) * t; // This needs to be from 0-length +1\n\tvar intPoint=Math.floor(point);var weight=point - intPoint;intPoint += intPoint > 0?0:(Math.floor(Math.abs(intPoint) / points.length) + 1) * points.length;var point0=points[(intPoint - 1) % points.length];var point1=points[intPoint % points.length];var point2=points[(intPoint + 1) % points.length];var point3=points[(intPoint + 2) % points.length];var vector=new THREE.Vector3();vector.x = THREE.Curve.Utils.interpolate(point0.x,point1.x,point2.x,point3.x,weight);vector.y = THREE.Curve.Utils.interpolate(point0.y,point1.y,point2.y,point3.y,weight);vector.z = THREE.Curve.Utils.interpolate(point0.z,point1.z,point2.z,point3.z,weight);return vector;}); // File:src/extras/animation/AnimationHandler.js\n\t/**\n\t * @author mikael emtinger / http://gomo.se/\n\t */THREE.AnimationHandler = {LINEAR:0,CATMULLROM:1,CATMULLROM_FORWARD:2, //\n\tadd:function add(){console.warn('THREE.AnimationHandler.add() has been deprecated.');},get:function get(){console.warn('THREE.AnimationHandler.get() has been deprecated.');},remove:function remove(){console.warn('THREE.AnimationHandler.remove() has been deprecated.');}, //\n\tanimations:[],init:function init(data){if(data.initialized === true)return data; // loop through all keys\n\tfor(var h=0;h < data.hierarchy.length;h++) {for(var k=0;k < data.hierarchy[h].keys.length;k++) { // remove minus times\n\tif(data.hierarchy[h].keys[k].time < 0){data.hierarchy[h].keys[k].time = 0;} // create quaternions\n\tif(data.hierarchy[h].keys[k].rot !== undefined && !(data.hierarchy[h].keys[k].rot instanceof THREE.Quaternion)){var quat=data.hierarchy[h].keys[k].rot;data.hierarchy[h].keys[k].rot = new THREE.Quaternion().fromArray(quat);}} // prepare morph target keys\n\tif(data.hierarchy[h].keys.length && data.hierarchy[h].keys[0].morphTargets !== undefined){ // get all used\n\tvar usedMorphTargets={};for(var k=0;k < data.hierarchy[h].keys.length;k++) {for(var m=0;m < data.hierarchy[h].keys[k].morphTargets.length;m++) {var morphTargetName=data.hierarchy[h].keys[k].morphTargets[m];usedMorphTargets[morphTargetName] = -1;}}data.hierarchy[h].usedMorphTargets = usedMorphTargets; // set all used on all frames\n\tfor(var k=0;k < data.hierarchy[h].keys.length;k++) {var influences={};for(var morphTargetName in usedMorphTargets) {for(var m=0;m < data.hierarchy[h].keys[k].morphTargets.length;m++) {if(data.hierarchy[h].keys[k].morphTargets[m] === morphTargetName){influences[morphTargetName] = data.hierarchy[h].keys[k].morphTargetsInfluences[m];break;}}if(m === data.hierarchy[h].keys[k].morphTargets.length){influences[morphTargetName] = 0;}}data.hierarchy[h].keys[k].morphTargetsInfluences = influences;}} // remove all keys that are on the same time\n\tfor(var k=1;k < data.hierarchy[h].keys.length;k++) {if(data.hierarchy[h].keys[k].time === data.hierarchy[h].keys[k - 1].time){data.hierarchy[h].keys.splice(k,1);k--;}} // set index\n\tfor(var k=0;k < data.hierarchy[h].keys.length;k++) {data.hierarchy[h].keys[k].index = k;}}data.initialized = true;return data;},parse:function parse(root){var parseRecurseHierarchy=function parseRecurseHierarchy(root,hierarchy){hierarchy.push(root);for(var c=0;c < root.children.length;c++) parseRecurseHierarchy(root.children[c],hierarchy);}; // setup hierarchy\n\tvar hierarchy=[];if(root instanceof THREE.SkinnedMesh){for(var b=0;b < root.skeleton.bones.length;b++) {hierarchy.push(root.skeleton.bones[b]);}}else {parseRecurseHierarchy(root,hierarchy);}return hierarchy;},play:function play(animation){if(this.animations.indexOf(animation) === -1){this.animations.push(animation);}},stop:function stop(animation){var index=this.animations.indexOf(animation);if(index !== -1){this.animations.splice(index,1);}},update:function update(deltaTimeMS){for(var i=0;i < this.animations.length;i++) {this.animations[i].resetBlendWeights();}for(var i=0;i < this.animations.length;i++) {this.animations[i].update(deltaTimeMS);}}}; // File:src/extras/animation/Animation.js\n\t/**\n\t * @author mikael emtinger / http://gomo.se/\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author alteredq / http://alteredqualia.com/\n\t */THREE.Animation = function(root,data){this.root = root;this.data = THREE.AnimationHandler.init(data);this.hierarchy = THREE.AnimationHandler.parse(root);this.currentTime = 0;this.timeScale = 1;this.isPlaying = false;this.loop = true;this.weight = 0;this.interpolationType = THREE.AnimationHandler.LINEAR;};THREE.Animation.prototype = {constructor:THREE.Animation,keyTypes:[\"pos\",\"rot\",\"scl\"],play:function play(startTime,weight){this.currentTime = startTime !== undefined?startTime:0;this.weight = weight !== undefined?weight:1;this.isPlaying = true;this.reset();THREE.AnimationHandler.play(this);},stop:function stop(){this.isPlaying = false;THREE.AnimationHandler.stop(this);},reset:function reset(){for(var h=0,hl=this.hierarchy.length;h < hl;h++) {var object=this.hierarchy[h];if(object.animationCache === undefined){object.animationCache = {animations:{},blending:{positionWeight:0.0,quaternionWeight:0.0,scaleWeight:0.0}};}var name=this.data.name;var animations=object.animationCache.animations;var animationCache=animations[name];if(animationCache === undefined){animationCache = {prevKey:{pos:0,rot:0,scl:0},nextKey:{pos:0,rot:0,scl:0},originalMatrix:object.matrix};animations[name] = animationCache;} // Get keys to match our current time\n\tfor(var t=0;t < 3;t++) {var type=this.keyTypes[t];var prevKey=this.data.hierarchy[h].keys[0];var nextKey=this.getNextKeyWith(type,h,1);while(nextKey.time < this.currentTime && nextKey.index > prevKey.index) {prevKey = nextKey;nextKey = this.getNextKeyWith(type,h,nextKey.index + 1);}animationCache.prevKey[type] = prevKey;animationCache.nextKey[type] = nextKey;}}},resetBlendWeights:function resetBlendWeights(){for(var h=0,hl=this.hierarchy.length;h < hl;h++) {var object=this.hierarchy[h];var animationCache=object.animationCache;if(animationCache !== undefined){var blending=animationCache.blending;blending.positionWeight = 0.0;blending.quaternionWeight = 0.0;blending.scaleWeight = 0.0;}}},update:(function(){var points=[];var target=new THREE.Vector3();var newVector=new THREE.Vector3();var newQuat=new THREE.Quaternion(); // Catmull-Rom spline\n\tvar interpolateCatmullRom=function interpolateCatmullRom(points,scale){var c=[],v3=[],point,intPoint,weight,w2,w3,pa,pb,pc,pd;point = (points.length - 1) * scale;intPoint = Math.floor(point);weight = point - intPoint;c[0] = intPoint === 0?intPoint:intPoint - 1;c[1] = intPoint;c[2] = intPoint > points.length - 2?intPoint:intPoint + 1;c[3] = intPoint > points.length - 3?intPoint:intPoint + 2;pa = points[c[0]];pb = points[c[1]];pc = points[c[2]];pd = points[c[3]];w2 = weight * weight;w3 = weight * w2;v3[0] = interpolate(pa[0],pb[0],pc[0],pd[0],weight,w2,w3);v3[1] = interpolate(pa[1],pb[1],pc[1],pd[1],weight,w2,w3);v3[2] = interpolate(pa[2],pb[2],pc[2],pd[2],weight,w2,w3);return v3;};var interpolate=function interpolate(p0,p1,p2,p3,t,t2,t3){var v0=(p2 - p0) * 0.5,v1=(p3 - p1) * 0.5;return (2 * (p1 - p2) + v0 + v1) * t3 + (-3 * (p1 - p2) - 2 * v0 - v1) * t2 + v0 * t + p1;};return function(delta){if(this.isPlaying === false)return;this.currentTime += delta * this.timeScale;if(this.weight === 0)return; //\n\tvar duration=this.data.length;if(this.currentTime > duration || this.currentTime < 0){if(this.loop){this.currentTime %= duration;if(this.currentTime < 0)this.currentTime += duration;this.reset();}else {this.stop();}}for(var h=0,hl=this.hierarchy.length;h < hl;h++) {var object=this.hierarchy[h];var animationCache=object.animationCache.animations[this.data.name];var blending=object.animationCache.blending; // loop through pos/rot/scl\n\tfor(var t=0;t < 3;t++) { // get keys\n\tvar type=this.keyTypes[t];var prevKey=animationCache.prevKey[type];var nextKey=animationCache.nextKey[type];if(this.timeScale > 0 && nextKey.time <= this.currentTime || this.timeScale < 0 && prevKey.time >= this.currentTime){prevKey = this.data.hierarchy[h].keys[0];nextKey = this.getNextKeyWith(type,h,1);while(nextKey.time < this.currentTime && nextKey.index > prevKey.index) {prevKey = nextKey;nextKey = this.getNextKeyWith(type,h,nextKey.index + 1);}animationCache.prevKey[type] = prevKey;animationCache.nextKey[type] = nextKey;}var scale=(this.currentTime - prevKey.time) / (nextKey.time - prevKey.time);var prevXYZ=prevKey[type];var nextXYZ=nextKey[type];if(scale < 0)scale = 0;if(scale > 1)scale = 1; // interpolate\n\tif(type === \"pos\"){if(this.interpolationType === THREE.AnimationHandler.LINEAR){newVector.x = prevXYZ[0] + (nextXYZ[0] - prevXYZ[0]) * scale;newVector.y = prevXYZ[1] + (nextXYZ[1] - prevXYZ[1]) * scale;newVector.z = prevXYZ[2] + (nextXYZ[2] - prevXYZ[2]) * scale; // blend\n\tvar proportionalWeight=this.weight / (this.weight + blending.positionWeight);object.position.lerp(newVector,proportionalWeight);blending.positionWeight += this.weight;}else if(this.interpolationType === THREE.AnimationHandler.CATMULLROM || this.interpolationType === THREE.AnimationHandler.CATMULLROM_FORWARD){points[0] = this.getPrevKeyWith(\"pos\",h,prevKey.index - 1)[\"pos\"];points[1] = prevXYZ;points[2] = nextXYZ;points[3] = this.getNextKeyWith(\"pos\",h,nextKey.index + 1)[\"pos\"];scale = scale * 0.33 + 0.33;var currentPoint=interpolateCatmullRom(points,scale);var proportionalWeight=this.weight / (this.weight + blending.positionWeight);blending.positionWeight += this.weight; // blend\n\tvar vector=object.position;vector.x = vector.x + (currentPoint[0] - vector.x) * proportionalWeight;vector.y = vector.y + (currentPoint[1] - vector.y) * proportionalWeight;vector.z = vector.z + (currentPoint[2] - vector.z) * proportionalWeight;if(this.interpolationType === THREE.AnimationHandler.CATMULLROM_FORWARD){var forwardPoint=interpolateCatmullRom(points,scale * 1.01);target.set(forwardPoint[0],forwardPoint[1],forwardPoint[2]);target.sub(vector);target.y = 0;target.normalize();var angle=Math.atan2(target.x,target.z);object.rotation.set(0,angle,0);}}}else if(type === \"rot\"){THREE.Quaternion.slerp(prevXYZ,nextXYZ,newQuat,scale); // Avoid paying the cost of an additional slerp if we don't have to\n\tif(blending.quaternionWeight === 0){object.quaternion.copy(newQuat);blending.quaternionWeight = this.weight;}else {var proportionalWeight=this.weight / (this.weight + blending.quaternionWeight);THREE.Quaternion.slerp(object.quaternion,newQuat,object.quaternion,proportionalWeight);blending.quaternionWeight += this.weight;}}else if(type === \"scl\"){newVector.x = prevXYZ[0] + (nextXYZ[0] - prevXYZ[0]) * scale;newVector.y = prevXYZ[1] + (nextXYZ[1] - prevXYZ[1]) * scale;newVector.z = prevXYZ[2] + (nextXYZ[2] - prevXYZ[2]) * scale;var proportionalWeight=this.weight / (this.weight + blending.scaleWeight);object.scale.lerp(newVector,proportionalWeight);blending.scaleWeight += this.weight;}}}return true;};})(),getNextKeyWith:function getNextKeyWith(type,h,key){var keys=this.data.hierarchy[h].keys;if(this.interpolationType === THREE.AnimationHandler.CATMULLROM || this.interpolationType === THREE.AnimationHandler.CATMULLROM_FORWARD){key = key < keys.length - 1?key:keys.length - 1;}else {key = key % keys.length;}for(;key < keys.length;key++) {if(keys[key][type] !== undefined){return keys[key];}}return this.data.hierarchy[h].keys[0];},getPrevKeyWith:function getPrevKeyWith(type,h,key){var keys=this.data.hierarchy[h].keys;if(this.interpolationType === THREE.AnimationHandler.CATMULLROM || this.interpolationType === THREE.AnimationHandler.CATMULLROM_FORWARD){key = key > 0?key:0;}else {key = key >= 0?key:key + keys.length;}for(;key >= 0;key--) {if(keys[key][type] !== undefined){return keys[key];}}return this.data.hierarchy[h].keys[keys.length - 1];}}; // File:src/extras/animation/KeyFrameAnimation.js\n\t/**\n\t * @author mikael emtinger / http://gomo.se/\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author khang duong\n\t * @author erik kitson\n\t */THREE.KeyFrameAnimation = function(data){this.root = data.node;this.data = THREE.AnimationHandler.init(data);this.hierarchy = THREE.AnimationHandler.parse(this.root);this.currentTime = 0;this.timeScale = 0.001;this.isPlaying = false;this.isPaused = true;this.loop = true; // initialize to first keyframes\n\tfor(var h=0,hl=this.hierarchy.length;h < hl;h++) {var keys=this.data.hierarchy[h].keys,sids=this.data.hierarchy[h].sids,obj=this.hierarchy[h];if(keys.length && sids){for(var s=0;s < sids.length;s++) {var sid=sids[s],next=this.getNextKeyWith(sid,h,0);if(next){next.apply(sid);}}obj.matrixAutoUpdate = false;this.data.hierarchy[h].node.updateMatrix();obj.matrixWorldNeedsUpdate = true;}}};THREE.KeyFrameAnimation.prototype = {constructor:THREE.KeyFrameAnimation,play:function play(startTime){this.currentTime = startTime !== undefined?startTime:0;if(this.isPlaying === false){this.isPlaying = true; // reset key cache\n\tvar h,hl=this.hierarchy.length,object,node;for(h = 0;h < hl;h++) {object = this.hierarchy[h];node = this.data.hierarchy[h];if(node.animationCache === undefined){node.animationCache = {};node.animationCache.prevKey = null;node.animationCache.nextKey = null;node.animationCache.originalMatrix = object.matrix;}var keys=this.data.hierarchy[h].keys;if(keys.length){node.animationCache.prevKey = keys[0];node.animationCache.nextKey = keys[1];this.startTime = Math.min(keys[0].time,this.startTime);this.endTime = Math.max(keys[keys.length - 1].time,this.endTime);}}this.update(0);}this.isPaused = false;THREE.AnimationHandler.play(this);},stop:function stop(){this.isPlaying = false;this.isPaused = false;THREE.AnimationHandler.stop(this); // reset JIT matrix and remove cache\n\tfor(var h=0;h < this.data.hierarchy.length;h++) {var obj=this.hierarchy[h];var node=this.data.hierarchy[h];if(node.animationCache !== undefined){var original=node.animationCache.originalMatrix;original.copy(obj.matrix);obj.matrix = original;delete node.animationCache;}}},update:function update(delta){if(this.isPlaying === false)return;this.currentTime += delta * this.timeScale; //\n\tvar duration=this.data.length;if(this.loop === true && this.currentTime > duration){this.currentTime %= duration;}this.currentTime = Math.min(this.currentTime,duration);for(var h=0,hl=this.hierarchy.length;h < hl;h++) {var object=this.hierarchy[h];var node=this.data.hierarchy[h];var keys=node.keys,animationCache=node.animationCache;if(keys.length){var prevKey=animationCache.prevKey;var nextKey=animationCache.nextKey;if(nextKey.time <= this.currentTime){while(nextKey.time < this.currentTime && nextKey.index > prevKey.index) {prevKey = nextKey;nextKey = keys[prevKey.index + 1];}animationCache.prevKey = prevKey;animationCache.nextKey = nextKey;}if(nextKey.time >= this.currentTime){prevKey.interpolate(nextKey,this.currentTime);}else {prevKey.interpolate(nextKey,nextKey.time);}this.data.hierarchy[h].node.updateMatrix();object.matrixWorldNeedsUpdate = true;}}},getNextKeyWith:function getNextKeyWith(sid,h,key){var keys=this.data.hierarchy[h].keys;key = key % keys.length;for(;key < keys.length;key++) {if(keys[key].hasTarget(sid)){return keys[key];}}return keys[0];},getPrevKeyWith:function getPrevKeyWith(sid,h,key){var keys=this.data.hierarchy[h].keys;key = key >= 0?key:key + keys.length;for(;key >= 0;key--) {if(keys[key].hasTarget(sid)){return keys[key];}}return keys[keys.length - 1];}}; // File:src/extras/animation/MorphAnimation.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com\n\t * @author willy-vvu / http://willy-vvu.github.io\n\t */THREE.MorphAnimation = function(mesh){this.mesh = mesh;this.frames = mesh.morphTargetInfluences.length;this.currentTime = 0;this.duration = 1000;this.loop = true;this.lastFrame = 0;this.currentFrame = 0;this.isPlaying = false;};THREE.MorphAnimation.prototype = {constructor:THREE.MorphAnimation,play:function play(){this.isPlaying = true;},pause:function pause(){this.isPlaying = false;},update:function update(delta){if(this.isPlaying === false)return;this.currentTime += delta;if(this.loop === true && this.currentTime > this.duration){this.currentTime %= this.duration;}this.currentTime = Math.min(this.currentTime,this.duration);var frameTime=this.duration / this.frames;var frame=Math.floor(this.currentTime / frameTime);var influences=this.mesh.morphTargetInfluences;if(frame !== this.currentFrame){influences[this.lastFrame] = 0;influences[this.currentFrame] = 1;influences[frame] = 0;this.lastFrame = this.currentFrame;this.currentFrame = frame;}var mix=this.currentTime % frameTime / frameTime;influences[frame] = mix;influences[this.lastFrame] = 1 - mix;}}; // File:src/extras/geometries/BoxGeometry.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * based on http://papervision3d.googlecode.com/svn/trunk/as3/trunk/src/org/papervision3d/objects/primitives/Cube.as\n\t */THREE.BoxGeometry = function(width,height,depth,widthSegments,heightSegments,depthSegments){THREE.Geometry.call(this);this.type = 'BoxGeometry';this.parameters = {width:width,height:height,depth:depth,widthSegments:widthSegments,heightSegments:heightSegments,depthSegments:depthSegments};this.widthSegments = widthSegments || 1;this.heightSegments = heightSegments || 1;this.depthSegments = depthSegments || 1;var scope=this;var width_half=width / 2;var height_half=height / 2;var depth_half=depth / 2;buildPlane('z','y',-1,-1,depth,height,width_half,0); // px\n\tbuildPlane('z','y',1,-1,depth,height,-width_half,1); // nx\n\tbuildPlane('x','z',1,1,width,depth,height_half,2); // py\n\tbuildPlane('x','z',1,-1,width,depth,-height_half,3); // ny\n\tbuildPlane('x','y',1,-1,width,height,depth_half,4); // pz\n\tbuildPlane('x','y',-1,-1,width,height,-depth_half,5); // nz\n\tfunction buildPlane(u,v,udir,vdir,width,height,depth,materialIndex){var w,ix,iy,gridX=scope.widthSegments,gridY=scope.heightSegments,width_half=width / 2,height_half=height / 2,offset=scope.vertices.length;if(u === 'x' && v === 'y' || u === 'y' && v === 'x'){w = 'z';}else if(u === 'x' && v === 'z' || u === 'z' && v === 'x'){w = 'y';gridY = scope.depthSegments;}else if(u === 'z' && v === 'y' || u === 'y' && v === 'z'){w = 'x';gridX = scope.depthSegments;}var gridX1=gridX + 1,gridY1=gridY + 1,segment_width=width / gridX,segment_height=height / gridY,normal=new THREE.Vector3();normal[w] = depth > 0?1:-1;for(iy = 0;iy < gridY1;iy++) {for(ix = 0;ix < gridX1;ix++) {var vector=new THREE.Vector3();vector[u] = (ix * segment_width - width_half) * udir;vector[v] = (iy * segment_height - height_half) * vdir;vector[w] = depth;scope.vertices.push(vector);}}for(iy = 0;iy < gridY;iy++) {for(ix = 0;ix < gridX;ix++) {var a=ix + gridX1 * iy;var b=ix + gridX1 * (iy + 1);var c=ix + 1 + gridX1 * (iy + 1);var d=ix + 1 + gridX1 * iy;var uva=new THREE.Vector2(ix / gridX,1 - iy / gridY);var uvb=new THREE.Vector2(ix / gridX,1 - (iy + 1) / gridY);var uvc=new THREE.Vector2((ix + 1) / gridX,1 - (iy + 1) / gridY);var uvd=new THREE.Vector2((ix + 1) / gridX,1 - iy / gridY);var face=new THREE.Face3(a + offset,b + offset,d + offset);face.normal.copy(normal);face.vertexNormals.push(normal.clone(),normal.clone(),normal.clone());face.materialIndex = materialIndex;scope.faces.push(face);scope.faceVertexUvs[0].push([uva,uvb,uvd]);face = new THREE.Face3(b + offset,c + offset,d + offset);face.normal.copy(normal);face.vertexNormals.push(normal.clone(),normal.clone(),normal.clone());face.materialIndex = materialIndex;scope.faces.push(face);scope.faceVertexUvs[0].push([uvb.clone(),uvc,uvd.clone()]);}}}this.mergeVertices();};THREE.BoxGeometry.prototype = _Object$create(THREE.Geometry.prototype);THREE.BoxGeometry.prototype.constructor = THREE.BoxGeometry;THREE.BoxGeometry.prototype.clone = function(){var geometry=new THREE.BoxGeometry(this.parameters.width,this.parameters.height,this.parameters.depth,this.parameters.widthSegments,this.parameters.heightSegments,this.parameters.depthSegments);return geometry;};THREE.CubeGeometry = THREE.BoxGeometry; // backwards compatibility\n\t// File:src/extras/geometries/CircleGeometry.js\n\t/**\n\t * @author hughes\n\t */THREE.CircleGeometry = function(radius,segments,thetaStart,thetaLength){THREE.Geometry.call(this);this.type = 'CircleGeometry';this.parameters = {radius:radius,segments:segments,thetaStart:thetaStart,thetaLength:thetaLength};radius = radius || 50;segments = segments !== undefined?Math.max(3,segments):8;thetaStart = thetaStart !== undefined?thetaStart:0;thetaLength = thetaLength !== undefined?thetaLength:Math.PI * 2;var i,uvs=[],center=new THREE.Vector3(),centerUV=new THREE.Vector2(0.5,0.5);this.vertices.push(center);uvs.push(centerUV);for(i = 0;i <= segments;i++) {var vertex=new THREE.Vector3();var segment=thetaStart + i / segments * thetaLength;vertex.x = radius * Math.cos(segment);vertex.y = radius * Math.sin(segment);this.vertices.push(vertex);uvs.push(new THREE.Vector2((vertex.x / radius + 1) / 2,(vertex.y / radius + 1) / 2));}var n=new THREE.Vector3(0,0,1);for(i = 1;i <= segments;i++) {this.faces.push(new THREE.Face3(i,i + 1,0,[n.clone(),n.clone(),n.clone()]));this.faceVertexUvs[0].push([uvs[i].clone(),uvs[i + 1].clone(),centerUV.clone()]);}this.computeFaceNormals();this.boundingSphere = new THREE.Sphere(new THREE.Vector3(),radius);};THREE.CircleGeometry.prototype = _Object$create(THREE.Geometry.prototype);THREE.CircleGeometry.prototype.constructor = THREE.CircleGeometry;THREE.CircleGeometry.prototype.clone = function(){var geometry=new THREE.CircleGeometry(this.parameters.radius,this.parameters.segments,this.parameters.thetaStart,this.parameters.thetaLength);return geometry;}; // File:src/extras/geometries/CircleBufferGeometry.js\n\t/**\n\t * @author benaadams / https://twitter.com/ben_a_adams\n\t */THREE.CircleBufferGeometry = function(radius,segments,thetaStart,thetaLength){THREE.BufferGeometry.call(this);this.type = 'CircleBufferGeometry';this.parameters = {radius:radius,segments:segments,thetaStart:thetaStart,thetaLength:thetaLength};radius = radius || 50;segments = segments !== undefined?Math.max(3,segments):8;thetaStart = thetaStart !== undefined?thetaStart:0;thetaLength = thetaLength !== undefined?thetaLength:Math.PI * 2;var vertices=segments + 2;var positions=new Float32Array(vertices * 3);var normals=new Float32Array(vertices * 3);var uvs=new Float32Array(vertices * 2); // center data is already zero, but need to set a few extras\n\tnormals[3] = 1.0;uvs[0] = 0.5;uvs[1] = 0.5;for(var s=0,i=3,ii=2;s <= segments;s++,i += 3,ii += 2) {var segment=thetaStart + s / segments * thetaLength;positions[i] = radius * Math.cos(segment);positions[i + 1] = radius * Math.sin(segment);normals[i + 2] = 1; // normal z\n\tuvs[ii] = (positions[i] / radius + 1) / 2;uvs[ii + 1] = (positions[i + 1] / radius + 1) / 2;}var indices=[];for(var i=1;i <= segments;i++) {indices.push(i);indices.push(i + 1);indices.push(0);}this.setIndex(new THREE.BufferAttribute(new Uint16Array(indices),1));this.addAttribute('position',new THREE.BufferAttribute(positions,3));this.addAttribute('normal',new THREE.BufferAttribute(normals,3));this.addAttribute('uv',new THREE.BufferAttribute(uvs,2));this.boundingSphere = new THREE.Sphere(new THREE.Vector3(),radius);};THREE.CircleBufferGeometry.prototype = _Object$create(THREE.BufferGeometry.prototype);THREE.CircleBufferGeometry.prototype.constructor = THREE.CircleBufferGeometry;THREE.CircleBufferGeometry.prototype.clone = function(){var geometry=new THREE.CircleBufferGeometry(this.parameters.radius,this.parameters.segments,this.parameters.thetaStart,this.parameters.thetaLength);geometry.copy(this);return geometry;}; // File:src/extras/geometries/CylinderGeometry.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */THREE.CylinderGeometry = function(radiusTop,radiusBottom,height,radialSegments,heightSegments,openEnded,thetaStart,thetaLength){THREE.Geometry.call(this);this.type = 'CylinderGeometry';this.parameters = {radiusTop:radiusTop,radiusBottom:radiusBottom,height:height,radialSegments:radialSegments,heightSegments:heightSegments,openEnded:openEnded,thetaStart:thetaStart,thetaLength:thetaLength};radiusTop = radiusTop !== undefined?radiusTop:20;radiusBottom = radiusBottom !== undefined?radiusBottom:20;height = height !== undefined?height:100;radialSegments = radialSegments || 8;heightSegments = heightSegments || 1;openEnded = openEnded !== undefined?openEnded:false;thetaStart = thetaStart !== undefined?thetaStart:0;thetaLength = thetaLength !== undefined?thetaLength:2 * Math.PI;var heightHalf=height / 2;var x,y,vertices=[],uvs=[];for(y = 0;y <= heightSegments;y++) {var verticesRow=[];var uvsRow=[];var v=y / heightSegments;var radius=v * (radiusBottom - radiusTop) + radiusTop;for(x = 0;x <= radialSegments;x++) {var u=x / radialSegments;var vertex=new THREE.Vector3();vertex.x = radius * Math.sin(u * thetaLength + thetaStart);vertex.y = -v * height + heightHalf;vertex.z = radius * Math.cos(u * thetaLength + thetaStart);this.vertices.push(vertex);verticesRow.push(this.vertices.length - 1);uvsRow.push(new THREE.Vector2(u,1 - v));}vertices.push(verticesRow);uvs.push(uvsRow);}var tanTheta=(radiusBottom - radiusTop) / height;var na,nb;for(x = 0;x < radialSegments;x++) {if(radiusTop !== 0){na = this.vertices[vertices[0][x]].clone();nb = this.vertices[vertices[0][x + 1]].clone();}else {na = this.vertices[vertices[1][x]].clone();nb = this.vertices[vertices[1][x + 1]].clone();}na.setY(Math.sqrt(na.x * na.x + na.z * na.z) * tanTheta).normalize();nb.setY(Math.sqrt(nb.x * nb.x + nb.z * nb.z) * tanTheta).normalize();for(y = 0;y < heightSegments;y++) {var v1=vertices[y][x];var v2=vertices[y + 1][x];var v3=vertices[y + 1][x + 1];var v4=vertices[y][x + 1];var n1=na.clone();var n2=na.clone();var n3=nb.clone();var n4=nb.clone();var uv1=uvs[y][x].clone();var uv2=uvs[y + 1][x].clone();var uv3=uvs[y + 1][x + 1].clone();var uv4=uvs[y][x + 1].clone();this.faces.push(new THREE.Face3(v1,v2,v4,[n1,n2,n4]));this.faceVertexUvs[0].push([uv1,uv2,uv4]);this.faces.push(new THREE.Face3(v2,v3,v4,[n2.clone(),n3,n4.clone()]));this.faceVertexUvs[0].push([uv2.clone(),uv3,uv4.clone()]);}} // top cap\n\tif(openEnded === false && radiusTop > 0){this.vertices.push(new THREE.Vector3(0,heightHalf,0));for(x = 0;x < radialSegments;x++) {var v1=vertices[0][x];var v2=vertices[0][x + 1];var v3=this.vertices.length - 1;var n1=new THREE.Vector3(0,1,0);var n2=new THREE.Vector3(0,1,0);var n3=new THREE.Vector3(0,1,0);var uv1=uvs[0][x].clone();var uv2=uvs[0][x + 1].clone();var uv3=new THREE.Vector2(uv2.x,0);this.faces.push(new THREE.Face3(v1,v2,v3,[n1,n2,n3],undefined,1));this.faceVertexUvs[0].push([uv1,uv2,uv3]);}} // bottom cap\n\tif(openEnded === false && radiusBottom > 0){this.vertices.push(new THREE.Vector3(0,-heightHalf,0));for(x = 0;x < radialSegments;x++) {var v1=vertices[heightSegments][x + 1];var v2=vertices[heightSegments][x];var v3=this.vertices.length - 1;var n1=new THREE.Vector3(0,-1,0);var n2=new THREE.Vector3(0,-1,0);var n3=new THREE.Vector3(0,-1,0);var uv1=uvs[heightSegments][x + 1].clone();var uv2=uvs[heightSegments][x].clone();var uv3=new THREE.Vector2(uv2.x,1);this.faces.push(new THREE.Face3(v1,v2,v3,[n1,n2,n3],undefined,2));this.faceVertexUvs[0].push([uv1,uv2,uv3]);}}this.computeFaceNormals();};THREE.CylinderGeometry.prototype = _Object$create(THREE.Geometry.prototype);THREE.CylinderGeometry.prototype.constructor = THREE.CylinderGeometry;THREE.CylinderGeometry.prototype.clone = function(){var geometry=new THREE.CylinderGeometry(this.parameters.radiusTop,this.parameters.radiusBottom,this.parameters.height,this.parameters.radialSegments,this.parameters.heightSegments,this.parameters.openEnded,this.parameters.thetaStart,this.parameters.thetaLength);return geometry;}; // File:src/extras/geometries/EdgesGeometry.js\n\t/**\n\t * @author WestLangley / http://github.com/WestLangley\n\t */THREE.EdgesGeometry = function(geometry,thresholdAngle){THREE.BufferGeometry.call(this);thresholdAngle = thresholdAngle !== undefined?thresholdAngle:1;var thresholdDot=Math.cos(THREE.Math.degToRad(thresholdAngle));var edge=[0,0],hash={};var sortFunction=function sortFunction(a,b){return a - b;};var keys=['a','b','c'];var geometry2;if(geometry instanceof THREE.BufferGeometry){geometry2 = new THREE.Geometry();geometry2.fromBufferGeometry(geometry);}else {geometry2 = geometry.clone();}geometry2.mergeVertices();geometry2.computeFaceNormals();var vertices=geometry2.vertices;var faces=geometry2.faces;for(var i=0,l=faces.length;i < l;i++) {var face=faces[i];for(var j=0;j < 3;j++) {edge[0] = face[keys[j]];edge[1] = face[keys[(j + 1) % 3]];edge.sort(sortFunction);var key=edge.toString();if(hash[key] === undefined){hash[key] = {vert1:edge[0],vert2:edge[1],face1:i,face2:undefined};}else {hash[key].face2 = i;}}}var coords=[];for(var key in hash) {var h=hash[key];if(h.face2 === undefined || faces[h.face1].normal.dot(faces[h.face2].normal) <= thresholdDot){var vertex=vertices[h.vert1];coords.push(vertex.x);coords.push(vertex.y);coords.push(vertex.z);vertex = vertices[h.vert2];coords.push(vertex.x);coords.push(vertex.y);coords.push(vertex.z);}}this.addAttribute('position',new THREE.BufferAttribute(new Float32Array(coords),3));};THREE.EdgesGeometry.prototype = _Object$create(THREE.BufferGeometry.prototype);THREE.EdgesGeometry.prototype.constructor = THREE.EdgesGeometry; // File:src/extras/geometries/ExtrudeGeometry.js\n\t/**\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\n\t *\n\t * Creates extruded geometry from a path shape.\n\t *\n\t * parameters = {\n\t *\n\t *  curveSegments: <int>, // number of points on the curves\n\t *  steps: <int>, // number of points for z-side extrusions / used for subdividing segments of extrude spline too\n\t *  amount: <int>, // Depth to extrude the shape\n\t *\n\t *  bevelEnabled: <bool>, // turn on bevel\n\t *  bevelThickness: <float>, // how deep into the original shape bevel goes\n\t *  bevelSize: <float>, // how far from shape outline is bevel\n\t *  bevelSegments: <int>, // number of bevel layers\n\t *\n\t *  extrudePath: <THREE.CurvePath> // 3d spline path to extrude shape along. (creates Frames if .frames aren't defined)\n\t *  frames: <THREE.TubeGeometry.FrenetFrames> // containing arrays of tangents, normals, binormals\n\t *\n\t *  uvGenerator: <Object> // object that provides UV generator functions\n\t *\n\t * }\n\t **/THREE.ExtrudeGeometry = function(shapes,options){if(typeof shapes === \"undefined\"){shapes = [];return;}THREE.Geometry.call(this);this.type = 'ExtrudeGeometry';shapes = Array.isArray(shapes)?shapes:[shapes];this.addShapeList(shapes,options);this.computeFaceNormals(); // can't really use automatic vertex normals\n\t// as then front and back sides get smoothed too\n\t// should do separate smoothing just for sides\n\t//this.computeVertexNormals();\n\t//console.log( \"took\", ( Date.now() - startTime ) );\n\t};THREE.ExtrudeGeometry.prototype = _Object$create(THREE.Geometry.prototype);THREE.ExtrudeGeometry.prototype.constructor = THREE.ExtrudeGeometry;THREE.ExtrudeGeometry.prototype.addShapeList = function(shapes,options){var sl=shapes.length;for(var s=0;s < sl;s++) {var shape=shapes[s];this.addShape(shape,options);}};THREE.ExtrudeGeometry.prototype.addShape = function(shape,options){var amount=options.amount !== undefined?options.amount:100;var bevelThickness=options.bevelThickness !== undefined?options.bevelThickness:6; // 10\n\tvar bevelSize=options.bevelSize !== undefined?options.bevelSize:bevelThickness - 2; // 8\n\tvar bevelSegments=options.bevelSegments !== undefined?options.bevelSegments:3;var bevelEnabled=options.bevelEnabled !== undefined?options.bevelEnabled:true; // false\n\tvar curveSegments=options.curveSegments !== undefined?options.curveSegments:12;var steps=options.steps !== undefined?options.steps:1;var extrudePath=options.extrudePath;var extrudePts,extrudeByPath=false; // Use default WorldUVGenerator if no UV generators are specified.\n\tvar uvgen=options.UVGenerator !== undefined?options.UVGenerator:THREE.ExtrudeGeometry.WorldUVGenerator;var splineTube,binormal,normal,position2;if(extrudePath){extrudePts = extrudePath.getSpacedPoints(steps);extrudeByPath = true;bevelEnabled = false; // bevels not supported for path extrusion\n\t// SETUP TNB variables\n\t// Reuse TNB from TubeGeomtry for now.\n\t// TODO1 - have a .isClosed in spline?\n\tsplineTube = options.frames !== undefined?options.frames:new THREE.TubeGeometry.FrenetFrames(extrudePath,steps,false); // console.log(splineTube, 'splineTube', splineTube.normals.length, 'steps', steps, 'extrudePts', extrudePts.length);\n\tbinormal = new THREE.Vector3();normal = new THREE.Vector3();position2 = new THREE.Vector3();} // Safeguards if bevels are not enabled\n\tif(!bevelEnabled){bevelSegments = 0;bevelThickness = 0;bevelSize = 0;} // Variables initialization\n\tvar ahole,h,hl; // looping of holes\n\tvar scope=this;var shapesOffset=this.vertices.length;var shapePoints=shape.extractPoints(curveSegments);var vertices=shapePoints.shape;var holes=shapePoints.holes;var reverse=!THREE.Shape.Utils.isClockWise(vertices);if(reverse){vertices = vertices.reverse(); // Maybe we should also check if holes are in the opposite direction, just to be safe ...\n\tfor(h = 0,hl = holes.length;h < hl;h++) {ahole = holes[h];if(THREE.Shape.Utils.isClockWise(ahole)){holes[h] = ahole.reverse();}}reverse = false; // If vertices are in order now, we shouldn't need to worry about them again (hopefully)!\n\t}var faces=THREE.Shape.Utils.triangulateShape(vertices,holes); /* Vertices */var contour=vertices; // vertices has all points but contour has only points of circumference\n\tfor(h = 0,hl = holes.length;h < hl;h++) {ahole = holes[h];vertices = vertices.concat(ahole);}function scalePt2(pt,vec,size){if(!vec)console.error(\"THREE.ExtrudeGeometry: vec does not exist\");return vec.clone().multiplyScalar(size).add(pt);}var b,bs,t,z,vert,vlen=vertices.length,face,flen=faces.length; // Find directions for point movement\n\tfunction getBevelVec(inPt,inPrev,inNext){var EPSILON=0.0000000001; // computes for inPt the corresponding point inPt' on a new contour\n\t//   shifted by 1 unit (length of normalized vector) to the left\n\t// if we walk along contour clockwise, this new contour is outside the old one\n\t//\n\t// inPt' is the intersection of the two lines parallel to the two\n\t//  adjacent edges of inPt at a distance of 1 unit on the left side.\n\tvar v_trans_x,v_trans_y,shrink_by=1; // resulting translation vector for inPt\n\t// good reading for geometry algorithms (here: line-line intersection)\n\t// http://geomalgorithms.com/a05-_intersect-1.html\n\tvar v_prev_x=inPt.x - inPrev.x,v_prev_y=inPt.y - inPrev.y;var v_next_x=inNext.x - inPt.x,v_next_y=inNext.y - inPt.y;var v_prev_lensq=v_prev_x * v_prev_x + v_prev_y * v_prev_y; // check for collinear edges\n\tvar collinear0=v_prev_x * v_next_y - v_prev_y * v_next_x;if(Math.abs(collinear0) > EPSILON){ // not collinear\n\t// length of vectors for normalizing\n\tvar v_prev_len=Math.sqrt(v_prev_lensq);var v_next_len=Math.sqrt(v_next_x * v_next_x + v_next_y * v_next_y); // shift adjacent points by unit vectors to the left\n\tvar ptPrevShift_x=inPrev.x - v_prev_y / v_prev_len;var ptPrevShift_y=inPrev.y + v_prev_x / v_prev_len;var ptNextShift_x=inNext.x - v_next_y / v_next_len;var ptNextShift_y=inNext.y + v_next_x / v_next_len; // scaling factor for v_prev to intersection point\n\tvar sf=((ptNextShift_x - ptPrevShift_x) * v_next_y - (ptNextShift_y - ptPrevShift_y) * v_next_x) / (v_prev_x * v_next_y - v_prev_y * v_next_x); // vector from inPt to intersection point\n\tv_trans_x = ptPrevShift_x + v_prev_x * sf - inPt.x;v_trans_y = ptPrevShift_y + v_prev_y * sf - inPt.y; // Don't normalize!, otherwise sharp corners become ugly\n\t//  but prevent crazy spikes\n\tvar v_trans_lensq=v_trans_x * v_trans_x + v_trans_y * v_trans_y;if(v_trans_lensq <= 2){return new THREE.Vector2(v_trans_x,v_trans_y);}else {shrink_by = Math.sqrt(v_trans_lensq / 2);}}else { // handle special case of collinear edges\n\tvar direction_eq=false; // assumes: opposite\n\tif(v_prev_x > EPSILON){if(v_next_x > EPSILON){direction_eq = true;}}else {if(v_prev_x < -EPSILON){if(v_next_x < -EPSILON){direction_eq = true;}}else {if(_Math$sign(v_prev_y) === _Math$sign(v_next_y)){direction_eq = true;}}}if(direction_eq){ // console.log(\"Warning: lines are a straight sequence\");\n\tv_trans_x = -v_prev_y;v_trans_y = v_prev_x;shrink_by = Math.sqrt(v_prev_lensq);}else { // console.log(\"Warning: lines are a straight spike\");\n\tv_trans_x = v_prev_x;v_trans_y = v_prev_y;shrink_by = Math.sqrt(v_prev_lensq / 2);}}return new THREE.Vector2(v_trans_x / shrink_by,v_trans_y / shrink_by);}var contourMovements=[];for(var i=0,il=contour.length,j=il - 1,k=i + 1;i < il;i++,j++,k++) {if(j === il)j = 0;if(k === il)k = 0; //  (j)---(i)---(k)\n\t// console.log('i,j,k', i, j , k)\n\tcontourMovements[i] = getBevelVec(contour[i],contour[j],contour[k]);}var holesMovements=[],oneHoleMovements,verticesMovements=contourMovements.concat();for(h = 0,hl = holes.length;h < hl;h++) {ahole = holes[h];oneHoleMovements = [];for(i = 0,il = ahole.length,j = il - 1,k = i + 1;i < il;i++,j++,k++) {if(j === il)j = 0;if(k === il)k = 0; //  (j)---(i)---(k)\n\toneHoleMovements[i] = getBevelVec(ahole[i],ahole[j],ahole[k]);}holesMovements.push(oneHoleMovements);verticesMovements = verticesMovements.concat(oneHoleMovements);} // Loop bevelSegments, 1 for the front, 1 for the back\n\tfor(b = 0;b < bevelSegments;b++) { //for ( b = bevelSegments; b > 0; b -- ) {\n\tt = b / bevelSegments;z = bevelThickness * (1 - t); //z = bevelThickness * t;\n\tbs = bevelSize * Math.sin(t * Math.PI / 2); // curved\n\t//bs = bevelSize * t; // linear\n\t// contract shape\n\tfor(i = 0,il = contour.length;i < il;i++) {vert = scalePt2(contour[i],contourMovements[i],bs);v(vert.x,vert.y,-z);} // expand holes\n\tfor(h = 0,hl = holes.length;h < hl;h++) {ahole = holes[h];oneHoleMovements = holesMovements[h];for(i = 0,il = ahole.length;i < il;i++) {vert = scalePt2(ahole[i],oneHoleMovements[i],bs);v(vert.x,vert.y,-z);}}}bs = bevelSize; // Back facing vertices\n\tfor(i = 0;i < vlen;i++) {vert = bevelEnabled?scalePt2(vertices[i],verticesMovements[i],bs):vertices[i];if(!extrudeByPath){v(vert.x,vert.y,0);}else { // v( vert.x, vert.y + extrudePts[ 0 ].y, extrudePts[ 0 ].x );\n\tnormal.copy(splineTube.normals[0]).multiplyScalar(vert.x);binormal.copy(splineTube.binormals[0]).multiplyScalar(vert.y);position2.copy(extrudePts[0]).add(normal).add(binormal);v(position2.x,position2.y,position2.z);}} // Add stepped vertices...\n\t// Including front facing vertices\n\tvar s;for(s = 1;s <= steps;s++) {for(i = 0;i < vlen;i++) {vert = bevelEnabled?scalePt2(vertices[i],verticesMovements[i],bs):vertices[i];if(!extrudeByPath){v(vert.x,vert.y,amount / steps * s);}else { // v( vert.x, vert.y + extrudePts[ s - 1 ].y, extrudePts[ s - 1 ].x );\n\tnormal.copy(splineTube.normals[s]).multiplyScalar(vert.x);binormal.copy(splineTube.binormals[s]).multiplyScalar(vert.y);position2.copy(extrudePts[s]).add(normal).add(binormal);v(position2.x,position2.y,position2.z);}}} // Add bevel segments planes\n\t//for ( b = 1; b <= bevelSegments; b ++ ) {\n\tfor(b = bevelSegments - 1;b >= 0;b--) {t = b / bevelSegments;z = bevelThickness * (1 - t); //bs = bevelSize * ( 1-Math.sin ( ( 1 - t ) * Math.PI/2 ) );\n\tbs = bevelSize * Math.sin(t * Math.PI / 2); // contract shape\n\tfor(i = 0,il = contour.length;i < il;i++) {vert = scalePt2(contour[i],contourMovements[i],bs);v(vert.x,vert.y,amount + z);} // expand holes\n\tfor(h = 0,hl = holes.length;h < hl;h++) {ahole = holes[h];oneHoleMovements = holesMovements[h];for(i = 0,il = ahole.length;i < il;i++) {vert = scalePt2(ahole[i],oneHoleMovements[i],bs);if(!extrudeByPath){v(vert.x,vert.y,amount + z);}else {v(vert.x,vert.y + extrudePts[steps - 1].y,extrudePts[steps - 1].x + z);}}}} /* Faces */ // Top and bottom faces\n\tbuildLidFaces(); // Sides faces\n\tbuildSideFaces(); /////  Internal functions\n\tfunction buildLidFaces(){if(bevelEnabled){var layer=0; // steps + 1\n\tvar offset=vlen * layer; // Bottom faces\n\tfor(i = 0;i < flen;i++) {face = faces[i];f3(face[2] + offset,face[1] + offset,face[0] + offset);}layer = steps + bevelSegments * 2;offset = vlen * layer; // Top faces\n\tfor(i = 0;i < flen;i++) {face = faces[i];f3(face[0] + offset,face[1] + offset,face[2] + offset);}}else { // Bottom faces\n\tfor(i = 0;i < flen;i++) {face = faces[i];f3(face[2],face[1],face[0]);} // Top faces\n\tfor(i = 0;i < flen;i++) {face = faces[i];f3(face[0] + vlen * steps,face[1] + vlen * steps,face[2] + vlen * steps);}}} // Create faces for the z-sides of the shape\n\tfunction buildSideFaces(){var layeroffset=0;sidewalls(contour,layeroffset);layeroffset += contour.length;for(h = 0,hl = holes.length;h < hl;h++) {ahole = holes[h];sidewalls(ahole,layeroffset); //, true\n\tlayeroffset += ahole.length;}}function sidewalls(contour,layeroffset){var j,k;i = contour.length;while(--i >= 0) {j = i;k = i - 1;if(k < 0)k = contour.length - 1; //console.log('b', i,j, i-1, k,vertices.length);\n\tvar s=0,sl=steps + bevelSegments * 2;for(s = 0;s < sl;s++) {var slen1=vlen * s;var slen2=vlen * (s + 1);var a=layeroffset + j + slen1,b=layeroffset + k + slen1,c=layeroffset + k + slen2,d=layeroffset + j + slen2;f4(a,b,c,d,contour,s,sl,j,k);}}}function v(x,y,z){scope.vertices.push(new THREE.Vector3(x,y,z));}function f3(a,b,c){a += shapesOffset;b += shapesOffset;c += shapesOffset;scope.faces.push(new THREE.Face3(a,b,c));var uvs=uvgen.generateTopUV(scope,a,b,c);scope.faceVertexUvs[0].push(uvs);}function f4(a,b,c,d,wallContour,stepIndex,stepsLength,contourIndex1,contourIndex2){a += shapesOffset;b += shapesOffset;c += shapesOffset;d += shapesOffset;scope.faces.push(new THREE.Face3(a,b,d));scope.faces.push(new THREE.Face3(b,c,d));var uvs=uvgen.generateSideWallUV(scope,a,b,c,d);scope.faceVertexUvs[0].push([uvs[0],uvs[1],uvs[3]]);scope.faceVertexUvs[0].push([uvs[1],uvs[2],uvs[3]]);}};THREE.ExtrudeGeometry.WorldUVGenerator = {generateTopUV:function generateTopUV(geometry,indexA,indexB,indexC){var vertices=geometry.vertices;var a=vertices[indexA];var b=vertices[indexB];var c=vertices[indexC];return [new THREE.Vector2(a.x,a.y),new THREE.Vector2(b.x,b.y),new THREE.Vector2(c.x,c.y)];},generateSideWallUV:function generateSideWallUV(geometry,indexA,indexB,indexC,indexD){var vertices=geometry.vertices;var a=vertices[indexA];var b=vertices[indexB];var c=vertices[indexC];var d=vertices[indexD];if(Math.abs(a.y - b.y) < 0.01){return [new THREE.Vector2(a.x,1 - a.z),new THREE.Vector2(b.x,1 - b.z),new THREE.Vector2(c.x,1 - c.z),new THREE.Vector2(d.x,1 - d.z)];}else {return [new THREE.Vector2(a.y,1 - a.z),new THREE.Vector2(b.y,1 - b.z),new THREE.Vector2(c.y,1 - c.z),new THREE.Vector2(d.y,1 - d.z)];}}}; // File:src/extras/geometries/ShapeGeometry.js\n\t/**\n\t * @author jonobr1 / http://jonobr1.com\n\t *\n\t * Creates a one-sided polygonal geometry from a path shape. Similar to\n\t * ExtrudeGeometry.\n\t *\n\t * parameters = {\n\t *\n\t *\tcurveSegments: <int>, // number of points on the curves. NOT USED AT THE MOMENT.\n\t *\n\t *\tmaterial: <int> // material index for front and back faces\n\t *\tuvGenerator: <Object> // object that provides UV generator functions\n\t *\n\t * }\n\t **/THREE.ShapeGeometry = function(shapes,options){THREE.Geometry.call(this);this.type = 'ShapeGeometry';if(Array.isArray(shapes) === false)shapes = [shapes];this.addShapeList(shapes,options);this.computeFaceNormals();};THREE.ShapeGeometry.prototype = _Object$create(THREE.Geometry.prototype);THREE.ShapeGeometry.prototype.constructor = THREE.ShapeGeometry; /**\n\t * Add an array of shapes to THREE.ShapeGeometry.\n\t */THREE.ShapeGeometry.prototype.addShapeList = function(shapes,options){for(var i=0,l=shapes.length;i < l;i++) {this.addShape(shapes[i],options);}return this;}; /**\n\t * Adds a shape to THREE.ShapeGeometry, based on THREE.ExtrudeGeometry.\n\t */THREE.ShapeGeometry.prototype.addShape = function(shape,options){if(options === undefined)options = {};var curveSegments=options.curveSegments !== undefined?options.curveSegments:12;var material=options.material;var uvgen=options.UVGenerator === undefined?THREE.ExtrudeGeometry.WorldUVGenerator:options.UVGenerator; //\n\tvar i,l,hole;var shapesOffset=this.vertices.length;var shapePoints=shape.extractPoints(curveSegments);var vertices=shapePoints.shape;var holes=shapePoints.holes;var reverse=!THREE.Shape.Utils.isClockWise(vertices);if(reverse){vertices = vertices.reverse(); // Maybe we should also check if holes are in the opposite direction, just to be safe...\n\tfor(i = 0,l = holes.length;i < l;i++) {hole = holes[i];if(THREE.Shape.Utils.isClockWise(hole)){holes[i] = hole.reverse();}}reverse = false;}var faces=THREE.Shape.Utils.triangulateShape(vertices,holes); // Vertices\n\tfor(i = 0,l = holes.length;i < l;i++) {hole = holes[i];vertices = vertices.concat(hole);} //\n\tvar vert,vlen=vertices.length;var face,flen=faces.length;for(i = 0;i < vlen;i++) {vert = vertices[i];this.vertices.push(new THREE.Vector3(vert.x,vert.y,0));}for(i = 0;i < flen;i++) {face = faces[i];var a=face[0] + shapesOffset;var b=face[1] + shapesOffset;var c=face[2] + shapesOffset;this.faces.push(new THREE.Face3(a,b,c,null,null,material));this.faceVertexUvs[0].push(uvgen.generateTopUV(this,a,b,c));}}; // File:src/extras/geometries/LatheGeometry.js\n\t/**\n\t * @author astrodud / http://astrodud.isgreat.org/\n\t * @author zz85 / https://github.com/zz85\n\t * @author bhouston / http://exocortex.com\n\t */ // points - to create a closed torus, one must use a set of points \n\t//    like so: [ a, b, c, d, a ], see first is the same as last.\n\t// segments - the number of circumference segments to create\n\t// phiStart - the starting radian\n\t// phiLength - the radian (0 to 2*PI) range of the lathed section\n\t//    2*pi is a closed lathe, less than 2PI is a portion.\n\tTHREE.LatheGeometry = function(points,segments,phiStart,phiLength){THREE.Geometry.call(this);this.type = 'LatheGeometry';this.parameters = {points:points,segments:segments,phiStart:phiStart,phiLength:phiLength};segments = segments || 12;phiStart = phiStart || 0;phiLength = phiLength || 2 * Math.PI;var inversePointLength=1.0 / (points.length - 1);var inverseSegments=1.0 / segments;for(var i=0,il=segments;i <= il;i++) {var phi=phiStart + i * inverseSegments * phiLength;var c=Math.cos(phi),s=Math.sin(phi);for(var j=0,jl=points.length;j < jl;j++) {var pt=points[j];var vertex=new THREE.Vector3();vertex.x = c * pt.x - s * pt.y;vertex.y = s * pt.x + c * pt.y;vertex.z = pt.z;this.vertices.push(vertex);}}var np=points.length;for(var i=0,il=segments;i < il;i++) {for(var j=0,jl=points.length - 1;j < jl;j++) {var base=j + np * i;var a=base;var b=base + np;var c=base + 1 + np;var d=base + 1;var u0=i * inverseSegments;var v0=j * inversePointLength;var u1=u0 + inverseSegments;var v1=v0 + inversePointLength;this.faces.push(new THREE.Face3(a,b,d));this.faceVertexUvs[0].push([new THREE.Vector2(u0,v0),new THREE.Vector2(u1,v0),new THREE.Vector2(u0,v1)]);this.faces.push(new THREE.Face3(b,c,d));this.faceVertexUvs[0].push([new THREE.Vector2(u1,v0),new THREE.Vector2(u1,v1),new THREE.Vector2(u0,v1)]);}}this.mergeVertices();this.computeFaceNormals();this.computeVertexNormals();};THREE.LatheGeometry.prototype = _Object$create(THREE.Geometry.prototype);THREE.LatheGeometry.prototype.constructor = THREE.LatheGeometry; // File:src/extras/geometries/PlaneGeometry.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * based on http://papervision3d.googlecode.com/svn/trunk/as3/trunk/src/org/papervision3d/objects/primitives/Plane.as\n\t */THREE.PlaneGeometry = function(width,height,widthSegments,heightSegments){THREE.Geometry.call(this);this.type = 'PlaneGeometry';this.parameters = {width:width,height:height,widthSegments:widthSegments,heightSegments:heightSegments};this.fromBufferGeometry(new THREE.PlaneBufferGeometry(width,height,widthSegments,heightSegments));};THREE.PlaneGeometry.prototype = _Object$create(THREE.Geometry.prototype);THREE.PlaneGeometry.prototype.constructor = THREE.PlaneGeometry;THREE.PlaneGeometry.prototype.clone = function(){var geometry=new THREE.PlaneGeometry(this.parameters.width,this.parameters.height,this.parameters.widthSegments,this.parameters.heightSegments);return geometry;}; // File:src/extras/geometries/PlaneBufferGeometry.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * based on http://papervision3d.googlecode.com/svn/trunk/as3/trunk/src/org/papervision3d/objects/primitives/Plane.as\n\t */THREE.PlaneBufferGeometry = function(width,height,widthSegments,heightSegments){THREE.BufferGeometry.call(this);this.type = 'PlaneBufferGeometry';this.parameters = {width:width,height:height,widthSegments:widthSegments,heightSegments:heightSegments};var width_half=width / 2;var height_half=height / 2;var gridX=Math.floor(widthSegments) || 1;var gridY=Math.floor(heightSegments) || 1;var gridX1=gridX + 1;var gridY1=gridY + 1;var segment_width=width / gridX;var segment_height=height / gridY;var vertices=new Float32Array(gridX1 * gridY1 * 3);var normals=new Float32Array(gridX1 * gridY1 * 3);var uvs=new Float32Array(gridX1 * gridY1 * 2);var offset=0;var offset2=0;for(var iy=0;iy < gridY1;iy++) {var y=iy * segment_height - height_half;for(var ix=0;ix < gridX1;ix++) {var x=ix * segment_width - width_half;vertices[offset] = x;vertices[offset + 1] = -y;normals[offset + 2] = 1;uvs[offset2] = ix / gridX;uvs[offset2 + 1] = 1 - iy / gridY;offset += 3;offset2 += 2;}}offset = 0;var indices=new (vertices.length / 3 > 65535?Uint32Array:Uint16Array)(gridX * gridY * 6);for(var iy=0;iy < gridY;iy++) {for(var ix=0;ix < gridX;ix++) {var a=ix + gridX1 * iy;var b=ix + gridX1 * (iy + 1);var c=ix + 1 + gridX1 * (iy + 1);var d=ix + 1 + gridX1 * iy;indices[offset] = a;indices[offset + 1] = b;indices[offset + 2] = d;indices[offset + 3] = b;indices[offset + 4] = c;indices[offset + 5] = d;offset += 6;}}this.setIndex(new THREE.BufferAttribute(indices,1));this.addAttribute('position',new THREE.BufferAttribute(vertices,3));this.addAttribute('normal',new THREE.BufferAttribute(normals,3));this.addAttribute('uv',new THREE.BufferAttribute(uvs,2));};THREE.PlaneBufferGeometry.prototype = _Object$create(THREE.BufferGeometry.prototype);THREE.PlaneBufferGeometry.prototype.constructor = THREE.PlaneBufferGeometry;THREE.PlaneBufferGeometry.prototype.clone = function(){var geometry=new THREE.PlaneBufferGeometry(this.parameters.width,this.parameters.height,this.parameters.widthSegments,this.parameters.heightSegments);geometry.copy(this);return geometry;}; // File:src/extras/geometries/RingGeometry.js\n\t/**\n\t * @author Kaleb Murphy\n\t */THREE.RingGeometry = function(innerRadius,outerRadius,thetaSegments,phiSegments,thetaStart,thetaLength){THREE.Geometry.call(this);this.type = 'RingGeometry';this.parameters = {innerRadius:innerRadius,outerRadius:outerRadius,thetaSegments:thetaSegments,phiSegments:phiSegments,thetaStart:thetaStart,thetaLength:thetaLength};innerRadius = innerRadius || 0;outerRadius = outerRadius || 50;thetaStart = thetaStart !== undefined?thetaStart:0;thetaLength = thetaLength !== undefined?thetaLength:Math.PI * 2;thetaSegments = thetaSegments !== undefined?Math.max(3,thetaSegments):8;phiSegments = phiSegments !== undefined?Math.max(1,phiSegments):8;var i,o,uvs=[],radius=innerRadius,radiusStep=(outerRadius - innerRadius) / phiSegments;for(i = 0;i < phiSegments + 1;i++) { // concentric circles inside ring\n\tfor(o = 0;o < thetaSegments + 1;o++) { // number of segments per circle\n\tvar vertex=new THREE.Vector3();var segment=thetaStart + o / thetaSegments * thetaLength;vertex.x = radius * Math.cos(segment);vertex.y = radius * Math.sin(segment);this.vertices.push(vertex);uvs.push(new THREE.Vector2((vertex.x / outerRadius + 1) / 2,(vertex.y / outerRadius + 1) / 2));}radius += radiusStep;}var n=new THREE.Vector3(0,0,1);for(i = 0;i < phiSegments;i++) { // concentric circles inside ring\n\tvar thetaSegment=i * (thetaSegments + 1);for(o = 0;o < thetaSegments;o++) { // number of segments per circle\n\tvar segment=o + thetaSegment;var v1=segment;var v2=segment + thetaSegments + 1;var v3=segment + thetaSegments + 2;this.faces.push(new THREE.Face3(v1,v2,v3,[n.clone(),n.clone(),n.clone()]));this.faceVertexUvs[0].push([uvs[v1].clone(),uvs[v2].clone(),uvs[v3].clone()]);v1 = segment;v2 = segment + thetaSegments + 2;v3 = segment + 1;this.faces.push(new THREE.Face3(v1,v2,v3,[n.clone(),n.clone(),n.clone()]));this.faceVertexUvs[0].push([uvs[v1].clone(),uvs[v2].clone(),uvs[v3].clone()]);}}this.computeFaceNormals();this.boundingSphere = new THREE.Sphere(new THREE.Vector3(),radius);};THREE.RingGeometry.prototype = _Object$create(THREE.Geometry.prototype);THREE.RingGeometry.prototype.constructor = THREE.RingGeometry;THREE.RingGeometry.prototype.clone = function(){var geometry=new THREE.RingGeometry(this.parameters.innerRadius,this.parameters.outerRadius,this.parameters.thetaSegments,this.parameters.phiSegments,this.parameters.thetaStart,this.parameters.thetaLength);return geometry;}; // File:src/extras/geometries/SphereGeometry.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */THREE.SphereGeometry = function(radius,widthSegments,heightSegments,phiStart,phiLength,thetaStart,thetaLength){THREE.Geometry.call(this);this.type = 'SphereGeometry';this.parameters = {radius:radius,widthSegments:widthSegments,heightSegments:heightSegments,phiStart:phiStart,phiLength:phiLength,thetaStart:thetaStart,thetaLength:thetaLength};this.fromBufferGeometry(new THREE.SphereBufferGeometry(radius,widthSegments,heightSegments,phiStart,phiLength,thetaStart,thetaLength));};THREE.SphereGeometry.prototype = _Object$create(THREE.Geometry.prototype);THREE.SphereGeometry.prototype.constructor = THREE.SphereGeometry;THREE.SphereGeometry.prototype.clone = function(){var geometry=new THREE.SphereGeometry(this.parameters.radius,this.parameters.widthSegments,this.parameters.heightSegments,this.parameters.phiStart,this.parameters.phiLength,this.parameters.thetaStart,this.parameters.thetaLength);return geometry;}; // File:src/extras/geometries/SphereBufferGeometry.js\n\t/**\n\t * @author benaadams / https://twitter.com/ben_a_adams\n\t * based on THREE.SphereGeometry\n\t */THREE.SphereBufferGeometry = function(radius,widthSegments,heightSegments,phiStart,phiLength,thetaStart,thetaLength){THREE.BufferGeometry.call(this);this.type = 'SphereBufferGeometry';this.parameters = {radius:radius,widthSegments:widthSegments,heightSegments:heightSegments,phiStart:phiStart,phiLength:phiLength,thetaStart:thetaStart,thetaLength:thetaLength};radius = radius || 50;widthSegments = Math.max(3,Math.floor(widthSegments) || 8);heightSegments = Math.max(2,Math.floor(heightSegments) || 6);phiStart = phiStart !== undefined?phiStart:0;phiLength = phiLength !== undefined?phiLength:Math.PI * 2;thetaStart = thetaStart !== undefined?thetaStart:0;thetaLength = thetaLength !== undefined?thetaLength:Math.PI;var thetaEnd=thetaStart + thetaLength;var vertexCount=(widthSegments + 1) * (heightSegments + 1);var positions=new THREE.BufferAttribute(new Float32Array(vertexCount * 3),3);var normals=new THREE.BufferAttribute(new Float32Array(vertexCount * 3),3);var uvs=new THREE.BufferAttribute(new Float32Array(vertexCount * 2),2);var index=0,vertices=[],normal=new THREE.Vector3();for(var y=0;y <= heightSegments;y++) {var verticesRow=[];var v=y / heightSegments;for(var x=0;x <= widthSegments;x++) {var u=x / widthSegments;var px=-radius * Math.cos(phiStart + u * phiLength) * Math.sin(thetaStart + v * thetaLength);var py=radius * Math.cos(thetaStart + v * thetaLength);var pz=radius * Math.sin(phiStart + u * phiLength) * Math.sin(thetaStart + v * thetaLength);normal.set(px,py,pz).normalize();positions.setXYZ(index,px,py,pz);normals.setXYZ(index,normal.x,normal.y,normal.z);uvs.setXY(index,u,1 - v);verticesRow.push(index);index++;}vertices.push(verticesRow);}var indices=[];for(var y=0;y < heightSegments;y++) {for(var x=0;x < widthSegments;x++) {var v1=vertices[y][x + 1];var v2=vertices[y][x];var v3=vertices[y + 1][x];var v4=vertices[y + 1][x + 1];if(y !== 0 || thetaStart > 0)indices.push(v1,v2,v4);if(y !== heightSegments - 1 || thetaEnd < Math.PI)indices.push(v2,v3,v4);}}this.setIndex(new THREE.BufferAttribute(new Uint16Array(indices),1));this.addAttribute('position',positions);this.addAttribute('normal',normals);this.addAttribute('uv',uvs);this.boundingSphere = new THREE.Sphere(new THREE.Vector3(),radius);};THREE.SphereBufferGeometry.prototype = _Object$create(THREE.BufferGeometry.prototype);THREE.SphereBufferGeometry.prototype.constructor = THREE.SphereBufferGeometry;THREE.SphereBufferGeometry.prototype.clone = function(){var geometry=new THREE.SphereBufferGeometry(this.parameters.radius,this.parameters.widthSegments,this.parameters.heightSegments,this.parameters.phiStart,this.parameters.phiLength,this.parameters.thetaStart,this.parameters.thetaLength);geometry.copy(this);return geometry;}; // File:src/extras/geometries/TextGeometry.js\n\t/**\n\t * @author zz85 / http://www.lab4games.net/zz85/blog\n\t * @author alteredq / http://alteredqualia.com/\n\t *\n\t * For creating 3D text geometry in three.js\n\t *\n\t * Text = 3D Text\n\t *\n\t * parameters = {\n\t *  size: \t\t\t<float>, \t// size of the text\n\t *  height: \t\t<float>, \t// thickness to extrude text\n\t *  curveSegments: \t<int>,\t\t// number of points on the curves\n\t *\n\t *  font: \t\t\t<string>,\t\t// font name\n\t *  weight: \t\t<string>,\t\t// font weight (normal, bold)\n\t *  style: \t\t\t<string>,\t\t// font style  (normal, italics)\n\t *\n\t *  bevelEnabled:\t<bool>,\t\t\t// turn on bevel\n\t *  bevelThickness: <float>, \t\t// how deep into text bevel goes\n\t *  bevelSize:\t\t<float>, \t\t// how far from text outline is bevel\n\t *  }\n\t *\n\t */ /*\tUsage Examples\n\t\n\t\t// TextGeometry wrapper\n\t\n\t\tvar text3d = new TextGeometry( text, options );\n\t\n\t\t// Complete manner\n\t\n\t\tvar textShapes = THREE.FontUtils.generateShapes( text, options );\n\t\tvar text3d = new ExtrudeGeometry( textShapes, options );\n\t\n\t*/THREE.TextGeometry = function(text,parameters){parameters = parameters || {};var textShapes=THREE.FontUtils.generateShapes(text,parameters); // translate parameters to ExtrudeGeometry API\n\tparameters.amount = parameters.height !== undefined?parameters.height:50; // defaults\n\tif(parameters.bevelThickness === undefined)parameters.bevelThickness = 10;if(parameters.bevelSize === undefined)parameters.bevelSize = 8;if(parameters.bevelEnabled === undefined)parameters.bevelEnabled = false;THREE.ExtrudeGeometry.call(this,textShapes,parameters);this.type = 'TextGeometry';};THREE.TextGeometry.prototype = _Object$create(THREE.ExtrudeGeometry.prototype);THREE.TextGeometry.prototype.constructor = THREE.TextGeometry; // File:src/extras/geometries/TorusGeometry.js\n\t/**\n\t * @author oosmoxiecode\n\t * @author mrdoob / http://mrdoob.com/\n\t * based on http://code.google.com/p/away3d/source/browse/trunk/fp10/Away3DLite/src/away3dlite/primitives/Torus.as?r=2888\n\t */THREE.TorusGeometry = function(radius,tube,radialSegments,tubularSegments,arc){THREE.Geometry.call(this);this.type = 'TorusGeometry';this.parameters = {radius:radius,tube:tube,radialSegments:radialSegments,tubularSegments:tubularSegments,arc:arc};radius = radius || 100;tube = tube || 40;radialSegments = radialSegments || 8;tubularSegments = tubularSegments || 6;arc = arc || Math.PI * 2;var center=new THREE.Vector3(),uvs=[],normals=[];for(var j=0;j <= radialSegments;j++) {for(var i=0;i <= tubularSegments;i++) {var u=i / tubularSegments * arc;var v=j / radialSegments * Math.PI * 2;center.x = radius * Math.cos(u);center.y = radius * Math.sin(u);var vertex=new THREE.Vector3();vertex.x = (radius + tube * Math.cos(v)) * Math.cos(u);vertex.y = (radius + tube * Math.cos(v)) * Math.sin(u);vertex.z = tube * Math.sin(v);this.vertices.push(vertex);uvs.push(new THREE.Vector2(i / tubularSegments,j / radialSegments));normals.push(vertex.clone().sub(center).normalize());}}for(var j=1;j <= radialSegments;j++) {for(var i=1;i <= tubularSegments;i++) {var a=(tubularSegments + 1) * j + i - 1;var b=(tubularSegments + 1) * (j - 1) + i - 1;var c=(tubularSegments + 1) * (j - 1) + i;var d=(tubularSegments + 1) * j + i;var face=new THREE.Face3(a,b,d,[normals[a].clone(),normals[b].clone(),normals[d].clone()]);this.faces.push(face);this.faceVertexUvs[0].push([uvs[a].clone(),uvs[b].clone(),uvs[d].clone()]);face = new THREE.Face3(b,c,d,[normals[b].clone(),normals[c].clone(),normals[d].clone()]);this.faces.push(face);this.faceVertexUvs[0].push([uvs[b].clone(),uvs[c].clone(),uvs[d].clone()]);}}this.computeFaceNormals();};THREE.TorusGeometry.prototype = _Object$create(THREE.Geometry.prototype);THREE.TorusGeometry.prototype.constructor = THREE.TorusGeometry;THREE.TorusGeometry.prototype.clone = function(){var geometry=new THREE.TorusGeometry(this.parameters.radius,this.parameters.tube,this.parameters.radialSegments,this.parameters.tubularSegments,this.parameters.arc);return geometry;}; // File:src/extras/geometries/TorusKnotGeometry.js\n\t/**\n\t * @author oosmoxiecode\n\t * based on http://code.google.com/p/away3d/source/browse/trunk/fp10/Away3D/src/away3d/primitives/TorusKnot.as?spec=svn2473&r=2473\n\t */THREE.TorusKnotGeometry = function(radius,tube,radialSegments,tubularSegments,p,q,heightScale){THREE.Geometry.call(this);this.type = 'TorusKnotGeometry';this.parameters = {radius:radius,tube:tube,radialSegments:radialSegments,tubularSegments:tubularSegments,p:p,q:q,heightScale:heightScale};radius = radius || 100;tube = tube || 40;radialSegments = radialSegments || 64;tubularSegments = tubularSegments || 8;p = p || 2;q = q || 3;heightScale = heightScale || 1;var grid=new Array(radialSegments);var tang=new THREE.Vector3();var n=new THREE.Vector3();var bitan=new THREE.Vector3();for(var i=0;i < radialSegments;++i) {grid[i] = new Array(tubularSegments);var u=i / radialSegments * 2 * p * Math.PI;var p1=getPos(u,q,p,radius,heightScale);var p2=getPos(u + 0.01,q,p,radius,heightScale);tang.subVectors(p2,p1);n.addVectors(p2,p1);bitan.crossVectors(tang,n);n.crossVectors(bitan,tang);bitan.normalize();n.normalize();for(var j=0;j < tubularSegments;++j) {var v=j / tubularSegments * 2 * Math.PI;var cx=-tube * Math.cos(v); // TODO: Hack: Negating it so it faces outside.\n\tvar cy=tube * Math.sin(v);var pos=new THREE.Vector3();pos.x = p1.x + cx * n.x + cy * bitan.x;pos.y = p1.y + cx * n.y + cy * bitan.y;pos.z = p1.z + cx * n.z + cy * bitan.z;grid[i][j] = this.vertices.push(pos) - 1;}}for(var i=0;i < radialSegments;++i) {for(var j=0;j < tubularSegments;++j) {var ip=(i + 1) % radialSegments;var jp=(j + 1) % tubularSegments;var a=grid[i][j];var b=grid[ip][j];var c=grid[ip][jp];var d=grid[i][jp];var uva=new THREE.Vector2(i / radialSegments,j / tubularSegments);var uvb=new THREE.Vector2((i + 1) / radialSegments,j / tubularSegments);var uvc=new THREE.Vector2((i + 1) / radialSegments,(j + 1) / tubularSegments);var uvd=new THREE.Vector2(i / radialSegments,(j + 1) / tubularSegments);this.faces.push(new THREE.Face3(a,b,d));this.faceVertexUvs[0].push([uva,uvb,uvd]);this.faces.push(new THREE.Face3(b,c,d));this.faceVertexUvs[0].push([uvb.clone(),uvc,uvd.clone()]);}}this.computeFaceNormals();this.computeVertexNormals();function getPos(u,in_q,in_p,radius,heightScale){var cu=Math.cos(u);var su=Math.sin(u);var quOverP=in_q / in_p * u;var cs=Math.cos(quOverP);var tx=radius * (2 + cs) * 0.5 * cu;var ty=radius * (2 + cs) * su * 0.5;var tz=heightScale * radius * Math.sin(quOverP) * 0.5;return new THREE.Vector3(tx,ty,tz);}};THREE.TorusKnotGeometry.prototype = _Object$create(THREE.Geometry.prototype);THREE.TorusKnotGeometry.prototype.constructor = THREE.TorusKnotGeometry;THREE.TorusKnotGeometry.prototype.clone = function(){var geometry=new THREE.TorusKnotGeometry(this.parameters.radius,this.parameters.tube,this.parameters.radialSegments,this.parameters.tubularSegments,this.parameters.p,this.parameters.q,this.parameters.heightScale);return geometry;}; // File:src/extras/geometries/TubeGeometry.js\n\t/**\n\t * @author WestLangley / https://github.com/WestLangley\n\t * @author zz85 / https://github.com/zz85\n\t * @author miningold / https://github.com/miningold\n\t * @author jonobr1 / https://github.com/jonobr1\n\t *\n\t * Modified from the TorusKnotGeometry by @oosmoxiecode\n\t *\n\t * Creates a tube which extrudes along a 3d spline\n\t *\n\t * Uses parallel transport frames as described in\n\t * http://www.cs.indiana.edu/pub/techreports/TR425.pdf\n\t */THREE.TubeGeometry = function(path,segments,radius,radialSegments,closed,taper){THREE.Geometry.call(this);this.type = 'TubeGeometry';this.parameters = {path:path,segments:segments,radius:radius,radialSegments:radialSegments,closed:closed};segments = segments || 64;radius = radius || 1;radialSegments = radialSegments || 8;closed = closed || false;taper = taper || THREE.TubeGeometry.NoTaper;var grid=[];var scope=this,tangent,normal,binormal,numpoints=segments + 1,u,v,r,cx,cy,pos,pos2=new THREE.Vector3(),i,j,ip,jp,a,b,c,d,uva,uvb,uvc,uvd;var frames=new THREE.TubeGeometry.FrenetFrames(path,segments,closed),tangents=frames.tangents,normals=frames.normals,binormals=frames.binormals; // proxy internals\n\tthis.tangents = tangents;this.normals = normals;this.binormals = binormals;function vert(x,y,z){return scope.vertices.push(new THREE.Vector3(x,y,z)) - 1;} // construct the grid\n\tfor(i = 0;i < numpoints;i++) {grid[i] = [];u = i / (numpoints - 1);pos = path.getPointAt(u);tangent = tangents[i];normal = normals[i];binormal = binormals[i];r = radius * taper(u);for(j = 0;j < radialSegments;j++) {v = j / radialSegments * 2 * Math.PI;cx = -r * Math.cos(v); // TODO: Hack: Negating it so it faces outside.\n\tcy = r * Math.sin(v);pos2.copy(pos);pos2.x += cx * normal.x + cy * binormal.x;pos2.y += cx * normal.y + cy * binormal.y;pos2.z += cx * normal.z + cy * binormal.z;grid[i][j] = vert(pos2.x,pos2.y,pos2.z);}} // construct the mesh\n\tfor(i = 0;i < segments;i++) {for(j = 0;j < radialSegments;j++) {ip = closed?(i + 1) % segments:i + 1;jp = (j + 1) % radialSegments;a = grid[i][j]; // *** NOT NECESSARILY PLANAR ! ***\n\tb = grid[ip][j];c = grid[ip][jp];d = grid[i][jp];uva = new THREE.Vector2(i / segments,j / radialSegments);uvb = new THREE.Vector2((i + 1) / segments,j / radialSegments);uvc = new THREE.Vector2((i + 1) / segments,(j + 1) / radialSegments);uvd = new THREE.Vector2(i / segments,(j + 1) / radialSegments);this.faces.push(new THREE.Face3(a,b,d));this.faceVertexUvs[0].push([uva,uvb,uvd]);this.faces.push(new THREE.Face3(b,c,d));this.faceVertexUvs[0].push([uvb.clone(),uvc,uvd.clone()]);}}this.computeFaceNormals();this.computeVertexNormals();};THREE.TubeGeometry.prototype = _Object$create(THREE.Geometry.prototype);THREE.TubeGeometry.prototype.constructor = THREE.TubeGeometry;THREE.TubeGeometry.NoTaper = function(u){return 1;};THREE.TubeGeometry.SinusoidalTaper = function(u){return Math.sin(Math.PI * u);}; // For computing of Frenet frames, exposing the tangents, normals and binormals the spline\n\tTHREE.TubeGeometry.FrenetFrames = function(path,segments,closed){var normal=new THREE.Vector3(),tangents=[],normals=[],binormals=[],vec=new THREE.Vector3(),mat=new THREE.Matrix4(),numpoints=segments + 1,theta,epsilon=0.0001,smallest,tx,ty,tz,i,u; // expose internals\n\tthis.tangents = tangents;this.normals = normals;this.binormals = binormals; // compute the tangent vectors for each segment on the path\n\tfor(i = 0;i < numpoints;i++) {u = i / (numpoints - 1);tangents[i] = path.getTangentAt(u);tangents[i].normalize();}initialNormal3(); /*\n\t\tfunction initialNormal1(lastBinormal) {\n\t\t\t// fixed start binormal. Has dangers of 0 vectors\n\t\t\tnormals[ 0 ] = new THREE.Vector3();\n\t\t\tbinormals[ 0 ] = new THREE.Vector3();\n\t\t\tif (lastBinormal===undefined) lastBinormal = new THREE.Vector3( 0, 0, 1 );\n\t\t\tnormals[ 0 ].crossVectors( lastBinormal, tangents[ 0 ] ).normalize();\n\t\t\tbinormals[ 0 ].crossVectors( tangents[ 0 ], normals[ 0 ] ).normalize();\n\t\t}\n\t\n\t\tfunction initialNormal2() {\n\t\n\t\t\t// This uses the Frenet-Serret formula for deriving binormal\n\t\t\tvar t2 = path.getTangentAt( epsilon );\n\t\n\t\t\tnormals[ 0 ] = new THREE.Vector3().subVectors( t2, tangents[ 0 ] ).normalize();\n\t\t\tbinormals[ 0 ] = new THREE.Vector3().crossVectors( tangents[ 0 ], normals[ 0 ] );\n\t\n\t\t\tnormals[ 0 ].crossVectors( binormals[ 0 ], tangents[ 0 ] ).normalize(); // last binormal x tangent\n\t\t\tbinormals[ 0 ].crossVectors( tangents[ 0 ], normals[ 0 ] ).normalize();\n\t\n\t\t}\n\t\t*/function initialNormal3(){ // select an initial normal vector perpendicular to the first tangent vector,\n\t// and in the direction of the smallest tangent xyz component\n\tnormals[0] = new THREE.Vector3();binormals[0] = new THREE.Vector3();smallest = Number.MAX_VALUE;tx = Math.abs(tangents[0].x);ty = Math.abs(tangents[0].y);tz = Math.abs(tangents[0].z);if(tx <= smallest){smallest = tx;normal.set(1,0,0);}if(ty <= smallest){smallest = ty;normal.set(0,1,0);}if(tz <= smallest){normal.set(0,0,1);}vec.crossVectors(tangents[0],normal).normalize();normals[0].crossVectors(tangents[0],vec);binormals[0].crossVectors(tangents[0],normals[0]);} // compute the slowly-varying normal and binormal vectors for each segment on the path\n\tfor(i = 1;i < numpoints;i++) {normals[i] = normals[i - 1].clone();binormals[i] = binormals[i - 1].clone();vec.crossVectors(tangents[i - 1],tangents[i]);if(vec.length() > epsilon){vec.normalize();theta = Math.acos(THREE.Math.clamp(tangents[i - 1].dot(tangents[i]),-1,1)); // clamp for floating pt errors\n\tnormals[i].applyMatrix4(mat.makeRotationAxis(vec,theta));}binormals[i].crossVectors(tangents[i],normals[i]);} // if the curve is closed, postprocess the vectors so the first and last normal vectors are the same\n\tif(closed){theta = Math.acos(THREE.Math.clamp(normals[0].dot(normals[numpoints - 1]),-1,1));theta /= numpoints - 1;if(tangents[0].dot(vec.crossVectors(normals[0],normals[numpoints - 1])) > 0){theta = -theta;}for(i = 1;i < numpoints;i++) { // twist a little...\n\tnormals[i].applyMatrix4(mat.makeRotationAxis(tangents[i],theta * i));binormals[i].crossVectors(tangents[i],normals[i]);}}}; // File:src/extras/geometries/PolyhedronGeometry.js\n\t/**\n\t * @author clockworkgeek / https://github.com/clockworkgeek\n\t * @author timothypratley / https://github.com/timothypratley\n\t * @author WestLangley / http://github.com/WestLangley\n\t*/THREE.PolyhedronGeometry = function(vertices,indices,radius,detail){THREE.Geometry.call(this);this.type = 'PolyhedronGeometry';this.parameters = {vertices:vertices,indices:indices,radius:radius,detail:detail};radius = radius || 1;detail = detail || 0;var that=this;for(var i=0,l=vertices.length;i < l;i += 3) {prepare(new THREE.Vector3(vertices[i],vertices[i + 1],vertices[i + 2]));}var p=this.vertices;var faces=[];for(var i=0,j=0,l=indices.length;i < l;i += 3,j++) {var v1=p[indices[i]];var v2=p[indices[i + 1]];var v3=p[indices[i + 2]];faces[j] = new THREE.Face3(v1.index,v2.index,v3.index,[v1.clone(),v2.clone(),v3.clone()],undefined,j);}var centroid=new THREE.Vector3();for(var i=0,l=faces.length;i < l;i++) {subdivide(faces[i],detail);} // Handle case when face straddles the seam\n\tfor(var i=0,l=this.faceVertexUvs[0].length;i < l;i++) {var uvs=this.faceVertexUvs[0][i];var x0=uvs[0].x;var x1=uvs[1].x;var x2=uvs[2].x;var max=Math.max(x0,Math.max(x1,x2));var min=Math.min(x0,Math.min(x1,x2));if(max > 0.9 && min < 0.1){ // 0.9 is somewhat arbitrary\n\tif(x0 < 0.2)uvs[0].x += 1;if(x1 < 0.2)uvs[1].x += 1;if(x2 < 0.2)uvs[2].x += 1;}} // Apply radius\n\tfor(var i=0,l=this.vertices.length;i < l;i++) {this.vertices[i].multiplyScalar(radius);} // Merge vertices\n\tthis.mergeVertices();this.computeFaceNormals();this.boundingSphere = new THREE.Sphere(new THREE.Vector3(),radius); // Project vector onto sphere's surface\n\tfunction prepare(vector){var vertex=vector.normalize().clone();vertex.index = that.vertices.push(vertex) - 1; // Texture coords are equivalent to map coords, calculate angle and convert to fraction of a circle.\n\tvar u=azimuth(vector) / 2 / Math.PI + 0.5;var v=inclination(vector) / Math.PI + 0.5;vertex.uv = new THREE.Vector2(u,1 - v);return vertex;} // Approximate a curved face with recursively sub-divided triangles.\n\tfunction make(v1,v2,v3,materialIndex){var face=new THREE.Face3(v1.index,v2.index,v3.index,[v1.clone(),v2.clone(),v3.clone()],undefined,materialIndex);that.faces.push(face);centroid.copy(v1).add(v2).add(v3).divideScalar(3);var azi=azimuth(centroid);that.faceVertexUvs[0].push([correctUV(v1.uv,v1,azi),correctUV(v2.uv,v2,azi),correctUV(v3.uv,v3,azi)]);} // Analytically subdivide a face to the required detail level.\n\tfunction subdivide(face,detail){var cols=Math.pow(2,detail);var a=prepare(that.vertices[face.a]);var b=prepare(that.vertices[face.b]);var c=prepare(that.vertices[face.c]);var v=[];var materialIndex=face.materialIndex; // Construct all of the vertices for this subdivision.\n\tfor(var i=0;i <= cols;i++) {v[i] = [];var aj=prepare(a.clone().lerp(c,i / cols));var bj=prepare(b.clone().lerp(c,i / cols));var rows=cols - i;for(var j=0;j <= rows;j++) {if(j === 0 && i === cols){v[i][j] = aj;}else {v[i][j] = prepare(aj.clone().lerp(bj,j / rows));}}} // Construct all of the faces.\n\tfor(var i=0;i < cols;i++) {for(var j=0;j < 2 * (cols - i) - 1;j++) {var k=Math.floor(j / 2);if(j % 2 === 0){make(v[i][k + 1],v[i + 1][k],v[i][k],materialIndex);}else {make(v[i][k + 1],v[i + 1][k + 1],v[i + 1][k],materialIndex);}}}} // Angle around the Y axis, counter-clockwise when looking from above.\n\tfunction azimuth(vector){return Math.atan2(vector.z,-vector.x);} // Angle above the XZ plane.\n\tfunction inclination(vector){return Math.atan2(-vector.y,Math.sqrt(vector.x * vector.x + vector.z * vector.z));} // Texture fixing helper. Spheres have some odd behaviours.\n\tfunction correctUV(uv,vector,azimuth){if(azimuth < 0 && uv.x === 1)uv = new THREE.Vector2(uv.x - 1,uv.y);if(vector.x === 0 && vector.z === 0)uv = new THREE.Vector2(azimuth / 2 / Math.PI + 0.5,uv.y);return uv.clone();}};THREE.PolyhedronGeometry.prototype = _Object$create(THREE.Geometry.prototype);THREE.PolyhedronGeometry.prototype.constructor = THREE.PolyhedronGeometry;THREE.PolyhedronGeometry.prototype.clone = function(){var geometry=new THREE.PolyhedronGeometry(this.parameters.vertices,this.parameters.indices,this.parameters.radius,this.parameters.detail);return geometry.copy(this);};THREE.PolyhedronGeometry.prototype.copy = function(source){THREE.Geometry.prototype.copy.call(this,source);return this;}; // File:src/extras/geometries/DodecahedronGeometry.js\n\t/**\n\t * @author Abe Pazos / https://hamoid.com\n\t */THREE.DodecahedronGeometry = function(radius,detail){var t=(1 + Math.sqrt(5)) / 2;var r=1 / t;var vertices=[ // (1, 1, 1)\n\t-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1, // (0, 1/, )\n\t0,-r,-t,0,-r,t,0,r,-t,0,r,t, // (1/, , 0)\n\t-r,-t,0,-r,t,0,r,-t,0,r,t,0, // (, 0, 1/)\n\t-t,0,-r,t,0,-r,-t,0,r,t,0,r];var indices=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];THREE.PolyhedronGeometry.call(this,vertices,indices,radius,detail);this.type = 'DodecahedronGeometry';this.parameters = {radius:radius,detail:detail};};THREE.DodecahedronGeometry.prototype = _Object$create(THREE.PolyhedronGeometry.prototype);THREE.DodecahedronGeometry.prototype.constructor = THREE.DodecahedronGeometry;THREE.DodecahedronGeometry.prototype.clone = function(){var geometry=new THREE.DodecahedronGeometry(this.parameters.radius,this.parameters.detail);geometry.copy(this);return geometry;}; // File:src/extras/geometries/IcosahedronGeometry.js\n\t/**\n\t * @author timothypratley / https://github.com/timothypratley\n\t */THREE.IcosahedronGeometry = function(radius,detail){var t=(1 + Math.sqrt(5)) / 2;var vertices=[-1,t,0,1,t,0,-1,-t,0,1,-t,0,0,-1,t,0,1,t,0,-1,-t,0,1,-t,t,0,-1,t,0,1,-t,0,-1,-t,0,1];var indices=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];THREE.PolyhedronGeometry.call(this,vertices,indices,radius,detail);this.type = 'IcosahedronGeometry';this.parameters = {radius:radius,detail:detail};};THREE.IcosahedronGeometry.prototype = _Object$create(THREE.PolyhedronGeometry.prototype);THREE.IcosahedronGeometry.prototype.constructor = THREE.IcosahedronGeometry;THREE.IcosahedronGeometry.prototype.clone = function(){var geometry=new THREE.IcosahedronGeometry(this.parameters.radius,this.parameters.detail);geometry.copy(this);return geometry;}; // File:src/extras/geometries/OctahedronGeometry.js\n\t/**\n\t * @author timothypratley / https://github.com/timothypratley\n\t */THREE.OctahedronGeometry = function(radius,detail){var vertices=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1];var indices=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];THREE.PolyhedronGeometry.call(this,vertices,indices,radius,detail);this.type = 'OctahedronGeometry';this.parameters = {radius:radius,detail:detail};};THREE.OctahedronGeometry.prototype = _Object$create(THREE.PolyhedronGeometry.prototype);THREE.OctahedronGeometry.prototype.constructor = THREE.OctahedronGeometry;THREE.OctahedronGeometry.prototype.clone = function(){var geometry=new THREE.OctahedronGeometry(this.parameters.radius,this.parameters.detail);geometry.copy(this);return geometry;}; // File:src/extras/geometries/TetrahedronGeometry.js\n\t/**\n\t * @author timothypratley / https://github.com/timothypratley\n\t */THREE.TetrahedronGeometry = function(radius,detail){var vertices=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1];var indices=[2,1,0,0,3,2,1,3,0,2,3,1];THREE.PolyhedronGeometry.call(this,vertices,indices,radius,detail);this.type = 'TetrahedronGeometry';this.parameters = {radius:radius,detail:detail};};THREE.TetrahedronGeometry.prototype = _Object$create(THREE.PolyhedronGeometry.prototype);THREE.TetrahedronGeometry.prototype.constructor = THREE.TetrahedronGeometry;THREE.TetrahedronGeometry.prototype.clone = function(){var geometry=new THREE.TetrahedronGeometry(this.parameters.radius,this.parameters.detail);geometry.copy(this);return geometry;}; // File:src/extras/geometries/ParametricGeometry.js\n\t/**\n\t * @author zz85 / https://github.com/zz85\n\t * Parametric Surfaces Geometry\n\t * based on the brilliant article by @prideout http://prideout.net/blog/?p=44\n\t *\n\t * new THREE.ParametricGeometry( parametricFunction, uSegments, ySegements );\n\t *\n\t */THREE.ParametricGeometry = function(func,slices,stacks){THREE.Geometry.call(this);this.type = 'ParametricGeometry';this.parameters = {func:func,slices:slices,stacks:stacks};var verts=this.vertices;var faces=this.faces;var uvs=this.faceVertexUvs[0];var i,j,p;var u,v;var sliceCount=slices + 1;for(i = 0;i <= stacks;i++) {v = i / stacks;for(j = 0;j <= slices;j++) {u = j / slices;p = func(u,v);verts.push(p);}}var a,b,c,d;var uva,uvb,uvc,uvd;for(i = 0;i < stacks;i++) {for(j = 0;j < slices;j++) {a = i * sliceCount + j;b = i * sliceCount + j + 1;c = (i + 1) * sliceCount + j + 1;d = (i + 1) * sliceCount + j;uva = new THREE.Vector2(j / slices,i / stacks);uvb = new THREE.Vector2((j + 1) / slices,i / stacks);uvc = new THREE.Vector2((j + 1) / slices,(i + 1) / stacks);uvd = new THREE.Vector2(j / slices,(i + 1) / stacks);faces.push(new THREE.Face3(a,b,d));uvs.push([uva,uvb,uvd]);faces.push(new THREE.Face3(b,c,d));uvs.push([uvb.clone(),uvc,uvd.clone()]);}} // console.log(this);\n\t// magic bullet\n\t// var diff = this.mergeVertices();\n\t// console.log('removed ', diff, ' vertices by merging');\n\tthis.computeFaceNormals();this.computeVertexNormals();};THREE.ParametricGeometry.prototype = _Object$create(THREE.Geometry.prototype);THREE.ParametricGeometry.prototype.constructor = THREE.ParametricGeometry; // File:src/extras/geometries/WireframeGeometry.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */THREE.WireframeGeometry = function(geometry){THREE.BufferGeometry.call(this);var edge=[0,0],hash={};var sortFunction=function sortFunction(a,b){return a - b;};var keys=['a','b','c'];if(geometry instanceof THREE.Geometry){var vertices=geometry.vertices;var faces=geometry.faces;var numEdges=0; // allocate maximal size\n\tvar edges=new Uint32Array(6 * faces.length);for(var i=0,l=faces.length;i < l;i++) {var face=faces[i];for(var j=0;j < 3;j++) {edge[0] = face[keys[j]];edge[1] = face[keys[(j + 1) % 3]];edge.sort(sortFunction);var key=edge.toString();if(hash[key] === undefined){edges[2 * numEdges] = edge[0];edges[2 * numEdges + 1] = edge[1];hash[key] = true;numEdges++;}}}var coords=new Float32Array(numEdges * 2 * 3);for(var i=0,l=numEdges;i < l;i++) {for(var j=0;j < 2;j++) {var vertex=vertices[edges[2 * i + j]];var index=6 * i + 3 * j;coords[index + 0] = vertex.x;coords[index + 1] = vertex.y;coords[index + 2] = vertex.z;}}this.addAttribute('position',new THREE.BufferAttribute(coords,3));}else if(geometry instanceof THREE.BufferGeometry){if(geometry.index !== null){ // Indexed BufferGeometry\n\tvar indices=geometry.index.array;var vertices=geometry.attributes.position;var drawcalls=geometry.drawcalls;var numEdges=0;if(drawcalls.length === 0){geometry.addDrawCall(0,indices.length);} // allocate maximal size\n\tvar edges=new Uint32Array(2 * indices.length);for(var o=0,ol=drawcalls.length;o < ol;++o) {var drawcall=drawcalls[o];var start=drawcall.start;var count=drawcall.count;for(var i=start,il=start + count;i < il;i += 3) {for(var j=0;j < 3;j++) {edge[0] = indices[i + j];edge[1] = indices[i + (j + 1) % 3];edge.sort(sortFunction);var key=edge.toString();if(hash[key] === undefined){edges[2 * numEdges] = edge[0];edges[2 * numEdges + 1] = edge[1];hash[key] = true;numEdges++;}}}}var coords=new Float32Array(numEdges * 2 * 3);for(var i=0,l=numEdges;i < l;i++) {for(var j=0;j < 2;j++) {var index=6 * i + 3 * j;var index2=edges[2 * i + j];coords[index + 0] = vertices.getX(index2);coords[index + 1] = vertices.getY(index2);coords[index + 2] = vertices.getZ(index2);}}this.addAttribute('position',new THREE.BufferAttribute(coords,3));}else { // non-indexed BufferGeometry\n\tvar vertices=geometry.attributes.position.array;var numEdges=vertices.length / 3;var numTris=numEdges / 3;var coords=new Float32Array(numEdges * 2 * 3);for(var i=0,l=numTris;i < l;i++) {for(var j=0;j < 3;j++) {var index=18 * i + 6 * j;var index1=9 * i + 3 * j;coords[index + 0] = vertices[index1];coords[index + 1] = vertices[index1 + 1];coords[index + 2] = vertices[index1 + 2];var index2=9 * i + 3 * ((j + 1) % 3);coords[index + 3] = vertices[index2];coords[index + 4] = vertices[index2 + 1];coords[index + 5] = vertices[index2 + 2];}}this.addAttribute('position',new THREE.BufferAttribute(coords,3));}}};THREE.WireframeGeometry.prototype = _Object$create(THREE.BufferGeometry.prototype);THREE.WireframeGeometry.prototype.constructor = THREE.WireframeGeometry; // File:src/extras/helpers/AxisHelper.js\n\t/**\n\t * @author sroucheray / http://sroucheray.org/\n\t * @author mrdoob / http://mrdoob.com/\n\t */THREE.AxisHelper = function(size){size = size || 1;var vertices=new Float32Array([0,0,0,size,0,0,0,0,0,0,size,0,0,0,0,0,0,size]);var colors=new Float32Array([1,0,0,1,0.6,0,0,1,0,0.6,1,0,0,0,1,0,0.6,1]);var geometry=new THREE.BufferGeometry();geometry.addAttribute('position',new THREE.BufferAttribute(vertices,3));geometry.addAttribute('color',new THREE.BufferAttribute(colors,3));var material=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});THREE.LineSegments.call(this,geometry,material);};THREE.AxisHelper.prototype = _Object$create(THREE.LineSegments.prototype);THREE.AxisHelper.prototype.constructor = THREE.AxisHelper; // File:src/extras/helpers/ArrowHelper.js\n\t/**\n\t * @author WestLangley / http://github.com/WestLangley\n\t * @author zz85 / http://github.com/zz85\n\t * @author bhouston / http://exocortex.com\n\t *\n\t * Creates an arrow for visualizing directions\n\t *\n\t * Parameters:\n\t *  dir - Vector3\n\t *  origin - Vector3\n\t *  length - Number\n\t *  color - color in hex value\n\t *  headLength - Number\n\t *  headWidth - Number\n\t */THREE.ArrowHelper = (function(){var lineGeometry=new THREE.Geometry();lineGeometry.vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(0,1,0));var coneGeometry=new THREE.CylinderGeometry(0,0.5,1,5,1);coneGeometry.translate(0,-0.5,0);return function ArrowHelper(dir,origin,length,color,headLength,headWidth){ // dir is assumed to be normalized\n\tTHREE.Object3D.call(this);if(color === undefined)color = 0xffff00;if(length === undefined)length = 1;if(headLength === undefined)headLength = 0.2 * length;if(headWidth === undefined)headWidth = 0.2 * headLength;this.position.copy(origin);if(headLength < length){this.line = new THREE.Line(lineGeometry,new THREE.LineBasicMaterial({color:color}));this.line.matrixAutoUpdate = false;this.add(this.line);}this.cone = new THREE.Mesh(coneGeometry,new THREE.MeshBasicMaterial({color:color}));this.cone.matrixAutoUpdate = false;this.add(this.cone);this.setDirection(dir);this.setLength(length,headLength,headWidth);};})();THREE.ArrowHelper.prototype = _Object$create(THREE.Object3D.prototype);THREE.ArrowHelper.prototype.constructor = THREE.ArrowHelper;THREE.ArrowHelper.prototype.setDirection = (function(){var axis=new THREE.Vector3();var radians;return function setDirection(dir){ // dir is assumed to be normalized\n\tif(dir.y > 0.99999){this.quaternion.set(0,0,0,1);}else if(dir.y < -0.99999){this.quaternion.set(1,0,0,0);}else {axis.set(dir.z,0,-dir.x).normalize();radians = Math.acos(dir.y);this.quaternion.setFromAxisAngle(axis,radians);}};})();THREE.ArrowHelper.prototype.setLength = function(length,headLength,headWidth){if(headLength === undefined)headLength = 0.2 * length;if(headWidth === undefined)headWidth = 0.2 * headLength;if(headLength < length){this.line.scale.set(1,length - headLength,1);this.line.updateMatrix();}this.cone.scale.set(headWidth,headLength,headWidth);this.cone.position.y = length;this.cone.updateMatrix();};THREE.ArrowHelper.prototype.setColor = function(color){if(this.line !== undefined)this.line.material.color.set(color);this.cone.material.color.set(color);}; // File:src/extras/helpers/BoxHelper.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */THREE.BoxHelper = function(object){var indices=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var positions=new Float32Array(8 * 3);var geometry=new THREE.BufferGeometry();geometry.setIndex(new THREE.BufferAttribute(indices,1));geometry.addAttribute('position',new THREE.BufferAttribute(positions,3));THREE.LineSegments.call(this,geometry,new THREE.LineBasicMaterial({color:0xffff00}));if(object !== undefined){this.update(object);}};THREE.BoxHelper.prototype = _Object$create(THREE.LineSegments.prototype);THREE.BoxHelper.prototype.constructor = THREE.BoxHelper;THREE.BoxHelper.prototype.update = (function(){var box=new THREE.Box3();return function(object){box.setFromObject(object);if(box.empty())return;var min=box.min;var max=box.max; /*\n\t\t\t  5____4\n\t\t\t1/___0/|\n\t\t\t| 6__|_7\n\t\t\t2/___3/\n\t\n\t\t\t0: max.x, max.y, max.z\n\t\t\t1: min.x, max.y, max.z\n\t\t\t2: min.x, min.y, max.z\n\t\t\t3: max.x, min.y, max.z\n\t\t\t4: max.x, max.y, min.z\n\t\t\t5: min.x, max.y, min.z\n\t\t\t6: min.x, min.y, min.z\n\t\t\t7: max.x, min.y, min.z\n\t\t\t*/var position=this.geometry.attributes.position;var array=position.array;array[0] = max.x;array[1] = max.y;array[2] = max.z;array[3] = min.x;array[4] = max.y;array[5] = max.z;array[6] = min.x;array[7] = min.y;array[8] = max.z;array[9] = max.x;array[10] = min.y;array[11] = max.z;array[12] = max.x;array[13] = max.y;array[14] = min.z;array[15] = min.x;array[16] = max.y;array[17] = min.z;array[18] = min.x;array[19] = min.y;array[20] = min.z;array[21] = max.x;array[22] = min.y;array[23] = min.z;position.needsUpdate = true;this.geometry.computeBoundingSphere();};})(); // File:src/extras/helpers/BoundingBoxHelper.js\n\t/**\n\t * @author WestLangley / http://github.com/WestLangley\n\t */ // a helper to show the world-axis-aligned bounding box for an object\n\tTHREE.BoundingBoxHelper = function(object,hex){var color=hex !== undefined?hex:0x888888;this.object = object;this.box = new THREE.Box3();THREE.Mesh.call(this,new THREE.BoxGeometry(1,1,1),new THREE.MeshBasicMaterial({color:color,wireframe:true}));};THREE.BoundingBoxHelper.prototype = _Object$create(THREE.Mesh.prototype);THREE.BoundingBoxHelper.prototype.constructor = THREE.BoundingBoxHelper;THREE.BoundingBoxHelper.prototype.update = function(){this.box.setFromObject(this.object);this.box.size(this.scale);this.box.center(this.position);}; // File:src/extras/helpers/CameraHelper.js\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t *\n\t *\t- shows frustum, line of sight and up of the camera\n\t *\t- suitable for fast updates\n\t * \t- based on frustum visualization in lightgl.js shadowmap example\n\t *\t\thttp://evanw.github.com/lightgl.js/tests/shadowmap.html\n\t */THREE.CameraHelper = function(camera){var geometry=new THREE.Geometry();var material=new THREE.LineBasicMaterial({color:0xffffff,vertexColors:THREE.FaceColors});var pointMap={}; // colors\n\tvar hexFrustum=0xffaa00;var hexCone=0xff0000;var hexUp=0x00aaff;var hexTarget=0xffffff;var hexCross=0x333333; // near\n\taddLine(\"n1\",\"n2\",hexFrustum);addLine(\"n2\",\"n4\",hexFrustum);addLine(\"n4\",\"n3\",hexFrustum);addLine(\"n3\",\"n1\",hexFrustum); // far\n\taddLine(\"f1\",\"f2\",hexFrustum);addLine(\"f2\",\"f4\",hexFrustum);addLine(\"f4\",\"f3\",hexFrustum);addLine(\"f3\",\"f1\",hexFrustum); // sides\n\taddLine(\"n1\",\"f1\",hexFrustum);addLine(\"n2\",\"f2\",hexFrustum);addLine(\"n3\",\"f3\",hexFrustum);addLine(\"n4\",\"f4\",hexFrustum); // cone\n\taddLine(\"p\",\"n1\",hexCone);addLine(\"p\",\"n2\",hexCone);addLine(\"p\",\"n3\",hexCone);addLine(\"p\",\"n4\",hexCone); // up\n\taddLine(\"u1\",\"u2\",hexUp);addLine(\"u2\",\"u3\",hexUp);addLine(\"u3\",\"u1\",hexUp); // target\n\taddLine(\"c\",\"t\",hexTarget);addLine(\"p\",\"c\",hexCross); // cross\n\taddLine(\"cn1\",\"cn2\",hexCross);addLine(\"cn3\",\"cn4\",hexCross);addLine(\"cf1\",\"cf2\",hexCross);addLine(\"cf3\",\"cf4\",hexCross);function addLine(a,b,hex){addPoint(a,hex);addPoint(b,hex);}function addPoint(id,hex){geometry.vertices.push(new THREE.Vector3());geometry.colors.push(new THREE.Color(hex));if(pointMap[id] === undefined){pointMap[id] = [];}pointMap[id].push(geometry.vertices.length - 1);}THREE.LineSegments.call(this,geometry,material);this.camera = camera;this.matrix = camera.matrixWorld;this.matrixAutoUpdate = false;this.pointMap = pointMap;this.update();};THREE.CameraHelper.prototype = _Object$create(THREE.LineSegments.prototype);THREE.CameraHelper.prototype.constructor = THREE.CameraHelper;THREE.CameraHelper.prototype.update = (function(){var geometry,pointMap;var vector=new THREE.Vector3();var camera=new THREE.Camera();var setPoint=function setPoint(point,x,y,z){vector.set(x,y,z).unproject(camera);var points=pointMap[point];if(points !== undefined){for(var i=0,il=points.length;i < il;i++) {geometry.vertices[points[i]].copy(vector);}}};return function(){geometry = this.geometry;pointMap = this.pointMap;var w=1,h=1; // we need just camera projection matrix\n\t// world matrix must be identity\n\tcamera.projectionMatrix.copy(this.camera.projectionMatrix); // center / target\n\tsetPoint(\"c\",0,0,-1);setPoint(\"t\",0,0,1); // near\n\tsetPoint(\"n1\",-w,-h,-1);setPoint(\"n2\",w,-h,-1);setPoint(\"n3\",-w,h,-1);setPoint(\"n4\",w,h,-1); // far\n\tsetPoint(\"f1\",-w,-h,1);setPoint(\"f2\",w,-h,1);setPoint(\"f3\",-w,h,1);setPoint(\"f4\",w,h,1); // up\n\tsetPoint(\"u1\",w * 0.7,h * 1.1,-1);setPoint(\"u2\",-w * 0.7,h * 1.1,-1);setPoint(\"u3\",0,h * 2,-1); // cross\n\tsetPoint(\"cf1\",-w,0,1);setPoint(\"cf2\",w,0,1);setPoint(\"cf3\",0,-h,1);setPoint(\"cf4\",0,h,1);setPoint(\"cn1\",-w,0,-1);setPoint(\"cn2\",w,0,-1);setPoint(\"cn3\",0,-h,-1);setPoint(\"cn4\",0,h,-1);geometry.verticesNeedUpdate = true;};})(); // File:src/extras/helpers/DirectionalLightHelper.js\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author WestLangley / http://github.com/WestLangley\n\t */THREE.DirectionalLightHelper = function(light,size){THREE.Object3D.call(this);this.light = light;this.light.updateMatrixWorld();this.matrix = light.matrixWorld;this.matrixAutoUpdate = false;size = size || 1;var geometry=new THREE.Geometry();geometry.vertices.push(new THREE.Vector3(-size,size,0),new THREE.Vector3(size,size,0),new THREE.Vector3(size,-size,0),new THREE.Vector3(-size,-size,0),new THREE.Vector3(-size,size,0));var material=new THREE.LineBasicMaterial({fog:false});material.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.lightPlane = new THREE.Line(geometry,material);this.add(this.lightPlane);geometry = new THREE.Geometry();geometry.vertices.push(new THREE.Vector3(),new THREE.Vector3());material = new THREE.LineBasicMaterial({fog:false});material.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.targetLine = new THREE.Line(geometry,material);this.add(this.targetLine);this.update();};THREE.DirectionalLightHelper.prototype = _Object$create(THREE.Object3D.prototype);THREE.DirectionalLightHelper.prototype.constructor = THREE.DirectionalLightHelper;THREE.DirectionalLightHelper.prototype.dispose = function(){this.lightPlane.geometry.dispose();this.lightPlane.material.dispose();this.targetLine.geometry.dispose();this.targetLine.material.dispose();};THREE.DirectionalLightHelper.prototype.update = (function(){var v1=new THREE.Vector3();var v2=new THREE.Vector3();var v3=new THREE.Vector3();return function(){v1.setFromMatrixPosition(this.light.matrixWorld);v2.setFromMatrixPosition(this.light.target.matrixWorld);v3.subVectors(v2,v1);this.lightPlane.lookAt(v3);this.lightPlane.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.targetLine.geometry.vertices[1].copy(v3);this.targetLine.geometry.verticesNeedUpdate = true;this.targetLine.material.color.copy(this.lightPlane.material.color);};})(); // File:src/extras/helpers/EdgesHelper.js\n\t/**\n\t * @author WestLangley / http://github.com/WestLangley\n\t * @param object THREE.Mesh whose geometry will be used\n\t * @param hex line color\n\t * @param thresholdAngle the minimum angle (in degrees),\n\t * between the face normals of adjacent faces,\n\t * that is required to render an edge. A value of 10 means\n\t * an edge is only rendered if the angle is at least 10 degrees.\n\t */THREE.EdgesHelper = function(object,hex,thresholdAngle){var color=hex !== undefined?hex:0xffffff;THREE.LineSegments.call(this,new THREE.EdgesGeometry(object.geometry,thresholdAngle),new THREE.LineBasicMaterial({color:color}));this.matrix = object.matrixWorld;this.matrixAutoUpdate = false;};THREE.EdgesHelper.prototype = _Object$create(THREE.LineSegments.prototype);THREE.EdgesHelper.prototype.constructor = THREE.EdgesHelper; // File:src/extras/helpers/FaceNormalsHelper.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author WestLangley / http://github.com/WestLangley\n\t*/THREE.FaceNormalsHelper = function(object,size,hex,linewidth){ // FaceNormalsHelper only supports THREE.Geometry\n\tthis.object = object;this.size = size !== undefined?size:1;var color=hex !== undefined?hex:0xffff00;var width=linewidth !== undefined?linewidth:1; //\n\tvar nNormals=0;var objGeometry=this.object.geometry;if(objGeometry instanceof THREE.Geometry){nNormals = objGeometry.faces.length;}else {console.warn('THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.');} //\n\tvar geometry=new THREE.BufferGeometry();var positions=new THREE.Float32Attribute(nNormals * 2 * 3,3);geometry.addAttribute('position',positions);THREE.LineSegments.call(this,geometry,new THREE.LineBasicMaterial({color:color,linewidth:width})); //\n\tthis.matrixAutoUpdate = false;this.update();};THREE.FaceNormalsHelper.prototype = _Object$create(THREE.LineSegments.prototype);THREE.FaceNormalsHelper.prototype.constructor = THREE.FaceNormalsHelper;THREE.FaceNormalsHelper.prototype.update = (function(){var v1=new THREE.Vector3();var v2=new THREE.Vector3();var normalMatrix=new THREE.Matrix3();return function update(){this.object.updateMatrixWorld(true);normalMatrix.getNormalMatrix(this.object.matrixWorld);var matrixWorld=this.object.matrixWorld;var position=this.geometry.attributes.position; //\n\tvar objGeometry=this.object.geometry;var vertices=objGeometry.vertices;var faces=objGeometry.faces;var idx=0;for(var i=0,l=faces.length;i < l;i++) {var face=faces[i];var normal=face.normal;v1.copy(vertices[face.a]).add(vertices[face.b]).add(vertices[face.c]).divideScalar(3).applyMatrix4(matrixWorld);v2.copy(normal).applyMatrix3(normalMatrix).normalize().multiplyScalar(this.size).add(v1);position.setXYZ(idx,v1.x,v1.y,v1.z);idx = idx + 1;position.setXYZ(idx,v2.x,v2.y,v2.z);idx = idx + 1;}position.needsUpdate = true;return this;};})(); // File:src/extras/helpers/GridHelper.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */THREE.GridHelper = function(size,step){var geometry=new THREE.Geometry();var material=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});this.color1 = new THREE.Color(0x444444);this.color2 = new THREE.Color(0x888888);for(var i=-size;i <= size;i += step) {geometry.vertices.push(new THREE.Vector3(-size,0,i),new THREE.Vector3(size,0,i),new THREE.Vector3(i,0,-size),new THREE.Vector3(i,0,size));var color=i === 0?this.color1:this.color2;geometry.colors.push(color,color,color,color);}THREE.LineSegments.call(this,geometry,material);};THREE.GridHelper.prototype = _Object$create(THREE.LineSegments.prototype);THREE.GridHelper.prototype.constructor = THREE.GridHelper;THREE.GridHelper.prototype.setColors = function(colorCenterLine,colorGrid){this.color1.set(colorCenterLine);this.color2.set(colorGrid);this.geometry.colorsNeedUpdate = true;}; // File:src/extras/helpers/HemisphereLightHelper.js\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author mrdoob / http://mrdoob.com/\n\t */THREE.HemisphereLightHelper = function(light,sphereSize){THREE.Object3D.call(this);this.light = light;this.light.updateMatrixWorld();this.matrix = light.matrixWorld;this.matrixAutoUpdate = false;this.colors = [new THREE.Color(),new THREE.Color()];var geometry=new THREE.SphereGeometry(sphereSize,4,2);geometry.rotateX(-Math.PI / 2);for(var i=0,il=8;i < il;i++) {geometry.faces[i].color = this.colors[i < 4?0:1];}var material=new THREE.MeshBasicMaterial({vertexColors:THREE.FaceColors,wireframe:true});this.lightSphere = new THREE.Mesh(geometry,material);this.add(this.lightSphere);this.update();};THREE.HemisphereLightHelper.prototype = _Object$create(THREE.Object3D.prototype);THREE.HemisphereLightHelper.prototype.constructor = THREE.HemisphereLightHelper;THREE.HemisphereLightHelper.prototype.dispose = function(){this.lightSphere.geometry.dispose();this.lightSphere.material.dispose();};THREE.HemisphereLightHelper.prototype.update = (function(){var vector=new THREE.Vector3();return function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity);this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity);this.lightSphere.lookAt(vector.setFromMatrixPosition(this.light.matrixWorld).negate());this.lightSphere.geometry.colorsNeedUpdate = true;};})(); // File:src/extras/helpers/PointLightHelper.js\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author mrdoob / http://mrdoob.com/\n\t */THREE.PointLightHelper = function(light,sphereSize){this.light = light;this.light.updateMatrixWorld();var geometry=new THREE.SphereGeometry(sphereSize,4,2);var material=new THREE.MeshBasicMaterial({wireframe:true,fog:false});material.color.copy(this.light.color).multiplyScalar(this.light.intensity);THREE.Mesh.call(this,geometry,material);this.matrix = this.light.matrixWorld;this.matrixAutoUpdate = false; /*\n\t\tvar distanceGeometry = new THREE.IcosahedronGeometry( 1, 2 );\n\t\tvar distanceMaterial = new THREE.MeshBasicMaterial( { color: hexColor, fog: false, wireframe: true, opacity: 0.1, transparent: true } );\n\t\n\t\tthis.lightSphere = new THREE.Mesh( bulbGeometry, bulbMaterial );\n\t\tthis.lightDistance = new THREE.Mesh( distanceGeometry, distanceMaterial );\n\t\n\t\tvar d = light.distance;\n\t\n\t\tif ( d === 0.0 ) {\n\t\n\t\t\tthis.lightDistance.visible = false;\n\t\n\t\t} else {\n\t\n\t\t\tthis.lightDistance.scale.set( d, d, d );\n\t\n\t\t}\n\t\n\t\tthis.add( this.lightDistance );\n\t\t*/};THREE.PointLightHelper.prototype = _Object$create(THREE.Mesh.prototype);THREE.PointLightHelper.prototype.constructor = THREE.PointLightHelper;THREE.PointLightHelper.prototype.dispose = function(){this.geometry.dispose();this.material.dispose();};THREE.PointLightHelper.prototype.update = function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity); /*\n\t\tvar d = this.light.distance;\n\t\n\t\tif ( d === 0.0 ) {\n\t\n\t\t\tthis.lightDistance.visible = false;\n\t\n\t\t} else {\n\t\n\t\t\tthis.lightDistance.visible = true;\n\t\t\tthis.lightDistance.scale.set( d, d, d );\n\t\n\t\t}\n\t\t*/}; // File:src/extras/helpers/SkeletonHelper.js\n\t/**\n\t * @author Sean Griffin / http://twitter.com/sgrif\n\t * @author Michael Guerrero / http://realitymeltdown.com\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author ikerr / http://verold.com\n\t */THREE.SkeletonHelper = function(object){this.bones = this.getBoneList(object);var geometry=new THREE.Geometry();for(var i=0;i < this.bones.length;i++) {var bone=this.bones[i];if(bone.parent instanceof THREE.Bone){geometry.vertices.push(new THREE.Vector3());geometry.vertices.push(new THREE.Vector3());geometry.colors.push(new THREE.Color(0,0,1));geometry.colors.push(new THREE.Color(0,1,0));}}geometry.dynamic = true;var material=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors,depthTest:false,depthWrite:false,transparent:true});THREE.LineSegments.call(this,geometry,material);this.root = object;this.matrix = object.matrixWorld;this.matrixAutoUpdate = false;this.update();};THREE.SkeletonHelper.prototype = _Object$create(THREE.LineSegments.prototype);THREE.SkeletonHelper.prototype.constructor = THREE.SkeletonHelper;THREE.SkeletonHelper.prototype.getBoneList = function(object){var boneList=[];if(object instanceof THREE.Bone){boneList.push(object);}for(var i=0;i < object.children.length;i++) {boneList.push.apply(boneList,this.getBoneList(object.children[i]));}return boneList;};THREE.SkeletonHelper.prototype.update = function(){var geometry=this.geometry;var matrixWorldInv=new THREE.Matrix4().getInverse(this.root.matrixWorld);var boneMatrix=new THREE.Matrix4();var j=0;for(var i=0;i < this.bones.length;i++) {var bone=this.bones[i];if(bone.parent instanceof THREE.Bone){boneMatrix.multiplyMatrices(matrixWorldInv,bone.matrixWorld);geometry.vertices[j].setFromMatrixPosition(boneMatrix);boneMatrix.multiplyMatrices(matrixWorldInv,bone.parent.matrixWorld);geometry.vertices[j + 1].setFromMatrixPosition(boneMatrix);j += 2;}}geometry.verticesNeedUpdate = true;geometry.computeBoundingSphere();}; // File:src/extras/helpers/SpotLightHelper.js\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author WestLangley / http://github.com/WestLangley\n\t*/THREE.SpotLightHelper = function(light){THREE.Object3D.call(this);this.light = light;this.light.updateMatrixWorld();this.matrix = light.matrixWorld;this.matrixAutoUpdate = false;var geometry=new THREE.CylinderGeometry(0,1,1,8,1,true);geometry.translate(0,-0.5,0);geometry.rotateX(-Math.PI / 2);var material=new THREE.MeshBasicMaterial({wireframe:true,fog:false});this.cone = new THREE.Mesh(geometry,material);this.add(this.cone);this.update();};THREE.SpotLightHelper.prototype = _Object$create(THREE.Object3D.prototype);THREE.SpotLightHelper.prototype.constructor = THREE.SpotLightHelper;THREE.SpotLightHelper.prototype.dispose = function(){this.cone.geometry.dispose();this.cone.material.dispose();};THREE.SpotLightHelper.prototype.update = (function(){var vector=new THREE.Vector3();var vector2=new THREE.Vector3();return function(){var coneLength=this.light.distance?this.light.distance:10000;var coneWidth=coneLength * Math.tan(this.light.angle);this.cone.scale.set(coneWidth,coneWidth,coneLength);vector.setFromMatrixPosition(this.light.matrixWorld);vector2.setFromMatrixPosition(this.light.target.matrixWorld);this.cone.lookAt(vector2.sub(vector));this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);};})(); // File:src/extras/helpers/VertexNormalsHelper.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t * @author WestLangley / http://github.com/WestLangley\n\t*/THREE.VertexNormalsHelper = function(object,size,hex,linewidth){this.object = object;this.size = size !== undefined?size:1;var color=hex !== undefined?hex:0xff0000;var width=linewidth !== undefined?linewidth:1; //\n\tvar nNormals=0;var objGeometry=this.object.geometry;if(objGeometry instanceof THREE.Geometry){nNormals = objGeometry.faces.length * 3;}else if(objGeometry instanceof THREE.BufferGeometry){nNormals = objGeometry.attributes.normal.count;} //\n\tvar geometry=new THREE.BufferGeometry();var positions=new THREE.Float32Attribute(nNormals * 2 * 3,3);geometry.addAttribute('position',positions);THREE.LineSegments.call(this,geometry,new THREE.LineBasicMaterial({color:color,linewidth:width})); //\n\tthis.matrixAutoUpdate = false;this.update();};THREE.VertexNormalsHelper.prototype = _Object$create(THREE.LineSegments.prototype);THREE.VertexNormalsHelper.prototype.constructor = THREE.VertexNormalsHelper;THREE.VertexNormalsHelper.prototype.update = (function(){var v1=new THREE.Vector3();var v2=new THREE.Vector3();var normalMatrix=new THREE.Matrix3();return function update(){var keys=['a','b','c'];this.object.updateMatrixWorld(true);normalMatrix.getNormalMatrix(this.object.matrixWorld);var matrixWorld=this.object.matrixWorld;var position=this.geometry.attributes.position; //\n\tvar objGeometry=this.object.geometry;if(objGeometry instanceof THREE.Geometry){var vertices=objGeometry.vertices;var faces=objGeometry.faces;var idx=0;for(var i=0,l=faces.length;i < l;i++) {var face=faces[i];for(var j=0,jl=face.vertexNormals.length;j < jl;j++) {var vertex=vertices[face[keys[j]]];var normal=face.vertexNormals[j];v1.copy(vertex).applyMatrix4(matrixWorld);v2.copy(normal).applyMatrix3(normalMatrix).normalize().multiplyScalar(this.size).add(v1);position.setXYZ(idx,v1.x,v1.y,v1.z);idx = idx + 1;position.setXYZ(idx,v2.x,v2.y,v2.z);idx = idx + 1;}}}else if(objGeometry instanceof THREE.BufferGeometry){var objPos=objGeometry.attributes.position;var objNorm=objGeometry.attributes.normal;var idx=0; // for simplicity, ignore index and drawcalls, and render every normal\n\tfor(var j=0,jl=objPos.count;j < jl;j++) {v1.set(objPos.getX(j),objPos.getY(j),objPos.getZ(j)).applyMatrix4(matrixWorld);v2.set(objNorm.getX(j),objNorm.getY(j),objNorm.getZ(j));v2.applyMatrix3(normalMatrix).normalize().multiplyScalar(this.size).add(v1);position.setXYZ(idx,v1.x,v1.y,v1.z);idx = idx + 1;position.setXYZ(idx,v2.x,v2.y,v2.z);idx = idx + 1;}}position.needsUpdate = true;return this;};})(); // File:src/extras/helpers/WireframeHelper.js\n\t/**\n\t * @author mrdoob / http://mrdoob.com/\n\t */THREE.WireframeHelper = function(object,hex){var color=hex !== undefined?hex:0xffffff;THREE.LineSegments.call(this,new THREE.WireframeGeometry(object.geometry),new THREE.LineBasicMaterial({color:color}));this.matrix = object.matrixWorld;this.matrixAutoUpdate = false;};THREE.WireframeHelper.prototype = _Object$create(THREE.LineSegments.prototype);THREE.WireframeHelper.prototype.constructor = THREE.WireframeHelper; // File:src/extras/objects/ImmediateRenderObject.js\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t */THREE.ImmediateRenderObject = function(){THREE.Object3D.call(this);this.render = function(renderCallback){};};THREE.ImmediateRenderObject.prototype = _Object$create(THREE.Object3D.prototype);THREE.ImmediateRenderObject.prototype.constructor = THREE.ImmediateRenderObject; // File:src/extras/objects/MorphBlendMesh.js\n\t/**\n\t * @author alteredq / http://alteredqualia.com/\n\t */THREE.MorphBlendMesh = function(geometry,material){THREE.Mesh.call(this,geometry,material);this.animationsMap = {};this.animationsList = []; // prepare default animation\n\t// (all frames played together in 1 second)\n\tvar numFrames=this.geometry.morphTargets.length;var name=\"__default\";var startFrame=0;var endFrame=numFrames - 1;var fps=numFrames / 1;this.createAnimation(name,startFrame,endFrame,fps);this.setAnimationWeight(name,1);};THREE.MorphBlendMesh.prototype = _Object$create(THREE.Mesh.prototype);THREE.MorphBlendMesh.prototype.constructor = THREE.MorphBlendMesh;THREE.MorphBlendMesh.prototype.createAnimation = function(name,start,end,fps){var animation={start:start,end:end,length:end - start + 1,fps:fps,duration:(end - start) / fps,lastFrame:0,currentFrame:0,active:false,time:0,direction:1,weight:1,directionBackwards:false,mirroredLoop:false};this.animationsMap[name] = animation;this.animationsList.push(animation);};THREE.MorphBlendMesh.prototype.autoCreateAnimations = function(fps){var pattern=/([a-z]+)_?(\\d+)/;var firstAnimation,frameRanges={};var geometry=this.geometry;for(var i=0,il=geometry.morphTargets.length;i < il;i++) {var morph=geometry.morphTargets[i];var chunks=morph.name.match(pattern);if(chunks && chunks.length > 1){var name=chunks[1];if(!frameRanges[name])frameRanges[name] = {start:Infinity,end:-Infinity};var range=frameRanges[name];if(i < range.start)range.start = i;if(i > range.end)range.end = i;if(!firstAnimation)firstAnimation = name;}}for(var name in frameRanges) {var range=frameRanges[name];this.createAnimation(name,range.start,range.end,fps);}this.firstAnimation = firstAnimation;};THREE.MorphBlendMesh.prototype.setAnimationDirectionForward = function(name){var animation=this.animationsMap[name];if(animation){animation.direction = 1;animation.directionBackwards = false;}};THREE.MorphBlendMesh.prototype.setAnimationDirectionBackward = function(name){var animation=this.animationsMap[name];if(animation){animation.direction = -1;animation.directionBackwards = true;}};THREE.MorphBlendMesh.prototype.setAnimationFPS = function(name,fps){var animation=this.animationsMap[name];if(animation){animation.fps = fps;animation.duration = (animation.end - animation.start) / animation.fps;}};THREE.MorphBlendMesh.prototype.setAnimationDuration = function(name,duration){var animation=this.animationsMap[name];if(animation){animation.duration = duration;animation.fps = (animation.end - animation.start) / animation.duration;}};THREE.MorphBlendMesh.prototype.setAnimationWeight = function(name,weight){var animation=this.animationsMap[name];if(animation){animation.weight = weight;}};THREE.MorphBlendMesh.prototype.setAnimationTime = function(name,time){var animation=this.animationsMap[name];if(animation){animation.time = time;}};THREE.MorphBlendMesh.prototype.getAnimationTime = function(name){var time=0;var animation=this.animationsMap[name];if(animation){time = animation.time;}return time;};THREE.MorphBlendMesh.prototype.getAnimationDuration = function(name){var duration=-1;var animation=this.animationsMap[name];if(animation){duration = animation.duration;}return duration;};THREE.MorphBlendMesh.prototype.playAnimation = function(name){var animation=this.animationsMap[name];if(animation){animation.time = 0;animation.active = true;}else {console.warn(\"THREE.MorphBlendMesh: animation[\" + name + \"] undefined in .playAnimation()\");}};THREE.MorphBlendMesh.prototype.stopAnimation = function(name){var animation=this.animationsMap[name];if(animation){animation.active = false;}};THREE.MorphBlendMesh.prototype.update = function(delta){for(var i=0,il=this.animationsList.length;i < il;i++) {var animation=this.animationsList[i];if(!animation.active)continue;var frameTime=animation.duration / animation.length;animation.time += animation.direction * delta;if(animation.mirroredLoop){if(animation.time > animation.duration || animation.time < 0){animation.direction *= -1;if(animation.time > animation.duration){animation.time = animation.duration;animation.directionBackwards = true;}if(animation.time < 0){animation.time = 0;animation.directionBackwards = false;}}}else {animation.time = animation.time % animation.duration;if(animation.time < 0)animation.time += animation.duration;}var keyframe=animation.start + THREE.Math.clamp(Math.floor(animation.time / frameTime),0,animation.length - 1);var weight=animation.weight;if(keyframe !== animation.currentFrame){this.morphTargetInfluences[animation.lastFrame] = 0;this.morphTargetInfluences[animation.currentFrame] = 1 * weight;this.morphTargetInfluences[keyframe] = 0;animation.lastFrame = animation.currentFrame;animation.currentFrame = keyframe;}var mix=animation.time % frameTime / frameTime;if(animation.directionBackwards)mix = 1 - mix;if(animation.currentFrame !== animation.lastFrame){this.morphTargetInfluences[animation.currentFrame] = mix * weight;this.morphTargetInfluences[animation.lastFrame] = (1 - mix) * weight;}else {this.morphTargetInfluences[animation.currentFrame] = weight;}}};\n\n/***/ },\n/* 88 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = { \"default\": __webpack_require__(89), __esModule: true };\n\n/***/ },\n/* 89 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t__webpack_require__(90);\n\tmodule.exports = __webpack_require__(19).Math.sign;\n\n/***/ },\n/* 90 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t// 20.2.2.28 Math.sign(x)\n\tvar $def = __webpack_require__(17);\n\t\n\t$def($def.S, 'Math', {sign: __webpack_require__(91)});\n\n/***/ },\n/* 91 */\n/***/ function(module, exports) {\n\n\t// 20.2.2.28 Math.sign(x)\n\tmodule.exports = Math.sign || function sign(x){\n\t  return (x = +x) == 0 || x != x ? x : x < 0 ? -1 : 1;\n\t};\n\n/***/ },\n/* 92 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = { \"default\": __webpack_require__(93), __esModule: true };\n\n/***/ },\n/* 93 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar $ = __webpack_require__(10);\n\tmodule.exports = function defineProperties(T, D){\n\t  return $.setDescs(T, D);\n\t};\n\n/***/ },\n/* 94 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _interopRequireDefault = __webpack_require__(1)['default'];\n\t\n\tObject.defineProperty(exports, '__esModule', {\n\t\tvalue: true\n\t});\n\texports['default'] = Resize;\n\t\n\tvar _debug = __webpack_require__(3);\n\t\n\tvar _debug2 = _interopRequireDefault(_debug);\n\t\n\tvar _three = __webpack_require__(87);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar debug = (0, _debug2['default'])('hedra:plugins:resize');\n\t\n\tfunction resize(config) {\n\t\tdebug('resize');\n\t\n\t\tvar parent = this.renderer.domElement.parentNode;\n\t\tvar event = {};\n\t\n\t\tif (parent === document.body) {\n\t\t\tevent.width = window.innerWidth;\n\t\t\tevent.height = window.innerHeight;\n\t\t} else {\n\t\t\tevent.width = parent.offsetWidth;\n\t\t\tevent.height = parent.offsetHeight;\n\t\t}\n\t\n\t\tthis.bubble('resize', event);\n\t\n\t\tthis.camera.aspect = event.width / event.height;\n\t\n\t\tif (config.fov) {\n\t\t\tthis.camera.fov = config.y;\n\t\n\t\t\tvar height = 2 * Math.tan(_three2['default'].Math.degToRad(config.y / 2));\n\t\t\tevent.fovx = _three2['default'].Math.radToDeg(2 * Math.atan(height * this.camera.aspect / 2));\n\t\t\tevent.fovy = _three2['default'].Math.radToDeg(2 * Math.atan(height / 2));\n\t\n\t\t\tif (event.fovx < config.x) {\n\t\t\t\tvar width = 2 * Math.tan(_three2['default'].Math.degToRad(config.x / 2));\n\t\t\t\tevent.fovy = _three2['default'].Math.radToDeg(2 * Math.atan(width / this.camera.aspect / 2));\n\t\t\t\tevent.fovx = _three2['default'].Math.radToDeg(2 * Math.atan(width / 2));\n\t\n\t\t\t\tthis.camera.fov = event.fovy;\n\t\t\t}\n\t\t}\n\t\n\t\tthis.bubble('resize-post', event);\n\t\n\t\tthis.camera.updateProjectionMatrix();\n\t\n\t\tthis.renderer.setSize(event.width, event.height);\n\t}\n\t\n\tfunction Resize(context, config) {\n\t\tdebug('initialize', config);\n\t\n\t\tconfig = config || {};\n\t\tif (config.fov !== false) {\n\t\t\tconfig.fov = true;\n\t\t}\n\t\n\t\twindow.addEventListener('resize', resize.bind(context, config), false);\n\t\tsetTimeout(resize.bind(context, config), 0);\n\t\n\t\tif (config.fov) {\n\t\t\tif (!config.ratio) {\n\t\t\t\tconfig.ratio = 16 / 9;\n\t\t\t}\n\t\n\t\t\tif (!config.y) {\n\t\t\t\tconfig.y = 2 * _three2['default'].Math.radToDeg(Math.atan(3 / 4));\n\t\t\t}\n\t\n\t\t\tvar height = 2 * Math.tan(_three2['default'].Math.degToRad(config.y / 2));\n\t\n\t\t\tif (!config.x) {\n\t\t\t\tconfig.x = 2 * _three2['default'].Math.radToDeg(Math.atan(height / 2 * config.ratio));\n\t\t\t}\n\t\n\t\t\tvar width = 2 * Math.tan(_three2['default'].Math.degToRad(config.x / 2));\n\t\n\t\t\tif (config.helper) {\n\t\t\t\tcontext.fov_helper = new _three2['default'].Mesh(new _three2['default'].BoxGeometry(width / height, 1, 1), new _three2['default'].MeshBasicMaterial({ wireframe: true }));\n\t\t\t\tcontext.fov_helper.name = 'FOV Helper';\n\t\t\t\tcontext.fov_helper.position.set(0, 0, -1 / height - 0.5);\n\t\t\t\tcontext.camera.add(context.fov_helper);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 95 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\texports.fromDisc = fromDisc;\n\texports.fromCircle = fromCircle;\n\t\n\tfunction fromDisc(radius) {\n\t\tradius *= Math.sqrt(Math.random());\n\t\n\t\tvar angle = 2 * Math.PI * Math.random();\n\t\n\t\treturn [radius * Math.cos(angle), radius * Math.sin(angle)];\n\t}\n\t\n\tfunction fromCircle(radius) {\n\t\tvar angle = 2 * Math.PI * Math.random();\n\t\n\t\treturn [radius * Math.cos(angle), radius * Math.sin(angle)];\n\t}\n\n/***/ },\n/* 96 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _get = __webpack_require__(7)['default'];\n\t\n\tvar _inherits = __webpack_require__(21)['default'];\n\t\n\tvar _createClass = __webpack_require__(32)['default'];\n\t\n\tvar _classCallCheck = __webpack_require__(35)['default'];\n\t\n\tvar _toConsumableArray = __webpack_require__(36)['default'];\n\t\n\tvar _bind = __webpack_require__(97)['default'];\n\t\n\tvar _Promise = __webpack_require__(63)['default'];\n\t\n\tvar _interopRequireDefault = __webpack_require__(1)['default'];\n\t\n\tObject.defineProperty(exports, '__esModule', {\n\t\tvalue: true\n\t});\n\t\n\tvar _debug = __webpack_require__(3);\n\t\n\tvar _debug2 = _interopRequireDefault(_debug);\n\t\n\tvar _hedra = __webpack_require__(85);\n\t\n\tvar _hedra2 = _interopRequireDefault(_hedra);\n\t\n\tvar _three = __webpack_require__(87);\n\t\n\tvar _three2 = _interopRequireDefault(_three);\n\t\n\tvar _steering = __webpack_require__(98);\n\t\n\tvar _steering2 = _interopRequireDefault(_steering);\n\t\n\tvar debug = (0, _debug2['default'])('app:agent');\n\t\n\tvar geometry = undefined;\n\tvar material = undefined;\n\t\n\tvar Agent = (function (_Hedra) {\n\t\t_inherits(Agent, _Hedra);\n\t\n\t\t_createClass(Agent, null, [{\n\t\t\tkey: 'load',\n\t\t\tvalue: function load() {\n\t\t\t\treturn new _Promise(function (resolve) {\n\t\t\t\t\tvar vertices = [0, 0, -1, 1, 1, 1, -1, 1, 1, -1, -1, 1, 1, -1, 1];\n\t\n\t\t\t\t\tvar faces = [2, 1, 0, 3, 2, 0, 4, 3, 0, 1, 4, 0, 1, 2, 3, 3, 4, 1];\n\t\n\t\t\t\t\tgeometry = new _three2['default'].PolyhedronGeometry(vertices, faces, 1);\n\t\n\t\t\t\t\tmaterial = new _three2['default'].MeshNormalMaterial();\n\t\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t\t}\n\t\t}]);\n\t\n\t\tfunction Agent(config) {\n\t\t\tvar _this = this;\n\t\n\t\t\t_classCallCheck(this, Agent);\n\t\n\t\t\tdebug('construct');\n\t\n\t\t\tconfig = config || {};\n\t\t\tconfig.geometry = geometry;\n\t\t\tconfig.material = material;\n\t\n\t\t\t_get(Object.getPrototypeOf(Agent.prototype), 'constructor', this).call(this, config);\n\t\n\t\t\tthis.steering = new _steering2['default'](this);\n\t\n\t\t\tthis.on('update').then(function (dt, t) {\n\t\t\t\tvar _position;\n\t\n\t\t\t\t_this.steering.update(dt);\n\t\n\t\t\t\t(_position = _this.position).set.apply(_position, _toConsumableArray(_this.steering.position));\n\t\n\t\t\t\t_this.quaternion.setFromRotationMatrix(new _three2['default'].Matrix4().lookAt(new _three2['default'].Vector3(), new (_bind.apply(_three2['default'].Vector3, [null].concat(_toConsumableArray(_this.steering.velocity))))(), new _three2['default'].Vector3(0, 0, 1)));\n\t\t\t});\n\t\t}\n\t\n\t\treturn Agent;\n\t})(_hedra2['default']);\n\t\n\texports['default'] = Agent;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 97 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\texports[\"default\"] = Function.prototype.bind;\n\texports.__esModule = true;\n\n/***/ },\n/* 98 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _get = __webpack_require__(7)['default'];\n\t\n\tvar _inherits = __webpack_require__(21)['default'];\n\t\n\tvar _createClass = __webpack_require__(32)['default'];\n\t\n\tvar _classCallCheck = __webpack_require__(35)['default'];\n\t\n\tvar _interopRequireDefault = __webpack_require__(1)['default'];\n\t\n\tObject.defineProperty(exports, '__esModule', {\n\t\tvalue: true\n\t});\n\t\n\tvar _debug = __webpack_require__(3);\n\t\n\tvar _debug2 = _interopRequireDefault(_debug);\n\t\n\tvar _emitter = __webpack_require__(86);\n\t\n\tvar _emitter2 = _interopRequireDefault(_emitter);\n\t\n\tvar _glMatrixVec3 = __webpack_require__(99);\n\t\n\tvar _glMatrixVec32 = _interopRequireDefault(_glMatrixVec3);\n\t\n\tvar debug = (0, _debug2['default'])('app:agent');\n\t\n\tvar Steering = (function (_Emitter) {\n\t\t_inherits(Steering, _Emitter);\n\t\n\t\tfunction Steering(track) {\n\t\t\t_classCallCheck(this, Steering);\n\t\n\t\t\tdebug('construct');\n\t\n\t\t\t_get(Object.getPrototypeOf(Steering.prototype), 'constructor', this).call(this);\n\t\n\t\t\tif (track) {\n\t\t\t\tthis._position = track.position;\n\t\t\t}\n\t\n\t\t\tthis.speed = 1;\n\t\t\tthis.velocity = _glMatrixVec32['default'].fromValues(1, 0, 0);\n\t\t\tthis.position = _glMatrixVec32['default'].fromValues(0, 0, 0);\n\t\t}\n\t\n\t\t_createClass(Steering, [{\n\t\t\tkey: 'update',\n\t\t\tvalue: function update(dt) {\n\t\t\t\tvar force = _glMatrixVec32['default'].create();\n\t\n\t\t\t\t_glMatrixVec32['default'].set(force, 0, 0, 0);\n\t\t\t\tthis.emit('steer', force);\n\t\n\t\t\t\t_glMatrixVec32['default'].scale(force, force, dt);\n\t\n\t\t\t\t_glMatrixVec32['default'].add(this.velocity, this.velocity, force);\n\t\t\t\t_glMatrixVec32['default'].normalize(this.velocity, this.velocity);\n\t\t\t\t_glMatrixVec32['default'].scale(this.velocity, this.velocity, this.speed);\n\t\n\t\t\t\t_glMatrixVec32['default'].add(this.position, this.position, _glMatrixVec32['default'].scale([], this.velocity, dt));\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Steering;\n\t})(_emitter2['default']);\n\t\n\texports['default'] = Steering;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 99 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/* Copyright (c) 2015, Brandon Jones, Colin MacKenzie IV.\n\t\n\tPermission is hereby granted, free of charge, to any person obtaining a copy\n\tof this software and associated documentation files (the \"Software\"), to deal\n\tin the Software without restriction, including without limitation the rights\n\tto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n\tcopies of the Software, and to permit persons to whom the Software is\n\tfurnished to do so, subject to the following conditions:\n\t\n\tThe above copyright notice and this permission notice shall be included in\n\tall copies or substantial portions of the Software.\n\t\n\tTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n\tIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n\tFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n\tAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n\tLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n\tOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n\tTHE SOFTWARE. */\n\t\n\t'use strict';\n\t\n\tvar glMatrix = __webpack_require__(100);\n\t\n\t/**\n\t * @class 3 Dimensional Vector\n\t * @name vec3\n\t */\n\tvar vec3 = {};\n\t\n\t/**\n\t * Creates a new, empty vec3\n\t *\n\t * @returns {vec3} a new 3D vector\n\t */\n\tvec3.create = function () {\n\t    var out = new glMatrix.ARRAY_TYPE(3);\n\t    out[0] = 0;\n\t    out[1] = 0;\n\t    out[2] = 0;\n\t    return out;\n\t};\n\t\n\t/**\n\t * Creates a new vec3 initialized with values from an existing vector\n\t *\n\t * @param {vec3} a vector to clone\n\t * @returns {vec3} a new 3D vector\n\t */\n\tvec3.clone = function (a) {\n\t    var out = new glMatrix.ARRAY_TYPE(3);\n\t    out[0] = a[0];\n\t    out[1] = a[1];\n\t    out[2] = a[2];\n\t    return out;\n\t};\n\t\n\t/**\n\t * Creates a new vec3 initialized with the given values\n\t *\n\t * @param {Number} x X component\n\t * @param {Number} y Y component\n\t * @param {Number} z Z component\n\t * @returns {vec3} a new 3D vector\n\t */\n\tvec3.fromValues = function (x, y, z) {\n\t    var out = new glMatrix.ARRAY_TYPE(3);\n\t    out[0] = x;\n\t    out[1] = y;\n\t    out[2] = z;\n\t    return out;\n\t};\n\t\n\t/**\n\t * Copy the values from one vec3 to another\n\t *\n\t * @param {vec3} out the receiving vector\n\t * @param {vec3} a the source vector\n\t * @returns {vec3} out\n\t */\n\tvec3.copy = function (out, a) {\n\t    out[0] = a[0];\n\t    out[1] = a[1];\n\t    out[2] = a[2];\n\t    return out;\n\t};\n\t\n\t/**\n\t * Set the components of a vec3 to the given values\n\t *\n\t * @param {vec3} out the receiving vector\n\t * @param {Number} x X component\n\t * @param {Number} y Y component\n\t * @param {Number} z Z component\n\t * @returns {vec3} out\n\t */\n\tvec3.set = function (out, x, y, z) {\n\t    out[0] = x;\n\t    out[1] = y;\n\t    out[2] = z;\n\t    return out;\n\t};\n\t\n\t/**\n\t * Adds two vec3's\n\t *\n\t * @param {vec3} out the receiving vector\n\t * @param {vec3} a the first operand\n\t * @param {vec3} b the second operand\n\t * @returns {vec3} out\n\t */\n\tvec3.add = function (out, a, b) {\n\t    out[0] = a[0] + b[0];\n\t    out[1] = a[1] + b[1];\n\t    out[2] = a[2] + b[2];\n\t    return out;\n\t};\n\t\n\t/**\n\t * Subtracts vector b from vector a\n\t *\n\t * @param {vec3} out the receiving vector\n\t * @param {vec3} a the first operand\n\t * @param {vec3} b the second operand\n\t * @returns {vec3} out\n\t */\n\tvec3.subtract = function (out, a, b) {\n\t    out[0] = a[0] - b[0];\n\t    out[1] = a[1] - b[1];\n\t    out[2] = a[2] - b[2];\n\t    return out;\n\t};\n\t\n\t/**\n\t * Alias for {@link vec3.subtract}\n\t * @function\n\t */\n\tvec3.sub = vec3.subtract;\n\t\n\t/**\n\t * Multiplies two vec3's\n\t *\n\t * @param {vec3} out the receiving vector\n\t * @param {vec3} a the first operand\n\t * @param {vec3} b the second operand\n\t * @returns {vec3} out\n\t */\n\tvec3.multiply = function (out, a, b) {\n\t    out[0] = a[0] * b[0];\n\t    out[1] = a[1] * b[1];\n\t    out[2] = a[2] * b[2];\n\t    return out;\n\t};\n\t\n\t/**\n\t * Alias for {@link vec3.multiply}\n\t * @function\n\t */\n\tvec3.mul = vec3.multiply;\n\t\n\t/**\n\t * Divides two vec3's\n\t *\n\t * @param {vec3} out the receiving vector\n\t * @param {vec3} a the first operand\n\t * @param {vec3} b the second operand\n\t * @returns {vec3} out\n\t */\n\tvec3.divide = function (out, a, b) {\n\t    out[0] = a[0] / b[0];\n\t    out[1] = a[1] / b[1];\n\t    out[2] = a[2] / b[2];\n\t    return out;\n\t};\n\t\n\t/**\n\t * Alias for {@link vec3.divide}\n\t * @function\n\t */\n\tvec3.div = vec3.divide;\n\t\n\t/**\n\t * Returns the minimum of two vec3's\n\t *\n\t * @param {vec3} out the receiving vector\n\t * @param {vec3} a the first operand\n\t * @param {vec3} b the second operand\n\t * @returns {vec3} out\n\t */\n\tvec3.min = function (out, a, b) {\n\t    out[0] = Math.min(a[0], b[0]);\n\t    out[1] = Math.min(a[1], b[1]);\n\t    out[2] = Math.min(a[2], b[2]);\n\t    return out;\n\t};\n\t\n\t/**\n\t * Returns the maximum of two vec3's\n\t *\n\t * @param {vec3} out the receiving vector\n\t * @param {vec3} a the first operand\n\t * @param {vec3} b the second operand\n\t * @returns {vec3} out\n\t */\n\tvec3.max = function (out, a, b) {\n\t    out[0] = Math.max(a[0], b[0]);\n\t    out[1] = Math.max(a[1], b[1]);\n\t    out[2] = Math.max(a[2], b[2]);\n\t    return out;\n\t};\n\t\n\t/**\n\t * Scales a vec3 by a scalar number\n\t *\n\t * @param {vec3} out the receiving vector\n\t * @param {vec3} a the vector to scale\n\t * @param {Number} b amount to scale the vector by\n\t * @returns {vec3} out\n\t */\n\tvec3.scale = function (out, a, b) {\n\t    out[0] = a[0] * b;\n\t    out[1] = a[1] * b;\n\t    out[2] = a[2] * b;\n\t    return out;\n\t};\n\t\n\t/**\n\t * Adds two vec3's after scaling the second operand by a scalar value\n\t *\n\t * @param {vec3} out the receiving vector\n\t * @param {vec3} a the first operand\n\t * @param {vec3} b the second operand\n\t * @param {Number} scale the amount to scale b by before adding\n\t * @returns {vec3} out\n\t */\n\tvec3.scaleAndAdd = function (out, a, b, scale) {\n\t    out[0] = a[0] + b[0] * scale;\n\t    out[1] = a[1] + b[1] * scale;\n\t    out[2] = a[2] + b[2] * scale;\n\t    return out;\n\t};\n\t\n\t/**\n\t * Calculates the euclidian distance between two vec3's\n\t *\n\t * @param {vec3} a the first operand\n\t * @param {vec3} b the second operand\n\t * @returns {Number} distance between a and b\n\t */\n\tvec3.distance = function (a, b) {\n\t    var x = b[0] - a[0],\n\t        y = b[1] - a[1],\n\t        z = b[2] - a[2];\n\t    return Math.sqrt(x * x + y * y + z * z);\n\t};\n\t\n\t/**\n\t * Alias for {@link vec3.distance}\n\t * @function\n\t */\n\tvec3.dist = vec3.distance;\n\t\n\t/**\n\t * Calculates the squared euclidian distance between two vec3's\n\t *\n\t * @param {vec3} a the first operand\n\t * @param {vec3} b the second operand\n\t * @returns {Number} squared distance between a and b\n\t */\n\tvec3.squaredDistance = function (a, b) {\n\t    var x = b[0] - a[0],\n\t        y = b[1] - a[1],\n\t        z = b[2] - a[2];\n\t    return x * x + y * y + z * z;\n\t};\n\t\n\t/**\n\t * Alias for {@link vec3.squaredDistance}\n\t * @function\n\t */\n\tvec3.sqrDist = vec3.squaredDistance;\n\t\n\t/**\n\t * Calculates the length of a vec3\n\t *\n\t * @param {vec3} a vector to calculate length of\n\t * @returns {Number} length of a\n\t */\n\tvec3.length = function (a) {\n\t    var x = a[0],\n\t        y = a[1],\n\t        z = a[2];\n\t    return Math.sqrt(x * x + y * y + z * z);\n\t};\n\t\n\t/**\n\t * Alias for {@link vec3.length}\n\t * @function\n\t */\n\tvec3.len = vec3.length;\n\t\n\t/**\n\t * Calculates the squared length of a vec3\n\t *\n\t * @param {vec3} a vector to calculate squared length of\n\t * @returns {Number} squared length of a\n\t */\n\tvec3.squaredLength = function (a) {\n\t    var x = a[0],\n\t        y = a[1],\n\t        z = a[2];\n\t    return x * x + y * y + z * z;\n\t};\n\t\n\t/**\n\t * Alias for {@link vec3.squaredLength}\n\t * @function\n\t */\n\tvec3.sqrLen = vec3.squaredLength;\n\t\n\t/**\n\t * Negates the components of a vec3\n\t *\n\t * @param {vec3} out the receiving vector\n\t * @param {vec3} a vector to negate\n\t * @returns {vec3} out\n\t */\n\tvec3.negate = function (out, a) {\n\t    out[0] = -a[0];\n\t    out[1] = -a[1];\n\t    out[2] = -a[2];\n\t    return out;\n\t};\n\t\n\t/**\n\t * Returns the inverse of the components of a vec3\n\t *\n\t * @param {vec3} out the receiving vector\n\t * @param {vec3} a vector to invert\n\t * @returns {vec3} out\n\t */\n\tvec3.inverse = function (out, a) {\n\t    out[0] = 1.0 / a[0];\n\t    out[1] = 1.0 / a[1];\n\t    out[2] = 1.0 / a[2];\n\t    return out;\n\t};\n\t\n\t/**\n\t * Normalize a vec3\n\t *\n\t * @param {vec3} out the receiving vector\n\t * @param {vec3} a vector to normalize\n\t * @returns {vec3} out\n\t */\n\tvec3.normalize = function (out, a) {\n\t    var x = a[0],\n\t        y = a[1],\n\t        z = a[2];\n\t    var len = x * x + y * y + z * z;\n\t    if (len > 0) {\n\t        //TODO: evaluate use of glm_invsqrt here?\n\t        len = 1 / Math.sqrt(len);\n\t        out[0] = a[0] * len;\n\t        out[1] = a[1] * len;\n\t        out[2] = a[2] * len;\n\t    }\n\t    return out;\n\t};\n\t\n\t/**\n\t * Calculates the dot product of two vec3's\n\t *\n\t * @param {vec3} a the first operand\n\t * @param {vec3} b the second operand\n\t * @returns {Number} dot product of a and b\n\t */\n\tvec3.dot = function (a, b) {\n\t    return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n\t};\n\t\n\t/**\n\t * Computes the cross product of two vec3's\n\t *\n\t * @param {vec3} out the receiving vector\n\t * @param {vec3} a the first operand\n\t * @param {vec3} b the second operand\n\t * @returns {vec3} out\n\t */\n\tvec3.cross = function (out, a, b) {\n\t    var ax = a[0],\n\t        ay = a[1],\n\t        az = a[2],\n\t        bx = b[0],\n\t        by = b[1],\n\t        bz = b[2];\n\t\n\t    out[0] = ay * bz - az * by;\n\t    out[1] = az * bx - ax * bz;\n\t    out[2] = ax * by - ay * bx;\n\t    return out;\n\t};\n\t\n\t/**\n\t * Performs a linear interpolation between two vec3's\n\t *\n\t * @param {vec3} out the receiving vector\n\t * @param {vec3} a the first operand\n\t * @param {vec3} b the second operand\n\t * @param {Number} t interpolation amount between the two inputs\n\t * @returns {vec3} out\n\t */\n\tvec3.lerp = function (out, a, b, t) {\n\t    var ax = a[0],\n\t        ay = a[1],\n\t        az = a[2];\n\t    out[0] = ax + t * (b[0] - ax);\n\t    out[1] = ay + t * (b[1] - ay);\n\t    out[2] = az + t * (b[2] - az);\n\t    return out;\n\t};\n\t\n\t/**\n\t * Performs a hermite interpolation with two control points\n\t *\n\t * @param {vec3} out the receiving vector\n\t * @param {vec3} a the first operand\n\t * @param {vec3} b the second operand\n\t * @param {vec3} c the third operand\n\t * @param {vec3} d the fourth operand\n\t * @param {Number} t interpolation amount between the two inputs\n\t * @returns {vec3} out\n\t */\n\tvec3.hermite = function (out, a, b, c, d, t) {\n\t    var factorTimes2 = t * t,\n\t        factor1 = factorTimes2 * (2 * t - 3) + 1,\n\t        factor2 = factorTimes2 * (t - 2) + t,\n\t        factor3 = factorTimes2 * (t - 1),\n\t        factor4 = factorTimes2 * (3 - 2 * t);\n\t\n\t    out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n\t    out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n\t    out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n\t\n\t    return out;\n\t};\n\t\n\t/**\n\t * Performs a bezier interpolation with two control points\n\t *\n\t * @param {vec3} out the receiving vector\n\t * @param {vec3} a the first operand\n\t * @param {vec3} b the second operand\n\t * @param {vec3} c the third operand\n\t * @param {vec3} d the fourth operand\n\t * @param {Number} t interpolation amount between the two inputs\n\t * @returns {vec3} out\n\t */\n\tvec3.bezier = function (out, a, b, c, d, t) {\n\t    var inverseFactor = 1 - t,\n\t        inverseFactorTimesTwo = inverseFactor * inverseFactor,\n\t        factorTimes2 = t * t,\n\t        factor1 = inverseFactorTimesTwo * inverseFactor,\n\t        factor2 = 3 * t * inverseFactorTimesTwo,\n\t        factor3 = 3 * factorTimes2 * inverseFactor,\n\t        factor4 = factorTimes2 * t;\n\t\n\t    out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n\t    out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n\t    out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n\t\n\t    return out;\n\t};\n\t\n\t/**\n\t * Generates a random vector with the given scale\n\t *\n\t * @param {vec3} out the receiving vector\n\t * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\n\t * @returns {vec3} out\n\t */\n\tvec3.random = function (out, scale) {\n\t    scale = scale || 1.0;\n\t\n\t    var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n\t    var z = glMatrix.RANDOM() * 2.0 - 1.0;\n\t    var zScale = Math.sqrt(1.0 - z * z) * scale;\n\t\n\t    out[0] = Math.cos(r) * zScale;\n\t    out[1] = Math.sin(r) * zScale;\n\t    out[2] = z * scale;\n\t    return out;\n\t};\n\t\n\t/**\n\t * Transforms the vec3 with a mat4.\n\t * 4th vector component is implicitly '1'\n\t *\n\t * @param {vec3} out the receiving vector\n\t * @param {vec3} a the vector to transform\n\t * @param {mat4} m matrix to transform with\n\t * @returns {vec3} out\n\t */\n\tvec3.transformMat4 = function (out, a, m) {\n\t    var x = a[0],\n\t        y = a[1],\n\t        z = a[2],\n\t        w = m[3] * x + m[7] * y + m[11] * z + m[15];\n\t    w = w || 1.0;\n\t    out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\n\t    out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\n\t    out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\n\t    return out;\n\t};\n\t\n\t/**\n\t * Transforms the vec3 with a mat3.\n\t *\n\t * @param {vec3} out the receiving vector\n\t * @param {vec3} a the vector to transform\n\t * @param {mat4} m the 3x3 matrix to transform with\n\t * @returns {vec3} out\n\t */\n\tvec3.transformMat3 = function (out, a, m) {\n\t    var x = a[0],\n\t        y = a[1],\n\t        z = a[2];\n\t    out[0] = x * m[0] + y * m[3] + z * m[6];\n\t    out[1] = x * m[1] + y * m[4] + z * m[7];\n\t    out[2] = x * m[2] + y * m[5] + z * m[8];\n\t    return out;\n\t};\n\t\n\t/**\n\t * Transforms the vec3 with a quat\n\t *\n\t * @param {vec3} out the receiving vector\n\t * @param {vec3} a the vector to transform\n\t * @param {quat} q quaternion to transform with\n\t * @returns {vec3} out\n\t */\n\tvec3.transformQuat = function (out, a, q) {\n\t    // benchmarks: http://jsperf.com/quaternion-transform-vec3-implementations\n\t\n\t    var x = a[0],\n\t        y = a[1],\n\t        z = a[2],\n\t        qx = q[0],\n\t        qy = q[1],\n\t        qz = q[2],\n\t        qw = q[3],\n\t\n\t    // calculate quat * vec\n\t    ix = qw * x + qy * z - qz * y,\n\t        iy = qw * y + qz * x - qx * z,\n\t        iz = qw * z + qx * y - qy * x,\n\t        iw = -qx * x - qy * y - qz * z;\n\t\n\t    // calculate result * inverse quat\n\t    out[0] = ix * qw + iw * -qx + iy * -qz - iz * -qy;\n\t    out[1] = iy * qw + iw * -qy + iz * -qx - ix * -qz;\n\t    out[2] = iz * qw + iw * -qz + ix * -qy - iy * -qx;\n\t    return out;\n\t};\n\t\n\t/**\n\t * Rotate a 3D vector around the x-axis\n\t * @param {vec3} out The receiving vec3\n\t * @param {vec3} a The vec3 point to rotate\n\t * @param {vec3} b The origin of the rotation\n\t * @param {Number} c The angle of rotation\n\t * @returns {vec3} out\n\t */\n\tvec3.rotateX = function (out, a, b, c) {\n\t    var p = [],\n\t        r = [];\n\t    //Translate point to the origin\n\t    p[0] = a[0] - b[0];\n\t    p[1] = a[1] - b[1];\n\t    p[2] = a[2] - b[2];\n\t\n\t    //perform rotation\n\t    r[0] = p[0];\n\t    r[1] = p[1] * Math.cos(c) - p[2] * Math.sin(c);\n\t    r[2] = p[1] * Math.sin(c) + p[2] * Math.cos(c);\n\t\n\t    //translate to correct position\n\t    out[0] = r[0] + b[0];\n\t    out[1] = r[1] + b[1];\n\t    out[2] = r[2] + b[2];\n\t\n\t    return out;\n\t};\n\t\n\t/**\n\t * Rotate a 3D vector around the y-axis\n\t * @param {vec3} out The receiving vec3\n\t * @param {vec3} a The vec3 point to rotate\n\t * @param {vec3} b The origin of the rotation\n\t * @param {Number} c The angle of rotation\n\t * @returns {vec3} out\n\t */\n\tvec3.rotateY = function (out, a, b, c) {\n\t    var p = [],\n\t        r = [];\n\t    //Translate point to the origin\n\t    p[0] = a[0] - b[0];\n\t    p[1] = a[1] - b[1];\n\t    p[2] = a[2] - b[2];\n\t\n\t    //perform rotation\n\t    r[0] = p[2] * Math.sin(c) + p[0] * Math.cos(c);\n\t    r[1] = p[1];\n\t    r[2] = p[2] * Math.cos(c) - p[0] * Math.sin(c);\n\t\n\t    //translate to correct position\n\t    out[0] = r[0] + b[0];\n\t    out[1] = r[1] + b[1];\n\t    out[2] = r[2] + b[2];\n\t\n\t    return out;\n\t};\n\t\n\t/**\n\t * Rotate a 3D vector around the z-axis\n\t * @param {vec3} out The receiving vec3\n\t * @param {vec3} a The vec3 point to rotate\n\t * @param {vec3} b The origin of the rotation\n\t * @param {Number} c The angle of rotation\n\t * @returns {vec3} out\n\t */\n\tvec3.rotateZ = function (out, a, b, c) {\n\t    var p = [],\n\t        r = [];\n\t    //Translate point to the origin\n\t    p[0] = a[0] - b[0];\n\t    p[1] = a[1] - b[1];\n\t    p[2] = a[2] - b[2];\n\t\n\t    //perform rotation\n\t    r[0] = p[0] * Math.cos(c) - p[1] * Math.sin(c);\n\t    r[1] = p[0] * Math.sin(c) + p[1] * Math.cos(c);\n\t    r[2] = p[2];\n\t\n\t    //translate to correct position\n\t    out[0] = r[0] + b[0];\n\t    out[1] = r[1] + b[1];\n\t    out[2] = r[2] + b[2];\n\t\n\t    return out;\n\t};\n\t\n\t/**\n\t * Perform some operation over an array of vec3s.\n\t *\n\t * @param {Array} a the array of vectors to iterate over\n\t * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed\n\t * @param {Number} offset Number of elements to skip at the beginning of the array\n\t * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array\n\t * @param {Function} fn Function to call for each vector in the array\n\t * @param {Object} [arg] additional argument to pass to fn\n\t * @returns {Array} a\n\t * @function\n\t */\n\tvec3.forEach = (function () {\n\t    var vec = vec3.create();\n\t\n\t    return function (a, stride, offset, count, fn, arg) {\n\t        var i, l;\n\t        if (!stride) {\n\t            stride = 3;\n\t        }\n\t\n\t        if (!offset) {\n\t            offset = 0;\n\t        }\n\t\n\t        if (count) {\n\t            l = Math.min(count * stride + offset, a.length);\n\t        } else {\n\t            l = a.length;\n\t        }\n\t\n\t        for (i = offset; i < l; i += stride) {\n\t            vec[0] = a[i];vec[1] = a[i + 1];vec[2] = a[i + 2];\n\t            fn(vec, vec, arg);\n\t            a[i] = vec[0];a[i + 1] = vec[1];a[i + 2] = vec[2];\n\t        }\n\t\n\t        return a;\n\t    };\n\t})();\n\t\n\t/**\n\t * Get the angle between two 3D vectors\n\t * @param {vec3} a The first operand\n\t * @param {vec3} b The second operand\n\t * @returns {Number} The angle in radians\n\t */\n\tvec3.angle = function (a, b) {\n\t\n\t    var tempA = vec3.fromValues(a[0], a[1], a[2]);\n\t    var tempB = vec3.fromValues(b[0], b[1], b[2]);\n\t\n\t    vec3.normalize(tempA, tempA);\n\t    vec3.normalize(tempB, tempB);\n\t\n\t    var cosine = vec3.dot(tempA, tempB);\n\t\n\t    if (cosine > 1.0) {\n\t        return 0;\n\t    } else {\n\t        return Math.acos(cosine);\n\t    }\n\t};\n\t\n\t/**\n\t * Returns a string representation of a vector\n\t *\n\t * @param {vec3} vec vector to represent as a string\n\t * @returns {String} string representation of the vector\n\t */\n\tvec3.str = function (a) {\n\t    return 'vec3(' + a[0] + ', ' + a[1] + ', ' + a[2] + ')';\n\t};\n\t\n\tmodule.exports = vec3;\n\n/***/ },\n/* 100 */\n/***/ function(module, exports) {\n\n\t/* Copyright (c) 2015, Brandon Jones, Colin MacKenzie IV.\n\t\n\tPermission is hereby granted, free of charge, to any person obtaining a copy\n\tof this software and associated documentation files (the \"Software\"), to deal\n\tin the Software without restriction, including without limitation the rights\n\tto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n\tcopies of the Software, and to permit persons to whom the Software is\n\tfurnished to do so, subject to the following conditions:\n\t\n\tThe above copyright notice and this permission notice shall be included in\n\tall copies or substantial portions of the Software.\n\t\n\tTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n\tIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n\tFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n\tAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n\tLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n\tOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n\tTHE SOFTWARE. */\n\t\n\t/**\n\t * @class Common utilities\n\t * @name glMatrix\n\t */\n\t'use strict';\n\t\n\tvar glMatrix = {};\n\t\n\t// Configuration Constants\n\tglMatrix.EPSILON = 0.000001;\n\tglMatrix.ARRAY_TYPE = typeof Float32Array !== 'undefined' ? Float32Array : Array;\n\tglMatrix.RANDOM = Math.random;\n\tglMatrix.ENABLE_SIMD = false;\n\t\n\t// Capability detection\n\tglMatrix.SIMD_AVAILABLE = glMatrix.ARRAY_TYPE === Float32Array && 'SIMD' in window;\n\tglMatrix.USE_SIMD = glMatrix.ENABLE_SIMD && glMatrix.SIMD_AVAILABLE;\n\t\n\t/**\n\t * Sets the type of array used when creating new vectors and matrices\n\t *\n\t * @param {Type} type Array type, such as Float32Array or Array\n\t */\n\tglMatrix.setMatrixArrayType = function (type) {\n\t  glMatrix.ARRAY_TYPE = type;\n\t};\n\t\n\tvar degree = Math.PI / 180;\n\t\n\t/**\n\t* Convert Degree To Radian\n\t*\n\t* @param {Number} Angle in Degrees\n\t*/\n\tglMatrix.toRadian = function (a) {\n\t  return a * degree;\n\t};\n\t\n\tmodule.exports = glMatrix;\n\n/***/ },\n/* 101 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _interopRequireDefault = __webpack_require__(1)['default'];\n\t\n\tObject.defineProperty(exports, '__esModule', {\n\t\tvalue: true\n\t});\n\t\n\tvar _agent = __webpack_require__(96);\n\t\n\tvar _agent2 = _interopRequireDefault(_agent);\n\t\n\tvar _steeringBehavioursWander = __webpack_require__(102);\n\t\n\tvar _steeringBehavioursWander2 = _interopRequireDefault(_steeringBehavioursWander);\n\t\n\tvar _steeringBehavioursPursue = __webpack_require__(104);\n\t\n\tvar _steeringBehavioursPursue2 = _interopRequireDefault(_steeringBehavioursPursue);\n\t\n\tvar _steeringBehavioursEvade = __webpack_require__(106);\n\t\n\tvar _steeringBehavioursEvade2 = _interopRequireDefault(_steeringBehavioursEvade);\n\t\n\texports['default'] = function () {\n\t\tvar agents = [];\n\t\n\t\tvar predator = new _agent2['default']();\n\t\tagents.push(predator);\n\t\n\t\tpredator.steering.wander = new _steeringBehavioursWander2['default'](predator.steering, { weight: 25 });\n\t\tpredator.steering.speed = 5;\n\t\n\t\tvar prey = new _agent2['default']();\n\t\tagents.push(prey);\n\t\n\t\tprey.steering.wander = new _steeringBehavioursWander2['default'](prey.steering, { weight: 25 });\n\t\tprey.steering.speed = 5 * 1.5;\n\t\n\t\tpredator.steering.pursue = new _steeringBehavioursPursue2['default'](predator.steering, { weight: 5, target: prey.steering, radius: 0 });\n\t\tprey.steering.evade = new _steeringBehavioursEvade2['default'](prey.steering, { weight: 5, target: predator.steering, radius: 0 });\n\t\n\t\treturn agents;\n\t};\n\t\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 102 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _get = __webpack_require__(7)['default'];\n\t\n\tvar _inherits = __webpack_require__(21)['default'];\n\t\n\tvar _classCallCheck = __webpack_require__(35)['default'];\n\t\n\tvar _toConsumableArray = __webpack_require__(36)['default'];\n\t\n\tvar _interopRequireDefault = __webpack_require__(1)['default'];\n\t\n\tObject.defineProperty(exports, '__esModule', {\n\t\tvalue: true\n\t});\n\t\n\tvar _behaviour = __webpack_require__(103);\n\t\n\tvar _behaviour2 = _interopRequireDefault(_behaviour);\n\t\n\tvar _glMatrixVec3 = __webpack_require__(99);\n\t\n\tvar _glMatrixVec32 = _interopRequireDefault(_glMatrixVec3);\n\t\n\tvar Wander = (function (_Behaviour) {\n\t\t_inherits(Wander, _Behaviour);\n\t\n\t\tfunction Wander(agent, _ref) {\n\t\t\tvar _this = this;\n\t\n\t\t\tvar weight = _ref.weight;\n\t\t\tvar _ref$radius = _ref.radius;\n\t\t\tvar radius = _ref$radius === undefined ? .5 : _ref$radius;\n\t\t\tvar _ref$distance = _ref.distance;\n\t\t\tvar distance = _ref$distance === undefined ? 1 : _ref$distance;\n\t\t\tvar _ref$volatility = _ref.volatility;\n\t\t\tvar volatility = _ref$volatility === undefined ? .5 : _ref$volatility;\n\t\n\t\t\t_classCallCheck(this, Wander);\n\t\n\t\t\t_get(Object.getPrototypeOf(Wander.prototype), 'constructor', this).call(this, agent, weight);\n\t\n\t\t\tthis.angle = 0;\n\t\t\tthis.radius = radius;\n\t\t\tthis.distance = distance;\n\t\t\tthis.volatility = volatility;\n\t\n\t\t\tagent.on('steer').then(function (force) {\n\t\t\t\t_this.angle += (Math.random() * 2 - 1) * volatility;\n\t\n\t\t\t\tvar displacement = _glMatrixVec32['default'].fromValues(Math.cos(_this.angle) * _this.radius, Math.sin(_this.angle) * _this.radius, 0);\n\t\n\t\t\t\tvar wander = _glMatrixVec32['default'].fromValues.apply(_glMatrixVec32['default'], _toConsumableArray(agent.velocity));\n\t\t\t\t_glMatrixVec32['default'].scale(wander, wander, _this.distance);\n\t\t\t\t_glMatrixVec32['default'].add(wander, wander, displacement);\n\t\n\t\t\t\t_glMatrixVec32['default'].normalize(wander, wander);\n\t\n\t\t\t\t_behaviour2['default'].addForce(force, wander, _this.weight);\n\t\t\t});\n\t\t}\n\t\n\t\treturn Wander;\n\t})(_behaviour2['default']);\n\t\n\texports['default'] = Wander;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 103 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _createClass = __webpack_require__(32)['default'];\n\t\n\tvar _classCallCheck = __webpack_require__(35)['default'];\n\t\n\tvar _interopRequireDefault = __webpack_require__(1)['default'];\n\t\n\tObject.defineProperty(exports, '__esModule', {\n\t\tvalue: true\n\t});\n\t\n\tvar _glMatrixVec3 = __webpack_require__(99);\n\t\n\tvar _glMatrixVec32 = _interopRequireDefault(_glMatrixVec3);\n\t\n\tvar Behaviour = (function () {\n\t\t_createClass(Behaviour, null, [{\n\t\t\tkey: 'addForce',\n\t\t\tvalue: function addForce(force, delta, weight) {\n\t\t\t\t_glMatrixVec32['default'].scale(delta, delta, weight);\n\t\t\t\t_glMatrixVec32['default'].add(force, force, delta);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'neighborhoodDistance',\n\t\t\tvalue: function neighborhoodDistance(source, agents, radius) {\n\t\t\t\treturn agents.map(function (agent) {\n\t\t\t\t\tvar delta = _glMatrixVec32['default'].sub([], source.position, agent.position);\n\t\n\t\t\t\t\treturn {\n\t\t\t\t\t\tdistance: _glMatrixVec32['default'].length(delta),\n\t\t\t\t\t\tagent: agent\n\t\t\t\t\t};\n\t\t\t\t}).filter(function (agent) {\n\t\t\t\t\treturn source !== agent.agent && agent.distance < radius;\n\t\t\t\t});\n\t\t\t}\n\t\t}]);\n\t\n\t\tfunction Behaviour(agent) {\n\t\t\tvar weight = arguments.length <= 1 || arguments[1] === undefined ? 1 : arguments[1];\n\t\n\t\t\t_classCallCheck(this, Behaviour);\n\t\n\t\t\tthis.agent = agent;\n\t\t\tthis.weight = weight;\n\t\t}\n\t\n\t\treturn Behaviour;\n\t})();\n\t\n\texports['default'] = Behaviour;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 104 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _get = __webpack_require__(7)['default'];\n\t\n\tvar _inherits = __webpack_require__(21)['default'];\n\t\n\tvar _classCallCheck = __webpack_require__(35)['default'];\n\t\n\tvar _interopRequireDefault = __webpack_require__(1)['default'];\n\t\n\tObject.defineProperty(exports, '__esModule', {\n\t\tvalue: true\n\t});\n\t\n\tvar _behaviour = __webpack_require__(103);\n\t\n\tvar _behaviour2 = _interopRequireDefault(_behaviour);\n\t\n\tvar _glMatrixVec3 = __webpack_require__(99);\n\t\n\tvar _glMatrixVec32 = _interopRequireDefault(_glMatrixVec3);\n\t\n\tvar _seek = __webpack_require__(105);\n\t\n\tvar Pursue = (function (_Behaviour) {\n\t\t_inherits(Pursue, _Behaviour);\n\t\n\t\tfunction Pursue(agent, _ref) {\n\t\t\tvar _this = this;\n\t\n\t\t\tvar weight = _ref.weight;\n\t\t\tvar target = _ref.target;\n\t\t\tvar _ref$radius = _ref.radius;\n\t\t\tvar radius = _ref$radius === undefined ? 0 : _ref$radius;\n\t\n\t\t\t_classCallCheck(this, Pursue);\n\t\n\t\t\t_get(Object.getPrototypeOf(Pursue.prototype), 'constructor', this).call(this, agent, weight);\n\t\n\t\t\tthis.target = target;\n\t\t\tthis.radius = radius;\n\t\n\t\t\tagent.on('steer').then(function (force) {\n\t\t\t\tvar distance = _glMatrixVec32['default'].length(_glMatrixVec32['default'].sub([], _this.target.position, agent.position));\n\t\t\t\tvar time = distance / agent.speed;\n\t\n\t\t\t\tvar position = _glMatrixVec32['default'].scale([], _this.target.velocity, time);\n\t\t\t\t_glMatrixVec32['default'].add(position, position, _this.target.position);\n\t\n\t\t\t\tvar pursue = (0, _seek.seek)(agent, { position: position }, _this.radius);\n\t\n\t\t\t\t_behaviour2['default'].addForce(force, pursue, _this.weight);\n\t\t\t});\n\t\t}\n\t\n\t\treturn Pursue;\n\t})(_behaviour2['default']);\n\t\n\texports['default'] = Pursue;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 105 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _get = __webpack_require__(7)['default'];\n\t\n\tvar _inherits = __webpack_require__(21)['default'];\n\t\n\tvar _classCallCheck = __webpack_require__(35)['default'];\n\t\n\tvar _interopRequireDefault = __webpack_require__(1)['default'];\n\t\n\tObject.defineProperty(exports, '__esModule', {\n\t\tvalue: true\n\t});\n\texports.seek = seek;\n\t\n\tvar _behaviour = __webpack_require__(103);\n\t\n\tvar _behaviour2 = _interopRequireDefault(_behaviour);\n\t\n\tvar _glMatrixVec3 = __webpack_require__(99);\n\t\n\tvar _glMatrixVec32 = _interopRequireDefault(_glMatrixVec3);\n\t\n\tvar Seek = (function (_Behaviour) {\n\t\t_inherits(Seek, _Behaviour);\n\t\n\t\tfunction Seek(agent, _ref) {\n\t\t\tvar _this = this;\n\t\n\t\t\tvar weight = _ref.weight;\n\t\t\tvar target = _ref.target;\n\t\t\tvar _ref$radius = _ref.radius;\n\t\t\tvar radius = _ref$radius === undefined ? 0 : _ref$radius;\n\t\n\t\t\t_classCallCheck(this, Seek);\n\t\n\t\t\t_get(Object.getPrototypeOf(Seek.prototype), 'constructor', this).call(this, agent, weight);\n\t\n\t\t\tthis.target = target;\n\t\t\tthis.radius = radius;\n\t\n\t\t\tagent.on('steer').then(function (force) {\n\t\t\t\tvar delta = seek(agent, _this.target, _this.radius);\n\t\n\t\t\t\t_behaviour2['default'].addForce(force, delta, _this.weight);\n\t\t\t});\n\t\t}\n\t\n\t\treturn Seek;\n\t})(_behaviour2['default']);\n\t\n\texports['default'] = Seek;\n\t\n\tfunction seek(agent, target, radius) {\n\t\tvar seek = _glMatrixVec32['default'].sub([], target.position, agent.position);\n\t\tvar distance = _glMatrixVec32['default'].length(seek);\n\t\n\t\t_glMatrixVec32['default'].normalize(seek, seek);\n\t\t_glMatrixVec32['default'].scale(seek, seek, agent.speed);\n\t\n\t\tif (distance < radius) {\n\t\t\t_glMatrixVec32['default'].scale(seek, seek, distance / radius);\n\t\t}\n\t\n\t\t_glMatrixVec32['default'].sub(seek, seek, agent.velocity);\n\t\n\t\t_glMatrixVec32['default'].normalize(seek, seek);\n\t\n\t\treturn seek;\n\t}\n\n/***/ },\n/* 106 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _get = __webpack_require__(7)['default'];\n\t\n\tvar _inherits = __webpack_require__(21)['default'];\n\t\n\tvar _classCallCheck = __webpack_require__(35)['default'];\n\t\n\tvar _interopRequireDefault = __webpack_require__(1)['default'];\n\t\n\tObject.defineProperty(exports, '__esModule', {\n\t\tvalue: true\n\t});\n\t\n\tvar _behaviour = __webpack_require__(103);\n\t\n\tvar _behaviour2 = _interopRequireDefault(_behaviour);\n\t\n\tvar _glMatrixVec3 = __webpack_require__(99);\n\t\n\tvar _glMatrixVec32 = _interopRequireDefault(_glMatrixVec3);\n\t\n\tvar _flee = __webpack_require__(107);\n\t\n\tvar Pursue = (function (_Behaviour) {\n\t\t_inherits(Pursue, _Behaviour);\n\t\n\t\tfunction Pursue(agent, _ref) {\n\t\t\tvar _this = this;\n\t\n\t\t\tvar weight = _ref.weight;\n\t\t\tvar target = _ref.target;\n\t\t\tvar _ref$radius = _ref.radius;\n\t\t\tvar radius = _ref$radius === undefined ? 0 : _ref$radius;\n\t\n\t\t\t_classCallCheck(this, Pursue);\n\t\n\t\t\t_get(Object.getPrototypeOf(Pursue.prototype), 'constructor', this).call(this, agent, weight);\n\t\n\t\t\tthis.target = target;\n\t\t\tthis.radius = radius;\n\t\n\t\t\tagent.on('steer').then(function (force) {\n\t\t\t\tvar distance = _glMatrixVec32['default'].length(_glMatrixVec32['default'].sub([], _this.target.position, agent.position));\n\t\t\t\tvar time = distance / agent.speed;\n\t\n\t\t\t\tvar position = _glMatrixVec32['default'].scale([], _this.target.velocity, time);\n\t\t\t\t_glMatrixVec32['default'].add(position, position, _this.target.position);\n\t\n\t\t\t\tvar pursue = (0, _flee.flee)(agent, { position: position }, _this.radius);\n\t\n\t\t\t\t_behaviour2['default'].addForce(force, pursue, _this.weight);\n\t\t\t});\n\t\t}\n\t\n\t\treturn Pursue;\n\t})(_behaviour2['default']);\n\t\n\texports['default'] = Pursue;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 107 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _get = __webpack_require__(7)['default'];\n\t\n\tvar _inherits = __webpack_require__(21)['default'];\n\t\n\tvar _classCallCheck = __webpack_require__(35)['default'];\n\t\n\tvar _interopRequireDefault = __webpack_require__(1)['default'];\n\t\n\tObject.defineProperty(exports, '__esModule', {\n\t\tvalue: true\n\t});\n\texports.flee = flee;\n\t\n\tvar _behaviour = __webpack_require__(103);\n\t\n\tvar _behaviour2 = _interopRequireDefault(_behaviour);\n\t\n\tvar _glMatrixVec3 = __webpack_require__(99);\n\t\n\tvar _glMatrixVec32 = _interopRequireDefault(_glMatrixVec3);\n\t\n\tvar Flee = (function (_Behaviour) {\n\t\t_inherits(Flee, _Behaviour);\n\t\n\t\tfunction Flee(agent, _ref) {\n\t\t\tvar _this = this;\n\t\n\t\t\tvar weight = _ref.weight;\n\t\t\tvar target = _ref.target;\n\t\t\tvar _ref$radius = _ref.radius;\n\t\t\tvar radius = _ref$radius === undefined ? 0 : _ref$radius;\n\t\n\t\t\t_classCallCheck(this, Flee);\n\t\n\t\t\t_get(Object.getPrototypeOf(Flee.prototype), 'constructor', this).call(this, agent, weight);\n\t\n\t\t\tthis.target = target;\n\t\t\tthis.radius = radius;\n\t\n\t\t\tagent.on('steer').then(function (force) {\n\t\t\t\tvar delta = flee(agent, _this.target, _this.radius);\n\t\n\t\t\t\t_behaviour2['default'].addForce(force, delta, _this.weight);\n\t\t\t});\n\t\t}\n\t\n\t\treturn Flee;\n\t})(_behaviour2['default']);\n\t\n\texports['default'] = Flee;\n\t\n\tfunction flee(agent, target, radius) {\n\t\tvar flee = _glMatrixVec32['default'].sub([], target.position, agent.position);\n\t\tvar distance = _glMatrixVec32['default'].length(flee);\n\t\n\t\t_glMatrixVec32['default'].normalize(flee, flee);\n\t\t_glMatrixVec32['default'].scale(flee, flee, -agent.speed);\n\t\n\t\tif (distance < radius) {\n\t\t\t_glMatrixVec32['default'].scale(flee, flee, distance / radius);\n\t\t}\n\t\n\t\t_glMatrixVec32['default'].sub(flee, flee, agent.velocity);\n\t\n\t\t_glMatrixVec32['default'].normalize(flee, flee);\n\t\n\t\treturn flee;\n\t}\n\n/***/ },\n/* 108 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _interopRequireDefault = __webpack_require__(1)['default'];\n\t\n\tObject.defineProperty(exports, '__esModule', {\n\t\tvalue: true\n\t});\n\t\n\tvar _agent = __webpack_require__(96);\n\t\n\tvar _agent2 = _interopRequireDefault(_agent);\n\t\n\tvar _steeringBehavioursWander = __webpack_require__(102);\n\t\n\tvar _steeringBehavioursWander2 = _interopRequireDefault(_steeringBehavioursWander);\n\t\n\tvar _steeringBehavioursAlign = __webpack_require__(109);\n\t\n\tvar _steeringBehavioursAlign2 = _interopRequireDefault(_steeringBehavioursAlign);\n\t\n\tvar _steeringBehavioursCohere = __webpack_require__(110);\n\t\n\tvar _steeringBehavioursCohere2 = _interopRequireDefault(_steeringBehavioursCohere);\n\t\n\tvar _steeringBehavioursSeparate = __webpack_require__(111);\n\t\n\tvar _steeringBehavioursSeparate2 = _interopRequireDefault(_steeringBehavioursSeparate);\n\t\n\texports['default'] = function () {\n\t\tvar agents = [];\n\t\tvar steerings = [];\n\t\n\t\tfor (var i = 0; i < 150; i++) {\n\t\t\tvar agent = new _agent2['default']();\n\t\t\tagents.push(agent);\n\t\n\t\t\tsteerings.push(agent.steering);\n\t\n\t\t\tagent.steering.speed = Math.random() + 4;\n\t\t\tagent.steering.wander = new _steeringBehavioursWander2['default'](agent.steering, { weight: 20 });\n\t\t\tagent.steering.align = new _steeringBehavioursAlign2['default'](agent.steering, { weight: 10, agents: steerings, radius: 15 });\n\t\t\tagent.steering.cohere = new _steeringBehavioursCohere2['default'](agent.steering, { weight: 5, agents: steerings, radius: 9 });\n\t\t\tagent.steering.separate = new _steeringBehavioursSeparate2['default'](agent.steering, { weight: 15, agents: steerings, radius: 3 });\n\t\t}\n\t\n\t\treturn agents;\n\t};\n\t\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 109 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _get = __webpack_require__(7)['default'];\n\t\n\tvar _inherits = __webpack_require__(21)['default'];\n\t\n\tvar _classCallCheck = __webpack_require__(35)['default'];\n\t\n\tvar _interopRequireDefault = __webpack_require__(1)['default'];\n\t\n\tObject.defineProperty(exports, '__esModule', {\n\t\tvalue: true\n\t});\n\t\n\tvar _behaviour = __webpack_require__(103);\n\t\n\tvar _behaviour2 = _interopRequireDefault(_behaviour);\n\t\n\tvar _glMatrixVec3 = __webpack_require__(99);\n\t\n\tvar _glMatrixVec32 = _interopRequireDefault(_glMatrixVec3);\n\t\n\tvar Align = (function (_Behaviour) {\n\t\t_inherits(Align, _Behaviour);\n\t\n\t\tfunction Align(agent, _ref) {\n\t\t\tvar _this = this;\n\t\n\t\t\tvar weight = _ref.weight;\n\t\t\tvar agents = _ref.agents;\n\t\t\tvar _ref$radius = _ref.radius;\n\t\t\tvar radius = _ref$radius === undefined ? 0 : _ref$radius;\n\t\n\t\t\t_classCallCheck(this, Align);\n\t\n\t\t\t_get(Object.getPrototypeOf(Align.prototype), 'constructor', this).call(this, agent, weight);\n\t\n\t\t\tthis.agents = agents;\n\t\t\tthis.radius = radius;\n\t\n\t\t\tagent.on('steer').then(function (force) {\n\t\t\t\tvar agents = _behaviour2['default'].neighborhoodDistance(agent, _this.agents, _this.radius);\n\t\n\t\t\t\tif (!agents.length) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\n\t\t\t\tvar delta = agents.reduce(function (average, agent) {\n\t\t\t\t\treturn _glMatrixVec32['default'].add(average, average, agent.agent.velocity);\n\t\t\t\t}, _glMatrixVec32['default'].create());\n\t\n\t\t\t\t_glMatrixVec32['default'].normalize(delta, delta);\n\t\n\t\t\t\t_behaviour2['default'].addForce(force, delta, _this.weight);\n\t\t\t});\n\t\t}\n\t\n\t\treturn Align;\n\t})(_behaviour2['default']);\n\t\n\texports['default'] = Align;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 110 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _get = __webpack_require__(7)['default'];\n\t\n\tvar _inherits = __webpack_require__(21)['default'];\n\t\n\tvar _classCallCheck = __webpack_require__(35)['default'];\n\t\n\tvar _interopRequireDefault = __webpack_require__(1)['default'];\n\t\n\tObject.defineProperty(exports, '__esModule', {\n\t\tvalue: true\n\t});\n\t\n\tvar _behaviour = __webpack_require__(103);\n\t\n\tvar _behaviour2 = _interopRequireDefault(_behaviour);\n\t\n\tvar _glMatrixVec3 = __webpack_require__(99);\n\t\n\tvar _glMatrixVec32 = _interopRequireDefault(_glMatrixVec3);\n\t\n\tvar Cohere = (function (_Behaviour) {\n\t\t_inherits(Cohere, _Behaviour);\n\t\n\t\tfunction Cohere(agent, _ref) {\n\t\t\tvar _this = this;\n\t\n\t\t\tvar weight = _ref.weight;\n\t\t\tvar agents = _ref.agents;\n\t\t\tvar _ref$radius = _ref.radius;\n\t\t\tvar radius = _ref$radius === undefined ? 0 : _ref$radius;\n\t\n\t\t\t_classCallCheck(this, Cohere);\n\t\n\t\t\t_get(Object.getPrototypeOf(Cohere.prototype), 'constructor', this).call(this, agent, weight);\n\t\n\t\t\tthis.agents = agents;\n\t\t\tthis.radius = radius;\n\t\n\t\t\tagent.on('steer').then(function (force) {\n\t\t\t\tvar agents = _behaviour2['default'].neighborhoodDistance(agent, _this.agents, _this.radius);\n\t\n\t\t\t\tif (!agents.length) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\n\t\t\t\tvar position = agents.reduce(function (position, agent) {\n\t\t\t\t\treturn _glMatrixVec32['default'].add(position, position, agent.agent.position);\n\t\t\t\t}, _glMatrixVec32['default'].create());\n\t\n\t\t\t\t_glMatrixVec32['default'].scale(position, position, 1 / agents.length);\n\t\t\t\t_glMatrixVec32['default'].sub(position, position, agent.position);\n\t\n\t\t\t\t_glMatrixVec32['default'].normalize(position, position);\n\t\n\t\t\t\t_behaviour2['default'].addForce(force, position, _this.weight);\n\t\t\t});\n\t\t}\n\t\n\t\treturn Cohere;\n\t})(_behaviour2['default']);\n\t\n\texports['default'] = Cohere;\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 111 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _get = __webpack_require__(7)['default'];\n\t\n\tvar _inherits = __webpack_require__(21)['default'];\n\t\n\tvar _classCallCheck = __webpack_require__(35)['default'];\n\t\n\tvar _interopRequireDefault = __webpack_require__(1)['default'];\n\t\n\tObject.defineProperty(exports, '__esModule', {\n\t\tvalue: true\n\t});\n\t\n\tvar _behaviour = __webpack_require__(103);\n\t\n\tvar _behaviour2 = _interopRequireDefault(_behaviour);\n\t\n\tvar _glMatrixVec3 = __webpack_require__(99);\n\t\n\tvar _glMatrixVec32 = _interopRequireDefault(_glMatrixVec3);\n\t\n\tvar Cohere = (function (_Behaviour) {\n\t\t_inherits(Cohere, _Behaviour);\n\t\n\t\tfunction Cohere(agent, _ref) {\n\t\t\tvar _this = this;\n\t\n\t\t\tvar weight = _ref.weight;\n\t\t\tvar agents = _ref.agents;\n\t\t\tvar _ref$radius = _ref.radius;\n\t\t\tvar radius = _ref$radius === undefined ? 0 : _ref$radius;\n\t\n\t\t\t_classCallCheck(this, Cohere);\n\t\n\t\t\t_get(Object.getPrototypeOf(Cohere.prototype), 'constructor', this).call(this, agent, weight);\n\t\n\t\t\tthis.agents = agents;\n\t\t\tthis.radius = radius;\n\t\n\t\t\tagent.on('steer').then(function (force) {\n\t\t\t\tvar agents = _behaviour2['default'].neighborhoodDistance(agent, _this.agents, _this.radius);\n\t\n\t\t\t\tif (!agents.length) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\n\t\t\t\tvar position = agents.reduce(function (position, agent) {\n\t\t\t\t\treturn _glMatrixVec32['default'].add(position, position, agent.agent.position);\n\t\t\t\t}, _glMatrixVec32['default'].create());\n\t\n\t\t\t\t_glMatrixVec32['default'].scale(position, position, 1 / agents.length);\n\t\t\t\t_glMatrixVec32['default'].sub(position, position, agent.position);\n\t\t\t\t_glMatrixVec32['default'].scale(position, position, -1);\n\t\n\t\t\t\t_glMatrixVec32['default'].normalize(position, position);\n\t\n\t\t\t\t_behaviour2['default'].addForce(force, position, _this.weight);\n\t\t\t});\n\t\t}\n\t\n\t\treturn Cohere;\n\t})(_behaviour2['default']);\n\t\n\texports['default'] = Cohere;\n\tmodule.exports = exports['default'];\n\n/***/ }\n/******/ ]);\n\n\n/** WEBPACK FOOTER **\n ** app.bundle.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap c5b93f66f92ee1eecb4b\n **/","import Bootstrap from 'hedra/bootstrap';\r\nimport App from './app';\r\n\r\nexport default Bootstrap(App);\r\n\n\n\n/** WEBPACK FOOTER **\n ** c:/data/Projects/Steering/src/bootstrap.js\n **/","\"use strict\";\n\nexports[\"default\"] = function (obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n};\n\nexports.__esModule = true;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/helpers/interop-require-default.js\n ** module id = 1\n ** module chunks = 0\n **/","import debug from 'debug';\r\nwindow.debug = debug;\r\n\r\nexport default function(App) {\r\n\twindow.onload = function() {\r\n\t\tApp.load().then(() => {\r\n\t\t\twindow.app = new App({ parent: document.body });\r\n\t\t});\r\n\t};\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** c:/data/Projects/Steering/~/hedra/bootstrap.jsx\n **/","\n/**\n * This is the web browser implementation of `debug()`.\n *\n * Expose `debug()` as the module.\n */\n\nexports = module.exports = require('./debug');\nexports.log = log;\nexports.formatArgs = formatArgs;\nexports.save = save;\nexports.load = load;\nexports.useColors = useColors;\nexports.storage = 'undefined' != typeof chrome\n               && 'undefined' != typeof chrome.storage\n                  ? chrome.storage.local\n                  : localstorage();\n\n/**\n * Colors.\n */\n\nexports.colors = [\n  'lightseagreen',\n  'forestgreen',\n  'goldenrod',\n  'dodgerblue',\n  'darkorchid',\n  'crimson'\n];\n\n/**\n * Currently only WebKit-based Web Inspectors, Firefox >= v31,\n * and the Firebug extension (any Firefox version) are known\n * to support \"%c\" CSS customizations.\n *\n * TODO: add a `localStorage` variable to explicitly enable/disable colors\n */\n\nfunction useColors() {\n  // is webkit? http://stackoverflow.com/a/16459606/376773\n  return ('WebkitAppearance' in document.documentElement.style) ||\n    // is firebug? http://stackoverflow.com/a/398120/376773\n    (window.console && (console.firebug || (console.exception && console.table))) ||\n    // is firefox >= v31?\n    // https://developer.mozilla.org/en-US/docs/Tools/Web_Console#Styling_messages\n    (navigator.userAgent.toLowerCase().match(/firefox\\/(\\d+)/) && parseInt(RegExp.$1, 10) >= 31);\n}\n\n/**\n * Map %j to `JSON.stringify()`, since no Web Inspectors do that by default.\n */\n\nexports.formatters.j = function(v) {\n  return JSON.stringify(v);\n};\n\n\n/**\n * Colorize log arguments if enabled.\n *\n * @api public\n */\n\nfunction formatArgs() {\n  var args = arguments;\n  var useColors = this.useColors;\n\n  args[0] = (useColors ? '%c' : '')\n    + this.namespace\n    + (useColors ? ' %c' : ' ')\n    + args[0]\n    + (useColors ? '%c ' : ' ')\n    + '+' + exports.humanize(this.diff);\n\n  if (!useColors) return args;\n\n  var c = 'color: ' + this.color;\n  args = [args[0], c, 'color: inherit'].concat(Array.prototype.slice.call(args, 1));\n\n  // the final \"%c\" is somewhat tricky, because there could be other\n  // arguments passed either before or after the %c, so we need to\n  // figure out the correct index to insert the CSS into\n  var index = 0;\n  var lastC = 0;\n  args[0].replace(/%[a-z%]/g, function(match) {\n    if ('%%' === match) return;\n    index++;\n    if ('%c' === match) {\n      // we only are interested in the *last* %c\n      // (the user may have provided their own)\n      lastC = index;\n    }\n  });\n\n  args.splice(lastC, 0, c);\n  return args;\n}\n\n/**\n * Invokes `console.log()` when available.\n * No-op when `console.log` is not a \"function\".\n *\n * @api public\n */\n\nfunction log() {\n  // this hackery is required for IE8/9, where\n  // the `console.log` function doesn't have 'apply'\n  return 'object' === typeof console\n    && console.log\n    && Function.prototype.apply.call(console.log, console, arguments);\n}\n\n/**\n * Save `namespaces`.\n *\n * @param {String} namespaces\n * @api private\n */\n\nfunction save(namespaces) {\n  try {\n    if (null == namespaces) {\n      exports.storage.removeItem('debug');\n    } else {\n      exports.storage.debug = namespaces;\n    }\n  } catch(e) {}\n}\n\n/**\n * Load `namespaces`.\n *\n * @return {String} returns the previously persisted debug modes\n * @api private\n */\n\nfunction load() {\n  var r;\n  try {\n    r = exports.storage.debug;\n  } catch(e) {}\n  return r;\n}\n\n/**\n * Enable namespaces listed in `localStorage.debug` initially.\n */\n\nexports.enable(load());\n\n/**\n * Localstorage attempts to return the localstorage.\n *\n * This is necessary because safari throws\n * when a user disables cookies/localstorage\n * and you attempt to access it.\n *\n * @return {LocalStorage}\n * @api private\n */\n\nfunction localstorage(){\n  try {\n    return window.localStorage;\n  } catch (e) {}\n}\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/debug/browser.js\n ** module id = 3\n ** module chunks = 0\n **/","\n/**\n * This is the common logic for both the Node.js and web browser\n * implementations of `debug()`.\n *\n * Expose `debug()` as the module.\n */\n\nexports = module.exports = debug;\nexports.coerce = coerce;\nexports.disable = disable;\nexports.enable = enable;\nexports.enabled = enabled;\nexports.humanize = require('ms');\n\n/**\n * The currently active debug mode names, and names to skip.\n */\n\nexports.names = [];\nexports.skips = [];\n\n/**\n * Map of special \"%n\" handling functions, for the debug \"format\" argument.\n *\n * Valid key names are a single, lowercased letter, i.e. \"n\".\n */\n\nexports.formatters = {};\n\n/**\n * Previously assigned color.\n */\n\nvar prevColor = 0;\n\n/**\n * Previous log timestamp.\n */\n\nvar prevTime;\n\n/**\n * Select a color.\n *\n * @return {Number}\n * @api private\n */\n\nfunction selectColor() {\n  return exports.colors[prevColor++ % exports.colors.length];\n}\n\n/**\n * Create a debugger with the given `namespace`.\n *\n * @param {String} namespace\n * @return {Function}\n * @api public\n */\n\nfunction debug(namespace) {\n\n  // define the `disabled` version\n  function disabled() {\n  }\n  disabled.enabled = false;\n\n  // define the `enabled` version\n  function enabled() {\n\n    var self = enabled;\n\n    // set `diff` timestamp\n    var curr = +new Date();\n    var ms = curr - (prevTime || curr);\n    self.diff = ms;\n    self.prev = prevTime;\n    self.curr = curr;\n    prevTime = curr;\n\n    // add the `color` if not set\n    if (null == self.useColors) self.useColors = exports.useColors();\n    if (null == self.color && self.useColors) self.color = selectColor();\n\n    var args = Array.prototype.slice.call(arguments);\n\n    args[0] = exports.coerce(args[0]);\n\n    if ('string' !== typeof args[0]) {\n      // anything else let's inspect with %o\n      args = ['%o'].concat(args);\n    }\n\n    // apply any `formatters` transformations\n    var index = 0;\n    args[0] = args[0].replace(/%([a-z%])/g, function(match, format) {\n      // if we encounter an escaped % then don't increase the array index\n      if (match === '%%') return match;\n      index++;\n      var formatter = exports.formatters[format];\n      if ('function' === typeof formatter) {\n        var val = args[index];\n        match = formatter.call(self, val);\n\n        // now we need to remove `args[index]` since it's inlined in the `format`\n        args.splice(index, 1);\n        index--;\n      }\n      return match;\n    });\n\n    if ('function' === typeof exports.formatArgs) {\n      args = exports.formatArgs.apply(self, args);\n    }\n    var logFn = enabled.log || exports.log || console.log.bind(console);\n    logFn.apply(self, args);\n  }\n  enabled.enabled = true;\n\n  var fn = exports.enabled(namespace) ? enabled : disabled;\n\n  fn.namespace = namespace;\n\n  return fn;\n}\n\n/**\n * Enables a debug mode by namespaces. This can include modes\n * separated by a colon and wildcards.\n *\n * @param {String} namespaces\n * @api public\n */\n\nfunction enable(namespaces) {\n  exports.save(namespaces);\n\n  var split = (namespaces || '').split(/[\\s,]+/);\n  var len = split.length;\n\n  for (var i = 0; i < len; i++) {\n    if (!split[i]) continue; // ignore empty strings\n    namespaces = split[i].replace(/\\*/g, '.*?');\n    if (namespaces[0] === '-') {\n      exports.skips.push(new RegExp('^' + namespaces.substr(1) + '$'));\n    } else {\n      exports.names.push(new RegExp('^' + namespaces + '$'));\n    }\n  }\n}\n\n/**\n * Disable debug output.\n *\n * @api public\n */\n\nfunction disable() {\n  exports.enable('');\n}\n\n/**\n * Returns true if the given mode name is enabled, false otherwise.\n *\n * @param {String} name\n * @return {Boolean}\n * @api public\n */\n\nfunction enabled(name) {\n  var i, len;\n  for (i = 0, len = exports.skips.length; i < len; i++) {\n    if (exports.skips[i].test(name)) {\n      return false;\n    }\n  }\n  for (i = 0, len = exports.names.length; i < len; i++) {\n    if (exports.names[i].test(name)) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Coerce `val`.\n *\n * @param {Mixed} val\n * @return {Mixed}\n * @api private\n */\n\nfunction coerce(val) {\n  if (val instanceof Error) return val.stack || val.message;\n  return val;\n}\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/debug/debug.js\n ** module id = 4\n ** module chunks = 0\n **/","/**\n * Helpers.\n */\n\nvar s = 1000;\nvar m = s * 60;\nvar h = m * 60;\nvar d = h * 24;\nvar y = d * 365.25;\n\n/**\n * Parse or format the given `val`.\n *\n * Options:\n *\n *  - `long` verbose formatting [false]\n *\n * @param {String|Number} val\n * @param {Object} options\n * @return {String|Number}\n * @api public\n */\n\nmodule.exports = function(val, options){\n  options = options || {};\n  if ('string' == typeof val) return parse(val);\n  return options.long\n    ? long(val)\n    : short(val);\n};\n\n/**\n * Parse the given `str` and return milliseconds.\n *\n * @param {String} str\n * @return {Number}\n * @api private\n */\n\nfunction parse(str) {\n  str = '' + str;\n  if (str.length > 10000) return;\n  var match = /^((?:\\d+)?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(str);\n  if (!match) return;\n  var n = parseFloat(match[1]);\n  var type = (match[2] || 'ms').toLowerCase();\n  switch (type) {\n    case 'years':\n    case 'year':\n    case 'yrs':\n    case 'yr':\n    case 'y':\n      return n * y;\n    case 'days':\n    case 'day':\n    case 'd':\n      return n * d;\n    case 'hours':\n    case 'hour':\n    case 'hrs':\n    case 'hr':\n    case 'h':\n      return n * h;\n    case 'minutes':\n    case 'minute':\n    case 'mins':\n    case 'min':\n    case 'm':\n      return n * m;\n    case 'seconds':\n    case 'second':\n    case 'secs':\n    case 'sec':\n    case 's':\n      return n * s;\n    case 'milliseconds':\n    case 'millisecond':\n    case 'msecs':\n    case 'msec':\n    case 'ms':\n      return n;\n  }\n}\n\n/**\n * Short format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction short(ms) {\n  if (ms >= d) return Math.round(ms / d) + 'd';\n  if (ms >= h) return Math.round(ms / h) + 'h';\n  if (ms >= m) return Math.round(ms / m) + 'm';\n  if (ms >= s) return Math.round(ms / s) + 's';\n  return ms + 'ms';\n}\n\n/**\n * Long format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction long(ms) {\n  return plural(ms, d, 'day')\n    || plural(ms, h, 'hour')\n    || plural(ms, m, 'minute')\n    || plural(ms, s, 'second')\n    || ms + ' ms';\n}\n\n/**\n * Pluralization helper.\n */\n\nfunction plural(ms, n, name) {\n  if (ms < n) return;\n  if (ms < n * 1.5) return Math.floor(ms / n) + ' ' + name;\n  return Math.ceil(ms / n) + ' ' + name + 's';\n}\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/debug/~/ms/index.js\n ** module id = 5\n ** module chunks = 0\n **/","import Debug from 'debug';\r\nlet debug = Debug('app');\r\n\r\nimport BaseApp from 'hedra/app';\r\nimport Resize from 'hedra/plugins/resize';\r\n\r\nimport { fromDisc, fromCircle } from './lib/random';\r\n\r\nimport Agent from './agent';\r\nimport hunt from './hunt';\r\nimport swarm from './swarm';\r\n\r\nexport default class App extends BaseApp {\r\n\tstatic load() {\r\n\t\treturn Promise.all([\r\n\t\t\tAgent.load(),\r\n\t\t]);\r\n\t}\r\n\t\r\n\tconstructor(config) {\r\n\t\tdebug('construct');\r\n\t\t\r\n\t\tsuper(config);\r\n\t\t\r\n\t\tResize(this, { ratio: 16 / 9 });\r\n\t\t\r\n\t\tthis.camera.position.set(0, 0, 150);\r\n\t\tthis.camera.lookAt(this.scene.position);\r\n\t\t\r\n\t\tlet width;\r\n\t\tlet height;\r\n\t\t\r\n\t\tthis.on('resize-post').then((event) => {\r\n\t\t\twidth  = 150 * Math.tan(event.fovx / 2 * Math.PI / 180) * 2;\r\n\t\t\theight = 150 * Math.tan(event.fovy / 2 * Math.PI / 180) * 2;\r\n\t\t});\r\n\t\t\r\n\t\tfor (let agent of swarm()) {\r\n\t\t\tthis.add(agent);\r\n\t\t\t\r\n\t\t\tagent.steering.position = [ ...fromDisc(50), 0 ];\r\n\t\t\tagent.steering.velocity = [ ...fromCircle(1), 0 ];\r\n\t\t\t\r\n\t\t\tagent.on('update').then(() => {\r\n\t\t\t\twhile (agent.position.x > width / 2) {\r\n\t\t\t\t\tagent.position.x -= width;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\twhile (agent.position.x < -width / 2) {\r\n\t\t\t\t\tagent.position.x += width;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\twhile (agent.position.y > height / 2) {\r\n\t\t\t\t\tagent.position.y -= height;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\twhile (agent.position.y < -height / 2) {\r\n\t\t\t\t\tagent.position.y += height;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tagent.steering.position = agent.position.toArray();\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** c:/data/Projects/Steering/src/app.js\n **/","\"use strict\";\n\nvar _Object$getOwnPropertyDescriptor = require(\"babel-runtime/core-js/object/get-own-property-descriptor\")[\"default\"];\n\nexports[\"default\"] = function get(_x, _x2, _x3) {\n  var _again = true;\n\n  _function: while (_again) {\n    var object = _x,\n        property = _x2,\n        receiver = _x3;\n    desc = parent = getter = undefined;\n    _again = false;\n    if (object === null) object = Function.prototype;\n\n    var desc = _Object$getOwnPropertyDescriptor(object, property);\n\n    if (desc === undefined) {\n      var parent = Object.getPrototypeOf(object);\n\n      if (parent === null) {\n        return undefined;\n      } else {\n        _x = parent;\n        _x2 = property;\n        _x3 = receiver;\n        _again = true;\n        continue _function;\n      }\n    } else if (\"value\" in desc) {\n      return desc.value;\n    } else {\n      var getter = desc.get;\n\n      if (getter === undefined) {\n        return undefined;\n      }\n\n      return getter.call(receiver);\n    }\n  }\n};\n\nexports.__esModule = true;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/helpers/get.js\n ** module id = 7\n ** module chunks = 0\n **/","module.exports = { \"default\": require(\"core-js/library/fn/object/get-own-property-descriptor\"), __esModule: true };\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/core-js/object/get-own-property-descriptor.js\n ** module id = 8\n ** module chunks = 0\n **/","var $ = require('../../modules/$');\nrequire('../../modules/es6.object.get-own-property-descriptor');\nmodule.exports = function getOwnPropertyDescriptor(it, key){\n  return $.getDesc(it, key);\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/fn/object/get-own-property-descriptor.js\n ** module id = 9\n ** module chunks = 0\n **/","var $Object = Object;\nmodule.exports = {\n  create:     $Object.create,\n  getProto:   $Object.getPrototypeOf,\n  isEnum:     {}.propertyIsEnumerable,\n  getDesc:    $Object.getOwnPropertyDescriptor,\n  setDesc:    $Object.defineProperty,\n  setDescs:   $Object.defineProperties,\n  getKeys:    $Object.keys,\n  getNames:   $Object.getOwnPropertyNames,\n  getSymbols: $Object.getOwnPropertySymbols,\n  each:       [].forEach\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.js\n ** module id = 10\n ** module chunks = 0\n **/","// 19.1.2.6 Object.getOwnPropertyDescriptor(O, P)\nvar toIObject = require('./$.to-iobject');\n\nrequire('./$.object-sap')('getOwnPropertyDescriptor', function($getOwnPropertyDescriptor){\n  return function getOwnPropertyDescriptor(it, key){\n    return $getOwnPropertyDescriptor(toIObject(it), key);\n  };\n});\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/es6.object.get-own-property-descriptor.js\n ** module id = 11\n ** module chunks = 0\n **/","// to indexed object, toObject with fallback for non-array-like ES3 strings\r\nvar IObject = require('./$.iobject')\r\n  , defined = require('./$.defined');\r\nmodule.exports = function(it){\r\n  return IObject(defined(it));\r\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.to-iobject.js\n ** module id = 12\n ** module chunks = 0\n **/","// indexed object, fallback for non-array-like ES3 strings\nvar cof = require('./$.cof');\nmodule.exports = 0 in Object('z') ? Object : function(it){\n  return cof(it) == 'String' ? it.split('') : Object(it);\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.iobject.js\n ** module id = 13\n ** module chunks = 0\n **/","var toString = {}.toString;\n\nmodule.exports = function(it){\n  return toString.call(it).slice(8, -1);\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.cof.js\n ** module id = 14\n ** module chunks = 0\n **/","// 7.2.1 RequireObjectCoercible(argument)\nmodule.exports = function(it){\n  if(it == undefined)throw TypeError(\"Can't call method on  \" + it);\n  return it;\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.defined.js\n ** module id = 15\n ** module chunks = 0\n **/","// most Object methods by ES6 should accept primitives\nmodule.exports = function(KEY, exec){\n  var $def = require('./$.def')\n    , fn   = (require('./$.core').Object || {})[KEY] || Object[KEY]\n    , exp  = {};\n  exp[KEY] = exec(fn);\n  $def($def.S + $def.F * require('./$.fails')(function(){ fn(1); }), 'Object', exp);\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.object-sap.js\n ** module id = 16\n ** module chunks = 0\n **/","var global    = require('./$.global')\n  , core      = require('./$.core')\n  , PROTOTYPE = 'prototype';\nvar ctx = function(fn, that){\n  return function(){\n    return fn.apply(that, arguments);\n  };\n};\nvar $def = function(type, name, source){\n  var key, own, out, exp\n    , isGlobal = type & $def.G\n    , isProto  = type & $def.P\n    , target   = isGlobal ? global : type & $def.S\n        ? global[name] : (global[name] || {})[PROTOTYPE]\n    , exports  = isGlobal ? core : core[name] || (core[name] = {});\n  if(isGlobal)source = name;\n  for(key in source){\n    // contains in native\n    own = !(type & $def.F) && target && key in target;\n    if(own && key in exports)continue;\n    // export native or passed\n    out = own ? target[key] : source[key];\n    // prevent global pollution for namespaces\n    if(isGlobal && typeof target[key] != 'function')exp = source[key];\n    // bind timers to global for call from export context\n    else if(type & $def.B && own)exp = ctx(out, global);\n    // wrap global constructors for prevent change them in library\n    else if(type & $def.W && target[key] == out)!function(C){\n      exp = function(param){\n        return this instanceof C ? new C(param) : C(param);\n      };\n      exp[PROTOTYPE] = C[PROTOTYPE];\n    }(out);\n    else exp = isProto && typeof out == 'function' ? ctx(Function.call, out) : out;\n    // export\n    exports[key] = exp;\n    if(isProto)(exports[PROTOTYPE] || (exports[PROTOTYPE] = {}))[key] = out;\n  }\n};\n// type bitmap\n$def.F = 1;  // forced\n$def.G = 2;  // global\n$def.S = 4;  // static\n$def.P = 8;  // proto\n$def.B = 16; // bind\n$def.W = 32; // wrap\nmodule.exports = $def;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.def.js\n ** module id = 17\n ** module chunks = 0\n **/","// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nvar UNDEFINED = 'undefined';\nvar global = module.exports = typeof window != UNDEFINED && window.Math == Math\n  ? window : typeof self != UNDEFINED && self.Math == Math ? self : Function('return this')();\nif(typeof __g == 'number')__g = global; // eslint-disable-line no-undef\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.global.js\n ** module id = 18\n ** module chunks = 0\n **/","var core = module.exports = {version: '1.2.1'};\nif(typeof __e == 'number')__e = core; // eslint-disable-line no-undef\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.core.js\n ** module id = 19\n ** module chunks = 0\n **/","module.exports = function(exec){\n  try {\n    return !!exec();\n  } catch(e){\n    return true;\n  }\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.fails.js\n ** module id = 20\n ** module chunks = 0\n **/","\"use strict\";\n\nvar _Object$create = require(\"babel-runtime/core-js/object/create\")[\"default\"];\n\nvar _Object$setPrototypeOf = require(\"babel-runtime/core-js/object/set-prototype-of\")[\"default\"];\n\nexports[\"default\"] = function (subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = _Object$create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _Object$setPrototypeOf ? _Object$setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n};\n\nexports.__esModule = true;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/helpers/inherits.js\n ** module id = 21\n ** module chunks = 0\n **/","module.exports = { \"default\": require(\"core-js/library/fn/object/create\"), __esModule: true };\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/core-js/object/create.js\n ** module id = 22\n ** module chunks = 0\n **/","var $ = require('../../modules/$');\nmodule.exports = function create(P, D){\n  return $.create(P, D);\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/fn/object/create.js\n ** module id = 23\n ** module chunks = 0\n **/","module.exports = { \"default\": require(\"core-js/library/fn/object/set-prototype-of\"), __esModule: true };\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/core-js/object/set-prototype-of.js\n ** module id = 24\n ** module chunks = 0\n **/","require('../../modules/es6.object.set-prototype-of');\nmodule.exports = require('../../modules/$.core').Object.setPrototypeOf;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/fn/object/set-prototype-of.js\n ** module id = 25\n ** module chunks = 0\n **/","// 19.1.3.19 Object.setPrototypeOf(O, proto)\nvar $def = require('./$.def');\n$def($def.S, 'Object', {setPrototypeOf: require('./$.set-proto').set});\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/es6.object.set-prototype-of.js\n ** module id = 26\n ** module chunks = 0\n **/","// Works with __proto__ only. Old v8 can't work with null proto objects.\n/* eslint-disable no-proto */\nvar getDesc  = require('./$').getDesc\n  , isObject = require('./$.is-object')\n  , anObject = require('./$.an-object');\nvar check = function(O, proto){\n  anObject(O);\n  if(!isObject(proto) && proto !== null)throw TypeError(proto + \": can't set as prototype!\");\n};\nmodule.exports = {\n  set: Object.setPrototypeOf || ('__proto__' in {} ? // eslint-disable-line no-proto\n    function(test, buggy, set){\n      try {\n        set = require('./$.ctx')(Function.call, getDesc(Object.prototype, '__proto__').set, 2);\n        set(test, []);\n        buggy = !(test instanceof Array);\n      } catch(e){ buggy = true; }\n      return function setPrototypeOf(O, proto){\n        check(O, proto);\n        if(buggy)O.__proto__ = proto;\n        else set(O, proto);\n        return O;\n      };\n    }({}, false) : undefined),\n  check: check\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.set-proto.js\n ** module id = 27\n ** module chunks = 0\n **/","module.exports = function(it){\n  return typeof it === 'object' ? it !== null : typeof it === 'function';\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.is-object.js\n ** module id = 28\n ** module chunks = 0\n **/","var isObject = require('./$.is-object');\nmodule.exports = function(it){\n  if(!isObject(it))throw TypeError(it + ' is not an object!');\n  return it;\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.an-object.js\n ** module id = 29\n ** module chunks = 0\n **/","// optional / simple context binding\nvar aFunction = require('./$.a-function');\nmodule.exports = function(fn, that, length){\n  aFunction(fn);\n  if(that === undefined)return fn;\n  switch(length){\n    case 1: return function(a){\n      return fn.call(that, a);\n    };\n    case 2: return function(a, b){\n      return fn.call(that, a, b);\n    };\n    case 3: return function(a, b, c){\n      return fn.call(that, a, b, c);\n    };\n  }\n  return function(/* ...args */){\n    return fn.apply(that, arguments);\n  };\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.ctx.js\n ** module id = 30\n ** module chunks = 0\n **/","module.exports = function(it){\n  if(typeof it != 'function')throw TypeError(it + ' is not a function!');\n  return it;\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.a-function.js\n ** module id = 31\n ** module chunks = 0\n **/","\"use strict\";\n\nvar _Object$defineProperty = require(\"babel-runtime/core-js/object/define-property\")[\"default\"];\n\nexports[\"default\"] = (function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n\n      _Object$defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n})();\n\nexports.__esModule = true;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/helpers/create-class.js\n ** module id = 32\n ** module chunks = 0\n **/","module.exports = { \"default\": require(\"core-js/library/fn/object/define-property\"), __esModule: true };\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/core-js/object/define-property.js\n ** module id = 33\n ** module chunks = 0\n **/","var $ = require('../../modules/$');\nmodule.exports = function defineProperty(it, key, desc){\n  return $.setDesc(it, key, desc);\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/fn/object/define-property.js\n ** module id = 34\n ** module chunks = 0\n **/","\"use strict\";\n\nexports[\"default\"] = function (instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n};\n\nexports.__esModule = true;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/helpers/class-call-check.js\n ** module id = 35\n ** module chunks = 0\n **/","\"use strict\";\n\nvar _Array$from = require(\"babel-runtime/core-js/array/from\")[\"default\"];\n\nexports[\"default\"] = function (arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) arr2[i] = arr[i];\n\n    return arr2;\n  } else {\n    return _Array$from(arr);\n  }\n};\n\nexports.__esModule = true;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/helpers/to-consumable-array.js\n ** module id = 36\n ** module chunks = 0\n **/","module.exports = { \"default\": require(\"core-js/library/fn/array/from\"), __esModule: true };\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/core-js/array/from.js\n ** module id = 37\n ** module chunks = 0\n **/","require('../../modules/es6.string.iterator');\nrequire('../../modules/es6.array.from');\nmodule.exports = require('../../modules/$.core').Array.from;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/fn/array/from.js\n ** module id = 38\n ** module chunks = 0\n **/","'use strict';\nvar $at  = require('./$.string-at')(true);\n\n// 21.1.3.27 String.prototype[@@iterator]()\nrequire('./$.iter-define')(String, 'String', function(iterated){\n  this._t = String(iterated); // target\n  this._i = 0;                // next index\n// 21.1.5.2.1 %StringIteratorPrototype%.next()\n}, function(){\n  var O     = this._t\n    , index = this._i\n    , point;\n  if(index >= O.length)return {value: undefined, done: true};\n  point = $at(O, index);\n  this._i += point.length;\n  return {value: point, done: false};\n});\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/es6.string.iterator.js\n ** module id = 39\n ** module chunks = 0\n **/","// true  -> String#at\n// false -> String#codePointAt\nvar toInteger = require('./$.to-integer')\n  , defined   = require('./$.defined');\nmodule.exports = function(TO_STRING){\n  return function(that, pos){\n    var s = String(defined(that))\n      , i = toInteger(pos)\n      , l = s.length\n      , a, b;\n    if(i < 0 || i >= l)return TO_STRING ? '' : undefined;\n    a = s.charCodeAt(i);\n    return a < 0xd800 || a > 0xdbff || i + 1 === l\n      || (b = s.charCodeAt(i + 1)) < 0xdc00 || b > 0xdfff\n        ? TO_STRING ? s.charAt(i) : a\n        : TO_STRING ? s.slice(i, i + 2) : (a - 0xd800 << 10) + (b - 0xdc00) + 0x10000;\n  };\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.string-at.js\n ** module id = 40\n ** module chunks = 0\n **/","// 7.1.4 ToInteger\nvar ceil  = Math.ceil\n  , floor = Math.floor;\nmodule.exports = function(it){\n  return isNaN(it = +it) ? 0 : (it > 0 ? floor : ceil)(it);\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.to-integer.js\n ** module id = 41\n ** module chunks = 0\n **/","'use strict';\nvar LIBRARY         = require('./$.library')\n  , $def            = require('./$.def')\n  , $redef          = require('./$.redef')\n  , hide            = require('./$.hide')\n  , has             = require('./$.has')\n  , SYMBOL_ITERATOR = require('./$.wks')('iterator')\n  , Iterators       = require('./$.iterators')\n  , BUGGY           = !([].keys && 'next' in [].keys()) // Safari has buggy iterators w/o `next`\n  , FF_ITERATOR     = '@@iterator'\n  , KEYS            = 'keys'\n  , VALUES          = 'values';\nvar returnThis = function(){ return this; };\nmodule.exports = function(Base, NAME, Constructor, next, DEFAULT, IS_SET, FORCE){\n  require('./$.iter-create')(Constructor, NAME, next);\n  var createMethod = function(kind){\n    switch(kind){\n      case KEYS: return function keys(){ return new Constructor(this, kind); };\n      case VALUES: return function values(){ return new Constructor(this, kind); };\n    } return function entries(){ return new Constructor(this, kind); };\n  };\n  var TAG      = NAME + ' Iterator'\n    , proto    = Base.prototype\n    , _native  = proto[SYMBOL_ITERATOR] || proto[FF_ITERATOR] || DEFAULT && proto[DEFAULT]\n    , _default = _native || createMethod(DEFAULT)\n    , methods, key;\n  // Fix native\n  if(_native){\n    var IteratorPrototype = require('./$').getProto(_default.call(new Base));\n    // Set @@toStringTag to native iterators\n    require('./$.tag')(IteratorPrototype, TAG, true);\n    // FF fix\n    if(!LIBRARY && has(proto, FF_ITERATOR))hide(IteratorPrototype, SYMBOL_ITERATOR, returnThis);\n  }\n  // Define iterator\n  if(!LIBRARY || FORCE)hide(proto, SYMBOL_ITERATOR, _default);\n  // Plug for library\n  Iterators[NAME] = _default;\n  Iterators[TAG]  = returnThis;\n  if(DEFAULT){\n    methods = {\n      keys:    IS_SET            ? _default : createMethod(KEYS),\n      values:  DEFAULT == VALUES ? _default : createMethod(VALUES),\n      entries: DEFAULT != VALUES ? _default : createMethod('entries')\n    };\n    if(FORCE)for(key in methods){\n      if(!(key in proto))$redef(proto, key, methods[key]);\n    } else $def($def.P + $def.F * BUGGY, NAME, methods);\n  }\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.iter-define.js\n ** module id = 42\n ** module chunks = 0\n **/","module.exports = true;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.library.js\n ** module id = 43\n ** module chunks = 0\n **/","module.exports = require('./$.hide');\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.redef.js\n ** module id = 44\n ** module chunks = 0\n **/","var $          = require('./$')\n  , createDesc = require('./$.property-desc');\nmodule.exports = require('./$.support-desc') ? function(object, key, value){\n  return $.setDesc(object, key, createDesc(1, value));\n} : function(object, key, value){\n  object[key] = value;\n  return object;\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.hide.js\n ** module id = 45\n ** module chunks = 0\n **/","module.exports = function(bitmap, value){\n  return {\n    enumerable  : !(bitmap & 1),\n    configurable: !(bitmap & 2),\n    writable    : !(bitmap & 4),\n    value       : value\n  };\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.property-desc.js\n ** module id = 46\n ** module chunks = 0\n **/","// Thank's IE8 for his funny defineProperty\nmodule.exports = !require('./$.fails')(function(){\n  return Object.defineProperty({}, 'a', {get: function(){ return 7; }}).a != 7;\n});\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.support-desc.js\n ** module id = 47\n ** module chunks = 0\n **/","var hasOwnProperty = {}.hasOwnProperty;\nmodule.exports = function(it, key){\n  return hasOwnProperty.call(it, key);\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.has.js\n ** module id = 48\n ** module chunks = 0\n **/","var store  = require('./$.shared')('wks')\n  , Symbol = require('./$.global').Symbol;\nmodule.exports = function(name){\n  return store[name] || (store[name] =\n    Symbol && Symbol[name] || (Symbol || require('./$.uid'))('Symbol.' + name));\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.wks.js\n ** module id = 49\n ** module chunks = 0\n **/","var global = require('./$.global')\n  , SHARED = '__core-js_shared__'\n  , store  = global[SHARED] || (global[SHARED] = {});\nmodule.exports = function(key){\n  return store[key] || (store[key] = {});\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.shared.js\n ** module id = 50\n ** module chunks = 0\n **/","var id = 0\n  , px = Math.random();\nmodule.exports = function(key){\n  return 'Symbol('.concat(key === undefined ? '' : key, ')_', (++id + px).toString(36));\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.uid.js\n ** module id = 51\n ** module chunks = 0\n **/","module.exports = {};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.iterators.js\n ** module id = 52\n ** module chunks = 0\n **/","'use strict';\nvar $ = require('./$')\n  , IteratorPrototype = {};\n\n// 25.1.2.1.1 %IteratorPrototype%[@@iterator]()\nrequire('./$.hide')(IteratorPrototype, require('./$.wks')('iterator'), function(){ return this; });\n\nmodule.exports = function(Constructor, NAME, next){\n  Constructor.prototype = $.create(IteratorPrototype, {next: require('./$.property-desc')(1,next)});\n  require('./$.tag')(Constructor, NAME + ' Iterator');\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.iter-create.js\n ** module id = 53\n ** module chunks = 0\n **/","var has  = require('./$.has')\n  , hide = require('./$.hide')\n  , TAG  = require('./$.wks')('toStringTag');\n\nmodule.exports = function(it, tag, stat){\n  if(it && !has(it = stat ? it : it.prototype, TAG))hide(it, TAG, tag);\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.tag.js\n ** module id = 54\n ** module chunks = 0\n **/","'use strict';\nvar ctx         = require('./$.ctx')\n  , $def        = require('./$.def')\n  , toObject    = require('./$.to-object')\n  , call        = require('./$.iter-call')\n  , isArrayIter = require('./$.is-array-iter')\n  , toLength    = require('./$.to-length')\n  , getIterFn   = require('./core.get-iterator-method');\n$def($def.S + $def.F * !require('./$.iter-detect')(function(iter){ Array.from(iter); }), 'Array', {\n  // 22.1.2.1 Array.from(arrayLike, mapfn = undefined, thisArg = undefined)\n  from: function from(arrayLike/*, mapfn = undefined, thisArg = undefined*/){\n    var O       = toObject(arrayLike)\n      , C       = typeof this == 'function' ? this : Array\n      , mapfn   = arguments[1]\n      , mapping = mapfn !== undefined\n      , index   = 0\n      , iterFn  = getIterFn(O)\n      , length, result, step, iterator;\n    if(mapping)mapfn = ctx(mapfn, arguments[2], 2);\n    // if object isn't iterable or it's array with default iterator - use simple case\n    if(iterFn != undefined && !(C == Array && isArrayIter(iterFn))){\n      for(iterator = iterFn.call(O), result = new C; !(step = iterator.next()).done; index++){\n        result[index] = mapping ? call(iterator, mapfn, [step.value, index], true) : step.value;\n      }\n    } else {\n      length = toLength(O.length);\n      for(result = new C(length); length > index; index++){\n        result[index] = mapping ? mapfn(O[index], index) : O[index];\n      }\n    }\n    result.length = index;\n    return result;\n  }\n});\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/es6.array.from.js\n ** module id = 55\n ** module chunks = 0\n **/","// 7.1.13 ToObject(argument)\nvar defined = require('./$.defined');\nmodule.exports = function(it){\n  return Object(defined(it));\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.to-object.js\n ** module id = 56\n ** module chunks = 0\n **/","// call something on iterator step with safe closing on error\nvar anObject = require('./$.an-object');\nmodule.exports = function(iterator, fn, value, entries){\n  try {\n    return entries ? fn(anObject(value)[0], value[1]) : fn(value);\n  // 7.4.6 IteratorClose(iterator, completion)\n  } catch(e){\n    var ret = iterator['return'];\n    if(ret !== undefined)anObject(ret.call(iterator));\n    throw e;\n  }\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.iter-call.js\n ** module id = 57\n ** module chunks = 0\n **/","// check on default Array iterator\nvar Iterators = require('./$.iterators')\n  , ITERATOR  = require('./$.wks')('iterator');\nmodule.exports = function(it){\n  return (Iterators.Array || Array.prototype[ITERATOR]) === it;\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.is-array-iter.js\n ** module id = 58\n ** module chunks = 0\n **/","// 7.1.15 ToLength\nvar toInteger = require('./$.to-integer')\n  , min       = Math.min;\nmodule.exports = function(it){\n  return it > 0 ? min(toInteger(it), 0x1fffffffffffff) : 0; // pow(2, 53) - 1 == 9007199254740991\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.to-length.js\n ** module id = 59\n ** module chunks = 0\n **/","var classof   = require('./$.classof')\n  , ITERATOR  = require('./$.wks')('iterator')\n  , Iterators = require('./$.iterators');\nmodule.exports = require('./$.core').getIteratorMethod = function(it){\n  if(it != undefined)return it[ITERATOR] || it['@@iterator'] || Iterators[classof(it)];\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/core.get-iterator-method.js\n ** module id = 60\n ** module chunks = 0\n **/","// getting tag from 19.1.3.6 Object.prototype.toString()\nvar cof = require('./$.cof')\n  , TAG = require('./$.wks')('toStringTag')\n  // ES3 wrong here\n  , ARG = cof(function(){ return arguments; }()) == 'Arguments';\n\nmodule.exports = function(it){\n  var O, T, B;\n  return it === undefined ? 'Undefined' : it === null ? 'Null'\n    // @@toStringTag case\n    : typeof (T = (O = Object(it))[TAG]) == 'string' ? T\n    // builtinTag case\n    : ARG ? cof(O)\n    // ES3 arguments fallback\n    : (B = cof(O)) == 'Object' && typeof O.callee == 'function' ? 'Arguments' : B;\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.classof.js\n ** module id = 61\n ** module chunks = 0\n **/","var SYMBOL_ITERATOR = require('./$.wks')('iterator')\n  , SAFE_CLOSING    = false;\ntry {\n  var riter = [7][SYMBOL_ITERATOR]();\n  riter['return'] = function(){ SAFE_CLOSING = true; };\n  Array.from(riter, function(){ throw 2; });\n} catch(e){ /* empty */ }\nmodule.exports = function(exec){\n  if(!SAFE_CLOSING)return false;\n  var safe = false;\n  try {\n    var arr  = [7]\n      , iter = arr[SYMBOL_ITERATOR]();\n    iter.next = function(){ safe = true; };\n    arr[SYMBOL_ITERATOR] = function(){ return iter; };\n    exec(arr);\n  } catch(e){ /* empty */ }\n  return safe;\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.iter-detect.js\n ** module id = 62\n ** module chunks = 0\n **/","module.exports = { \"default\": require(\"core-js/library/fn/promise\"), __esModule: true };\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/core-js/promise.js\n ** module id = 63\n ** module chunks = 0\n **/","require('../modules/es6.object.to-string');\nrequire('../modules/es6.string.iterator');\nrequire('../modules/web.dom.iterable');\nrequire('../modules/es6.promise');\nmodule.exports = require('../modules/$.core').Promise;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/fn/promise.js\n ** module id = 64\n ** module chunks = 0\n **/","require('./es6.array.iterator');\nvar Iterators = require('./$.iterators');\nIterators.NodeList = Iterators.HTMLCollection = Iterators.Array;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/web.dom.iterable.js\n ** module id = 66\n ** module chunks = 0\n **/","'use strict';\nvar setUnscope = require('./$.unscope')\n  , step       = require('./$.iter-step')\n  , Iterators  = require('./$.iterators')\n  , toIObject  = require('./$.to-iobject');\n\n// 22.1.3.4 Array.prototype.entries()\n// 22.1.3.13 Array.prototype.keys()\n// 22.1.3.29 Array.prototype.values()\n// 22.1.3.30 Array.prototype[@@iterator]()\nrequire('./$.iter-define')(Array, 'Array', function(iterated, kind){\n  this._t = toIObject(iterated); // target\n  this._i = 0;                   // next index\n  this._k = kind;                // kind\n// 22.1.5.2.1 %ArrayIteratorPrototype%.next()\n}, function(){\n  var O     = this._t\n    , kind  = this._k\n    , index = this._i++;\n  if(!O || index >= O.length){\n    this._t = undefined;\n    return step(1);\n  }\n  if(kind == 'keys'  )return step(0, index);\n  if(kind == 'values')return step(0, O[index]);\n  return step(0, [index, O[index]]);\n}, 'values');\n\n// argumentsList[@@iterator] is %ArrayProto_values% (9.4.4.6, 9.4.4.7)\nIterators.Arguments = Iterators.Array;\n\nsetUnscope('keys');\nsetUnscope('values');\nsetUnscope('entries');\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/es6.array.iterator.js\n ** module id = 67\n ** module chunks = 0\n **/","module.exports = function(){ /* empty */ };\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.unscope.js\n ** module id = 68\n ** module chunks = 0\n **/","module.exports = function(done, value){\n  return {value: value, done: !!done};\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.iter-step.js\n ** module id = 69\n ** module chunks = 0\n **/","'use strict';\nvar $          = require('./$')\n  , LIBRARY    = require('./$.library')\n  , global     = require('./$.global')\n  , ctx        = require('./$.ctx')\n  , classof    = require('./$.classof')\n  , $def       = require('./$.def')\n  , isObject   = require('./$.is-object')\n  , anObject   = require('./$.an-object')\n  , aFunction  = require('./$.a-function')\n  , strictNew  = require('./$.strict-new')\n  , forOf      = require('./$.for-of')\n  , setProto   = require('./$.set-proto').set\n  , same       = require('./$.same')\n  , species    = require('./$.species')\n  , SPECIES    = require('./$.wks')('species')\n  , RECORD     = require('./$.uid')('record')\n  , asap       = require('./$.microtask')\n  , PROMISE    = 'Promise'\n  , process    = global.process\n  , isNode     = classof(process) == 'process'\n  , P          = global[PROMISE]\n  , Wrapper;\n\nvar testResolve = function(sub){\n  var test = new P(function(){});\n  if(sub)test.constructor = Object;\n  return P.resolve(test) === test;\n};\n\nvar useNative = function(){\n  var works = false;\n  function P2(x){\n    var self = new P(x);\n    setProto(self, P2.prototype);\n    return self;\n  }\n  try {\n    works = P && P.resolve && testResolve();\n    setProto(P2, P);\n    P2.prototype = $.create(P.prototype, {constructor: {value: P2}});\n    // actual Firefox has broken subclass support, test that\n    if(!(P2.resolve(5).then(function(){}) instanceof P2)){\n      works = false;\n    }\n    // actual V8 bug, https://code.google.com/p/v8/issues/detail?id=4162\n    if(works && require('./$.support-desc')){\n      var thenableThenGotten = false;\n      P.resolve($.setDesc({}, 'then', {\n        get: function(){ thenableThenGotten = true; }\n      }));\n      works = thenableThenGotten;\n    }\n  } catch(e){ works = false; }\n  return works;\n}();\n\n// helpers\nvar isPromise = function(it){\n  return isObject(it) && (useNative ? classof(it) == 'Promise' : RECORD in it);\n};\nvar sameConstructor = function(a, b){\n  // library wrapper special case\n  if(LIBRARY && a === P && b === Wrapper)return true;\n  return same(a, b);\n};\nvar getConstructor = function(C){\n  var S = anObject(C)[SPECIES];\n  return S != undefined ? S : C;\n};\nvar isThenable = function(it){\n  var then;\n  return isObject(it) && typeof (then = it.then) == 'function' ? then : false;\n};\nvar notify = function(record, isReject){\n  if(record.n)return;\n  record.n = true;\n  var chain = record.c;\n  asap(function(){\n    var value = record.v\n      , ok    = record.s == 1\n      , i     = 0;\n    var run = function(react){\n      var cb = ok ? react.ok : react.fail\n        , ret, then;\n      try {\n        if(cb){\n          if(!ok)record.h = true;\n          ret = cb === true ? value : cb(value);\n          if(ret === react.P){\n            react.rej(TypeError('Promise-chain cycle'));\n          } else if(then = isThenable(ret)){\n            then.call(ret, react.res, react.rej);\n          } else react.res(ret);\n        } else react.rej(value);\n      } catch(err){\n        react.rej(err);\n      }\n    };\n    while(chain.length > i)run(chain[i++]); // variable length - can't use forEach\n    chain.length = 0;\n    record.n = false;\n    if(isReject)setTimeout(function(){\n      var promise = record.p\n        , handler, console;\n      if(isUnhandled(promise)){\n        if(isNode){\n          process.emit('unhandledRejection', value, promise);\n        } else if(handler = global.onunhandledrejection){\n          handler({promise: promise, reason: value});\n        } else if((console = global.console) && console.error){\n          console.error('Unhandled promise rejection', value);\n        }\n      } record.a = undefined;\n    }, 1);\n  });\n};\nvar isUnhandled = function(promise){\n  var record = promise[RECORD]\n    , chain  = record.a || record.c\n    , i      = 0\n    , react;\n  if(record.h)return false;\n  while(chain.length > i){\n    react = chain[i++];\n    if(react.fail || !isUnhandled(react.P))return false;\n  } return true;\n};\nvar $reject = function(value){\n  var record = this;\n  if(record.d)return;\n  record.d = true;\n  record = record.r || record; // unwrap\n  record.v = value;\n  record.s = 2;\n  record.a = record.c.slice();\n  notify(record, true);\n};\nvar $resolve = function(value){\n  var record = this\n    , then;\n  if(record.d)return;\n  record.d = true;\n  record = record.r || record; // unwrap\n  try {\n    if(then = isThenable(value)){\n      asap(function(){\n        var wrapper = {r: record, d: false}; // wrap\n        try {\n          then.call(value, ctx($resolve, wrapper, 1), ctx($reject, wrapper, 1));\n        } catch(e){\n          $reject.call(wrapper, e);\n        }\n      });\n    } else {\n      record.v = value;\n      record.s = 1;\n      notify(record, false);\n    }\n  } catch(e){\n    $reject.call({r: record, d: false}, e); // wrap\n  }\n};\n\n// constructor polyfill\nif(!useNative){\n  // 25.4.3.1 Promise(executor)\n  P = function Promise(executor){\n    aFunction(executor);\n    var record = {\n      p: strictNew(this, P, PROMISE),         // <- promise\n      c: [],                                  // <- awaiting reactions\n      a: undefined,                           // <- checked in isUnhandled reactions\n      s: 0,                                   // <- state\n      d: false,                               // <- done\n      v: undefined,                           // <- value\n      h: false,                               // <- handled rejection\n      n: false                                // <- notify\n    };\n    this[RECORD] = record;\n    try {\n      executor(ctx($resolve, record, 1), ctx($reject, record, 1));\n    } catch(err){\n      $reject.call(record, err);\n    }\n  };\n  require('./$.mix')(P.prototype, {\n    // 25.4.5.3 Promise.prototype.then(onFulfilled, onRejected)\n    then: function then(onFulfilled, onRejected){\n      var S = anObject(anObject(this).constructor)[SPECIES];\n      var react = {\n        ok:   typeof onFulfilled == 'function' ? onFulfilled : true,\n        fail: typeof onRejected == 'function'  ? onRejected  : false\n      };\n      var promise = react.P = new (S != undefined ? S : P)(function(res, rej){\n        react.res = res;\n        react.rej = rej;\n      });\n      aFunction(react.res);\n      aFunction(react.rej);\n      var record = this[RECORD];\n      record.c.push(react);\n      if(record.a)record.a.push(react);\n      if(record.s)notify(record, false);\n      return promise;\n    },\n    // 25.4.5.1 Promise.prototype.catch(onRejected)\n    'catch': function(onRejected){\n      return this.then(undefined, onRejected);\n    }\n  });\n}\n\n// export\n$def($def.G + $def.W + $def.F * !useNative, {Promise: P});\nrequire('./$.tag')(P, PROMISE);\nspecies(P);\nspecies(Wrapper = require('./$.core')[PROMISE]);\n\n// statics\n$def($def.S + $def.F * !useNative, PROMISE, {\n  // 25.4.4.5 Promise.reject(r)\n  reject: function reject(r){\n    return new this(function(res, rej){ rej(r); });\n  }\n});\n$def($def.S + $def.F * (!useNative || testResolve(true)), PROMISE, {\n  // 25.4.4.6 Promise.resolve(x)\n  resolve: function resolve(x){\n    return isPromise(x) && sameConstructor(x.constructor, this)\n      ? x : new this(function(res){ res(x); });\n  }\n});\n$def($def.S + $def.F * !(useNative && require('./$.iter-detect')(function(iter){\n  P.all(iter)['catch'](function(){});\n})), PROMISE, {\n  // 25.4.4.1 Promise.all(iterable)\n  all: function all(iterable){\n    var C      = getConstructor(this)\n      , values = [];\n    return new C(function(res, rej){\n      forOf(iterable, false, values.push, values);\n      var remaining = values.length\n        , results   = Array(remaining);\n      if(remaining)$.each.call(values, function(promise, index){\n        C.resolve(promise).then(function(value){\n          results[index] = value;\n          --remaining || res(results);\n        }, rej);\n      });\n      else res(results);\n    });\n  },\n  // 25.4.4.4 Promise.race(iterable)\n  race: function race(iterable){\n    var C = getConstructor(this);\n    return new C(function(res, rej){\n      forOf(iterable, false, function(promise){\n        C.resolve(promise).then(res, rej);\n      });\n    });\n  }\n});\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/es6.promise.js\n ** module id = 70\n ** module chunks = 0\n **/","module.exports = function(it, Constructor, name){\n  if(!(it instanceof Constructor))throw TypeError(name + \": use the 'new' operator!\");\n  return it;\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.strict-new.js\n ** module id = 71\n ** module chunks = 0\n **/","var ctx         = require('./$.ctx')\n  , call        = require('./$.iter-call')\n  , isArrayIter = require('./$.is-array-iter')\n  , anObject    = require('./$.an-object')\n  , toLength    = require('./$.to-length')\n  , getIterFn   = require('./core.get-iterator-method');\nmodule.exports = function(iterable, entries, fn, that){\n  var iterFn = getIterFn(iterable)\n    , f      = ctx(fn, that, entries ? 2 : 1)\n    , index  = 0\n    , length, step, iterator;\n  if(typeof iterFn != 'function')throw TypeError(iterable + ' is not iterable!');\n  // fast case for arrays with default iterator\n  if(isArrayIter(iterFn))for(length = toLength(iterable.length); length > index; index++){\n    entries ? f(anObject(step = iterable[index])[0], step[1]) : f(iterable[index]);\n  } else for(iterator = iterFn.call(iterable); !(step = iterator.next()).done; ){\n    call(iterator, f, step.value, entries);\n  }\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.for-of.js\n ** module id = 72\n ** module chunks = 0\n **/","module.exports = Object.is || function is(x, y){\n  return x === y ? x !== 0 || 1 / x === 1 / y : x != x && y != y;\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.same.js\n ** module id = 73\n ** module chunks = 0\n **/","'use strict';\nvar $       = require('./$')\n  , SPECIES = require('./$.wks')('species');\nmodule.exports = function(C){\n  if(require('./$.support-desc') && !(SPECIES in C))$.setDesc(C, SPECIES, {\n    configurable: true,\n    get: function(){ return this; }\n  });\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.species.js\n ** module id = 74\n ** module chunks = 0\n **/","var global    = require('./$.global')\r\n  , macrotask = require('./$.task').set\r\n  , Observer  = global.MutationObserver || global.WebKitMutationObserver\r\n  , process   = global.process\r\n  , isNode    = require('./$.cof')(process) == 'process'\r\n  , head, last, notify;\r\n\r\nvar flush = function(){\r\n  var parent, domain;\r\n  if(isNode && (parent = process.domain)){\r\n    process.domain = null;\r\n    parent.exit();\r\n  }\r\n  while(head){\r\n    domain = head.domain;\r\n    if(domain)domain.enter();\r\n    head.fn.call(); // <- currently we use it only for Promise - try / catch not required\r\n    if(domain)domain.exit();\r\n    head = head.next;\r\n  } last = undefined;\r\n  if(parent)parent.enter();\r\n}\r\n\r\n// Node.js\r\nif(isNode){\r\n  notify = function(){\r\n    process.nextTick(flush);\r\n  };\r\n// browsers with MutationObserver\r\n} else if(Observer){\r\n  var toggle = 1\r\n    , node   = document.createTextNode('');\r\n  new Observer(flush).observe(node, {characterData: true}); // eslint-disable-line no-new\r\n  notify = function(){\r\n    node.data = toggle = -toggle;\r\n  };\r\n// for other environments - macrotask based on:\r\n// - setImmediate\r\n// - MessageChannel\r\n// - window.postMessag\r\n// - onreadystatechange\r\n// - setTimeout\r\n} else {\r\n  notify = function(){\r\n    // strange IE + webpack dev server bug - use .call(global)\r\n    macrotask.call(global, flush);\r\n  };\r\n}\r\n\r\nmodule.exports = function asap(fn){\r\n  var task = {fn: fn, next: undefined, domain: isNode && process.domain};\r\n  if(last)last.next = task;\r\n  if(!head){\r\n    head = task;\r\n    notify();\r\n  } last = task;\r\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.microtask.js\n ** module id = 75\n ** module chunks = 0\n **/","'use strict';\nvar ctx                = require('./$.ctx')\n  , invoke             = require('./$.invoke')\n  , html               = require('./$.html')\n  , cel                = require('./$.dom-create')\n  , global             = require('./$.global')\n  , process            = global.process\n  , setTask            = global.setImmediate\n  , clearTask          = global.clearImmediate\n  , MessageChannel     = global.MessageChannel\n  , counter            = 0\n  , queue              = {}\n  , ONREADYSTATECHANGE = 'onreadystatechange'\n  , defer, channel, port;\nvar run = function(){\n  var id = +this;\n  if(queue.hasOwnProperty(id)){\n    var fn = queue[id];\n    delete queue[id];\n    fn();\n  }\n};\nvar listner = function(event){\n  run.call(event.data);\n};\n// Node.js 0.9+ & IE10+ has setImmediate, otherwise:\nif(!setTask || !clearTask){\n  setTask = function setImmediate(fn){\n    var args = [], i = 1;\n    while(arguments.length > i)args.push(arguments[i++]);\n    queue[++counter] = function(){\n      invoke(typeof fn == 'function' ? fn : Function(fn), args);\n    };\n    defer(counter);\n    return counter;\n  };\n  clearTask = function clearImmediate(id){\n    delete queue[id];\n  };\n  // Node.js 0.8-\n  if(require('./$.cof')(process) == 'process'){\n    defer = function(id){\n      process.nextTick(ctx(run, id, 1));\n    };\n  // Browsers with MessageChannel, includes WebWorkers\n  } else if(MessageChannel){\n    channel = new MessageChannel;\n    port    = channel.port2;\n    channel.port1.onmessage = listner;\n    defer = ctx(port.postMessage, port, 1);\n  // Browsers with postMessage, skip WebWorkers\n  // IE8 has postMessage, but it's sync & typeof its postMessage is 'object'\n  } else if(global.addEventListener && typeof postMessage == 'function' && !global.importScripts){\n    defer = function(id){\n      global.postMessage(id + '', '*');\n    };\n    global.addEventListener('message', listner, false);\n  // IE8-\n  } else if(ONREADYSTATECHANGE in cel('script')){\n    defer = function(id){\n      html.appendChild(cel('script'))[ONREADYSTATECHANGE] = function(){\n        html.removeChild(this);\n        run.call(id);\n      };\n    };\n  // Rest old browsers\n  } else {\n    defer = function(id){\n      setTimeout(ctx(run, id, 1), 0);\n    };\n  }\n}\nmodule.exports = {\n  set:   setTask,\n  clear: clearTask\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.task.js\n ** module id = 76\n ** module chunks = 0\n **/","// fast apply, http://jsperf.lnkit.com/fast-apply/5\nmodule.exports = function(fn, args, that){\n  var un = that === undefined;\n  switch(args.length){\n    case 0: return un ? fn()\n                      : fn.call(that);\n    case 1: return un ? fn(args[0])\n                      : fn.call(that, args[0]);\n    case 2: return un ? fn(args[0], args[1])\n                      : fn.call(that, args[0], args[1]);\n    case 3: return un ? fn(args[0], args[1], args[2])\n                      : fn.call(that, args[0], args[1], args[2]);\n    case 4: return un ? fn(args[0], args[1], args[2], args[3])\n                      : fn.call(that, args[0], args[1], args[2], args[3]);\n  } return              fn.apply(that, args);\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.invoke.js\n ** module id = 77\n ** module chunks = 0\n **/","module.exports = require('./$.global').document && document.documentElement;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.html.js\n ** module id = 78\n ** module chunks = 0\n **/","var isObject = require('./$.is-object')\n  , document = require('./$.global').document\n  // in old IE typeof document.createElement is 'object'\n  , is = isObject(document) && isObject(document.createElement);\nmodule.exports = function(it){\n  return is ? document.createElement(it) : {};\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.dom-create.js\n ** module id = 79\n ** module chunks = 0\n **/","var $redef = require('./$.redef');\nmodule.exports = function(target, src){\n  for(var key in src)$redef(target, key, src[key]);\n  return target;\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.mix.js\n ** module id = 80\n ** module chunks = 0\n **/","module.exports = { \"default\": require(\"core-js/library/fn/get-iterator\"), __esModule: true };\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/core-js/get-iterator.js\n ** module id = 81\n ** module chunks = 0\n **/","require('../modules/web.dom.iterable');\nrequire('../modules/es6.string.iterator');\nmodule.exports = require('../modules/core.get-iterator');\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/fn/get-iterator.js\n ** module id = 82\n ** module chunks = 0\n **/","var anObject = require('./$.an-object')\n  , get      = require('./core.get-iterator-method');\nmodule.exports = require('./$.core').getIterator = function(it){\n  var iterFn = get(it);\n  if(typeof iterFn != 'function')throw TypeError(it + ' is not iterable!');\n  return anObject(iterFn.call(it));\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/core.get-iterator.js\n ** module id = 83\n ** module chunks = 0\n **/","import Debug from 'debug';\r\nlet debug = Debug('hedra:app');\r\n\r\nimport Hedra from './hedra';\r\nimport THREE from 'three';\r\n//import TWEEN from 'tween';\r\n\r\nexport default class HedraApp extends Hedra {\r\n\tconstructor(config) {\r\n\t\tdebug('construct', config);\r\n\t\t\r\n\t\tconfig.make = false;\r\n\t\tconfig.parent = config.parent || document.body;\r\n\t\t\r\n\t\tif(!config.width && !config.height) {\r\n\t\t\tif(config.parent === document.body) {\r\n\t\t\t\tconfig.width = window.innerWidth;\r\n\t\t\t\tconfig.height = window.innerHeight;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tconfig.width = config.parent.offsetWidth;\r\n\t\t\t\tconfig.height = config.parent.offsetHeight;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tif(config.parent === document.body) {\r\n\t\t\tdocument.body.style.margin = '0';\r\n\t\t\tdocument.body.style.backgroundColor = 'gray';\r\n\t\t}\r\n\t\t\r\n\t\tvar scene = new THREE.Scene();\r\n\t\t\r\n\t\tvar camera = new THREE.PerspectiveCamera(75, config.width / config.height, 0.1, 1000);\r\n\t\tcamera.position.copy(config.camera || new THREE.Vector3(0,0,0));\r\n\t\t\r\n\t\tvar renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });\r\n\t\trenderer.setClearColor(0x000000, 0);\r\n\t\trenderer.setSize(config.width, config.height);\r\n\t\t\r\n\t\trenderer.domElement.style.display = 'block';\r\n\t\tconfig.parent.appendChild(renderer.domElement);\r\n\t\t\r\n\t\tsuper(config);\r\n\t\t\r\n\t\tthis.scene = this._ = scene;\r\n\t\tthis.camera = camera;\r\n\t\tthis.renderer = renderer;\r\n\t\t\r\n\t\tthis.scene.add(this.camera);\r\n\t\t\r\n\t\tthis.clock = new THREE.Clock(false);\r\n\t\t\r\n\t\tif(config.pause) {\r\n\t\t\twindow.addEventListener('focus', () => {\r\n\t\t\t\tthis.play();\r\n\t\t\t}, false);\r\n\t\t\t\r\n\t\t\twindow.addEventListener('blur', () => {\r\n\t\t\t\tthis.pause();\r\n\t\t\t}, false);\r\n\t\t}\r\n\t\t\r\n\t\tsetTimeout(() => {\r\n\t\t\tthis.play();\r\n\t\t}, 0);\r\n\t\t\r\n\t\tif(typeof window.Stats !== 'undefined') {\r\n\t\t\tthis.stats = new window.Stats();\r\n\t\t\t\r\n\t\t\tthis.stats.domElement.style.position = 'absolute';\r\n\t\t\tthis.stats.domElement.style.top  = '0';\r\n\t\t\tthis.stats.domElement.style.left = '0';\r\n\t\t\tconfig.parent.appendChild(this.stats.domElement);\r\n\t\t}\r\n\t\t\r\n\t\tif(typeof TWEEN !== 'undefined') {\r\n\t\t\tTWEEN._time = 0;\r\n\t\t\tthis.on('update').then((e) => {\r\n\t\t\t\tTWEEN._time = e.time;\r\n\t\t\t\tTWEEN.update(e.time);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\t\r\n\tplay() {\r\n\t\tdebug('play');\r\n\t\t\r\n\t\tthis.clock.start();\r\n\t\trequestAnimationFrame(() => { this._animate(); });\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\tpause() {\r\n\t\tdebug('pause');\r\n\t\t\r\n\t\tthis.clock.stop();\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t_animate() {\r\n\t\tif(this.clock.running) {\r\n\t\t\trequestAnimationFrame(() => { this._animate(); });\r\n\t\t}\r\n\t\t\r\n\t\tthis._frame(this.clock.getDelta(), this.clock.getElapsedTime());\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t_frame(delta, time) {\r\n\t\tthis.bubble('update', delta || 0, time || 0);\r\n\t\t\r\n\t\tthis.render();\r\n\t\t\r\n\t\tif(this.stats) {\r\n\t\t\tthis.stats.update();\r\n\t\t}\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tthis.renderer.render(this.scene, this.camera);\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** c:/data/Projects/Steering/~/hedra/app.jsx\n **/","import Debug from 'debug';\r\nlet debug = Debug('hedra');\r\n\r\nimport Emitter from 'emitter';\r\nimport THREE from 'three';\r\n//import TWEEN from 'tween';\r\n\r\nexport default class Hedra extends Emitter {\r\n\tconstructor(config) {\r\n\t\tdebug('construct', config);\r\n\t\t\r\n\t\tif(config.make === false) {\r\n\t\t\tdelete config.make;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif(config.geometry && config.material) {\r\n\t\t\t\tconfig.make = new THREE.Mesh(config.geometry, config.material);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tconfig.make = new THREE.Object3D();\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tsuper();\r\n\t\t\r\n\t\tthis.children = [];\r\n\t\t\r\n\t\tif(config.make) {\r\n\t\t\tthis._ = config.make;\r\n\t\t\tthis._._ = this;\r\n\t\t}\r\n\t}\r\n\t\r\n\tadd(child) {\r\n\t\tdebug('add', child);\r\n\t\t\r\n\t\tif(child instanceof Hedra) {\r\n\t\t\tthis.children.push(child);\r\n\t\t\tthis._.add(child._);\r\n\t\t}\r\n\t\telse if(child instanceof THREE.Object3D) {\r\n\t\t\tthis._.add(child);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthrow new Error('Hedra.app.add: Child not an instance of `Hedra` or `THREE.Object3D`.');\r\n\t\t}\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\tbubble(...items) {\r\n\t\tthis.emit(...items);\r\n\t\t\r\n\t\tfor(let child of this.children) {\r\n\t\t\tchild.bubble(...items);\r\n\t\t}\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\ttween(config) {\r\n\t\tdebug('tween', config);\r\n\t\t\r\n\t\tvar tween = new TWEEN.Tween(config.object || this);\r\n\t\t\r\n\t\tif(config.to && config.duration) {\r\n\t\t\ttween.to(config.to, config.duration);\r\n\t\t}\r\n\t\t\r\n\t\tif(config.easing) {\r\n\t\t\ttween.easing(config.easing);\r\n\t\t}\r\n\t\t\r\n\t\tvar promise = new Promise(function(resolve) {\r\n\t\t\ttween.onComplete(resolve);\r\n\t\t\ttween.onStop(resolve);\r\n\t\t\ttween.start(TWEEN._time);\r\n\t\t});\r\n\t\t\r\n\t\tpromise.tween = tween;\r\n\t\t\r\n\t\treturn promise;\r\n\t}\r\n\t\r\n\tget position() {\r\n\t\treturn this._.position;\r\n\t}\r\n\t\r\n\tget rotation() {\r\n\t\treturn this._.rotation;\r\n\t}\r\n\t\r\n\tget quaternion() {\r\n\t\treturn this._.quaternion;\r\n\t}\r\n\t\r\n\tget scale() {\r\n\t\treturn this._.scale;\r\n\t}\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** c:/data/Projects/Steering/~/hedra/hedra.jsx\n **/","/**\r\n * ES6-ified version of component-emitter\r\n * Original available at https://github.com/component/emitter\r\n */\r\n\r\nexport default class Emitter {\r\n\t/**\r\n\t * Initialize a new `Emitter`.\r\n\t *\r\n\t * @api public\r\n\t */\r\n\t\r\n\tconstructor() {\r\n\t\tthis._emitters = {};\r\n\t\tthis._subscribers = [];\r\n\t}\r\n\t\r\n\t/**\r\n\t * Register a handler `fn`.\r\n\t */\r\n\t\r\n\tthen(fn) {\r\n\t\tthis._subscribers.push(fn.bind(this));\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Return an emitter for the given `event`.\r\n\t *\r\n\t * @param {String} event\r\n\t * @return {Emitter}\r\n\t * @api public\r\n\t */\r\n\t\r\n\ton(...items) {\r\n\t\tif(!items.length) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\t\r\n\t\tvar event = items.shift();\r\n\t\t\r\n\t\tif(!this._emitters[event]) {\r\n\t\t\tthis._emitters[event] = new Emitter();\r\n\t\t}\r\n\t\t\r\n\t\treturn this._emitters[event].on(...items);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Remove the emitters for `event` or all events.\r\n\t *\r\n\t * @param {String} event\r\n\t * @return {Emitter}\r\n\t * @api public\r\n\t */\r\n\t\r\n\toff(...items) {\r\n\t\tif(!items.length) {\r\n\t\t\tthis._emitters = {};\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\t\r\n\t\tvar event = items.shift();\r\n\t\t\r\n\t\tif(!this._emitters[event]) {\r\n\t\t\tthis._emitters[event] = new Emitter();\r\n\t\t}\r\n\t\t\r\n\t\treturn this._emitters[event].off(...items);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Emit `event` with the given args.\r\n\t *\r\n\t * @param {String} event\r\n\t * @param {Mixed} ...\r\n\t * @return {Emitter}\r\n\t */\r\n\t\r\n\temit(...items) {\r\n\t\tthis._subscribers.map((fn) => {\r\n\t\t\tfn.apply(this, items);\r\n\t\t});\r\n\t\t\r\n\t\tvar event = items[0];\r\n\t\tif(typeof event === 'string') {\r\n\t\t\titems.shift();\r\n\t\t\tvar emitter = this._emitters[event];\r\n\t\t\t\r\n\t\t\tif(emitter) {\r\n\t\t\t\temitter.emit(...items);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn this;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Check if this emitter has `event` emitters.\r\n\t *\r\n\t * @param {String} event\r\n\t * @return {Boolean}\r\n\t * @api public\r\n\t */\r\n\t\r\n\thas(event) {\r\n\t\treturn !!this._emitters[event];\r\n\t}\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** c:/data/Projects/Steering/~/emitter/emitter.jsx\n **/","// File:src/Three.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nvar THREE = { REVISION: '72' };\n\n//\n\nif ( typeof define === 'function' && define.amd ) {\n\n\t\tdefine( 'three', THREE );\n\n} else if ( 'undefined' !== typeof exports && 'undefined' !== typeof module ) {\n\n\t\tmodule.exports = THREE;\n\n}\n\n\n// polyfills\n\nif ( self.requestAnimationFrame === undefined || self.cancelAnimationFrame === undefined ) {\n\n\t// Missing in Android stock browser.\n\n\t( function () {\n\n\t\tvar lastTime = 0;\n\t\tvar vendors = [ 'ms', 'moz', 'webkit', 'o' ];\n\n\t\tfor ( var x = 0; x < vendors.length && ! self.requestAnimationFrame; ++ x ) {\n\n\t\t\tself.requestAnimationFrame = self[ vendors[ x ] + 'RequestAnimationFrame' ];\n\t\t\tself.cancelAnimationFrame = self[ vendors[ x ] + 'CancelAnimationFrame' ] || self[ vendors[ x ] + 'CancelRequestAnimationFrame' ];\n\n\t\t}\n\n\t\tif ( self.requestAnimationFrame === undefined && self.setTimeout !== undefined ) {\n\n\t\t\tself.requestAnimationFrame = function ( callback ) {\n\n\t\t\t\tvar currTime = Date.now(), timeToCall = Math.max( 0, 16 - ( currTime - lastTime ) );\n\t\t\t\tvar id = self.setTimeout( function () {\n\n\t\t\t\t\tcallback( currTime + timeToCall );\n\n\t\t\t\t}, timeToCall );\n\t\t\t\tlastTime = currTime + timeToCall;\n\t\t\t\treturn id;\n\n\t\t\t};\n\n\t\t}\n\n\t\tif ( self.cancelAnimationFrame === undefined && self.clearTimeout !== undefined ) {\n\n\t\t\tself.cancelAnimationFrame = function ( id ) {\n\n\t\t\t\tself.clearTimeout( id );\n\n\t\t\t};\n\n\t\t}\n\n\t}() );\n\n}\n\nif ( Math.sign === undefined ) {\n\n\t// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/sign\n\n\tMath.sign = function ( x ) {\n\n\t\treturn ( x < 0 ) ? - 1 : ( x > 0 ) ? 1 : + x;\n\n\t};\n\n}\n\nif ( Function.prototype.name === undefined && Object.defineProperty !== undefined ) {\n\n\t// Missing in IE9-11.\n\t// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/name\n\n\tObject.defineProperty( Function.prototype, 'name', {\n\n\t\tget: function () {\n\n\t\t\treturn this.toString().match( /^\\s*function\\s*(\\S*)\\s*\\(/ )[ 1 ];\n\n\t\t}\n\n\t} );\n\n}\n\n// https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent.button\n\nTHREE.MOUSE = { LEFT: 0, MIDDLE: 1, RIGHT: 2 };\n\n// GL STATE CONSTANTS\n\nTHREE.CullFaceNone = 0;\nTHREE.CullFaceBack = 1;\nTHREE.CullFaceFront = 2;\nTHREE.CullFaceFrontBack = 3;\n\nTHREE.FrontFaceDirectionCW = 0;\nTHREE.FrontFaceDirectionCCW = 1;\n\n// SHADOWING TYPES\n\nTHREE.BasicShadowMap = 0;\nTHREE.PCFShadowMap = 1;\nTHREE.PCFSoftShadowMap = 2;\n\n// MATERIAL CONSTANTS\n\n// side\n\nTHREE.FrontSide = 0;\nTHREE.BackSide = 1;\nTHREE.DoubleSide = 2;\n\n// shading\n\nTHREE.FlatShading = 1;\nTHREE.SmoothShading = 2;\n\n// colors\n\nTHREE.NoColors = 0;\nTHREE.FaceColors = 1;\nTHREE.VertexColors = 2;\n\n// blending modes\n\nTHREE.NoBlending = 0;\nTHREE.NormalBlending = 1;\nTHREE.AdditiveBlending = 2;\nTHREE.SubtractiveBlending = 3;\nTHREE.MultiplyBlending = 4;\nTHREE.CustomBlending = 5;\n\n// custom blending equations\n// (numbers start from 100 not to clash with other\n// mappings to OpenGL constants defined in Texture.js)\n\nTHREE.AddEquation = 100;\nTHREE.SubtractEquation = 101;\nTHREE.ReverseSubtractEquation = 102;\nTHREE.MinEquation = 103;\nTHREE.MaxEquation = 104;\n\n// custom blending destination factors\n\nTHREE.ZeroFactor = 200;\nTHREE.OneFactor = 201;\nTHREE.SrcColorFactor = 202;\nTHREE.OneMinusSrcColorFactor = 203;\nTHREE.SrcAlphaFactor = 204;\nTHREE.OneMinusSrcAlphaFactor = 205;\nTHREE.DstAlphaFactor = 206;\nTHREE.OneMinusDstAlphaFactor = 207;\n\n// custom blending source factors\n\n//THREE.ZeroFactor = 200;\n//THREE.OneFactor = 201;\n//THREE.SrcAlphaFactor = 204;\n//THREE.OneMinusSrcAlphaFactor = 205;\n//THREE.DstAlphaFactor = 206;\n//THREE.OneMinusDstAlphaFactor = 207;\nTHREE.DstColorFactor = 208;\nTHREE.OneMinusDstColorFactor = 209;\nTHREE.SrcAlphaSaturateFactor = 210;\n\n// depth modes\n\nTHREE.NeverDepth = 0;\nTHREE.AlwaysDepth = 1;\nTHREE.LessDepth = 2;\nTHREE.LessEqualDepth = 3;\nTHREE.EqualDepth = 4;\nTHREE.GreaterEqualDepth = 5;\nTHREE.GreaterDepth = 6;\nTHREE.NotEqualDepth = 7;\n\n\n// TEXTURE CONSTANTS\n\nTHREE.MultiplyOperation = 0;\nTHREE.MixOperation = 1;\nTHREE.AddOperation = 2;\n\n// Mapping modes\n\nTHREE.UVMapping = 300;\n\nTHREE.CubeReflectionMapping = 301;\nTHREE.CubeRefractionMapping = 302;\n\nTHREE.EquirectangularReflectionMapping = 303;\nTHREE.EquirectangularRefractionMapping = 304;\n\nTHREE.SphericalReflectionMapping = 305;\n\n// Wrapping modes\n\nTHREE.RepeatWrapping = 1000;\nTHREE.ClampToEdgeWrapping = 1001;\nTHREE.MirroredRepeatWrapping = 1002;\n\n// Filters\n\nTHREE.NearestFilter = 1003;\nTHREE.NearestMipMapNearestFilter = 1004;\nTHREE.NearestMipMapLinearFilter = 1005;\nTHREE.LinearFilter = 1006;\nTHREE.LinearMipMapNearestFilter = 1007;\nTHREE.LinearMipMapLinearFilter = 1008;\n\n// Data types\n\nTHREE.UnsignedByteType = 1009;\nTHREE.ByteType = 1010;\nTHREE.ShortType = 1011;\nTHREE.UnsignedShortType = 1012;\nTHREE.IntType = 1013;\nTHREE.UnsignedIntType = 1014;\nTHREE.FloatType = 1015;\nTHREE.HalfFloatType = 1025;\n\n// Pixel types\n\n//THREE.UnsignedByteType = 1009;\nTHREE.UnsignedShort4444Type = 1016;\nTHREE.UnsignedShort5551Type = 1017;\nTHREE.UnsignedShort565Type = 1018;\n\n// Pixel formats\n\nTHREE.AlphaFormat = 1019;\nTHREE.RGBFormat = 1020;\nTHREE.RGBAFormat = 1021;\nTHREE.LuminanceFormat = 1022;\nTHREE.LuminanceAlphaFormat = 1023;\n// THREE.RGBEFormat handled as THREE.RGBAFormat in shaders\nTHREE.RGBEFormat = THREE.RGBAFormat; //1024;\n\n// DDS / ST3C Compressed texture formats\n\nTHREE.RGB_S3TC_DXT1_Format = 2001;\nTHREE.RGBA_S3TC_DXT1_Format = 2002;\nTHREE.RGBA_S3TC_DXT3_Format = 2003;\nTHREE.RGBA_S3TC_DXT5_Format = 2004;\n\n\n// PVRTC compressed texture formats\n\nTHREE.RGB_PVRTC_4BPPV1_Format = 2100;\nTHREE.RGB_PVRTC_2BPPV1_Format = 2101;\nTHREE.RGBA_PVRTC_4BPPV1_Format = 2102;\nTHREE.RGBA_PVRTC_2BPPV1_Format = 2103;\n\n\n// DEPRECATED\n\nTHREE.Projector = function () {\n\n\tconsole.error( 'THREE.Projector has been moved to /examples/js/renderers/Projector.js.' );\n\n\tthis.projectVector = function ( vector, camera ) {\n\n\t\tconsole.warn( 'THREE.Projector: .projectVector() is now vector.project().' );\n\t\tvector.project( camera );\n\n\t};\n\n\tthis.unprojectVector = function ( vector, camera ) {\n\n\t\tconsole.warn( 'THREE.Projector: .unprojectVector() is now vector.unproject().' );\n\t\tvector.unproject( camera );\n\n\t};\n\n\tthis.pickingRay = function ( vector, camera ) {\n\n\t\tconsole.error( 'THREE.Projector: .pickingRay() is now raycaster.setFromCamera().' );\n\n\t};\n\n};\n\nTHREE.CanvasRenderer = function () {\n\n\tconsole.error( 'THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js' );\n\n\tthis.domElement = document.createElement( 'canvas' );\n\tthis.clear = function () {};\n\tthis.render = function () {};\n\tthis.setClearColor = function () {};\n\tthis.setSize = function () {};\n\n};\n\n// File:src/math/Color.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.Color = function ( color ) {\n\n\tif ( arguments.length === 3 ) {\n\n\t\treturn this.setRGB( arguments[ 0 ], arguments[ 1 ], arguments[ 2 ] );\n\n\t}\n\n\treturn this.set( color );\n\n};\n\nTHREE.Color.prototype = {\n\n\tconstructor: THREE.Color,\n\n\tr: 1, g: 1, b: 1,\n\n\tset: function ( value ) {\n\n\t\tif ( value instanceof THREE.Color ) {\n\n\t\t\tthis.copy( value );\n\n\t\t} else if ( typeof value === 'number' ) {\n\n\t\t\tthis.setHex( value );\n\n\t\t} else if ( typeof value === 'string' ) {\n\n\t\t\tthis.setStyle( value );\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tsetHex: function ( hex ) {\n\n\t\thex = Math.floor( hex );\n\n\t\tthis.r = ( hex >> 16 & 255 ) / 255;\n\t\tthis.g = ( hex >> 8 & 255 ) / 255;\n\t\tthis.b = ( hex & 255 ) / 255;\n\n\t\treturn this;\n\n\t},\n\n\tsetRGB: function ( r, g, b ) {\n\n\t\tthis.r = r;\n\t\tthis.g = g;\n\t\tthis.b = b;\n\n\t\treturn this;\n\n\t},\n\n\tsetHSL: function () {\n\n\t\tfunction hue2rgb ( p, q, t ) {\n\n\t\t\tif ( t < 0 ) t += 1;\n\t\t\tif ( t > 1 ) t -= 1;\n\t\t\tif ( t < 1 / 6 ) return p + ( q - p ) * 6 * t;\n\t\t\tif ( t < 1 / 2 ) return q;\n\t\t\tif ( t < 2 / 3 ) return p + ( q - p ) * 6 * ( 2 / 3 - t );\n\t\t\treturn p;\n\n\t\t}\n\n\t\treturn function ( h, s, l ) {\n\n\t\t\t// h,s,l ranges are in 0.0 - 1.0\n\t\t\th = THREE.Math.euclideanModulo( h, 1 );\n\t\t\ts = THREE.Math.clamp( s, 0, 1 );\n\t\t\tl = THREE.Math.clamp( l, 0, 1 );\n\n\t\t\tif ( s === 0 ) {\n\n\t\t\t\tthis.r = this.g = this.b = l;\n\n\t\t\t} else {\n\n\t\t\t\tvar p = l <= 0.5 ? l * ( 1 + s ) : l + s - ( l * s );\n\t\t\t\tvar q = ( 2 * l ) - p;\n\n\t\t\t\tthis.r = hue2rgb( q, p, h + 1 / 3 );\n\t\t\t\tthis.g = hue2rgb( q, p, h );\n\t\t\t\tthis.b = hue2rgb( q, p, h - 1 / 3 );\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t};\n\n\t}(),\n\n\tsetStyle: function ( style ) {\n\n\t\tvar parseAlpha = function ( strAlpha ) {\n\n\t\t\tvar alpha = parseFloat( strAlpha );\n\n\t\t\tif ( alpha < 1 ) {\n\n\t\t\t\tconsole.warn( 'THREE.Color: Alpha component of color ' + style + ' will be ignored.' );\n\n\t\t\t}\n\n\t\t\treturn alpha;\n\n\t\t}\n\n\n\t\tvar m;\n\n\t\tif ( m = /^((?:rgb|hsl)a?)\\(\\s*([^\\)]*)\\)/.exec( style ) ) {\n\n\t\t\t// rgb / hsl\n\n\t\t\tvar color;\n\t\t\tvar name = m[ 1 ];\n\t\t\tvar components = m[ 2 ];\n\n\t\t\tswitch ( name ) {\n\n\t\t\t\tcase 'rgb':\n\n\t\t\t\t\tif ( color = /^(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*$/.exec( components ) ) {\n\n\t\t\t\t\t\t// rgb(255,0,0)\n\t\t\t\t\t\tthis.r = Math.min( 255, parseInt( color[ 1 ], 10 ) ) / 255;\n\t\t\t\t\t\tthis.g = Math.min( 255, parseInt( color[ 2 ], 10 ) ) / 255;\n\t\t\t\t\t\tthis.b = Math.min( 255, parseInt( color[ 3 ], 10 ) ) / 255;\n\n\t\t\t\t\t\treturn this;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( color = /^(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*$/.exec( components ) ) {\n\n\t\t\t\t\t\t// rgb(100%,0%,0%)\n\t\t\t\t\t\tthis.r = Math.min( 100, parseInt( color[ 1 ], 10 ) ) / 100;\n\t\t\t\t\t\tthis.g = Math.min( 100, parseInt( color[ 2 ], 10 ) ) / 100;\n\t\t\t\t\t\tthis.b = Math.min( 100, parseInt( color[ 3 ], 10 ) ) / 100;\n\n\t\t\t\t\t\treturn this;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'rgba':\n\n\t\t\t\t\tif ( color = /^(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*([0-9]*\\.?[0-9]+)\\s*$/.exec( components ) ) {\n\n\t\t\t\t\t\t// rgba(255,0,0,0.5)\n\t\t\t\t\t\tthis.r = Math.min( 255, parseInt( color[ 1 ], 10 ) ) / 255;\n\t\t\t\t\t\tthis.g = Math.min( 255, parseInt( color[ 2 ], 10 ) ) / 255;\n\t\t\t\t\t\tthis.b = Math.min( 255, parseInt( color[ 3 ], 10 ) ) / 255;\n\t\t\t\t\t\tparseAlpha( color[ 4 ] );\n\n\t\t\t\t\t\treturn this;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( color = /^(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*,\\s*([0-9]*\\.?[0-9]+)\\s*$/.exec( components ) ) {\n\n\t\t\t\t\t\t// rgba(100%,0%,0%,0.5)\n\t\t\t\t\t\tthis.r = Math.min( 100, parseInt( color[ 1 ], 10 ) ) / 100;\n\t\t\t\t\t\tthis.g = Math.min( 100, parseInt( color[ 2 ], 10 ) ) / 100;\n\t\t\t\t\t\tthis.b = Math.min( 100, parseInt( color[ 3 ], 10 ) ) / 100;\n\t\t\t\t\t\tparseAlpha( color[ 4 ] );\n\n\t\t\t\t\t\treturn this;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'hsl':\n\n\t\t\t\t\tif ( color = /^([0-9]*\\.?[0-9]+)\\s*,\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*$/.exec( components ) ) {\n\n\t\t\t\t\t\t// hsl(120,50%,50%)\n\t\t\t\t\t\tvar h = parseFloat( color[ 1 ] );\n\t\t\t\t\t\tvar s = parseInt( color[ 2 ], 10 ) / 100;\n\t\t\t\t\t\tvar l = parseInt( color[ 3 ], 10 ) / 100;\n\n\t\t\t\t\t\treturn this.setHSL( h, s, l );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'hsla':\n\n\t\t\t\t\tif ( color = /^([0-9]*\\.?[0-9]+)\\s*,\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*,\\s*([0-9]*\\.?[0-9]+)\\s*$/.exec( components ) ) {\n\n\t\t\t\t\t\t// hsla(120,50%,50%,0.5)\n\t\t\t\t\t\tvar h = parseFloat( color[ 1 ] );\n\t\t\t\t\t\tvar s = parseInt( color[ 2 ], 10 ) / 100;\n\t\t\t\t\t\tvar l = parseInt( color[ 3 ], 10 ) / 100;\n\t\t\t\t\t\tparseAlpha( color[ 4 ] );\n\n\t\t\t\t\t\treturn this.setHSL( h, s, l );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t} else if ( m = /^\\#([A-Fa-f0-9]+)$/.exec( style ) ) {\n\n\t\t\t// hex color\n\n\t\t\tvar hex = m[ 1 ];\n\t\t\tvar size = hex.length;\n\n\t\t\tif ( size === 3 ) {\n\n\t\t\t\t// #ff0\n\t\t\t\tthis.r = parseInt( hex.charAt( 0 ) + hex.charAt( 0 ), 16 ) / 255;\n\t\t\t\tthis.g = parseInt( hex.charAt( 1 ) + hex.charAt( 1 ), 16 ) / 255;\n\t\t\t\tthis.b = parseInt( hex.charAt( 2 ) + hex.charAt( 2 ), 16 ) / 255;\n\n\t\t\t\treturn this;\n\n\t\t\t} else if ( size === 6 ) {\n\n\t\t\t\t// #ff0000\n\t\t\t\tthis.r = parseInt( hex.charAt( 0 ) + hex.charAt( 1 ), 16 ) / 255;\n\t\t\t\tthis.g = parseInt( hex.charAt( 2 ) + hex.charAt( 3 ), 16 ) / 255;\n\t\t\t\tthis.b = parseInt( hex.charAt( 4 ) + hex.charAt( 5 ), 16 ) / 255;\n\n\t\t\t\treturn this;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( style && style.length > 0 ) {\n\n\t\t\t// color keywords\n\t\t\tvar hex = THREE.ColorKeywords[ style ];\n\n\t\t\tif ( hex !== undefined ) {\n\n\t\t\t\t// red\n\t\t\t\tthis.setHex( hex );\n\n\t\t\t} else {\n\n\t\t\t\t// unknown color\n\t\t\t\tconsole.warn( 'THREE.Color: Unknown color ' + style );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tclone: function () {\n\n\t\treturn new this.constructor( this.r, this.g, this.b );\n\n\t},\n\n\tcopy: function ( color ) {\n\n\t\tthis.r = color.r;\n\t\tthis.g = color.g;\n\t\tthis.b = color.b;\n\n\t\treturn this;\n\n\t},\n\n\tcopyGammaToLinear: function ( color, gammaFactor ) {\n\n\t\tif ( gammaFactor === undefined ) gammaFactor = 2.0;\n\n\t\tthis.r = Math.pow( color.r, gammaFactor );\n\t\tthis.g = Math.pow( color.g, gammaFactor );\n\t\tthis.b = Math.pow( color.b, gammaFactor );\n\n\t\treturn this;\n\n\t},\n\n\tcopyLinearToGamma: function ( color, gammaFactor ) {\n\n\t\tif ( gammaFactor === undefined ) gammaFactor = 2.0;\n\n\t\tvar safeInverse = ( gammaFactor > 0 ) ? ( 1.0 / gammaFactor ) : 1.0;\n\n\t\tthis.r = Math.pow( color.r, safeInverse );\n\t\tthis.g = Math.pow( color.g, safeInverse );\n\t\tthis.b = Math.pow( color.b, safeInverse );\n\n\t\treturn this;\n\n\t},\n\n\tconvertGammaToLinear: function () {\n\n\t\tvar r = this.r, g = this.g, b = this.b;\n\n\t\tthis.r = r * r;\n\t\tthis.g = g * g;\n\t\tthis.b = b * b;\n\n\t\treturn this;\n\n\t},\n\n\tconvertLinearToGamma: function () {\n\n\t\tthis.r = Math.sqrt( this.r );\n\t\tthis.g = Math.sqrt( this.g );\n\t\tthis.b = Math.sqrt( this.b );\n\n\t\treturn this;\n\n\t},\n\n\tgetHex: function () {\n\n\t\treturn ( this.r * 255 ) << 16 ^ ( this.g * 255 ) << 8 ^ ( this.b * 255 ) << 0;\n\n\t},\n\n\tgetHexString: function () {\n\n\t\treturn ( '000000' + this.getHex().toString( 16 ) ).slice( - 6 );\n\n\t},\n\n\tgetHSL: function ( optionalTarget ) {\n\n\t\t// h,s,l ranges are in 0.0 - 1.0\n\n\t\tvar hsl = optionalTarget || { h: 0, s: 0, l: 0 };\n\n\t\tvar r = this.r, g = this.g, b = this.b;\n\n\t\tvar max = Math.max( r, g, b );\n\t\tvar min = Math.min( r, g, b );\n\n\t\tvar hue, saturation;\n\t\tvar lightness = ( min + max ) / 2.0;\n\n\t\tif ( min === max ) {\n\n\t\t\thue = 0;\n\t\t\tsaturation = 0;\n\n\t\t} else {\n\n\t\t\tvar delta = max - min;\n\n\t\t\tsaturation = lightness <= 0.5 ? delta / ( max + min ) : delta / ( 2 - max - min );\n\n\t\t\tswitch ( max ) {\n\n\t\t\t\tcase r: hue = ( g - b ) / delta + ( g < b ? 6 : 0 ); break;\n\t\t\t\tcase g: hue = ( b - r ) / delta + 2; break;\n\t\t\t\tcase b: hue = ( r - g ) / delta + 4; break;\n\n\t\t\t}\n\n\t\t\thue /= 6;\n\n\t\t}\n\n\t\thsl.h = hue;\n\t\thsl.s = saturation;\n\t\thsl.l = lightness;\n\n\t\treturn hsl;\n\n\t},\n\n\tgetStyle: function () {\n\n\t\treturn 'rgb(' + ( ( this.r * 255 ) | 0 ) + ',' + ( ( this.g * 255 ) | 0 ) + ',' + ( ( this.b * 255 ) | 0 ) + ')';\n\n\t},\n\n\toffsetHSL: function ( h, s, l ) {\n\n\t\tvar hsl = this.getHSL();\n\n\t\thsl.h += h; hsl.s += s; hsl.l += l;\n\n\t\tthis.setHSL( hsl.h, hsl.s, hsl.l );\n\n\t\treturn this;\n\n\t},\n\n\tadd: function ( color ) {\n\n\t\tthis.r += color.r;\n\t\tthis.g += color.g;\n\t\tthis.b += color.b;\n\n\t\treturn this;\n\n\t},\n\n\taddColors: function ( color1, color2 ) {\n\n\t\tthis.r = color1.r + color2.r;\n\t\tthis.g = color1.g + color2.g;\n\t\tthis.b = color1.b + color2.b;\n\n\t\treturn this;\n\n\t},\n\n\taddScalar: function ( s ) {\n\n\t\tthis.r += s;\n\t\tthis.g += s;\n\t\tthis.b += s;\n\n\t\treturn this;\n\n\t},\n\n\tmultiply: function ( color ) {\n\n\t\tthis.r *= color.r;\n\t\tthis.g *= color.g;\n\t\tthis.b *= color.b;\n\n\t\treturn this;\n\n\t},\n\n\tmultiplyScalar: function ( s ) {\n\n\t\tthis.r *= s;\n\t\tthis.g *= s;\n\t\tthis.b *= s;\n\n\t\treturn this;\n\n\t},\n\n\tlerp: function ( color, alpha ) {\n\n\t\tthis.r += ( color.r - this.r ) * alpha;\n\t\tthis.g += ( color.g - this.g ) * alpha;\n\t\tthis.b += ( color.b - this.b ) * alpha;\n\n\t\treturn this;\n\n\t},\n\n\tequals: function ( c ) {\n\n\t\treturn ( c.r === this.r ) && ( c.g === this.g ) && ( c.b === this.b );\n\n\t},\n\n\tfromArray: function ( array ) {\n\n\t\tthis.r = array[ 0 ];\n\t\tthis.g = array[ 1 ];\n\t\tthis.b = array[ 2 ];\n\n\t\treturn this;\n\n\t},\n\n\ttoArray: function ( array, offset ) {\n\n\t\tif ( array === undefined ) array = [];\n\t\tif ( offset === undefined ) offset = 0;\n\n\t\tarray[ offset ] = this.r;\n\t\tarray[ offset + 1 ] = this.g;\n\t\tarray[ offset + 2 ] = this.b;\n\n\t\treturn array;\n\n\t}\n\n};\n\nTHREE.ColorKeywords = { 'aliceblue': 0xF0F8FF, 'antiquewhite': 0xFAEBD7, 'aqua': 0x00FFFF, 'aquamarine': 0x7FFFD4, 'azure': 0xF0FFFF,\n'beige': 0xF5F5DC, 'bisque': 0xFFE4C4, 'black': 0x000000, 'blanchedalmond': 0xFFEBCD, 'blue': 0x0000FF, 'blueviolet': 0x8A2BE2,\n'brown': 0xA52A2A, 'burlywood': 0xDEB887, 'cadetblue': 0x5F9EA0, 'chartreuse': 0x7FFF00, 'chocolate': 0xD2691E, 'coral': 0xFF7F50,\n'cornflowerblue': 0x6495ED, 'cornsilk': 0xFFF8DC, 'crimson': 0xDC143C, 'cyan': 0x00FFFF, 'darkblue': 0x00008B, 'darkcyan': 0x008B8B,\n'darkgoldenrod': 0xB8860B, 'darkgray': 0xA9A9A9, 'darkgreen': 0x006400, 'darkgrey': 0xA9A9A9, 'darkkhaki': 0xBDB76B, 'darkmagenta': 0x8B008B,\n'darkolivegreen': 0x556B2F, 'darkorange': 0xFF8C00, 'darkorchid': 0x9932CC, 'darkred': 0x8B0000, 'darksalmon': 0xE9967A, 'darkseagreen': 0x8FBC8F,\n'darkslateblue': 0x483D8B, 'darkslategray': 0x2F4F4F, 'darkslategrey': 0x2F4F4F, 'darkturquoise': 0x00CED1, 'darkviolet': 0x9400D3,\n'deeppink': 0xFF1493, 'deepskyblue': 0x00BFFF, 'dimgray': 0x696969, 'dimgrey': 0x696969, 'dodgerblue': 0x1E90FF, 'firebrick': 0xB22222,\n'floralwhite': 0xFFFAF0, 'forestgreen': 0x228B22, 'fuchsia': 0xFF00FF, 'gainsboro': 0xDCDCDC, 'ghostwhite': 0xF8F8FF, 'gold': 0xFFD700,\n'goldenrod': 0xDAA520, 'gray': 0x808080, 'green': 0x008000, 'greenyellow': 0xADFF2F, 'grey': 0x808080, 'honeydew': 0xF0FFF0, 'hotpink': 0xFF69B4,\n'indianred': 0xCD5C5C, 'indigo': 0x4B0082, 'ivory': 0xFFFFF0, 'khaki': 0xF0E68C, 'lavender': 0xE6E6FA, 'lavenderblush': 0xFFF0F5, 'lawngreen': 0x7CFC00,\n'lemonchiffon': 0xFFFACD, 'lightblue': 0xADD8E6, 'lightcoral': 0xF08080, 'lightcyan': 0xE0FFFF, 'lightgoldenrodyellow': 0xFAFAD2, 'lightgray': 0xD3D3D3,\n'lightgreen': 0x90EE90, 'lightgrey': 0xD3D3D3, 'lightpink': 0xFFB6C1, 'lightsalmon': 0xFFA07A, 'lightseagreen': 0x20B2AA, 'lightskyblue': 0x87CEFA,\n'lightslategray': 0x778899, 'lightslategrey': 0x778899, 'lightsteelblue': 0xB0C4DE, 'lightyellow': 0xFFFFE0, 'lime': 0x00FF00, 'limegreen': 0x32CD32,\n'linen': 0xFAF0E6, 'magenta': 0xFF00FF, 'maroon': 0x800000, 'mediumaquamarine': 0x66CDAA, 'mediumblue': 0x0000CD, 'mediumorchid': 0xBA55D3,\n'mediumpurple': 0x9370DB, 'mediumseagreen': 0x3CB371, 'mediumslateblue': 0x7B68EE, 'mediumspringgreen': 0x00FA9A, 'mediumturquoise': 0x48D1CC,\n'mediumvioletred': 0xC71585, 'midnightblue': 0x191970, 'mintcream': 0xF5FFFA, 'mistyrose': 0xFFE4E1, 'moccasin': 0xFFE4B5, 'navajowhite': 0xFFDEAD,\n'navy': 0x000080, 'oldlace': 0xFDF5E6, 'olive': 0x808000, 'olivedrab': 0x6B8E23, 'orange': 0xFFA500, 'orangered': 0xFF4500, 'orchid': 0xDA70D6,\n'palegoldenrod': 0xEEE8AA, 'palegreen': 0x98FB98, 'paleturquoise': 0xAFEEEE, 'palevioletred': 0xDB7093, 'papayawhip': 0xFFEFD5, 'peachpuff': 0xFFDAB9,\n'peru': 0xCD853F, 'pink': 0xFFC0CB, 'plum': 0xDDA0DD, 'powderblue': 0xB0E0E6, 'purple': 0x800080, 'red': 0xFF0000, 'rosybrown': 0xBC8F8F,\n'royalblue': 0x4169E1, 'saddlebrown': 0x8B4513, 'salmon': 0xFA8072, 'sandybrown': 0xF4A460, 'seagreen': 0x2E8B57, 'seashell': 0xFFF5EE,\n'sienna': 0xA0522D, 'silver': 0xC0C0C0, 'skyblue': 0x87CEEB, 'slateblue': 0x6A5ACD, 'slategray': 0x708090, 'slategrey': 0x708090, 'snow': 0xFFFAFA,\n'springgreen': 0x00FF7F, 'steelblue': 0x4682B4, 'tan': 0xD2B48C, 'teal': 0x008080, 'thistle': 0xD8BFD8, 'tomato': 0xFF6347, 'turquoise': 0x40E0D0,\n'violet': 0xEE82EE, 'wheat': 0xF5DEB3, 'white': 0xFFFFFF, 'whitesmoke': 0xF5F5F5, 'yellow': 0xFFFF00, 'yellowgreen': 0x9ACD32 };\n\n// File:src/math/Quaternion.js\n\n/**\n * @author mikael emtinger / http://gomo.se/\n * @author alteredq / http://alteredqualia.com/\n * @author WestLangley / http://github.com/WestLangley\n * @author bhouston / http://exocortex.com\n */\n\nTHREE.Quaternion = function ( x, y, z, w ) {\n\n\tthis._x = x || 0;\n\tthis._y = y || 0;\n\tthis._z = z || 0;\n\tthis._w = ( w !== undefined ) ? w : 1;\n\n};\n\nTHREE.Quaternion.prototype = {\n\n\tconstructor: THREE.Quaternion,\n\n\tget x () {\n\n\t\treturn this._x;\n\n\t},\n\n\tset x ( value ) {\n\n\t\tthis._x = value;\n\t\tthis.onChangeCallback();\n\n\t},\n\n\tget y () {\n\n\t\treturn this._y;\n\n\t},\n\n\tset y ( value ) {\n\n\t\tthis._y = value;\n\t\tthis.onChangeCallback();\n\n\t},\n\n\tget z () {\n\n\t\treturn this._z;\n\n\t},\n\n\tset z ( value ) {\n\n\t\tthis._z = value;\n\t\tthis.onChangeCallback();\n\n\t},\n\n\tget w () {\n\n\t\treturn this._w;\n\n\t},\n\n\tset w ( value ) {\n\n\t\tthis._w = value;\n\t\tthis.onChangeCallback();\n\n\t},\n\n\tset: function ( x, y, z, w ) {\n\n\t\tthis._x = x;\n\t\tthis._y = y;\n\t\tthis._z = z;\n\t\tthis._w = w;\n\n\t\tthis.onChangeCallback();\n\n\t\treturn this;\n\n\t},\n\n\tclone: function () {\n\n\t\treturn new this.constructor( this._x, this._y, this._z, this._w );\n\n\t},\n\n\tcopy: function ( quaternion ) {\n\n\t\tthis._x = quaternion.x;\n\t\tthis._y = quaternion.y;\n\t\tthis._z = quaternion.z;\n\t\tthis._w = quaternion.w;\n\n\t\tthis.onChangeCallback();\n\n\t\treturn this;\n\n\t},\n\n\tsetFromEuler: function ( euler, update ) {\n\n\t\tif ( euler instanceof THREE.Euler === false ) {\n\n\t\t\tthrow new Error( 'THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.' );\n\n\t\t}\n\n\t\t// http://www.mathworks.com/matlabcentral/fileexchange/\n\t\t// \t20696-function-to-convert-between-dcm-euler-angles-quaternions-and-euler-vectors/\n\t\t//\tcontent/SpinCalc.m\n\n\t\tvar c1 = Math.cos( euler._x / 2 );\n\t\tvar c2 = Math.cos( euler._y / 2 );\n\t\tvar c3 = Math.cos( euler._z / 2 );\n\t\tvar s1 = Math.sin( euler._x / 2 );\n\t\tvar s2 = Math.sin( euler._y / 2 );\n\t\tvar s3 = Math.sin( euler._z / 2 );\n\n\t\tvar order = euler.order;\n\n\t\tif ( order === 'XYZ' ) {\n\n\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\n\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\n\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\n\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\n\n\t\t} else if ( order === 'YXZ' ) {\n\n\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\n\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\n\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\n\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\n\n\t\t} else if ( order === 'ZXY' ) {\n\n\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\n\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\n\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\n\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\n\n\t\t} else if ( order === 'ZYX' ) {\n\n\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\n\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\n\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\n\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\n\n\t\t} else if ( order === 'YZX' ) {\n\n\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\n\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\n\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\n\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\n\n\t\t} else if ( order === 'XZY' ) {\n\n\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\n\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\n\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\n\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\n\n\t\t}\n\n\t\tif ( update !== false ) this.onChangeCallback();\n\n\t\treturn this;\n\n\t},\n\n\tsetFromAxisAngle: function ( axis, angle ) {\n\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/angleToQuaternion/index.htm\n\n\t\t// assumes axis is normalized\n\n\t\tvar halfAngle = angle / 2, s = Math.sin( halfAngle );\n\n\t\tthis._x = axis.x * s;\n\t\tthis._y = axis.y * s;\n\t\tthis._z = axis.z * s;\n\t\tthis._w = Math.cos( halfAngle );\n\n\t\tthis.onChangeCallback();\n\n\t\treturn this;\n\n\t},\n\n\tsetFromRotationMatrix: function ( m ) {\n\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToQuaternion/index.htm\n\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n\n\t\tvar te = m.elements,\n\n\t\t\tm11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ],\n\t\t\tm21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ],\n\t\t\tm31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ],\n\n\t\t\ttrace = m11 + m22 + m33,\n\t\t\ts;\n\n\t\tif ( trace > 0 ) {\n\n\t\t\ts = 0.5 / Math.sqrt( trace + 1.0 );\n\n\t\t\tthis._w = 0.25 / s;\n\t\t\tthis._x = ( m32 - m23 ) * s;\n\t\t\tthis._y = ( m13 - m31 ) * s;\n\t\t\tthis._z = ( m21 - m12 ) * s;\n\n\t\t} else if ( m11 > m22 && m11 > m33 ) {\n\n\t\t\ts = 2.0 * Math.sqrt( 1.0 + m11 - m22 - m33 );\n\n\t\t\tthis._w = ( m32 - m23 ) / s;\n\t\t\tthis._x = 0.25 * s;\n\t\t\tthis._y = ( m12 + m21 ) / s;\n\t\t\tthis._z = ( m13 + m31 ) / s;\n\n\t\t} else if ( m22 > m33 ) {\n\n\t\t\ts = 2.0 * Math.sqrt( 1.0 + m22 - m11 - m33 );\n\n\t\t\tthis._w = ( m13 - m31 ) / s;\n\t\t\tthis._x = ( m12 + m21 ) / s;\n\t\t\tthis._y = 0.25 * s;\n\t\t\tthis._z = ( m23 + m32 ) / s;\n\n\t\t} else {\n\n\t\t\ts = 2.0 * Math.sqrt( 1.0 + m33 - m11 - m22 );\n\n\t\t\tthis._w = ( m21 - m12 ) / s;\n\t\t\tthis._x = ( m13 + m31 ) / s;\n\t\t\tthis._y = ( m23 + m32 ) / s;\n\t\t\tthis._z = 0.25 * s;\n\n\t\t}\n\n\t\tthis.onChangeCallback();\n\n\t\treturn this;\n\n\t},\n\n\tsetFromUnitVectors: function () {\n\n\t\t// http://lolengine.net/blog/2014/02/24/quaternion-from-two-vectors-final\n\n\t\t// assumes direction vectors vFrom and vTo are normalized\n\n\t\tvar v1, r;\n\n\t\tvar EPS = 0.000001;\n\n\t\treturn function ( vFrom, vTo ) {\n\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\n\n\t\t\tr = vFrom.dot( vTo ) + 1;\n\n\t\t\tif ( r < EPS ) {\n\n\t\t\t\tr = 0;\n\n\t\t\t\tif ( Math.abs( vFrom.x ) > Math.abs( vFrom.z ) ) {\n\n\t\t\t\t\tv1.set( - vFrom.y, vFrom.x, 0 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tv1.set( 0, - vFrom.z, vFrom.y );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tv1.crossVectors( vFrom, vTo );\n\n\t\t\t}\n\n\t\t\tthis._x = v1.x;\n\t\t\tthis._y = v1.y;\n\t\t\tthis._z = v1.z;\n\t\t\tthis._w = r;\n\n\t\t\tthis.normalize();\n\n\t\t\treturn this;\n\n\t\t}\n\n\t}(),\n\n\tinverse: function () {\n\n\t\tthis.conjugate().normalize();\n\n\t\treturn this;\n\n\t},\n\n\tconjugate: function () {\n\n\t\tthis._x *= - 1;\n\t\tthis._y *= - 1;\n\t\tthis._z *= - 1;\n\n\t\tthis.onChangeCallback();\n\n\t\treturn this;\n\n\t},\n\n\tdot: function ( v ) {\n\n\t\treturn this._x * v._x + this._y * v._y + this._z * v._z + this._w * v._w;\n\n\t},\n\n\tlengthSq: function () {\n\n\t\treturn this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w;\n\n\t},\n\n\tlength: function () {\n\n\t\treturn Math.sqrt( this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w );\n\n\t},\n\n\tnormalize: function () {\n\n\t\tvar l = this.length();\n\n\t\tif ( l === 0 ) {\n\n\t\t\tthis._x = 0;\n\t\t\tthis._y = 0;\n\t\t\tthis._z = 0;\n\t\t\tthis._w = 1;\n\n\t\t} else {\n\n\t\t\tl = 1 / l;\n\n\t\t\tthis._x = this._x * l;\n\t\t\tthis._y = this._y * l;\n\t\t\tthis._z = this._z * l;\n\t\t\tthis._w = this._w * l;\n\n\t\t}\n\n\t\tthis.onChangeCallback();\n\n\t\treturn this;\n\n\t},\n\n\tmultiply: function ( q, p ) {\n\n\t\tif ( p !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead.' );\n\t\t\treturn this.multiplyQuaternions( q, p );\n\n\t\t}\n\n\t\treturn this.multiplyQuaternions( this, q );\n\n\t},\n\n\tmultiplyQuaternions: function ( a, b ) {\n\n\t\t// from http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/code/index.htm\n\n\t\tvar qax = a._x, qay = a._y, qaz = a._z, qaw = a._w;\n\t\tvar qbx = b._x, qby = b._y, qbz = b._z, qbw = b._w;\n\n\t\tthis._x = qax * qbw + qaw * qbx + qay * qbz - qaz * qby;\n\t\tthis._y = qay * qbw + qaw * qby + qaz * qbx - qax * qbz;\n\t\tthis._z = qaz * qbw + qaw * qbz + qax * qby - qay * qbx;\n\t\tthis._w = qaw * qbw - qax * qbx - qay * qby - qaz * qbz;\n\n\t\tthis.onChangeCallback();\n\n\t\treturn this;\n\n\t},\n\n\tmultiplyVector3: function ( vector ) {\n\n\t\tconsole.warn( 'THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.' );\n\t\treturn vector.applyQuaternion( this );\n\n\t},\n\n\tslerp: function ( qb, t ) {\n\n\t\tif ( t === 0 ) return this;\n\t\tif ( t === 1 ) return this.copy( qb );\n\n\t\tvar x = this._x, y = this._y, z = this._z, w = this._w;\n\n\t\t// http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/slerp/\n\n\t\tvar cosHalfTheta = w * qb._w + x * qb._x + y * qb._y + z * qb._z;\n\n\t\tif ( cosHalfTheta < 0 ) {\n\n\t\t\tthis._w = - qb._w;\n\t\t\tthis._x = - qb._x;\n\t\t\tthis._y = - qb._y;\n\t\t\tthis._z = - qb._z;\n\n\t\t\tcosHalfTheta = - cosHalfTheta;\n\n\t\t} else {\n\n\t\t\tthis.copy( qb );\n\n\t\t}\n\n\t\tif ( cosHalfTheta >= 1.0 ) {\n\n\t\t\tthis._w = w;\n\t\t\tthis._x = x;\n\t\t\tthis._y = y;\n\t\t\tthis._z = z;\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tvar halfTheta = Math.acos( cosHalfTheta );\n\t\tvar sinHalfTheta = Math.sqrt( 1.0 - cosHalfTheta * cosHalfTheta );\n\n\t\tif ( Math.abs( sinHalfTheta ) < 0.001 ) {\n\n\t\t\tthis._w = 0.5 * ( w + this._w );\n\t\t\tthis._x = 0.5 * ( x + this._x );\n\t\t\tthis._y = 0.5 * ( y + this._y );\n\t\t\tthis._z = 0.5 * ( z + this._z );\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tvar ratioA = Math.sin( ( 1 - t ) * halfTheta ) / sinHalfTheta,\n\t\tratioB = Math.sin( t * halfTheta ) / sinHalfTheta;\n\n\t\tthis._w = ( w * ratioA + this._w * ratioB );\n\t\tthis._x = ( x * ratioA + this._x * ratioB );\n\t\tthis._y = ( y * ratioA + this._y * ratioB );\n\t\tthis._z = ( z * ratioA + this._z * ratioB );\n\n\t\tthis.onChangeCallback();\n\n\t\treturn this;\n\n\t},\n\n\tequals: function ( quaternion ) {\n\n\t\treturn ( quaternion._x === this._x ) && ( quaternion._y === this._y ) && ( quaternion._z === this._z ) && ( quaternion._w === this._w );\n\n\t},\n\n\tfromArray: function ( array, offset ) {\n\n\t\tif ( offset === undefined ) offset = 0;\n\n\t\tthis._x = array[ offset ];\n\t\tthis._y = array[ offset + 1 ];\n\t\tthis._z = array[ offset + 2 ];\n\t\tthis._w = array[ offset + 3 ];\n\n\t\tthis.onChangeCallback();\n\n\t\treturn this;\n\n\t},\n\n\ttoArray: function ( array, offset ) {\n\n\t\tif ( array === undefined ) array = [];\n\t\tif ( offset === undefined ) offset = 0;\n\n\t\tarray[ offset ] = this._x;\n\t\tarray[ offset + 1 ] = this._y;\n\t\tarray[ offset + 2 ] = this._z;\n\t\tarray[ offset + 3 ] = this._w;\n\n\t\treturn array;\n\n\t},\n\n\tonChange: function ( callback ) {\n\n\t\tthis.onChangeCallback = callback;\n\n\t\treturn this;\n\n\t},\n\n\tonChangeCallback: function () {}\n\n};\n\nTHREE.Quaternion.slerp = function ( qa, qb, qm, t ) {\n\n\treturn qm.copy( qa ).slerp( qb, t );\n\n};\n\n// File:src/math/Vector2.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n * @author philogb / http://blog.thejit.org/\n * @author egraether / http://egraether.com/\n * @author zz85 / http://www.lab4games.net/zz85/blog\n */\n\nTHREE.Vector2 = function ( x, y ) {\n\n\tthis.x = x || 0;\n\tthis.y = y || 0;\n\n};\n\nTHREE.Vector2.prototype = {\n\n\tconstructor: THREE.Vector2,\n\n\tset: function ( x, y ) {\n\n\t\tthis.x = x;\n\t\tthis.y = y;\n\n\t\treturn this;\n\n\t},\n\n\tsetX: function ( x ) {\n\n\t\tthis.x = x;\n\n\t\treturn this;\n\n\t},\n\n\tsetY: function ( y ) {\n\n\t\tthis.y = y;\n\n\t\treturn this;\n\n\t},\n\n\tsetComponent: function ( index, value ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: this.x = value; break;\n\t\t\tcase 1: this.y = value; break;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t},\n\n\tgetComponent: function ( index ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: return this.x;\n\t\t\tcase 1: return this.y;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t},\n\n\tclone: function () {\n\n\t\treturn new this.constructor( this.x, this.y );\n\n\t},\n\n\tcopy: function ( v ) {\n\n\t\tthis.x = v.x;\n\t\tthis.y = v.y;\n\n\t\treturn this;\n\n\t},\n\n\tadd: function ( v, w ) {\n\n\t\tif ( w !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead.' );\n\t\t\treturn this.addVectors( v, w );\n\n\t\t}\n\n\t\tthis.x += v.x;\n\t\tthis.y += v.y;\n\n\t\treturn this;\n\n\t},\n\n\taddScalar: function ( s ) {\n\n\t\tthis.x += s;\n\t\tthis.y += s;\n\n\t\treturn this;\n\n\t},\n\n\taddVectors: function ( a, b ) {\n\n\t\tthis.x = a.x + b.x;\n\t\tthis.y = a.y + b.y;\n\n\t\treturn this;\n\n\t},\n\n\taddScaledVector: function ( v, s ) {\n\n\t\tthis.x += v.x * s;\n\t\tthis.y += v.y * s;\n\n\t\treturn this;\n\n\t},\n\n\tsub: function ( v, w ) {\n\n\t\tif ( w !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.' );\n\t\t\treturn this.subVectors( v, w );\n\n\t\t}\n\n\t\tthis.x -= v.x;\n\t\tthis.y -= v.y;\n\n\t\treturn this;\n\n\t},\n\n\tsubScalar: function ( s ) {\n\n\t\tthis.x -= s;\n\t\tthis.y -= s;\n\n\t\treturn this;\n\n\t},\n\n\tsubVectors: function ( a, b ) {\n\n\t\tthis.x = a.x - b.x;\n\t\tthis.y = a.y - b.y;\n\n\t\treturn this;\n\n\t},\n\n\tmultiply: function ( v ) {\n\n\t\tthis.x *= v.x;\n\t\tthis.y *= v.y;\n\n\t\treturn this;\n\n\t},\n\n\tmultiplyScalar: function ( s ) {\n\n\t\tthis.x *= s;\n\t\tthis.y *= s;\n\n\t\treturn this;\n\n\t},\n\n\tdivide: function ( v ) {\n\n\t\tthis.x /= v.x;\n\t\tthis.y /= v.y;\n\n\t\treturn this;\n\n\t},\n\n\tdivideScalar: function ( scalar ) {\n\n\t\tif ( scalar !== 0 ) {\n\n\t\t\tvar invScalar = 1 / scalar;\n\n\t\t\tthis.x *= invScalar;\n\t\t\tthis.y *= invScalar;\n\n\t\t} else {\n\n\t\t\tthis.x = 0;\n\t\t\tthis.y = 0;\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tmin: function ( v ) {\n\n\t\tif ( this.x > v.x ) {\n\n\t\t\tthis.x = v.x;\n\n\t\t}\n\n\t\tif ( this.y > v.y ) {\n\n\t\t\tthis.y = v.y;\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tmax: function ( v ) {\n\n\t\tif ( this.x < v.x ) {\n\n\t\t\tthis.x = v.x;\n\n\t\t}\n\n\t\tif ( this.y < v.y ) {\n\n\t\t\tthis.y = v.y;\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tclamp: function ( min, max ) {\n\n\t\t// This function assumes min < max, if this assumption isn't true it will not operate correctly\n\n\t\tif ( this.x < min.x ) {\n\n\t\t\tthis.x = min.x;\n\n\t\t} else if ( this.x > max.x ) {\n\n\t\t\tthis.x = max.x;\n\n\t\t}\n\n\t\tif ( this.y < min.y ) {\n\n\t\t\tthis.y = min.y;\n\n\t\t} else if ( this.y > max.y ) {\n\n\t\t\tthis.y = max.y;\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tclampScalar: function () {\n\n\t\tvar min, max;\n\n\t\treturn function clampScalar( minVal, maxVal ) {\n\n\t\t\tif ( min === undefined ) {\n\n\t\t\t\tmin = new THREE.Vector2();\n\t\t\t\tmax = new THREE.Vector2();\n\n\t\t\t}\n\n\t\t\tmin.set( minVal, minVal );\n\t\t\tmax.set( maxVal, maxVal );\n\n\t\t\treturn this.clamp( min, max );\n\n\t\t};\n\n\t}(),\n\n\tfloor: function () {\n\n\t\tthis.x = Math.floor( this.x );\n\t\tthis.y = Math.floor( this.y );\n\n\t\treturn this;\n\n\t},\n\n\tceil: function () {\n\n\t\tthis.x = Math.ceil( this.x );\n\t\tthis.y = Math.ceil( this.y );\n\n\t\treturn this;\n\n\t},\n\n\tround: function () {\n\n\t\tthis.x = Math.round( this.x );\n\t\tthis.y = Math.round( this.y );\n\n\t\treturn this;\n\n\t},\n\n\troundToZero: function () {\n\n\t\tthis.x = ( this.x < 0 ) ? Math.ceil( this.x ) : Math.floor( this.x );\n\t\tthis.y = ( this.y < 0 ) ? Math.ceil( this.y ) : Math.floor( this.y );\n\n\t\treturn this;\n\n\t},\n\n\tnegate: function () {\n\n\t\tthis.x = - this.x;\n\t\tthis.y = - this.y;\n\n\t\treturn this;\n\n\t},\n\n\tdot: function ( v ) {\n\n\t\treturn this.x * v.x + this.y * v.y;\n\n\t},\n\n\tlengthSq: function () {\n\n\t\treturn this.x * this.x + this.y * this.y;\n\n\t},\n\n\tlength: function () {\n\n\t\treturn Math.sqrt( this.x * this.x + this.y * this.y );\n\n\t},\n\n\tlengthManhattan: function() {\n\n\t\treturn Math.abs( this.x ) + Math.abs( this.y );\n\n\t},\n\n\tnormalize: function () {\n\n\t\treturn this.divideScalar( this.length() );\n\n\t},\n\n\tdistanceTo: function ( v ) {\n\n\t\treturn Math.sqrt( this.distanceToSquared( v ) );\n\n\t},\n\n\tdistanceToSquared: function ( v ) {\n\n\t\tvar dx = this.x - v.x, dy = this.y - v.y;\n\t\treturn dx * dx + dy * dy;\n\n\t},\n\n\tsetLength: function ( l ) {\n\n\t\tvar oldLength = this.length();\n\n\t\tif ( oldLength !== 0 && l !== oldLength ) {\n\n\t\t\tthis.multiplyScalar( l / oldLength );\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tlerp: function ( v, alpha ) {\n\n\t\tthis.x += ( v.x - this.x ) * alpha;\n\t\tthis.y += ( v.y - this.y ) * alpha;\n\n\t\treturn this;\n\n\t},\n\n\tlerpVectors: function ( v1, v2, alpha ) {\n\n\t\tthis.subVectors( v2, v1 ).multiplyScalar( alpha ).add( v1 );\n\n\t\treturn this;\n\n\t},\n\n\tequals: function ( v ) {\n\n\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) );\n\n\t},\n\n\tfromArray: function ( array, offset ) {\n\n\t\tif ( offset === undefined ) offset = 0;\n\n\t\tthis.x = array[ offset ];\n\t\tthis.y = array[ offset + 1 ];\n\n\t\treturn this;\n\n\t},\n\n\ttoArray: function ( array, offset ) {\n\n\t\tif ( array === undefined ) array = [];\n\t\tif ( offset === undefined ) offset = 0;\n\n\t\tarray[ offset ] = this.x;\n\t\tarray[ offset + 1 ] = this.y;\n\n\t\treturn array;\n\n\t},\n\n\tfromAttribute: function ( attribute, index, offset ) {\n\n\t\tif ( offset === undefined ) offset = 0;\n\n\t\tindex = index * attribute.itemSize + offset;\n\n\t\tthis.x = attribute.array[ index ];\n\t\tthis.y = attribute.array[ index + 1 ];\n\n\t\treturn this;\n\n\t}\n\n};\n\n// File:src/math/Vector3.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n * @author *kile / http://kile.stravaganza.org/\n * @author philogb / http://blog.thejit.org/\n * @author mikael emtinger / http://gomo.se/\n * @author egraether / http://egraether.com/\n * @author WestLangley / http://github.com/WestLangley\n */\n\nTHREE.Vector3 = function ( x, y, z ) {\n\n\tthis.x = x || 0;\n\tthis.y = y || 0;\n\tthis.z = z || 0;\n\n};\n\nTHREE.Vector3.prototype = {\n\n\tconstructor: THREE.Vector3,\n\n\tset: function ( x, y, z ) {\n\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.z = z;\n\n\t\treturn this;\n\n\t},\n\n\tsetX: function ( x ) {\n\n\t\tthis.x = x;\n\n\t\treturn this;\n\n\t},\n\n\tsetY: function ( y ) {\n\n\t\tthis.y = y;\n\n\t\treturn this;\n\n\t},\n\n\tsetZ: function ( z ) {\n\n\t\tthis.z = z;\n\n\t\treturn this;\n\n\t},\n\n\tsetComponent: function ( index, value ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: this.x = value; break;\n\t\t\tcase 1: this.y = value; break;\n\t\t\tcase 2: this.z = value; break;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t},\n\n\tgetComponent: function ( index ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: return this.x;\n\t\t\tcase 1: return this.y;\n\t\t\tcase 2: return this.z;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t},\n\n\tclone: function () {\n\n\t\treturn new this.constructor( this.x, this.y, this.z );\n\n\t},\n\n\tcopy: function ( v ) {\n\n\t\tthis.x = v.x;\n\t\tthis.y = v.y;\n\t\tthis.z = v.z;\n\n\t\treturn this;\n\n\t},\n\n\tadd: function ( v, w ) {\n\n\t\tif ( w !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead.' );\n\t\t\treturn this.addVectors( v, w );\n\n\t\t}\n\n\t\tthis.x += v.x;\n\t\tthis.y += v.y;\n\t\tthis.z += v.z;\n\n\t\treturn this;\n\n\t},\n\n\taddScalar: function ( s ) {\n\n\t\tthis.x += s;\n\t\tthis.y += s;\n\t\tthis.z += s;\n\n\t\treturn this;\n\n\t},\n\n\taddVectors: function ( a, b ) {\n\n\t\tthis.x = a.x + b.x;\n\t\tthis.y = a.y + b.y;\n\t\tthis.z = a.z + b.z;\n\n\t\treturn this;\n\n\t},\n\n\taddScaledVector: function ( v, s ) {\n\n\t\tthis.x += v.x * s;\n\t\tthis.y += v.y * s;\n\t\tthis.z += v.z * s;\n\n\t\treturn this;\n\n\t},\n\n\tsub: function ( v, w ) {\n\n\t\tif ( w !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.' );\n\t\t\treturn this.subVectors( v, w );\n\n\t\t}\n\n\t\tthis.x -= v.x;\n\t\tthis.y -= v.y;\n\t\tthis.z -= v.z;\n\n\t\treturn this;\n\n\t},\n\n\tsubScalar: function ( s ) {\n\n\t\tthis.x -= s;\n\t\tthis.y -= s;\n\t\tthis.z -= s;\n\n\t\treturn this;\n\n\t},\n\n\tsubVectors: function ( a, b ) {\n\n\t\tthis.x = a.x - b.x;\n\t\tthis.y = a.y - b.y;\n\t\tthis.z = a.z - b.z;\n\n\t\treturn this;\n\n\t},\n\n\tmultiply: function ( v, w ) {\n\n\t\tif ( w !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead.' );\n\t\t\treturn this.multiplyVectors( v, w );\n\n\t\t}\n\n\t\tthis.x *= v.x;\n\t\tthis.y *= v.y;\n\t\tthis.z *= v.z;\n\n\t\treturn this;\n\n\t},\n\n\tmultiplyScalar: function ( scalar ) {\n\n\t\tthis.x *= scalar;\n\t\tthis.y *= scalar;\n\t\tthis.z *= scalar;\n\n\t\treturn this;\n\n\t},\n\n\tmultiplyVectors: function ( a, b ) {\n\n\t\tthis.x = a.x * b.x;\n\t\tthis.y = a.y * b.y;\n\t\tthis.z = a.z * b.z;\n\n\t\treturn this;\n\n\t},\n\n\tapplyEuler: function () {\n\n\t\tvar quaternion;\n\n\t\treturn function applyEuler( euler ) {\n\n\t\t\tif ( euler instanceof THREE.Euler === false ) {\n\n\t\t\t\tconsole.error( 'THREE.Vector3: .applyEuler() now expects a Euler rotation rather than a Vector3 and order.' );\n\n\t\t\t}\n\n\t\t\tif ( quaternion === undefined ) quaternion = new THREE.Quaternion();\n\n\t\t\tthis.applyQuaternion( quaternion.setFromEuler( euler ) );\n\n\t\t\treturn this;\n\n\t\t};\n\n\t}(),\n\n\tapplyAxisAngle: function () {\n\n\t\tvar quaternion;\n\n\t\treturn function applyAxisAngle( axis, angle ) {\n\n\t\t\tif ( quaternion === undefined ) quaternion = new THREE.Quaternion();\n\n\t\t\tthis.applyQuaternion( quaternion.setFromAxisAngle( axis, angle ) );\n\n\t\t\treturn this;\n\n\t\t};\n\n\t}(),\n\n\tapplyMatrix3: function ( m ) {\n\n\t\tvar x = this.x;\n\t\tvar y = this.y;\n\t\tvar z = this.z;\n\n\t\tvar e = m.elements;\n\n\t\tthis.x = e[ 0 ] * x + e[ 3 ] * y + e[ 6 ] * z;\n\t\tthis.y = e[ 1 ] * x + e[ 4 ] * y + e[ 7 ] * z;\n\t\tthis.z = e[ 2 ] * x + e[ 5 ] * y + e[ 8 ] * z;\n\n\t\treturn this;\n\n\t},\n\n\tapplyMatrix4: function ( m ) {\n\n\t\t// input: THREE.Matrix4 affine matrix\n\n\t\tvar x = this.x, y = this.y, z = this.z;\n\n\t\tvar e = m.elements;\n\n\t\tthis.x = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ]  * z + e[ 12 ];\n\t\tthis.y = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ]  * z + e[ 13 ];\n\t\tthis.z = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z + e[ 14 ];\n\n\t\treturn this;\n\n\t},\n\n\tapplyProjection: function ( m ) {\n\n\t\t// input: THREE.Matrix4 projection matrix\n\n\t\tvar x = this.x, y = this.y, z = this.z;\n\n\t\tvar e = m.elements;\n\t\tvar d = 1 / ( e[ 3 ] * x + e[ 7 ] * y + e[ 11 ] * z + e[ 15 ] ); // perspective divide\n\n\t\tthis.x = ( e[ 0 ] * x + e[ 4 ] * y + e[ 8 ]  * z + e[ 12 ] ) * d;\n\t\tthis.y = ( e[ 1 ] * x + e[ 5 ] * y + e[ 9 ]  * z + e[ 13 ] ) * d;\n\t\tthis.z = ( e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z + e[ 14 ] ) * d;\n\n\t\treturn this;\n\n\t},\n\n\tapplyQuaternion: function ( q ) {\n\n\t\tvar x = this.x;\n\t\tvar y = this.y;\n\t\tvar z = this.z;\n\n\t\tvar qx = q.x;\n\t\tvar qy = q.y;\n\t\tvar qz = q.z;\n\t\tvar qw = q.w;\n\n\t\t// calculate quat * vector\n\n\t\tvar ix =  qw * x + qy * z - qz * y;\n\t\tvar iy =  qw * y + qz * x - qx * z;\n\t\tvar iz =  qw * z + qx * y - qy * x;\n\t\tvar iw = - qx * x - qy * y - qz * z;\n\n\t\t// calculate result * inverse quat\n\n\t\tthis.x = ix * qw + iw * - qx + iy * - qz - iz * - qy;\n\t\tthis.y = iy * qw + iw * - qy + iz * - qx - ix * - qz;\n\t\tthis.z = iz * qw + iw * - qz + ix * - qy - iy * - qx;\n\n\t\treturn this;\n\n\t},\n\n\tproject: function () {\n\n\t\tvar matrix;\n\n\t\treturn function project( camera ) {\n\n\t\t\tif ( matrix === undefined ) matrix = new THREE.Matrix4();\n\n\t\t\tmatrix.multiplyMatrices( camera.projectionMatrix, matrix.getInverse( camera.matrixWorld ) );\n\t\t\treturn this.applyProjection( matrix );\n\n\t\t};\n\n\t}(),\n\n\tunproject: function () {\n\n\t\tvar matrix;\n\n\t\treturn function unproject( camera ) {\n\n\t\t\tif ( matrix === undefined ) matrix = new THREE.Matrix4();\n\n\t\t\tmatrix.multiplyMatrices( camera.matrixWorld, matrix.getInverse( camera.projectionMatrix ) );\n\t\t\treturn this.applyProjection( matrix );\n\n\t\t};\n\n\t}(),\n\n\ttransformDirection: function ( m ) {\n\n\t\t// input: THREE.Matrix4 affine matrix\n\t\t// vector interpreted as a direction\n\n\t\tvar x = this.x, y = this.y, z = this.z;\n\n\t\tvar e = m.elements;\n\n\t\tthis.x = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ]  * z;\n\t\tthis.y = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ]  * z;\n\t\tthis.z = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z;\n\n\t\tthis.normalize();\n\n\t\treturn this;\n\n\t},\n\n\tdivide: function ( v ) {\n\n\t\tthis.x /= v.x;\n\t\tthis.y /= v.y;\n\t\tthis.z /= v.z;\n\n\t\treturn this;\n\n\t},\n\n\tdivideScalar: function ( scalar ) {\n\n\t\tif ( scalar !== 0 ) {\n\n\t\t\tvar invScalar = 1 / scalar;\n\n\t\t\tthis.x *= invScalar;\n\t\t\tthis.y *= invScalar;\n\t\t\tthis.z *= invScalar;\n\n\t\t} else {\n\n\t\t\tthis.x = 0;\n\t\t\tthis.y = 0;\n\t\t\tthis.z = 0;\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tmin: function ( v ) {\n\n\t\tif ( this.x > v.x ) {\n\n\t\t\tthis.x = v.x;\n\n\t\t}\n\n\t\tif ( this.y > v.y ) {\n\n\t\t\tthis.y = v.y;\n\n\t\t}\n\n\t\tif ( this.z > v.z ) {\n\n\t\t\tthis.z = v.z;\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tmax: function ( v ) {\n\n\t\tif ( this.x < v.x ) {\n\n\t\t\tthis.x = v.x;\n\n\t\t}\n\n\t\tif ( this.y < v.y ) {\n\n\t\t\tthis.y = v.y;\n\n\t\t}\n\n\t\tif ( this.z < v.z ) {\n\n\t\t\tthis.z = v.z;\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tclamp: function ( min, max ) {\n\n\t\t// This function assumes min < max, if this assumption isn't true it will not operate correctly\n\n\t\tif ( this.x < min.x ) {\n\n\t\t\tthis.x = min.x;\n\n\t\t} else if ( this.x > max.x ) {\n\n\t\t\tthis.x = max.x;\n\n\t\t}\n\n\t\tif ( this.y < min.y ) {\n\n\t\t\tthis.y = min.y;\n\n\t\t} else if ( this.y > max.y ) {\n\n\t\t\tthis.y = max.y;\n\n\t\t}\n\n\t\tif ( this.z < min.z ) {\n\n\t\t\tthis.z = min.z;\n\n\t\t} else if ( this.z > max.z ) {\n\n\t\t\tthis.z = max.z;\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tclampScalar: function () {\n\n\t\tvar min, max;\n\n\t\treturn function clampScalar( minVal, maxVal ) {\n\n\t\t\tif ( min === undefined ) {\n\n\t\t\t\tmin = new THREE.Vector3();\n\t\t\t\tmax = new THREE.Vector3();\n\n\t\t\t}\n\n\t\t\tmin.set( minVal, minVal, minVal );\n\t\t\tmax.set( maxVal, maxVal, maxVal );\n\n\t\t\treturn this.clamp( min, max );\n\n\t\t};\n\n\t}(),\n\n\tfloor: function () {\n\n\t\tthis.x = Math.floor( this.x );\n\t\tthis.y = Math.floor( this.y );\n\t\tthis.z = Math.floor( this.z );\n\n\t\treturn this;\n\n\t},\n\n\tceil: function () {\n\n\t\tthis.x = Math.ceil( this.x );\n\t\tthis.y = Math.ceil( this.y );\n\t\tthis.z = Math.ceil( this.z );\n\n\t\treturn this;\n\n\t},\n\n\tround: function () {\n\n\t\tthis.x = Math.round( this.x );\n\t\tthis.y = Math.round( this.y );\n\t\tthis.z = Math.round( this.z );\n\n\t\treturn this;\n\n\t},\n\n\troundToZero: function () {\n\n\t\tthis.x = ( this.x < 0 ) ? Math.ceil( this.x ) : Math.floor( this.x );\n\t\tthis.y = ( this.y < 0 ) ? Math.ceil( this.y ) : Math.floor( this.y );\n\t\tthis.z = ( this.z < 0 ) ? Math.ceil( this.z ) : Math.floor( this.z );\n\n\t\treturn this;\n\n\t},\n\n\tnegate: function () {\n\n\t\tthis.x = - this.x;\n\t\tthis.y = - this.y;\n\t\tthis.z = - this.z;\n\n\t\treturn this;\n\n\t},\n\n\tdot: function ( v ) {\n\n\t\treturn this.x * v.x + this.y * v.y + this.z * v.z;\n\n\t},\n\n\tlengthSq: function () {\n\n\t\treturn this.x * this.x + this.y * this.y + this.z * this.z;\n\n\t},\n\n\tlength: function () {\n\n\t\treturn Math.sqrt( this.x * this.x + this.y * this.y + this.z * this.z );\n\n\t},\n\n\tlengthManhattan: function () {\n\n\t\treturn Math.abs( this.x ) + Math.abs( this.y ) + Math.abs( this.z );\n\n\t},\n\n\tnormalize: function () {\n\n\t\treturn this.divideScalar( this.length() );\n\n\t},\n\n\tsetLength: function ( l ) {\n\n\t\tvar oldLength = this.length();\n\n\t\tif ( oldLength !== 0 && l !== oldLength  ) {\n\n\t\t\tthis.multiplyScalar( l / oldLength );\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tlerp: function ( v, alpha ) {\n\n\t\tthis.x += ( v.x - this.x ) * alpha;\n\t\tthis.y += ( v.y - this.y ) * alpha;\n\t\tthis.z += ( v.z - this.z ) * alpha;\n\n\t\treturn this;\n\n\t},\n\n\tlerpVectors: function ( v1, v2, alpha ) {\n\n\t\tthis.subVectors( v2, v1 ).multiplyScalar( alpha ).add( v1 );\n\n\t\treturn this;\n\n\t},\n\n\tcross: function ( v, w ) {\n\n\t\tif ( w !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead.' );\n\t\t\treturn this.crossVectors( v, w );\n\n\t\t}\n\n\t\tvar x = this.x, y = this.y, z = this.z;\n\n\t\tthis.x = y * v.z - z * v.y;\n\t\tthis.y = z * v.x - x * v.z;\n\t\tthis.z = x * v.y - y * v.x;\n\n\t\treturn this;\n\n\t},\n\n\tcrossVectors: function ( a, b ) {\n\n\t\tvar ax = a.x, ay = a.y, az = a.z;\n\t\tvar bx = b.x, by = b.y, bz = b.z;\n\n\t\tthis.x = ay * bz - az * by;\n\t\tthis.y = az * bx - ax * bz;\n\t\tthis.z = ax * by - ay * bx;\n\n\t\treturn this;\n\n\t},\n\n\tprojectOnVector: function () {\n\n\t\tvar v1, dot;\n\n\t\treturn function projectOnVector( vector ) {\n\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\n\n\t\t\tv1.copy( vector ).normalize();\n\n\t\t\tdot = this.dot( v1 );\n\n\t\t\treturn this.copy( v1 ).multiplyScalar( dot );\n\n\t\t};\n\n\t}(),\n\n\tprojectOnPlane: function () {\n\n\t\tvar v1;\n\n\t\treturn function projectOnPlane( planeNormal ) {\n\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\n\n\t\t\tv1.copy( this ).projectOnVector( planeNormal );\n\n\t\t\treturn this.sub( v1 );\n\n\t\t}\n\n\t}(),\n\n\treflect: function () {\n\n\t\t// reflect incident vector off plane orthogonal to normal\n\t\t// normal is assumed to have unit length\n\n\t\tvar v1;\n\n\t\treturn function reflect( normal ) {\n\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\n\n\t\t\treturn this.sub( v1.copy( normal ).multiplyScalar( 2 * this.dot( normal ) ) );\n\n\t\t}\n\n\t}(),\n\n\tangleTo: function ( v ) {\n\n\t\tvar theta = this.dot( v ) / ( this.length() * v.length() );\n\n\t\t// clamp, to handle numerical problems\n\n\t\treturn Math.acos( THREE.Math.clamp( theta, - 1, 1 ) );\n\n\t},\n\n\tdistanceTo: function ( v ) {\n\n\t\treturn Math.sqrt( this.distanceToSquared( v ) );\n\n\t},\n\n\tdistanceToSquared: function ( v ) {\n\n\t\tvar dx = this.x - v.x;\n\t\tvar dy = this.y - v.y;\n\t\tvar dz = this.z - v.z;\n\n\t\treturn dx * dx + dy * dy + dz * dz;\n\n\t},\n\n\tsetEulerFromRotationMatrix: function ( m, order ) {\n\n\t\tconsole.error( 'THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.' );\n\n\t},\n\n\tsetEulerFromQuaternion: function ( q, order ) {\n\n\t\tconsole.error( 'THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.' );\n\n\t},\n\n\tgetPositionFromMatrix: function ( m ) {\n\n\t\tconsole.warn( 'THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition().' );\n\n\t\treturn this.setFromMatrixPosition( m );\n\n\t},\n\n\tgetScaleFromMatrix: function ( m ) {\n\n\t\tconsole.warn( 'THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale().' );\n\n\t\treturn this.setFromMatrixScale( m );\n\n\t},\n\n\tgetColumnFromMatrix: function ( index, matrix ) {\n\n\t\tconsole.warn( 'THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn().' );\n\n\t\treturn this.setFromMatrixColumn( index, matrix );\n\n\t},\n\n\tsetFromMatrixPosition: function ( m ) {\n\n\t\tthis.x = m.elements[ 12 ];\n\t\tthis.y = m.elements[ 13 ];\n\t\tthis.z = m.elements[ 14 ];\n\n\t\treturn this;\n\n\t},\n\n\tsetFromMatrixScale: function ( m ) {\n\n\t\tvar sx = this.set( m.elements[ 0 ], m.elements[ 1 ], m.elements[ 2 ] ).length();\n\t\tvar sy = this.set( m.elements[ 4 ], m.elements[ 5 ], m.elements[ 6 ] ).length();\n\t\tvar sz = this.set( m.elements[ 8 ], m.elements[ 9 ], m.elements[ 10 ] ).length();\n\n\t\tthis.x = sx;\n\t\tthis.y = sy;\n\t\tthis.z = sz;\n\n\t\treturn this;\n\n\t},\n\n\tsetFromMatrixColumn: function ( index, matrix ) {\n\n\t\tvar offset = index * 4;\n\n\t\tvar me = matrix.elements;\n\n\t\tthis.x = me[ offset ];\n\t\tthis.y = me[ offset + 1 ];\n\t\tthis.z = me[ offset + 2 ];\n\n\t\treturn this;\n\n\t},\n\n\tequals: function ( v ) {\n\n\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) && ( v.z === this.z ) );\n\n\t},\n\n\tfromArray: function ( array, offset ) {\n\n\t\tif ( offset === undefined ) offset = 0;\n\n\t\tthis.x = array[ offset ];\n\t\tthis.y = array[ offset + 1 ];\n\t\tthis.z = array[ offset + 2 ];\n\n\t\treturn this;\n\n\t},\n\n\ttoArray: function ( array, offset ) {\n\n\t\tif ( array === undefined ) array = [];\n\t\tif ( offset === undefined ) offset = 0;\n\n\t\tarray[ offset ] = this.x;\n\t\tarray[ offset + 1 ] = this.y;\n\t\tarray[ offset + 2 ] = this.z;\n\n\t\treturn array;\n\n\t},\n\n\tfromAttribute: function ( attribute, index, offset ) {\n\n\t\tif ( offset === undefined ) offset = 0;\n\n\t\tindex = index * attribute.itemSize + offset;\n\n\t\tthis.x = attribute.array[ index ];\n\t\tthis.y = attribute.array[ index + 1 ];\n\t\tthis.z = attribute.array[ index + 2 ];\n\n\t\treturn this;\n\n\t}\n\n};\n\n// File:src/math/Vector4.js\n\n/**\n * @author supereggbert / http://www.paulbrunt.co.uk/\n * @author philogb / http://blog.thejit.org/\n * @author mikael emtinger / http://gomo.se/\n * @author egraether / http://egraether.com/\n * @author WestLangley / http://github.com/WestLangley\n */\n\nTHREE.Vector4 = function ( x, y, z, w ) {\n\n\tthis.x = x || 0;\n\tthis.y = y || 0;\n\tthis.z = z || 0;\n\tthis.w = ( w !== undefined ) ? w : 1;\n\n};\n\nTHREE.Vector4.prototype = {\n\n\tconstructor: THREE.Vector4,\n\n\tset: function ( x, y, z, w ) {\n\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.z = z;\n\t\tthis.w = w;\n\n\t\treturn this;\n\n\t},\n\n\tsetX: function ( x ) {\n\n\t\tthis.x = x;\n\n\t\treturn this;\n\n\t},\n\n\tsetY: function ( y ) {\n\n\t\tthis.y = y;\n\n\t\treturn this;\n\n\t},\n\n\tsetZ: function ( z ) {\n\n\t\tthis.z = z;\n\n\t\treturn this;\n\n\t},\n\n\tsetW: function ( w ) {\n\n\t\tthis.w = w;\n\n\t\treturn this;\n\n\t},\n\n\tsetComponent: function ( index, value ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: this.x = value; break;\n\t\t\tcase 1: this.y = value; break;\n\t\t\tcase 2: this.z = value; break;\n\t\t\tcase 3: this.w = value; break;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t},\n\n\tgetComponent: function ( index ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: return this.x;\n\t\t\tcase 1: return this.y;\n\t\t\tcase 2: return this.z;\n\t\t\tcase 3: return this.w;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t},\n\n\tclone: function () {\n\n\t\treturn new this.constructor( this.x, this.y, this.z, this.w );\n\n\t},\n\n\tcopy: function ( v ) {\n\n\t\tthis.x = v.x;\n\t\tthis.y = v.y;\n\t\tthis.z = v.z;\n\t\tthis.w = ( v.w !== undefined ) ? v.w : 1;\n\n\t\treturn this;\n\n\t},\n\n\tadd: function ( v, w ) {\n\n\t\tif ( w !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead.' );\n\t\t\treturn this.addVectors( v, w );\n\n\t\t}\n\n\t\tthis.x += v.x;\n\t\tthis.y += v.y;\n\t\tthis.z += v.z;\n\t\tthis.w += v.w;\n\n\t\treturn this;\n\n\t},\n\n\taddScalar: function ( s ) {\n\n\t\tthis.x += s;\n\t\tthis.y += s;\n\t\tthis.z += s;\n\t\tthis.w += s;\n\n\t\treturn this;\n\n\t},\n\n\taddVectors: function ( a, b ) {\n\n\t\tthis.x = a.x + b.x;\n\t\tthis.y = a.y + b.y;\n\t\tthis.z = a.z + b.z;\n\t\tthis.w = a.w + b.w;\n\n\t\treturn this;\n\n\t},\n\n\taddScaledVector: function ( v, s ) {\n\n\t\tthis.x += v.x * s;\n\t\tthis.y += v.y * s;\n\t\tthis.z += v.z * s;\n\t\tthis.w += v.w * s;\n\n\t\treturn this;\n\n\t},\n\n\tsub: function ( v, w ) {\n\n\t\tif ( w !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.' );\n\t\t\treturn this.subVectors( v, w );\n\n\t\t}\n\n\t\tthis.x -= v.x;\n\t\tthis.y -= v.y;\n\t\tthis.z -= v.z;\n\t\tthis.w -= v.w;\n\n\t\treturn this;\n\n\t},\n\n\tsubScalar: function ( s ) {\n\n\t\tthis.x -= s;\n\t\tthis.y -= s;\n\t\tthis.z -= s;\n\t\tthis.w -= s;\n\n\t\treturn this;\n\n\t},\n\n\tsubVectors: function ( a, b ) {\n\n\t\tthis.x = a.x - b.x;\n\t\tthis.y = a.y - b.y;\n\t\tthis.z = a.z - b.z;\n\t\tthis.w = a.w - b.w;\n\n\t\treturn this;\n\n\t},\n\n\tmultiplyScalar: function ( scalar ) {\n\n\t\tthis.x *= scalar;\n\t\tthis.y *= scalar;\n\t\tthis.z *= scalar;\n\t\tthis.w *= scalar;\n\n\t\treturn this;\n\n\t},\n\n\tapplyMatrix4: function ( m ) {\n\n\t\tvar x = this.x;\n\t\tvar y = this.y;\n\t\tvar z = this.z;\n\t\tvar w = this.w;\n\n\t\tvar e = m.elements;\n\n\t\tthis.x = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ] * z + e[ 12 ] * w;\n\t\tthis.y = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ] * z + e[ 13 ] * w;\n\t\tthis.z = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z + e[ 14 ] * w;\n\t\tthis.w = e[ 3 ] * x + e[ 7 ] * y + e[ 11 ] * z + e[ 15 ] * w;\n\n\t\treturn this;\n\n\t},\n\n\tdivideScalar: function ( scalar ) {\n\n\t\tif ( scalar !== 0 ) {\n\n\t\t\tvar invScalar = 1 / scalar;\n\n\t\t\tthis.x *= invScalar;\n\t\t\tthis.y *= invScalar;\n\t\t\tthis.z *= invScalar;\n\t\t\tthis.w *= invScalar;\n\n\t\t} else {\n\n\t\t\tthis.x = 0;\n\t\t\tthis.y = 0;\n\t\t\tthis.z = 0;\n\t\t\tthis.w = 1;\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tsetAxisAngleFromQuaternion: function ( q ) {\n\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/quaternionToAngle/index.htm\n\n\t\t// q is assumed to be normalized\n\n\t\tthis.w = 2 * Math.acos( q.w );\n\n\t\tvar s = Math.sqrt( 1 - q.w * q.w );\n\n\t\tif ( s < 0.0001 ) {\n\n\t\t\t this.x = 1;\n\t\t\t this.y = 0;\n\t\t\t this.z = 0;\n\n\t\t} else {\n\n\t\t\t this.x = q.x / s;\n\t\t\t this.y = q.y / s;\n\t\t\t this.z = q.z / s;\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tsetAxisAngleFromRotationMatrix: function ( m ) {\n\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToAngle/index.htm\n\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n\n\t\tvar angle, x, y, z,\t\t// variables for result\n\t\t\tepsilon = 0.01,\t\t// margin to allow for rounding errors\n\t\t\tepsilon2 = 0.1,\t\t// margin to distinguish between 0 and 180 degrees\n\n\t\t\tte = m.elements,\n\n\t\t\tm11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ],\n\t\t\tm21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ],\n\t\t\tm31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ];\n\n\t\tif ( ( Math.abs( m12 - m21 ) < epsilon )\n\t\t   && ( Math.abs( m13 - m31 ) < epsilon )\n\t\t   && ( Math.abs( m23 - m32 ) < epsilon ) ) {\n\n\t\t\t// singularity found\n\t\t\t// first check for identity matrix which must have +1 for all terms\n\t\t\t// in leading diagonal and zero in other terms\n\n\t\t\tif ( ( Math.abs( m12 + m21 ) < epsilon2 )\n\t\t\t   && ( Math.abs( m13 + m31 ) < epsilon2 )\n\t\t\t   && ( Math.abs( m23 + m32 ) < epsilon2 )\n\t\t\t   && ( Math.abs( m11 + m22 + m33 - 3 ) < epsilon2 ) ) {\n\n\t\t\t\t// this singularity is identity matrix so angle = 0\n\n\t\t\t\tthis.set( 1, 0, 0, 0 );\n\n\t\t\t\treturn this; // zero angle, arbitrary axis\n\n\t\t\t}\n\n\t\t\t// otherwise this singularity is angle = 180\n\n\t\t\tangle = Math.PI;\n\n\t\t\tvar xx = ( m11 + 1 ) / 2;\n\t\t\tvar yy = ( m22 + 1 ) / 2;\n\t\t\tvar zz = ( m33 + 1 ) / 2;\n\t\t\tvar xy = ( m12 + m21 ) / 4;\n\t\t\tvar xz = ( m13 + m31 ) / 4;\n\t\t\tvar yz = ( m23 + m32 ) / 4;\n\n\t\t\tif ( ( xx > yy ) && ( xx > zz ) ) {\n\n\t\t\t\t// m11 is the largest diagonal term\n\n\t\t\t\tif ( xx < epsilon ) {\n\n\t\t\t\t\tx = 0;\n\t\t\t\t\ty = 0.707106781;\n\t\t\t\t\tz = 0.707106781;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tx = Math.sqrt( xx );\n\t\t\t\t\ty = xy / x;\n\t\t\t\t\tz = xz / x;\n\n\t\t\t\t}\n\n\t\t\t} else if ( yy > zz ) {\n\n\t\t\t\t// m22 is the largest diagonal term\n\n\t\t\t\tif ( yy < epsilon ) {\n\n\t\t\t\t\tx = 0.707106781;\n\t\t\t\t\ty = 0;\n\t\t\t\t\tz = 0.707106781;\n\n\t\t\t\t} else {\n\n\t\t\t\t\ty = Math.sqrt( yy );\n\t\t\t\t\tx = xy / y;\n\t\t\t\t\tz = yz / y;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// m33 is the largest diagonal term so base result on this\n\n\t\t\t\tif ( zz < epsilon ) {\n\n\t\t\t\t\tx = 0.707106781;\n\t\t\t\t\ty = 0.707106781;\n\t\t\t\t\tz = 0;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tz = Math.sqrt( zz );\n\t\t\t\t\tx = xz / z;\n\t\t\t\t\ty = yz / z;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.set( x, y, z, angle );\n\n\t\t\treturn this; // return 180 deg rotation\n\n\t\t}\n\n\t\t// as we have reached here there are no singularities so we can handle normally\n\n\t\tvar s = Math.sqrt( ( m32 - m23 ) * ( m32 - m23 )\n\t\t\t\t\t\t  + ( m13 - m31 ) * ( m13 - m31 )\n\t\t\t\t\t\t  + ( m21 - m12 ) * ( m21 - m12 ) ); // used to normalize\n\n\t\tif ( Math.abs( s ) < 0.001 ) s = 1;\n\n\t\t// prevent divide by zero, should not happen if matrix is orthogonal and should be\n\t\t// caught by singularity test above, but I've left it in just in case\n\n\t\tthis.x = ( m32 - m23 ) / s;\n\t\tthis.y = ( m13 - m31 ) / s;\n\t\tthis.z = ( m21 - m12 ) / s;\n\t\tthis.w = Math.acos( ( m11 + m22 + m33 - 1 ) / 2 );\n\n\t\treturn this;\n\n\t},\n\n\tmin: function ( v ) {\n\n\t\tif ( this.x > v.x ) {\n\n\t\t\tthis.x = v.x;\n\n\t\t}\n\n\t\tif ( this.y > v.y ) {\n\n\t\t\tthis.y = v.y;\n\n\t\t}\n\n\t\tif ( this.z > v.z ) {\n\n\t\t\tthis.z = v.z;\n\n\t\t}\n\n\t\tif ( this.w > v.w ) {\n\n\t\t\tthis.w = v.w;\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tmax: function ( v ) {\n\n\t\tif ( this.x < v.x ) {\n\n\t\t\tthis.x = v.x;\n\n\t\t}\n\n\t\tif ( this.y < v.y ) {\n\n\t\t\tthis.y = v.y;\n\n\t\t}\n\n\t\tif ( this.z < v.z ) {\n\n\t\t\tthis.z = v.z;\n\n\t\t}\n\n\t\tif ( this.w < v.w ) {\n\n\t\t\tthis.w = v.w;\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tclamp: function ( min, max ) {\n\n\t\t// This function assumes min < max, if this assumption isn't true it will not operate correctly\n\n\t\tif ( this.x < min.x ) {\n\n\t\t\tthis.x = min.x;\n\n\t\t} else if ( this.x > max.x ) {\n\n\t\t\tthis.x = max.x;\n\n\t\t}\n\n\t\tif ( this.y < min.y ) {\n\n\t\t\tthis.y = min.y;\n\n\t\t} else if ( this.y > max.y ) {\n\n\t\t\tthis.y = max.y;\n\n\t\t}\n\n\t\tif ( this.z < min.z ) {\n\n\t\t\tthis.z = min.z;\n\n\t\t} else if ( this.z > max.z ) {\n\n\t\t\tthis.z = max.z;\n\n\t\t}\n\n\t\tif ( this.w < min.w ) {\n\n\t\t\tthis.w = min.w;\n\n\t\t} else if ( this.w > max.w ) {\n\n\t\t\tthis.w = max.w;\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tclampScalar: function () {\n\n\t\tvar min, max;\n\n\t\treturn function clampScalar( minVal, maxVal ) {\n\n\t\t\tif ( min === undefined ) {\n\n\t\t\t\tmin = new THREE.Vector4();\n\t\t\t\tmax = new THREE.Vector4();\n\n\t\t\t}\n\n\t\t\tmin.set( minVal, minVal, minVal, minVal );\n\t\t\tmax.set( maxVal, maxVal, maxVal, maxVal );\n\n\t\t\treturn this.clamp( min, max );\n\n\t\t};\n\n\t}(),\n\n\tfloor: function () {\n\n\t\tthis.x = Math.floor( this.x );\n\t\tthis.y = Math.floor( this.y );\n\t\tthis.z = Math.floor( this.z );\n\t\tthis.w = Math.floor( this.w );\n\n\t\treturn this;\n\n\t},\n\n\tceil: function () {\n\n\t\tthis.x = Math.ceil( this.x );\n\t\tthis.y = Math.ceil( this.y );\n\t\tthis.z = Math.ceil( this.z );\n\t\tthis.w = Math.ceil( this.w );\n\n\t\treturn this;\n\n\t},\n\n\tround: function () {\n\n\t\tthis.x = Math.round( this.x );\n\t\tthis.y = Math.round( this.y );\n\t\tthis.z = Math.round( this.z );\n\t\tthis.w = Math.round( this.w );\n\n\t\treturn this;\n\n\t},\n\n\troundToZero: function () {\n\n\t\tthis.x = ( this.x < 0 ) ? Math.ceil( this.x ) : Math.floor( this.x );\n\t\tthis.y = ( this.y < 0 ) ? Math.ceil( this.y ) : Math.floor( this.y );\n\t\tthis.z = ( this.z < 0 ) ? Math.ceil( this.z ) : Math.floor( this.z );\n\t\tthis.w = ( this.w < 0 ) ? Math.ceil( this.w ) : Math.floor( this.w );\n\n\t\treturn this;\n\n\t},\n\n\tnegate: function () {\n\n\t\tthis.x = - this.x;\n\t\tthis.y = - this.y;\n\t\tthis.z = - this.z;\n\t\tthis.w = - this.w;\n\n\t\treturn this;\n\n\t},\n\n\tdot: function ( v ) {\n\n\t\treturn this.x * v.x + this.y * v.y + this.z * v.z + this.w * v.w;\n\n\t},\n\n\tlengthSq: function () {\n\n\t\treturn this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w;\n\n\t},\n\n\tlength: function () {\n\n\t\treturn Math.sqrt( this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w );\n\n\t},\n\n\tlengthManhattan: function () {\n\n\t\treturn Math.abs( this.x ) + Math.abs( this.y ) + Math.abs( this.z ) + Math.abs( this.w );\n\n\t},\n\n\tnormalize: function () {\n\n\t\treturn this.divideScalar( this.length() );\n\n\t},\n\n\tsetLength: function ( l ) {\n\n\t\tvar oldLength = this.length();\n\n\t\tif ( oldLength !== 0 && l !== oldLength ) {\n\n\t\t\tthis.multiplyScalar( l / oldLength );\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tlerp: function ( v, alpha ) {\n\n\t\tthis.x += ( v.x - this.x ) * alpha;\n\t\tthis.y += ( v.y - this.y ) * alpha;\n\t\tthis.z += ( v.z - this.z ) * alpha;\n\t\tthis.w += ( v.w - this.w ) * alpha;\n\n\t\treturn this;\n\n\t},\n\n\tlerpVectors: function ( v1, v2, alpha ) {\n\n\t\tthis.subVectors( v2, v1 ).multiplyScalar( alpha ).add( v1 );\n\n\t\treturn this;\n\n\t},\n\n\tequals: function ( v ) {\n\n\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) && ( v.z === this.z ) && ( v.w === this.w ) );\n\n\t},\n\n\tfromArray: function ( array, offset ) {\n\n\t\tif ( offset === undefined ) offset = 0;\n\n\t\tthis.x = array[ offset ];\n\t\tthis.y = array[ offset + 1 ];\n\t\tthis.z = array[ offset + 2 ];\n\t\tthis.w = array[ offset + 3 ];\n\n\t\treturn this;\n\n\t},\n\n\ttoArray: function ( array, offset ) {\n\n\t\tif ( array === undefined ) array = [];\n\t\tif ( offset === undefined ) offset = 0;\n\n\t\tarray[ offset ] = this.x;\n\t\tarray[ offset + 1 ] = this.y;\n\t\tarray[ offset + 2 ] = this.z;\n\t\tarray[ offset + 3 ] = this.w;\n\n\t\treturn array;\n\n\t},\n\n\tfromAttribute: function ( attribute, index, offset ) {\n\n\t\tif ( offset === undefined ) offset = 0;\n\n\t\tindex = index * attribute.itemSize + offset;\n\n\t\tthis.x = attribute.array[ index ];\n\t\tthis.y = attribute.array[ index + 1 ];\n\t\tthis.z = attribute.array[ index + 2 ];\n\t\tthis.w = attribute.array[ index + 3 ];\n\n\t\treturn this;\n\n\t}\n\n};\n\n// File:src/math/Euler.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n * @author WestLangley / http://github.com/WestLangley\n * @author bhouston / http://exocortex.com\n */\n\nTHREE.Euler = function ( x, y, z, order ) {\n\n\tthis._x = x || 0;\n\tthis._y = y || 0;\n\tthis._z = z || 0;\n\tthis._order = order || THREE.Euler.DefaultOrder;\n\n};\n\nTHREE.Euler.RotationOrders = [ 'XYZ', 'YZX', 'ZXY', 'XZY', 'YXZ', 'ZYX' ];\n\nTHREE.Euler.DefaultOrder = 'XYZ';\n\nTHREE.Euler.prototype = {\n\n\tconstructor: THREE.Euler,\n\n\tget x () {\n\n\t\treturn this._x;\n\n\t},\n\n\tset x ( value ) {\n\n\t\tthis._x = value;\n\t\tthis.onChangeCallback();\n\n\t},\n\n\tget y () {\n\n\t\treturn this._y;\n\n\t},\n\n\tset y ( value ) {\n\n\t\tthis._y = value;\n\t\tthis.onChangeCallback();\n\n\t},\n\n\tget z () {\n\n\t\treturn this._z;\n\n\t},\n\n\tset z ( value ) {\n\n\t\tthis._z = value;\n\t\tthis.onChangeCallback();\n\n\t},\n\n\tget order () {\n\n\t\treturn this._order;\n\n\t},\n\n\tset order ( value ) {\n\n\t\tthis._order = value;\n\t\tthis.onChangeCallback();\n\n\t},\n\n\tset: function ( x, y, z, order ) {\n\n\t\tthis._x = x;\n\t\tthis._y = y;\n\t\tthis._z = z;\n\t\tthis._order = order || this._order;\n\n\t\tthis.onChangeCallback();\n\n\t\treturn this;\n\n\t},\n\n\tclone: function () {\n\n\t\treturn new this.constructor( this._x, this._y, this._z, this._order);\n\n\t},\n\n\tcopy: function ( euler ) {\n\n\t\tthis._x = euler._x;\n\t\tthis._y = euler._y;\n\t\tthis._z = euler._z;\n\t\tthis._order = euler._order;\n\n\t\tthis.onChangeCallback();\n\n\t\treturn this;\n\n\t},\n\n\tsetFromRotationMatrix: function ( m, order, update ) {\n\n\t\tvar clamp = THREE.Math.clamp;\n\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n\n\t\tvar te = m.elements;\n\t\tvar m11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ];\n\t\tvar m21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ];\n\t\tvar m31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ];\n\n\t\torder = order || this._order;\n\n\t\tif ( order === 'XYZ' ) {\n\n\t\t\tthis._y = Math.asin( clamp( m13, - 1, 1 ) );\n\n\t\t\tif ( Math.abs( m13 ) < 0.99999 ) {\n\n\t\t\t\tthis._x = Math.atan2( - m23, m33 );\n\t\t\t\tthis._z = Math.atan2( - m12, m11 );\n\n\t\t\t} else {\n\n\t\t\t\tthis._x = Math.atan2( m32, m22 );\n\t\t\t\tthis._z = 0;\n\n\t\t\t}\n\n\t\t} else if ( order === 'YXZ' ) {\n\n\t\t\tthis._x = Math.asin( - clamp( m23, - 1, 1 ) );\n\n\t\t\tif ( Math.abs( m23 ) < 0.99999 ) {\n\n\t\t\t\tthis._y = Math.atan2( m13, m33 );\n\t\t\t\tthis._z = Math.atan2( m21, m22 );\n\n\t\t\t} else {\n\n\t\t\t\tthis._y = Math.atan2( - m31, m11 );\n\t\t\t\tthis._z = 0;\n\n\t\t\t}\n\n\t\t} else if ( order === 'ZXY' ) {\n\n\t\t\tthis._x = Math.asin( clamp( m32, - 1, 1 ) );\n\n\t\t\tif ( Math.abs( m32 ) < 0.99999 ) {\n\n\t\t\t\tthis._y = Math.atan2( - m31, m33 );\n\t\t\t\tthis._z = Math.atan2( - m12, m22 );\n\n\t\t\t} else {\n\n\t\t\t\tthis._y = 0;\n\t\t\t\tthis._z = Math.atan2( m21, m11 );\n\n\t\t\t}\n\n\t\t} else if ( order === 'ZYX' ) {\n\n\t\t\tthis._y = Math.asin( - clamp( m31, - 1, 1 ) );\n\n\t\t\tif ( Math.abs( m31 ) < 0.99999 ) {\n\n\t\t\t\tthis._x = Math.atan2( m32, m33 );\n\t\t\t\tthis._z = Math.atan2( m21, m11 );\n\n\t\t\t} else {\n\n\t\t\t\tthis._x = 0;\n\t\t\t\tthis._z = Math.atan2( - m12, m22 );\n\n\t\t\t}\n\n\t\t} else if ( order === 'YZX' ) {\n\n\t\t\tthis._z = Math.asin( clamp( m21, - 1, 1 ) );\n\n\t\t\tif ( Math.abs( m21 ) < 0.99999 ) {\n\n\t\t\t\tthis._x = Math.atan2( - m23, m22 );\n\t\t\t\tthis._y = Math.atan2( - m31, m11 );\n\n\t\t\t} else {\n\n\t\t\t\tthis._x = 0;\n\t\t\t\tthis._y = Math.atan2( m13, m33 );\n\n\t\t\t}\n\n\t\t} else if ( order === 'XZY' ) {\n\n\t\t\tthis._z = Math.asin( - clamp( m12, - 1, 1 ) );\n\n\t\t\tif ( Math.abs( m12 ) < 0.99999 ) {\n\n\t\t\t\tthis._x = Math.atan2( m32, m22 );\n\t\t\t\tthis._y = Math.atan2( m13, m11 );\n\n\t\t\t} else {\n\n\t\t\t\tthis._x = Math.atan2( - m23, m33 );\n\t\t\t\tthis._y = 0;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.Euler: .setFromRotationMatrix() given unsupported order: ' + order )\n\n\t\t}\n\n\t\tthis._order = order;\n\n\t\tif ( update !== false ) this.onChangeCallback();\n\n\t\treturn this;\n\n\t},\n\n\tsetFromQuaternion: function () {\n\n\t\tvar matrix;\n\n\t\treturn function ( q, order, update ) {\n\n\t\t\tif ( matrix === undefined ) matrix = new THREE.Matrix4();\n\t\t\tmatrix.makeRotationFromQuaternion( q );\n\t\t\tthis.setFromRotationMatrix( matrix, order, update );\n\n\t\t\treturn this;\n\n\t\t};\n\n\t}(),\n\n\tsetFromVector3: function ( v, order ) {\n\n\t\treturn this.set( v.x, v.y, v.z, order || this._order );\n\n\t},\n\n\treorder: function () {\n\n\t\t// WARNING: this discards revolution information -bhouston\n\n\t\tvar q = new THREE.Quaternion();\n\n\t\treturn function ( newOrder ) {\n\n\t\t\tq.setFromEuler( this );\n\t\t\tthis.setFromQuaternion( q, newOrder );\n\n\t\t};\n\n\t}(),\n\n\tequals: function ( euler ) {\n\n\t\treturn ( euler._x === this._x ) && ( euler._y === this._y ) && ( euler._z === this._z ) && ( euler._order === this._order );\n\n\t},\n\n\tfromArray: function ( array ) {\n\n\t\tthis._x = array[ 0 ];\n\t\tthis._y = array[ 1 ];\n\t\tthis._z = array[ 2 ];\n\t\tif ( array[ 3 ] !== undefined ) this._order = array[ 3 ];\n\n\t\tthis.onChangeCallback();\n\n\t\treturn this;\n\n\t},\n\n\ttoArray: function ( array, offset ) {\n\n\t\tif ( array === undefined ) array = [];\n\t\tif ( offset === undefined ) offset = 0;\n\n\t\tarray[ offset ] = this._x;\n\t\tarray[ offset + 1 ] = this._y;\n\t\tarray[ offset + 2 ] = this._z;\n\t\tarray[ offset + 3 ] = this._order;\n\n\t\treturn array;\n\n\t},\n\n\ttoVector3: function ( optionalResult ) {\n\n\t\tif ( optionalResult ) {\n\n\t\t\treturn optionalResult.set( this._x, this._y, this._z );\n\n\t\t} else {\n\n\t\t\treturn new THREE.Vector3( this._x, this._y, this._z );\n\n\t\t}\n\n\t},\n\n\tonChange: function ( callback ) {\n\n\t\tthis.onChangeCallback = callback;\n\n\t\treturn this;\n\n\t},\n\n\tonChangeCallback: function () {}\n\n};\n\n// File:src/math/Line3.js\n\n/**\n * @author bhouston / http://exocortex.com\n */\n\nTHREE.Line3 = function ( start, end ) {\n\n\tthis.start = ( start !== undefined ) ? start : new THREE.Vector3();\n\tthis.end = ( end !== undefined ) ? end : new THREE.Vector3();\n\n};\n\nTHREE.Line3.prototype = {\n\n\tconstructor: THREE.Line3,\n\n\tset: function ( start, end ) {\n\n\t\tthis.start.copy( start );\n\t\tthis.end.copy( end );\n\n\t\treturn this;\n\n\t},\n\n\tclone: function () {\n\n\t\treturn new this.constructor().copy( this );\n\n\t},\n\n\tcopy: function ( line ) {\n\n\t\tthis.start.copy( line.start );\n\t\tthis.end.copy( line.end );\n\n\t\treturn this;\n\n\t},\n\n\tcenter: function ( optionalTarget ) {\n\n\t\tvar result = optionalTarget || new THREE.Vector3();\n\t\treturn result.addVectors( this.start, this.end ).multiplyScalar( 0.5 );\n\n\t},\n\n\tdelta: function ( optionalTarget ) {\n\n\t\tvar result = optionalTarget || new THREE.Vector3();\n\t\treturn result.subVectors( this.end, this.start );\n\n\t},\n\n\tdistanceSq: function () {\n\n\t\treturn this.start.distanceToSquared( this.end );\n\n\t},\n\n\tdistance: function () {\n\n\t\treturn this.start.distanceTo( this.end );\n\n\t},\n\n\tat: function ( t, optionalTarget ) {\n\n\t\tvar result = optionalTarget || new THREE.Vector3();\n\n\t\treturn this.delta( result ).multiplyScalar( t ).add( this.start );\n\n\t},\n\n\tclosestPointToPointParameter: function () {\n\n\t\tvar startP = new THREE.Vector3();\n\t\tvar startEnd = new THREE.Vector3();\n\n\t\treturn function ( point, clampToLine ) {\n\n\t\t\tstartP.subVectors( point, this.start );\n\t\t\tstartEnd.subVectors( this.end, this.start );\n\n\t\t\tvar startEnd2 = startEnd.dot( startEnd );\n\t\t\tvar startEnd_startP = startEnd.dot( startP );\n\n\t\t\tvar t = startEnd_startP / startEnd2;\n\n\t\t\tif ( clampToLine ) {\n\n\t\t\t\tt = THREE.Math.clamp( t, 0, 1 );\n\n\t\t\t}\n\n\t\t\treturn t;\n\n\t\t};\n\n\t}(),\n\n\tclosestPointToPoint: function ( point, clampToLine, optionalTarget ) {\n\n\t\tvar t = this.closestPointToPointParameter( point, clampToLine );\n\n\t\tvar result = optionalTarget || new THREE.Vector3();\n\n\t\treturn this.delta( result ).multiplyScalar( t ).add( this.start );\n\n\t},\n\n\tapplyMatrix4: function ( matrix ) {\n\n\t\tthis.start.applyMatrix4( matrix );\n\t\tthis.end.applyMatrix4( matrix );\n\n\t\treturn this;\n\n\t},\n\n\tequals: function ( line ) {\n\n\t\treturn line.start.equals( this.start ) && line.end.equals( this.end );\n\n\t}\n\n};\n\n// File:src/math/Box2.js\n\n/**\n * @author bhouston / http://exocortex.com\n */\n\nTHREE.Box2 = function ( min, max ) {\n\n\tthis.min = ( min !== undefined ) ? min : new THREE.Vector2( Infinity, Infinity );\n\tthis.max = ( max !== undefined ) ? max : new THREE.Vector2( - Infinity, - Infinity );\n\n};\n\nTHREE.Box2.prototype = {\n\n\tconstructor: THREE.Box2,\n\n\tset: function ( min, max ) {\n\n\t\tthis.min.copy( min );\n\t\tthis.max.copy( max );\n\n\t\treturn this;\n\n\t},\n\n\tsetFromPoints: function ( points ) {\n\n\t\tthis.makeEmpty();\n\n\t\tfor ( var i = 0, il = points.length; i < il; i ++ ) {\n\n\t\t\tthis.expandByPoint( points[ i ] )\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tsetFromCenterAndSize: function () {\n\n\t\tvar v1 = new THREE.Vector2();\n\n\t\treturn function ( center, size ) {\n\n\t\t\tvar halfSize = v1.copy( size ).multiplyScalar( 0.5 );\n\t\t\tthis.min.copy( center ).sub( halfSize );\n\t\t\tthis.max.copy( center ).add( halfSize );\n\n\t\t\treturn this;\n\n\t\t};\n\n\t}(),\n\t\n\tclone: function () {\n\n\t\treturn new this.constructor().copy( this );\n\n\t},\n\n\tcopy: function ( box ) {\n\n\t\tthis.min.copy( box.min );\n\t\tthis.max.copy( box.max );\n\n\t\treturn this;\n\n\t},\n\n\tmakeEmpty: function () {\n\n\t\tthis.min.x = this.min.y = Infinity;\n\t\tthis.max.x = this.max.y = - Infinity;\n\n\t\treturn this;\n\n\t},\n\n\tempty: function () {\n\n\t\t// this is a more robust check for empty than ( volume <= 0 ) because volume can get positive with two negative axes\n\n\t\treturn ( this.max.x < this.min.x ) || ( this.max.y < this.min.y );\n\n\t},\n\n\tcenter: function ( optionalTarget ) {\n\n\t\tvar result = optionalTarget || new THREE.Vector2();\n\t\treturn result.addVectors( this.min, this.max ).multiplyScalar( 0.5 );\n\n\t},\n\n\tsize: function ( optionalTarget ) {\n\n\t\tvar result = optionalTarget || new THREE.Vector2();\n\t\treturn result.subVectors( this.max, this.min );\n\n\t},\n\n\texpandByPoint: function ( point ) {\n\n\t\tthis.min.min( point );\n\t\tthis.max.max( point );\n\n\t\treturn this;\n\n\t},\n\n\texpandByVector: function ( vector ) {\n\n\t\tthis.min.sub( vector );\n\t\tthis.max.add( vector );\n\n\t\treturn this;\n\n\t},\n\n\texpandByScalar: function ( scalar ) {\n\n\t\tthis.min.addScalar( - scalar );\n\t\tthis.max.addScalar( scalar );\n\n\t\treturn this;\n\n\t},\n\n\tcontainsPoint: function ( point ) {\n\n\t\tif ( point.x < this.min.x || point.x > this.max.x ||\n\t\t     point.y < this.min.y || point.y > this.max.y ) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\treturn true;\n\n\t},\n\n\tcontainsBox: function ( box ) {\n\n\t\tif ( ( this.min.x <= box.min.x ) && ( box.max.x <= this.max.x ) &&\n\t\t     ( this.min.y <= box.min.y ) && ( box.max.y <= this.max.y ) ) {\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\treturn false;\n\n\t},\n\n\tgetParameter: function ( point, optionalTarget ) {\n\n\t\t// This can potentially have a divide by zero if the box\n\t\t// has a size dimension of 0.\n\n\t\tvar result = optionalTarget || new THREE.Vector2();\n\n\t\treturn result.set(\n\t\t\t( point.x - this.min.x ) / ( this.max.x - this.min.x ),\n\t\t\t( point.y - this.min.y ) / ( this.max.y - this.min.y )\n\t\t);\n\n\t},\n\n\tisIntersectionBox: function ( box ) {\n\n\t\t// using 6 splitting planes to rule out intersections.\n\n\t\tif ( box.max.x < this.min.x || box.min.x > this.max.x ||\n\t\t     box.max.y < this.min.y || box.min.y > this.max.y ) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\treturn true;\n\n\t},\n\n\tclampPoint: function ( point, optionalTarget ) {\n\n\t\tvar result = optionalTarget || new THREE.Vector2();\n\t\treturn result.copy( point ).clamp( this.min, this.max );\n\n\t},\n\n\tdistanceToPoint: function () {\n\n\t\tvar v1 = new THREE.Vector2();\n\n\t\treturn function ( point ) {\n\n\t\t\tvar clampedPoint = v1.copy( point ).clamp( this.min, this.max );\n\t\t\treturn clampedPoint.sub( point ).length();\n\n\t\t};\n\n\t}(),\n\n\tintersect: function ( box ) {\n\n\t\tthis.min.max( box.min );\n\t\tthis.max.min( box.max );\n\n\t\treturn this;\n\n\t},\n\n\tunion: function ( box ) {\n\n\t\tthis.min.min( box.min );\n\t\tthis.max.max( box.max );\n\n\t\treturn this;\n\n\t},\n\n\ttranslate: function ( offset ) {\n\n\t\tthis.min.add( offset );\n\t\tthis.max.add( offset );\n\n\t\treturn this;\n\n\t},\n\n\tequals: function ( box ) {\n\n\t\treturn box.min.equals( this.min ) && box.max.equals( this.max );\n\n\t}\n\n};\n\n// File:src/math/Box3.js\n\n/**\n * @author bhouston / http://exocortex.com\n * @author WestLangley / http://github.com/WestLangley\n */\n\nTHREE.Box3 = function ( min, max ) {\n\n\tthis.min = ( min !== undefined ) ? min : new THREE.Vector3( Infinity, Infinity, Infinity );\n\tthis.max = ( max !== undefined ) ? max : new THREE.Vector3( - Infinity, - Infinity, - Infinity );\n\n};\n\nTHREE.Box3.prototype = {\n\n\tconstructor: THREE.Box3,\n\n\tset: function ( min, max ) {\n\n\t\tthis.min.copy( min );\n\t\tthis.max.copy( max );\n\n\t\treturn this;\n\n\t},\n\n\tsetFromPoints: function ( points ) {\n\n\t\tthis.makeEmpty();\n\n\t\tfor ( var i = 0, il = points.length; i < il; i ++ ) {\n\n\t\t\tthis.expandByPoint( points[ i ] );\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tsetFromCenterAndSize: function () {\n\n\t\tvar v1 = new THREE.Vector3();\n\n\t\treturn function ( center, size ) {\n\n\t\t\tvar halfSize = v1.copy( size ).multiplyScalar( 0.5 );\n\n\t\t\tthis.min.copy( center ).sub( halfSize );\n\t\t\tthis.max.copy( center ).add( halfSize );\n\n\t\t\treturn this;\n\n\t\t};\n\n\t}(),\n\n\tsetFromObject: function () {\n\n\t\t// Computes the world-axis-aligned bounding box of an object (including its children),\n\t\t// accounting for both the object's, and children's, world transforms\n\n\t\tvar v1 = new THREE.Vector3();\n\n\t\treturn function ( object ) {\n\n\t\t\tvar scope = this;\n\n\t\t\tobject.updateMatrixWorld( true );\n\n\t\t\tthis.makeEmpty();\n\n\t\t\tobject.traverse( function ( node ) {\n\n\t\t\t\tvar geometry = node.geometry;\n\n\t\t\t\tif ( geometry !== undefined ) {\n\n\t\t\t\t\tif ( geometry instanceof THREE.Geometry ) {\n\n\t\t\t\t\t\tvar vertices = geometry.vertices;\n\n\t\t\t\t\t\tfor ( var i = 0, il = vertices.length; i < il; i ++ ) {\n\n\t\t\t\t\t\t\tv1.copy( vertices[ i ] );\n\n\t\t\t\t\t\t\tv1.applyMatrix4( node.matrixWorld );\n\n\t\t\t\t\t\t\tscope.expandByPoint( v1 );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else if ( geometry instanceof THREE.BufferGeometry && geometry.attributes[ 'position' ] !== undefined ) {\n\n\t\t\t\t\t\tvar positions = geometry.attributes[ 'position' ].array;\n\n\t\t\t\t\t\tfor ( var i = 0, il = positions.length; i < il; i += 3 ) {\n\n\t\t\t\t\t\t\tv1.set( positions[ i ], positions[ i + 1 ], positions[ i + 2 ] );\n\n\t\t\t\t\t\t\tv1.applyMatrix4( node.matrixWorld );\n\n\t\t\t\t\t\t\tscope.expandByPoint( v1 );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t\treturn this;\n\n\t\t};\n\n\t}(),\n\n\tclone: function () {\n\n\t\treturn new this.constructor().copy( this );\n\n\t},\n\n\tcopy: function ( box ) {\n\n\t\tthis.min.copy( box.min );\n\t\tthis.max.copy( box.max );\n\n\t\treturn this;\n\n\t},\n\n\tmakeEmpty: function () {\n\n\t\tthis.min.x = this.min.y = this.min.z = Infinity;\n\t\tthis.max.x = this.max.y = this.max.z = - Infinity;\n\n\t\treturn this;\n\n\t},\n\n\tempty: function () {\n\n\t\t// this is a more robust check for empty than ( volume <= 0 ) because volume can get positive with two negative axes\n\n\t\treturn ( this.max.x < this.min.x ) || ( this.max.y < this.min.y ) || ( this.max.z < this.min.z );\n\n\t},\n\n\tcenter: function ( optionalTarget ) {\n\n\t\tvar result = optionalTarget || new THREE.Vector3();\n\t\treturn result.addVectors( this.min, this.max ).multiplyScalar( 0.5 );\n\n\t},\n\n\tsize: function ( optionalTarget ) {\n\n\t\tvar result = optionalTarget || new THREE.Vector3();\n\t\treturn result.subVectors( this.max, this.min );\n\n\t},\n\n\texpandByPoint: function ( point ) {\n\n\t\tthis.min.min( point );\n\t\tthis.max.max( point );\n\n\t\treturn this;\n\n\t},\n\n\texpandByVector: function ( vector ) {\n\n\t\tthis.min.sub( vector );\n\t\tthis.max.add( vector );\n\n\t\treturn this;\n\n\t},\n\n\texpandByScalar: function ( scalar ) {\n\n\t\tthis.min.addScalar( - scalar );\n\t\tthis.max.addScalar( scalar );\n\n\t\treturn this;\n\n\t},\n\n\tcontainsPoint: function ( point ) {\n\n\t\tif ( point.x < this.min.x || point.x > this.max.x ||\n\t\t     point.y < this.min.y || point.y > this.max.y ||\n\t\t     point.z < this.min.z || point.z > this.max.z ) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\treturn true;\n\n\t},\n\n\tcontainsBox: function ( box ) {\n\n\t\tif ( ( this.min.x <= box.min.x ) && ( box.max.x <= this.max.x ) &&\n\t\t\t ( this.min.y <= box.min.y ) && ( box.max.y <= this.max.y ) &&\n\t\t\t ( this.min.z <= box.min.z ) && ( box.max.z <= this.max.z ) ) {\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\treturn false;\n\n\t},\n\n\tgetParameter: function ( point, optionalTarget ) {\n\n\t\t// This can potentially have a divide by zero if the box\n\t\t// has a size dimension of 0.\n\n\t\tvar result = optionalTarget || new THREE.Vector3();\n\n\t\treturn result.set(\n\t\t\t( point.x - this.min.x ) / ( this.max.x - this.min.x ),\n\t\t\t( point.y - this.min.y ) / ( this.max.y - this.min.y ),\n\t\t\t( point.z - this.min.z ) / ( this.max.z - this.min.z )\n\t\t);\n\n\t},\n\n\tisIntersectionBox: function ( box ) {\n\n\t\t// using 6 splitting planes to rule out intersections.\n\n\t\tif ( box.max.x < this.min.x || box.min.x > this.max.x ||\n\t\t     box.max.y < this.min.y || box.min.y > this.max.y ||\n\t\t     box.max.z < this.min.z || box.min.z > this.max.z ) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\treturn true;\n\n\t},\n\n\tclampPoint: function ( point, optionalTarget ) {\n\n\t\tvar result = optionalTarget || new THREE.Vector3();\n\t\treturn result.copy( point ).clamp( this.min, this.max );\n\n\t},\n\n\tdistanceToPoint: function () {\n\n\t\tvar v1 = new THREE.Vector3();\n\n\t\treturn function ( point ) {\n\n\t\t\tvar clampedPoint = v1.copy( point ).clamp( this.min, this.max );\n\t\t\treturn clampedPoint.sub( point ).length();\n\n\t\t};\n\n\t}(),\n\n\tgetBoundingSphere: function () {\n\n\t\tvar v1 = new THREE.Vector3();\n\n\t\treturn function ( optionalTarget ) {\n\n\t\t\tvar result = optionalTarget || new THREE.Sphere();\n\n\t\t\tresult.center = this.center();\n\t\t\tresult.radius = this.size( v1 ).length() * 0.5;\n\n\t\t\treturn result;\n\n\t\t};\n\n\t}(),\n\n\tintersect: function ( box ) {\n\n\t\tthis.min.max( box.min );\n\t\tthis.max.min( box.max );\n\n\t\treturn this;\n\n\t},\n\n\tunion: function ( box ) {\n\n\t\tthis.min.min( box.min );\n\t\tthis.max.max( box.max );\n\n\t\treturn this;\n\n\t},\n\n\tapplyMatrix4: function () {\n\n\t\tvar points = [\n\t\t\tnew THREE.Vector3(),\n\t\t\tnew THREE.Vector3(),\n\t\t\tnew THREE.Vector3(),\n\t\t\tnew THREE.Vector3(),\n\t\t\tnew THREE.Vector3(),\n\t\t\tnew THREE.Vector3(),\n\t\t\tnew THREE.Vector3(),\n\t\t\tnew THREE.Vector3()\n\t\t];\n\n\t\treturn function ( matrix ) {\n\n\t\t\t// NOTE: I am using a binary pattern to specify all 2^3 combinations below\n\t\t\tpoints[ 0 ].set( this.min.x, this.min.y, this.min.z ).applyMatrix4( matrix ); // 000\n\t\t\tpoints[ 1 ].set( this.min.x, this.min.y, this.max.z ).applyMatrix4( matrix ); // 001\n\t\t\tpoints[ 2 ].set( this.min.x, this.max.y, this.min.z ).applyMatrix4( matrix ); // 010\n\t\t\tpoints[ 3 ].set( this.min.x, this.max.y, this.max.z ).applyMatrix4( matrix ); // 011\n\t\t\tpoints[ 4 ].set( this.max.x, this.min.y, this.min.z ).applyMatrix4( matrix ); // 100\n\t\t\tpoints[ 5 ].set( this.max.x, this.min.y, this.max.z ).applyMatrix4( matrix ); // 101\n\t\t\tpoints[ 6 ].set( this.max.x, this.max.y, this.min.z ).applyMatrix4( matrix ); // 110\n\t\t\tpoints[ 7 ].set( this.max.x, this.max.y, this.max.z ).applyMatrix4( matrix );  // 111\n\n\t\t\tthis.makeEmpty();\n\t\t\tthis.setFromPoints( points );\n\n\t\t\treturn this;\n\n\t\t};\n\n\t}(),\n\n\ttranslate: function ( offset ) {\n\n\t\tthis.min.add( offset );\n\t\tthis.max.add( offset );\n\n\t\treturn this;\n\n\t},\n\n\tequals: function ( box ) {\n\n\t\treturn box.min.equals( this.min ) && box.max.equals( this.max );\n\n\t}\n\n};\n\n// File:src/math/Matrix3.js\n\n/**\n * @author alteredq / http://alteredqualia.com/\n * @author WestLangley / http://github.com/WestLangley\n * @author bhouston / http://exocortex.com\n */\n\nTHREE.Matrix3 = function () {\n\n\tthis.elements = new Float32Array( [\n\n\t\t1, 0, 0,\n\t\t0, 1, 0,\n\t\t0, 0, 1\n\n\t] );\n\n\tif ( arguments.length > 0 ) {\n\n\t\tconsole.error( 'THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.' );\n\n\t}\n\n};\n\nTHREE.Matrix3.prototype = {\n\n\tconstructor: THREE.Matrix3,\n\n\tset: function ( n11, n12, n13, n21, n22, n23, n31, n32, n33 ) {\n\n\t\tvar te = this.elements;\n\n\t\tte[ 0 ] = n11; te[ 3 ] = n12; te[ 6 ] = n13;\n\t\tte[ 1 ] = n21; te[ 4 ] = n22; te[ 7 ] = n23;\n\t\tte[ 2 ] = n31; te[ 5 ] = n32; te[ 8 ] = n33;\n\n\t\treturn this;\n\n\t},\n\n\tidentity: function () {\n\n\t\tthis.set(\n\n\t\t\t1, 0, 0,\n\t\t\t0, 1, 0,\n\t\t\t0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t},\n\n\tclone: function () {\n\n\t\treturn new this.constructor().fromArray( this.elements );\n\n\t},\n\n\tcopy: function ( m ) {\n\n\t\tvar me = m.elements;\n\n\t\tthis.set(\n\n\t\t\tme[ 0 ], me[ 3 ], me[ 6 ],\n\t\t\tme[ 1 ], me[ 4 ], me[ 7 ],\n\t\t\tme[ 2 ], me[ 5 ], me[ 8 ]\n\n\t\t);\n\n\t\treturn this;\n\n\t},\n\n\tmultiplyVector3: function ( vector ) {\n\n\t\tconsole.warn( 'THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.' );\n\t\treturn vector.applyMatrix3( this );\n\n\t},\n\n\tmultiplyVector3Array: function ( a ) {\n\n\t\tconsole.warn( 'THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.' );\n\t\treturn this.applyToVector3Array( a );\n\n\t},\n\n\tapplyToVector3Array: function () {\n\n\t\tvar v1;\n\n\t\treturn function ( array, offset, length ) {\n\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\n\t\t\tif ( offset === undefined ) offset = 0;\n\t\t\tif ( length === undefined ) length = array.length;\n\n\t\t\tfor ( var i = 0, j = offset; i < length; i += 3, j += 3 ) {\n\n\t\t\t\tv1.fromArray( array, j );\n\t\t\t\tv1.applyMatrix3( this );\n\t\t\t\tv1.toArray( array, j );\n\n\t\t\t}\n\n\t\t\treturn array;\n\n\t\t};\n\n\t}(),\n\n\tapplyToBuffer: function () {\n\n\t\tvar v1;\n\n\t\treturn function applyToBuffer( buffer, offset, length ) {\n\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\n\t\t\tif ( offset === undefined ) offset = 0;\n\t\t\tif ( length === undefined ) length = buffer.length / buffer.itemSize;\n\n\t\t\tfor ( var i = 0, j = offset; i < length; i ++, j ++ ) {\n\n\t\t\t\tv1.x = buffer.getX( j );\n\t\t\t\tv1.y = buffer.getY( j );\n\t\t\t\tv1.z = buffer.getZ( j );\n\n\t\t\t\tv1.applyMatrix3( this );\n\n\t\t\t\tbuffer.setXYZ( v1.x, v1.y, v1.z );\n\n\t\t\t}\n\n\t\t\treturn buffer;\n\n\t\t};\n\n\t}(),\n\n\tmultiplyScalar: function ( s ) {\n\n\t\tvar te = this.elements;\n\n\t\tte[ 0 ] *= s; te[ 3 ] *= s; te[ 6 ] *= s;\n\t\tte[ 1 ] *= s; te[ 4 ] *= s; te[ 7 ] *= s;\n\t\tte[ 2 ] *= s; te[ 5 ] *= s; te[ 8 ] *= s;\n\n\t\treturn this;\n\n\t},\n\n\tdeterminant: function () {\n\n\t\tvar te = this.elements;\n\n\t\tvar a = te[ 0 ], b = te[ 1 ], c = te[ 2 ],\n\t\t\td = te[ 3 ], e = te[ 4 ], f = te[ 5 ],\n\t\t\tg = te[ 6 ], h = te[ 7 ], i = te[ 8 ];\n\n\t\treturn a * e * i - a * f * h - b * d * i + b * f * g + c * d * h - c * e * g;\n\n\t},\n\n\tgetInverse: function ( matrix, throwOnInvertible ) {\n\n\t\t// input: THREE.Matrix4\n\t\t// ( based on http://code.google.com/p/webgl-mjs/ )\n\n\t\tvar me = matrix.elements;\n\t\tvar te = this.elements;\n\n\t\tte[ 0 ] =   me[ 10 ] * me[ 5 ] - me[ 6 ] * me[ 9 ];\n\t\tte[ 1 ] = - me[ 10 ] * me[ 1 ] + me[ 2 ] * me[ 9 ];\n\t\tte[ 2 ] =   me[ 6 ] * me[ 1 ] - me[ 2 ] * me[ 5 ];\n\t\tte[ 3 ] = - me[ 10 ] * me[ 4 ] + me[ 6 ] * me[ 8 ];\n\t\tte[ 4 ] =   me[ 10 ] * me[ 0 ] - me[ 2 ] * me[ 8 ];\n\t\tte[ 5 ] = - me[ 6 ] * me[ 0 ] + me[ 2 ] * me[ 4 ];\n\t\tte[ 6 ] =   me[ 9 ] * me[ 4 ] - me[ 5 ] * me[ 8 ];\n\t\tte[ 7 ] = - me[ 9 ] * me[ 0 ] + me[ 1 ] * me[ 8 ];\n\t\tte[ 8 ] =   me[ 5 ] * me[ 0 ] - me[ 1 ] * me[ 4 ];\n\n\t\tvar det = me[ 0 ] * te[ 0 ] + me[ 1 ] * te[ 3 ] + me[ 2 ] * te[ 6 ];\n\n\t\t// no inverse\n\n\t\tif ( det === 0 ) {\n\n\t\t\tvar msg = \"Matrix3.getInverse(): can't invert matrix, determinant is 0\";\n\n\t\t\tif ( throwOnInvertible || false ) {\n\n\t\t\t\tthrow new Error( msg );\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( msg );\n\n\t\t\t}\n\n\t\t\tthis.identity();\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tthis.multiplyScalar( 1.0 / det );\n\n\t\treturn this;\n\n\t},\n\n\ttranspose: function () {\n\n\t\tvar tmp, m = this.elements;\n\n\t\ttmp = m[ 1 ]; m[ 1 ] = m[ 3 ]; m[ 3 ] = tmp;\n\t\ttmp = m[ 2 ]; m[ 2 ] = m[ 6 ]; m[ 6 ] = tmp;\n\t\ttmp = m[ 5 ]; m[ 5 ] = m[ 7 ]; m[ 7 ] = tmp;\n\n\t\treturn this;\n\n\t},\n\n\tflattenToArrayOffset: function ( array, offset ) {\n\n\t\tvar te = this.elements;\n\n\t\tarray[ offset ] = te[ 0 ];\n\t\tarray[ offset + 1 ] = te[ 1 ];\n\t\tarray[ offset + 2 ] = te[ 2 ];\n\n\t\tarray[ offset + 3 ] = te[ 3 ];\n\t\tarray[ offset + 4 ] = te[ 4 ];\n\t\tarray[ offset + 5 ] = te[ 5 ];\n\n\t\tarray[ offset + 6 ] = te[ 6 ];\n\t\tarray[ offset + 7 ] = te[ 7 ];\n\t\tarray[ offset + 8 ]  = te[ 8 ];\n\n\t\treturn array;\n\n\t},\n\n\tgetNormalMatrix: function ( m ) {\n\n\t\t// input: THREE.Matrix4\n\n\t\tthis.getInverse( m ).transpose();\n\n\t\treturn this;\n\n\t},\n\n\ttransposeIntoArray: function ( r ) {\n\n\t\tvar m = this.elements;\n\n\t\tr[ 0 ] = m[ 0 ];\n\t\tr[ 1 ] = m[ 3 ];\n\t\tr[ 2 ] = m[ 6 ];\n\t\tr[ 3 ] = m[ 1 ];\n\t\tr[ 4 ] = m[ 4 ];\n\t\tr[ 5 ] = m[ 7 ];\n\t\tr[ 6 ] = m[ 2 ];\n\t\tr[ 7 ] = m[ 5 ];\n\t\tr[ 8 ] = m[ 8 ];\n\n\t\treturn this;\n\n\t},\n\n\tfromArray: function ( array ) {\n\n\t\tthis.elements.set( array );\n\n\t\treturn this;\n\n\t},\n\n\ttoArray: function () {\n\n\t\tvar te = this.elements;\n\n\t\treturn [\n\t\t\tte[ 0 ], te[ 1 ], te[ 2 ],\n\t\t\tte[ 3 ], te[ 4 ], te[ 5 ],\n\t\t\tte[ 6 ], te[ 7 ], te[ 8 ]\n\t\t];\n\n\t}\n\n};\n\n// File:src/math/Matrix4.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n * @author supereggbert / http://www.paulbrunt.co.uk/\n * @author philogb / http://blog.thejit.org/\n * @author jordi_ros / http://plattsoft.com\n * @author D1plo1d / http://github.com/D1plo1d\n * @author alteredq / http://alteredqualia.com/\n * @author mikael emtinger / http://gomo.se/\n * @author timknip / http://www.floorplanner.com/\n * @author bhouston / http://exocortex.com\n * @author WestLangley / http://github.com/WestLangley\n */\n\nTHREE.Matrix4 = function () {\n\n\tthis.elements = new Float32Array( [\n\n\t\t1, 0, 0, 0,\n\t\t0, 1, 0, 0,\n\t\t0, 0, 1, 0,\n\t\t0, 0, 0, 1\n\n\t] );\n\n\tif ( arguments.length > 0 ) {\n\n\t\tconsole.error( 'THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.' );\n\n\t}\n\n};\n\nTHREE.Matrix4.prototype = {\n\n\tconstructor: THREE.Matrix4,\n\n\tset: function ( n11, n12, n13, n14, n21, n22, n23, n24, n31, n32, n33, n34, n41, n42, n43, n44 ) {\n\n\t\tvar te = this.elements;\n\n\t\tte[ 0 ] = n11; te[ 4 ] = n12; te[ 8 ] = n13; te[ 12 ] = n14;\n\t\tte[ 1 ] = n21; te[ 5 ] = n22; te[ 9 ] = n23; te[ 13 ] = n24;\n\t\tte[ 2 ] = n31; te[ 6 ] = n32; te[ 10 ] = n33; te[ 14 ] = n34;\n\t\tte[ 3 ] = n41; te[ 7 ] = n42; te[ 11 ] = n43; te[ 15 ] = n44;\n\n\t\treturn this;\n\n\t},\n\n\tidentity: function () {\n\n\t\tthis.set(\n\n\t\t\t1, 0, 0, 0,\n\t\t\t0, 1, 0, 0,\n\t\t\t0, 0, 1, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t},\n\n\tclone: function () {\n\n\t\treturn new THREE.Matrix4().fromArray( this.elements );\n\n\t},\n\n\tcopy: function ( m ) {\n\n\t\tthis.elements.set( m.elements );\n\n\t\treturn this;\n\n\t},\n\n\textractPosition: function ( m ) {\n\n\t\tconsole.warn( 'THREE.Matrix4: .extractPosition() has been renamed to .copyPosition().' );\n\t\treturn this.copyPosition( m );\n\n\t},\n\n\tcopyPosition: function ( m ) {\n\n\t\tvar te = this.elements;\n\t\tvar me = m.elements;\n\n\t\tte[ 12 ] = me[ 12 ];\n\t\tte[ 13 ] = me[ 13 ];\n\t\tte[ 14 ] = me[ 14 ];\n\n\t\treturn this;\n\n\t},\n\n\textractBasis: function ( xAxis, yAxis, zAxis ) {\n\n\t\tvar te = this.elements;\n\n\t\txAxis.set( te[ 0 ], te[ 1 ], te[ 2 ] );\n\t\tyAxis.set( te[ 4 ], te[ 5 ], te[ 6 ] );\n\t\tzAxis.set( te[ 8 ], te[ 9 ], te[ 10 ] );\n\n\t\treturn this;\n\n\t},\n\n\tmakeBasis: function ( xAxis, yAxis, zAxis ) {\n\n\t\tthis.set(\n\t\t\txAxis.x, yAxis.x, zAxis.x, 0,\n\t\t\txAxis.y, yAxis.y, zAxis.y, 0,\n\t\t\txAxis.z, yAxis.z, zAxis.z, 0,\n\t\t\t0,       0,       0,       1\n\t\t);\n\n\t\treturn this;\n\n\t},\n\n\textractRotation: function () {\n\n\t\tvar v1;\n\n\t\treturn function ( m ) {\n\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\n\n\t\t\tvar te = this.elements;\n\t\t\tvar me = m.elements;\n\n\t\t\tvar scaleX = 1 / v1.set( me[ 0 ], me[ 1 ], me[ 2 ] ).length();\n\t\t\tvar scaleY = 1 / v1.set( me[ 4 ], me[ 5 ], me[ 6 ] ).length();\n\t\t\tvar scaleZ = 1 / v1.set( me[ 8 ], me[ 9 ], me[ 10 ] ).length();\n\n\t\t\tte[ 0 ] = me[ 0 ] * scaleX;\n\t\t\tte[ 1 ] = me[ 1 ] * scaleX;\n\t\t\tte[ 2 ] = me[ 2 ] * scaleX;\n\n\t\t\tte[ 4 ] = me[ 4 ] * scaleY;\n\t\t\tte[ 5 ] = me[ 5 ] * scaleY;\n\t\t\tte[ 6 ] = me[ 6 ] * scaleY;\n\n\t\t\tte[ 8 ] = me[ 8 ] * scaleZ;\n\t\t\tte[ 9 ] = me[ 9 ] * scaleZ;\n\t\t\tte[ 10 ] = me[ 10 ] * scaleZ;\n\n\t\t\treturn this;\n\n\t\t};\n\n\t}(),\n\n\tmakeRotationFromEuler: function ( euler ) {\n\n\t\tif ( euler instanceof THREE.Euler === false ) {\n\n\t\t\tconsole.error( 'THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.' );\n\n\t\t}\n\n\t\tvar te = this.elements;\n\n\t\tvar x = euler.x, y = euler.y, z = euler.z;\n\t\tvar a = Math.cos( x ), b = Math.sin( x );\n\t\tvar c = Math.cos( y ), d = Math.sin( y );\n\t\tvar e = Math.cos( z ), f = Math.sin( z );\n\n\t\tif ( euler.order === 'XYZ' ) {\n\n\t\t\tvar ae = a * e, af = a * f, be = b * e, bf = b * f;\n\n\t\t\tte[ 0 ] = c * e;\n\t\t\tte[ 4 ] = - c * f;\n\t\t\tte[ 8 ] = d;\n\n\t\t\tte[ 1 ] = af + be * d;\n\t\t\tte[ 5 ] = ae - bf * d;\n\t\t\tte[ 9 ] = - b * c;\n\n\t\t\tte[ 2 ] = bf - ae * d;\n\t\t\tte[ 6 ] = be + af * d;\n\t\t\tte[ 10 ] = a * c;\n\n\t\t} else if ( euler.order === 'YXZ' ) {\n\n\t\t\tvar ce = c * e, cf = c * f, de = d * e, df = d * f;\n\n\t\t\tte[ 0 ] = ce + df * b;\n\t\t\tte[ 4 ] = de * b - cf;\n\t\t\tte[ 8 ] = a * d;\n\n\t\t\tte[ 1 ] = a * f;\n\t\t\tte[ 5 ] = a * e;\n\t\t\tte[ 9 ] = - b;\n\n\t\t\tte[ 2 ] = cf * b - de;\n\t\t\tte[ 6 ] = df + ce * b;\n\t\t\tte[ 10 ] = a * c;\n\n\t\t} else if ( euler.order === 'ZXY' ) {\n\n\t\t\tvar ce = c * e, cf = c * f, de = d * e, df = d * f;\n\n\t\t\tte[ 0 ] = ce - df * b;\n\t\t\tte[ 4 ] = - a * f;\n\t\t\tte[ 8 ] = de + cf * b;\n\n\t\t\tte[ 1 ] = cf + de * b;\n\t\t\tte[ 5 ] = a * e;\n\t\t\tte[ 9 ] = df - ce * b;\n\n\t\t\tte[ 2 ] = - a * d;\n\t\t\tte[ 6 ] = b;\n\t\t\tte[ 10 ] = a * c;\n\n\t\t} else if ( euler.order === 'ZYX' ) {\n\n\t\t\tvar ae = a * e, af = a * f, be = b * e, bf = b * f;\n\n\t\t\tte[ 0 ] = c * e;\n\t\t\tte[ 4 ] = be * d - af;\n\t\t\tte[ 8 ] = ae * d + bf;\n\n\t\t\tte[ 1 ] = c * f;\n\t\t\tte[ 5 ] = bf * d + ae;\n\t\t\tte[ 9 ] = af * d - be;\n\n\t\t\tte[ 2 ] = - d;\n\t\t\tte[ 6 ] = b * c;\n\t\t\tte[ 10 ] = a * c;\n\n\t\t} else if ( euler.order === 'YZX' ) {\n\n\t\t\tvar ac = a * c, ad = a * d, bc = b * c, bd = b * d;\n\n\t\t\tte[ 0 ] = c * e;\n\t\t\tte[ 4 ] = bd - ac * f;\n\t\t\tte[ 8 ] = bc * f + ad;\n\n\t\t\tte[ 1 ] = f;\n\t\t\tte[ 5 ] = a * e;\n\t\t\tte[ 9 ] = - b * e;\n\n\t\t\tte[ 2 ] = - d * e;\n\t\t\tte[ 6 ] = ad * f + bc;\n\t\t\tte[ 10 ] = ac - bd * f;\n\n\t\t} else if ( euler.order === 'XZY' ) {\n\n\t\t\tvar ac = a * c, ad = a * d, bc = b * c, bd = b * d;\n\n\t\t\tte[ 0 ] = c * e;\n\t\t\tte[ 4 ] = - f;\n\t\t\tte[ 8 ] = d * e;\n\n\t\t\tte[ 1 ] = ac * f + bd;\n\t\t\tte[ 5 ] = a * e;\n\t\t\tte[ 9 ] = ad * f - bc;\n\n\t\t\tte[ 2 ] = bc * f - ad;\n\t\t\tte[ 6 ] = b * e;\n\t\t\tte[ 10 ] = bd * f + ac;\n\n\t\t}\n\n\t\t// last column\n\t\tte[ 3 ] = 0;\n\t\tte[ 7 ] = 0;\n\t\tte[ 11 ] = 0;\n\n\t\t// bottom row\n\t\tte[ 12 ] = 0;\n\t\tte[ 13 ] = 0;\n\t\tte[ 14 ] = 0;\n\t\tte[ 15 ] = 1;\n\n\t\treturn this;\n\n\t},\n\n\tsetRotationFromQuaternion: function ( q ) {\n\n\t\tconsole.warn( 'THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion().' );\n\n\t\treturn this.makeRotationFromQuaternion( q );\n\n\t},\n\n\tmakeRotationFromQuaternion: function ( q ) {\n\n\t\tvar te = this.elements;\n\n\t\tvar x = q.x, y = q.y, z = q.z, w = q.w;\n\t\tvar x2 = x + x, y2 = y + y, z2 = z + z;\n\t\tvar xx = x * x2, xy = x * y2, xz = x * z2;\n\t\tvar yy = y * y2, yz = y * z2, zz = z * z2;\n\t\tvar wx = w * x2, wy = w * y2, wz = w * z2;\n\n\t\tte[ 0 ] = 1 - ( yy + zz );\n\t\tte[ 4 ] = xy - wz;\n\t\tte[ 8 ] = xz + wy;\n\n\t\tte[ 1 ] = xy + wz;\n\t\tte[ 5 ] = 1 - ( xx + zz );\n\t\tte[ 9 ] = yz - wx;\n\n\t\tte[ 2 ] = xz - wy;\n\t\tte[ 6 ] = yz + wx;\n\t\tte[ 10 ] = 1 - ( xx + yy );\n\n\t\t// last column\n\t\tte[ 3 ] = 0;\n\t\tte[ 7 ] = 0;\n\t\tte[ 11 ] = 0;\n\n\t\t// bottom row\n\t\tte[ 12 ] = 0;\n\t\tte[ 13 ] = 0;\n\t\tte[ 14 ] = 0;\n\t\tte[ 15 ] = 1;\n\n\t\treturn this;\n\n\t},\n\n\tlookAt: function () {\n\n\t\tvar x, y, z;\n\n\t\treturn function ( eye, target, up ) {\n\n\t\t\tif ( x === undefined ) x = new THREE.Vector3();\n\t\t\tif ( y === undefined ) y = new THREE.Vector3();\n\t\t\tif ( z === undefined ) z = new THREE.Vector3();\n\n\t\t\tvar te = this.elements;\n\n\t\t\tz.subVectors( eye, target ).normalize();\n\n\t\t\tif ( z.length() === 0 ) {\n\n\t\t\t\tz.z = 1;\n\n\t\t\t}\n\n\t\t\tx.crossVectors( up, z ).normalize();\n\n\t\t\tif ( x.length() === 0 ) {\n\n\t\t\t\tz.x += 0.0001;\n\t\t\t\tx.crossVectors( up, z ).normalize();\n\n\t\t\t}\n\n\t\t\ty.crossVectors( z, x );\n\n\n\t\t\tte[ 0 ] = x.x; te[ 4 ] = y.x; te[ 8 ] = z.x;\n\t\t\tte[ 1 ] = x.y; te[ 5 ] = y.y; te[ 9 ] = z.y;\n\t\t\tte[ 2 ] = x.z; te[ 6 ] = y.z; te[ 10 ] = z.z;\n\n\t\t\treturn this;\n\n\t\t};\n\n\t}(),\n\n\tmultiply: function ( m, n ) {\n\n\t\tif ( n !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead.' );\n\t\t\treturn this.multiplyMatrices( m, n );\n\n\t\t}\n\n\t\treturn this.multiplyMatrices( this, m );\n\n\t},\n\n\tmultiplyMatrices: function ( a, b ) {\n\n\t\tvar ae = a.elements;\n\t\tvar be = b.elements;\n\t\tvar te = this.elements;\n\n\t\tvar a11 = ae[ 0 ], a12 = ae[ 4 ], a13 = ae[ 8 ], a14 = ae[ 12 ];\n\t\tvar a21 = ae[ 1 ], a22 = ae[ 5 ], a23 = ae[ 9 ], a24 = ae[ 13 ];\n\t\tvar a31 = ae[ 2 ], a32 = ae[ 6 ], a33 = ae[ 10 ], a34 = ae[ 14 ];\n\t\tvar a41 = ae[ 3 ], a42 = ae[ 7 ], a43 = ae[ 11 ], a44 = ae[ 15 ];\n\n\t\tvar b11 = be[ 0 ], b12 = be[ 4 ], b13 = be[ 8 ], b14 = be[ 12 ];\n\t\tvar b21 = be[ 1 ], b22 = be[ 5 ], b23 = be[ 9 ], b24 = be[ 13 ];\n\t\tvar b31 = be[ 2 ], b32 = be[ 6 ], b33 = be[ 10 ], b34 = be[ 14 ];\n\t\tvar b41 = be[ 3 ], b42 = be[ 7 ], b43 = be[ 11 ], b44 = be[ 15 ];\n\n\t\tte[ 0 ] = a11 * b11 + a12 * b21 + a13 * b31 + a14 * b41;\n\t\tte[ 4 ] = a11 * b12 + a12 * b22 + a13 * b32 + a14 * b42;\n\t\tte[ 8 ] = a11 * b13 + a12 * b23 + a13 * b33 + a14 * b43;\n\t\tte[ 12 ] = a11 * b14 + a12 * b24 + a13 * b34 + a14 * b44;\n\n\t\tte[ 1 ] = a21 * b11 + a22 * b21 + a23 * b31 + a24 * b41;\n\t\tte[ 5 ] = a21 * b12 + a22 * b22 + a23 * b32 + a24 * b42;\n\t\tte[ 9 ] = a21 * b13 + a22 * b23 + a23 * b33 + a24 * b43;\n\t\tte[ 13 ] = a21 * b14 + a22 * b24 + a23 * b34 + a24 * b44;\n\n\t\tte[ 2 ] = a31 * b11 + a32 * b21 + a33 * b31 + a34 * b41;\n\t\tte[ 6 ] = a31 * b12 + a32 * b22 + a33 * b32 + a34 * b42;\n\t\tte[ 10 ] = a31 * b13 + a32 * b23 + a33 * b33 + a34 * b43;\n\t\tte[ 14 ] = a31 * b14 + a32 * b24 + a33 * b34 + a34 * b44;\n\n\t\tte[ 3 ] = a41 * b11 + a42 * b21 + a43 * b31 + a44 * b41;\n\t\tte[ 7 ] = a41 * b12 + a42 * b22 + a43 * b32 + a44 * b42;\n\t\tte[ 11 ] = a41 * b13 + a42 * b23 + a43 * b33 + a44 * b43;\n\t\tte[ 15 ] = a41 * b14 + a42 * b24 + a43 * b34 + a44 * b44;\n\n\t\treturn this;\n\n\t},\n\n\tmultiplyToArray: function ( a, b, r ) {\n\n\t\tvar te = this.elements;\n\n\t\tthis.multiplyMatrices( a, b );\n\n\t\tr[ 0 ] = te[ 0 ]; r[ 1 ] = te[ 1 ]; r[ 2 ] = te[ 2 ]; r[ 3 ] = te[ 3 ];\n\t\tr[ 4 ] = te[ 4 ]; r[ 5 ] = te[ 5 ]; r[ 6 ] = te[ 6 ]; r[ 7 ] = te[ 7 ];\n\t\tr[ 8 ]  = te[ 8 ]; r[ 9 ]  = te[ 9 ]; r[ 10 ] = te[ 10 ]; r[ 11 ] = te[ 11 ];\n\t\tr[ 12 ] = te[ 12 ]; r[ 13 ] = te[ 13 ]; r[ 14 ] = te[ 14 ]; r[ 15 ] = te[ 15 ];\n\n\t\treturn this;\n\n\t},\n\n\tmultiplyScalar: function ( s ) {\n\n\t\tvar te = this.elements;\n\n\t\tte[ 0 ] *= s; te[ 4 ] *= s; te[ 8 ] *= s; te[ 12 ] *= s;\n\t\tte[ 1 ] *= s; te[ 5 ] *= s; te[ 9 ] *= s; te[ 13 ] *= s;\n\t\tte[ 2 ] *= s; te[ 6 ] *= s; te[ 10 ] *= s; te[ 14 ] *= s;\n\t\tte[ 3 ] *= s; te[ 7 ] *= s; te[ 11 ] *= s; te[ 15 ] *= s;\n\n\t\treturn this;\n\n\t},\n\n\tmultiplyVector3: function ( vector ) {\n\n\t\tconsole.warn( 'THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead.' );\n\t\treturn vector.applyProjection( this );\n\n\t},\n\n\tmultiplyVector4: function ( vector ) {\n\n\t\tconsole.warn( 'THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.' );\n\t\treturn vector.applyMatrix4( this );\n\n\t},\n\n\tmultiplyVector3Array: function ( a ) {\n\n\t\tconsole.warn( 'THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.' );\n\t\treturn this.applyToVector3Array( a );\n\n\t},\n\n\tapplyToVector3Array: function () {\n\n\t\tvar v1;\n\n\t\treturn function ( array, offset, length ) {\n\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\n\t\t\tif ( offset === undefined ) offset = 0;\n\t\t\tif ( length === undefined ) length = array.length;\n\n\t\t\tfor ( var i = 0, j = offset; i < length; i += 3, j += 3 ) {\n\n\t\t\t\tv1.fromArray( array, j );\n\t\t\t\tv1.applyMatrix4( this );\n\t\t\t\tv1.toArray( array, j );\n\n\t\t\t}\n\n\t\t\treturn array;\n\n\t\t};\n\n\t}(),\n\n\tapplyToBuffer: function () {\n\n\t\tvar v1;\n\n\t\treturn function applyToBuffer( buffer, offset, length ) {\n\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\n\t\t\tif ( offset === undefined ) offset = 0;\n\t\t\tif ( length === undefined ) length = buffer.length / buffer.itemSize;\n\n\t\t\tfor ( var i = 0, j = offset; i < length; i ++, j ++ ) {\n\n\t\t\t\tv1.x = buffer.getX( j );\n\t\t\t\tv1.y = buffer.getY( j );\n\t\t\t\tv1.z = buffer.getZ( j );\n\n\t\t\t\tv1.applyMatrix4( this );\n\n\t\t\t\tbuffer.setXYZ( v1.x, v1.y, v1.z );\n\n\t\t\t}\n\n\t\t\treturn buffer;\n\n\t\t};\n\n\t}(),\n\n\trotateAxis: function ( v ) {\n\n\t\tconsole.warn( 'THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.' );\n\n\t\tv.transformDirection( this );\n\n\t},\n\n\tcrossVector: function ( vector ) {\n\n\t\tconsole.warn( 'THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.' );\n\t\treturn vector.applyMatrix4( this );\n\n\t},\n\n\tdeterminant: function () {\n\n\t\tvar te = this.elements;\n\n\t\tvar n11 = te[ 0 ], n12 = te[ 4 ], n13 = te[ 8 ], n14 = te[ 12 ];\n\t\tvar n21 = te[ 1 ], n22 = te[ 5 ], n23 = te[ 9 ], n24 = te[ 13 ];\n\t\tvar n31 = te[ 2 ], n32 = te[ 6 ], n33 = te[ 10 ], n34 = te[ 14 ];\n\t\tvar n41 = te[ 3 ], n42 = te[ 7 ], n43 = te[ 11 ], n44 = te[ 15 ];\n\n\t\t//TODO: make this more efficient\n\t\t//( based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm )\n\n\t\treturn (\n\t\t\tn41 * (\n\t\t\t\t+ n14 * n23 * n32\n\t\t\t\t - n13 * n24 * n32\n\t\t\t\t - n14 * n22 * n33\n\t\t\t\t + n12 * n24 * n33\n\t\t\t\t + n13 * n22 * n34\n\t\t\t\t - n12 * n23 * n34\n\t\t\t) +\n\t\t\tn42 * (\n\t\t\t\t+ n11 * n23 * n34\n\t\t\t\t - n11 * n24 * n33\n\t\t\t\t + n14 * n21 * n33\n\t\t\t\t - n13 * n21 * n34\n\t\t\t\t + n13 * n24 * n31\n\t\t\t\t - n14 * n23 * n31\n\t\t\t) +\n\t\t\tn43 * (\n\t\t\t\t+ n11 * n24 * n32\n\t\t\t\t - n11 * n22 * n34\n\t\t\t\t - n14 * n21 * n32\n\t\t\t\t + n12 * n21 * n34\n\t\t\t\t + n14 * n22 * n31\n\t\t\t\t - n12 * n24 * n31\n\t\t\t) +\n\t\t\tn44 * (\n\t\t\t\t- n13 * n22 * n31\n\t\t\t\t - n11 * n23 * n32\n\t\t\t\t + n11 * n22 * n33\n\t\t\t\t + n13 * n21 * n32\n\t\t\t\t - n12 * n21 * n33\n\t\t\t\t + n12 * n23 * n31\n\t\t\t)\n\n\t\t);\n\n\t},\n\n\ttranspose: function () {\n\n\t\tvar te = this.elements;\n\t\tvar tmp;\n\n\t\ttmp = te[ 1 ]; te[ 1 ] = te[ 4 ]; te[ 4 ] = tmp;\n\t\ttmp = te[ 2 ]; te[ 2 ] = te[ 8 ]; te[ 8 ] = tmp;\n\t\ttmp = te[ 6 ]; te[ 6 ] = te[ 9 ]; te[ 9 ] = tmp;\n\n\t\ttmp = te[ 3 ]; te[ 3 ] = te[ 12 ]; te[ 12 ] = tmp;\n\t\ttmp = te[ 7 ]; te[ 7 ] = te[ 13 ]; te[ 13 ] = tmp;\n\t\ttmp = te[ 11 ]; te[ 11 ] = te[ 14 ]; te[ 14 ] = tmp;\n\n\t\treturn this;\n\n\t},\n\n\tflattenToArrayOffset: function ( array, offset ) {\n\n\t\tvar te = this.elements;\n\n\t\tarray[ offset ] = te[ 0 ];\n\t\tarray[ offset + 1 ] = te[ 1 ];\n\t\tarray[ offset + 2 ] = te[ 2 ];\n\t\tarray[ offset + 3 ] = te[ 3 ];\n\n\t\tarray[ offset + 4 ] = te[ 4 ];\n\t\tarray[ offset + 5 ] = te[ 5 ];\n\t\tarray[ offset + 6 ] = te[ 6 ];\n\t\tarray[ offset + 7 ] = te[ 7 ];\n\n\t\tarray[ offset + 8 ]  = te[ 8 ];\n\t\tarray[ offset + 9 ]  = te[ 9 ];\n\t\tarray[ offset + 10 ] = te[ 10 ];\n\t\tarray[ offset + 11 ] = te[ 11 ];\n\n\t\tarray[ offset + 12 ] = te[ 12 ];\n\t\tarray[ offset + 13 ] = te[ 13 ];\n\t\tarray[ offset + 14 ] = te[ 14 ];\n\t\tarray[ offset + 15 ] = te[ 15 ];\n\n\t\treturn array;\n\n\t},\n\n\tgetPosition: function () {\n\n\t\tvar v1;\n\n\t\treturn function () {\n\n\t\t\tif ( v1 === undefined ) v1 = new THREE.Vector3();\n\t\t\tconsole.warn( 'THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.' );\n\n\t\t\tvar te = this.elements;\n\t\t\treturn v1.set( te[ 12 ], te[ 13 ], te[ 14 ] );\n\n\t\t};\n\n\t}(),\n\n\tsetPosition: function ( v ) {\n\n\t\tvar te = this.elements;\n\n\t\tte[ 12 ] = v.x;\n\t\tte[ 13 ] = v.y;\n\t\tte[ 14 ] = v.z;\n\n\t\treturn this;\n\n\t},\n\n\tgetInverse: function ( m, throwOnInvertible ) {\n\n\t\t// based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm\n\t\tvar te = this.elements;\n\t\tvar me = m.elements;\n\n\t\tvar n11 = me[ 0 ], n12 = me[ 4 ], n13 = me[ 8 ], n14 = me[ 12 ];\n\t\tvar n21 = me[ 1 ], n22 = me[ 5 ], n23 = me[ 9 ], n24 = me[ 13 ];\n\t\tvar n31 = me[ 2 ], n32 = me[ 6 ], n33 = me[ 10 ], n34 = me[ 14 ];\n\t\tvar n41 = me[ 3 ], n42 = me[ 7 ], n43 = me[ 11 ], n44 = me[ 15 ];\n\n\t\tte[ 0 ] = n23 * n34 * n42 - n24 * n33 * n42 + n24 * n32 * n43 - n22 * n34 * n43 - n23 * n32 * n44 + n22 * n33 * n44;\n\t\tte[ 4 ] = n14 * n33 * n42 - n13 * n34 * n42 - n14 * n32 * n43 + n12 * n34 * n43 + n13 * n32 * n44 - n12 * n33 * n44;\n\t\tte[ 8 ] = n13 * n24 * n42 - n14 * n23 * n42 + n14 * n22 * n43 - n12 * n24 * n43 - n13 * n22 * n44 + n12 * n23 * n44;\n\t\tte[ 12 ] = n14 * n23 * n32 - n13 * n24 * n32 - n14 * n22 * n33 + n12 * n24 * n33 + n13 * n22 * n34 - n12 * n23 * n34;\n\t\tte[ 1 ] = n24 * n33 * n41 - n23 * n34 * n41 - n24 * n31 * n43 + n21 * n34 * n43 + n23 * n31 * n44 - n21 * n33 * n44;\n\t\tte[ 5 ] = n13 * n34 * n41 - n14 * n33 * n41 + n14 * n31 * n43 - n11 * n34 * n43 - n13 * n31 * n44 + n11 * n33 * n44;\n\t\tte[ 9 ] = n14 * n23 * n41 - n13 * n24 * n41 - n14 * n21 * n43 + n11 * n24 * n43 + n13 * n21 * n44 - n11 * n23 * n44;\n\t\tte[ 13 ] = n13 * n24 * n31 - n14 * n23 * n31 + n14 * n21 * n33 - n11 * n24 * n33 - n13 * n21 * n34 + n11 * n23 * n34;\n\t\tte[ 2 ] = n22 * n34 * n41 - n24 * n32 * n41 + n24 * n31 * n42 - n21 * n34 * n42 - n22 * n31 * n44 + n21 * n32 * n44;\n\t\tte[ 6 ] = n14 * n32 * n41 - n12 * n34 * n41 - n14 * n31 * n42 + n11 * n34 * n42 + n12 * n31 * n44 - n11 * n32 * n44;\n\t\tte[ 10 ] = n12 * n24 * n41 - n14 * n22 * n41 + n14 * n21 * n42 - n11 * n24 * n42 - n12 * n21 * n44 + n11 * n22 * n44;\n\t\tte[ 14 ] = n14 * n22 * n31 - n12 * n24 * n31 - n14 * n21 * n32 + n11 * n24 * n32 + n12 * n21 * n34 - n11 * n22 * n34;\n\t\tte[ 3 ] = n23 * n32 * n41 - n22 * n33 * n41 - n23 * n31 * n42 + n21 * n33 * n42 + n22 * n31 * n43 - n21 * n32 * n43;\n\t\tte[ 7 ] = n12 * n33 * n41 - n13 * n32 * n41 + n13 * n31 * n42 - n11 * n33 * n42 - n12 * n31 * n43 + n11 * n32 * n43;\n\t\tte[ 11 ] = n13 * n22 * n41 - n12 * n23 * n41 - n13 * n21 * n42 + n11 * n23 * n42 + n12 * n21 * n43 - n11 * n22 * n43;\n\t\tte[ 15 ] = n12 * n23 * n31 - n13 * n22 * n31 + n13 * n21 * n32 - n11 * n23 * n32 - n12 * n21 * n33 + n11 * n22 * n33;\n\n\t\tvar det = n11 * te[ 0 ] + n21 * te[ 4 ] + n31 * te[ 8 ] + n41 * te[ 12 ];\n\n\t\tif ( det === 0 ) {\n\n\t\t\tvar msg = \"THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0\";\n\n\t\t\tif ( throwOnInvertible || false ) {\n\n\t\t\t\tthrow new Error( msg );\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( msg );\n\n\t\t\t}\n\n\t\t\tthis.identity();\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tthis.multiplyScalar( 1 / det );\n\n\t\treturn this;\n\n\t},\n\n\ttranslate: function ( v ) {\n\n\t\tconsole.error( 'THREE.Matrix4: .translate() has been removed.' );\n\n\t},\n\n\trotateX: function ( angle ) {\n\n\t\tconsole.error( 'THREE.Matrix4: .rotateX() has been removed.' );\n\n\t},\n\n\trotateY: function ( angle ) {\n\n\t\tconsole.error( 'THREE.Matrix4: .rotateY() has been removed.' );\n\n\t},\n\n\trotateZ: function ( angle ) {\n\n\t\tconsole.error( 'THREE.Matrix4: .rotateZ() has been removed.' );\n\n\t},\n\n\trotateByAxis: function ( axis, angle ) {\n\n\t\tconsole.error( 'THREE.Matrix4: .rotateByAxis() has been removed.' );\n\n\t},\n\n\tscale: function ( v ) {\n\n\t\tvar te = this.elements;\n\t\tvar x = v.x, y = v.y, z = v.z;\n\n\t\tte[ 0 ] *= x; te[ 4 ] *= y; te[ 8 ] *= z;\n\t\tte[ 1 ] *= x; te[ 5 ] *= y; te[ 9 ] *= z;\n\t\tte[ 2 ] *= x; te[ 6 ] *= y; te[ 10 ] *= z;\n\t\tte[ 3 ] *= x; te[ 7 ] *= y; te[ 11 ] *= z;\n\n\t\treturn this;\n\n\t},\n\n\tgetMaxScaleOnAxis: function () {\n\n\t\tvar te = this.elements;\n\n\t\tvar scaleXSq = te[ 0 ] * te[ 0 ] + te[ 1 ] * te[ 1 ] + te[ 2 ] * te[ 2 ];\n\t\tvar scaleYSq = te[ 4 ] * te[ 4 ] + te[ 5 ] * te[ 5 ] + te[ 6 ] * te[ 6 ];\n\t\tvar scaleZSq = te[ 8 ] * te[ 8 ] + te[ 9 ] * te[ 9 ] + te[ 10 ] * te[ 10 ];\n\n\t\treturn Math.sqrt( Math.max( scaleXSq, Math.max( scaleYSq, scaleZSq ) ) );\n\n\t},\n\n\tmakeTranslation: function ( x, y, z ) {\n\n\t\tthis.set(\n\n\t\t\t1, 0, 0, x,\n\t\t\t0, 1, 0, y,\n\t\t\t0, 0, 1, z,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t},\n\n\tmakeRotationX: function ( theta ) {\n\n\t\tvar c = Math.cos( theta ), s = Math.sin( theta );\n\n\t\tthis.set(\n\n\t\t\t1, 0,  0, 0,\n\t\t\t0, c, - s, 0,\n\t\t\t0, s,  c, 0,\n\t\t\t0, 0,  0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t},\n\n\tmakeRotationY: function ( theta ) {\n\n\t\tvar c = Math.cos( theta ), s = Math.sin( theta );\n\n\t\tthis.set(\n\n\t\t\t c, 0, s, 0,\n\t\t\t 0, 1, 0, 0,\n\t\t\t- s, 0, c, 0,\n\t\t\t 0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t},\n\n\tmakeRotationZ: function ( theta ) {\n\n\t\tvar c = Math.cos( theta ), s = Math.sin( theta );\n\n\t\tthis.set(\n\n\t\t\tc, - s, 0, 0,\n\t\t\ts,  c, 0, 0,\n\t\t\t0,  0, 1, 0,\n\t\t\t0,  0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t},\n\n\tmakeRotationAxis: function ( axis, angle ) {\n\n\t\t// Based on http://www.gamedev.net/reference/articles/article1199.asp\n\n\t\tvar c = Math.cos( angle );\n\t\tvar s = Math.sin( angle );\n\t\tvar t = 1 - c;\n\t\tvar x = axis.x, y = axis.y, z = axis.z;\n\t\tvar tx = t * x, ty = t * y;\n\n\t\tthis.set(\n\n\t\t\ttx * x + c, tx * y - s * z, tx * z + s * y, 0,\n\t\t\ttx * y + s * z, ty * y + c, ty * z - s * x, 0,\n\t\t\ttx * z - s * y, ty * z + s * x, t * z * z + c, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\t return this;\n\n\t},\n\n\tmakeScale: function ( x, y, z ) {\n\n\t\tthis.set(\n\n\t\t\tx, 0, 0, 0,\n\t\t\t0, y, 0, 0,\n\t\t\t0, 0, z, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t},\n\n\tcompose: function ( position, quaternion, scale ) {\n\n\t\tthis.makeRotationFromQuaternion( quaternion );\n\t\tthis.scale( scale );\n\t\tthis.setPosition( position );\n\n\t\treturn this;\n\n\t},\n\n\tdecompose: function () {\n\n\t\tvar vector, matrix;\n\n\t\treturn function ( position, quaternion, scale ) {\n\n\t\t\tif ( vector === undefined ) vector = new THREE.Vector3();\n\t\t\tif ( matrix === undefined ) matrix = new THREE.Matrix4();\n\n\t\t\tvar te = this.elements;\n\n\t\t\tvar sx = vector.set( te[ 0 ], te[ 1 ], te[ 2 ] ).length();\n\t\t\tvar sy = vector.set( te[ 4 ], te[ 5 ], te[ 6 ] ).length();\n\t\t\tvar sz = vector.set( te[ 8 ], te[ 9 ], te[ 10 ] ).length();\n\n\t\t\t// if determine is negative, we need to invert one scale\n\t\t\tvar det = this.determinant();\n\t\t\tif ( det < 0 ) {\n\n\t\t\t\tsx = - sx;\n\n\t\t\t}\n\n\t\t\tposition.x = te[ 12 ];\n\t\t\tposition.y = te[ 13 ];\n\t\t\tposition.z = te[ 14 ];\n\n\t\t\t// scale the rotation part\n\n\t\t\tmatrix.elements.set( this.elements ); // at this point matrix is incomplete so we can't use .copy()\n\n\t\t\tvar invSX = 1 / sx;\n\t\t\tvar invSY = 1 / sy;\n\t\t\tvar invSZ = 1 / sz;\n\n\t\t\tmatrix.elements[ 0 ] *= invSX;\n\t\t\tmatrix.elements[ 1 ] *= invSX;\n\t\t\tmatrix.elements[ 2 ] *= invSX;\n\n\t\t\tmatrix.elements[ 4 ] *= invSY;\n\t\t\tmatrix.elements[ 5 ] *= invSY;\n\t\t\tmatrix.elements[ 6 ] *= invSY;\n\n\t\t\tmatrix.elements[ 8 ] *= invSZ;\n\t\t\tmatrix.elements[ 9 ] *= invSZ;\n\t\t\tmatrix.elements[ 10 ] *= invSZ;\n\n\t\t\tquaternion.setFromRotationMatrix( matrix );\n\n\t\t\tscale.x = sx;\n\t\t\tscale.y = sy;\n\t\t\tscale.z = sz;\n\n\t\t\treturn this;\n\n\t\t};\n\n\t}(),\n\n\tmakeFrustum: function ( left, right, bottom, top, near, far ) {\n\n\t\tvar te = this.elements;\n\t\tvar x = 2 * near / ( right - left );\n\t\tvar y = 2 * near / ( top - bottom );\n\n\t\tvar a = ( right + left ) / ( right - left );\n\t\tvar b = ( top + bottom ) / ( top - bottom );\n\t\tvar c = - ( far + near ) / ( far - near );\n\t\tvar d = - 2 * far * near / ( far - near );\n\n\t\tte[ 0 ] = x;\tte[ 4 ] = 0;\tte[ 8 ] = a;\tte[ 12 ] = 0;\n\t\tte[ 1 ] = 0;\tte[ 5 ] = y;\tte[ 9 ] = b;\tte[ 13 ] = 0;\n\t\tte[ 2 ] = 0;\tte[ 6 ] = 0;\tte[ 10 ] = c;\tte[ 14 ] = d;\n\t\tte[ 3 ] = 0;\tte[ 7 ] = 0;\tte[ 11 ] = - 1;\tte[ 15 ] = 0;\n\n\t\treturn this;\n\n\t},\n\n\tmakePerspective: function ( fov, aspect, near, far ) {\n\n\t\tvar ymax = near * Math.tan( THREE.Math.degToRad( fov * 0.5 ) );\n\t\tvar ymin = - ymax;\n\t\tvar xmin = ymin * aspect;\n\t\tvar xmax = ymax * aspect;\n\n\t\treturn this.makeFrustum( xmin, xmax, ymin, ymax, near, far );\n\n\t},\n\n\tmakeOrthographic: function ( left, right, top, bottom, near, far ) {\n\n\t\tvar te = this.elements;\n\t\tvar w = right - left;\n\t\tvar h = top - bottom;\n\t\tvar p = far - near;\n\n\t\tvar x = ( right + left ) / w;\n\t\tvar y = ( top + bottom ) / h;\n\t\tvar z = ( far + near ) / p;\n\n\t\tte[ 0 ] = 2 / w;\tte[ 4 ] = 0;\tte[ 8 ] = 0;\tte[ 12 ] = - x;\n\t\tte[ 1 ] = 0;\tte[ 5 ] = 2 / h;\tte[ 9 ] = 0;\tte[ 13 ] = - y;\n\t\tte[ 2 ] = 0;\tte[ 6 ] = 0;\tte[ 10 ] = - 2 / p;\tte[ 14 ] = - z;\n\t\tte[ 3 ] = 0;\tte[ 7 ] = 0;\tte[ 11 ] = 0;\tte[ 15 ] = 1;\n\n\t\treturn this;\n\n\t},\n\n\tequals: function ( matrix ) {\n\n\t\tvar te = this.elements;\n\t\tvar me = matrix.elements;\n\n\t\tfor ( var i = 0; i < 16; i ++ ) {\n\n\t\t\tif ( te[ i ] !== me[ i ] ) return false;\n\n\t\t}\n\n\t\treturn true;\n\n\t},\n\n\tfromArray: function ( array ) {\n\n\t\tthis.elements.set( array );\n\n\t\treturn this;\n\n\t},\n\n\ttoArray: function () {\n\n\t\tvar te = this.elements;\n\n\t\treturn [\n\t\t\tte[ 0 ], te[ 1 ], te[ 2 ], te[ 3 ],\n\t\t\tte[ 4 ], te[ 5 ], te[ 6 ], te[ 7 ],\n\t\t\tte[ 8 ], te[ 9 ], te[ 10 ], te[ 11 ],\n\t\t\tte[ 12 ], te[ 13 ], te[ 14 ], te[ 15 ]\n\t\t];\n\n\t}\n\n};\n\n// File:src/math/Ray.js\n\n/**\n * @author bhouston / http://exocortex.com\n */\n\nTHREE.Ray = function ( origin, direction ) {\n\n\tthis.origin = ( origin !== undefined ) ? origin : new THREE.Vector3();\n\tthis.direction = ( direction !== undefined ) ? direction : new THREE.Vector3();\n\n};\n\nTHREE.Ray.prototype = {\n\n\tconstructor: THREE.Ray,\n\n\tset: function ( origin, direction ) {\n\n\t\tthis.origin.copy( origin );\n\t\tthis.direction.copy( direction );\n\n\t\treturn this;\n\n\t},\n\n\tclone: function () {\n\n\t\treturn new this.constructor().copy( this );\n\n\t},\n\n\tcopy: function ( ray ) {\n\n\t\tthis.origin.copy( ray.origin );\n\t\tthis.direction.copy( ray.direction );\n\n\t\treturn this;\n\n\t},\n\n\tat: function ( t, optionalTarget ) {\n\n\t\tvar result = optionalTarget || new THREE.Vector3();\n\n\t\treturn result.copy( this.direction ).multiplyScalar( t ).add( this.origin );\n\n\t},\n\n\trecast: function () {\n\n\t\tvar v1 = new THREE.Vector3();\n\n\t\treturn function ( t ) {\n\n\t\t\tthis.origin.copy( this.at( t, v1 ) );\n\n\t\t\treturn this;\n\n\t\t};\n\n\t}(),\n\n\tclosestPointToPoint: function ( point, optionalTarget ) {\n\n\t\tvar result = optionalTarget || new THREE.Vector3();\n\t\tresult.subVectors( point, this.origin );\n\t\tvar directionDistance = result.dot( this.direction );\n\n\t\tif ( directionDistance < 0 ) {\n\n\t\t\treturn result.copy( this.origin );\n\n\t\t}\n\n\t\treturn result.copy( this.direction ).multiplyScalar( directionDistance ).add( this.origin );\n\n\t},\n\n\tdistanceToPoint: function ( point ) {\n\n\t\treturn Math.sqrt( this.distanceSqToPoint( point ) );\n\n\t},\n\n\tdistanceSqToPoint: function () {\n\n\t\tvar v1 = new THREE.Vector3();\n\n\t\treturn function ( point ) {\n\n\t\t\tvar directionDistance = v1.subVectors( point, this.origin ).dot( this.direction );\n\n\t\t\t// point behind the ray\n\n\t\t\tif ( directionDistance < 0 ) {\n\n\t\t\t\treturn this.origin.distanceToSquared( point );\n\n\t\t\t}\n\n\t\t\tv1.copy( this.direction ).multiplyScalar( directionDistance ).add( this.origin );\n\n\t\t\treturn v1.distanceToSquared( point );\n\n\t\t};\n\n\t}(),\n\n\tdistanceSqToSegment: function () {\n\n\t\tvar segCenter = new THREE.Vector3();\n\t\tvar segDir = new THREE.Vector3();\n\t\tvar diff = new THREE.Vector3();\n\n\t\treturn function ( v0, v1, optionalPointOnRay, optionalPointOnSegment ) {\n\n\t\t\t// from http://www.geometrictools.com/LibMathematics/Distance/Wm5DistRay3Segment3.cpp\n\t\t\t// It returns the min distance between the ray and the segment\n\t\t\t// defined by v0 and v1\n\t\t\t// It can also set two optional targets :\n\t\t\t// - The closest point on the ray\n\t\t\t// - The closest point on the segment\n\n\t\t\tsegCenter.copy( v0 ).add( v1 ).multiplyScalar( 0.5 );\n\t\t\tsegDir.copy( v1 ).sub( v0 ).normalize();\n\t\t\tdiff.copy( this.origin ).sub( segCenter );\n\n\t\t\tvar segExtent = v0.distanceTo( v1 ) * 0.5;\n\t\t\tvar a01 = - this.direction.dot( segDir );\n\t\t\tvar b0 = diff.dot( this.direction );\n\t\t\tvar b1 = - diff.dot( segDir );\n\t\t\tvar c = diff.lengthSq();\n\t\t\tvar det = Math.abs( 1 - a01 * a01 );\n\t\t\tvar s0, s1, sqrDist, extDet;\n\n\t\t\tif ( det > 0 ) {\n\n\t\t\t\t// The ray and segment are not parallel.\n\n\t\t\t\ts0 = a01 * b1 - b0;\n\t\t\t\ts1 = a01 * b0 - b1;\n\t\t\t\textDet = segExtent * det;\n\n\t\t\t\tif ( s0 >= 0 ) {\n\n\t\t\t\t\tif ( s1 >= - extDet ) {\n\n\t\t\t\t\t\tif ( s1 <= extDet ) {\n\n\t\t\t\t\t\t\t// region 0\n\t\t\t\t\t\t\t// Minimum at interior points of ray and segment.\n\n\t\t\t\t\t\t\tvar invDet = 1 / det;\n\t\t\t\t\t\t\ts0 *= invDet;\n\t\t\t\t\t\t\ts1 *= invDet;\n\t\t\t\t\t\t\tsqrDist = s0 * ( s0 + a01 * s1 + 2 * b0 ) + s1 * ( a01 * s0 + s1 + 2 * b1 ) + c;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t// region 1\n\n\t\t\t\t\t\t\ts1 = segExtent;\n\t\t\t\t\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\n\t\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// region 5\n\n\t\t\t\t\t\ts1 = - segExtent;\n\t\t\t\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\n\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( s1 <= - extDet ) {\n\n\t\t\t\t\t\t// region 4\n\n\t\t\t\t\t\ts0 = Math.max( 0, - ( - a01 * segExtent + b0 ) );\n\t\t\t\t\t\ts1 = ( s0 > 0 ) ? - segExtent : Math.min( Math.max( - segExtent, - b1 ), segExtent );\n\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t\t\t} else if ( s1 <= extDet ) {\n\n\t\t\t\t\t\t// region 3\n\n\t\t\t\t\t\ts0 = 0;\n\t\t\t\t\t\ts1 = Math.min( Math.max( - segExtent, - b1 ), segExtent );\n\t\t\t\t\t\tsqrDist = s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// region 2\n\n\t\t\t\t\t\ts0 = Math.max( 0, - ( a01 * segExtent + b0 ) );\n\t\t\t\t\t\ts1 = ( s0 > 0 ) ? segExtent : Math.min( Math.max( - segExtent, - b1 ), segExtent );\n\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// Ray and segment are parallel.\n\n\t\t\t\ts1 = ( a01 > 0 ) ? - segExtent : segExtent;\n\t\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\n\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t}\n\n\t\t\tif ( optionalPointOnRay ) {\n\n\t\t\t\toptionalPointOnRay.copy( this.direction ).multiplyScalar( s0 ).add( this.origin );\n\n\t\t\t}\n\n\t\t\tif ( optionalPointOnSegment ) {\n\n\t\t\t\toptionalPointOnSegment.copy( segDir ).multiplyScalar( s1 ).add( segCenter );\n\n\t\t\t}\n\n\t\t\treturn sqrDist;\n\n\t\t};\n\n\t}(),\n\n\n\tisIntersectionSphere: function ( sphere ) {\n\n\t\treturn this.distanceToPoint( sphere.center ) <= sphere.radius;\n\n\t},\n\n\tintersectSphere: function () {\n\n\t\t// from http://www.scratchapixel.com/lessons/3d-basic-lessons/lesson-7-intersecting-simple-shapes/ray-sphere-intersection/\n\n\t\tvar v1 = new THREE.Vector3();\n\n\t\treturn function ( sphere, optionalTarget ) {\n\n\t\t\tv1.subVectors( sphere.center, this.origin );\n\n\t\t\tvar tca = v1.dot( this.direction );\n\n\t\t\tvar d2 = v1.dot( v1 ) - tca * tca;\n\n\t\t\tvar radius2 = sphere.radius * sphere.radius;\n\n\t\t\tif ( d2 > radius2 ) return null;\n\n\t\t\tvar thc = Math.sqrt( radius2 - d2 );\n\n\t\t\t// t0 = first intersect point - entrance on front of sphere\n\t\t\tvar t0 = tca - thc;\n\n\t\t\t// t1 = second intersect point - exit point on back of sphere\n\t\t\tvar t1 = tca + thc;\n\n\t\t\t// test to see if both t0 and t1 are behind the ray - if so, return null\n\t\t\tif ( t0 < 0 && t1 < 0 ) return null;\n\n\t\t\t// test to see if t0 is behind the ray:\n\t\t\t// if it is, the ray is inside the sphere, so return the second exit point scaled by t1,\n\t\t\t// in order to always return an intersect point that is in front of the ray.\n\t\t\tif ( t0 < 0 ) return this.at( t1, optionalTarget );\n\n\t\t\t// else t0 is in front of the ray, so return the first collision point scaled by t0\n\t\t\treturn this.at( t0, optionalTarget );\n\n\t\t}\n\n\t}(),\n\n\tisIntersectionPlane: function ( plane ) {\n\n\t\t// check if the ray lies on the plane first\n\n\t\tvar distToPoint = plane.distanceToPoint( this.origin );\n\n\t\tif ( distToPoint === 0 ) {\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\tvar denominator = plane.normal.dot( this.direction );\n\n\t\tif ( denominator * distToPoint < 0 ) {\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\t// ray origin is behind the plane (and is pointing behind it)\n\n\t\treturn false;\n\n\t},\n\n\tdistanceToPlane: function ( plane ) {\n\n\t\tvar denominator = plane.normal.dot( this.direction );\n\t\tif ( denominator === 0 ) {\n\n\t\t\t// line is coplanar, return origin\n\t\t\tif ( plane.distanceToPoint( this.origin ) === 0 ) {\n\n\t\t\t\treturn 0;\n\n\t\t\t}\n\n\t\t\t// Null is preferable to undefined since undefined means.... it is undefined\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tvar t = - ( this.origin.dot( plane.normal ) + plane.constant ) / denominator;\n\n\t\t// Return if the ray never intersects the plane\n\n\t\treturn t >= 0 ? t :  null;\n\n\t},\n\n\tintersectPlane: function ( plane, optionalTarget ) {\n\n\t\tvar t = this.distanceToPlane( plane );\n\n\t\tif ( t === null ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\treturn this.at( t, optionalTarget );\n\n\t},\n\n\tisIntersectionBox: function () {\n\n\t\tvar v = new THREE.Vector3();\n\n\t\treturn function ( box ) {\n\n\t\t\treturn this.intersectBox( box, v ) !== null;\n\n\t\t};\n\n\t}(),\n\n\tintersectBox: function ( box, optionalTarget ) {\n\n\t\t// http://www.scratchapixel.com/lessons/3d-basic-lessons/lesson-7-intersecting-simple-shapes/ray-box-intersection/\n\n\t\tvar tmin, tmax, tymin, tymax, tzmin, tzmax;\n\n\t\tvar invdirx = 1 / this.direction.x,\n\t\t\tinvdiry = 1 / this.direction.y,\n\t\t\tinvdirz = 1 / this.direction.z;\n\n\t\tvar origin = this.origin;\n\n\t\tif ( invdirx >= 0 ) {\n\n\t\t\ttmin = ( box.min.x - origin.x ) * invdirx;\n\t\t\ttmax = ( box.max.x - origin.x ) * invdirx;\n\n\t\t} else {\n\n\t\t\ttmin = ( box.max.x - origin.x ) * invdirx;\n\t\t\ttmax = ( box.min.x - origin.x ) * invdirx;\n\n\t\t}\n\n\t\tif ( invdiry >= 0 ) {\n\n\t\t\ttymin = ( box.min.y - origin.y ) * invdiry;\n\t\t\ttymax = ( box.max.y - origin.y ) * invdiry;\n\n\t\t} else {\n\n\t\t\ttymin = ( box.max.y - origin.y ) * invdiry;\n\t\t\ttymax = ( box.min.y - origin.y ) * invdiry;\n\n\t\t}\n\n\t\tif ( ( tmin > tymax ) || ( tymin > tmax ) ) return null;\n\n\t\t// These lines also handle the case where tmin or tmax is NaN\n\t\t// (result of 0 * Infinity). x !== x returns true if x is NaN\n\n\t\tif ( tymin > tmin || tmin !== tmin ) tmin = tymin;\n\n\t\tif ( tymax < tmax || tmax !== tmax ) tmax = tymax;\n\n\t\tif ( invdirz >= 0 ) {\n\n\t\t\ttzmin = ( box.min.z - origin.z ) * invdirz;\n\t\t\ttzmax = ( box.max.z - origin.z ) * invdirz;\n\n\t\t} else {\n\n\t\t\ttzmin = ( box.max.z - origin.z ) * invdirz;\n\t\t\ttzmax = ( box.min.z - origin.z ) * invdirz;\n\n\t\t}\n\n\t\tif ( ( tmin > tzmax ) || ( tzmin > tmax ) ) return null;\n\n\t\tif ( tzmin > tmin || tmin !== tmin ) tmin = tzmin;\n\n\t\tif ( tzmax < tmax || tmax !== tmax ) tmax = tzmax;\n\n\t\t//return point closest to the ray (positive side)\n\n\t\tif ( tmax < 0 ) return null;\n\n\t\treturn this.at( tmin >= 0 ? tmin : tmax, optionalTarget );\n\n\t},\n\n\tintersectTriangle: function () {\n\n\t\t// Compute the offset origin, edges, and normal.\n\t\tvar diff = new THREE.Vector3();\n\t\tvar edge1 = new THREE.Vector3();\n\t\tvar edge2 = new THREE.Vector3();\n\t\tvar normal = new THREE.Vector3();\n\n\t\treturn function ( a, b, c, backfaceCulling, optionalTarget ) {\n\n\t\t\t// from http://www.geometrictools.com/LibMathematics/Intersection/Wm5IntrRay3Triangle3.cpp\n\n\t\t\tedge1.subVectors( b, a );\n\t\t\tedge2.subVectors( c, a );\n\t\t\tnormal.crossVectors( edge1, edge2 );\n\n\t\t\t// Solve Q + t*D = b1*E1 + b2*E2 (Q = kDiff, D = ray direction,\n\t\t\t// E1 = kEdge1, E2 = kEdge2, N = Cross(E1,E2)) by\n\t\t\t//   |Dot(D,N)|*b1 = sign(Dot(D,N))*Dot(D,Cross(Q,E2))\n\t\t\t//   |Dot(D,N)|*b2 = sign(Dot(D,N))*Dot(D,Cross(E1,Q))\n\t\t\t//   |Dot(D,N)|*t = -sign(Dot(D,N))*Dot(Q,N)\n\t\t\tvar DdN = this.direction.dot( normal );\n\t\t\tvar sign;\n\n\t\t\tif ( DdN > 0 ) {\n\n\t\t\t\tif ( backfaceCulling ) return null;\n\t\t\t\tsign = 1;\n\n\t\t\t} else if ( DdN < 0 ) {\n\n\t\t\t\tsign = - 1;\n\t\t\t\tDdN = - DdN;\n\n\t\t\t} else {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t\tdiff.subVectors( this.origin, a );\n\t\t\tvar DdQxE2 = sign * this.direction.dot( edge2.crossVectors( diff, edge2 ) );\n\n\t\t\t// b1 < 0, no intersection\n\t\t\tif ( DdQxE2 < 0 ) {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t\tvar DdE1xQ = sign * this.direction.dot( edge1.cross( diff ) );\n\n\t\t\t// b2 < 0, no intersection\n\t\t\tif ( DdE1xQ < 0 ) {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t\t// b1+b2 > 1, no intersection\n\t\t\tif ( DdQxE2 + DdE1xQ > DdN ) {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t\t// Line intersects triangle, check if ray does.\n\t\t\tvar QdN = - sign * diff.dot( normal );\n\n\t\t\t// t < 0, no intersection\n\t\t\tif ( QdN < 0 ) {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t\t// Ray intersects triangle.\n\t\t\treturn this.at( QdN / DdN, optionalTarget );\n\n\t\t};\n\n\t}(),\n\n\tapplyMatrix4: function ( matrix4 ) {\n\n\t\tthis.direction.add( this.origin ).applyMatrix4( matrix4 );\n\t\tthis.origin.applyMatrix4( matrix4 );\n\t\tthis.direction.sub( this.origin );\n\t\tthis.direction.normalize();\n\n\t\treturn this;\n\n\t},\n\n\tequals: function ( ray ) {\n\n\t\treturn ray.origin.equals( this.origin ) && ray.direction.equals( this.direction );\n\n\t}\n\n};\n\n// File:src/math/Sphere.js\n\n/**\n * @author bhouston / http://exocortex.com\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.Sphere = function ( center, radius ) {\n\n\tthis.center = ( center !== undefined ) ? center : new THREE.Vector3();\n\tthis.radius = ( radius !== undefined ) ? radius : 0;\n\n};\n\nTHREE.Sphere.prototype = {\n\n\tconstructor: THREE.Sphere,\n\n\tset: function ( center, radius ) {\n\n\t\tthis.center.copy( center );\n\t\tthis.radius = radius;\n\n\t\treturn this;\n\n\t},\n\n\tsetFromPoints: function () {\n\n\t\tvar box = new THREE.Box3();\n\n\t\treturn function ( points, optionalCenter ) {\n\n\t\t\tvar center = this.center;\n\n\t\t\tif ( optionalCenter !== undefined ) {\n\n\t\t\t\tcenter.copy( optionalCenter );\n\n\t\t\t} else {\n\n\t\t\t\tbox.setFromPoints( points ).center( center );\n\n\t\t\t}\n\n\t\t\tvar maxRadiusSq = 0;\n\n\t\t\tfor ( var i = 0, il = points.length; i < il; i ++ ) {\n\n\t\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( points[ i ] ) );\n\n\t\t\t}\n\n\t\t\tthis.radius = Math.sqrt( maxRadiusSq );\n\n\t\t\treturn this;\n\n\t\t};\n\n\t}(),\n\n\tclone: function () {\n\n\t\treturn new this.constructor().copy( this );\n\n\t},\n\n\tcopy: function ( sphere ) {\n\n\t\tthis.center.copy( sphere.center );\n\t\tthis.radius = sphere.radius;\n\n\t\treturn this;\n\n\t},\n\n\tempty: function () {\n\n\t\treturn ( this.radius <= 0 );\n\n\t},\n\n\tcontainsPoint: function ( point ) {\n\n\t\treturn ( point.distanceToSquared( this.center ) <= ( this.radius * this.radius ) );\n\n\t},\n\n\tdistanceToPoint: function ( point ) {\n\n\t\treturn ( point.distanceTo( this.center ) - this.radius );\n\n\t},\n\n\tintersectsSphere: function ( sphere ) {\n\n\t\tvar radiusSum = this.radius + sphere.radius;\n\n\t\treturn sphere.center.distanceToSquared( this.center ) <= ( radiusSum * radiusSum );\n\n\t},\n\n\tclampPoint: function ( point, optionalTarget ) {\n\n\t\tvar deltaLengthSq = this.center.distanceToSquared( point );\n\n\t\tvar result = optionalTarget || new THREE.Vector3();\n\t\tresult.copy( point );\n\n\t\tif ( deltaLengthSq > ( this.radius * this.radius ) ) {\n\n\t\t\tresult.sub( this.center ).normalize();\n\t\t\tresult.multiplyScalar( this.radius ).add( this.center );\n\n\t\t}\n\n\t\treturn result;\n\n\t},\n\n\tgetBoundingBox: function ( optionalTarget ) {\n\n\t\tvar box = optionalTarget || new THREE.Box3();\n\n\t\tbox.set( this.center, this.center );\n\t\tbox.expandByScalar( this.radius );\n\n\t\treturn box;\n\n\t},\n\n\tapplyMatrix4: function ( matrix ) {\n\n\t\tthis.center.applyMatrix4( matrix );\n\t\tthis.radius = this.radius * matrix.getMaxScaleOnAxis();\n\n\t\treturn this;\n\n\t},\n\n\ttranslate: function ( offset ) {\n\n\t\tthis.center.add( offset );\n\n\t\treturn this;\n\n\t},\n\n\tequals: function ( sphere ) {\n\n\t\treturn sphere.center.equals( this.center ) && ( sphere.radius === this.radius );\n\n\t}\n\n};\n\n// File:src/math/Frustum.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n * @author alteredq / http://alteredqualia.com/\n * @author bhouston / http://exocortex.com\n */\n\nTHREE.Frustum = function ( p0, p1, p2, p3, p4, p5 ) {\n\n\tthis.planes = [\n\n\t\t( p0 !== undefined ) ? p0 : new THREE.Plane(),\n\t\t( p1 !== undefined ) ? p1 : new THREE.Plane(),\n\t\t( p2 !== undefined ) ? p2 : new THREE.Plane(),\n\t\t( p3 !== undefined ) ? p3 : new THREE.Plane(),\n\t\t( p4 !== undefined ) ? p4 : new THREE.Plane(),\n\t\t( p5 !== undefined ) ? p5 : new THREE.Plane()\n\n\t];\n\n};\n\nTHREE.Frustum.prototype = {\n\n\tconstructor: THREE.Frustum,\n\n\tset: function ( p0, p1, p2, p3, p4, p5 ) {\n\n\t\tvar planes = this.planes;\n\n\t\tplanes[ 0 ].copy( p0 );\n\t\tplanes[ 1 ].copy( p1 );\n\t\tplanes[ 2 ].copy( p2 );\n\t\tplanes[ 3 ].copy( p3 );\n\t\tplanes[ 4 ].copy( p4 );\n\t\tplanes[ 5 ].copy( p5 );\n\n\t\treturn this;\n\n\t},\n\n\tclone: function () {\n\n\t\treturn new this.constructor().copy( this );\n\n\t},\n\n\tcopy: function ( frustum ) {\n\n\t\tvar planes = this.planes;\n\n\t\tfor ( var i = 0; i < 6; i ++ ) {\n\n\t\t\tplanes[ i ].copy( frustum.planes[ i ] );\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tsetFromMatrix: function ( m ) {\n\n\t\tvar planes = this.planes;\n\t\tvar me = m.elements;\n\t\tvar me0 = me[ 0 ], me1 = me[ 1 ], me2 = me[ 2 ], me3 = me[ 3 ];\n\t\tvar me4 = me[ 4 ], me5 = me[ 5 ], me6 = me[ 6 ], me7 = me[ 7 ];\n\t\tvar me8 = me[ 8 ], me9 = me[ 9 ], me10 = me[ 10 ], me11 = me[ 11 ];\n\t\tvar me12 = me[ 12 ], me13 = me[ 13 ], me14 = me[ 14 ], me15 = me[ 15 ];\n\n\t\tplanes[ 0 ].setComponents( me3 - me0, me7 - me4, me11 - me8, me15 - me12 ).normalize();\n\t\tplanes[ 1 ].setComponents( me3 + me0, me7 + me4, me11 + me8, me15 + me12 ).normalize();\n\t\tplanes[ 2 ].setComponents( me3 + me1, me7 + me5, me11 + me9, me15 + me13 ).normalize();\n\t\tplanes[ 3 ].setComponents( me3 - me1, me7 - me5, me11 - me9, me15 - me13 ).normalize();\n\t\tplanes[ 4 ].setComponents( me3 - me2, me7 - me6, me11 - me10, me15 - me14 ).normalize();\n\t\tplanes[ 5 ].setComponents( me3 + me2, me7 + me6, me11 + me10, me15 + me14 ).normalize();\n\n\t\treturn this;\n\n\t},\n\n\tintersectsObject: function () {\n\n\t\tvar sphere = new THREE.Sphere();\n\n\t\treturn function ( object ) {\n\n\t\t\tvar geometry = object.geometry;\n\n\t\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\n\n\t\t\tsphere.copy( geometry.boundingSphere );\n\t\t\tsphere.applyMatrix4( object.matrixWorld );\n\n\t\t\treturn this.intersectsSphere( sphere );\n\n\t\t};\n\n\t}(),\n\n\tintersectsSphere: function ( sphere ) {\n\n\t\tvar planes = this.planes;\n\t\tvar center = sphere.center;\n\t\tvar negRadius = - sphere.radius;\n\n\t\tfor ( var i = 0; i < 6; i ++ ) {\n\n\t\t\tvar distance = planes[ i ].distanceToPoint( center );\n\n\t\t\tif ( distance < negRadius ) {\n\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn true;\n\n\t},\n\n\tintersectsBox: function () {\n\n\t\tvar p1 = new THREE.Vector3(),\n\t\t\tp2 = new THREE.Vector3();\n\n\t\treturn function ( box ) {\n\n\t\t\tvar planes = this.planes;\n\n\t\t\tfor ( var i = 0; i < 6 ; i ++ ) {\n\n\t\t\t\tvar plane = planes[ i ];\n\n\t\t\t\tp1.x = plane.normal.x > 0 ? box.min.x : box.max.x;\n\t\t\t\tp2.x = plane.normal.x > 0 ? box.max.x : box.min.x;\n\t\t\t\tp1.y = plane.normal.y > 0 ? box.min.y : box.max.y;\n\t\t\t\tp2.y = plane.normal.y > 0 ? box.max.y : box.min.y;\n\t\t\t\tp1.z = plane.normal.z > 0 ? box.min.z : box.max.z;\n\t\t\t\tp2.z = plane.normal.z > 0 ? box.max.z : box.min.z;\n\n\t\t\t\tvar d1 = plane.distanceToPoint( p1 );\n\t\t\t\tvar d2 = plane.distanceToPoint( p2 );\n\n\t\t\t\t// if both outside plane, no intersection\n\n\t\t\t\tif ( d1 < 0 && d2 < 0 ) {\n\n\t\t\t\t\treturn false;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn true;\n\n\t\t};\n\n\t}(),\n\n\n\tcontainsPoint: function ( point ) {\n\n\t\tvar planes = this.planes;\n\n\t\tfor ( var i = 0; i < 6; i ++ ) {\n\n\t\t\tif ( planes[ i ].distanceToPoint( point ) < 0 ) {\n\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n};\n\n// File:src/math/Plane.js\n\n/**\n * @author bhouston / http://exocortex.com\n */\n\nTHREE.Plane = function ( normal, constant ) {\n\n\tthis.normal = ( normal !== undefined ) ? normal : new THREE.Vector3( 1, 0, 0 );\n\tthis.constant = ( constant !== undefined ) ? constant : 0;\n\n};\n\nTHREE.Plane.prototype = {\n\n\tconstructor: THREE.Plane,\n\n\tset: function ( normal, constant ) {\n\n\t\tthis.normal.copy( normal );\n\t\tthis.constant = constant;\n\n\t\treturn this;\n\n\t},\n\n\tsetComponents: function ( x, y, z, w ) {\n\n\t\tthis.normal.set( x, y, z );\n\t\tthis.constant = w;\n\n\t\treturn this;\n\n\t},\n\n\tsetFromNormalAndCoplanarPoint: function ( normal, point ) {\n\n\t\tthis.normal.copy( normal );\n\t\tthis.constant = - point.dot( this.normal );\t// must be this.normal, not normal, as this.normal is normalized\n\n\t\treturn this;\n\n\t},\n\n\tsetFromCoplanarPoints: function () {\n\n\t\tvar v1 = new THREE.Vector3();\n\t\tvar v2 = new THREE.Vector3();\n\n\t\treturn function ( a, b, c ) {\n\n\t\t\tvar normal = v1.subVectors( c, b ).cross( v2.subVectors( a, b ) ).normalize();\n\n\t\t\t// Q: should an error be thrown if normal is zero (e.g. degenerate plane)?\n\n\t\t\tthis.setFromNormalAndCoplanarPoint( normal, a );\n\n\t\t\treturn this;\n\n\t\t};\n\n\t}(),\n\n\tclone: function () {\n\n\t\treturn new this.constructor().copy( this );\n\n\t},\n\n\tcopy: function ( plane ) {\n\n\t\tthis.normal.copy( plane.normal );\n\t\tthis.constant = plane.constant;\n\n\t\treturn this;\n\n\t},\n\n\tnormalize: function () {\n\n\t\t// Note: will lead to a divide by zero if the plane is invalid.\n\n\t\tvar inverseNormalLength = 1.0 / this.normal.length();\n\t\tthis.normal.multiplyScalar( inverseNormalLength );\n\t\tthis.constant *= inverseNormalLength;\n\n\t\treturn this;\n\n\t},\n\n\tnegate: function () {\n\n\t\tthis.constant *= - 1;\n\t\tthis.normal.negate();\n\n\t\treturn this;\n\n\t},\n\n\tdistanceToPoint: function ( point ) {\n\n\t\treturn this.normal.dot( point ) + this.constant;\n\n\t},\n\n\tdistanceToSphere: function ( sphere ) {\n\n\t\treturn this.distanceToPoint( sphere.center ) - sphere.radius;\n\n\t},\n\n\tprojectPoint: function ( point, optionalTarget ) {\n\n\t\treturn this.orthoPoint( point, optionalTarget ).sub( point ).negate();\n\n\t},\n\n\torthoPoint: function ( point, optionalTarget ) {\n\n\t\tvar perpendicularMagnitude = this.distanceToPoint( point );\n\n\t\tvar result = optionalTarget || new THREE.Vector3();\n\t\treturn result.copy( this.normal ).multiplyScalar( perpendicularMagnitude );\n\n\t},\n\n\tisIntersectionLine: function ( line ) {\n\n\t\t// Note: this tests if a line intersects the plane, not whether it (or its end-points) are coplanar with it.\n\n\t\tvar startSign = this.distanceToPoint( line.start );\n\t\tvar endSign = this.distanceToPoint( line.end );\n\n\t\treturn ( startSign < 0 && endSign > 0 ) || ( endSign < 0 && startSign > 0 );\n\n\t},\n\n\tintersectLine: function () {\n\n\t\tvar v1 = new THREE.Vector3();\n\n\t\treturn function ( line, optionalTarget ) {\n\n\t\t\tvar result = optionalTarget || new THREE.Vector3();\n\n\t\t\tvar direction = line.delta( v1 );\n\n\t\t\tvar denominator = this.normal.dot( direction );\n\n\t\t\tif ( denominator === 0 ) {\n\n\t\t\t\t// line is coplanar, return origin\n\t\t\t\tif ( this.distanceToPoint( line.start ) === 0 ) {\n\n\t\t\t\t\treturn result.copy( line.start );\n\n\t\t\t\t}\n\n\t\t\t\t// Unsure if this is the correct method to handle this case.\n\t\t\t\treturn undefined;\n\n\t\t\t}\n\n\t\t\tvar t = - ( line.start.dot( this.normal ) + this.constant ) / denominator;\n\n\t\t\tif ( t < 0 || t > 1 ) {\n\n\t\t\t\treturn undefined;\n\n\t\t\t}\n\n\t\t\treturn result.copy( direction ).multiplyScalar( t ).add( line.start );\n\n\t\t};\n\n\t}(),\n\n\n\tcoplanarPoint: function ( optionalTarget ) {\n\n\t\tvar result = optionalTarget || new THREE.Vector3();\n\t\treturn result.copy( this.normal ).multiplyScalar( - this.constant );\n\n\t},\n\n\tapplyMatrix4: function () {\n\n\t\tvar v1 = new THREE.Vector3();\n\t\tvar v2 = new THREE.Vector3();\n\t\tvar m1 = new THREE.Matrix3();\n\n\t\treturn function ( matrix, optionalNormalMatrix ) {\n\n\t\t\t// compute new normal based on theory here:\n\t\t\t// http://www.songho.ca/opengl/gl_normaltransform.html\n\t\t\tvar normalMatrix = optionalNormalMatrix || m1.getNormalMatrix( matrix );\n\t\t\tvar newNormal = v1.copy( this.normal ).applyMatrix3( normalMatrix );\n\n\t\t\tvar newCoplanarPoint = this.coplanarPoint( v2 );\n\t\t\tnewCoplanarPoint.applyMatrix4( matrix );\n\n\t\t\tthis.setFromNormalAndCoplanarPoint( newNormal, newCoplanarPoint );\n\n\t\t\treturn this;\n\n\t\t};\n\n\t}(),\n\n\ttranslate: function ( offset ) {\n\n\t\tthis.constant = this.constant - offset.dot( this.normal );\n\n\t\treturn this;\n\n\t},\n\n\tequals: function ( plane ) {\n\n\t\treturn plane.normal.equals( this.normal ) && ( plane.constant === this.constant );\n\n\t}\n\n};\n\n// File:src/math/Math.js\n\n/**\n * @author alteredq / http://alteredqualia.com/\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.Math = {\n\n\tgenerateUUID: function () {\n\n\t\t// http://www.broofa.com/Tools/Math.uuid.htm\n\n\t\tvar chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.split( '' );\n\t\tvar uuid = new Array( 36 );\n\t\tvar rnd = 0, r;\n\n\t\treturn function () {\n\n\t\t\tfor ( var i = 0; i < 36; i ++ ) {\n\n\t\t\t\tif ( i === 8 || i === 13 || i === 18 || i === 23 ) {\n\n\t\t\t\t\tuuid[ i ] = '-';\n\n\t\t\t\t} else if ( i === 14 ) {\n\n\t\t\t\t\tuuid[ i ] = '4';\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( rnd <= 0x02 ) rnd = 0x2000000 + ( Math.random() * 0x1000000 ) | 0;\n\t\t\t\t\tr = rnd & 0xf;\n\t\t\t\t\trnd = rnd >> 4;\n\t\t\t\t\tuuid[ i ] = chars[ ( i === 19 ) ? ( r & 0x3 ) | 0x8 : r ];\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn uuid.join( '' );\n\n\t\t};\n\n\t}(),\n\n\t// Clamp value to range <a, b>\n\n\tclamp: function ( x, a, b ) {\n\n\t\treturn ( x < a ) ? a : ( ( x > b ) ? b : x );\n\n\t},\n\n\t// Clamp value to range <a, inf)\n\n\tclampBottom: function ( x, a ) {\n\n\t\treturn x < a ? a : x;\n\n\t},\n\n\t// compute euclidian modulo of m % n\n\t// https://en.wikipedia.org/wiki/Modulo_operation\n\n\teuclideanModulo: function ( n, m ) {\n\n\t\treturn ( ( n % m ) + m ) % m;\n\n\t},\n\n\t// Linear mapping from range <a1, a2> to range <b1, b2>\n\n\tmapLinear: function ( x, a1, a2, b1, b2 ) {\n\n\t\treturn b1 + ( x - a1 ) * ( b2 - b1 ) / ( a2 - a1 );\n\n\t},\n\n\t// http://en.wikipedia.org/wiki/Smoothstep\n\n\tsmoothstep: function ( x, min, max ) {\n\n\t\tif ( x <= min ) return 0;\n\t\tif ( x >= max ) return 1;\n\n\t\tx = ( x - min ) / ( max - min );\n\n\t\treturn x * x * ( 3 - 2 * x );\n\n\t},\n\n\tsmootherstep: function ( x, min, max ) {\n\n\t\tif ( x <= min ) return 0;\n\t\tif ( x >= max ) return 1;\n\n\t\tx = ( x - min ) / ( max - min );\n\n\t\treturn x * x * x * ( x * ( x * 6 - 15 ) + 10 );\n\n\t},\n\n\t// Random float from <0, 1> with 16 bits of randomness\n\t// (standard Math.random() creates repetitive patterns when applied over larger space)\n\n\trandom16: function () {\n\n\t\treturn ( 65280 * Math.random() + 255 * Math.random() ) / 65535;\n\n\t},\n\n\t// Random integer from <low, high> interval\n\n\trandInt: function ( low, high ) {\n\n\t\treturn low + Math.floor( Math.random() * ( high - low + 1 ) );\n\n\t},\n\n\t// Random float from <low, high> interval\n\n\trandFloat: function ( low, high ) {\n\n\t\treturn low + Math.random() * ( high - low );\n\n\t},\n\n\t// Random float from <-range/2, range/2> interval\n\n\trandFloatSpread: function ( range ) {\n\n\t\treturn range * ( 0.5 - Math.random() );\n\n\t},\n\n\tdegToRad: function () {\n\n\t\tvar degreeToRadiansFactor = Math.PI / 180;\n\n\t\treturn function ( degrees ) {\n\n\t\t\treturn degrees * degreeToRadiansFactor;\n\n\t\t};\n\n\t}(),\n\n\tradToDeg: function () {\n\n\t\tvar radianToDegreesFactor = 180 / Math.PI;\n\n\t\treturn function ( radians ) {\n\n\t\t\treturn radians * radianToDegreesFactor;\n\n\t\t};\n\n\t}(),\n\n\tisPowerOfTwo: function ( value ) {\n\n\t\treturn ( value & ( value - 1 ) ) === 0 && value !== 0;\n\n\t},\n\n\tnextPowerOfTwo: function ( value ) {\n\n\t\tvalue --;\n\t\tvalue |= value >> 1;\n\t\tvalue |= value >> 2;\n\t\tvalue |= value >> 4;\n\t\tvalue |= value >> 8;\n\t\tvalue |= value >> 16;\n\t\tvalue ++;\n\n\t\treturn value;\n\n\t}\n\n};\n\n// File:src/math/Spline.js\n\n/**\n * Spline from Tween.js, slightly optimized (and trashed)\n * http://sole.github.com/tween.js/examples/05_spline.html\n *\n * @author mrdoob / http://mrdoob.com/\n * @author alteredq / http://alteredqualia.com/\n */\n\nTHREE.Spline = function ( points ) {\n\n\tthis.points = points;\n\n\tvar c = [], v3 = { x: 0, y: 0, z: 0 },\n\tpoint, intPoint, weight, w2, w3,\n\tpa, pb, pc, pd;\n\n\tthis.initFromArray = function ( a ) {\n\n\t\tthis.points = [];\n\n\t\tfor ( var i = 0; i < a.length; i ++ ) {\n\n\t\t\tthis.points[ i ] = { x: a[ i ][ 0 ], y: a[ i ][ 1 ], z: a[ i ][ 2 ] };\n\n\t\t}\n\n\t};\n\n\tthis.getPoint = function ( k ) {\n\n\t\tpoint = ( this.points.length - 1 ) * k;\n\t\tintPoint = Math.floor( point );\n\t\tweight = point - intPoint;\n\n\t\tc[ 0 ] = intPoint === 0 ? intPoint : intPoint - 1;\n\t\tc[ 1 ] = intPoint;\n\t\tc[ 2 ] = intPoint  > this.points.length - 2 ? this.points.length - 1 : intPoint + 1;\n\t\tc[ 3 ] = intPoint  > this.points.length - 3 ? this.points.length - 1 : intPoint + 2;\n\n\t\tpa = this.points[ c[ 0 ] ];\n\t\tpb = this.points[ c[ 1 ] ];\n\t\tpc = this.points[ c[ 2 ] ];\n\t\tpd = this.points[ c[ 3 ] ];\n\n\t\tw2 = weight * weight;\n\t\tw3 = weight * w2;\n\n\t\tv3.x = interpolate( pa.x, pb.x, pc.x, pd.x, weight, w2, w3 );\n\t\tv3.y = interpolate( pa.y, pb.y, pc.y, pd.y, weight, w2, w3 );\n\t\tv3.z = interpolate( pa.z, pb.z, pc.z, pd.z, weight, w2, w3 );\n\n\t\treturn v3;\n\n\t};\n\n\tthis.getControlPointsArray = function () {\n\n\t\tvar i, p, l = this.points.length,\n\t\t\tcoords = [];\n\n\t\tfor ( i = 0; i < l; i ++ ) {\n\n\t\t\tp = this.points[ i ];\n\t\t\tcoords[ i ] = [ p.x, p.y, p.z ];\n\n\t\t}\n\n\t\treturn coords;\n\n\t};\n\n\t// approximate length by summing linear segments\n\n\tthis.getLength = function ( nSubDivisions ) {\n\n\t\tvar i, index, nSamples, position,\n\t\t\tpoint = 0, intPoint = 0, oldIntPoint = 0,\n\t\t\toldPosition = new THREE.Vector3(),\n\t\t\ttmpVec = new THREE.Vector3(),\n\t\t\tchunkLengths = [],\n\t\t\ttotalLength = 0;\n\n\t\t// first point has 0 length\n\n\t\tchunkLengths[ 0 ] = 0;\n\n\t\tif ( ! nSubDivisions ) nSubDivisions = 100;\n\n\t\tnSamples = this.points.length * nSubDivisions;\n\n\t\toldPosition.copy( this.points[ 0 ] );\n\n\t\tfor ( i = 1; i < nSamples; i ++ ) {\n\n\t\t\tindex = i / nSamples;\n\n\t\t\tposition = this.getPoint( index );\n\t\t\ttmpVec.copy( position );\n\n\t\t\ttotalLength += tmpVec.distanceTo( oldPosition );\n\n\t\t\toldPosition.copy( position );\n\n\t\t\tpoint = ( this.points.length - 1 ) * index;\n\t\t\tintPoint = Math.floor( point );\n\n\t\t\tif ( intPoint !== oldIntPoint ) {\n\n\t\t\t\tchunkLengths[ intPoint ] = totalLength;\n\t\t\t\toldIntPoint = intPoint;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// last point ends with total length\n\n\t\tchunkLengths[ chunkLengths.length ] = totalLength;\n\n\t\treturn { chunks: chunkLengths, total: totalLength };\n\n\t};\n\n\tthis.reparametrizeByArcLength = function ( samplingCoef ) {\n\n\t\tvar i, j,\n\t\t\tindex, indexCurrent, indexNext,\n\t\t\trealDistance,\n\t\t\tsampling, position,\n\t\t\tnewpoints = [],\n\t\t\ttmpVec = new THREE.Vector3(),\n\t\t\tsl = this.getLength();\n\n\t\tnewpoints.push( tmpVec.copy( this.points[ 0 ] ).clone() );\n\n\t\tfor ( i = 1; i < this.points.length; i ++ ) {\n\n\t\t\t//tmpVec.copy( this.points[ i - 1 ] );\n\t\t\t//linearDistance = tmpVec.distanceTo( this.points[ i ] );\n\n\t\t\trealDistance = sl.chunks[ i ] - sl.chunks[ i - 1 ];\n\n\t\t\tsampling = Math.ceil( samplingCoef * realDistance / sl.total );\n\n\t\t\tindexCurrent = ( i - 1 ) / ( this.points.length - 1 );\n\t\t\tindexNext = i / ( this.points.length - 1 );\n\n\t\t\tfor ( j = 1; j < sampling - 1; j ++ ) {\n\n\t\t\t\tindex = indexCurrent + j * ( 1 / sampling ) * ( indexNext - indexCurrent );\n\n\t\t\t\tposition = this.getPoint( index );\n\t\t\t\tnewpoints.push( tmpVec.copy( position ).clone() );\n\n\t\t\t}\n\n\t\t\tnewpoints.push( tmpVec.copy( this.points[ i ] ).clone() );\n\n\t\t}\n\n\t\tthis.points = newpoints;\n\n\t};\n\n\t// Catmull-Rom\n\n\tfunction interpolate( p0, p1, p2, p3, t, t2, t3 ) {\n\n\t\tvar v0 = ( p2 - p0 ) * 0.5,\n\t\t\tv1 = ( p3 - p1 ) * 0.5;\n\n\t\treturn ( 2 * ( p1 - p2 ) + v0 + v1 ) * t3 + ( - 3 * ( p1 - p2 ) - 2 * v0 - v1 ) * t2 + v0 * t + p1;\n\n\t}\n\n};\n\n// File:src/math/Triangle.js\n\n/**\n * @author bhouston / http://exocortex.com\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.Triangle = function ( a, b, c ) {\n\n\tthis.a = ( a !== undefined ) ? a : new THREE.Vector3();\n\tthis.b = ( b !== undefined ) ? b : new THREE.Vector3();\n\tthis.c = ( c !== undefined ) ? c : new THREE.Vector3();\n\n};\n\nTHREE.Triangle.normal = function () {\n\n\tvar v0 = new THREE.Vector3();\n\n\treturn function ( a, b, c, optionalTarget ) {\n\n\t\tvar result = optionalTarget || new THREE.Vector3();\n\n\t\tresult.subVectors( c, b );\n\t\tv0.subVectors( a, b );\n\t\tresult.cross( v0 );\n\n\t\tvar resultLengthSq = result.lengthSq();\n\t\tif ( resultLengthSq > 0 ) {\n\n\t\t\treturn result.multiplyScalar( 1 / Math.sqrt( resultLengthSq ) );\n\n\t\t}\n\n\t\treturn result.set( 0, 0, 0 );\n\n\t};\n\n}();\n\n// static/instance method to calculate barycentric coordinates\n// based on: http://www.blackpawn.com/texts/pointinpoly/default.html\nTHREE.Triangle.barycoordFromPoint = function () {\n\n\tvar v0 = new THREE.Vector3();\n\tvar v1 = new THREE.Vector3();\n\tvar v2 = new THREE.Vector3();\n\n\treturn function ( point, a, b, c, optionalTarget ) {\n\n\t\tv0.subVectors( c, a );\n\t\tv1.subVectors( b, a );\n\t\tv2.subVectors( point, a );\n\n\t\tvar dot00 = v0.dot( v0 );\n\t\tvar dot01 = v0.dot( v1 );\n\t\tvar dot02 = v0.dot( v2 );\n\t\tvar dot11 = v1.dot( v1 );\n\t\tvar dot12 = v1.dot( v2 );\n\n\t\tvar denom = ( dot00 * dot11 - dot01 * dot01 );\n\n\t\tvar result = optionalTarget || new THREE.Vector3();\n\n\t\t// collinear or singular triangle\n\t\tif ( denom === 0 ) {\n\n\t\t\t// arbitrary location outside of triangle?\n\t\t\t// not sure if this is the best idea, maybe should be returning undefined\n\t\t\treturn result.set( - 2, - 1, - 1 );\n\n\t\t}\n\n\t\tvar invDenom = 1 / denom;\n\t\tvar u = ( dot11 * dot02 - dot01 * dot12 ) * invDenom;\n\t\tvar v = ( dot00 * dot12 - dot01 * dot02 ) * invDenom;\n\n\t\t// barycentric coordinates must always sum to 1\n\t\treturn result.set( 1 - u - v, v, u );\n\n\t};\n\n}();\n\nTHREE.Triangle.containsPoint = function () {\n\n\tvar v1 = new THREE.Vector3();\n\n\treturn function ( point, a, b, c ) {\n\n\t\tvar result = THREE.Triangle.barycoordFromPoint( point, a, b, c, v1 );\n\n\t\treturn ( result.x >= 0 ) && ( result.y >= 0 ) && ( ( result.x + result.y ) <= 1 );\n\n\t};\n\n}();\n\nTHREE.Triangle.prototype = {\n\n\tconstructor: THREE.Triangle,\n\n\tset: function ( a, b, c ) {\n\n\t\tthis.a.copy( a );\n\t\tthis.b.copy( b );\n\t\tthis.c.copy( c );\n\n\t\treturn this;\n\n\t},\n\n\tsetFromPointsAndIndices: function ( points, i0, i1, i2 ) {\n\n\t\tthis.a.copy( points[ i0 ] );\n\t\tthis.b.copy( points[ i1 ] );\n\t\tthis.c.copy( points[ i2 ] );\n\n\t\treturn this;\n\n\t},\n\n\tclone: function () {\n\n\t\treturn new this.constructor().copy( this );\n\n\t},\n\n\tcopy: function ( triangle ) {\n\n\t\tthis.a.copy( triangle.a );\n\t\tthis.b.copy( triangle.b );\n\t\tthis.c.copy( triangle.c );\n\n\t\treturn this;\n\n\t},\n\n\tarea: function () {\n\n\t\tvar v0 = new THREE.Vector3();\n\t\tvar v1 = new THREE.Vector3();\n\n\t\treturn function () {\n\n\t\t\tv0.subVectors( this.c, this.b );\n\t\t\tv1.subVectors( this.a, this.b );\n\n\t\t\treturn v0.cross( v1 ).length() * 0.5;\n\n\t\t};\n\n\t}(),\n\n\tmidpoint: function ( optionalTarget ) {\n\n\t\tvar result = optionalTarget || new THREE.Vector3();\n\t\treturn result.addVectors( this.a, this.b ).add( this.c ).multiplyScalar( 1 / 3 );\n\n\t},\n\n\tnormal: function ( optionalTarget ) {\n\n\t\treturn THREE.Triangle.normal( this.a, this.b, this.c, optionalTarget );\n\n\t},\n\n\tplane: function ( optionalTarget ) {\n\n\t\tvar result = optionalTarget || new THREE.Plane();\n\n\t\treturn result.setFromCoplanarPoints( this.a, this.b, this.c );\n\n\t},\n\n\tbarycoordFromPoint: function ( point, optionalTarget ) {\n\n\t\treturn THREE.Triangle.barycoordFromPoint( point, this.a, this.b, this.c, optionalTarget );\n\n\t},\n\n\tcontainsPoint: function ( point ) {\n\n\t\treturn THREE.Triangle.containsPoint( point, this.a, this.b, this.c );\n\n\t},\n\n\tequals: function ( triangle ) {\n\n\t\treturn triangle.a.equals( this.a ) && triangle.b.equals( this.b ) && triangle.c.equals( this.c );\n\n\t}\n\n};\n\n// File:src/core/Clock.js\n\n/**\n * @author alteredq / http://alteredqualia.com/\n */\n\nTHREE.Clock = function ( autoStart ) {\n\n\tthis.autoStart = ( autoStart !== undefined ) ? autoStart : true;\n\n\tthis.startTime = 0;\n\tthis.oldTime = 0;\n\tthis.elapsedTime = 0;\n\n\tthis.running = false;\n\n};\n\nTHREE.Clock.prototype = {\n\n\tconstructor: THREE.Clock,\n\n\tstart: function () {\n\n\t\tthis.startTime = self.performance !== undefined && self.performance.now !== undefined\n\t\t\t\t\t ? self.performance.now()\n\t\t\t\t\t : Date.now();\n\n\t\tthis.oldTime = this.startTime;\n\t\tthis.running = true;\n\n\t},\n\n\tstop: function () {\n\n\t\tthis.getElapsedTime();\n\t\tthis.running = false;\n\n\t},\n\n\tgetElapsedTime: function () {\n\n\t\tthis.getDelta();\n\t\treturn this.elapsedTime;\n\n\t},\n\n\tgetDelta: function () {\n\n\t\tvar diff = 0;\n\n\t\tif ( this.autoStart && ! this.running ) {\n\n\t\t\tthis.start();\n\n\t\t}\n\n\t\tif ( this.running ) {\n\n\t\t\tvar newTime = self.performance !== undefined && self.performance.now !== undefined\n\t\t\t\t\t ? self.performance.now()\n\t\t\t\t\t : Date.now();\n\n\t\t\tdiff = 0.001 * ( newTime - this.oldTime );\n\t\t\tthis.oldTime = newTime;\n\n\t\t\tthis.elapsedTime += diff;\n\n\t\t}\n\n\t\treturn diff;\n\n\t}\n\n};\n\n// File:src/core/EventDispatcher.js\n\n/**\n * https://github.com/mrdoob/eventdispatcher.js/\n */\n\nTHREE.EventDispatcher = function () {};\n\nTHREE.EventDispatcher.prototype = {\n\n\tconstructor: THREE.EventDispatcher,\n\n\tapply: function ( object ) {\n\n\t\tobject.addEventListener = THREE.EventDispatcher.prototype.addEventListener;\n\t\tobject.hasEventListener = THREE.EventDispatcher.prototype.hasEventListener;\n\t\tobject.removeEventListener = THREE.EventDispatcher.prototype.removeEventListener;\n\t\tobject.dispatchEvent = THREE.EventDispatcher.prototype.dispatchEvent;\n\n\t},\n\n\taddEventListener: function ( type, listener ) {\n\n\t\tif ( this._listeners === undefined ) this._listeners = {};\n\n\t\tvar listeners = this._listeners;\n\n\t\tif ( listeners[ type ] === undefined ) {\n\n\t\t\tlisteners[ type ] = [];\n\n\t\t}\n\n\t\tif ( listeners[ type ].indexOf( listener ) === - 1 ) {\n\n\t\t\tlisteners[ type ].push( listener );\n\n\t\t}\n\n\t},\n\n\thasEventListener: function ( type, listener ) {\n\n\t\tif ( this._listeners === undefined ) return false;\n\n\t\tvar listeners = this._listeners;\n\n\t\tif ( listeners[ type ] !== undefined && listeners[ type ].indexOf( listener ) !== - 1 ) {\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\treturn false;\n\n\t},\n\n\tremoveEventListener: function ( type, listener ) {\n\n\t\tif ( this._listeners === undefined ) return;\n\n\t\tvar listeners = this._listeners;\n\t\tvar listenerArray = listeners[ type ];\n\n\t\tif ( listenerArray !== undefined ) {\n\n\t\t\tvar index = listenerArray.indexOf( listener );\n\n\t\t\tif ( index !== - 1 ) {\n\n\t\t\t\tlistenerArray.splice( index, 1 );\n\n\t\t\t}\n\n\t\t}\n\n\t},\n\n\tdispatchEvent: function ( event ) {\n\n\t\tif ( this._listeners === undefined ) return;\n\n\t\tvar listeners = this._listeners;\n\t\tvar listenerArray = listeners[ event.type ];\n\n\t\tif ( listenerArray !== undefined ) {\n\n\t\t\tevent.target = this;\n\n\t\t\tvar array = [];\n\t\t\tvar length = listenerArray.length;\n\n\t\t\tfor ( var i = 0; i < length; i ++ ) {\n\n\t\t\t\tarray[ i ] = listenerArray[ i ];\n\n\t\t\t}\n\n\t\t\tfor ( var i = 0; i < length; i ++ ) {\n\n\t\t\t\tarray[ i ].call( this, event );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n};\n\n// File:src/core/Raycaster.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n * @author bhouston / http://exocortex.com/\n * @author stephomi / http://stephaneginier.com/\n */\n\n( function ( THREE ) {\n\n\tTHREE.Raycaster = function ( origin, direction, near, far ) {\n\n\t\tthis.ray = new THREE.Ray( origin, direction );\n\t\t// direction is assumed to be normalized (for accurate distance calculations)\n\n\t\tthis.near = near || 0;\n\t\tthis.far = far || Infinity;\n\n\t\tthis.params = {\n\t\t\tMesh: {},\n\t\t\tLine: {},\n\t\t\tLOD: {},\n\t\t\tPoints: { threshold: 1 },\n\t\t\tSprite: {}\n\t\t};\n\n\t\tObject.defineProperties( this.params, {\n\t\t\tPointCloud: {\n\t\t\t\tget: function () {\n\t\t\t\t\tconsole.warn( 'THREE.Raycaster: params.PointCloud has been renamed to params.Points.' );\n\t\t\t\t\treturn this.Points;\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\n\t};\n\n\tfunction descSort( a, b ) {\n\n\t\treturn a.distance - b.distance;\n\n\t}\n\n\tvar intersectObject = function ( object, raycaster, intersects, recursive ) {\n\n\t\tif ( object.visible === false ) return;\n\n\t\tobject.raycast( raycaster, intersects );\n\n\t\tif ( recursive === true ) {\n\n\t\t\tvar children = object.children;\n\n\t\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\t\tintersectObject( children[ i ], raycaster, intersects, true );\n\n\t\t\t}\n\n\t\t}\n\n\t};\n\n\t//\n\n\tTHREE.Raycaster.prototype = {\n\n\t\tconstructor: THREE.Raycaster,\n\n\t\tlinePrecision: 1,\n\n\t\tset: function ( origin, direction ) {\n\n\t\t\t// direction is assumed to be normalized (for accurate distance calculations)\n\n\t\t\tthis.ray.set( origin, direction );\n\n\t\t},\n\n\t\tsetFromCamera: function ( coords, camera ) {\n\n\t\t\tif ( camera instanceof THREE.PerspectiveCamera ) {\n\n\t\t\t\tthis.ray.origin.setFromMatrixPosition( camera.matrixWorld );\n\t\t\t\tthis.ray.direction.set( coords.x, coords.y, 0.5 ).unproject( camera ).sub( this.ray.origin ).normalize();\n\n\t\t\t} else if ( camera instanceof THREE.OrthographicCamera ) {\n\n\t\t\t\tthis.ray.origin.set( coords.x, coords.y, - 1 ).unproject( camera );\n\t\t\t\tthis.ray.direction.set( 0, 0, - 1 ).transformDirection( camera.matrixWorld );\n\n\t\t\t} else {\n\n\t\t\t\tconsole.error( 'THREE.Raycaster: Unsupported camera type.' );\n\n\t\t\t}\n\n\t\t},\n\n\t\tintersectObject: function ( object, recursive ) {\n\n\t\t\tvar intersects = [];\n\n\t\t\tintersectObject( object, this, intersects, recursive );\n\n\t\t\tintersects.sort( descSort );\n\n\t\t\treturn intersects;\n\n\t\t},\n\n\t\tintersectObjects: function ( objects, recursive ) {\n\n\t\t\tvar intersects = [];\n\n\t\t\tif ( Array.isArray( objects ) === false ) {\n\n\t\t\t\tconsole.warn( 'THREE.Raycaster.intersectObjects: objects is not an Array.' );\n\t\t\t\treturn intersects;\n\n\t\t\t}\n\n\t\t\tfor ( var i = 0, l = objects.length; i < l; i ++ ) {\n\n\t\t\t\tintersectObject( objects[ i ], this, intersects, recursive );\n\n\t\t\t}\n\n\t\t\tintersects.sort( descSort );\n\n\t\t\treturn intersects;\n\n\t\t}\n\n\t};\n\n}( THREE ) );\n\n// File:src/core/Object3D.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n * @author mikael emtinger / http://gomo.se/\n * @author alteredq / http://alteredqualia.com/\n * @author WestLangley / http://github.com/WestLangley\n * @author elephantatwork / www.elephantatwork.ch\n */\n\nTHREE.Object3D = function () {\n\n\tObject.defineProperty( this, 'id', { value: THREE.Object3DIdCount ++ } );\n\n\tthis.uuid = THREE.Math.generateUUID();\n\n\tthis.name = '';\n\tthis.type = 'Object3D';\n\n\tthis.parent = null;\n\tthis.children = [];\n\n\tthis.up = THREE.Object3D.DefaultUp.clone();\n\n\tvar position = new THREE.Vector3();\n\tvar rotation = new THREE.Euler();\n\tvar quaternion = new THREE.Quaternion();\n\tvar scale = new THREE.Vector3( 1, 1, 1 );\n\n\tvar onRotationChange = function () {\n\n\t\tquaternion.setFromEuler( rotation, false );\n\n\t};\n\n\tvar onQuaternionChange = function () {\n\n\t\trotation.setFromQuaternion( quaternion, undefined, false );\n\n\t};\n\n\trotation.onChange( onRotationChange );\n\tquaternion.onChange( onQuaternionChange );\n\n\tObject.defineProperties( this, {\n\t\tposition: {\n\t\t\tenumerable: true,\n\t\t\tvalue: position\n\t\t},\n\t\trotation: {\n\t\t\tenumerable: true,\n\t\t\tvalue: rotation\n\t\t},\n\t\tquaternion: {\n\t\t\tenumerable: true,\n\t\t\tvalue: quaternion\n\t\t},\n\t\tscale: {\n\t\t\tenumerable: true,\n\t\t\tvalue: scale\n\t\t},\n\t\tmodelViewMatrix: {\n\t\t\tvalue: new THREE.Matrix4()\n\t\t},\n\t\tnormalMatrix: {\n\t\t\tvalue: new THREE.Matrix3()\n\t\t}\n\t} );\n\n\tthis.rotationAutoUpdate = true;\n\n\tthis.matrix = new THREE.Matrix4();\n\tthis.matrixWorld = new THREE.Matrix4();\n\n\tthis.matrixAutoUpdate = THREE.Object3D.DefaultMatrixAutoUpdate;\n\tthis.matrixWorldNeedsUpdate = false;\n\n\tthis.visible = true;\n\n\tthis.castShadow = false;\n\tthis.receiveShadow = false;\n\n\tthis.frustumCulled = true;\n\tthis.renderOrder = 0;\n\n\tthis.userData = {};\n\n};\n\nTHREE.Object3D.DefaultUp = new THREE.Vector3( 0, 1, 0 );\nTHREE.Object3D.DefaultMatrixAutoUpdate = true;\n\nTHREE.Object3D.prototype = {\n\n\tconstructor: THREE.Object3D,\n\n\tget eulerOrder () {\n\n\t\tconsole.warn( 'THREE.Object3D: .eulerOrder has been moved to .rotation.order.' );\n\n\t\treturn this.rotation.order;\n\n\t},\n\n\tset eulerOrder ( value ) {\n\n\t\tconsole.warn( 'THREE.Object3D: .eulerOrder has been moved to .rotation.order.' );\n\n\t\tthis.rotation.order = value;\n\n\t},\n\n\tget useQuaternion () {\n\n\t\tconsole.warn( 'THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.' );\n\n\t},\n\n\tset useQuaternion ( value ) {\n\n\t\tconsole.warn( 'THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.' );\n\n\t},\n\n\tset renderDepth ( value ) {\n\n\t\tconsole.warn( 'THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.' );\n\n\t},\n\n\tapplyMatrix: function ( matrix ) {\n\n\t\tthis.matrix.multiplyMatrices( matrix, this.matrix );\n\n\t\tthis.matrix.decompose( this.position, this.quaternion, this.scale );\n\n\t},\n\n\tsetRotationFromAxisAngle: function ( axis, angle ) {\n\n\t\t// assumes axis is normalized\n\n\t\tthis.quaternion.setFromAxisAngle( axis, angle );\n\n\t},\n\n\tsetRotationFromEuler: function ( euler ) {\n\n\t\tthis.quaternion.setFromEuler( euler, true );\n\n\t},\n\n\tsetRotationFromMatrix: function ( m ) {\n\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n\n\t\tthis.quaternion.setFromRotationMatrix( m );\n\n\t},\n\n\tsetRotationFromQuaternion: function ( q ) {\n\n\t\t// assumes q is normalized\n\n\t\tthis.quaternion.copy( q );\n\n\t},\n\n\trotateOnAxis: function () {\n\n\t\t// rotate object on axis in object space\n\t\t// axis is assumed to be normalized\n\n\t\tvar q1 = new THREE.Quaternion();\n\n\t\treturn function ( axis, angle ) {\n\n\t\t\tq1.setFromAxisAngle( axis, angle );\n\n\t\t\tthis.quaternion.multiply( q1 );\n\n\t\t\treturn this;\n\n\t\t};\n\n\t}(),\n\n\trotateX: function () {\n\n\t\tvar v1 = new THREE.Vector3( 1, 0, 0 );\n\n\t\treturn function ( angle ) {\n\n\t\t\treturn this.rotateOnAxis( v1, angle );\n\n\t\t};\n\n\t}(),\n\n\trotateY: function () {\n\n\t\tvar v1 = new THREE.Vector3( 0, 1, 0 );\n\n\t\treturn function ( angle ) {\n\n\t\t\treturn this.rotateOnAxis( v1, angle );\n\n\t\t};\n\n\t}(),\n\n\trotateZ: function () {\n\n\t\tvar v1 = new THREE.Vector3( 0, 0, 1 );\n\n\t\treturn function ( angle ) {\n\n\t\t\treturn this.rotateOnAxis( v1, angle );\n\n\t\t};\n\n\t}(),\n\n\ttranslateOnAxis: function () {\n\n\t\t// translate object by distance along axis in object space\n\t\t// axis is assumed to be normalized\n\n\t\tvar v1 = new THREE.Vector3();\n\n\t\treturn function ( axis, distance ) {\n\n\t\t\tv1.copy( axis ).applyQuaternion( this.quaternion );\n\n\t\t\tthis.position.add( v1.multiplyScalar( distance ) );\n\n\t\t\treturn this;\n\n\t\t};\n\n\t}(),\n\n\ttranslate: function ( distance, axis ) {\n\n\t\tconsole.warn( 'THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead.' );\n\t\treturn this.translateOnAxis( axis, distance );\n\n\t},\n\n\ttranslateX: function () {\n\n\t\tvar v1 = new THREE.Vector3( 1, 0, 0 );\n\n\t\treturn function ( distance ) {\n\n\t\t\treturn this.translateOnAxis( v1, distance );\n\n\t\t};\n\n\t}(),\n\n\ttranslateY: function () {\n\n\t\tvar v1 = new THREE.Vector3( 0, 1, 0 );\n\n\t\treturn function ( distance ) {\n\n\t\t\treturn this.translateOnAxis( v1, distance );\n\n\t\t};\n\n\t}(),\n\n\ttranslateZ: function () {\n\n\t\tvar v1 = new THREE.Vector3( 0, 0, 1 );\n\n\t\treturn function ( distance ) {\n\n\t\t\treturn this.translateOnAxis( v1, distance );\n\n\t\t};\n\n\t}(),\n\n\tlocalToWorld: function ( vector ) {\n\n\t\treturn vector.applyMatrix4( this.matrixWorld );\n\n\t},\n\n\tworldToLocal: function () {\n\n\t\tvar m1 = new THREE.Matrix4();\n\n\t\treturn function ( vector ) {\n\n\t\t\treturn vector.applyMatrix4( m1.getInverse( this.matrixWorld ) );\n\n\t\t};\n\n\t}(),\n\n\tlookAt: function () {\n\n\t\t// This routine does not support objects with rotated and/or translated parent(s)\n\n\t\tvar m1 = new THREE.Matrix4();\n\n\t\treturn function ( vector ) {\n\n\t\t\tm1.lookAt( vector, this.position, this.up );\n\n\t\t\tthis.quaternion.setFromRotationMatrix( m1 );\n\n\t\t};\n\n\t}(),\n\n\tadd: function ( object ) {\n\n\t\tif ( arguments.length > 1 ) {\n\n\t\t\tfor ( var i = 0; i < arguments.length; i ++ ) {\n\n\t\t\t\tthis.add( arguments[ i ] );\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tif ( object === this ) {\n\n\t\t\tconsole.error( \"THREE.Object3D.add: object can't be added as a child of itself.\", object );\n\t\t\treturn this;\n\n\t\t}\n\n\t\tif ( object instanceof THREE.Object3D ) {\n\n\t\t\tif ( object.parent !== null ) {\n\n\t\t\t\tobject.parent.remove( object );\n\n\t\t\t}\n\n\t\t\tobject.parent = this;\n\t\t\tobject.dispatchEvent( { type: 'added' } );\n\n\t\t\tthis.children.push( object );\n\n\t\t} else {\n\n\t\t\tconsole.error( \"THREE.Object3D.add: object not an instance of THREE.Object3D.\", object );\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tremove: function ( object ) {\n\n\t\tif ( arguments.length > 1 ) {\n\n\t\t\tfor ( var i = 0; i < arguments.length; i ++ ) {\n\n\t\t\t\tthis.remove( arguments[ i ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvar index = this.children.indexOf( object );\n\n\t\tif ( index !== - 1 ) {\n\n\t\t\tobject.parent = null;\n\n\t\t\tobject.dispatchEvent( { type: 'removed' } );\n\n\t\t\tthis.children.splice( index, 1 );\n\n\t\t}\n\n\t},\n\n\tgetChildByName: function ( name ) {\n\n\t\tconsole.warn( 'THREE.Object3D: .getChildByName() has been renamed to .getObjectByName().' );\n\t\treturn this.getObjectByName( name );\n\n\t},\n\n\tgetObjectById: function ( id ) {\n\n\t\treturn this.getObjectByProperty( 'id', id );\n\n\t},\n\n\tgetObjectByName: function ( name ) {\n\n\t\treturn this.getObjectByProperty( 'name', name );\n\n\t},\n\n\tgetObjectByProperty: function ( name, value ) {\n\n\t\tif ( this[ name ] === value ) return this;\n\n\t\tfor ( var i = 0, l = this.children.length; i < l; i ++ ) {\n\n\t\t\tvar child = this.children[ i ];\n\t\t\tvar object = child.getObjectByProperty( name, value );\n\n\t\t\tif ( object !== undefined ) {\n\n\t\t\t\treturn object;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn undefined;\n\n\t},\n\n\tgetWorldPosition: function ( optionalTarget ) {\n\n\t\tvar result = optionalTarget || new THREE.Vector3();\n\n\t\tthis.updateMatrixWorld( true );\n\n\t\treturn result.setFromMatrixPosition( this.matrixWorld );\n\n\t},\n\n\tgetWorldQuaternion: function () {\n\n\t\tvar position = new THREE.Vector3();\n\t\tvar scale = new THREE.Vector3();\n\n\t\treturn function ( optionalTarget ) {\n\n\t\t\tvar result = optionalTarget || new THREE.Quaternion();\n\n\t\t\tthis.updateMatrixWorld( true );\n\n\t\t\tthis.matrixWorld.decompose( position, result, scale );\n\n\t\t\treturn result;\n\n\t\t};\n\n\t}(),\n\n\tgetWorldRotation: function () {\n\n\t\tvar quaternion = new THREE.Quaternion();\n\n\t\treturn function ( optionalTarget ) {\n\n\t\t\tvar result = optionalTarget || new THREE.Euler();\n\n\t\t\tthis.getWorldQuaternion( quaternion );\n\n\t\t\treturn result.setFromQuaternion( quaternion, this.rotation.order, false );\n\n\t\t};\n\n\t}(),\n\n\tgetWorldScale: function () {\n\n\t\tvar position = new THREE.Vector3();\n\t\tvar quaternion = new THREE.Quaternion();\n\n\t\treturn function ( optionalTarget ) {\n\n\t\t\tvar result = optionalTarget || new THREE.Vector3();\n\n\t\t\tthis.updateMatrixWorld( true );\n\n\t\t\tthis.matrixWorld.decompose( position, quaternion, result );\n\n\t\t\treturn result;\n\n\t\t};\n\n\t}(),\n\n\tgetWorldDirection: function () {\n\n\t\tvar quaternion = new THREE.Quaternion();\n\n\t\treturn function ( optionalTarget ) {\n\n\t\t\tvar result = optionalTarget || new THREE.Vector3();\n\n\t\t\tthis.getWorldQuaternion( quaternion );\n\n\t\t\treturn result.set( 0, 0, 1 ).applyQuaternion( quaternion );\n\n\t\t};\n\n\t}(),\n\n\traycast: function () {},\n\n\ttraverse: function ( callback ) {\n\n\t\tcallback( this );\n\n\t\tvar children = this.children;\n\n\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\tchildren[ i ].traverse( callback );\n\n\t\t}\n\n\t},\n\n\ttraverseVisible: function ( callback ) {\n\n\t\tif ( this.visible === false ) return;\n\n\t\tcallback( this );\n\n\t\tvar children = this.children;\n\n\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\tchildren[ i ].traverseVisible( callback );\n\n\t\t}\n\n\t},\n\n\ttraverseAncestors: function ( callback ) {\n\n\t\tvar parent = this.parent;\n\n\t\tif ( parent !== null ) {\n\n\t\t\tcallback( parent );\n\n\t\t\tparent.traverseAncestors( callback );\n\n\t\t}\n\n\t},\n\n\tupdateMatrix: function () {\n\n\t\tthis.matrix.compose( this.position, this.quaternion, this.scale );\n\n\t\tthis.matrixWorldNeedsUpdate = true;\n\n\t},\n\n\tupdateMatrixWorld: function ( force ) {\n\n\t\tif ( this.matrixAutoUpdate === true ) this.updateMatrix();\n\n\t\tif ( this.matrixWorldNeedsUpdate === true || force === true ) {\n\n\t\t\tif ( this.parent === null ) {\n\n\t\t\t\tthis.matrixWorld.copy( this.matrix );\n\n\t\t\t} else {\n\n\t\t\t\tthis.matrixWorld.multiplyMatrices( this.parent.matrixWorld, this.matrix );\n\n\t\t\t}\n\n\t\t\tthis.matrixWorldNeedsUpdate = false;\n\n\t\t\tforce = true;\n\n\t\t}\n\n\t\t// update children\n\n\t\tfor ( var i = 0, l = this.children.length; i < l; i ++ ) {\n\n\t\t\tthis.children[ i ].updateMatrixWorld( force );\n\n\t\t}\n\n\t},\n\n\ttoJSON: function ( meta ) {\n\n\t\tvar isRootObject = ( meta === undefined );\n\n\t\tvar data = {};\n\n\t\t// meta is a hash used to collect geometries, materials.\n\t\t// not providing it implies that this is the root object\n\t\t// being serialized.\n\t\tif ( isRootObject ) {\n\n\t\t\t// initialize meta obj\n\t\t\tmeta = {\n\t\t\t\tgeometries: {},\n\t\t\t\tmaterials: {},\n\t\t\t\ttextures: {},\n\t\t\t\timages: {}\n\t\t\t};\n\n\t\t\tdata.metadata = {\n\t\t\t\tversion: 4.4,\n\t\t\t\ttype: 'Object',\n\t\t\t\tgenerator: 'Object3D.toJSON'\n\t\t\t};\n\n\t\t}\n\n\t\t// standard Object3D serialization\n\n\t\tdata.uuid = this.uuid;\n\t\tdata.type = this.type;\n\n\t\tif ( this.name !== '' ) data.name = this.name;\n\t\tif ( JSON.stringify( this.userData ) !== '{}' ) data.userData = this.userData;\n\t\tif ( this.visible !== true ) data.visible = this.visible;\n\n\t\tdata.matrix = this.matrix.toArray();\n\n\t\tif ( this.children.length > 0 ) {\n\n\t\t\tdata.children = [];\n\n\t\t\tfor ( var i = 0; i < this.children.length; i ++ ) {\n\n\t\t\t\tdata.children.push( this.children[ i ].toJSON( meta ).object );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvar output = {};\n\n\t\tif ( isRootObject ) {\n\n\t\t\tvar geometries = extractFromCache( meta.geometries );\n\t\t\tvar materials = extractFromCache( meta.materials );\n\t\t\tvar textures = extractFromCache( meta.textures );\n\t\t\tvar images = extractFromCache( meta.images );\n\n\t\t\tif ( geometries.length > 0 ) output.geometries = geometries;\n\t\t\tif ( materials.length > 0 ) output.materials = materials;\n\t\t\tif ( textures.length > 0 ) output.textures = textures;\n\t\t\tif ( images.length > 0 ) output.images = images;\n\n\t\t}\n\n\t\toutput.object = data;\n\n\t\treturn output;\n\n\t\t// extract data from the cache hash\n\t\t// remove metadata on each item\n\t\t// and return as array\n\t\tfunction extractFromCache ( cache ) {\n\n\t\t\tvar values = [];\n\t\t\tfor ( var key in cache ) {\n\n\t\t\t\tvar data = cache[ key ];\n\t\t\t\tdelete data.metadata;\n\t\t\t\tvalues.push( data );\n\n\t\t\t}\n\t\t\treturn values;\n\n\t\t}\n\n\t},\n\n\tclone: function ( recursive ) {\n\n\t\treturn new this.constructor().copy( this, recursive );\n\n\t},\n\n\tcopy: function ( source, recursive ) {\n\n\t\tif ( recursive === undefined ) recursive = true;\n\n\t\tthis.name = source.name;\n\n\t\tthis.up.copy( source.up );\n\n\t\tthis.position.copy( source.position );\n\t\tthis.quaternion.copy( source.quaternion );\n\t\tthis.scale.copy( source.scale );\n\n\t\tthis.rotationAutoUpdate = source.rotationAutoUpdate;\n\n\t\tthis.matrix.copy( source.matrix );\n\t\tthis.matrixWorld.copy( source.matrixWorld );\n\n\t\tthis.matrixAutoUpdate = source.matrixAutoUpdate;\n\t\tthis.matrixWorldNeedsUpdate = source.matrixWorldNeedsUpdate;\n\n\t\tthis.visible = source.visible;\n\n\t\tthis.castShadow = source.castShadow;\n\t\tthis.receiveShadow = source.receiveShadow;\n\n\t\tthis.frustumCulled = source.frustumCulled;\n\t\tthis.renderOrder = source.renderOrder;\n\n\t\tthis.userData = JSON.parse( JSON.stringify( source.userData ) );\n\n\t\tif ( recursive === true ) {\n\n\t\t\tfor ( var i = 0; i < source.children.length; i ++ ) {\n\n\t\t\t\tvar child = source.children[ i ];\n\t\t\t\tthis.add( child.clone() );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n};\n\nTHREE.EventDispatcher.prototype.apply( THREE.Object3D.prototype );\n\nTHREE.Object3DIdCount = 0;\n\n// File:src/core/Face3.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n * @author alteredq / http://alteredqualia.com/\n */\n\nTHREE.Face3 = function ( a, b, c, normal, color, materialIndex ) {\n\n\tthis.a = a;\n\tthis.b = b;\n\tthis.c = c;\n\n\tthis.normal = normal instanceof THREE.Vector3 ? normal : new THREE.Vector3();\n\tthis.vertexNormals = Array.isArray( normal ) ? normal : [];\n\n\tthis.color = color instanceof THREE.Color ? color : new THREE.Color();\n\tthis.vertexColors = Array.isArray( color ) ? color : [];\n\n\tthis.materialIndex = materialIndex !== undefined ? materialIndex : 0;\n\n};\n\nTHREE.Face3.prototype = {\n\n\tconstructor: THREE.Face3,\n\n\tclone: function () {\n\n\t\treturn new this.constructor().copy( this );\n\n\t},\n\n\tcopy: function ( source ) {\n\n\t\tthis.a = source.a;\n\t\tthis.b = source.b;\n\t\tthis.c = source.c;\n\n\t\tthis.normal.copy( source.normal );\n\t\tthis.color.copy( source.color );\n\n\t\tthis.materialIndex = source.materialIndex;\n\n\t\tfor ( var i = 0, il = source.vertexNormals.length; i < il; i ++ ) {\n\n\t\t\tthis.vertexNormals[ i ] = source.vertexNormals[ i ].clone();\n\n\t\t}\n\n\t\tfor ( var i = 0, il = source.vertexColors.length; i < il; i ++ ) {\n\n\t\t\tthis.vertexColors[ i ] = source.vertexColors[ i ].clone();\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n};\n\n// File:src/core/Face4.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.Face4 = function ( a, b, c, d, normal, color, materialIndex ) {\n\n\tconsole.warn( 'THREE.Face4 has been removed. A THREE.Face3 will be created instead.' );\n\treturn new THREE.Face3( a, b, c, normal, color, materialIndex );\n\n};\n\n// File:src/core/BufferAttribute.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.BufferAttribute = function ( array, itemSize ) {\n\n\tthis.uuid = THREE.Math.generateUUID();\n\n\tthis.array = array;\n\tthis.itemSize = itemSize;\n\n\tthis.dynamic = false;\n\tthis.updateRange = { offset: 0, count: - 1 };\n\n\tthis.version = 0;\n\n};\n\nTHREE.BufferAttribute.prototype = {\n\n\tconstructor: THREE.BufferAttribute,\n\n\tget length() {\n\n\t\tconsole.warn( 'THREE.BufferAttribute: .length has been deprecated. Please use .count.' );\n\t\treturn this.array.length;\n\n\t},\n\n\tget count() {\n\n\t\treturn this.array.length / this.itemSize;\n\n\t},\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.version ++;\n\n\t},\n\n\tsetDynamic: function ( value ) {\n\n\t\tthis.dynamic = value;\n\n\t\treturn this;\n\n\t},\n\n\tcopy: function ( source ) {\n\n\t\tthis.array = new source.array.constructor( source.array );\n\t\tthis.itemSize = source.itemSize;\n\n\t\tthis.dynamic = source.dynamic;\n\n\t\treturn this;\n\n\t},\n\n\tcopyAt: function ( index1, attribute, index2 ) {\n\n\t\tindex1 *= this.itemSize;\n\t\tindex2 *= attribute.itemSize;\n\n\t\tfor ( var i = 0, l = this.itemSize; i < l; i ++ ) {\n\n\t\t\tthis.array[ index1 + i ] = attribute.array[ index2 + i ];\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tcopyArray: function ( array ) {\n\n\t\tthis.array.set( array );\n\n\t\treturn this;\n\n\t},\n\n\tcopyColorsArray: function ( colors ) {\n\n\t\tvar array = this.array, offset = 0;\n\n\t\tfor ( var i = 0, l = colors.length; i < l; i ++ ) {\n\n\t\t\tvar color = colors[ i ];\n\n\t\t\tif ( color === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyColorsArray(): color is undefined', i );\n\t\t\t\tcolor = new THREE.Color();\n\n\t\t\t}\n\n\t\t\tarray[ offset ++ ] = color.r;\n\t\t\tarray[ offset ++ ] = color.g;\n\t\t\tarray[ offset ++ ] = color.b;\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tcopyIndicesArray: function ( indices ) {\n\n\t\tvar array = this.array, offset = 0;\n\n\t\tfor ( var i = 0, l = indices.length; i < l; i ++ ) {\n\n\t\t\tvar index = indices[ i ];\n\n\t\t\tarray[ offset ++ ] = index.a;\n\t\t\tarray[ offset ++ ] = index.b;\n\t\t\tarray[ offset ++ ] = index.c;\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tcopyVector2sArray: function ( vectors ) {\n\n\t\tvar array = this.array, offset = 0;\n\n\t\tfor ( var i = 0, l = vectors.length; i < l; i ++ ) {\n\n\t\t\tvar vector = vectors[ i ];\n\n\t\t\tif ( vector === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyVector2sArray(): vector is undefined', i );\n\t\t\t\tvector = new THREE.Vector2();\n\n\t\t\t}\n\n\t\t\tarray[ offset ++ ] = vector.x;\n\t\t\tarray[ offset ++ ] = vector.y;\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tcopyVector3sArray: function ( vectors ) {\n\n\t\tvar array = this.array, offset = 0;\n\n\t\tfor ( var i = 0, l = vectors.length; i < l; i ++ ) {\n\n\t\t\tvar vector = vectors[ i ];\n\n\t\t\tif ( vector === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyVector3sArray(): vector is undefined', i );\n\t\t\t\tvector = new THREE.Vector3();\n\n\t\t\t}\n\n\t\t\tarray[ offset ++ ] = vector.x;\n\t\t\tarray[ offset ++ ] = vector.y;\n\t\t\tarray[ offset ++ ] = vector.z;\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tcopyVector4sArray: function ( vectors ) {\n\n\t\tvar array = this.array, offset = 0;\n\n\t\tfor ( var i = 0, l = vectors.length; i < l; i ++ ) {\n\n\t\t\tvar vector = vectors[ i ];\n\n\t\t\tif ( vector === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.BufferAttribute.copyVector4sArray(): vector is undefined', i );\n\t\t\t\tvector = new THREE.Vector4();\n\n\t\t\t}\n\n\t\t\tarray[ offset ++ ] = vector.x;\n\t\t\tarray[ offset ++ ] = vector.y;\n\t\t\tarray[ offset ++ ] = vector.z;\n\t\t\tarray[ offset ++ ] = vector.w;\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tset: function ( value, offset ) {\n\n\t\tif ( offset === undefined ) offset = 0;\n\n\t\tthis.array.set( value, offset );\n\n\t\treturn this;\n\n\t},\n\n\tgetX: function ( index ) {\n\n\t\treturn this.array[ index * this.itemSize ];\n\n\t},\n\n\tsetX: function ( index, x ) {\n\n\t\tthis.array[ index * this.itemSize ] = x;\n\n\t\treturn this;\n\n\t},\n\n\tgetY: function ( index ) {\n\n\t\treturn this.array[ index * this.itemSize + 1 ];\n\n\t},\n\n\tsetY: function ( index, y ) {\n\n\t\tthis.array[ index * this.itemSize + 1 ] = y;\n\n\t\treturn this;\n\n\t},\n\n\tgetZ: function ( index ) {\n\n\t\treturn this.array[ index * this.itemSize + 2 ];\n\n\t},\n\n\tsetZ: function ( index, z ) {\n\n\t\tthis.array[ index * this.itemSize + 2 ] = z;\n\n\t\treturn this;\n\n\t},\n\n\tgetW: function ( index ) {\n\n\t\treturn this.array[ index * this.itemSize + 3 ];\n\n\t},\n\n\tsetW: function ( index, w ) {\n\n\t\tthis.array[ index * this.itemSize + 3 ] = w;\n\n\t\treturn this;\n\n\t},\n\n\tsetXY: function ( index, x, y ) {\n\n\t\tindex *= this.itemSize;\n\n\t\tthis.array[ index + 0 ] = x;\n\t\tthis.array[ index + 1 ] = y;\n\n\t\treturn this;\n\n\t},\n\n\tsetXYZ: function ( index, x, y, z ) {\n\n\t\tindex *= this.itemSize;\n\n\t\tthis.array[ index + 0 ] = x;\n\t\tthis.array[ index + 1 ] = y;\n\t\tthis.array[ index + 2 ] = z;\n\n\t\treturn this;\n\n\t},\n\n\tsetXYZW: function ( index, x, y, z, w ) {\n\n\t\tindex *= this.itemSize;\n\n\t\tthis.array[ index + 0 ] = x;\n\t\tthis.array[ index + 1 ] = y;\n\t\tthis.array[ index + 2 ] = z;\n\t\tthis.array[ index + 3 ] = w;\n\n\t\treturn this;\n\n\t},\n\n\tclone: function () {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n};\n\n//\n\nTHREE.Int8Attribute = function ( array, itemSize ) {\n\n\treturn new THREE.BufferAttribute( new Int8Array( array ), itemSize );\n\n};\n\nTHREE.Uint8Attribute = function ( array, itemSize ) {\n\n\treturn new THREE.BufferAttribute( new Uint8Array( array ), itemSize );\n\n};\n\nTHREE.Uint8ClampedAttribute = function ( array, itemSize ) {\n\n\treturn new THREE.BufferAttribute( new Uint8ClampedArray( array ), itemSize );\n\n};\n\nTHREE.Int16Attribute = function ( array, itemSize ) {\n\n\treturn new THREE.BufferAttribute( new Int16Array( array ), itemSize );\n\n};\n\nTHREE.Uint16Attribute = function ( array, itemSize ) {\n\n\treturn new THREE.BufferAttribute( new Uint16Array( array ), itemSize );\n\n};\n\nTHREE.Int32Attribute = function ( array, itemSize ) {\n\n\treturn new THREE.BufferAttribute( new Int32Array( array ), itemSize );\n\n};\n\nTHREE.Uint32Attribute = function ( array, itemSize ) {\n\n\treturn new THREE.BufferAttribute( new Uint32Array( array ), itemSize );\n\n};\n\nTHREE.Float32Attribute = function ( array, itemSize ) {\n\n\treturn new THREE.BufferAttribute( new Float32Array( array ), itemSize );\n\n};\n\nTHREE.Float64Attribute = function ( array, itemSize ) {\n\n\treturn new THREE.BufferAttribute( new Float64Array( array ), itemSize );\n\n};\n\n\n// Deprecated\n\nTHREE.DynamicBufferAttribute = function ( array, itemSize ) {\n\n\tconsole.warn( 'THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead.' );\n\treturn new THREE.BufferAttribute( array, itemSize ).setDynamic( true );\n\n};\n\n// File:src/core/InstancedBufferAttribute.js\n\n/**\n * @author benaadams / https://twitter.com/ben_a_adams\n */\n\nTHREE.InstancedBufferAttribute = function ( array, itemSize, meshPerAttribute ) {\n\n\tTHREE.BufferAttribute.call( this, array, itemSize );\n\n\tthis.meshPerAttribute = meshPerAttribute || 1;\n\n};\n\nTHREE.InstancedBufferAttribute.prototype = Object.create( THREE.BufferAttribute.prototype );\nTHREE.InstancedBufferAttribute.prototype.constructor = THREE.InstancedBufferAttribute;\n\nTHREE.InstancedBufferAttribute.prototype.copy = function ( source ) {\n\n\tTHREE.BufferAttribute.prototype.copy.call( this, source );\n\n\tthis.meshPerAttribute = source.meshPerAttribute;\n\n\treturn this;\n\n};\n\n// File:src/core/InterleavedBuffer.js\n\n/**\n * @author benaadams / https://twitter.com/ben_a_adams\n */\n\nTHREE.InterleavedBuffer = function ( array, stride ) {\n\n\tthis.uuid = THREE.Math.generateUUID();\n\n\tthis.array = array;\n\tthis.stride = stride;\n\n\tthis.dynamic = false;\n\tthis.updateRange = { offset: 0, count: - 1 };\n\n\tthis.version = 0;\n\n};\n\nTHREE.InterleavedBuffer.prototype = {\n\n\tconstructor: THREE.InterleavedBuffer,\n\n\tget length () {\n\n\t\treturn this.array.length;\n\n\t},\n\n\tget count () {\n\n\t\treturn this.array.length / this.stride;\n\n\t},\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.version ++;\n\n\t},\n\n\tsetDynamic: function ( value ) {\n\n\t\tthis.dynamic = value;\n\n\t\treturn this;\n\n\t},\n\n\tcopy: function ( source ) {\n\n\t\tthis.array = new source.array.constructor( source.array );\n\t\tthis.stride = source.stride;\n\t\tthis.dynamic = source.dynamic;\n\n\t},\n\n\tcopyAt: function ( index1, attribute, index2 ) {\n\n\t\tindex1 *= this.stride;\n\t\tindex2 *= attribute.stride;\n\n\t\tfor ( var i = 0, l = this.stride; i < l; i ++ ) {\n\n\t\t\tthis.array[ index1 + i ] = attribute.array[ index2 + i ];\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tset: function ( value, offset ) {\n\n\t\tif ( offset === undefined ) offset = 0;\n\n\t\tthis.array.set( value, offset );\n\n\t\treturn this;\n\n\t},\n\n\tclone: function () {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n};\n\n// File:src/core/InstancedInterleavedBuffer.js\n\n/**\n * @author benaadams / https://twitter.com/ben_a_adams\n */\n\nTHREE.InstancedInterleavedBuffer = function ( array, stride, meshPerAttribute ) {\n\n\tTHREE.InterleavedBuffer.call( this, array, stride );\n\n\tthis.meshPerAttribute = meshPerAttribute || 1;\n\n};\n\nTHREE.InstancedInterleavedBuffer.prototype = Object.create( THREE.InterleavedBuffer.prototype );\nTHREE.InstancedInterleavedBuffer.prototype.constructor = THREE.InstancedInterleavedBuffer;\n\nTHREE.InstancedInterleavedBuffer.prototype.copy = function ( source ) {\n\n\tTHREE.InterleavedBuffer.prototype.copy.call( this, source );\n\n\tthis.meshPerAttribute = source.meshPerAttribute;\n\n\treturn this;\n\n};\n\n// File:src/core/InterleavedBufferAttribute.js\n\n/**\n * @author benaadams / https://twitter.com/ben_a_adams\n */\n\nTHREE.InterleavedBufferAttribute = function ( interleavedBuffer, itemSize, offset ) {\n\n\tthis.uuid = THREE.Math.generateUUID();\n\n\tthis.data = interleavedBuffer;\n\tthis.itemSize = itemSize;\n\tthis.offset = offset;\n\n};\n\n\nTHREE.InterleavedBufferAttribute.prototype = {\n\n\tconstructor: THREE.InterleavedBufferAttribute,\n\n\tget length() {\n\n\t\tconsole.warn( 'THREE.BufferAttribute: .length has been deprecated. Please use .count.' );\n\t\treturn this.array.length;\n\n\t},\n\n\tget count() {\n\n\t\treturn this.data.array.length / this.data.stride;\n\n\t},\n\n\tsetX: function ( index, x ) {\n\n\t\tthis.data.array[ index * this.data.stride + this.offset ] = x;\n\n\t\treturn this;\n\n\t},\n\n\tsetY: function ( index, y ) {\n\n\t\tthis.data.array[ index * this.data.stride + this.offset + 1 ] = y;\n\n\t\treturn this;\n\n\t},\n\n\tsetZ: function ( index, z ) {\n\n\t\tthis.data.array[ index * this.data.stride + this.offset + 2 ] = z;\n\n\t\treturn this;\n\n\t},\n\n\tsetW: function ( index, w ) {\n\n\t\tthis.data.array[ index * this.data.stride + this.offset + 3 ] = w;\n\n\t\treturn this;\n\n\t},\n\n\tgetX: function ( index ) {\n\n\t\treturn this.data.array[ index * this.data.stride + this.offset ];\n\n\t},\n\n\tgetY: function ( index ) {\n\n\t\treturn this.data.array[ index * this.data.stride + this.offset + 1 ];\n\n\t},\n\n\tgetZ: function ( index ) {\n\n\t\treturn this.data.array[ index * this.data.stride + this.offset + 2 ];\n\n\t},\n\n\tgetW: function ( index ) {\n\n\t\treturn this.data.array[ index * this.data.stride + this.offset + 3 ];\n\n\t},\n\n\tsetXY: function ( index, x, y ) {\n\n\t\tindex = index * this.data.stride + this.offset;\n\n\t\tthis.data.array[ index + 0 ] = x;\n\t\tthis.data.array[ index + 1 ] = y;\n\n\t\treturn this;\n\n\t},\n\n\tsetXYZ: function ( index, x, y, z ) {\n\n\t\tindex = index * this.data.stride + this.offset;\n\n\t\tthis.data.array[ index + 0 ] = x;\n\t\tthis.data.array[ index + 1 ] = y;\n\t\tthis.data.array[ index + 2 ] = z;\n\n\t\treturn this;\n\n\t},\n\n\tsetXYZW: function ( index, x, y, z, w ) {\n\n\t\tindex = index * this.data.stride + this.offset;\n\n\t\tthis.data.array[ index + 0 ] = x;\n\t\tthis.data.array[ index + 1 ] = y;\n\t\tthis.data.array[ index + 2 ] = z;\n\t\tthis.data.array[ index + 3 ] = w;\n\n\t\treturn this;\n\n\t}\n\n};\n\n// File:src/core/Geometry.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n * @author kile / http://kile.stravaganza.org/\n * @author alteredq / http://alteredqualia.com/\n * @author mikael emtinger / http://gomo.se/\n * @author zz85 / http://www.lab4games.net/zz85/blog\n * @author bhouston / http://exocortex.com\n */\n\nTHREE.Geometry = function () {\n\n\tObject.defineProperty( this, 'id', { value: THREE.GeometryIdCount ++ } );\n\n\tthis.uuid = THREE.Math.generateUUID();\n\n\tthis.name = '';\n\tthis.type = 'Geometry';\n\n\tthis.vertices = [];\n\tthis.colors = [];\n\tthis.faces = [];\n\tthis.faceVertexUvs = [ [] ];\n\n\tthis.morphTargets = [];\n\tthis.morphColors = [];\n\tthis.morphNormals = [];\n\n\tthis.skinWeights = [];\n\tthis.skinIndices = [];\n\n\tthis.lineDistances = [];\n\n\tthis.boundingBox = null;\n\tthis.boundingSphere = null;\n\n\t// update flags\n\n\tthis.verticesNeedUpdate = false;\n\tthis.elementsNeedUpdate = false;\n\tthis.uvsNeedUpdate = false;\n\tthis.normalsNeedUpdate = false;\n\tthis.colorsNeedUpdate = false;\n\tthis.lineDistancesNeedUpdate = false;\n\tthis.groupsNeedUpdate = false;\n\n};\n\nTHREE.Geometry.prototype = {\n\n\tconstructor: THREE.Geometry,\n\n\tapplyMatrix: function ( matrix ) {\n\n\t\tvar normalMatrix = new THREE.Matrix3().getNormalMatrix( matrix );\n\n\t\tfor ( var i = 0, il = this.vertices.length; i < il; i ++ ) {\n\n\t\t\tvar vertex = this.vertices[ i ];\n\t\t\tvertex.applyMatrix4( matrix );\n\n\t\t}\n\n\t\tfor ( var i = 0, il = this.faces.length; i < il; i ++ ) {\n\n\t\t\tvar face = this.faces[ i ];\n\t\t\tface.normal.applyMatrix3( normalMatrix ).normalize();\n\n\t\t\tfor ( var j = 0, jl = face.vertexNormals.length; j < jl; j ++ ) {\n\n\t\t\t\tface.vertexNormals[ j ].applyMatrix3( normalMatrix ).normalize();\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( this.boundingBox !== null ) {\n\n\t\t\tthis.computeBoundingBox();\n\n\t\t}\n\n\t\tif ( this.boundingSphere !== null ) {\n\n\t\t\tthis.computeBoundingSphere();\n\n\t\t}\n\n\t\tthis.verticesNeedUpdate = true;\n\t\tthis.normalsNeedUpdate = true;\n\n\t},\n\n\trotateX: function () {\n\n\t\t// rotate geometry around world x-axis\n\n\t\tvar m1;\n\n\t\treturn function rotateX( angle ) {\n\n\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\n\n\t\t\tm1.makeRotationX( angle );\n\n\t\t\tthis.applyMatrix( m1 );\n\n\t\t\treturn this;\n\n\t\t};\n\n\t}(),\n\n\trotateY: function () {\n\n\t\t// rotate geometry around world y-axis\n\n\t\tvar m1;\n\n\t\treturn function rotateY( angle ) {\n\n\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\n\n\t\t\tm1.makeRotationY( angle );\n\n\t\t\tthis.applyMatrix( m1 );\n\n\t\t\treturn this;\n\n\t\t};\n\n\t}(),\n\n\trotateZ: function () {\n\n\t\t// rotate geometry around world z-axis\n\n\t\tvar m1;\n\n\t\treturn function rotateZ( angle ) {\n\n\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\n\n\t\t\tm1.makeRotationZ( angle );\n\n\t\t\tthis.applyMatrix( m1 );\n\n\t\t\treturn this;\n\n\t\t};\n\n\t}(),\n\n\ttranslate: function () {\n\n\t\t// translate geometry\n\n\t\tvar m1;\n\n\t\treturn function translate( x, y, z ) {\n\n\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\n\n\t\t\tm1.makeTranslation( x, y, z );\n\n\t\t\tthis.applyMatrix( m1 );\n\n\t\t\treturn this;\n\n\t\t};\n\n\t}(),\n\n\tscale: function () {\n\n\t\t// scale geometry\n\n\t\tvar m1;\n\n\t\treturn function scale( x, y, z ) {\n\n\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\n\n\t\t\tm1.makeScale( x, y, z );\n\n\t\t\tthis.applyMatrix( m1 );\n\n\t\t\treturn this;\n\n\t\t};\n\n\t}(),\n\n\tlookAt: function () {\n\n\t\tvar obj;\n\n\t\treturn function lookAt( vector ) {\n\n\t\t\tif ( obj === undefined ) obj = new THREE.Object3D();\n\n\t\t\tobj.lookAt( vector );\n\n\t\t\tobj.updateMatrix();\n\n\t\t\tthis.applyMatrix( obj.matrix );\n\n\t\t};\n\n\t}(),\n\n\tfromBufferGeometry: function ( geometry ) {\n\n\t\tvar scope = this;\n\n\t\tvar indices = geometry.index !== null ? geometry.index.array : undefined;\n\t\tvar attributes = geometry.attributes;\n\n\t\tvar vertices = attributes.position.array;\n\t\tvar normals = attributes.normal !== undefined ? attributes.normal.array : undefined;\n\t\tvar colors = attributes.color !== undefined ? attributes.color.array : undefined;\n\t\tvar uvs = attributes.uv !== undefined ? attributes.uv.array : undefined;\n\t\tvar uvs2 = attributes.uv2 !== undefined ? attributes.uv2.array : undefined;\n\n\t\tif ( uvs2 !== undefined ) this.faceVertexUvs[ 1 ] = [];\n\n\t\tvar tempNormals = [];\n\t\tvar tempUVs = [];\n\t\tvar tempUVs2 = [];\n\n\t\tfor ( var i = 0, j = 0, k = 0; i < vertices.length; i += 3, j += 2, k += 4 ) {\n\n\t\t\tscope.vertices.push( new THREE.Vector3( vertices[ i ], vertices[ i + 1 ], vertices[ i + 2 ] ) );\n\n\t\t\tif ( normals !== undefined ) {\n\n\t\t\t\ttempNormals.push( new THREE.Vector3( normals[ i ], normals[ i + 1 ], normals[ i + 2 ] ) );\n\n\t\t\t}\n\n\t\t\tif ( colors !== undefined ) {\n\n\t\t\t\tscope.colors.push( new THREE.Color( colors[ i ], colors[ i + 1 ], colors[ i + 2 ] ) );\n\n\t\t\t}\n\n\t\t\tif ( uvs !== undefined ) {\n\n\t\t\t\ttempUVs.push( new THREE.Vector2( uvs[ j ], uvs[ j + 1 ] ) );\n\n\t\t\t}\n\n\t\t\tif ( uvs2 !== undefined ) {\n\n\t\t\t\ttempUVs2.push( new THREE.Vector2( uvs2[ j ], uvs2[ j + 1 ] ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvar addFace = function ( a, b, c ) {\n\n\t\t\tvar vertexNormals = normals !== undefined ? [ tempNormals[ a ].clone(), tempNormals[ b ].clone(), tempNormals[ c ].clone() ] : [];\n\t\t\tvar vertexColors = colors !== undefined ? [ scope.colors[ a ].clone(), scope.colors[ b ].clone(), scope.colors[ c ].clone() ] : [];\n\n\t\t\tvar face = new THREE.Face3( a, b, c, vertexNormals, vertexColors );\n\n\t\t\tscope.faces.push( face );\n\n\t\t\tif ( uvs !== undefined ) {\n\n\t\t\t\tscope.faceVertexUvs[ 0 ].push( [ tempUVs[ a ].clone(), tempUVs[ b ].clone(), tempUVs[ c ].clone() ] );\n\n\t\t\t}\n\n\t\t\tif ( uvs2 !== undefined ) {\n\n\t\t\t\tscope.faceVertexUvs[ 1 ].push( [ tempUVs2[ a ].clone(), tempUVs2[ b ].clone(), tempUVs2[ c ].clone() ] );\n\n\t\t\t}\n\n\t\t};\n\n\t\tif ( indices !== undefined ) {\n\n\t\t\tvar groups = geometry.groups;\n\n\t\t\tif ( groups.length > 0 ) {\n\n\t\t\t\tfor ( var i = 0; i < groups.length; i ++ ) {\n\n\t\t\t\t\tvar group = groups[ i ];\n\n\t\t\t\t\tvar start = group.start;\n\t\t\t\t\tvar count = group.count;\n\n\t\t\t\t\tfor ( var j = start, jl = start + count; j < jl; j += 3 ) {\n\n\t\t\t\t\t\taddFace( indices[ j ], indices[ j + 1 ], indices[ j + 2 ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tfor ( var i = 0; i < indices.length; i += 3 ) {\n\n\t\t\t\t\taddFace( indices[ i ], indices[ i + 1 ], indices[ i + 2 ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tfor ( var i = 0; i < vertices.length / 3; i += 3 ) {\n\n\t\t\t\taddFace( i, i + 1, i + 2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.computeFaceNormals();\n\n\t\tif ( geometry.boundingBox !== null ) {\n\n\t\t\tthis.boundingBox = geometry.boundingBox.clone();\n\n\t\t}\n\n\t\tif ( geometry.boundingSphere !== null ) {\n\n\t\t\tthis.boundingSphere = geometry.boundingSphere.clone();\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tcenter: function () {\n\n\t\tthis.computeBoundingBox();\n\n\t\tvar offset = this.boundingBox.center().negate();\n\n\t\tthis.translate( offset.x, offset.y, offset.z );\n\n\t\treturn offset;\n\n\t},\n\n\tnormalize: function () {\n\n\t\tthis.computeBoundingSphere();\n\n\t\tvar center = this.boundingSphere.center;\n\t\tvar radius = this.boundingSphere.radius;\n\n\t\tvar s = radius === 0 ? 1 : 1.0 / radius;\n\n\t\tvar matrix = new THREE.Matrix4();\n\t\tmatrix.set(\n\t\t\ts, 0, 0, - s * center.x,\n\t\t\t0, s, 0, - s * center.y,\n\t\t\t0, 0, s, - s * center.z,\n\t\t\t0, 0, 0, 1\n\t\t);\n\n\t\tthis.applyMatrix( matrix );\n\n\t\treturn this;\n\n\t},\n\n\tcomputeFaceNormals: function () {\n\n\t\tvar cb = new THREE.Vector3(), ab = new THREE.Vector3();\n\n\t\tfor ( var f = 0, fl = this.faces.length; f < fl; f ++ ) {\n\n\t\t\tvar face = this.faces[ f ];\n\n\t\t\tvar vA = this.vertices[ face.a ];\n\t\t\tvar vB = this.vertices[ face.b ];\n\t\t\tvar vC = this.vertices[ face.c ];\n\n\t\t\tcb.subVectors( vC, vB );\n\t\t\tab.subVectors( vA, vB );\n\t\t\tcb.cross( ab );\n\n\t\t\tcb.normalize();\n\n\t\t\tface.normal.copy( cb );\n\n\t\t}\n\n\t},\n\n\tcomputeVertexNormals: function ( areaWeighted ) {\n\n\t\tvar v, vl, f, fl, face, vertices;\n\n\t\tvertices = new Array( this.vertices.length );\n\n\t\tfor ( v = 0, vl = this.vertices.length; v < vl; v ++ ) {\n\n\t\t\tvertices[ v ] = new THREE.Vector3();\n\n\t\t}\n\n\t\tif ( areaWeighted ) {\n\n\t\t\t// vertex normals weighted by triangle areas\n\t\t\t// http://www.iquilezles.org/www/articles/normals/normals.htm\n\n\t\t\tvar vA, vB, vC;\n\t\t\tvar cb = new THREE.Vector3(), ab = new THREE.Vector3();\n\n\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\n\n\t\t\t\tface = this.faces[ f ];\n\n\t\t\t\tvA = this.vertices[ face.a ];\n\t\t\t\tvB = this.vertices[ face.b ];\n\t\t\t\tvC = this.vertices[ face.c ];\n\n\t\t\t\tcb.subVectors( vC, vB );\n\t\t\t\tab.subVectors( vA, vB );\n\t\t\t\tcb.cross( ab );\n\n\t\t\t\tvertices[ face.a ].add( cb );\n\t\t\t\tvertices[ face.b ].add( cb );\n\t\t\t\tvertices[ face.c ].add( cb );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\n\n\t\t\t\tface = this.faces[ f ];\n\n\t\t\t\tvertices[ face.a ].add( face.normal );\n\t\t\t\tvertices[ face.b ].add( face.normal );\n\t\t\t\tvertices[ face.c ].add( face.normal );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfor ( v = 0, vl = this.vertices.length; v < vl; v ++ ) {\n\n\t\t\tvertices[ v ].normalize();\n\n\t\t}\n\n\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\n\n\t\t\tface = this.faces[ f ];\n\n\t\t\tvar vertexNormals = face.vertexNormals;\n\n\t\t\tif ( vertexNormals.length === 3 ) {\n\n\t\t\t\tvertexNormals[ 0 ].copy( vertices[ face.a ] );\n\t\t\t\tvertexNormals[ 1 ].copy( vertices[ face.b ] );\n\t\t\t\tvertexNormals[ 2 ].copy( vertices[ face.c ] );\n\n\t\t\t} else {\n\n\t\t\t\tvertexNormals[ 0 ] = vertices[ face.a ].clone();\n\t\t\t\tvertexNormals[ 1 ] = vertices[ face.b ].clone();\n\t\t\t\tvertexNormals[ 2 ] = vertices[ face.c ].clone();\n\n\t\t\t}\n\n\t\t}\n\n\t},\n\n\tcomputeMorphNormals: function () {\n\n\t\tvar i, il, f, fl, face;\n\n\t\t// save original normals\n\t\t// - create temp variables on first access\n\t\t//   otherwise just copy (for faster repeated calls)\n\n\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\n\n\t\t\tface = this.faces[ f ];\n\n\t\t\tif ( ! face.__originalFaceNormal ) {\n\n\t\t\t\tface.__originalFaceNormal = face.normal.clone();\n\n\t\t\t} else {\n\n\t\t\t\tface.__originalFaceNormal.copy( face.normal );\n\n\t\t\t}\n\n\t\t\tif ( ! face.__originalVertexNormals ) face.__originalVertexNormals = [];\n\n\t\t\tfor ( i = 0, il = face.vertexNormals.length; i < il; i ++ ) {\n\n\t\t\t\tif ( ! face.__originalVertexNormals[ i ] ) {\n\n\t\t\t\t\tface.__originalVertexNormals[ i ] = face.vertexNormals[ i ].clone();\n\n\t\t\t\t} else {\n\n\t\t\t\t\tface.__originalVertexNormals[ i ].copy( face.vertexNormals[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t// use temp geometry to compute face and vertex normals for each morph\n\n\t\tvar tmpGeo = new THREE.Geometry();\n\t\ttmpGeo.faces = this.faces;\n\n\t\tfor ( i = 0, il = this.morphTargets.length; i < il; i ++ ) {\n\n\t\t\t// create on first access\n\n\t\t\tif ( ! this.morphNormals[ i ] ) {\n\n\t\t\t\tthis.morphNormals[ i ] = {};\n\t\t\t\tthis.morphNormals[ i ].faceNormals = [];\n\t\t\t\tthis.morphNormals[ i ].vertexNormals = [];\n\n\t\t\t\tvar dstNormalsFace = this.morphNormals[ i ].faceNormals;\n\t\t\t\tvar dstNormalsVertex = this.morphNormals[ i ].vertexNormals;\n\n\t\t\t\tvar faceNormal, vertexNormals;\n\n\t\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\n\n\t\t\t\t\tfaceNormal = new THREE.Vector3();\n\t\t\t\t\tvertexNormals = { a: new THREE.Vector3(), b: new THREE.Vector3(), c: new THREE.Vector3() };\n\n\t\t\t\t\tdstNormalsFace.push( faceNormal );\n\t\t\t\t\tdstNormalsVertex.push( vertexNormals );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar morphNormals = this.morphNormals[ i ];\n\n\t\t\t// set vertices to morph target\n\n\t\t\ttmpGeo.vertices = this.morphTargets[ i ].vertices;\n\n\t\t\t// compute morph normals\n\n\t\t\ttmpGeo.computeFaceNormals();\n\t\t\ttmpGeo.computeVertexNormals();\n\n\t\t\t// store morph normals\n\n\t\t\tvar faceNormal, vertexNormals;\n\n\t\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\n\n\t\t\t\tface = this.faces[ f ];\n\n\t\t\t\tfaceNormal = morphNormals.faceNormals[ f ];\n\t\t\t\tvertexNormals = morphNormals.vertexNormals[ f ];\n\n\t\t\t\tfaceNormal.copy( face.normal );\n\n\t\t\t\tvertexNormals.a.copy( face.vertexNormals[ 0 ] );\n\t\t\t\tvertexNormals.b.copy( face.vertexNormals[ 1 ] );\n\t\t\t\tvertexNormals.c.copy( face.vertexNormals[ 2 ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// restore original normals\n\n\t\tfor ( f = 0, fl = this.faces.length; f < fl; f ++ ) {\n\n\t\t\tface = this.faces[ f ];\n\n\t\t\tface.normal = face.__originalFaceNormal;\n\t\t\tface.vertexNormals = face.__originalVertexNormals;\n\n\t\t}\n\n\t},\n\n\tcomputeTangents: function () {\n\n\t\tconsole.warn( 'THREE.Geometry: .computeTangents() has been removed.' );\n\n\t},\n\n\tcomputeLineDistances: function () {\n\n\t\tvar d = 0;\n\t\tvar vertices = this.vertices;\n\n\t\tfor ( var i = 0, il = vertices.length; i < il; i ++ ) {\n\n\t\t\tif ( i > 0 ) {\n\n\t\t\t\td += vertices[ i ].distanceTo( vertices[ i - 1 ] );\n\n\t\t\t}\n\n\t\t\tthis.lineDistances[ i ] = d;\n\n\t\t}\n\n\t},\n\n\tcomputeBoundingBox: function () {\n\n\t\tif ( this.boundingBox === null ) {\n\n\t\t\tthis.boundingBox = new THREE.Box3();\n\n\t\t}\n\n\t\tthis.boundingBox.setFromPoints( this.vertices );\n\n\t},\n\n\tcomputeBoundingSphere: function () {\n\n\t\tif ( this.boundingSphere === null ) {\n\n\t\t\tthis.boundingSphere = new THREE.Sphere();\n\n\t\t}\n\n\t\tthis.boundingSphere.setFromPoints( this.vertices );\n\n\t},\n\n\tmerge: function ( geometry, matrix, materialIndexOffset ) {\n\n\t\tif ( geometry instanceof THREE.Geometry === false ) {\n\n\t\t\tconsole.error( 'THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.', geometry );\n\t\t\treturn;\n\n\t\t}\n\n\t\tvar normalMatrix,\n\t\tvertexOffset = this.vertices.length,\n\t\tvertices1 = this.vertices,\n\t\tvertices2 = geometry.vertices,\n\t\tfaces1 = this.faces,\n\t\tfaces2 = geometry.faces,\n\t\tuvs1 = this.faceVertexUvs[ 0 ],\n\t\tuvs2 = geometry.faceVertexUvs[ 0 ];\n\n\t\tif ( materialIndexOffset === undefined ) materialIndexOffset = 0;\n\n\t\tif ( matrix !== undefined ) {\n\n\t\t\tnormalMatrix = new THREE.Matrix3().getNormalMatrix( matrix );\n\n\t\t}\n\n\t\t// vertices\n\n\t\tfor ( var i = 0, il = vertices2.length; i < il; i ++ ) {\n\n\t\t\tvar vertex = vertices2[ i ];\n\n\t\t\tvar vertexCopy = vertex.clone();\n\n\t\t\tif ( matrix !== undefined ) vertexCopy.applyMatrix4( matrix );\n\n\t\t\tvertices1.push( vertexCopy );\n\n\t\t}\n\n\t\t// faces\n\n\t\tfor ( i = 0, il = faces2.length; i < il; i ++ ) {\n\n\t\t\tvar face = faces2[ i ], faceCopy, normal, color,\n\t\t\tfaceVertexNormals = face.vertexNormals,\n\t\t\tfaceVertexColors = face.vertexColors;\n\n\t\t\tfaceCopy = new THREE.Face3( face.a + vertexOffset, face.b + vertexOffset, face.c + vertexOffset );\n\t\t\tfaceCopy.normal.copy( face.normal );\n\n\t\t\tif ( normalMatrix !== undefined ) {\n\n\t\t\t\tfaceCopy.normal.applyMatrix3( normalMatrix ).normalize();\n\n\t\t\t}\n\n\t\t\tfor ( var j = 0, jl = faceVertexNormals.length; j < jl; j ++ ) {\n\n\t\t\t\tnormal = faceVertexNormals[ j ].clone();\n\n\t\t\t\tif ( normalMatrix !== undefined ) {\n\n\t\t\t\t\tnormal.applyMatrix3( normalMatrix ).normalize();\n\n\t\t\t\t}\n\n\t\t\t\tfaceCopy.vertexNormals.push( normal );\n\n\t\t\t}\n\n\t\t\tfaceCopy.color.copy( face.color );\n\n\t\t\tfor ( var j = 0, jl = faceVertexColors.length; j < jl; j ++ ) {\n\n\t\t\t\tcolor = faceVertexColors[ j ];\n\t\t\t\tfaceCopy.vertexColors.push( color.clone() );\n\n\t\t\t}\n\n\t\t\tfaceCopy.materialIndex = face.materialIndex + materialIndexOffset;\n\n\t\t\tfaces1.push( faceCopy );\n\n\t\t}\n\n\t\t// uvs\n\n\t\tfor ( i = 0, il = uvs2.length; i < il; i ++ ) {\n\n\t\t\tvar uv = uvs2[ i ], uvCopy = [];\n\n\t\t\tif ( uv === undefined ) {\n\n\t\t\t\tcontinue;\n\n\t\t\t}\n\n\t\t\tfor ( var j = 0, jl = uv.length; j < jl; j ++ ) {\n\n\t\t\t\tuvCopy.push( uv[ j ].clone() );\n\n\t\t\t}\n\n\t\t\tuvs1.push( uvCopy );\n\n\t\t}\n\n\t},\n\n\tmergeMesh: function ( mesh ) {\n\n\t\tif ( mesh instanceof THREE.Mesh === false ) {\n\n\t\t\tconsole.error( 'THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.', mesh );\n\t\t\treturn;\n\n\t\t}\n\n\t\tmesh.matrixAutoUpdate && mesh.updateMatrix();\n\n\t\tthis.merge( mesh.geometry, mesh.matrix );\n\n\t},\n\n\t/*\n\t * Checks for duplicate vertices with hashmap.\n\t * Duplicated vertices are removed\n\t * and faces' vertices are updated.\n\t */\n\n\tmergeVertices: function () {\n\n\t\tvar verticesMap = {}; // Hashmap for looking up vertices by position coordinates (and making sure they are unique)\n\t\tvar unique = [], changes = [];\n\n\t\tvar v, key;\n\t\tvar precisionPoints = 4; // number of decimal points, e.g. 4 for epsilon of 0.0001\n\t\tvar precision = Math.pow( 10, precisionPoints );\n\t\tvar i, il, face;\n\t\tvar indices, j, jl;\n\n\t\tfor ( i = 0, il = this.vertices.length; i < il; i ++ ) {\n\n\t\t\tv = this.vertices[ i ];\n\t\t\tkey = Math.round( v.x * precision ) + '_' + Math.round( v.y * precision ) + '_' + Math.round( v.z * precision );\n\n\t\t\tif ( verticesMap[ key ] === undefined ) {\n\n\t\t\t\tverticesMap[ key ] = i;\n\t\t\t\tunique.push( this.vertices[ i ] );\n\t\t\t\tchanges[ i ] = unique.length - 1;\n\n\t\t\t} else {\n\n\t\t\t\t//console.log('Duplicate vertex found. ', i, ' could be using ', verticesMap[key]);\n\t\t\t\tchanges[ i ] = changes[ verticesMap[ key ] ];\n\n\t\t\t}\n\n\t\t}\n\n\n\t\t// if faces are completely degenerate after merging vertices, we\n\t\t// have to remove them from the geometry.\n\t\tvar faceIndicesToRemove = [];\n\n\t\tfor ( i = 0, il = this.faces.length; i < il; i ++ ) {\n\n\t\t\tface = this.faces[ i ];\n\n\t\t\tface.a = changes[ face.a ];\n\t\t\tface.b = changes[ face.b ];\n\t\t\tface.c = changes[ face.c ];\n\n\t\t\tindices = [ face.a, face.b, face.c ];\n\n\t\t\tvar dupIndex = - 1;\n\n\t\t\t// if any duplicate vertices are found in a Face3\n\t\t\t// we have to remove the face as nothing can be saved\n\t\t\tfor ( var n = 0; n < 3; n ++ ) {\n\n\t\t\t\tif ( indices[ n ] === indices[ ( n + 1 ) % 3 ] ) {\n\n\t\t\t\t\tdupIndex = n;\n\t\t\t\t\tfaceIndicesToRemove.push( i );\n\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfor ( i = faceIndicesToRemove.length - 1; i >= 0; i -- ) {\n\n\t\t\tvar idx = faceIndicesToRemove[ i ];\n\n\t\t\tthis.faces.splice( idx, 1 );\n\n\t\t\tfor ( j = 0, jl = this.faceVertexUvs.length; j < jl; j ++ ) {\n\n\t\t\t\tthis.faceVertexUvs[ j ].splice( idx, 1 );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Use unique set of vertices\n\n\t\tvar diff = this.vertices.length - unique.length;\n\t\tthis.vertices = unique;\n\t\treturn diff;\n\n\t},\n\n\ttoJSON: function () {\n\n\t\tvar data = {\n\t\t\tmetadata: {\n\t\t\t\tversion: 4.4,\n\t\t\t\ttype: 'Geometry',\n\t\t\t\tgenerator: 'Geometry.toJSON'\n\t\t\t}\n\t\t};\n\n\t\t// standard Geometry serialization\n\n\t\tdata.uuid = this.uuid;\n\t\tdata.type = this.type;\n\t\tif ( this.name !== '' ) data.name = this.name;\n\n\t\tif ( this.parameters !== undefined ) {\n\n\t\t\tvar parameters = this.parameters;\n\n\t\t\tfor ( var key in parameters ) {\n\n\t\t\t\tif ( parameters[ key ] !== undefined ) data[ key ] = parameters[ key ];\n\n\t\t\t}\n\n\t\t\treturn data;\n\n\t\t}\n\n\t\tvar vertices = [];\n\n\t\tfor ( var i = 0; i < this.vertices.length; i ++ ) {\n\n\t\t\tvar vertex = this.vertices[ i ];\n\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t}\n\n\t\tvar faces = [];\n\t\tvar normals = [];\n\t\tvar normalsHash = {};\n\t\tvar colors = [];\n\t\tvar colorsHash = {};\n\t\tvar uvs = [];\n\t\tvar uvsHash = {};\n\n\t\tfor ( var i = 0; i < this.faces.length; i ++ ) {\n\n\t\t\tvar face = this.faces[ i ];\n\n\t\t\tvar hasMaterial = false; // face.materialIndex !== undefined;\n\t\t\tvar hasFaceUv = false; // deprecated\n\t\t\tvar hasFaceVertexUv = this.faceVertexUvs[ 0 ][ i ] !== undefined;\n\t\t\tvar hasFaceNormal = face.normal.length() > 0;\n\t\t\tvar hasFaceVertexNormal = face.vertexNormals.length > 0;\n\t\t\tvar hasFaceColor = face.color.r !== 1 || face.color.g !== 1 || face.color.b !== 1;\n\t\t\tvar hasFaceVertexColor = face.vertexColors.length > 0;\n\n\t\t\tvar faceType = 0;\n\n\t\t\tfaceType = setBit( faceType, 0, 0 );\n\t\t\tfaceType = setBit( faceType, 1, hasMaterial );\n\t\t\tfaceType = setBit( faceType, 2, hasFaceUv );\n\t\t\tfaceType = setBit( faceType, 3, hasFaceVertexUv );\n\t\t\tfaceType = setBit( faceType, 4, hasFaceNormal );\n\t\t\tfaceType = setBit( faceType, 5, hasFaceVertexNormal );\n\t\t\tfaceType = setBit( faceType, 6, hasFaceColor );\n\t\t\tfaceType = setBit( faceType, 7, hasFaceVertexColor );\n\n\t\t\tfaces.push( faceType );\n\t\t\tfaces.push( face.a, face.b, face.c );\n\n\t\t\tif ( hasFaceVertexUv ) {\n\n\t\t\t\tvar faceVertexUvs = this.faceVertexUvs[ 0 ][ i ];\n\n\t\t\t\tfaces.push(\n\t\t\t\t\tgetUvIndex( faceVertexUvs[ 0 ] ),\n\t\t\t\t\tgetUvIndex( faceVertexUvs[ 1 ] ),\n\t\t\t\t\tgetUvIndex( faceVertexUvs[ 2 ] )\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t\tif ( hasFaceNormal ) {\n\n\t\t\t\tfaces.push( getNormalIndex( face.normal ) );\n\n\t\t\t}\n\n\t\t\tif ( hasFaceVertexNormal ) {\n\n\t\t\t\tvar vertexNormals = face.vertexNormals;\n\n\t\t\t\tfaces.push(\n\t\t\t\t\tgetNormalIndex( vertexNormals[ 0 ] ),\n\t\t\t\t\tgetNormalIndex( vertexNormals[ 1 ] ),\n\t\t\t\t\tgetNormalIndex( vertexNormals[ 2 ] )\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t\tif ( hasFaceColor ) {\n\n\t\t\t\tfaces.push( getColorIndex( face.color ) );\n\n\t\t\t}\n\n\t\t\tif ( hasFaceVertexColor ) {\n\n\t\t\t\tvar vertexColors = face.vertexColors;\n\n\t\t\t\tfaces.push(\n\t\t\t\t\tgetColorIndex( vertexColors[ 0 ] ),\n\t\t\t\t\tgetColorIndex( vertexColors[ 1 ] ),\n\t\t\t\t\tgetColorIndex( vertexColors[ 2 ] )\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction setBit( value, position, enabled ) {\n\n\t\t\treturn enabled ? value | ( 1 << position ) : value & ( ~ ( 1 << position ) );\n\n\t\t}\n\n\t\tfunction getNormalIndex( normal ) {\n\n\t\t\tvar hash = normal.x.toString() + normal.y.toString() + normal.z.toString();\n\n\t\t\tif ( normalsHash[ hash ] !== undefined ) {\n\n\t\t\t\treturn normalsHash[ hash ];\n\n\t\t\t}\n\n\t\t\tnormalsHash[ hash ] = normals.length / 3;\n\t\t\tnormals.push( normal.x, normal.y, normal.z );\n\n\t\t\treturn normalsHash[ hash ];\n\n\t\t}\n\n\t\tfunction getColorIndex( color ) {\n\n\t\t\tvar hash = color.r.toString() + color.g.toString() + color.b.toString();\n\n\t\t\tif ( colorsHash[ hash ] !== undefined ) {\n\n\t\t\t\treturn colorsHash[ hash ];\n\n\t\t\t}\n\n\t\t\tcolorsHash[ hash ] = colors.length;\n\t\t\tcolors.push( color.getHex() );\n\n\t\t\treturn colorsHash[ hash ];\n\n\t\t}\n\n\t\tfunction getUvIndex( uv ) {\n\n\t\t\tvar hash = uv.x.toString() + uv.y.toString();\n\n\t\t\tif ( uvsHash[ hash ] !== undefined ) {\n\n\t\t\t\treturn uvsHash[ hash ];\n\n\t\t\t}\n\n\t\t\tuvsHash[ hash ] = uvs.length / 2;\n\t\t\tuvs.push( uv.x, uv.y );\n\n\t\t\treturn uvsHash[ hash ];\n\n\t\t}\n\n\t\tdata.data = {};\n\n\t\tdata.data.vertices = vertices;\n\t\tdata.data.normals = normals;\n\t\tif ( colors.length > 0 ) data.data.colors = colors;\n\t\tif ( uvs.length > 0 ) data.data.uvs = [ uvs ]; // temporal backward compatibility\n\t\tdata.data.faces = faces;\n\n\t\treturn data;\n\n\t},\n\n\tclone: function () {\n\n\t\treturn new this.constructor().copy( this );\n\n\t},\n\n\tcopy: function ( source ) {\n\n\t\tthis.vertices = [];\n\t\tthis.faces = [];\n\t\tthis.faceVertexUvs = [ [] ];\n\n\t\tvar vertices = source.vertices;\n\n\t\tfor ( var i = 0, il = vertices.length; i < il; i ++ ) {\n\n\t\t\tthis.vertices.push( vertices[ i ].clone() );\n\n\t\t}\n\n\t\tvar faces = source.faces;\n\n\t\tfor ( var i = 0, il = faces.length; i < il; i ++ ) {\n\n\t\t\tthis.faces.push( faces[ i ].clone() );\n\n\t\t}\n\n\t\tfor ( var i = 0, il = source.faceVertexUvs.length; i < il; i ++ ) {\n\n\t\t\tvar faceVertexUvs = source.faceVertexUvs[ i ];\n\n\t\t\tif ( this.faceVertexUvs[ i ] === undefined ) {\n\n\t\t\t\tthis.faceVertexUvs[ i ] = [];\n\n\t\t\t}\n\n\t\t\tfor ( var j = 0, jl = faceVertexUvs.length; j < jl; j ++ ) {\n\n\t\t\t\tvar uvs = faceVertexUvs[ j ], uvsCopy = [];\n\n\t\t\t\tfor ( var k = 0, kl = uvs.length; k < kl; k ++ ) {\n\n\t\t\t\t\tvar uv = uvs[ k ];\n\n\t\t\t\t\tuvsCopy.push( uv.clone() );\n\n\t\t\t\t}\n\n\t\t\t\tthis.faceVertexUvs[ i ].push( uvsCopy );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tdispose: function () {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t}\n\n};\n\nTHREE.EventDispatcher.prototype.apply( THREE.Geometry.prototype );\n\nTHREE.GeometryIdCount = 0;\n\n// File:src/core/DirectGeometry.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.DirectGeometry = function () {\n\n\tObject.defineProperty( this, 'id', { value: THREE.GeometryIdCount ++ } );\n\n\tthis.uuid = THREE.Math.generateUUID();\n\n\tthis.name = '';\n\tthis.type = 'DirectGeometry';\n\n\tthis.indices = [];\n\tthis.vertices = [];\n\tthis.normals = [];\n\tthis.colors = [];\n\tthis.uvs = [];\n\tthis.uvs2 = [];\n\n\tthis.groups = [];\n\n\tthis.morphTargets = {};\n\n\tthis.skinWeights = [];\n\tthis.skinIndices = [];\n\n\t// this.lineDistances = [];\n\n\tthis.boundingBox = null;\n\tthis.boundingSphere = null;\n\n\t// update flags\n\n\tthis.verticesNeedUpdate = false;\n\tthis.normalsNeedUpdate = false;\n\tthis.colorsNeedUpdate = false;\n\tthis.uvsNeedUpdate = false;\n\tthis.groupsNeedUpdate = false;\n\n};\n\nTHREE.DirectGeometry.prototype = {\n\n\tconstructor: THREE.DirectGeometry,\n\n\tcomputeBoundingBox: THREE.Geometry.prototype.computeBoundingBox,\n\tcomputeBoundingSphere: THREE.Geometry.prototype.computeBoundingSphere,\n\n\tcomputeFaceNormals: function () {\n\n\t\tconsole.warn( 'THREE.DirectGeometry: computeFaceNormals() is not a method of this type of geometry.' );\n\n\t},\n\n\tcomputeVertexNormals: function () {\n\n\t\tconsole.warn( 'THREE.DirectGeometry: computeVertexNormals() is not a method of this type of geometry.' );\n\n\t},\n\n\tcomputeGroups: function ( geometry ) {\n\n\t\tvar group;\n\t\tvar groups = [];\n\t\tvar materialIndex;\n\n\t\tvar faces = geometry.faces;\n\n\t\tfor ( var i = 0; i < faces.length; i ++ ) {\n\n\t\t\tvar face = faces[ i ];\n\n\t\t\t// materials\n\n\t\t\tif ( face.materialIndex !== materialIndex ) {\n\n\t\t\t\tmaterialIndex = face.materialIndex;\n\n\t\t\t\tif ( group !== undefined ) {\n\n\t\t\t\t\tgroup.count = ( i * 3 ) - group.start;\n\t\t\t\t\tgroups.push( group );\n\n\t\t\t\t}\n\n\t\t\t\tgroup = {\n\t\t\t\t\tstart: i * 3,\n\t\t\t\t\tmaterialIndex: materialIndex\n\t\t\t\t};\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( group !== undefined ) {\n\n\t\t\tgroup.count = ( i * 3 ) - group.start;\n\t\t\tgroups.push( group );\n\n\t\t}\n\n\t\tthis.groups = groups;\n\n\t},\n\n\tfromGeometry: function ( geometry ) {\n\n\t\tvar faces = geometry.faces;\n\t\tvar vertices = geometry.vertices;\n\t\tvar faceVertexUvs = geometry.faceVertexUvs;\n\n\t\tvar hasFaceVertexUv = faceVertexUvs[ 0 ] && faceVertexUvs[ 0 ].length > 0;\n\t\tvar hasFaceVertexUv2 = faceVertexUvs[ 1 ] && faceVertexUvs[ 1 ].length > 0;\n\n\t\t// morphs\n\n\t\tvar morphTargets = geometry.morphTargets;\n\t\tvar morphTargetsLength = morphTargets.length;\n\n\t\tif ( morphTargetsLength > 0 ) {\n\n\t\t\tvar morphTargetsPosition = [];\n\n\t\t\tfor ( var i = 0; i < morphTargetsLength; i ++ ) {\n\n\t\t\t\tmorphTargetsPosition[ i ] = [];\n\n\t\t\t}\n\n\t\t\tthis.morphTargets.position = morphTargetsPosition;\n\n\t\t}\n\n\t\tvar morphNormals = geometry.morphNormals;\n\t\tvar morphNormalsLength = morphNormals.length;\n\n\t\tif ( morphNormalsLength > 0 ) {\n\n\t\t\tvar morphTargetsNormal = [];\n\n\t\t\tfor ( var i = 0; i < morphNormalsLength; i ++ ) {\n\n\t\t\t\tmorphTargetsNormal[ i ] = [];\n\n\t\t\t}\n\n\t\t\tthis.morphTargets.normal = morphTargetsNormal;\n\n\t\t}\n\n\t\t// skins\n\n\t\tvar skinIndices = geometry.skinIndices;\n\t\tvar skinWeights = geometry.skinWeights;\n\n\t\tvar hasSkinIndices = skinIndices.length === vertices.length;\n\t\tvar hasSkinWeights = skinWeights.length === vertices.length;\n\n\t\t//\n\n\t\tfor ( var i = 0; i < faces.length; i ++ ) {\n\n\t\t\tvar face = faces[ i ];\n\n\t\t\tthis.vertices.push( vertices[ face.a ], vertices[ face.b ], vertices[ face.c ] );\n\n\t\t\tvar vertexNormals = face.vertexNormals;\n\n\t\t\tif ( vertexNormals.length === 3 ) {\n\n\t\t\t\tthis.normals.push( vertexNormals[ 0 ], vertexNormals[ 1 ], vertexNormals[ 2 ] );\n\n\t\t\t} else {\n\n\t\t\t\tvar normal = face.normal;\n\n\t\t\t\tthis.normals.push( normal, normal, normal );\n\n\t\t\t}\n\n\t\t\tvar vertexColors = face.vertexColors;\n\n\t\t\tif ( vertexColors.length === 3 ) {\n\n\t\t\t\tthis.colors.push( vertexColors[ 0 ], vertexColors[ 1 ], vertexColors[ 2 ] );\n\n\t\t\t} else {\n\n\t\t\t\tvar color = face.color;\n\n\t\t\t\tthis.colors.push( color, color, color );\n\n\t\t\t}\n\n\t\t\tif ( hasFaceVertexUv === true ) {\n\n\t\t\t\tvar vertexUvs = faceVertexUvs[ 0 ][ i ];\n\n\t\t\t\tif ( vertexUvs !== undefined ) {\n\n\t\t\t\t\tthis.uvs.push( vertexUvs[ 0 ], vertexUvs[ 1 ], vertexUvs[ 2 ] );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.warn( 'THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ', i );\n\n\t\t\t\t\tthis.uvs.push( new THREE.Vector2(), new THREE.Vector2(), new THREE.Vector2() );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( hasFaceVertexUv2 === true ) {\n\n\t\t\t\tvar vertexUvs = faceVertexUvs[ 1 ][ i ];\n\n\t\t\t\tif ( vertexUvs !== undefined ) {\n\n\t\t\t\t\tthis.uvs2.push( vertexUvs[ 0 ], vertexUvs[ 1 ], vertexUvs[ 2 ] );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.warn( 'THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ', i );\n\n\t\t\t\t\tthis.uvs2.push( new THREE.Vector2(), new THREE.Vector2(), new THREE.Vector2() );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// morphs\n\n\t\t\tfor ( var j = 0; j < morphTargetsLength; j ++ ) {\n\n\t\t\t\tvar morphTarget = morphTargets[ j ].vertices;\n\n\t\t\t\tmorphTargetsPosition[ j ].push( morphTarget[ face.a ], morphTarget[ face.b ], morphTarget[ face.c ] );\n\n\t\t\t}\n\n\t\t\tfor ( var j = 0; j < morphNormalsLength; j ++ ) {\n\n\t\t\t\tvar morphNormal = morphNormals[ j ].vertexNormals[ i ];\n\n\t\t\t\tmorphTargetsNormal[ j ].push( morphNormal.a, morphNormal.b, morphNormal.c );\n\n\t\t\t}\n\n\t\t\t// skins\n\n\t\t\tif ( hasSkinIndices ) {\n\n\t\t\t\tthis.skinIndices.push( skinIndices[ face.a ], skinIndices[ face.b ], skinIndices[ face.c ] );\n\n\t\t\t}\n\n\t\t\tif ( hasSkinWeights ) {\n\n\t\t\t\tthis.skinWeights.push( skinWeights[ face.a ], skinWeights[ face.b ], skinWeights[ face.c ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.computeGroups( geometry );\n\n\t\tthis.verticesNeedUpdate = geometry.verticesNeedUpdate;\n\t\tthis.normalsNeedUpdate = geometry.normalsNeedUpdate;\n\t\tthis.colorsNeedUpdate = geometry.colorsNeedUpdate;\n\t\tthis.uvsNeedUpdate = geometry.uvsNeedUpdate;\n\t\tthis.groupsNeedUpdate = geometry.groupsNeedUpdate;\n\n\t\treturn this;\n\n\t},\n\n\tdispose: function () {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t}\n\n};\n\nTHREE.EventDispatcher.prototype.apply( THREE.DirectGeometry.prototype );\n\n// File:src/core/BufferGeometry.js\n\n/**\n * @author alteredq / http://alteredqualia.com/\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.BufferGeometry = function () {\n\n\tObject.defineProperty( this, 'id', { value: THREE.GeometryIdCount ++ } );\n\n\tthis.uuid = THREE.Math.generateUUID();\n\n\tthis.name = '';\n\tthis.type = 'BufferGeometry';\n\n\tthis.index = null;\n\tthis.attributes = {};\n\n\tthis.morphAttributes = {};\n\n\tthis.groups = [];\n\n\tthis.boundingBox = null;\n\tthis.boundingSphere = null;\n\n\tthis.drawRange = { start: 0, count: Infinity };\n\n};\n\nTHREE.BufferGeometry.prototype = {\n\n\tconstructor: THREE.BufferGeometry,\n\n\taddIndex: function ( index ) {\n\n\t\tconsole.warn( 'THREE.BufferGeometry: .addIndex() has been renamed to .setIndex().' );\n\t\tthis.setIndex( index );\n\n\t},\n\n\tgetIndex: function () {\n\n\t\treturn this.index;\n\n\t},\n\n\tsetIndex: function ( index ) {\n\n\t\tthis.index = index;\n\n\t},\n\n\taddAttribute: function ( name, attribute ) {\n\n\t\tif ( attribute instanceof THREE.BufferAttribute === false && attribute instanceof THREE.InterleavedBufferAttribute === false ) {\n\n\t\t\tconsole.warn( 'THREE.BufferGeometry: .addAttribute() now expects ( name, attribute ).' );\n\n\t\t\tthis.addAttribute( name, new THREE.BufferAttribute( arguments[ 1 ], arguments[ 2 ] ) );\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( name === 'index' ) {\n\n\t\t\tconsole.warn( 'THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute.' );\n\t\t\tthis.setIndex( attribute );\n\n\t\t}\n\n\t\tthis.attributes[ name ] = attribute;\n\n\t},\n\n\tgetAttribute: function ( name ) {\n\n\t\treturn this.attributes[ name ];\n\n\t},\n\n\tremoveAttribute: function ( name ) {\n\n\t\tdelete this.attributes[ name ];\n\n\t},\n\n\tget drawcalls() {\n\n\t\tconsole.error( 'THREE.BufferGeometry: .drawcalls has been renamed to .groups.' );\n\t\treturn this.groups;\n\n\t},\n\n\tget offsets() {\n\n\t\tconsole.warn( 'THREE.BufferGeometry: .offsets has been renamed to .groups.' );\n\t\treturn this.groups;\n\n\t},\n\n\taddDrawCall: function ( start, count, indexOffset ) {\n\n\t\tif ( indexOffset !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset.' );\n\n\t\t}\n\n\t\tconsole.warn( 'THREE.BufferGeometry: .addDrawCall() is now .addGroup().' );\n\t\tthis.addGroup( start, count );\n\n\t},\n\n\tclearDrawCalls: function () {\n\n\t\tconsole.warn( 'THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups().' );\n\t\tthis.clearGroups();\n\n\t},\n\n\taddGroup: function ( start, count, materialIndex ) {\n\n\t\tthis.groups.push( {\n\n\t\t\tstart: start,\n\t\t\tcount: count,\n\t\t\tmaterialIndex: materialIndex !== undefined ? materialIndex : 0\n\n\t\t} );\n\n\t},\n\n\tclearGroups: function () {\n\n\t\tthis.groups = [];\n\n\t},\n\n\tsetDrawRange: function ( start, count ) {\n\n\t\tthis.drawRange.start = start;\n\t\tthis.drawRange.count = count;\n\n\t},\n\n\tapplyMatrix: function ( matrix ) {\n\n\t\tvar position = this.attributes.position;\n\n\t\tif ( position !== undefined ) {\n\n\t\t\tmatrix.applyToVector3Array( position.array );\n\t\t\tposition.needsUpdate = true;\n\n\t\t}\n\n\t\tvar normal = this.attributes.normal;\n\n\t\tif ( normal !== undefined ) {\n\n\t\t\tvar normalMatrix = new THREE.Matrix3().getNormalMatrix( matrix );\n\n\t\t\tnormalMatrix.applyToVector3Array( normal.array );\n\t\t\tnormal.needsUpdate = true;\n\n\t\t}\n\n\t\tif ( this.boundingBox !== null ) {\n\n\t\t\tthis.computeBoundingBox();\n\n\t\t}\n\n\t\tif ( this.boundingSphere !== null ) {\n\n\t\t\tthis.computeBoundingSphere();\n\n\t\t}\n\n\t},\n\n\trotateX: function () {\n\n\t\t// rotate geometry around world x-axis\n\n\t\tvar m1;\n\n\t\treturn function rotateX( angle ) {\n\n\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\n\n\t\t\tm1.makeRotationX( angle );\n\n\t\t\tthis.applyMatrix( m1 );\n\n\t\t\treturn this;\n\n\t\t};\n\n\t}(),\n\n\trotateY: function () {\n\n\t\t// rotate geometry around world y-axis\n\n\t\tvar m1;\n\n\t\treturn function rotateY( angle ) {\n\n\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\n\n\t\t\tm1.makeRotationY( angle );\n\n\t\t\tthis.applyMatrix( m1 );\n\n\t\t\treturn this;\n\n\t\t};\n\n\t}(),\n\n\trotateZ: function () {\n\n\t\t// rotate geometry around world z-axis\n\n\t\tvar m1;\n\n\t\treturn function rotateZ( angle ) {\n\n\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\n\n\t\t\tm1.makeRotationZ( angle );\n\n\t\t\tthis.applyMatrix( m1 );\n\n\t\t\treturn this;\n\n\t\t};\n\n\t}(),\n\n\ttranslate: function () {\n\n\t\t// translate geometry\n\n\t\tvar m1;\n\n\t\treturn function translate( x, y, z ) {\n\n\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\n\n\t\t\tm1.makeTranslation( x, y, z );\n\n\t\t\tthis.applyMatrix( m1 );\n\n\t\t\treturn this;\n\n\t\t};\n\n\t}(),\n\n\tscale: function () {\n\n\t\t// scale geometry\n\n\t\tvar m1;\n\n\t\treturn function scale( x, y, z ) {\n\n\t\t\tif ( m1 === undefined ) m1 = new THREE.Matrix4();\n\n\t\t\tm1.makeScale( x, y, z );\n\n\t\t\tthis.applyMatrix( m1 );\n\n\t\t\treturn this;\n\n\t\t};\n\n\t}(),\n\n\tlookAt: function () {\n\n\t\tvar obj;\n\n\t\treturn function lookAt( vector ) {\n\n\t\t\tif ( obj === undefined ) obj = new THREE.Object3D();\n\n\t\t\tobj.lookAt( vector );\n\n\t\t\tobj.updateMatrix();\n\n\t\t\tthis.applyMatrix( obj.matrix );\n\n\t\t};\n\n\t}(),\n\n\tcenter: function () {\n\n\t\tthis.computeBoundingBox();\n\n\t\tvar offset = this.boundingBox.center().negate();\n\n\t\tthis.translate( offset.x, offset.y, offset.z );\n\n\t\treturn offset;\n\n\t},\n\n\tsetFromObject: function ( object ) {\n\n\t\t// console.log( 'THREE.BufferGeometry.setFromObject(). Converting', object, this );\n\n\t\tvar geometry = object.geometry;\n\n\t\tif ( object instanceof THREE.Points || object instanceof THREE.Line ) {\n\n\t\t\tvar positions = new THREE.Float32Attribute( geometry.vertices.length * 3, 3 );\n\t\t\tvar colors = new THREE.Float32Attribute( geometry.colors.length * 3, 3 );\n\n\t\t\tthis.addAttribute( 'position', positions.copyVector3sArray( geometry.vertices ) );\n\t\t\tthis.addAttribute( 'color', colors.copyColorsArray( geometry.colors ) );\n\n\t\t\tif ( geometry.lineDistances && geometry.lineDistances.length === geometry.vertices.length ) {\n\n\t\t\t\tvar lineDistances = new THREE.Float32Attribute( geometry.lineDistances.length, 1 );\n\n\t\t\t\tthis.addAttribute( 'lineDistance',  lineDistances.copyArray( geometry.lineDistances ) );\n\n\t\t\t}\n\n\t\t\tif ( geometry.boundingSphere !== null ) {\n\n\t\t\t\tthis.boundingSphere = geometry.boundingSphere.clone();\n\n\t\t\t}\n\n\t\t\tif ( geometry.boundingBox !== null ) {\n\n\t\t\t\tthis.boundingBox = geometry.boundingBox.clone();\n\n\t\t\t}\n\n\t\t} else if ( object instanceof THREE.Mesh ) {\n\n\t\t\tif ( geometry instanceof THREE.Geometry ) {\n\n\t\t\t\tthis.fromGeometry( geometry );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tupdateFromObject: function ( object ) {\n\n\t\tvar geometry = object.geometry;\n\n\t\tif ( object instanceof THREE.Mesh ) {\n\n\t\t\tvar direct = geometry.__directGeometry;\n\n\t\t\tif ( direct === undefined ) {\n\n\t\t\t\treturn this.fromGeometry( geometry );\n\n\t\t\t}\n\n\t\t\tdirect.verticesNeedUpdate = geometry.verticesNeedUpdate;\n\t\t\tdirect.normalsNeedUpdate = geometry.normalsNeedUpdate;\n\t\t\tdirect.colorsNeedUpdate = geometry.colorsNeedUpdate;\n\t\t\tdirect.uvsNeedUpdate = geometry.uvsNeedUpdate;\n\t\t\tdirect.groupsNeedUpdate = geometry.groupsNeedUpdate;\n\n\t\t\tgeometry.verticesNeedUpdate = false;\n\t\t\tgeometry.normalsNeedUpdate = false;\n\t\t\tgeometry.colorsNeedUpdate = false;\n\t\t\tgeometry.uvsNeedUpdate = false;\n\t\t\tgeometry.groupsNeedUpdate = false;\n\n\t\t\tgeometry = direct;\n\n\t\t}\n\n\t\tif ( geometry.verticesNeedUpdate === true ) {\n\n\t\t\tvar attribute = this.attributes.position;\n\n\t\t\tif ( attribute !== undefined ) {\n\n\t\t\t\tattribute.copyVector3sArray( geometry.vertices );\n\t\t\t\tattribute.needsUpdate = true;\n\n\t\t\t}\n\n\t\t\tgeometry.verticesNeedUpdate = false;\n\n\t\t}\n\n\t\tif ( geometry.normalsNeedUpdate === true ) {\n\n\t\t\tvar attribute = this.attributes.normal;\n\n\t\t\tif ( attribute !== undefined ) {\n\n\t\t\t\tattribute.copyVector3sArray( geometry.normals );\n\t\t\t\tattribute.needsUpdate = true;\n\n\t\t\t}\n\n\t\t\tgeometry.normalsNeedUpdate = false;\n\n\t\t}\n\n\t\tif ( geometry.colorsNeedUpdate === true ) {\n\n\t\t\tvar attribute = this.attributes.color;\n\n\t\t\tif ( attribute !== undefined ) {\n\n\t\t\t\tattribute.copyColorsArray( geometry.colors );\n\t\t\t\tattribute.needsUpdate = true;\n\n\t\t\t}\n\n\t\t\tgeometry.colorsNeedUpdate = false;\n\n\t\t}\n\n\t\tif ( geometry.lineDistancesNeedUpdate ) {\n\n\t\t\tvar attribute = this.attributes.lineDistance;\n\n\t\t\tif ( attribute !== undefined ) {\n\n\t\t\t\tattribute.copyArray( geometry.lineDistances );\n\t\t\t\tattribute.needsUpdate = true;\n\n\t\t\t}\n\n\t\t\tgeometry.lineDistancesNeedUpdate = false;\n\n\t\t}\n\n\t\tif ( geometry.groupsNeedUpdate ) {\n\n\t\t\tgeometry.computeGroups( object.geometry );\n\t\t\tthis.groups = geometry.groups;\n\n\t\t\tgeometry.groupsNeedUpdate = false;\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tfromGeometry: function ( geometry ) {\n\n\t\tgeometry.__directGeometry = new THREE.DirectGeometry().fromGeometry( geometry );\n\n\t\treturn this.fromDirectGeometry( geometry.__directGeometry );\n\n\t},\n\n\tfromDirectGeometry: function ( geometry ) {\n\n\t\tvar positions = new Float32Array( geometry.vertices.length * 3 );\n\t\tthis.addAttribute( 'position', new THREE.BufferAttribute( positions, 3 ).copyVector3sArray( geometry.vertices ) );\n\n\t\tif ( geometry.normals.length > 0 ) {\n\n\t\t\tvar normals = new Float32Array( geometry.normals.length * 3 );\n\t\t\tthis.addAttribute( 'normal', new THREE.BufferAttribute( normals, 3 ).copyVector3sArray( geometry.normals ) );\n\n\t\t}\n\n\t\tif ( geometry.colors.length > 0 ) {\n\n\t\t\tvar colors = new Float32Array( geometry.colors.length * 3 );\n\t\t\tthis.addAttribute( 'color', new THREE.BufferAttribute( colors, 3 ).copyColorsArray( geometry.colors ) );\n\n\t\t}\n\n\t\tif ( geometry.uvs.length > 0 ) {\n\n\t\t\tvar uvs = new Float32Array( geometry.uvs.length * 2 );\n\t\t\tthis.addAttribute( 'uv', new THREE.BufferAttribute( uvs, 2 ).copyVector2sArray( geometry.uvs ) );\n\n\t\t}\n\n\t\tif ( geometry.uvs2.length > 0 ) {\n\n\t\t\tvar uvs2 = new Float32Array( geometry.uvs2.length * 2 );\n\t\t\tthis.addAttribute( 'uv2', new THREE.BufferAttribute( uvs2, 2 ).copyVector2sArray( geometry.uvs2 ) );\n\n\t\t}\n\n\t\tif ( geometry.indices.length > 0 ) {\n\n\t\t\tvar TypeArray = geometry.vertices.length > 65535 ? Uint32Array : Uint16Array;\n\t\t\tvar indices = new TypeArray( geometry.indices.length * 3 );\n\t\t\tthis.setIndex( new THREE.BufferAttribute( indices, 1 ).copyIndicesArray( geometry.indices ) );\n\n\t\t}\n\n\t\t// groups\n\n\t\tthis.groups = geometry.groups;\n\n\t\t// morphs\n\n\t\tfor ( var name in geometry.morphTargets ) {\n\n\t\t\tvar array = [];\n\t\t\tvar morphTargets = geometry.morphTargets[ name ];\n\n\t\t\tfor ( var i = 0, l = morphTargets.length; i < l; i ++ ) {\n\n\t\t\t\tvar morphTarget = morphTargets[ i ];\n\n\t\t\t\tvar attribute = new THREE.Float32Attribute( morphTarget.length * 3, 3 );\n\n\t\t\t\tarray.push( attribute.copyVector3sArray( morphTarget ) );\n\n\t\t\t}\n\n\t\t\tthis.morphAttributes[ name ] = array;\n\n\t\t}\n\n\t\t// skinning\n\n\t\tif ( geometry.skinIndices.length > 0 ) {\n\n\t\t\tvar skinIndices = new THREE.Float32Attribute( geometry.skinIndices.length * 4, 4 );\n\t\t\tthis.addAttribute( 'skinIndex', skinIndices.copyVector4sArray( geometry.skinIndices ) );\n\n\t\t}\n\n\t\tif ( geometry.skinWeights.length > 0 ) {\n\n\t\t\tvar skinWeights = new THREE.Float32Attribute( geometry.skinWeights.length * 4, 4 );\n\t\t\tthis.addAttribute( 'skinWeight', skinWeights.copyVector4sArray( geometry.skinWeights ) );\n\n\t\t}\n\n\t\t//\n\n\t\tif ( geometry.boundingSphere !== null ) {\n\n\t\t\tthis.boundingSphere = geometry.boundingSphere.clone();\n\n\t\t}\n\n\t\tif ( geometry.boundingBox !== null ) {\n\n\t\t\tthis.boundingBox = geometry.boundingBox.clone();\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tcomputeBoundingBox: function () {\n\n\t\tvar vector = new THREE.Vector3();\n\n\t\treturn function () {\n\n\t\t\tif ( this.boundingBox === null ) {\n\n\t\t\t\tthis.boundingBox = new THREE.Box3();\n\n\t\t\t}\n\n\t\t\tvar positions = this.attributes.position.array;\n\n\t\t\tif ( positions ) {\n\n\t\t\t\tvar bb = this.boundingBox;\n\t\t\t\tbb.makeEmpty();\n\n\t\t\t\tfor ( var i = 0, il = positions.length; i < il; i += 3 ) {\n\n\t\t\t\t\tvector.fromArray( positions, i );\n\t\t\t\t\tbb.expandByPoint( vector );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( positions === undefined || positions.length === 0 ) {\n\n\t\t\t\tthis.boundingBox.min.set( 0, 0, 0 );\n\t\t\t\tthis.boundingBox.max.set( 0, 0, 0 );\n\n\t\t\t}\n\n\t\t\tif ( isNaN( this.boundingBox.min.x ) || isNaN( this.boundingBox.min.y ) || isNaN( this.boundingBox.min.z ) ) {\n\n\t\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The \"position\" attribute is likely to have NaN values.', this );\n\n\t\t\t}\n\n\t\t};\n\n\t}(),\n\n\tcomputeBoundingSphere: function () {\n\n\t\tvar box = new THREE.Box3();\n\t\tvar vector = new THREE.Vector3();\n\n\t\treturn function () {\n\n\t\t\tif ( this.boundingSphere === null ) {\n\n\t\t\t\tthis.boundingSphere = new THREE.Sphere();\n\n\t\t\t}\n\n\t\t\tvar positions = this.attributes.position.array;\n\n\t\t\tif ( positions ) {\n\n\t\t\t\tbox.makeEmpty();\n\n\t\t\t\tvar center = this.boundingSphere.center;\n\n\t\t\t\tfor ( var i = 0, il = positions.length; i < il; i += 3 ) {\n\n\t\t\t\t\tvector.fromArray( positions, i );\n\t\t\t\t\tbox.expandByPoint( vector );\n\n\t\t\t\t}\n\n\t\t\t\tbox.center( center );\n\n\t\t\t\t// hoping to find a boundingSphere with a radius smaller than the\n\t\t\t\t// boundingSphere of the boundingBox: sqrt(3) smaller in the best case\n\n\t\t\t\tvar maxRadiusSq = 0;\n\n\t\t\t\tfor ( var i = 0, il = positions.length; i < il; i += 3 ) {\n\n\t\t\t\t\tvector.fromArray( positions, i );\n\t\t\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( vector ) );\n\n\t\t\t\t}\n\n\t\t\t\tthis.boundingSphere.radius = Math.sqrt( maxRadiusSq );\n\n\t\t\t\tif ( isNaN( this.boundingSphere.radius ) ) {\n\n\t\t\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The \"position\" attribute is likely to have NaN values.', this );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t};\n\n\t}(),\n\n\tcomputeFaceNormals: function () {\n\n\t\t// backwards compatibility\n\n\t},\n\n\tcomputeVertexNormals: function () {\n\n\t\tvar index = this.index;\n\t\tvar attributes = this.attributes;\n\t\tvar groups = this.groups;\n\n\t\tif ( attributes.position ) {\n\n\t\t\tvar positions = attributes.position.array;\n\n\t\t\tif ( attributes.normal === undefined ) {\n\n\t\t\t\tthis.addAttribute( 'normal', new THREE.BufferAttribute( new Float32Array( positions.length ), 3 ) );\n\n\t\t\t} else {\n\n\t\t\t\t// reset existing normals to zero\n\n\t\t\t\tvar normals = attributes.normal.array;\n\n\t\t\t\tfor ( var i = 0, il = normals.length; i < il; i ++ ) {\n\n\t\t\t\t\tnormals[ i ] = 0;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar normals = attributes.normal.array;\n\n\t\t\tvar vA, vB, vC,\n\n\t\t\tpA = new THREE.Vector3(),\n\t\t\tpB = new THREE.Vector3(),\n\t\t\tpC = new THREE.Vector3(),\n\n\t\t\tcb = new THREE.Vector3(),\n\t\t\tab = new THREE.Vector3();\n\n\t\t\t// indexed elements\n\n\t\t\tif ( index ) {\n\n\t\t\t\tvar indices = index.array;\n\n\t\t\t\tif ( groups.length === 0 ) {\n\n\t\t\t\t\tthis.addGroup( 0, indices.length );\n\n\t\t\t\t}\n\n\t\t\t\tfor ( var j = 0, jl = groups.length; j < jl; ++ j ) {\n\n\t\t\t\t\tvar group = groups[ j ];\n\n\t\t\t\t\tvar start = group.start;\n\t\t\t\t\tvar count = group.count;\n\n\t\t\t\t\tfor ( var i = start, il = start + count; i < il; i += 3 ) {\n\n\t\t\t\t\t\tvA = indices[ i + 0 ] * 3;\n\t\t\t\t\t\tvB = indices[ i + 1 ] * 3;\n\t\t\t\t\t\tvC = indices[ i + 2 ] * 3;\n\n\t\t\t\t\t\tpA.fromArray( positions, vA );\n\t\t\t\t\t\tpB.fromArray( positions, vB );\n\t\t\t\t\t\tpC.fromArray( positions, vC );\n\n\t\t\t\t\t\tcb.subVectors( pC, pB );\n\t\t\t\t\t\tab.subVectors( pA, pB );\n\t\t\t\t\t\tcb.cross( ab );\n\n\t\t\t\t\t\tnormals[ vA ] += cb.x;\n\t\t\t\t\t\tnormals[ vA + 1 ] += cb.y;\n\t\t\t\t\t\tnormals[ vA + 2 ] += cb.z;\n\n\t\t\t\t\t\tnormals[ vB ] += cb.x;\n\t\t\t\t\t\tnormals[ vB + 1 ] += cb.y;\n\t\t\t\t\t\tnormals[ vB + 2 ] += cb.z;\n\n\t\t\t\t\t\tnormals[ vC ] += cb.x;\n\t\t\t\t\t\tnormals[ vC + 1 ] += cb.y;\n\t\t\t\t\t\tnormals[ vC + 2 ] += cb.z;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// non-indexed elements (unconnected triangle soup)\n\n\t\t\t\tfor ( var i = 0, il = positions.length; i < il; i += 9 ) {\n\n\t\t\t\t\tpA.fromArray( positions, i );\n\t\t\t\t\tpB.fromArray( positions, i + 3 );\n\t\t\t\t\tpC.fromArray( positions, i + 6 );\n\n\t\t\t\t\tcb.subVectors( pC, pB );\n\t\t\t\t\tab.subVectors( pA, pB );\n\t\t\t\t\tcb.cross( ab );\n\n\t\t\t\t\tnormals[ i ] = cb.x;\n\t\t\t\t\tnormals[ i + 1 ] = cb.y;\n\t\t\t\t\tnormals[ i + 2 ] = cb.z;\n\n\t\t\t\t\tnormals[ i + 3 ] = cb.x;\n\t\t\t\t\tnormals[ i + 4 ] = cb.y;\n\t\t\t\t\tnormals[ i + 5 ] = cb.z;\n\n\t\t\t\t\tnormals[ i + 6 ] = cb.x;\n\t\t\t\t\tnormals[ i + 7 ] = cb.y;\n\t\t\t\t\tnormals[ i + 8 ] = cb.z;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.normalizeNormals();\n\n\t\t\tattributes.normal.needsUpdate = true;\n\n\t\t}\n\n\t},\n\n\tcomputeTangents: function () {\n\n\t\tconsole.warn( 'THREE.BufferGeometry: .computeTangents() has been removed.' );\n\n\t},\n\n\tcomputeOffsets: function ( size ) {\n\n\t\tconsole.warn( 'THREE.BufferGeometry: .computeOffsets() has been removed.')\n\n\t},\n\n\tmerge: function ( geometry, offset ) {\n\n\t\tif ( geometry instanceof THREE.BufferGeometry === false ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.', geometry );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( offset === undefined ) offset = 0;\n\n\t\tvar attributes = this.attributes;\n\n\t\tfor ( var key in attributes ) {\n\n\t\t\tif ( geometry.attributes[ key ] === undefined ) continue;\n\n\t\t\tvar attribute1 = attributes[ key ];\n\t\t\tvar attributeArray1 = attribute1.array;\n\n\t\t\tvar attribute2 = geometry.attributes[ key ];\n\t\t\tvar attributeArray2 = attribute2.array;\n\n\t\t\tvar attributeSize = attribute2.itemSize;\n\n\t\t\tfor ( var i = 0, j = attributeSize * offset; i < attributeArray2.length; i ++, j ++ ) {\n\n\t\t\t\tattributeArray1[ j ] = attributeArray2[ i ];\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tnormalizeNormals: function () {\n\n\t\tvar normals = this.attributes.normal.array;\n\n\t\tvar x, y, z, n;\n\n\t\tfor ( var i = 0, il = normals.length; i < il; i += 3 ) {\n\n\t\t\tx = normals[ i ];\n\t\t\ty = normals[ i + 1 ];\n\t\t\tz = normals[ i + 2 ];\n\n\t\t\tn = 1.0 / Math.sqrt( x * x + y * y + z * z );\n\n\t\t\tnormals[ i ] *= n;\n\t\t\tnormals[ i + 1 ] *= n;\n\t\t\tnormals[ i + 2 ] *= n;\n\n\t\t}\n\n\t},\n\n\ttoJSON: function () {\n\n\t\tvar data = {\n\t\t\tmetadata: {\n\t\t\t\tversion: 4.4,\n\t\t\t\ttype: 'BufferGeometry',\n\t\t\t\tgenerator: 'BufferGeometry.toJSON'\n\t\t\t}\n\t\t};\n\n\t\t// standard BufferGeometry serialization\n\n\t\tdata.uuid = this.uuid;\n\t\tdata.type = this.type;\n\t\tif ( this.name !== '' ) data.name = this.name;\n\n\t\tif ( this.parameters !== undefined ) {\n\n\t\t\tvar parameters = this.parameters;\n\n\t\t\tfor ( var key in parameters ) {\n\n\t\t\t\tif ( parameters[ key ] !== undefined ) data[ key ] = parameters[ key ];\n\n\t\t\t}\n\n\t\t\treturn data;\n\n\t\t}\n\n\t\tdata.data = { attributes: {} };\n\n\t\tvar index = this.index;\n\n\t\tif ( index !== null ) {\n\n\t\t\tvar array = Array.prototype.slice.call( index.array );\n\n\t\t\tdata.data.index = {\n\t\t\t\ttype: index.array.constructor.name,\n\t\t\t\tarray: array\n\t\t\t};\n\n\t\t}\n\n\t\tvar attributes = this.attributes;\n\n\t\tfor ( var key in attributes ) {\n\n\t\t\tvar attribute = attributes[ key ];\n\n\t\t\tvar array = Array.prototype.slice.call( attribute.array );\n\n\t\t\tdata.data.attributes[ key ] = {\n\t\t\t\titemSize: attribute.itemSize,\n\t\t\t\ttype: attribute.array.constructor.name,\n\t\t\t\tarray: array\n\t\t\t};\n\n\t\t}\n\n\t\tvar groups = this.groups;\n\n\t\tif ( groups.length > 0 ) {\n\n\t\t\tdata.data.groups = JSON.parse( JSON.stringify( groups ) );\n\n\t\t}\n\n\t\tvar boundingSphere = this.boundingSphere;\n\n\t\tif ( boundingSphere !== null ) {\n\n\t\t\tdata.data.boundingSphere = {\n\t\t\t\tcenter: boundingSphere.center.toArray(),\n\t\t\t\tradius: boundingSphere.radius\n\t\t\t};\n\n\t\t}\n\n\t\treturn data;\n\n\t},\n\n\tclone: function () {\n\n\t\treturn new this.constructor().copy( this );\n\n\t},\n\n\tcopy: function ( source ) {\n\n\t\tvar index = source.index;\n\n\t\tif ( index !== null ) {\n\n\t\t\tthis.setIndex( index.clone() );\n\n\t\t}\n\n\t\tvar attributes = source.attributes;\n\n\t\tfor ( var name in attributes ) {\n\n\t\t\tvar attribute = attributes[ name ];\n\t\t\tthis.addAttribute( name, attribute.clone() );\n\n\t\t}\n\n\t\tvar groups = source.groups;\n\n\t\tfor ( var i = 0, l = groups.length; i < l; i ++ ) {\n\n\t\t\tvar group = groups[ i ];\n\t\t\tthis.addGroup( group.start, group.count );\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tdispose: function () {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t}\n\n};\n\nTHREE.EventDispatcher.prototype.apply( THREE.BufferGeometry.prototype );\n\nTHREE.BufferGeometry.MaxIndex = 65535;\n\n// File:src/core/InstancedBufferGeometry.js\n\n/**\n * @author benaadams / https://twitter.com/ben_a_adams\n */\n\nTHREE.InstancedBufferGeometry = function () {\n\n\tTHREE.BufferGeometry.call( this );\n\n\tthis.type = 'InstancedBufferGeometry';\n\tthis.maxInstancedCount = undefined;\n\n};\n\nTHREE.InstancedBufferGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\nTHREE.InstancedBufferGeometry.prototype.constructor = THREE.InstancedBufferGeometry;\n\nTHREE.InstancedBufferGeometry.prototype.addGroup = function ( start, count, instances ) {\n\n\tthis.groups.push( {\n\n\t\tstart: start,\n\t\tcount: count,\n\t\tinstances: instances\n\n\t} );\n\n};\n\nTHREE.InstancedBufferGeometry.prototype.copy = function ( source ) {\n\n\tvar index = source.index;\n\n\tif ( index !== null ) {\n\n\t\tthis.setIndex( index.clone() );\n\n\t}\n\n\tvar attributes = source.attributes;\n\n\tfor ( var name in attributes ) {\n\n\t\tvar attribute = attributes[ name ];\n\t\tthis.addAttribute( name, attribute.clone() );\n\n\t}\n\n\tvar groups = source.groups;\n\n\tfor ( var i = 0, l = groups.length; i < l; i ++ ) {\n\n\t\tvar group = groups[ i ];\n\t\tthis.addGroup( group.start, group.count, group.instances );\n\n\t}\n\n\treturn this;\n\n};\n\nTHREE.EventDispatcher.prototype.apply( THREE.InstancedBufferGeometry.prototype );\n\n// File:src/cameras/Camera.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n * @author mikael emtinger / http://gomo.se/\n * @author WestLangley / http://github.com/WestLangley\n*/\n\nTHREE.Camera = function () {\n\n\tTHREE.Object3D.call( this );\n\n\tthis.type = 'Camera';\n\n\tthis.matrixWorldInverse = new THREE.Matrix4();\n\tthis.projectionMatrix = new THREE.Matrix4();\n\n};\n\nTHREE.Camera.prototype = Object.create( THREE.Object3D.prototype );\nTHREE.Camera.prototype.constructor = THREE.Camera;\n\nTHREE.Camera.prototype.getWorldDirection = function () {\n\n\tvar quaternion = new THREE.Quaternion();\n\n\treturn function ( optionalTarget ) {\n\n\t\tvar result = optionalTarget || new THREE.Vector3();\n\n\t\tthis.getWorldQuaternion( quaternion );\n\n\t\treturn result.set( 0, 0, - 1 ).applyQuaternion( quaternion );\n\n\t};\n\n}();\n\nTHREE.Camera.prototype.lookAt = function () {\n\n\t// This routine does not support cameras with rotated and/or translated parent(s)\n\n\tvar m1 = new THREE.Matrix4();\n\n\treturn function ( vector ) {\n\n\t\tm1.lookAt( this.position, vector, this.up );\n\n\t\tthis.quaternion.setFromRotationMatrix( m1 );\n\n\t};\n\n}();\n\nTHREE.Camera.prototype.clone = function () {\n\n\treturn new this.constructor().copy( this );\n\n};\n\nTHREE.Camera.prototype.copy = function ( source ) {\n\n\tTHREE.Object3D.prototype.copy.call( this, source );\n\n\tthis.matrixWorldInverse.copy( source.matrixWorldInverse );\n\tthis.projectionMatrix.copy( source.projectionMatrix );\n\n\treturn this;\n\n};\n\n// File:src/cameras/CubeCamera.js\n\n/**\n * Camera for rendering cube maps\n *\t- renders scene into axis-aligned cube\n *\n * @author alteredq / http://alteredqualia.com/\n */\n\nTHREE.CubeCamera = function ( near, far, cubeResolution ) {\n\n\tTHREE.Object3D.call( this );\n\n\tthis.type = 'CubeCamera';\n\n\tvar fov = 90, aspect = 1;\n\n\tvar cameraPX = new THREE.PerspectiveCamera( fov, aspect, near, far );\n\tcameraPX.up.set( 0, - 1, 0 );\n\tcameraPX.lookAt( new THREE.Vector3( 1, 0, 0 ) );\n\tthis.add( cameraPX );\n\n\tvar cameraNX = new THREE.PerspectiveCamera( fov, aspect, near, far );\n\tcameraNX.up.set( 0, - 1, 0 );\n\tcameraNX.lookAt( new THREE.Vector3( - 1, 0, 0 ) );\n\tthis.add( cameraNX );\n\n\tvar cameraPY = new THREE.PerspectiveCamera( fov, aspect, near, far );\n\tcameraPY.up.set( 0, 0, 1 );\n\tcameraPY.lookAt( new THREE.Vector3( 0, 1, 0 ) );\n\tthis.add( cameraPY );\n\n\tvar cameraNY = new THREE.PerspectiveCamera( fov, aspect, near, far );\n\tcameraNY.up.set( 0, 0, - 1 );\n\tcameraNY.lookAt( new THREE.Vector3( 0, - 1, 0 ) );\n\tthis.add( cameraNY );\n\n\tvar cameraPZ = new THREE.PerspectiveCamera( fov, aspect, near, far );\n\tcameraPZ.up.set( 0, - 1, 0 );\n\tcameraPZ.lookAt( new THREE.Vector3( 0, 0, 1 ) );\n\tthis.add( cameraPZ );\n\n\tvar cameraNZ = new THREE.PerspectiveCamera( fov, aspect, near, far );\n\tcameraNZ.up.set( 0, - 1, 0 );\n\tcameraNZ.lookAt( new THREE.Vector3( 0, 0, - 1 ) );\n\tthis.add( cameraNZ );\n\n\tthis.renderTarget = new THREE.WebGLRenderTargetCube( cubeResolution, cubeResolution, { format: THREE.RGBFormat, magFilter: THREE.LinearFilter, minFilter: THREE.LinearFilter } );\n\n\tthis.updateCubeMap = function ( renderer, scene ) {\n\n\t\tif ( this.parent === null ) this.updateMatrixWorld();\n\n\t\tvar renderTarget = this.renderTarget;\n\t\tvar generateMipmaps = renderTarget.generateMipmaps;\n\n\t\trenderTarget.generateMipmaps = false;\n\n\t\trenderTarget.activeCubeFace = 0;\n\t\trenderer.render( scene, cameraPX, renderTarget );\n\n\t\trenderTarget.activeCubeFace = 1;\n\t\trenderer.render( scene, cameraNX, renderTarget );\n\n\t\trenderTarget.activeCubeFace = 2;\n\t\trenderer.render( scene, cameraPY, renderTarget );\n\n\t\trenderTarget.activeCubeFace = 3;\n\t\trenderer.render( scene, cameraNY, renderTarget );\n\n\t\trenderTarget.activeCubeFace = 4;\n\t\trenderer.render( scene, cameraPZ, renderTarget );\n\n\t\trenderTarget.generateMipmaps = generateMipmaps;\n\n\t\trenderTarget.activeCubeFace = 5;\n\t\trenderer.render( scene, cameraNZ, renderTarget );\n\n\t\trenderer.setRenderTarget( null );\n\n\t};\n\n};\n\nTHREE.CubeCamera.prototype = Object.create( THREE.Object3D.prototype );\nTHREE.CubeCamera.prototype.constructor = THREE.CubeCamera;\n\n// File:src/cameras/OrthographicCamera.js\n\n/**\n * @author alteredq / http://alteredqualia.com/\n */\n\nTHREE.OrthographicCamera = function ( left, right, top, bottom, near, far ) {\n\n\tTHREE.Camera.call( this );\n\n\tthis.type = 'OrthographicCamera';\n\n\tthis.zoom = 1;\n\n\tthis.left = left;\n\tthis.right = right;\n\tthis.top = top;\n\tthis.bottom = bottom;\n\n\tthis.near = ( near !== undefined ) ? near : 0.1;\n\tthis.far = ( far !== undefined ) ? far : 2000;\n\n\tthis.updateProjectionMatrix();\n\n};\n\nTHREE.OrthographicCamera.prototype = Object.create( THREE.Camera.prototype );\nTHREE.OrthographicCamera.prototype.constructor = THREE.OrthographicCamera;\n\nTHREE.OrthographicCamera.prototype.updateProjectionMatrix = function () {\n\n\tvar dx = ( this.right - this.left ) / ( 2 * this.zoom );\n\tvar dy = ( this.top - this.bottom ) / ( 2 * this.zoom );\n\tvar cx = ( this.right + this.left ) / 2;\n\tvar cy = ( this.top + this.bottom ) / 2;\n\n\tthis.projectionMatrix.makeOrthographic( cx - dx, cx + dx, cy + dy, cy - dy, this.near, this.far );\n\n};\n\nTHREE.OrthographicCamera.prototype.copy = function ( source ) {\n\t\n\tTHREE.Camera.prototype.copy.call( this, source );\n\t\n\tthis.left = source.left;\n\tthis.right = source.right;\n\tthis.top = source.top;\n\tthis.bottom = source.bottom;\n\tthis.near = source.near;\n\tthis.far = source.far;\n\t\n\tthis.zoom = source.zoom;\n\t\n\treturn this;\n\t\t\n};\n\nTHREE.OrthographicCamera.prototype.toJSON = function ( meta ) {\n\n\tvar data = THREE.Object3D.prototype.toJSON.call( this, meta );\n\n\tdata.object.zoom = this.zoom;\n\tdata.object.left = this.left;\n\tdata.object.right = this.right;\n\tdata.object.top = this.top;\n\tdata.object.bottom = this.bottom;\n\tdata.object.near = this.near;\n\tdata.object.far = this.far;\n\n\treturn data;\n\n};\n\n// File:src/cameras/PerspectiveCamera.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n * @author greggman / http://games.greggman.com/\n * @author zz85 / http://www.lab4games.net/zz85/blog\n */\n\nTHREE.PerspectiveCamera = function ( fov, aspect, near, far ) {\n\n\tTHREE.Camera.call( this );\n\n\tthis.type = 'PerspectiveCamera';\n\n\tthis.zoom = 1;\n\n\tthis.fov = fov !== undefined ? fov : 50;\n\tthis.aspect = aspect !== undefined ? aspect : 1;\n\tthis.near = near !== undefined ? near : 0.1;\n\tthis.far = far !== undefined ? far : 2000;\n\n\tthis.updateProjectionMatrix();\n\n};\n\nTHREE.PerspectiveCamera.prototype = Object.create( THREE.Camera.prototype );\nTHREE.PerspectiveCamera.prototype.constructor = THREE.PerspectiveCamera;\n\n\n/**\n * Uses Focal Length (in mm) to estimate and set FOV\n * 35mm (full-frame) camera is used if frame size is not specified;\n * Formula based on http://www.bobatkins.com/photography/technical/field_of_view.html\n */\n\nTHREE.PerspectiveCamera.prototype.setLens = function ( focalLength, frameHeight ) {\n\n\tif ( frameHeight === undefined ) frameHeight = 24;\n\n\tthis.fov = 2 * THREE.Math.radToDeg( Math.atan( frameHeight / ( focalLength * 2 ) ) );\n\tthis.updateProjectionMatrix();\n\n};\n\n\n/**\n * Sets an offset in a larger frustum. This is useful for multi-window or\n * multi-monitor/multi-machine setups.\n *\n * For example, if you have 3x2 monitors and each monitor is 1920x1080 and\n * the monitors are in grid like this\n *\n *   +---+---+---+\n *   | A | B | C |\n *   +---+---+---+\n *   | D | E | F |\n *   +---+---+---+\n *\n * then for each monitor you would call it like this\n *\n *   var w = 1920;\n *   var h = 1080;\n *   var fullWidth = w * 3;\n *   var fullHeight = h * 2;\n *\n *   --A--\n *   camera.setOffset( fullWidth, fullHeight, w * 0, h * 0, w, h );\n *   --B--\n *   camera.setOffset( fullWidth, fullHeight, w * 1, h * 0, w, h );\n *   --C--\n *   camera.setOffset( fullWidth, fullHeight, w * 2, h * 0, w, h );\n *   --D--\n *   camera.setOffset( fullWidth, fullHeight, w * 0, h * 1, w, h );\n *   --E--\n *   camera.setOffset( fullWidth, fullHeight, w * 1, h * 1, w, h );\n *   --F--\n *   camera.setOffset( fullWidth, fullHeight, w * 2, h * 1, w, h );\n *\n *   Note there is no reason monitors have to be the same size or in a grid.\n */\n\nTHREE.PerspectiveCamera.prototype.setViewOffset = function ( fullWidth, fullHeight, x, y, width, height ) {\n\n\tthis.fullWidth = fullWidth;\n\tthis.fullHeight = fullHeight;\n\tthis.x = x;\n\tthis.y = y;\n\tthis.width = width;\n\tthis.height = height;\n\n\tthis.updateProjectionMatrix();\n\n};\n\n\nTHREE.PerspectiveCamera.prototype.updateProjectionMatrix = function () {\n\n\tvar fov = THREE.Math.radToDeg( 2 * Math.atan( Math.tan( THREE.Math.degToRad( this.fov ) * 0.5 ) / this.zoom ) );\n\n\tif ( this.fullWidth ) {\n\n\t\tvar aspect = this.fullWidth / this.fullHeight;\n\t\tvar top = Math.tan( THREE.Math.degToRad( fov * 0.5 ) ) * this.near;\n\t\tvar bottom = - top;\n\t\tvar left = aspect * bottom;\n\t\tvar right = aspect * top;\n\t\tvar width = Math.abs( right - left );\n\t\tvar height = Math.abs( top - bottom );\n\n\t\tthis.projectionMatrix.makeFrustum(\n\t\t\tleft + this.x * width / this.fullWidth,\n\t\t\tleft + ( this.x + this.width ) * width / this.fullWidth,\n\t\t\ttop - ( this.y + this.height ) * height / this.fullHeight,\n\t\t\ttop - this.y * height / this.fullHeight,\n\t\t\tthis.near,\n\t\t\tthis.far\n\t\t);\n\n\t} else {\n\n\t\tthis.projectionMatrix.makePerspective( fov, this.aspect, this.near, this.far );\n\n\t}\n\n};\n\nTHREE.PerspectiveCamera.prototype.copy = function ( source ) {\n\t\n\tTHREE.Camera.prototype.copy.call( this, source );\n\t\n\tthis.fov = source.fov;\n\tthis.aspect = source.aspect;\n\tthis.near = source.near;\n\tthis.far = source.far;\n\t\n\tthis.zoom = source.zoom;\n\t\n\treturn this;\n\t\t\n};\n\nTHREE.PerspectiveCamera.prototype.toJSON = function ( meta ) {\n\n\tvar data = THREE.Object3D.prototype.toJSON.call( this, meta );\n\n\tdata.object.zoom = this.zoom;\n\tdata.object.fov = this.fov;\n\tdata.object.aspect = this.aspect;\n\tdata.object.near = this.near;\n\tdata.object.far = this.far;\n\n\treturn data;\n\n};\n\n// File:src/lights/Light.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n * @author alteredq / http://alteredqualia.com/\n */\n\nTHREE.Light = function ( color ) {\n\n\tTHREE.Object3D.call( this );\n\n\tthis.type = 'Light';\n\n\tthis.color = new THREE.Color( color );\n\n};\n\nTHREE.Light.prototype = Object.create( THREE.Object3D.prototype );\nTHREE.Light.prototype.constructor = THREE.Light;\n\nTHREE.Light.prototype.copy = function ( source ) {\n\t\n\tTHREE.Object3D.prototype.copy.call( this, source );\n\t\n\tthis.color.copy( source.color );\n\t\n\treturn this;\n\n};\n// File:src/lights/AmbientLight.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.AmbientLight = function ( color ) {\n\n\tTHREE.Light.call( this, color );\n\n\tthis.type = 'AmbientLight';\n\n};\n\nTHREE.AmbientLight.prototype = Object.create( THREE.Light.prototype );\nTHREE.AmbientLight.prototype.constructor = THREE.AmbientLight;\n\nTHREE.AmbientLight.prototype.toJSON = function ( meta ) {\n\n\tvar data = THREE.Object3D.prototype.toJSON.call( this, meta );\n\n\tdata.object.color = this.color.getHex();\n\n\treturn data;\n\n};\n\n// File:src/lights/DirectionalLight.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n * @author alteredq / http://alteredqualia.com/\n */\n\nTHREE.DirectionalLight = function ( color, intensity ) {\n\n\tTHREE.Light.call( this, color );\n\n\tthis.type = 'DirectionalLight';\n\n\tthis.position.set( 0, 1, 0 );\n\tthis.updateMatrix();\n\n\tthis.target = new THREE.Object3D();\n\n\tthis.intensity = ( intensity !== undefined ) ? intensity : 1;\n\n\tthis.castShadow = false;\n\tthis.onlyShadow = false;\n\n\tthis.shadowCameraNear = 50;\n\tthis.shadowCameraFar = 5000;\n\n\tthis.shadowCameraLeft = - 500;\n\tthis.shadowCameraRight = 500;\n\tthis.shadowCameraTop = 500;\n\tthis.shadowCameraBottom = - 500;\n\n\tthis.shadowCameraVisible = false;\n\n\tthis.shadowBias = 0;\n\tthis.shadowDarkness = 0.5;\n\n\tthis.shadowMapWidth = 512;\n\tthis.shadowMapHeight = 512;\n\n\tthis.shadowMap = null;\n\tthis.shadowMapSize = null;\n\tthis.shadowCamera = null;\n\tthis.shadowMatrix = null;\n\n};\n\nTHREE.DirectionalLight.prototype = Object.create( THREE.Light.prototype );\nTHREE.DirectionalLight.prototype.constructor = THREE.DirectionalLight;\n\nTHREE.DirectionalLight.prototype.copy = function ( source ) {\n\n\tTHREE.Light.prototype.copy.call( this, source );\n\n\tthis.intensity = source.intensity;\n\tthis.target = source.target.clone();\n\n\tthis.castShadow = source.castShadow;\n\tthis.onlyShadow = source.onlyShadow;\n\n\tthis.shadowCameraNear = source.shadowCameraNear;\n\tthis.shadowCameraFar = source.shadowCameraFar;\n\n\tthis.shadowCameraLeft = source.shadowCameraLeft;\n\tthis.shadowCameraRight = source.shadowCameraRight;\n\tthis.shadowCameraTop = source.shadowCameraTop;\n\tthis.shadowCameraBottom = source.shadowCameraBottom;\n\n\tthis.shadowCameraVisible = source.shadowCameraVisible;\n\n\tthis.shadowBias = source.shadowBias;\n\tthis.shadowDarkness = source.shadowDarkness;\n\n\tthis.shadowMapWidth = source.shadowMapWidth;\n\tthis.shadowMapHeight = source.shadowMapHeight;\n\n\treturn this;\n\n};\n\nTHREE.DirectionalLight.prototype.toJSON = function ( meta ) {\n\n\tvar data = THREE.Object3D.prototype.toJSON.call( this, meta );\n\n\tdata.object.color = this.color.getHex();\n\tdata.object.intensity = this.intensity;\n\n\treturn data;\n\n};\n\n// File:src/lights/HemisphereLight.js\n\n/**\n * @author alteredq / http://alteredqualia.com/\n */\n\nTHREE.HemisphereLight = function ( skyColor, groundColor, intensity ) {\n\n\tTHREE.Light.call( this, skyColor );\n\n\tthis.type = 'HemisphereLight';\n\n\tthis.position.set( 0, 1, 0 );\n\tthis.updateMatrix();\n\n\tthis.groundColor = new THREE.Color( groundColor );\n\tthis.intensity = ( intensity !== undefined ) ? intensity : 1;\n\n};\n\nTHREE.HemisphereLight.prototype = Object.create( THREE.Light.prototype );\nTHREE.HemisphereLight.prototype.constructor = THREE.HemisphereLight;\n\nTHREE.HemisphereLight.prototype.copy = function ( source ) {\n\n\tTHREE.Light.prototype.copy.call( this, source );\n\n\tthis.groundColor.copy( source.groundColor );\n\tthis.intensity = source.intensity;\n\n\treturn this;\n\n};\n\nTHREE.HemisphereLight.prototype.toJSON = function ( meta ) {\n\n\tvar data = THREE.Object3D.prototype.toJSON.call( this, meta );\n\n\tdata.object.color = this.color.getHex();\n\tdata.object.groundColor = this.groundColor.getHex();\n\tdata.object.intensity = this.intensity;\n\n\treturn data;\n\n};\n\n// File:src/lights/PointLight.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.PointLight = function ( color, intensity, distance, decay ) {\n\n\tTHREE.Light.call( this, color );\n\n\tthis.type = 'PointLight';\n\n\tthis.intensity = ( intensity !== undefined ) ? intensity : 1;\n\tthis.distance = ( distance !== undefined ) ? distance : 0;\n\tthis.decay = ( decay !== undefined ) ? decay : 1;\t// for physically correct lights, should be 2.\n\n};\n\nTHREE.PointLight.prototype = Object.create( THREE.Light.prototype );\nTHREE.PointLight.prototype.constructor = THREE.PointLight;\n\nTHREE.PointLight.prototype.copy = function ( source ) {\n\n\tTHREE.Light.prototype.copy.call( this, source );\n\n\tthis.intensity = source.intensity;\n\tthis.distance = source.distance;\n\tthis.decay = source.decay;\n\n\treturn this;\n\n};\n\nTHREE.PointLight.prototype.toJSON = function ( meta ) {\n\n\tvar data = THREE.Object3D.prototype.toJSON.call( this, meta );\n\n\tdata.object.color = this.color.getHex();\n\tdata.object.intensity = this.intensity;\n\tdata.object.distance = this.distance;\n\tdata.object.decay = this.decay;\n\n\treturn data;\n\n};\n\n// File:src/lights/SpotLight.js\n\n/**\n * @author alteredq / http://alteredqualia.com/\n */\n\nTHREE.SpotLight = function ( color, intensity, distance, angle, exponent, decay ) {\n\n\tTHREE.Light.call( this, color );\n\n\tthis.type = 'SpotLight';\n\n\tthis.position.set( 0, 1, 0 );\n\tthis.updateMatrix();\n\n\tthis.target = new THREE.Object3D();\n\n\tthis.intensity = ( intensity !== undefined ) ? intensity : 1;\n\tthis.distance = ( distance !== undefined ) ? distance : 0;\n\tthis.angle = ( angle !== undefined ) ? angle : Math.PI / 3;\n\tthis.exponent = ( exponent !== undefined ) ? exponent : 10;\n\tthis.decay = ( decay !== undefined ) ? decay : 1;\t// for physically correct lights, should be 2.\n\n\tthis.castShadow = false;\n\tthis.onlyShadow = false;\n\n\tthis.shadowCameraNear = 50;\n\tthis.shadowCameraFar = 5000;\n\tthis.shadowCameraFov = 50;\n\n\tthis.shadowCameraVisible = false;\n\n\tthis.shadowBias = 0;\n\tthis.shadowDarkness = 0.5;\n\n\tthis.shadowMapWidth = 512;\n\tthis.shadowMapHeight = 512;\n\n\tthis.shadowMap = null;\n\tthis.shadowMapSize = null;\n\tthis.shadowCamera = null;\n\tthis.shadowMatrix = null;\n\n};\n\nTHREE.SpotLight.prototype = Object.create( THREE.Light.prototype );\nTHREE.SpotLight.prototype.constructor = THREE.SpotLight;\n\nTHREE.SpotLight.prototype.copy = function ( source ) {\n\n\tTHREE.Light.prototype.copy.call( this, source );\n\n\tthis.intensity = source.intensity;\n\tthis.distance = source.distance;\n\tthis.angle = source.angle;\n\tthis.exponent = source.exponent;\n\tthis.decay = source.decay;\n\n\tthis.target = source.target.clone();\n\n\tthis.castShadow = source.castShadow;\n\tthis.onlyShadow = source.onlyShadow;\n\n\tthis.shadowCameraNear = source.shadowCameraNear;\n\tthis.shadowCameraFar = source.shadowCameraFar;\n\tthis.shadowCameraFov = source.shadowCameraFov;\n\n\tthis.shadowCameraVisible = source.shadowCameraVisible;\n\n\tthis.shadowBias = source.shadowBias;\n\tthis.shadowDarkness = source.shadowDarkness;\n\n\tthis.shadowMapWidth = source.shadowMapWidth;\n\tthis.shadowMapHeight = source.shadowMapHeight;\n\n\treturn this;\n}\n\nTHREE.SpotLight.prototype.toJSON = function ( meta ) {\n\n\tvar data = THREE.Object3D.prototype.toJSON.call( this, meta );\n\n\tdata.object.color = this.color.getHex();\n\tdata.object.intensity = this.intensity;\n\tdata.object.distance = this.distance;\n\tdata.object.angle = this.angle;\n\tdata.object.exponent = this.exponent;\n\tdata.object.decay = this.decay;\n\n\treturn data;\n\n};\n\n// File:src/loaders/Cache.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.Cache = {\n\n\tenabled: false,\n\n\tfiles: {},\n\n\tadd: function ( key, file ) {\n\n\t\tif ( this.enabled === false ) return;\n\n\t\t// console.log( 'THREE.Cache', 'Adding key:', key );\n\n\t\tthis.files[ key ] = file;\n\n\t},\n\n\tget: function ( key ) {\n\n\t\tif ( this.enabled === false ) return;\n\n\t\t// console.log( 'THREE.Cache', 'Checking key:', key );\n\n\t\treturn this.files[ key ];\n\n\t},\n\n\tremove: function ( key ) {\n\n\t\tdelete this.files[ key ];\n\n\t},\n\n\tclear: function () {\n\n\t\tthis.files = {};\n\n\t}\n\n};\n\n// File:src/loaders/Loader.js\n\n/**\n * @author alteredq / http://alteredqualia.com/\n */\n\nTHREE.Loader = function () {\n\n\tthis.onLoadStart = function () {};\n\tthis.onLoadProgress = function () {};\n\tthis.onLoadComplete = function () {};\n\n};\n\nTHREE.Loader.prototype = {\n\n\tconstructor: THREE.Loader,\n\n\tcrossOrigin: undefined,\n\n\textractUrlBase: function ( url ) {\n\n\t\tvar parts = url.split( '/' );\n\n\t\tif ( parts.length === 1 ) return './';\n\n\t\tparts.pop();\n\n\t\treturn parts.join( '/' ) + '/';\n\n\t},\n\n\tinitMaterials: function ( materials, texturePath, crossOrigin ) {\n\n\t\tvar array = [];\n\n\t\tfor ( var i = 0; i < materials.length; ++ i ) {\n\n\t\t\tarray[ i ] = this.createMaterial( materials[ i ], texturePath, crossOrigin );\n\n\t\t}\n\n\t\treturn array;\n\n\t},\n\n\tcreateMaterial: ( function () {\n\n\t\tvar imageLoader;\n\n\t\treturn function createMaterial( m, texturePath, crossOrigin ) {\n\n\t\t\tvar scope = this;\n\n\t\t\tif ( crossOrigin === undefined && scope.crossOrigin !== undefined ) crossOrigin = scope.crossOrigin;\n\n\t\t\tif ( imageLoader === undefined ) imageLoader = new THREE.ImageLoader();\n\n\t\t\tfunction nearest_pow2( n ) {\n\n\t\t\t\tvar l = Math.log( n ) / Math.LN2;\n\t\t\t\treturn Math.pow( 2, Math.round(  l ) );\n\n\t\t\t}\n\n\t\t\tfunction create_texture( where, name, sourceFile, repeat, offset, wrap, anisotropy ) {\n\n\t\t\t\tvar fullPath = texturePath + sourceFile;\n\n\t\t\t\tvar texture;\n\n\t\t\t\tvar loader = THREE.Loader.Handlers.get( fullPath );\n\n\t\t\t\tif ( loader !== null ) {\n\n\t\t\t\t\ttexture = loader.load( fullPath );\n\n\t\t\t\t} else {\n\n\t\t\t\t\ttexture = new THREE.Texture();\n\n\t\t\t\t\tloader = imageLoader;\n\t\t\t\t\tloader.setCrossOrigin( crossOrigin );\n\t\t\t\t\tloader.load( fullPath, function ( image ) {\n\n\t\t\t\t\t\tif ( THREE.Math.isPowerOfTwo( image.width ) === false ||\n\t\t\t\t\t\t\tTHREE.Math.isPowerOfTwo( image.height ) === false ) {\n\n\t\t\t\t\t\t\tvar width = nearest_pow2( image.width );\n\t\t\t\t\t\t\tvar height = nearest_pow2( image.height );\n\n\t\t\t\t\t\t\tvar canvas = document.createElement( 'canvas' );\n\t\t\t\t\t\t\tcanvas.width = width;\n\t\t\t\t\t\t\tcanvas.height = height;\n\n\t\t\t\t\t\t\tvar context = canvas.getContext( '2d' );\n\t\t\t\t\t\t\tcontext.drawImage( image, 0, 0, width, height );\n\n\t\t\t\t\t\t\ttexture.image = canvas;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\ttexture.image = image;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttexture.needsUpdate = true;\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t\ttexture.sourceFile = sourceFile;\n\n\t\t\t\tif ( repeat ) {\n\n\t\t\t\t\ttexture.repeat.set( repeat[ 0 ], repeat[ 1 ] );\n\n\t\t\t\t\tif ( repeat[ 0 ] !== 1 ) texture.wrapS = THREE.RepeatWrapping;\n\t\t\t\t\tif ( repeat[ 1 ] !== 1 ) texture.wrapT = THREE.RepeatWrapping;\n\n\t\t\t\t}\n\n\t\t\t\tif ( offset ) {\n\n\t\t\t\t\ttexture.offset.set( offset[ 0 ], offset[ 1 ] );\n\n\t\t\t\t}\n\n\t\t\t\tif ( wrap ) {\n\n\t\t\t\t\tvar wrapMap = {\n\t\t\t\t\t\t'repeat': THREE.RepeatWrapping,\n\t\t\t\t\t\t'mirror': THREE.MirroredRepeatWrapping\n\t\t\t\t\t};\n\n\t\t\t\t\tif ( wrapMap[ wrap[ 0 ] ] !== undefined ) texture.wrapS = wrapMap[ wrap[ 0 ] ];\n\t\t\t\t\tif ( wrapMap[ wrap[ 1 ] ] !== undefined ) texture.wrapT = wrapMap[ wrap[ 1 ] ];\n\n\t\t\t\t}\n\n\t\t\t\tif ( anisotropy ) {\n\n\t\t\t\t\ttexture.anisotropy = anisotropy;\n\n\t\t\t\t}\n\n\t\t\t\twhere[ name ] = texture;\n\n\t\t\t}\n\n\t\t\tfunction rgb2hex( rgb ) {\n\n\t\t\t\treturn ( rgb[ 0 ] * 255 << 16 ) + ( rgb[ 1 ] * 255 << 8 ) + rgb[ 2 ] * 255;\n\n\t\t\t}\n\n\t\t\t// defaults\n\n\t\t\tvar mtype = 'MeshLambertMaterial';\n\t\t\tvar mpars = {};\n\n\t\t\t// parameters from model file\n\n\t\t\tif ( m.shading ) {\n\n\t\t\t\tvar shading = m.shading.toLowerCase();\n\n\t\t\t\tif ( shading === 'phong' ) mtype = 'MeshPhongMaterial';\n\t\t\t\telse if ( shading === 'basic' ) mtype = 'MeshBasicMaterial';\n\n\t\t\t}\n\n\t\t\tif ( m.blending !== undefined && THREE[ m.blending ] !== undefined ) {\n\n\t\t\t\tmpars.blending = THREE[ m.blending ];\n\n\t\t\t}\n\n\t\t\tif ( m.transparent !== undefined ) {\n\n\t\t\t\tmpars.transparent = m.transparent;\n\n\t\t\t}\n\n\t\t\tif ( m.opacity !== undefined && m.opacity < 1.0 ) {\n\n\t\t\t\tmpars.transparent = true;\n\n\t\t\t}\n\n\t\t\tif ( m.depthTest !== undefined ) {\n\n\t\t\t\tmpars.depthTest = m.depthTest;\n\n\t\t\t}\n\n\t\t\tif ( m.depthWrite !== undefined ) {\n\n\t\t\t\tmpars.depthWrite = m.depthWrite;\n\n\t\t\t}\n\n\t\t\tif ( m.visible !== undefined ) {\n\n\t\t\t\tmpars.visible = m.visible;\n\n\t\t\t}\n\n\t\t\tif ( m.flipSided !== undefined ) {\n\n\t\t\t\tmpars.side = THREE.BackSide;\n\n\t\t\t}\n\n\t\t\tif ( m.doubleSided !== undefined ) {\n\n\t\t\t\tmpars.side = THREE.DoubleSide;\n\n\t\t\t}\n\n\t\t\tif ( m.wireframe !== undefined ) {\n\n\t\t\t\tmpars.wireframe = m.wireframe;\n\n\t\t\t}\n\n\t\t\tif ( m.vertexColors !== undefined ) {\n\n\t\t\t\tif ( m.vertexColors === 'face' ) {\n\n\t\t\t\t\tmpars.vertexColors = THREE.FaceColors;\n\n\t\t\t\t} else if ( m.vertexColors ) {\n\n\t\t\t\t\tmpars.vertexColors = THREE.VertexColors;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// colors\n\n\t\t\tif ( m.colorDiffuse ) {\n\n\t\t\t\tmpars.color = rgb2hex( m.colorDiffuse );\n\n\t\t\t} else if ( m.DbgColor ) {\n\n\t\t\t\tmpars.color = m.DbgColor;\n\n\t\t\t}\n\n\t\t\tif ( m.colorEmissive ) {\n\n\t\t\t\tmpars.emissive = rgb2hex( m.colorEmissive );\n\n\t\t\t}\n\n\t\t\tif ( mtype === 'MeshPhongMaterial' ) {\n\n\t\t\t\tif ( m.colorSpecular ) {\n\n\t\t\t\t\tmpars.specular = rgb2hex( m.colorSpecular );\n\n\t\t\t\t}\n\n\t\t\t\tif ( m.specularCoef ) {\n\n\t\t\t\t\tmpars.shininess = m.specularCoef;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// modifiers\n\n\t\t\tif ( m.transparency !== undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.Loader: transparency has been renamed to opacity' );\n\t\t\t\tm.opacity = m.transparency;\n\n\t\t\t}\n\n\t\t\tif ( m.opacity !== undefined ) {\n\n\t\t\t\tmpars.opacity = m.opacity;\n\n\t\t\t}\n\n\t\t\t// textures\n\n\t\t\tif ( texturePath ) {\n\n\t\t\t\tif ( m.mapDiffuse ) {\n\n\t\t\t\t\tcreate_texture( mpars, 'map', m.mapDiffuse, m.mapDiffuseRepeat, m.mapDiffuseOffset, m.mapDiffuseWrap, m.mapDiffuseAnisotropy );\n\n\t\t\t\t}\n\n\t\t\t\tif ( m.mapLight ) {\n\n\t\t\t\t\tcreate_texture( mpars, 'lightMap', m.mapLight, m.mapLightRepeat, m.mapLightOffset, m.mapLightWrap, m.mapLightAnisotropy );\n\n\t\t\t\t}\n\n\t\t\t\tif ( m.mapAO ) {\n\n\t\t\t\t\tcreate_texture( mpars, 'aoMap', m.mapAO, m.mapAORepeat, m.mapAOOffset, m.mapAOWrap, m.mapAOAnisotropy );\n\n\t\t\t\t}\n\n\t\t\t\tif ( m.mapBump ) {\n\n\t\t\t\t\tcreate_texture( mpars, 'bumpMap', m.mapBump, m.mapBumpRepeat, m.mapBumpOffset, m.mapBumpWrap, m.mapBumpAnisotropy );\n\n\t\t\t\t}\n\n\t\t\t\tif ( m.mapNormal ) {\n\n\t\t\t\t\tcreate_texture( mpars, 'normalMap', m.mapNormal, m.mapNormalRepeat, m.mapNormalOffset, m.mapNormalWrap, m.mapNormalAnisotropy );\n\n\t\t\t\t}\n\n\t\t\t\tif ( m.mapSpecular ) {\n\n\t\t\t\t\tcreate_texture( mpars, 'specularMap', m.mapSpecular, m.mapSpecularRepeat, m.mapSpecularOffset, m.mapSpecularWrap, m.mapSpecularAnisotropy );\n\n\t\t\t\t}\n\n\t\t\t\tif ( m.mapAlpha ) {\n\n\t\t\t\t\tcreate_texture( mpars, 'alphaMap', m.mapAlpha, m.mapAlphaRepeat, m.mapAlphaOffset, m.mapAlphaWrap, m.mapAlphaAnisotropy );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t//\n\n\t\t\tif ( m.mapBumpScale ) {\n\n\t\t\t\tmpars.bumpScale = m.mapBumpScale;\n\n\t\t\t}\n\n\t\t\tif ( m.mapNormalFactor ) {\n\n\t\t\t\tmpars.normalScale = new THREE.Vector2( m.mapNormalFactor, m.mapNormalFactor );\n\n\t\t\t}\n\n\t\t\tvar material = new THREE[ mtype ]( mpars );\n\n\t\t\tif ( m.DbgName !== undefined ) material.name = m.DbgName;\n\n\t\t\treturn material;\n\n\t\t};\n\n\t} )()\n\n};\n\nTHREE.Loader.Handlers = {\n\n\thandlers: [],\n\n\tadd: function ( regex, loader ) {\n\n\t\tthis.handlers.push( regex, loader );\n\n\t},\n\n\tget: function ( file ) {\n\n\t\tfor ( var i = 0, l = this.handlers.length; i < l; i += 2 ) {\n\n\t\t\tvar regex = this.handlers[ i ];\n\t\t\tvar loader  = this.handlers[ i + 1 ];\n\n\t\t\tif ( regex.test( file ) ) {\n\n\t\t\t\treturn loader;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n};\n\n// File:src/loaders/XHRLoader.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.XHRLoader = function ( manager ) {\n\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\n\n};\n\nTHREE.XHRLoader.prototype = {\n\n\tconstructor: THREE.XHRLoader,\n\n\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\tvar scope = this;\n\n\t\tvar cached = THREE.Cache.get( url );\n\n\t\tif ( cached !== undefined ) {\n\n\t\t\tif ( onLoad ) {\n\n\t\t\t\tsetTimeout( function () {\n\n\t\t\t\t\tonLoad( cached );\n\n\t\t\t\t}, 0 );\n\n\t\t\t}\n\n\t\t\treturn cached;\n\n\t\t}\n\n\t\tvar request = new XMLHttpRequest();\n\t\trequest.open( 'GET', url, true );\n\n\t\trequest.addEventListener( 'load', function ( event ) {\n\n\t\t\tTHREE.Cache.add( url, this.response );\n\n\t\t\tif ( onLoad ) onLoad( this.response );\n\n\t\t\tscope.manager.itemEnd( url );\n\n\t\t}, false );\n\n\t\tif ( onProgress !== undefined ) {\n\n\t\t\trequest.addEventListener( 'progress', function ( event ) {\n\n\t\t\t\tonProgress( event );\n\n\t\t\t}, false );\n\n\t\t}\n\n\t\trequest.addEventListener( 'error', function ( event ) {\n\n\t\t\tif ( onError ) onError( event );\n\n\t\t\tscope.manager.itemError( url );\n\n\t\t}, false );\n\n\t\tif ( this.crossOrigin !== undefined ) request.crossOrigin = this.crossOrigin;\n\t\tif ( this.responseType !== undefined ) request.responseType = this.responseType;\n\t\tif ( this.withCredentials !== undefined ) request.withCredentials = this.withCredentials;\n\n\t\trequest.send( null );\n\n\t\tscope.manager.itemStart( url );\n\n\t\treturn request;\n\n\t},\n\n\tsetResponseType: function ( value ) {\n\n\t\tthis.responseType = value;\n\n\t},\n\n\tsetCrossOrigin: function ( value ) {\n\n\t\tthis.crossOrigin = value;\n\n\t},\n\n\tsetWithCredentials: function ( value ) {\n\n\t\tthis.withCredentials = value;\n\n\t}\n\n};\n\n// File:src/loaders/ImageLoader.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.ImageLoader = function ( manager ) {\n\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\n\n};\n\nTHREE.ImageLoader.prototype = {\n\n\tconstructor: THREE.ImageLoader,\n\n\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\tvar scope = this;\n\n\t\tvar cached = THREE.Cache.get( url );\n\n\t\tif ( cached !== undefined ) {\n\n\t\t\tif ( onLoad ) {\n\n\t\t\t\tsetTimeout( function () {\n\n\t\t\t\t\tonLoad( cached );\n\n\t\t\t\t}, 0 );\n\n\t\t\t}\n\n\t\t\treturn cached;\n\n\t\t}\n\n\t\tvar image = document.createElement( 'img' );\n\n\t\timage.addEventListener( 'load', function ( event ) {\n\n\t\t\tTHREE.Cache.add( url, this );\n\n\t\t\tif ( onLoad ) onLoad( this );\n\n\t\t\tscope.manager.itemEnd( url );\n\n\t\t}, false );\n\n\t\tif ( onProgress !== undefined ) {\n\n\t\t\timage.addEventListener( 'progress', function ( event ) {\n\n\t\t\t\tonProgress( event );\n\n\t\t\t}, false );\n\n\t\t}\n\n\t\timage.addEventListener( 'error', function ( event ) {\n\n\t\t\tif ( onError ) onError( event );\n\n\t\t\tscope.manager.itemError( url );\n\n\t\t}, false );\n\n\t\tif ( this.crossOrigin !== undefined ) image.crossOrigin = this.crossOrigin;\n\n\t\tscope.manager.itemStart( url );\n\n\t\timage.src = url;\n\n\t\treturn image;\n\n\t},\n\n\tsetCrossOrigin: function ( value ) {\n\n\t\tthis.crossOrigin = value;\n\n\t}\n\n};\n\n// File:src/loaders/JSONLoader.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n * @author alteredq / http://alteredqualia.com/\n */\n\nTHREE.JSONLoader = function ( manager ) {\n\n\tif ( typeof manager === 'boolean' ) {\n\n\t\tconsole.warn( 'THREE.JSONLoader: showStatus parameter has been removed from constructor.' );\n\t\tmanager = undefined;\n\n\t}\n\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\n\n\tthis.withCredentials = false;\n\n};\n\nTHREE.JSONLoader.prototype = {\n\n\tconstructor: THREE.JSONLoader,\n\n\t// Deprecated\n\t\n\tget statusDomElement () {\n\n\t\tif ( this._statusDomElement === undefined ) {\n\n\t\t\tthis._statusDomElement = document.createElement( 'div' );\n\n\t\t}\n\n\t\tconsole.warn( 'THREE.JSONLoader: .statusDomElement has been removed.' );\n\t\treturn this._statusDomElement;\n\n\t},\n\n\tload: function( url, onLoad, onProgress, onError ) {\n\n\t\tvar scope = this;\n\n\t\tvar texturePath = this.texturePath && ( typeof this.texturePath === \"string\" ) ? this.texturePath : THREE.Loader.prototype.extractUrlBase( url );\n\n\t\tvar loader = new THREE.XHRLoader( this.manager );\n\t\tloader.setCrossOrigin( this.crossOrigin );\n\t\tloader.setWithCredentials( this.withCredentials );\n\t\tloader.load( url, function ( text ) {\n\n\t\t\tvar json = JSON.parse( text );\n\t\t\tvar metadata = json.metadata;\n\n\t\t\tif ( metadata !== undefined ) {\n\n\t\t\t\tif ( metadata.type === 'object' ) {\n\n\t\t\t\t\tconsole.error( 'THREE.JSONLoader: ' + url + ' should be loaded with THREE.ObjectLoader instead.' );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\tif ( metadata.type === 'scene' ) {\n\n\t\t\t\t\tconsole.error( 'THREE.JSONLoader: ' + url + ' should be loaded with THREE.SceneLoader instead.' );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar object = scope.parse( json, texturePath );\n\t\t\tonLoad( object.geometry, object.materials );\n\n\t\t} );\n\n\t},\n\n\tsetCrossOrigin: function ( value ) {\n\n\t\tthis.crossOrigin = value;\n\n\t},\n\n\tsetTexturePath: function ( value ) {\n\n\t\tthis.texturePath = value;\n\n\t},\n\n\tparse: function ( json, texturePath ) {\n\n\t\tvar geometry = new THREE.Geometry(),\n\t\tscale = ( json.scale !== undefined ) ? 1.0 / json.scale : 1.0;\n\n\t\tparseModel( scale );\n\n\t\tparseSkin();\n\t\tparseMorphing( scale );\n\n\t\tgeometry.computeFaceNormals();\n\t\tgeometry.computeBoundingSphere();\n\n\t\tfunction parseModel( scale ) {\n\n\t\t\tfunction isBitSet( value, position ) {\n\n\t\t\t\treturn value & ( 1 << position );\n\n\t\t\t}\n\n\t\t\tvar i, j, fi,\n\n\t\t\toffset, zLength,\n\n\t\tcolorIndex, normalIndex, uvIndex, materialIndex,\n\n\t\t\ttype,\n\t\t\tisQuad,\n\t\t\thasMaterial,\n\t\t\thasFaceVertexUv,\n\t\t\thasFaceNormal, hasFaceVertexNormal,\n\t\t\thasFaceColor, hasFaceVertexColor,\n\n\t\tvertex, face, faceA, faceB, hex, normal,\n\n\t\t\tuvLayer, uv, u, v,\n\n\t\t\tfaces = json.faces,\n\t\t\tvertices = json.vertices,\n\t\t\tnormals = json.normals,\n\t\t\tcolors = json.colors,\n\n\t\t\tnUvLayers = 0;\n\n\t\t\tif ( json.uvs !== undefined ) {\n\n\t\t\t\t// disregard empty arrays\n\n\t\t\t\tfor ( i = 0; i < json.uvs.length; i ++ ) {\n\n\t\t\t\t\tif ( json.uvs[ i ].length ) nUvLayers ++;\n\n\t\t\t\t}\n\n\t\t\t\tfor ( i = 0; i < nUvLayers; i ++ ) {\n\n\t\t\t\t\tgeometry.faceVertexUvs[ i ] = [];\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\toffset = 0;\n\t\t\tzLength = vertices.length;\n\n\t\t\twhile ( offset < zLength ) {\n\n\t\t\t\tvertex = new THREE.Vector3();\n\n\t\t\t\tvertex.x = vertices[ offset ++ ] * scale;\n\t\t\t\tvertex.y = vertices[ offset ++ ] * scale;\n\t\t\t\tvertex.z = vertices[ offset ++ ] * scale;\n\n\t\t\t\tgeometry.vertices.push( vertex );\n\n\t\t\t}\n\n\t\t\toffset = 0;\n\t\t\tzLength = faces.length;\n\n\t\t\twhile ( offset < zLength ) {\n\n\t\t\t\ttype = faces[ offset ++ ];\n\n\n\t\t\t\tisQuad              = isBitSet( type, 0 );\n\t\t\t\thasMaterial         = isBitSet( type, 1 );\n\t\t\t\thasFaceVertexUv     = isBitSet( type, 3 );\n\t\t\t\thasFaceNormal       = isBitSet( type, 4 );\n\t\t\t\thasFaceVertexNormal = isBitSet( type, 5 );\n\t\t\t\thasFaceColor\t     = isBitSet( type, 6 );\n\t\t\t\thasFaceVertexColor  = isBitSet( type, 7 );\n\n\t\t\t\t// console.log(\"type\", type, \"bits\", isQuad, hasMaterial, hasFaceVertexUv, hasFaceNormal, hasFaceVertexNormal, hasFaceColor, hasFaceVertexColor);\n\n\t\t\t\tif ( isQuad ) {\n\n\t\t\t\t\tfaceA = new THREE.Face3();\n\t\t\t\t\tfaceA.a = faces[ offset ];\n\t\t\t\t\tfaceA.b = faces[ offset + 1 ];\n\t\t\t\t\tfaceA.c = faces[ offset + 3 ];\n\n\t\t\t\t\tfaceB = new THREE.Face3();\n\t\t\t\t\tfaceB.a = faces[ offset + 1 ];\n\t\t\t\t\tfaceB.b = faces[ offset + 2 ];\n\t\t\t\t\tfaceB.c = faces[ offset + 3 ];\n\n\t\t\t\t\toffset += 4;\n\n\t\t\t\t\tif ( hasMaterial ) {\n\n\t\t\t\t\t\tmaterialIndex = faces[ offset ++ ];\n\t\t\t\t\t\tfaceA.materialIndex = materialIndex;\n\t\t\t\t\t\tfaceB.materialIndex = materialIndex;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// to get face <=> uv index correspondence\n\n\t\t\t\t\tfi = geometry.faces.length;\n\n\t\t\t\t\tif ( hasFaceVertexUv ) {\n\n\t\t\t\t\t\tfor ( i = 0; i < nUvLayers; i ++ ) {\n\n\t\t\t\t\t\t\tuvLayer = json.uvs[ i ];\n\n\t\t\t\t\t\t\tgeometry.faceVertexUvs[ i ][ fi ] = [];\n\t\t\t\t\t\t\tgeometry.faceVertexUvs[ i ][ fi + 1 ] = [];\n\n\t\t\t\t\t\t\tfor ( j = 0; j < 4; j ++ ) {\n\n\t\t\t\t\t\t\t\tuvIndex = faces[ offset ++ ];\n\n\t\t\t\t\t\t\t\tu = uvLayer[ uvIndex * 2 ];\n\t\t\t\t\t\t\t\tv = uvLayer[ uvIndex * 2 + 1 ];\n\n\t\t\t\t\t\t\t\tuv = new THREE.Vector2( u, v );\n\n\t\t\t\t\t\t\t\tif ( j !== 2 ) geometry.faceVertexUvs[ i ][ fi ].push( uv );\n\t\t\t\t\t\t\t\tif ( j !== 0 ) geometry.faceVertexUvs[ i ][ fi + 1 ].push( uv );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( hasFaceNormal ) {\n\n\t\t\t\t\t\tnormalIndex = faces[ offset ++ ] * 3;\n\n\t\t\t\t\t\tfaceA.normal.set(\n\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\n\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\n\t\t\t\t\t\t\tnormals[ normalIndex ]\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tfaceB.normal.copy( faceA.normal );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( hasFaceVertexNormal ) {\n\n\t\t\t\t\t\tfor ( i = 0; i < 4; i ++ ) {\n\n\t\t\t\t\t\t\tnormalIndex = faces[ offset ++ ] * 3;\n\n\t\t\t\t\t\t\tnormal = new THREE.Vector3(\n\t\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\n\t\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\n\t\t\t\t\t\t\t\tnormals[ normalIndex ]\n\t\t\t\t\t\t\t);\n\n\n\t\t\t\t\t\t\tif ( i !== 2 ) faceA.vertexNormals.push( normal );\n\t\t\t\t\t\t\tif ( i !== 0 ) faceB.vertexNormals.push( normal );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\n\t\t\t\t\tif ( hasFaceColor ) {\n\n\t\t\t\t\t\tcolorIndex = faces[ offset ++ ];\n\t\t\t\t\t\thex = colors[ colorIndex ];\n\n\t\t\t\t\t\tfaceA.color.setHex( hex );\n\t\t\t\t\t\tfaceB.color.setHex( hex );\n\n\t\t\t\t\t}\n\n\n\t\t\t\t\tif ( hasFaceVertexColor ) {\n\n\t\t\t\t\t\tfor ( i = 0; i < 4; i ++ ) {\n\n\t\t\t\t\t\t\tcolorIndex = faces[ offset ++ ];\n\t\t\t\t\t\t\thex = colors[ colorIndex ];\n\n\t\t\t\t\t\t\tif ( i !== 2 ) faceA.vertexColors.push( new THREE.Color( hex ) );\n\t\t\t\t\t\t\tif ( i !== 0 ) faceB.vertexColors.push( new THREE.Color( hex ) );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tgeometry.faces.push( faceA );\n\t\t\t\t\tgeometry.faces.push( faceB );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tface = new THREE.Face3();\n\t\t\t\t\tface.a = faces[ offset ++ ];\n\t\t\t\t\tface.b = faces[ offset ++ ];\n\t\t\t\t\tface.c = faces[ offset ++ ];\n\n\t\t\t\t\tif ( hasMaterial ) {\n\n\t\t\t\t\t\tmaterialIndex = faces[ offset ++ ];\n\t\t\t\t\t\tface.materialIndex = materialIndex;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// to get face <=> uv index correspondence\n\n\t\t\t\t\tfi = geometry.faces.length;\n\n\t\t\t\t\tif ( hasFaceVertexUv ) {\n\n\t\t\t\t\t\tfor ( i = 0; i < nUvLayers; i ++ ) {\n\n\t\t\t\t\t\t\tuvLayer = json.uvs[ i ];\n\n\t\t\t\t\t\t\tgeometry.faceVertexUvs[ i ][ fi ] = [];\n\n\t\t\t\t\t\t\tfor ( j = 0; j < 3; j ++ ) {\n\n\t\t\t\t\t\t\t\tuvIndex = faces[ offset ++ ];\n\n\t\t\t\t\t\t\t\tu = uvLayer[ uvIndex * 2 ];\n\t\t\t\t\t\t\t\tv = uvLayer[ uvIndex * 2 + 1 ];\n\n\t\t\t\t\t\t\t\tuv = new THREE.Vector2( u, v );\n\n\t\t\t\t\t\t\t\tgeometry.faceVertexUvs[ i ][ fi ].push( uv );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( hasFaceNormal ) {\n\n\t\t\t\t\t\tnormalIndex = faces[ offset ++ ] * 3;\n\n\t\t\t\t\t\tface.normal.set(\n\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\n\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\n\t\t\t\t\t\t\tnormals[ normalIndex ]\n\t\t\t\t\t\t);\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( hasFaceVertexNormal ) {\n\n\t\t\t\t\t\tfor ( i = 0; i < 3; i ++ ) {\n\n\t\t\t\t\t\t\tnormalIndex = faces[ offset ++ ] * 3;\n\n\t\t\t\t\t\t\tnormal = new THREE.Vector3(\n\t\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\n\t\t\t\t\t\t\t\tnormals[ normalIndex ++ ],\n\t\t\t\t\t\t\t\tnormals[ normalIndex ]\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tface.vertexNormals.push( normal );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\n\t\t\t\t\tif ( hasFaceColor ) {\n\n\t\t\t\t\t\tcolorIndex = faces[ offset ++ ];\n\t\t\t\t\t\tface.color.setHex( colors[ colorIndex ] );\n\n\t\t\t\t\t}\n\n\n\t\t\t\t\tif ( hasFaceVertexColor ) {\n\n\t\t\t\t\t\tfor ( i = 0; i < 3; i ++ ) {\n\n\t\t\t\t\t\t\tcolorIndex = faces[ offset ++ ];\n\t\t\t\t\t\t\tface.vertexColors.push( new THREE.Color( colors[ colorIndex ] ) );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tgeometry.faces.push( face );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t};\n\n\t\tfunction parseSkin() {\n\n\t\t\tvar influencesPerVertex = ( json.influencesPerVertex !== undefined ) ? json.influencesPerVertex : 2;\n\n\t\t\tif ( json.skinWeights ) {\n\n\t\t\t\tfor ( var i = 0, l = json.skinWeights.length; i < l; i += influencesPerVertex ) {\n\n\t\t\t\t\tvar x =                               json.skinWeights[ i ];\n\t\t\t\t\tvar y = ( influencesPerVertex > 1 ) ? json.skinWeights[ i + 1 ] : 0;\n\t\t\t\t\tvar z = ( influencesPerVertex > 2 ) ? json.skinWeights[ i + 2 ] : 0;\n\t\t\t\t\tvar w = ( influencesPerVertex > 3 ) ? json.skinWeights[ i + 3 ] : 0;\n\n\t\t\t\t\tgeometry.skinWeights.push( new THREE.Vector4( x, y, z, w ) );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( json.skinIndices ) {\n\n\t\t\t\tfor ( var i = 0, l = json.skinIndices.length; i < l; i += influencesPerVertex ) {\n\n\t\t\t\t\tvar a =                               json.skinIndices[ i ];\n\t\t\t\t\tvar b = ( influencesPerVertex > 1 ) ? json.skinIndices[ i + 1 ] : 0;\n\t\t\t\t\tvar c = ( influencesPerVertex > 2 ) ? json.skinIndices[ i + 2 ] : 0;\n\t\t\t\t\tvar d = ( influencesPerVertex > 3 ) ? json.skinIndices[ i + 3 ] : 0;\n\n\t\t\t\t\tgeometry.skinIndices.push( new THREE.Vector4( a, b, c, d ) );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tgeometry.bones = json.bones;\n\n\t\t\tif ( geometry.bones && geometry.bones.length > 0 && ( geometry.skinWeights.length !== geometry.skinIndices.length || geometry.skinIndices.length !== geometry.vertices.length ) ) {\n\n\t\t\t\tconsole.warn( 'When skinning, number of vertices (' + geometry.vertices.length + '), skinIndices (' +\n\t\t\t\t\tgeometry.skinIndices.length + '), and skinWeights (' + geometry.skinWeights.length + ') should match.' );\n\n\t\t\t}\n\n\n\t\t\t// could change this to json.animations[0] or remove completely\n\n\t\t\tgeometry.animation = json.animation;\n\t\t\tgeometry.animations = json.animations;\n\n\t\t};\n\n\t\tfunction parseMorphing( scale ) {\n\n\t\t\tif ( json.morphTargets !== undefined ) {\n\n\t\t\t\tvar i, l, v, vl, dstVertices, srcVertices;\n\n\t\t\t\tfor ( i = 0, l = json.morphTargets.length; i < l; i ++ ) {\n\n\t\t\t\t\tgeometry.morphTargets[ i ] = {};\n\t\t\t\t\tgeometry.morphTargets[ i ].name = json.morphTargets[ i ].name;\n\t\t\t\t\tgeometry.morphTargets[ i ].vertices = [];\n\n\t\t\t\t\tdstVertices = geometry.morphTargets[ i ].vertices;\n\t\t\t\t\tsrcVertices = json.morphTargets[ i ].vertices;\n\n\t\t\t\t\tfor ( v = 0, vl = srcVertices.length; v < vl; v += 3 ) {\n\n\t\t\t\t\t\tvar vertex = new THREE.Vector3();\n\t\t\t\t\t\tvertex.x = srcVertices[ v ] * scale;\n\t\t\t\t\t\tvertex.y = srcVertices[ v + 1 ] * scale;\n\t\t\t\t\t\tvertex.z = srcVertices[ v + 2 ] * scale;\n\n\t\t\t\t\t\tdstVertices.push( vertex );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( json.morphColors !== undefined ) {\n\n\t\t\t\tvar i, l, c, cl, dstColors, srcColors, color;\n\n\t\t\t\tfor ( i = 0, l = json.morphColors.length; i < l; i ++ ) {\n\n\t\t\t\t\tgeometry.morphColors[ i ] = {};\n\t\t\t\t\tgeometry.morphColors[ i ].name = json.morphColors[ i ].name;\n\t\t\t\t\tgeometry.morphColors[ i ].colors = [];\n\n\t\t\t\t\tdstColors = geometry.morphColors[ i ].colors;\n\t\t\t\t\tsrcColors = json.morphColors[ i ].colors;\n\n\t\t\t\t\tfor ( c = 0, cl = srcColors.length; c < cl; c += 3 ) {\n\n\t\t\t\t\t\tcolor = new THREE.Color( 0xffaa00 );\n\t\t\t\t\t\tcolor.setRGB( srcColors[ c ], srcColors[ c + 1 ], srcColors[ c + 2 ] );\n\t\t\t\t\t\tdstColors.push( color );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t};\n\n\t\tif ( json.materials === undefined || json.materials.length === 0 ) {\n\n\t\t\treturn { geometry: geometry };\n\n\t\t} else {\n\n\t\t\tvar materials = THREE.Loader.prototype.initMaterials( json.materials, texturePath, this.crossOrigin );\n\n\t\t\treturn { geometry: geometry, materials: materials };\n\n\t\t}\n\n\t}\n\n};\n\n// File:src/loaders/LoadingManager.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.LoadingManager = function ( onLoad, onProgress, onError ) {\n\n\tvar scope = this;\n\n\tvar isLoading = false, itemsLoaded = 0, itemsTotal = 0;\n\n\tthis.onStart = undefined;\n\tthis.onLoad = onLoad;\n\tthis.onProgress = onProgress;\n\tthis.onError = onError;\n\n\tthis.itemStart = function ( url ) {\n\n\t\titemsTotal ++;\n\n\t\tif ( isLoading === false ) {\n\n\t\t\tif ( scope.onStart !== undefined ) {\n\n\t\t\t\tscope.onStart( url, itemsLoaded, itemsTotal );\n\n\t\t\t}\n\n\t\t}\n\n\t\tisLoading = true;\n\n\t};\n\n\tthis.itemEnd = function ( url ) {\n\n\t\titemsLoaded ++;\n\n\t\tif ( scope.onProgress !== undefined ) {\n\n\t\t\tscope.onProgress( url, itemsLoaded, itemsTotal );\n\n\t\t}\n\n\t\tif ( itemsLoaded === itemsTotal ) {\n\n\t\t\tisLoading = false;\n\n\t\t\tif ( scope.onLoad !== undefined ) {\n\n\t\t\t\tscope.onLoad();\n\n\t\t\t}\n\n\t\t}\n\n\t};\n\n\tthis.itemError = function ( url ) {\n\n\t\tif ( scope.onError !== undefined ) {\n\n\t\t\tscope.onError( url );\n\n\t\t}\n\n\t};\n\n};\n\nTHREE.DefaultLoadingManager = new THREE.LoadingManager();\n\n// File:src/loaders/BufferGeometryLoader.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.BufferGeometryLoader = function ( manager ) {\n\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\n\n};\n\nTHREE.BufferGeometryLoader.prototype = {\n\n\tconstructor: THREE.BufferGeometryLoader,\n\n\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\tvar scope = this;\n\n\t\tvar loader = new THREE.XHRLoader( scope.manager );\n\t\tloader.setCrossOrigin( this.crossOrigin );\n\t\tloader.load( url, function ( text ) {\n\n\t\t\tonLoad( scope.parse( JSON.parse( text ) ) );\n\n\t\t}, onProgress, onError );\n\n\t},\n\n\tsetCrossOrigin: function ( value ) {\n\n\t\tthis.crossOrigin = value;\n\n\t},\n\n\tparse: function ( json ) {\n\n\t\tvar geometry = new THREE.BufferGeometry();\n\n\t\tvar index = json.data.index;\n\n\t\tif ( index !== undefined ) {\n\n\t\t\tvar typedArray = new self[ index.type ]( index.array );\n\t\t\tgeometry.setIndex( new THREE.BufferAttribute( typedArray, 1 ) );\n\n\t\t}\n\n\t\tvar attributes = json.data.attributes;\n\n\t\tfor ( var key in attributes ) {\n\n\t\t\tvar attribute = attributes[ key ];\n\t\t\tvar typedArray = new self[ attribute.type ]( attribute.array );\n\n\t\t\tgeometry.addAttribute( key, new THREE.BufferAttribute( typedArray, attribute.itemSize ) );\n\n\t\t}\n\n\t\tvar groups = json.data.groups || json.data.drawcalls || json.data.offsets;\n\n\t\tif ( groups !== undefined ) {\n\n\t\t\tfor ( var i = 0, n = groups.length; i !== n; ++ i ) {\n\n\t\t\t\tvar group = groups[ i ];\n\n\t\t\t\tgeometry.addGroup( group.start, group.count );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvar boundingSphere = json.data.boundingSphere;\n\n\t\tif ( boundingSphere !== undefined ) {\n\n\t\t\tvar center = new THREE.Vector3();\n\n\t\t\tif ( boundingSphere.center !== undefined ) {\n\n\t\t\t\tcenter.fromArray( boundingSphere.center );\n\n\t\t\t}\n\n\t\t\tgeometry.boundingSphere = new THREE.Sphere( center, boundingSphere.radius );\n\n\t\t}\n\n\t\treturn geometry;\n\n\t}\n\n};\n\n// File:src/loaders/MaterialLoader.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.MaterialLoader = function ( manager ) {\n\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\n\tthis.textures = {};\n\n};\n\nTHREE.MaterialLoader.prototype = {\n\n\tconstructor: THREE.MaterialLoader,\n\n\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\tvar scope = this;\n\n\t\tvar loader = new THREE.XHRLoader( scope.manager );\n\t\tloader.setCrossOrigin( this.crossOrigin );\n\t\tloader.load( url, function ( text ) {\n\n\t\t\tonLoad( scope.parse( JSON.parse( text ) ) );\n\n\t\t}, onProgress, onError );\n\n\t},\n\n\tsetCrossOrigin: function ( value ) {\n\n\t\tthis.crossOrigin = value;\n\n\t},\n\n\tsetTextures: function ( value ) {\n\n\t\tthis.textures = value;\n\n\t},\n\n\tgetTexture: function ( name ) {\n\n\t\tvar textures = this.textures;\n\n\t\tif ( textures[ name ] === undefined ) {\n\n\t\t\tconsole.warn( 'THREE.MaterialLoader: Undefined texture', name );\n\n\t\t}\n\n\t\treturn textures[ name ];\n\n\t},\n\n\tparse: function ( json ) {\n\n\t\tvar material = new THREE[ json.type ];\n\t\tmaterial.uuid = json.uuid;\n\n\t\tif ( json.name !== undefined ) material.name = json.name;\n\t\tif ( json.color !== undefined ) material.color.setHex( json.color );\n\t\tif ( json.emissive !== undefined ) material.emissive.setHex( json.emissive );\n\t\tif ( json.specular !== undefined ) material.specular.setHex( json.specular );\n\t\tif ( json.shininess !== undefined ) material.shininess = json.shininess;\n\t\tif ( json.uniforms !== undefined ) material.uniforms = json.uniforms;\n\t\tif ( json.vertexShader !== undefined ) material.vertexShader = json.vertexShader;\n\t\tif ( json.fragmentShader !== undefined ) material.fragmentShader = json.fragmentShader;\n\t\tif ( json.vertexColors !== undefined ) material.vertexColors = json.vertexColors;\n\t\tif ( json.shading !== undefined ) material.shading = json.shading;\n\t\tif ( json.blending !== undefined ) material.blending = json.blending;\n\t\tif ( json.side !== undefined ) material.side = json.side;\n\t\tif ( json.opacity !== undefined ) material.opacity = json.opacity;\n\t\tif ( json.transparent !== undefined ) material.transparent = json.transparent;\n\t\tif ( json.alphaTest !== undefined ) material.alphaTest = json.alphaTest;\n\t\tif ( json.depthTest !== undefined ) material.depthTest = json.depthTest;\n\t\tif ( json.depthWrite !== undefined ) material.depthWrite = json.depthWrite;\n\t\tif ( json.wireframe !== undefined ) material.wireframe = json.wireframe;\n\t\tif ( json.wireframeLinewidth !== undefined ) material.wireframeLinewidth = json.wireframeLinewidth;\n\n\t\t// for PointsMaterial\n\t\tif ( json.size !== undefined ) material.size = json.size;\n\t\tif ( json.sizeAttenuation !== undefined ) material.sizeAttenuation = json.sizeAttenuation;\n\n\t\t// maps\n\n\t\tif ( json.map !== undefined ) material.map = this.getTexture( json.map );\n\n\t\tif ( json.alphaMap !== undefined ) {\n\n\t\t\tmaterial.alphaMap = this.getTexture( json.alphaMap );\n\t\t\tmaterial.transparent = true;\n\n\t\t}\n\n\t\tif ( json.bumpMap !== undefined ) material.bumpMap = this.getTexture( json.bumpMap );\n\t\tif ( json.bumpScale !== undefined ) material.bumpScale = json.bumpScale;\n\n\t\tif ( json.normalMap !== undefined ) material.normalMap = this.getTexture( json.normalMap );\n\t\tif ( json.normalScale )\tmaterial.normalScale = new THREE.Vector2( json.normalScale, json.normalScale );\n\n\t\tif ( json.displacementMap !== undefined ) material.displacementMap = this.getTexture( json.displacementMap );\n\t\tif ( json.displacementScale !== undefined ) material.displacementScale = json.displacementScale;\n\t\tif ( json.displacementBias !== undefined ) material.displacementBias = json.displacementBias;\n\n\t\tif ( json.specularMap !== undefined ) material.specularMap = this.getTexture( json.specularMap );\n\n\t\tif ( json.envMap !== undefined ) {\n\n\t\t\tmaterial.envMap = this.getTexture( json.envMap );\n\t\t\tmaterial.combine = THREE.MultiplyOperation;\n\n\t\t}\n\n\t\tif ( json.reflectivity ) material.reflectivity = json.reflectivity;\n\n\t\tif ( json.lightMap !== undefined ) material.lightMap = this.getTexture( json.lightMap );\n\t\tif ( json.lightMapIntensity !== undefined ) material.lightMapIntensity = json.lightMapIntensity;\n\n\t\tif ( json.aoMap !== undefined ) material.aoMap = this.getTexture( json.aoMap );\n\t\tif ( json.aoMapIntensity !== undefined ) material.aoMapIntensity = json.aoMapIntensity;\n\n\t\t// MeshFaceMaterial\n\n\t\tif ( json.materials !== undefined ) {\n\n\t\t\tfor ( var i = 0, l = json.materials.length; i < l; i ++ ) {\n\n\t\t\t\tmaterial.materials.push( this.parse( json.materials[ i ] ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn material;\n\n\t}\n\n};\n\n// File:src/loaders/ObjectLoader.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.ObjectLoader = function ( manager ) {\n\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\n\tthis.texturePath = '';\n\n};\n\nTHREE.ObjectLoader.prototype = {\n\n\tconstructor: THREE.ObjectLoader,\n\n\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\tif ( this.texturePath === '' ) {\n\n\t\t\tthis.texturePath = url.substring( 0, url.lastIndexOf( '/' ) + 1 );\n\n\t\t}\n\n\t\tvar scope = this;\n\n\t\tvar loader = new THREE.XHRLoader( scope.manager );\n\t\tloader.setCrossOrigin( this.crossOrigin );\n\t\tloader.load( url, function ( text ) {\n\n\t\t\tscope.parse( JSON.parse( text ), onLoad );\n\n\t\t}, onProgress, onError );\n\n\t},\n\n\tsetTexturePath: function ( value ) {\n\n\t\tthis.texturePath = value;\n\n\t},\n\n\tsetCrossOrigin: function ( value ) {\n\n\t\tthis.crossOrigin = value;\n\n\t},\n\n\tparse: function ( json, onLoad ) {\n\n\t\tvar geometries = this.parseGeometries( json.geometries );\n\n\t\tvar images = this.parseImages( json.images, function () {\n\n\t\t\tif ( onLoad !== undefined ) onLoad( object );\n\n\t\t} );\n\n\t\tvar textures  = this.parseTextures( json.textures, images );\n\t\tvar materials = this.parseMaterials( json.materials, textures );\n\t\tvar object = this.parseObject( json.object, geometries, materials );\n\n\t\tif ( json.images === undefined || json.images.length === 0 ) {\n\n\t\t\tif ( onLoad !== undefined ) onLoad( object );\n\n\t\t}\n\n\t\treturn object;\n\n\t},\n\n\tparseGeometries: function ( json ) {\n\n\t\tvar geometries = {};\n\n\t\tif ( json !== undefined ) {\n\n\t\t\tvar geometryLoader = new THREE.JSONLoader();\n\t\t\tvar bufferGeometryLoader = new THREE.BufferGeometryLoader();\n\n\t\t\tfor ( var i = 0, l = json.length; i < l; i ++ ) {\n\n\t\t\t\tvar geometry;\n\t\t\t\tvar data = json[ i ];\n\n\t\t\t\tswitch ( data.type ) {\n\n\t\t\t\t\tcase 'PlaneGeometry':\n\t\t\t\t\tcase 'PlaneBufferGeometry':\n\n\t\t\t\t\t\tgeometry = new THREE[ data.type ](\n\t\t\t\t\t\t\tdata.width,\n\t\t\t\t\t\t\tdata.height,\n\t\t\t\t\t\t\tdata.widthSegments,\n\t\t\t\t\t\t\tdata.heightSegments\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'BoxGeometry':\n\t\t\t\t\tcase 'CubeGeometry': // backwards compatible\n\n\t\t\t\t\t\tgeometry = new THREE.BoxGeometry(\n\t\t\t\t\t\t\tdata.width,\n\t\t\t\t\t\t\tdata.height,\n\t\t\t\t\t\t\tdata.depth,\n\t\t\t\t\t\t\tdata.widthSegments,\n\t\t\t\t\t\t\tdata.heightSegments,\n\t\t\t\t\t\t\tdata.depthSegments\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'CircleBufferGeometry':\n\n\t\t\t\t\t\tgeometry = new THREE.CircleBufferGeometry(\n\t\t\t\t\t\t\tdata.radius,\n\t\t\t\t\t\t\tdata.segments,\n\t\t\t\t\t\t\tdata.thetaStart,\n\t\t\t\t\t\t\tdata.thetaLength\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'CircleGeometry':\n\n\t\t\t\t\t\tgeometry = new THREE.CircleGeometry(\n\t\t\t\t\t\t\tdata.radius,\n\t\t\t\t\t\t\tdata.segments,\n\t\t\t\t\t\t\tdata.thetaStart,\n\t\t\t\t\t\t\tdata.thetaLength\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'CylinderGeometry':\n\n\t\t\t\t\t\tgeometry = new THREE.CylinderGeometry(\n\t\t\t\t\t\t\tdata.radiusTop,\n\t\t\t\t\t\t\tdata.radiusBottom,\n\t\t\t\t\t\t\tdata.height,\n\t\t\t\t\t\t\tdata.radialSegments,\n\t\t\t\t\t\t\tdata.heightSegments,\n\t\t\t\t\t\t\tdata.openEnded,\n\t\t\t\t\t\t\tdata.thetaStart,\n\t\t\t\t\t\t\tdata.thetaLength\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'SphereGeometry':\n\n\t\t\t\t\t\tgeometry = new THREE.SphereGeometry(\n\t\t\t\t\t\t\tdata.radius,\n\t\t\t\t\t\t\tdata.widthSegments,\n\t\t\t\t\t\t\tdata.heightSegments,\n\t\t\t\t\t\t\tdata.phiStart,\n\t\t\t\t\t\t\tdata.phiLength,\n\t\t\t\t\t\t\tdata.thetaStart,\n\t\t\t\t\t\t\tdata.thetaLength\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'SphereBufferGeometry':\n\n\t\t\t\t\t\tgeometry = new THREE.SphereBufferGeometry(\n\t\t\t\t\t\t\tdata.radius,\n\t\t\t\t\t\t\tdata.widthSegments,\n\t\t\t\t\t\t\tdata.heightSegments,\n\t\t\t\t\t\t\tdata.phiStart,\n\t\t\t\t\t\t\tdata.phiLength,\n\t\t\t\t\t\t\tdata.thetaStart,\n\t\t\t\t\t\t\tdata.thetaLength\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'DodecahedronGeometry':\n\n\t\t\t\t\t\tgeometry = new THREE.DodecahedronGeometry(\n\t\t\t\t\t\t\tdata.radius,\n\t\t\t\t\t\t\tdata.detail\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'IcosahedronGeometry':\n\n\t\t\t\t\t\tgeometry = new THREE.IcosahedronGeometry(\n\t\t\t\t\t\t\tdata.radius,\n\t\t\t\t\t\t\tdata.detail\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'OctahedronGeometry':\n\n\t\t\t\t\t\tgeometry = new THREE.OctahedronGeometry(\n\t\t\t\t\t\t\tdata.radius,\n\t\t\t\t\t\t\tdata.detail\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'TetrahedronGeometry':\n\n\t\t\t\t\t\tgeometry = new THREE.TetrahedronGeometry(\n\t\t\t\t\t\t\tdata.radius,\n\t\t\t\t\t\t\tdata.detail\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'RingGeometry':\n\n\t\t\t\t\t\tgeometry = new THREE.RingGeometry(\n\t\t\t\t\t\t\tdata.innerRadius,\n\t\t\t\t\t\t\tdata.outerRadius,\n\t\t\t\t\t\t\tdata.thetaSegments,\n\t\t\t\t\t\t\tdata.phiSegments,\n\t\t\t\t\t\t\tdata.thetaStart,\n\t\t\t\t\t\t\tdata.thetaLength\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'TorusGeometry':\n\n\t\t\t\t\t\tgeometry = new THREE.TorusGeometry(\n\t\t\t\t\t\t\tdata.radius,\n\t\t\t\t\t\t\tdata.tube,\n\t\t\t\t\t\t\tdata.radialSegments,\n\t\t\t\t\t\t\tdata.tubularSegments,\n\t\t\t\t\t\t\tdata.arc\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'TorusKnotGeometry':\n\n\t\t\t\t\t\tgeometry = new THREE.TorusKnotGeometry(\n\t\t\t\t\t\t\tdata.radius,\n\t\t\t\t\t\t\tdata.tube,\n\t\t\t\t\t\t\tdata.radialSegments,\n\t\t\t\t\t\t\tdata.tubularSegments,\n\t\t\t\t\t\t\tdata.p,\n\t\t\t\t\t\t\tdata.q,\n\t\t\t\t\t\t\tdata.heightScale\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'TextGeometry':\n\n\t\t\t\t\t\tgeometry = new THREE.TextGeometry(\n\t\t\t\t\t\t\tdata.text,\n\t\t\t\t\t\t\tdata.data\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'BufferGeometry':\n\n\t\t\t\t\t\tgeometry = bufferGeometryLoader.parse( data );\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'Geometry':\n\n\t\t\t\t\t\tgeometry = geometryLoader.parse( data.data, this.texturePath ).geometry;\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Unsupported geometry type \"' + data.type + '\"' );\n\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t}\n\n\t\t\t\tgeometry.uuid = data.uuid;\n\n\t\t\t\tif ( data.name !== undefined ) geometry.name = data.name;\n\n\t\t\t\tgeometries[ data.uuid ] = geometry;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn geometries;\n\n\t},\n\n\tparseMaterials: function ( json, textures ) {\n\n\t\tvar materials = {};\n\n\t\tif ( json !== undefined ) {\n\n\t\t\tvar loader = new THREE.MaterialLoader();\n\t\t\tloader.setTextures( textures );\n\n\t\t\tfor ( var i = 0, l = json.length; i < l; i ++ ) {\n\n\t\t\t\tvar material = loader.parse( json[ i ] );\n\t\t\t\tmaterials[ material.uuid ] = material;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn materials;\n\n\t},\n\n\tparseImages: function ( json, onLoad ) {\n\n\t\tvar scope = this;\n\t\tvar images = {};\n\n\t\tfunction loadImage( url ) {\n\n\t\t\tscope.manager.itemStart( url );\n\n\t\t\treturn loader.load( url, function () {\n\n\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t} );\n\n\t\t}\n\n\t\tif ( json !== undefined && json.length > 0 ) {\n\n\t\t\tvar manager = new THREE.LoadingManager( onLoad );\n\n\t\t\tvar loader = new THREE.ImageLoader( manager );\n\t\t\tloader.setCrossOrigin( this.crossOrigin );\n\n\t\t\tfor ( var i = 0, l = json.length; i < l; i ++ ) {\n\n\t\t\t\tvar image = json[ i ];\n\t\t\t\tvar path = /^(\\/\\/)|([a-z]+:(\\/\\/)?)/i.test( image.url ) ? image.url : scope.texturePath + image.url;\n\n\t\t\t\timages[ image.uuid ] = loadImage( path );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn images;\n\n\t},\n\n\tparseTextures: function ( json, images ) {\n\n\t\tfunction parseConstant( value ) {\n\n\t\t\tif ( typeof( value ) === 'number' ) return value;\n\n\t\t\tconsole.warn( 'THREE.ObjectLoader.parseTexture: Constant should be in numeric form.', value );\n\n\t\t\treturn THREE[ value ];\n\n\t\t}\n\n\t\tvar textures = {};\n\n\t\tif ( json !== undefined ) {\n\n\t\t\tfor ( var i = 0, l = json.length; i < l; i ++ ) {\n\n\t\t\t\tvar data = json[ i ];\n\n\t\t\t\tif ( data.image === undefined ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: No \"image\" specified for', data.uuid );\n\n\t\t\t\t}\n\n\t\t\t\tif ( images[ data.image ] === undefined ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined image', data.image );\n\n\t\t\t\t}\n\n\t\t\t\tvar texture = new THREE.Texture( images[ data.image ] );\n\t\t\t\ttexture.needsUpdate = true;\n\n\t\t\t\ttexture.uuid = data.uuid;\n\n\t\t\t\tif ( data.name !== undefined ) texture.name = data.name;\n\t\t\t\tif ( data.mapping !== undefined ) texture.mapping = parseConstant( data.mapping );\n\t\t\t\tif ( data.offset !== undefined ) texture.offset = new THREE.Vector2( data.offset[ 0 ], data.offset[ 1 ] );\n\t\t\t\tif ( data.repeat !== undefined ) texture.repeat = new THREE.Vector2( data.repeat[ 0 ], data.repeat[ 1 ] );\n\t\t\t\tif ( data.minFilter !== undefined ) texture.minFilter = parseConstant( data.minFilter );\n\t\t\t\tif ( data.magFilter !== undefined ) texture.magFilter = parseConstant( data.magFilter );\n\t\t\t\tif ( data.anisotropy !== undefined ) texture.anisotropy = data.anisotropy;\n\t\t\t\tif ( Array.isArray( data.wrap ) ) {\n\n\t\t\t\t\ttexture.wrapS = parseConstant( data.wrap[ 0 ] );\n\t\t\t\t\ttexture.wrapT = parseConstant( data.wrap[ 1 ] );\n\n\t\t\t\t}\n\n\t\t\t\ttextures[ data.uuid ] = texture;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn textures;\n\n\t},\n\n\tparseObject: function () {\n\n\t\tvar matrix = new THREE.Matrix4();\n\n\t\treturn function ( data, geometries, materials ) {\n\n\t\t\tvar object;\n\n\t\t\tvar getGeometry = function ( name ) {\n\n\t\t\t\tif ( geometries[ name ] === undefined ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined geometry', name );\n\n\t\t\t\t}\n\n\t\t\t\treturn geometries[ name ];\n\n\t\t\t};\n\n\t\t\tvar getMaterial = function ( name ) {\n\n\t\t\t\tif ( materials[ name ] === undefined ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined material', name );\n\n\t\t\t\t}\n\n\t\t\t\treturn materials[ name ];\n\n\t\t\t};\n\n\t\t\tswitch ( data.type ) {\n\n\t\t\t\tcase 'Scene':\n\n\t\t\t\t\tobject = new THREE.Scene();\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'PerspectiveCamera':\n\n\t\t\t\t\tobject = new THREE.PerspectiveCamera( data.fov, data.aspect, data.near, data.far );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'OrthographicCamera':\n\n\t\t\t\t\tobject = new THREE.OrthographicCamera( data.left, data.right, data.top, data.bottom, data.near, data.far );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'AmbientLight':\n\n\t\t\t\t\tobject = new THREE.AmbientLight( data.color );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'DirectionalLight':\n\n\t\t\t\t\tobject = new THREE.DirectionalLight( data.color, data.intensity );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'PointLight':\n\n\t\t\t\t\tobject = new THREE.PointLight( data.color, data.intensity, data.distance, data.decay );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'SpotLight':\n\n\t\t\t\t\tobject = new THREE.SpotLight( data.color, data.intensity, data.distance, data.angle, data.exponent, data.decay );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'HemisphereLight':\n\n\t\t\t\t\tobject = new THREE.HemisphereLight( data.color, data.groundColor, data.intensity );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'Mesh':\n\n\t\t\t\t\tobject = new THREE.Mesh( getGeometry( data.geometry ), getMaterial( data.material ) );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'LOD':\n\n\t\t\t\t\tobject = new THREE.LOD();\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'Line':\n\n\t\t\t\t\tobject = new THREE.Line( getGeometry( data.geometry ), getMaterial( data.material ), data.mode );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'PointCloud':\n\t\t\t\tcase 'Points':\n\n\t\t\t\t\tobject = new THREE.Points( getGeometry( data.geometry ), getMaterial( data.material ) );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'Sprite':\n\n\t\t\t\t\tobject = new THREE.Sprite( getMaterial( data.material ) );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'Group':\n\n\t\t\t\t\tobject = new THREE.Group();\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tobject = new THREE.Object3D();\n\n\t\t\t}\n\n\t\t\tobject.uuid = data.uuid;\n\n\t\t\tif ( data.name !== undefined ) object.name = data.name;\n\t\t\tif ( data.matrix !== undefined ) {\n\n\t\t\t\tmatrix.fromArray( data.matrix );\n\t\t\t\tmatrix.decompose( object.position, object.quaternion, object.scale );\n\n\t\t\t} else {\n\n\t\t\t\tif ( data.position !== undefined ) object.position.fromArray( data.position );\n\t\t\t\tif ( data.rotation !== undefined ) object.rotation.fromArray( data.rotation );\n\t\t\t\tif ( data.scale !== undefined ) object.scale.fromArray( data.scale );\n\n\t\t\t}\n\n\t\t\tif ( data.castShadow !== undefined ) object.castShadow = data.castShadow;\n\t\t\tif ( data.receiveShadow !== undefined ) object.receiveShadow = data.receiveShadow;\n\n\t\t\tif ( data.visible !== undefined ) object.visible = data.visible;\n\t\t\tif ( data.userData !== undefined ) object.userData = data.userData;\n\n\t\t\tif ( data.children !== undefined ) {\n\n\t\t\t\tfor ( var child in data.children ) {\n\n\t\t\t\t\tobject.add( this.parseObject( data.children[ child ], geometries, materials ) );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( data.type === 'LOD' ) {\n\n\t\t\t\tvar levels = data.levels;\n\n\t\t\t\tfor ( var l = 0; l < levels.length; l ++ ) {\n\n\t\t\t\t\tvar level = levels[ l ];\n\t\t\t\t\tvar child = object.getObjectByProperty( 'uuid', level.object );\n\n\t\t\t\t\tif ( child !== undefined ) {\n\n\t\t\t\t\t\tobject.addLevel( child, level.distance );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn object;\n\n\t\t}\n\n\t}()\n\n};\n\n// File:src/loaders/TextureLoader.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.TextureLoader = function ( manager ) {\n\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\n\n};\n\nTHREE.TextureLoader.prototype = {\n\n\tconstructor: THREE.TextureLoader,\n\n\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\tvar scope = this;\n\n\t\tvar loader = new THREE.ImageLoader( scope.manager );\n\t\tloader.setCrossOrigin( this.crossOrigin );\n\t\tloader.load( url, function ( image ) {\n\n\t\t\tvar texture = new THREE.Texture( image );\n\t\t\ttexture.needsUpdate = true;\n\n\t\t\tif ( onLoad !== undefined ) {\n\n\t\t\t\tonLoad( texture );\n\n\t\t\t}\n\n\t\t}, onProgress, onError );\n\n\t},\n\n\tsetCrossOrigin: function ( value ) {\n\n\t\tthis.crossOrigin = value;\n\n\t}\n\n};\n\n// File:src/loaders/BinaryTextureLoader.js\n\n/**\n * @author Nikos M. / https://github.com/foo123/\n *\n * Abstract Base class to load generic binary textures formats (rgbe, hdr, ...)\n */\n\nTHREE.DataTextureLoader = THREE.BinaryTextureLoader = function ( manager ) {\n\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\n\n\t// override in sub classes\n\tthis._parser = null;\n\n};\n\nTHREE.BinaryTextureLoader.prototype = {\n\n\tconstructor: THREE.BinaryTextureLoader,\n\n\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\tvar scope = this;\n\n\t\tvar texture = new THREE.DataTexture();\n\n\t\tvar loader = new THREE.XHRLoader( this.manager );\n\t\tloader.setCrossOrigin( this.crossOrigin );\n\t\tloader.setResponseType( 'arraybuffer' );\n\n\t\tloader.load( url, function ( buffer ) {\n\n\t\t\tvar texData = scope._parser( buffer );\n\n\t\t\tif ( ! texData ) return;\n\n\t\t\tif ( undefined !== texData.image ) {\n\n\t\t\t\ttexture.image = texData.image;\n\n\t\t\t} else if ( undefined !== texData.data ) {\n\n\t\t\t\ttexture.image.width = texData.width;\n\t\t\t\ttexture.image.height = texData.height;\n\t\t\t\ttexture.image.data = texData.data;\n\n\t\t\t}\n\n\t\t\ttexture.wrapS = undefined !== texData.wrapS ? texData.wrapS : THREE.ClampToEdgeWrapping;\n\t\t\ttexture.wrapT = undefined !== texData.wrapT ? texData.wrapT : THREE.ClampToEdgeWrapping;\n\n\t\t\ttexture.magFilter = undefined !== texData.magFilter ? texData.magFilter : THREE.LinearFilter;\n\t\t\ttexture.minFilter = undefined !== texData.minFilter ? texData.minFilter : THREE.LinearMipMapLinearFilter;\n\n\t\t\ttexture.anisotropy = undefined !== texData.anisotropy ? texData.anisotropy : 1;\n\n\t\t\tif ( undefined !== texData.format ) {\n\n\t\t\t\ttexture.format = texData.format;\n\n\t\t\t}\n\t\t\tif ( undefined !== texData.type ) {\n\n\t\t\t\ttexture.type = texData.type;\n\n\t\t\t}\n\n\t\t\tif ( undefined !== texData.mipmaps ) {\n\n\t\t\t\ttexture.mipmaps = texData.mipmaps;\n\n\t\t\t}\n\n\t\t\tif ( 1 === texData.mipmapCount ) {\n\n\t\t\t\ttexture.minFilter = THREE.LinearFilter;\n\n\t\t\t}\n\n\t\t\ttexture.needsUpdate = true;\n\n\t\t\tif ( onLoad ) onLoad( texture, texData );\n\n\t\t}, onProgress, onError );\n\n\n\t\treturn texture;\n\n\t},\n\n\tsetCrossOrigin: function ( value ) {\n\n\t\tthis.crossOrigin = value;\n\n\t}\n\n};\n\n// File:src/loaders/CompressedTextureLoader.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n *\n * Abstract Base class to block based textures loader (dds, pvr, ...)\n */\n\nTHREE.CompressedTextureLoader = function ( manager ) {\n\n\tthis.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\n\n\t// override in sub classes\n\tthis._parser = null;\n\n};\n\n\nTHREE.CompressedTextureLoader.prototype = {\n\n\tconstructor: THREE.CompressedTextureLoader,\n\n\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\tvar scope = this;\n\n\t\tvar images = [];\n\n\t\tvar texture = new THREE.CompressedTexture();\n\t\ttexture.image = images;\n\n\t\tvar loader = new THREE.XHRLoader( this.manager );\n\t\tloader.setCrossOrigin( this.crossOrigin );\n\t\tloader.setResponseType( 'arraybuffer' );\n\n\t\tif ( Array.isArray( url ) ) {\n\n\t\t\tvar loaded = 0;\n\n\t\t\tvar loadTexture = function ( i ) {\n\n\t\t\t\tloader.load( url[ i ], function ( buffer ) {\n\n\t\t\t\t\tvar texDatas = scope._parser( buffer, true );\n\n\t\t\t\t\timages[ i ] = {\n\t\t\t\t\t\twidth: texDatas.width,\n\t\t\t\t\t\theight: texDatas.height,\n\t\t\t\t\t\tformat: texDatas.format,\n\t\t\t\t\t\tmipmaps: texDatas.mipmaps\n\t\t\t\t\t};\n\n\t\t\t\t\tloaded += 1;\n\n\t\t\t\t\tif ( loaded === 6 ) {\n\n\t\t\t\t\t\tif ( texDatas.mipmapCount === 1 )\n \t\t\t\t\t\t\ttexture.minFilter = THREE.LinearFilter;\n\n\t\t\t\t\t\ttexture.format = texDatas.format;\n\t\t\t\t\t\ttexture.needsUpdate = true;\n\n\t\t\t\t\t\tif ( onLoad ) onLoad( texture );\n\n\t\t\t\t\t}\n\n\t\t\t\t}, onProgress, onError );\n\n\t\t\t};\n\n\t\t\tfor ( var i = 0, il = url.length; i < il; ++ i ) {\n\n\t\t\t\tloadTexture( i );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t// compressed cubemap texture stored in a single DDS file\n\n\t\t\tloader.load( url, function ( buffer ) {\n\n\t\t\t\tvar texDatas = scope._parser( buffer, true );\n\n\t\t\t\tif ( texDatas.isCubemap ) {\n\n\t\t\t\t\tvar faces = texDatas.mipmaps.length / texDatas.mipmapCount;\n\n\t\t\t\t\tfor ( var f = 0; f < faces; f ++ ) {\n\n\t\t\t\t\t\timages[ f ] = { mipmaps : [] };\n\n\t\t\t\t\t\tfor ( var i = 0; i < texDatas.mipmapCount; i ++ ) {\n\n\t\t\t\t\t\t\timages[ f ].mipmaps.push( texDatas.mipmaps[ f * texDatas.mipmapCount + i ] );\n\t\t\t\t\t\t\timages[ f ].format = texDatas.format;\n\t\t\t\t\t\t\timages[ f ].width = texDatas.width;\n\t\t\t\t\t\t\timages[ f ].height = texDatas.height;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\ttexture.image.width = texDatas.width;\n\t\t\t\t\ttexture.image.height = texDatas.height;\n\t\t\t\t\ttexture.mipmaps = texDatas.mipmaps;\n\n\t\t\t\t}\n\n\t\t\t\tif ( texDatas.mipmapCount === 1 ) {\n\n\t\t\t\t\ttexture.minFilter = THREE.LinearFilter;\n\n\t\t\t\t}\n\n\t\t\t\ttexture.format = texDatas.format;\n\t\t\t\ttexture.needsUpdate = true;\n\n\t\t\t\tif ( onLoad ) onLoad( texture );\n\n\t\t\t}, onProgress, onError );\n\n\t\t}\n\n\t\treturn texture;\n\n\t},\n\n\tsetCrossOrigin: function ( value ) {\n\n\t\tthis.crossOrigin = value;\n\n\t}\n\n};\n\n// File:src/materials/Material.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n * @author alteredq / http://alteredqualia.com/\n */\n\nTHREE.Material = function () {\n\n\tObject.defineProperty( this, 'id', { value: THREE.MaterialIdCount ++ } );\n\n\tthis.uuid = THREE.Math.generateUUID();\n\n\tthis.name = '';\n\tthis.type = 'Material';\n\n\tthis.side = THREE.FrontSide;\n\n\tthis.opacity = 1;\n\tthis.transparent = false;\n\n\tthis.blending = THREE.NormalBlending;\n\n\tthis.blendSrc = THREE.SrcAlphaFactor;\n\tthis.blendDst = THREE.OneMinusSrcAlphaFactor;\n\tthis.blendEquation = THREE.AddEquation;\n\tthis.blendSrcAlpha = null;\n\tthis.blendDstAlpha = null;\n\tthis.blendEquationAlpha = null;\n\n\tthis.depthFunc = THREE.LessEqualDepth;\n\tthis.depthTest = true;\n\tthis.depthWrite = true;\n\n\tthis.colorWrite = true;\n\n\tthis.precision = null; // override the renderer's default precision for this material\n\n\tthis.polygonOffset = false;\n\tthis.polygonOffsetFactor = 0;\n\tthis.polygonOffsetUnits = 0;\n\n\tthis.alphaTest = 0;\n\n\tthis.overdraw = 0; // Overdrawn pixels (typically between 0 and 1) for fixing antialiasing gaps in CanvasRenderer\n\n\tthis.visible = true;\n\n\tthis._needsUpdate = true;\n\n};\n\nTHREE.Material.prototype = {\n\n\tconstructor: THREE.Material,\n\n\tget needsUpdate () {\n\n\t\treturn this._needsUpdate;\n\n\t},\n\n\tset needsUpdate ( value ) {\n\n\t\tif ( value === true ) this.update();\n\n\t\tthis._needsUpdate = value;\n\n\t},\n\n\tsetValues: function ( values ) {\n\n\t\tif ( values === undefined ) return;\n\n\t\tfor ( var key in values ) {\n\n\t\t\tvar newValue = values[ key ];\n\n\t\t\tif ( newValue === undefined ) {\n\n\t\t\t\tconsole.warn( \"THREE.Material: '\" + key + \"' parameter is undefined.\" );\n\t\t\t\tcontinue;\n\n\t\t\t}\n\n\t\t\tvar currentValue = this[ key ];\n\n\t\t\tif ( currentValue === undefined ) {\n\n\t\t\t\tconsole.warn( \"THREE.\" + this.type + \": '\" + key + \"' is not a property of this material.\" );\n\t\t\t\tcontinue;\n\n\t\t\t}\n\n\t\t\tif ( currentValue instanceof THREE.Color ) {\n\n\t\t\t\tcurrentValue.set( newValue );\n\n\t\t\t} else if ( currentValue instanceof THREE.Vector3 && newValue instanceof THREE.Vector3 ) {\n\n\t\t\t\tcurrentValue.copy( newValue );\n\n\t\t\t} else if ( key === 'overdraw' ) {\n\n\t\t\t\t// ensure overdraw is backwards-compatible with legacy boolean type\n\t\t\t\tthis[ key ] = Number( newValue );\n\n\t\t\t} else {\n\n\t\t\t\tthis[ key ] = newValue;\n\n\t\t\t}\n\n\t\t}\n\n\t},\n\n\ttoJSON: function ( meta ) {\n\n\t\tvar data = {\n\t\t\tmetadata: {\n\t\t\t\tversion: 4.4,\n\t\t\t\ttype: 'Material',\n\t\t\t\tgenerator: 'Material.toJSON'\n\t\t\t}\n\t\t};\n\n\t\t// standard Material serialization\n\t\tdata.uuid = this.uuid;\n\t\tdata.type = this.type;\n\t\tif ( this.name !== '' ) data.name = this.name;\n\n\t\tif ( this.color instanceof THREE.Color ) data.color = this.color.getHex();\n\t\tif ( this.emissive instanceof THREE.Color ) data.emissive = this.emissive.getHex();\n\t\tif ( this.specular instanceof THREE.Color ) data.specular = this.specular.getHex();\n\t\tif ( this.shininess !== undefined ) data.shininess = this.shininess;\n\n\t\tif ( this.map instanceof THREE.Texture ) data.map = this.map.toJSON( meta ).uuid;\n\t\tif ( this.alphaMap instanceof THREE.Texture ) data.alphaMap = this.alphaMap.toJSON( meta ).uuid;\n\t\tif ( this.lightMap instanceof THREE.Texture ) data.lightMap = this.lightMap.toJSON( meta ).uuid;\n\t\tif ( this.bumpMap instanceof THREE.Texture ) {\n\n\t\t\tdata.bumpMap = this.bumpMap.toJSON( meta ).uuid;\n\t\t\tdata.bumpScale = this.bumpScale;\n\n\t\t}\n\t\tif ( this.normalMap instanceof THREE.Texture ) {\n\n\t\t\tdata.normalMap = this.normalMap.toJSON( meta ).uuid;\n\t\t\tdata.normalScale = this.normalScale; // Removed for now, causes issue in editor ui.js\n\n\t\t}\n\t\tif ( this.displacementMap instanceof THREE.Texture ) {\n\n\t\t\tdata.displacementMap = this.displacementMap.toJSON( meta ).uuid;\n\t\t\tdata.displacementScale = this.displacementScale;\n\t\t\tdata.displacementBias = this.displacementBias;\n\n\t\t}\n\t\tif ( this.specularMap instanceof THREE.Texture ) data.specularMap = this.specularMap.toJSON( meta ).uuid;\n\t\tif ( this.envMap instanceof THREE.Texture ) {\n\n\t\t\tdata.envMap = this.envMap.toJSON( meta ).uuid;\n\t\t\tdata.reflectivity = this.reflectivity; // Scale behind envMap\n\n\t\t}\n\n\t\tif ( this.size !== undefined ) data.size = this.size;\n\t\tif ( this.sizeAttenuation !== undefined ) data.sizeAttenuation = this.sizeAttenuation;\n\n\t\tif ( this.vertexColors !== undefined && this.vertexColors !== THREE.NoColors ) data.vertexColors = this.vertexColors;\n\t\tif ( this.shading !== undefined && this.shading !== THREE.SmoothShading ) data.shading = this.shading;\n\t\tif ( this.blending !== undefined && this.blending !== THREE.NormalBlending ) data.blending = this.blending;\n\t\tif ( this.side !== undefined && this.side !== THREE.FrontSide ) data.side = this.side;\n\n\t\tif ( this.opacity < 1 ) data.opacity = this.opacity;\n\t\tif ( this.transparent === true ) data.transparent = this.transparent;\n\t\tif ( this.alphaTest > 0 ) data.alphaTest = this.alphaTest;\n\t\tif ( this.wireframe === true ) data.wireframe = this.wireframe;\n\t\tif ( this.wireframeLinewidth > 1 ) data.wireframeLinewidth = this.wireframeLinewidth;\n\n\t\treturn data;\n\n\t},\n\n\tclone: function () {\n\n\t\treturn new this.constructor().copy( this );\n\n\t},\n\n\tcopy: function ( source ) {\n\n\t\tthis.name = source.name;\n\n\t\tthis.side = source.side;\n\n\t\tthis.opacity = source.opacity;\n\t\tthis.transparent = source.transparent;\n\n\t\tthis.blending = source.blending;\n\n\t\tthis.blendSrc = source.blendSrc;\n\t\tthis.blendDst = source.blendDst;\n\t\tthis.blendEquation = source.blendEquation;\n\t\tthis.blendSrcAlpha = source.blendSrcAlpha;\n\t\tthis.blendDstAlpha = source.blendDstAlpha;\n\t\tthis.blendEquationAlpha = source.blendEquationAlpha;\n\n\t\tthis.depthFunc = source.depthFunc;\n\t\tthis.depthTest = source.depthTest;\n\t\tthis.depthWrite = source.depthWrite;\n\n\t\tthis.precision = source.precision;\n\n\t\tthis.polygonOffset = source.polygonOffset;\n\t\tthis.polygonOffsetFactor = source.polygonOffsetFactor;\n\t\tthis.polygonOffsetUnits = source.polygonOffsetUnits;\n\n\t\tthis.alphaTest = source.alphaTest;\n\n\t\tthis.overdraw = source.overdraw;\n\n\t\tthis.visible = source.visible;\n\n\t\treturn this;\n\n\t},\n\n\tupdate: function () {\n\n\t\tthis.dispatchEvent( { type: 'update' } );\n\n\t},\n\n\tdispose: function () {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t},\n\n\t// Deprecated\n\n\tget wrapAround () {\n\n\t\tconsole.warn( 'THREE.' + this.type + ': .wrapAround has been removed.' );\n\n\t},\n\n\tset wrapAround ( boolean ) {\n\n\t\tconsole.warn( 'THREE.' + this.type + ': .wrapAround has been removed.' );\n\n\t},\n\n\tget wrapRGB () {\n\n\t\tconsole.warn( 'THREE.' + this.type + ': .wrapRGB has been removed.' );\n\t\treturn new THREE.Color();\n\n\t}\n\n};\n\nTHREE.EventDispatcher.prototype.apply( THREE.Material.prototype );\n\nTHREE.MaterialIdCount = 0;\n\n// File:src/materials/LineBasicMaterial.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n * @author alteredq / http://alteredqualia.com/\n *\n * parameters = {\n *  color: <hex>,\n *  opacity: <float>,\n *\n *  blending: THREE.NormalBlending,\n *  depthTest: <bool>,\n *  depthWrite: <bool>,\n *\n *  linewidth: <float>,\n *  linecap: \"round\",\n *  linejoin: \"round\",\n *\n *  vertexColors: <bool>\n *\n *  fog: <bool>\n * }\n */\n\nTHREE.LineBasicMaterial = function ( parameters ) {\n\n\tTHREE.Material.call( this );\n\n\tthis.type = 'LineBasicMaterial';\n\n\tthis.color = new THREE.Color( 0xffffff );\n\n\tthis.linewidth = 1;\n\tthis.linecap = 'round';\n\tthis.linejoin = 'round';\n\n\tthis.vertexColors = THREE.NoColors;\n\n\tthis.fog = true;\n\n\tthis.setValues( parameters );\n\n};\n\nTHREE.LineBasicMaterial.prototype = Object.create( THREE.Material.prototype );\nTHREE.LineBasicMaterial.prototype.constructor = THREE.LineBasicMaterial;\n\nTHREE.LineBasicMaterial.prototype.copy = function ( source ) {\n\n\tTHREE.Material.prototype.copy.call( this, source );\n\n\tthis.color.copy( source.color );\n\n\tthis.linewidth = source.linewidth;\n\tthis.linecap = source.linecap;\n\tthis.linejoin = source.linejoin;\n\n\tthis.vertexColors = source.vertexColors;\n\n\tthis.fog = source.fog;\n\n\treturn this;\n\n};\n\n// File:src/materials/LineDashedMaterial.js\n\n/**\n * @author alteredq / http://alteredqualia.com/\n *\n * parameters = {\n *  color: <hex>,\n *  opacity: <float>,\n *\n *  blending: THREE.NormalBlending,\n *  depthTest: <bool>,\n *  depthWrite: <bool>,\n *\n *  linewidth: <float>,\n *\n *  scale: <float>,\n *  dashSize: <float>,\n *  gapSize: <float>,\n *\n *  vertexColors: <bool>\n *\n *  fog: <bool>\n * }\n */\n\nTHREE.LineDashedMaterial = function ( parameters ) {\n\n\tTHREE.Material.call( this );\n\n\tthis.type = 'LineDashedMaterial';\n\n\tthis.color = new THREE.Color( 0xffffff );\n\n\tthis.linewidth = 1;\n\n\tthis.scale = 1;\n\tthis.dashSize = 3;\n\tthis.gapSize = 1;\n\n\tthis.vertexColors = false;\n\n\tthis.fog = true;\n\n\tthis.setValues( parameters );\n\n};\n\nTHREE.LineDashedMaterial.prototype = Object.create( THREE.Material.prototype );\nTHREE.LineDashedMaterial.prototype.constructor = THREE.LineDashedMaterial;\n\nTHREE.LineDashedMaterial.prototype.copy = function ( source ) {\n\n\tTHREE.Material.prototype.copy.call( this, source );\n\n\tthis.color.copy( source.color );\n\t\n\tthis.linewidth = source.linewidth;\n\n\tthis.scale = source.scale;\n\tthis.dashSize = source.dashSize;\n\tthis.gapSize = source.gapSize;\n\n\tthis.vertexColors = source.vertexColors;\n\n\tthis.fog = source.fog;\n\n\treturn this;\n\n};\n\n// File:src/materials/MeshBasicMaterial.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n * @author alteredq / http://alteredqualia.com/\n *\n * parameters = {\n *  color: <hex>,\n *  opacity: <float>,\n *  map: new THREE.Texture( <Image> ),\n *\n *  aoMap: new THREE.Texture( <Image> ),\n *  aoMapIntensity: <float>\n *\n *  specularMap: new THREE.Texture( <Image> ),\n *\n *  alphaMap: new THREE.Texture( <Image> ),\n *\n *  envMap: new THREE.TextureCube( [posx, negx, posy, negy, posz, negz] ),\n *  combine: THREE.Multiply,\n *  reflectivity: <float>,\n *  refractionRatio: <float>,\n *\n *  shading: THREE.SmoothShading,\n *  blending: THREE.NormalBlending,\n *  depthTest: <bool>,\n *  depthWrite: <bool>,\n *\n *  wireframe: <boolean>,\n *  wireframeLinewidth: <float>,\n *\n *  vertexColors: THREE.NoColors / THREE.VertexColors / THREE.FaceColors,\n *\n *  skinning: <bool>,\n *  morphTargets: <bool>,\n *\n *  fog: <bool>\n * }\n */\n\nTHREE.MeshBasicMaterial = function ( parameters ) {\n\n\tTHREE.Material.call( this );\n\n\tthis.type = 'MeshBasicMaterial';\n\n\tthis.color = new THREE.Color( 0xffffff ); // emissive\n\n\tthis.map = null;\n\n\tthis.aoMap = null;\n\tthis.aoMapIntensity = 1.0;\n\n\tthis.specularMap = null;\n\n\tthis.alphaMap = null;\n\n\tthis.envMap = null;\n\tthis.combine = THREE.MultiplyOperation;\n\tthis.reflectivity = 1;\n\tthis.refractionRatio = 0.98;\n\n\tthis.fog = true;\n\n\tthis.shading = THREE.SmoothShading;\n\n\tthis.wireframe = false;\n\tthis.wireframeLinewidth = 1;\n\tthis.wireframeLinecap = 'round';\n\tthis.wireframeLinejoin = 'round';\n\n\tthis.vertexColors = THREE.NoColors;\n\n\tthis.skinning = false;\n\tthis.morphTargets = false;\n\n\tthis.setValues( parameters );\n\n};\n\nTHREE.MeshBasicMaterial.prototype = Object.create( THREE.Material.prototype );\nTHREE.MeshBasicMaterial.prototype.constructor = THREE.MeshBasicMaterial;\n\nTHREE.MeshBasicMaterial.prototype.copy = function ( source ) {\n\t\n\tTHREE.Material.prototype.copy.call( this, source );\n\n\tthis.color.copy( source.color );\n\n\tthis.map = source.map;\n\n\tthis.aoMap = source.aoMap;\n\tthis.aoMapIntensity = source.aoMapIntensity;\n\n\tthis.specularMap = source.specularMap;\n\n\tthis.alphaMap = source.alphaMap;\n\n\tthis.envMap = source.envMap;\n\tthis.combine = source.combine;\n\tthis.reflectivity = source.reflectivity;\n\tthis.refractionRatio = source.refractionRatio;\n\n\tthis.fog = source.fog;\n\n\tthis.shading = source.shading;\n\n\tthis.wireframe = source.wireframe;\n\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\tthis.wireframeLinecap = source.wireframeLinecap;\n\tthis.wireframeLinejoin = source.wireframeLinejoin;\n\n\tthis.vertexColors = source.vertexColors;\n\n\tthis.skinning = source.skinning;\n\tthis.morphTargets = source.morphTargets;\n\t\n\treturn this;\n\n};\n\n// File:src/materials/MeshLambertMaterial.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n * @author alteredq / http://alteredqualia.com/\n *\n * parameters = {\n *  color: <hex>,\n *  emissive: <hex>,\n *  opacity: <float>,\n *\n *  map: new THREE.Texture( <Image> ),\n *\n *  specularMap: new THREE.Texture( <Image> ),\n *\n *  alphaMap: new THREE.Texture( <Image> ),\n *\n *  envMap: new THREE.TextureCube( [posx, negx, posy, negy, posz, negz] ),\n *  combine: THREE.Multiply,\n *  reflectivity: <float>,\n *  refractionRatio: <float>,\n *\n *  blending: THREE.NormalBlending,\n *  depthTest: <bool>,\n *  depthWrite: <bool>,\n *\n *  wireframe: <boolean>,\n *  wireframeLinewidth: <float>,\n *\n *  vertexColors: THREE.NoColors / THREE.VertexColors / THREE.FaceColors,\n *\n *  skinning: <bool>,\n *  morphTargets: <bool>,\n *  morphNormals: <bool>,\n *\n *\tfog: <bool>\n * }\n */\n\nTHREE.MeshLambertMaterial = function ( parameters ) {\n\n\tTHREE.Material.call( this );\n\n\tthis.type = 'MeshLambertMaterial';\n\n\tthis.color = new THREE.Color( 0xffffff ); // diffuse\n\tthis.emissive = new THREE.Color( 0x000000 );\n\n\tthis.map = null;\n\n\tthis.specularMap = null;\n\n\tthis.alphaMap = null;\n\n\tthis.envMap = null;\n\tthis.combine = THREE.MultiplyOperation;\n\tthis.reflectivity = 1;\n\tthis.refractionRatio = 0.98;\n\n\tthis.fog = true;\n\n\tthis.wireframe = false;\n\tthis.wireframeLinewidth = 1;\n\tthis.wireframeLinecap = 'round';\n\tthis.wireframeLinejoin = 'round';\n\n\tthis.vertexColors = THREE.NoColors;\n\n\tthis.skinning = false;\n\tthis.morphTargets = false;\n\tthis.morphNormals = false;\n\n\tthis.setValues( parameters );\n\n};\n\nTHREE.MeshLambertMaterial.prototype = Object.create( THREE.Material.prototype );\nTHREE.MeshLambertMaterial.prototype.constructor = THREE.MeshLambertMaterial;\n\nTHREE.MeshLambertMaterial.prototype.copy = function ( source ) {\n\n\tTHREE.Material.prototype.copy.call( this, source );\n\n\tthis.color.copy( source.color );\n\tthis.emissive.copy( source.emissive );\n\n\tthis.map = source.map;\n\n\tthis.specularMap = source.specularMap;\n\n\tthis.alphaMap = source.alphaMap;\n\n\tthis.envMap = source.envMap;\n\tthis.combine = source.combine;\n\tthis.reflectivity = source.reflectivity;\n\tthis.refractionRatio = source.refractionRatio;\n\n\tthis.fog = source.fog;\n\n\tthis.wireframe = source.wireframe;\n\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\tthis.wireframeLinecap = source.wireframeLinecap;\n\tthis.wireframeLinejoin = source.wireframeLinejoin;\n\n\tthis.vertexColors = source.vertexColors;\n\n\tthis.skinning = source.skinning;\n\tthis.morphTargets = source.morphTargets;\n\tthis.morphNormals = source.morphNormals;\n\n\treturn this;\n\n};\n\n// File:src/materials/MeshPhongMaterial.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n * @author alteredq / http://alteredqualia.com/\n *\n * parameters = {\n *  color: <hex>,\n *  emissive: <hex>,\n *  specular: <hex>,\n *  shininess: <float>,\n *  opacity: <float>,\n *\n *  map: new THREE.Texture( <Image> ),\n *\n *  lightMap: new THREE.Texture( <Image> ),\n *  lightMapIntensity: <float>\n *\n *  aoMap: new THREE.Texture( <Image> ),\n *  aoMapIntensity: <float>\n *\n *  emissiveMap: new THREE.Texture( <Image> ),\n *\n *  bumpMap: new THREE.Texture( <Image> ),\n *  bumpScale: <float>,\n *\n *  normalMap: new THREE.Texture( <Image> ),\n *  normalScale: <Vector2>,\n *\n *  displacementMap: new THREE.Texture( <Image> ),\n *  displacementScale: <float>,\n *  displacementBias: <float>,\n *\n *  specularMap: new THREE.Texture( <Image> ),\n *\n *  alphaMap: new THREE.Texture( <Image> ),\n *\n *  envMap: new THREE.TextureCube( [posx, negx, posy, negy, posz, negz] ),\n *  combine: THREE.Multiply,\n *  reflectivity: <float>,\n *  refractionRatio: <float>,\n *\n *  shading: THREE.SmoothShading,\n *  blending: THREE.NormalBlending,\n *  depthTest: <bool>,\n *  depthWrite: <bool>,\n *\n *  wireframe: <boolean>,\n *  wireframeLinewidth: <float>,\n *\n *  vertexColors: THREE.NoColors / THREE.VertexColors / THREE.FaceColors,\n *\n *  skinning: <bool>,\n *  morphTargets: <bool>,\n *  morphNormals: <bool>,\n *\n *\tfog: <bool>\n * }\n */\n\nTHREE.MeshPhongMaterial = function ( parameters ) {\n\n\tTHREE.Material.call( this );\n\n\tthis.type = 'MeshPhongMaterial';\n\n\tthis.color = new THREE.Color( 0xffffff ); // diffuse\n\tthis.emissive = new THREE.Color( 0x000000 );\n\tthis.specular = new THREE.Color( 0x111111 );\n\tthis.shininess = 30;\n\n\tthis.metal = false;\n\n\tthis.map = null;\n\n\tthis.lightMap = null;\n\tthis.lightMapIntensity = 1.0;\n\n\tthis.aoMap = null;\n\tthis.aoMapIntensity = 1.0;\n\n\tthis.emissiveMap = null;\n\n\tthis.bumpMap = null;\n\tthis.bumpScale = 1;\n\n\tthis.normalMap = null;\n\tthis.normalScale = new THREE.Vector2( 1, 1 );\n\n\tthis.displacementMap = null;\n\tthis.displacementScale = 1;\n\tthis.displacementBias = 0;\n\n\tthis.specularMap = null;\n\n\tthis.alphaMap = null;\n\n\tthis.envMap = null;\n\tthis.combine = THREE.MultiplyOperation;\n\tthis.reflectivity = 1;\n\tthis.refractionRatio = 0.98;\n\n\tthis.fog = true;\n\n\tthis.shading = THREE.SmoothShading;\n\n\tthis.wireframe = false;\n\tthis.wireframeLinewidth = 1;\n\tthis.wireframeLinecap = 'round';\n\tthis.wireframeLinejoin = 'round';\n\n\tthis.vertexColors = THREE.NoColors;\n\n\tthis.skinning = false;\n\tthis.morphTargets = false;\n\tthis.morphNormals = false;\n\n\tthis.setValues( parameters );\n\n};\n\nTHREE.MeshPhongMaterial.prototype = Object.create( THREE.Material.prototype );\nTHREE.MeshPhongMaterial.prototype.constructor = THREE.MeshPhongMaterial;\n\nTHREE.MeshPhongMaterial.prototype.copy = function ( source ) {\n\n\tTHREE.Material.prototype.copy.call( this, source );\n\n\tthis.color.copy( source.color );\n\tthis.emissive.copy( source.emissive );\n\tthis.specular.copy( source.specular );\n\tthis.shininess = source.shininess;\n\n\tthis.metal = source.metal;\n\n\tthis.map = source.map;\n\n\tthis.lightMap = source.lightMap;\n\tthis.lightMapIntensity = source.lightMapIntensity;\n\n\tthis.aoMap = source.aoMap;\n\tthis.aoMapIntensity = source.aoMapIntensity;\n\n\tthis.emissiveMap = source.emissiveMap;\n\n\tthis.bumpMap = source.bumpMap;\n\tthis.bumpScale = source.bumpScale;\n\n\tthis.normalMap = source.normalMap;\n\tthis.normalScale.copy( source.normalScale );\n\n\tthis.displacementMap = source.displacementMap;\n\tthis.displacementScale = source.displacementScale;\n\tthis.displacementBias = source.displacementBias;\n\n\tthis.specularMap = source.specularMap;\n\n\tthis.alphaMap = source.alphaMap;\n\n\tthis.envMap = source.envMap;\n\tthis.combine = source.combine;\n\tthis.reflectivity = source.reflectivity;\n\tthis.refractionRatio = source.refractionRatio;\n\n\tthis.fog = source.fog;\n\n\tthis.shading = source.shading;\n\n\tthis.wireframe = source.wireframe;\n\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\tthis.wireframeLinecap = source.wireframeLinecap;\n\tthis.wireframeLinejoin = source.wireframeLinejoin;\n\n\tthis.vertexColors = source.vertexColors;\n\n\tthis.skinning = source.skinning;\n\tthis.morphTargets = source.morphTargets;\n\tthis.morphNormals = source.morphNormals;\n\n\treturn this;\n\n};\n\n// File:src/materials/MeshDepthMaterial.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n * @author alteredq / http://alteredqualia.com/\n *\n * parameters = {\n *  opacity: <float>,\n *\n *  blending: THREE.NormalBlending,\n *  depthTest: <bool>,\n *  depthWrite: <bool>,\n *\n *  wireframe: <boolean>,\n *  wireframeLinewidth: <float>\n * }\n */\n\nTHREE.MeshDepthMaterial = function ( parameters ) {\n\n\tTHREE.Material.call( this );\n\n\tthis.type = 'MeshDepthMaterial';\n\n\tthis.morphTargets = false;\n\tthis.wireframe = false;\n\tthis.wireframeLinewidth = 1;\n\n\tthis.setValues( parameters );\n\n};\n\nTHREE.MeshDepthMaterial.prototype = Object.create( THREE.Material.prototype );\nTHREE.MeshDepthMaterial.prototype.constructor = THREE.MeshDepthMaterial;\n\nTHREE.MeshDepthMaterial.prototype.copy = function ( source ) {\n\n\tTHREE.Material.prototype.copy.call( this, source );\n\n\tthis.wireframe = source.wireframe;\n\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\n\treturn this;\n\n};\n\n// File:src/materials/MeshNormalMaterial.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n *\n * parameters = {\n *  opacity: <float>,\n *\n *  shading: THREE.FlatShading,\n *  blending: THREE.NormalBlending,\n *  depthTest: <bool>,\n *  depthWrite: <bool>,\n *\n *  wireframe: <boolean>,\n *  wireframeLinewidth: <float>\n * }\n */\n\nTHREE.MeshNormalMaterial = function ( parameters ) {\n\n\tTHREE.Material.call( this, parameters );\n\n\tthis.type = 'MeshNormalMaterial';\n\n\tthis.wireframe = false;\n\tthis.wireframeLinewidth = 1;\n\n\tthis.morphTargets = false;\n\n\tthis.setValues( parameters );\n\n};\n\nTHREE.MeshNormalMaterial.prototype = Object.create( THREE.Material.prototype );\nTHREE.MeshNormalMaterial.prototype.constructor = THREE.MeshNormalMaterial;\n\nTHREE.MeshNormalMaterial.prototype.copy = function ( source ) {\n\n\tTHREE.Material.prototype.copy.call( this, source );\n\n\tthis.wireframe = source.wireframe;\n\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\n\treturn this;\n\n};\n\n// File:src/materials/MultiMaterial.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.MultiMaterial = function ( materials ) {\n\n\tthis.uuid = THREE.Math.generateUUID();\n\n\tthis.type = 'MultiMaterial';\n\n\tthis.materials = materials instanceof Array ? materials : [];\n\n\tthis.visible = true;\n\n};\n\nTHREE.MultiMaterial.prototype = {\n\n\tconstructor: THREE.MultiMaterial,\n\n\ttoJSON: function () {\n\n\t\tvar output = {\n\t\t\tmetadata: {\n\t\t\t\tversion: 4.2,\n\t\t\t\ttype: 'material',\n\t\t\t\tgenerator: 'MaterialExporter'\n\t\t\t},\n\t\t\tuuid: this.uuid,\n\t\t\ttype: this.type,\n\t\t\tmaterials: []\n\t\t};\n\n\t\tfor ( var i = 0, l = this.materials.length; i < l; i ++ ) {\n\n\t\t\toutput.materials.push( this.materials[ i ].toJSON() );\n\n\t\t}\n\n\t\toutput.visible = this.visible;\n\n\t\treturn output;\n\n\t},\n\n\tclone: function () {\n\n\t\tvar material = new this.constructor();\n\n\t\tfor ( var i = 0; i < this.materials.length; i ++ ) {\n\n\t\t\tmaterial.materials.push( this.materials[ i ].clone() );\n\n\t\t}\n\n\t\tmaterial.visible = this.visible;\n\n\t\treturn material;\n\n\t}\n\n};\n\n// backwards compatibility\n\nTHREE.MeshFaceMaterial = THREE.MultiMaterial;\n\n// File:src/materials/PointsMaterial.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n * @author alteredq / http://alteredqualia.com/\n *\n * parameters = {\n *  color: <hex>,\n *  opacity: <float>,\n *  map: new THREE.Texture( <Image> ),\n *\n *  size: <float>,\n *  sizeAttenuation: <bool>,\n *\n *  blending: THREE.NormalBlending,\n *  depthTest: <bool>,\n *  depthWrite: <bool>,\n *\n *  vertexColors: <bool>,\n *\n *  fog: <bool>\n * }\n */\n\nTHREE.PointsMaterial = function ( parameters ) {\n\n\tTHREE.Material.call( this );\n\n\tthis.type = 'PointsMaterial';\n\n\tthis.color = new THREE.Color( 0xffffff );\n\n\tthis.map = null;\n\n\tthis.size = 1;\n\tthis.sizeAttenuation = true;\n\n\tthis.vertexColors = THREE.NoColors;\n\n\tthis.fog = true;\n\n\tthis.setValues( parameters );\n\n};\n\nTHREE.PointsMaterial.prototype = Object.create( THREE.Material.prototype );\nTHREE.PointsMaterial.prototype.constructor = THREE.PointsMaterial;\n\nTHREE.PointsMaterial.prototype.copy = function ( source ) {\n\n\tTHREE.Material.prototype.copy.call( this, source );\n\n\tthis.color.copy( source.color );\n\n\tthis.map = source.map;\n\n\tthis.size = source.size;\n\tthis.sizeAttenuation = source.sizeAttenuation;\n\n\tthis.vertexColors = source.vertexColors;\n\n\tthis.fog = source.fog;\n\n\treturn this;\n\n};\n\n// backwards compatibility\n\nTHREE.PointCloudMaterial = function ( parameters ) {\n\n\tconsole.warn( 'THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial.' );\n\treturn new THREE.PointsMaterial( parameters );\n\n};\n\nTHREE.ParticleBasicMaterial = function ( parameters ) {\n\n\tconsole.warn( 'THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial.' );\n\treturn new THREE.PointsMaterial( parameters );\n\n};\n\nTHREE.ParticleSystemMaterial = function ( parameters ) {\n\n\tconsole.warn( 'THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial.' );\n\treturn new THREE.PointsMaterial( parameters );\n\n};\n\n// File:src/materials/ShaderMaterial.js\n\n/**\n * @author alteredq / http://alteredqualia.com/\n *\n * parameters = {\n *  defines: { \"label\" : \"value\" },\n *  uniforms: { \"parameter1\": { type: \"f\", value: 1.0 }, \"parameter2\": { type: \"i\" value2: 2 } },\n *\n *  fragmentShader: <string>,\n *  vertexShader: <string>,\n *\n *  shading: THREE.SmoothShading,\n *  blending: THREE.NormalBlending,\n *  depthTest: <bool>,\n *  depthWrite: <bool>,\n *\n *  wireframe: <boolean>,\n *  wireframeLinewidth: <float>,\n *\n *  lights: <bool>,\n *\n *  vertexColors: THREE.NoColors / THREE.VertexColors / THREE.FaceColors,\n *\n *  skinning: <bool>,\n *  morphTargets: <bool>,\n *  morphNormals: <bool>,\n *\n *\tfog: <bool>\n * }\n */\n\nTHREE.ShaderMaterial = function ( parameters ) {\n\n\tTHREE.Material.call( this );\n\n\tthis.type = 'ShaderMaterial';\n\n\tthis.defines = {};\n\tthis.uniforms = {};\n\n\tthis.vertexShader = 'void main() {\\n\\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\\n}';\n\tthis.fragmentShader = 'void main() {\\n\\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\\n}';\n\n\tthis.shading = THREE.SmoothShading;\n\n\tthis.linewidth = 1;\n\n\tthis.wireframe = false;\n\tthis.wireframeLinewidth = 1;\n\n\tthis.fog = false; // set to use scene fog\n\n\tthis.lights = false; // set to use scene lights\n\n\tthis.vertexColors = THREE.NoColors; // set to use \"color\" attribute stream\n\n\tthis.skinning = false; // set to use skinning attribute streams\n\n\tthis.morphTargets = false; // set to use morph targets\n\tthis.morphNormals = false; // set to use morph normals\n\n\tthis.derivatives = false; // set to use derivatives\n\n\t// When rendered geometry doesn't include these attributes but the material does,\n\t// use these default values in WebGL. This avoids errors when buffer data is missing.\n\tthis.defaultAttributeValues = {\n\t\t'color': [ 1, 1, 1 ],\n\t\t'uv': [ 0, 0 ],\n\t\t'uv2': [ 0, 0 ]\n\t};\n\n\tthis.index0AttributeName = undefined;\n\n\tif ( parameters !== undefined ) {\n\n\t\tif ( parameters.attributes !== undefined ) {\n\n\t\t\tconsole.error( 'THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead.' );\n\n\t\t}\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n};\n\nTHREE.ShaderMaterial.prototype = Object.create( THREE.Material.prototype );\nTHREE.ShaderMaterial.prototype.constructor = THREE.ShaderMaterial;\n\nTHREE.ShaderMaterial.prototype.copy = function ( source ) {\n\n\tTHREE.Material.prototype.copy.call( this, source );\n\n\tthis.fragmentShader = source.fragmentShader;\n\tthis.vertexShader = source.vertexShader;\n\n\tthis.uniforms = THREE.UniformsUtils.clone( source.uniforms );\n\n\tthis.attributes = source.attributes;\n\tthis.defines = source.defines;\n\n\tthis.shading = source.shading;\n\n\tthis.wireframe = source.wireframe;\n\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\n\tthis.fog = source.fog;\n\n\tthis.lights = source.lights;\n\n\tthis.vertexColors = source.vertexColors;\n\n\tthis.skinning = source.skinning;\n\n\tthis.morphTargets = source.morphTargets;\n\tthis.morphNormals = source.morphNormals;\n\n\tthis.derivatives = source.derivatives;\n\n\treturn this;\n\n};\n\nTHREE.ShaderMaterial.prototype.toJSON = function ( meta ) {\n\n\tvar data = THREE.Material.prototype.toJSON.call( this, meta );\n\n\tdata.uniforms = this.uniforms;\n\tdata.attributes = this.attributes;\n\tdata.vertexShader = this.vertexShader;\n\tdata.fragmentShader = this.fragmentShader;\n\n\treturn data;\n\n};\n\n// File:src/materials/RawShaderMaterial.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.RawShaderMaterial = function ( parameters ) {\n\n\tTHREE.ShaderMaterial.call( this, parameters );\n\n\tthis.type = 'RawShaderMaterial';\n\n};\n\nTHREE.RawShaderMaterial.prototype = Object.create( THREE.ShaderMaterial.prototype );\nTHREE.RawShaderMaterial.prototype.constructor = THREE.RawShaderMaterial;\n// File:src/materials/SpriteMaterial.js\n\n/**\n * @author alteredq / http://alteredqualia.com/\n *\n * parameters = {\n *  color: <hex>,\n *  opacity: <float>,\n *  map: new THREE.Texture( <Image> ),\n *\n *  blending: THREE.NormalBlending,\n *  depthTest: <bool>,\n *  depthWrite: <bool>,\n *\n *\tuvOffset: new THREE.Vector2(),\n *\tuvScale: new THREE.Vector2(),\n *\n *  fog: <bool>\n * }\n */\n\nTHREE.SpriteMaterial = function ( parameters ) {\n\n\tTHREE.Material.call( this );\n\n\tthis.type = 'SpriteMaterial';\n\n\tthis.color = new THREE.Color( 0xffffff );\n\tthis.map = null;\n\n\tthis.rotation = 0;\n\n\tthis.fog = false;\n\n\t// set parameters\n\n\tthis.setValues( parameters );\n\n};\n\nTHREE.SpriteMaterial.prototype = Object.create( THREE.Material.prototype );\nTHREE.SpriteMaterial.prototype.constructor = THREE.SpriteMaterial;\n\nTHREE.SpriteMaterial.prototype.copy = function ( source ) {\n\n\tTHREE.Material.prototype.copy.call( this, source );\n\n\tthis.color.copy( source.color );\n\tthis.map = source.map;\n\n\tthis.rotation = source.rotation;\n\n\tthis.fog = source.fog;\n\n\treturn this;\n\n};\n\n// File:src/textures/Texture.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n * @author alteredq / http://alteredqualia.com/\n * @author szimek / https://github.com/szimek/\n */\n\nTHREE.Texture = function ( image, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy ) {\n\n\tObject.defineProperty( this, 'id', { value: THREE.TextureIdCount ++ } );\n\n\tthis.uuid = THREE.Math.generateUUID();\n\n\tthis.name = '';\n\tthis.sourceFile = '';\n\n\tthis.image = image !== undefined ? image : THREE.Texture.DEFAULT_IMAGE;\n\tthis.mipmaps = [];\n\n\tthis.mapping = mapping !== undefined ? mapping : THREE.Texture.DEFAULT_MAPPING;\n\n\tthis.wrapS = wrapS !== undefined ? wrapS : THREE.ClampToEdgeWrapping;\n\tthis.wrapT = wrapT !== undefined ? wrapT : THREE.ClampToEdgeWrapping;\n\n\tthis.magFilter = magFilter !== undefined ? magFilter : THREE.LinearFilter;\n\tthis.minFilter = minFilter !== undefined ? minFilter : THREE.LinearMipMapLinearFilter;\n\n\tthis.anisotropy = anisotropy !== undefined ? anisotropy : 1;\n\n\tthis.format = format !== undefined ? format : THREE.RGBAFormat;\n\tthis.type = type !== undefined ? type : THREE.UnsignedByteType;\n\n\tthis.offset = new THREE.Vector2( 0, 0 );\n\tthis.repeat = new THREE.Vector2( 1, 1 );\n\n\tthis.generateMipmaps = true;\n\tthis.premultiplyAlpha = false;\n\tthis.flipY = true;\n\tthis.unpackAlignment = 4; // valid values: 1, 2, 4, 8 (see http://www.khronos.org/opengles/sdk/docs/man/xhtml/glPixelStorei.xml)\n\n\tthis.version = 0;\n\tthis.onUpdate = null;\n\n};\n\nTHREE.Texture.DEFAULT_IMAGE = undefined;\nTHREE.Texture.DEFAULT_MAPPING = THREE.UVMapping;\n\nTHREE.Texture.prototype = {\n\n\tconstructor: THREE.Texture,\n\n\tset needsUpdate ( value ) {\n\n\t\tif ( value === true ) this.version ++;\n\n\t},\n\n\tclone: function () {\n\n\t\treturn new this.constructor().copy( this );\n\n\t},\n\n\tcopy: function ( source ) {\n\n\t\tthis.image = source.image;\n\t\tthis.mipmaps = source.mipmaps.slice( 0 );\n\n\t\tthis.mapping = source.mapping;\n\n\t\tthis.wrapS = source.wrapS;\n\t\tthis.wrapT = source.wrapT;\n\n\t\tthis.magFilter = source.magFilter;\n\t\tthis.minFilter = source.minFilter;\n\n\t\tthis.anisotropy = source.anisotropy;\n\n\t\tthis.format = source.format;\n\t\tthis.type = source.type;\n\n\t\tthis.offset.copy( source.offset );\n\t\tthis.repeat.copy( source.repeat );\n\n\t\tthis.generateMipmaps = source.generateMipmaps;\n\t\tthis.premultiplyAlpha = source.premultiplyAlpha;\n\t\tthis.flipY = source.flipY;\n\t\tthis.unpackAlignment = source.unpackAlignment;\n\n\t\treturn this;\n\n\t},\n\n\ttoJSON: function ( meta ) {\n\n\t\tif ( meta.textures[ this.uuid ] !== undefined ) {\n\n\t\t\treturn meta.textures[ this.uuid ];\n\n\t\t}\n\n\t\tfunction getDataURL( image ) {\n\n\t\t\tvar canvas;\n\n\t\t\tif ( image.toDataURL !== undefined ) {\n\n\t\t\t\tcanvas = image;\n\n\t\t\t} else {\n\n\t\t\t\tcanvas = document.createElement( 'canvas' );\n\t\t\t\tcanvas.width = image.width;\n\t\t\t\tcanvas.height = image.height;\n\n\t\t\t\tcanvas.getContext( '2d' ).drawImage( image, 0, 0, image.width, image.height );\n\n\t\t\t}\n\n\t\t\tif ( canvas.width > 2048 || canvas.height > 2048 ) {\n\n\t\t\t\treturn canvas.toDataURL( 'image/jpeg', 0.6 );\n\n\t\t\t} else {\n\n\t\t\t\treturn canvas.toDataURL( 'image/png' );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvar output = {\n\t\t\tmetadata: {\n\t\t\t\tversion: 4.4,\n\t\t\t\ttype: 'Texture',\n\t\t\t\tgenerator: 'Texture.toJSON'\n\t\t\t},\n\n\t\t\tuuid: this.uuid,\n\t\t\tname: this.name,\n\n\t\t\tmapping: this.mapping,\n\n\t\t\trepeat: [ this.repeat.x, this.repeat.y ],\n\t\t\toffset: [ this.offset.x, this.offset.y ],\n\t\t\twrap: [ this.wrapS, this.wrapT ],\n\n\t\t\tminFilter: this.minFilter,\n\t\t\tmagFilter: this.magFilter,\n\t\t\tanisotropy: this.anisotropy\n\t\t};\n\n\t\tif ( this.image !== undefined ) {\n\n\t\t\t// TODO: Move to THREE.Image\n\n\t\t\tvar image = this.image;\n\n\t\t\tif ( image.uuid === undefined ) {\n\n\t\t\t\timage.uuid = THREE.Math.generateUUID(); // UGH\n\n\t\t\t}\n\n\t\t\tif ( meta.images[ image.uuid ] === undefined ) {\n\n\t\t\t\tmeta.images[ image.uuid ] = {\n\t\t\t\t\tuuid: image.uuid,\n\t\t\t\t\turl: getDataURL( image )\n\t\t\t\t};\n\n\t\t\t}\n\n\t\t\toutput.image = image.uuid;\n\n\t\t}\n\n\t\tmeta.textures[ this.uuid ] = output;\n\n\t\treturn output;\n\n\t},\n\n\tdispose: function () {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t},\n\n\ttransformUv: function ( uv ) {\n\n\t\tif ( this.mapping !== THREE.UVMapping )  return;\n\n\t\tuv.multiply( this.repeat );\n\t\tuv.add( this.offset );\n\n\t\tif ( uv.x < 0 || uv.x > 1 ) {\n\n\t\t\tswitch ( this.wrapS ) {\n\n\t\t\t\tcase THREE.RepeatWrapping:\n\n\t\t\t\t\tuv.x = uv.x - Math.floor( uv.x );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase THREE.ClampToEdgeWrapping:\n\n\t\t\t\t\tuv.x = uv.x < 0 ? 0 : 1;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase THREE.MirroredRepeatWrapping:\n\n\t\t\t\t\tif ( Math.abs( Math.floor( uv.x ) % 2 ) === 1 ) {\n\n\t\t\t\t\t\tuv.x = Math.ceil( uv.x ) - uv.x;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tuv.x = uv.x - Math.floor( uv.x );\n\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( uv.y < 0 || uv.y > 1 ) {\n\n\t\t\tswitch ( this.wrapT ) {\n\n\t\t\t\tcase THREE.RepeatWrapping:\n\n\t\t\t\t\tuv.y = uv.y - Math.floor( uv.y );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase THREE.ClampToEdgeWrapping:\n\n\t\t\t\t\tuv.y = uv.y < 0 ? 0 : 1;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase THREE.MirroredRepeatWrapping:\n\n\t\t\t\t\tif ( Math.abs( Math.floor( uv.y ) % 2 ) === 1 ) {\n\n\t\t\t\t\t\tuv.y = Math.ceil( uv.y ) - uv.y;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tuv.y = uv.y - Math.floor( uv.y );\n\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( this.flipY ) {\n\n\t\t\tuv.y = 1 - uv.y;\n\n\t\t}\n\n\t}\n\n};\n\nTHREE.EventDispatcher.prototype.apply( THREE.Texture.prototype );\n\nTHREE.TextureIdCount = 0;\n\n// File:src/textures/CanvasTexture.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.CanvasTexture = function ( canvas, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy ) {\n\n\tTHREE.Texture.call( this, canvas, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\n\n\tthis.needsUpdate = true;\n\n};\n\nTHREE.CanvasTexture.prototype = Object.create( THREE.Texture.prototype );\nTHREE.CanvasTexture.prototype.constructor = THREE.CanvasTexture;\n\n// File:src/textures/CubeTexture.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.CubeTexture = function ( images, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy ) {\n\n\tmapping = mapping !== undefined ? mapping : THREE.CubeReflectionMapping;\n\n\tTHREE.Texture.call( this, images, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\n\n\tthis.images = images;\n\tthis.flipY = false;\n\n};\n\nTHREE.CubeTexture.prototype = Object.create( THREE.Texture.prototype );\nTHREE.CubeTexture.prototype.constructor = THREE.CubeTexture;\n\nTHREE.CubeTexture.prototype.copy = function ( source ) {\n\n\tTHREE.Texture.prototype.copy.call( this, source );\n\t\n\tthis.images = source.images;\n\t\n\treturn this;\n\n};\n// File:src/textures/CompressedTexture.js\n\n/**\n * @author alteredq / http://alteredqualia.com/\n */\n\nTHREE.CompressedTexture = function ( mipmaps, width, height, format, type, mapping, wrapS, wrapT, magFilter, minFilter, anisotropy ) {\n\n\tTHREE.Texture.call( this, null, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\n\n\tthis.image = { width: width, height: height };\n\tthis.mipmaps = mipmaps;\n\n\t// no flipping for cube textures\n\t// (also flipping doesn't work for compressed textures )\n\n\tthis.flipY = false;\n\n\t// can't generate mipmaps for compressed textures\n\t// mips must be embedded in DDS files\n\n\tthis.generateMipmaps = false;\n\n};\n\nTHREE.CompressedTexture.prototype = Object.create( THREE.Texture.prototype );\nTHREE.CompressedTexture.prototype.constructor = THREE.CompressedTexture;\n\n// File:src/textures/DataTexture.js\n\n/**\n * @author alteredq / http://alteredqualia.com/\n */\n\nTHREE.DataTexture = function ( data, width, height, format, type, mapping, wrapS, wrapT, magFilter, minFilter, anisotropy ) {\n\n\tTHREE.Texture.call( this, null, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\n\n\tthis.image = { data: data, width: width, height: height };\n\n\tthis.magFilter = magFilter !== undefined ? magFilter : THREE.NearestFilter;\n\tthis.minFilter = minFilter !== undefined ? minFilter : THREE.NearestFilter;\n\t\n\tthis.flipY = false;\n\tthis.generateMipmaps  = false;\n\n};\n\nTHREE.DataTexture.prototype = Object.create( THREE.Texture.prototype );\nTHREE.DataTexture.prototype.constructor = THREE.DataTexture;\n\n// File:src/textures/VideoTexture.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.VideoTexture = function ( video, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy ) {\n\n\tTHREE.Texture.call( this, video, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\n\n\tthis.generateMipmaps = false;\n\n\tvar scope = this;\n\n\tvar update = function () {\n\n\t\trequestAnimationFrame( update );\n\n\t\tif ( video.readyState === video.HAVE_ENOUGH_DATA ) {\n\n\t\t\tscope.needsUpdate = true;\n\n\t\t}\n\n\t};\n\n\tupdate();\n\n};\n\nTHREE.VideoTexture.prototype = Object.create( THREE.Texture.prototype );\nTHREE.VideoTexture.prototype.constructor = THREE.VideoTexture;\n\n// File:src/objects/Group.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.Group = function () {\n\n\tTHREE.Object3D.call( this );\n\n\tthis.type = 'Group';\n\n};\n\nTHREE.Group.prototype = Object.create( THREE.Object3D.prototype );\nTHREE.Group.prototype.constructor = THREE.Group;\n// File:src/objects/Points.js\n\n/**\n * @author alteredq / http://alteredqualia.com/\n */\n\nTHREE.Points = function ( geometry, material ) {\n\n\tTHREE.Object3D.call( this );\n\n\tthis.type = 'Points';\n\n\tthis.geometry = geometry !== undefined ? geometry : new THREE.Geometry();\n\tthis.material = material !== undefined ? material : new THREE.PointsMaterial( { color: Math.random() * 0xffffff } );\n\n};\n\nTHREE.Points.prototype = Object.create( THREE.Object3D.prototype );\nTHREE.Points.prototype.constructor = THREE.Points;\n\nTHREE.Points.prototype.raycast = ( function () {\n\n\tvar inverseMatrix = new THREE.Matrix4();\n\tvar ray = new THREE.Ray();\n\n\treturn function raycast( raycaster, intersects ) {\n\n\t\tvar object = this;\n\t\tvar geometry = object.geometry;\n\t\tvar threshold = raycaster.params.Points.threshold;\n\n\t\tinverseMatrix.getInverse( this.matrixWorld );\n\t\tray.copy( raycaster.ray ).applyMatrix4( inverseMatrix );\n\n\t\tif ( geometry.boundingBox !== null ) {\n\n\t\t\tif ( ray.isIntersectionBox( geometry.boundingBox ) === false ) {\n\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t}\n\n\t\tvar localThreshold = threshold / ( ( this.scale.x + this.scale.y + this.scale.z ) / 3 );\n\t\tvar localThresholdSq = localThreshold * localThreshold;\n\t\tvar position = new THREE.Vector3();\n\n\t\tfunction testPoint( point, index ) {\n\n\t\t\tvar rayPointDistanceSq = ray.distanceSqToPoint( point );\n\n\t\t\tif ( rayPointDistanceSq < localThresholdSq ) {\n\n\t\t\t\tvar intersectPoint = ray.closestPointToPoint( point );\n\t\t\t\tintersectPoint.applyMatrix4( object.matrixWorld );\n\n\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( intersectPoint );\n\n\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) return;\n\n\t\t\t\tintersects.push( {\n\n\t\t\t\t\tdistance: distance,\n\t\t\t\t\tdistanceToRay: Math.sqrt( rayPointDistanceSq ),\n\t\t\t\t\tpoint: intersectPoint.clone(),\n\t\t\t\t\tindex: index,\n\t\t\t\t\tface: null,\n\t\t\t\t\tobject: object\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( geometry instanceof THREE.BufferGeometry ) {\n\n\t\t\tvar index = geometry.index;\n\t\t\tvar attributes = geometry.attributes;\n\t\t\tvar positions = attributes.position.array;\n\n\t\t\tif ( index !== null ) {\n\n\t\t\t\tvar indices = index.array;\n\n\t\t\t\tfor ( var i = 0, il = indices.length; i < il; i ++ ) {\n\n\t\t\t\t\tvar a = indices[ i ];\n\n\t\t\t\t\tposition.fromArray( positions, a * 3 );\n\n\t\t\t\t\ttestPoint( position, a );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tfor ( var i = 0, l = positions.length / 3; i < l; i ++ ) {\n\n\t\t\t\t\tposition.fromArray( positions, i * 3 );\n\n\t\t\t\t\ttestPoint( position, i );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tvar vertices = geometry.vertices;\n\n\t\t\tfor ( var i = 0, l = vertices.length; i < l; i ++ ) {\n\n\t\t\t\ttestPoint( vertices[ i ], i );\n\n\t\t\t}\n\n\t\t}\n\n\t};\n\n}() );\n\nTHREE.Points.prototype.clone = function () {\n\n\treturn new this.constructor( this.geometry, this.material ).copy( this );\n\n};\n\nTHREE.Points.prototype.toJSON = function ( meta ) {\n\n\tvar data = THREE.Object3D.prototype.toJSON.call( this, meta );\n\n\t// only serialize if not in meta geometries cache\n\tif ( meta.geometries[ this.geometry.uuid ] === undefined ) {\n\n\t\tmeta.geometries[ this.geometry.uuid ] = this.geometry.toJSON();\n\n\t}\n\n\t// only serialize if not in meta materials cache\n\tif ( meta.materials[ this.material.uuid ] === undefined ) {\n\n\t\tmeta.materials[ this.material.uuid ] = this.material.toJSON();\n\n\t}\n\n\tdata.object.geometry = this.geometry.uuid;\n\tdata.object.material = this.material.uuid;\n\n\treturn data;\n\n};\n\n// Backwards compatibility\n\nTHREE.PointCloud = function ( geometry, material ) {\n\n\tconsole.warn( 'THREE.PointCloud has been renamed to THREE.Points.' );\n\treturn new THREE.Points( geometry, material );\n\n};\n\nTHREE.ParticleSystem = function ( geometry, material ) {\n\n\tconsole.warn( 'THREE.ParticleSystem has been renamed to THREE.Points.' );\n\treturn new THREE.Points( geometry, material );\n\n};\n\n// File:src/objects/Line.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.Line = function ( geometry, material, mode ) {\n\n\tif ( mode === 1 ) {\n\n\t\tconsole.warn( 'THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead.' );\n\t\treturn new THREE.LineSegments( geometry, material );\n\n\t}\n\n\tTHREE.Object3D.call( this );\n\n\tthis.type = 'Line';\n\n\tthis.geometry = geometry !== undefined ? geometry : new THREE.Geometry();\n\tthis.material = material !== undefined ? material : new THREE.LineBasicMaterial( { color: Math.random() * 0xffffff } );\n\n};\n\nTHREE.Line.prototype = Object.create( THREE.Object3D.prototype );\nTHREE.Line.prototype.constructor = THREE.Line;\n\nTHREE.Line.prototype.raycast = ( function () {\n\n\tvar inverseMatrix = new THREE.Matrix4();\n\tvar ray = new THREE.Ray();\n\tvar sphere = new THREE.Sphere();\n\n\treturn function raycast( raycaster, intersects ) {\n\n\t\tvar precision = raycaster.linePrecision;\n\t\tvar precisionSq = precision * precision;\n\n\t\tvar geometry = this.geometry;\n\n\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\n\n\t\t// Checking boundingSphere distance to ray\n\n\t\tsphere.copy( geometry.boundingSphere );\n\t\tsphere.applyMatrix4( this.matrixWorld );\n\n\t\tif ( raycaster.ray.isIntersectionSphere( sphere ) === false ) {\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tinverseMatrix.getInverse( this.matrixWorld );\n\t\tray.copy( raycaster.ray ).applyMatrix4( inverseMatrix );\n\n\t\tvar vStart = new THREE.Vector3();\n\t\tvar vEnd = new THREE.Vector3();\n\t\tvar interSegment = new THREE.Vector3();\n\t\tvar interRay = new THREE.Vector3();\n\t\tvar step = this instanceof THREE.LineSegments ? 2 : 1;\n\n\t\tif ( geometry instanceof THREE.BufferGeometry ) {\n\n\t\t\tvar index = geometry.index;\n\t\t\tvar attributes = geometry.attributes;\n\n\t\t\tif ( index !== null ) {\n\n\t\t\t\tvar indices = index.array;\n\t\t\t\tvar positions = attributes.position.array;\n\n\t\t\t\tfor ( var i = 0, l = indices.length - 1; i < l; i += step ) {\n\n\t\t\t\t\tvar a = indices[ i ];\n\t\t\t\t\tvar b = indices[ i + 1 ];\n\n\t\t\t\t\tvStart.fromArray( positions, a * 3 );\n\t\t\t\t\tvEnd.fromArray( positions, b * 3 );\n\n\t\t\t\t\tvar distSq = ray.distanceSqToSegment( vStart, vEnd, interRay, interSegment );\n\n\t\t\t\t\tif ( distSq > precisionSq ) continue;\n\n\t\t\t\t\tinterRay.applyMatrix4( this.matrixWorld ); //Move back to world space for distance calculation\n\n\t\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( interRay );\n\n\t\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) continue;\n\n\t\t\t\t\tintersects.push( {\n\n\t\t\t\t\t\tdistance: distance,\n\t\t\t\t\t\t// What do we want? intersection point on the ray or on the segment??\n\t\t\t\t\t\t// point: raycaster.ray.at( distance ),\n\t\t\t\t\t\tpoint: interSegment.clone().applyMatrix4( this.matrixWorld ),\n\t\t\t\t\t\tindex: i,\n\t\t\t\t\t\tface: null,\n\t\t\t\t\t\tfaceIndex: null,\n\t\t\t\t\t\tobject: this\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tvar positions = attributes.position.array;\n\n\t\t\t\tfor ( var i = 0, l = positions.length / 3 - 1; i < l; i += step ) {\n\n\t\t\t\t\tvStart.fromArray( positions, 3 * i );\n\t\t\t\t\tvEnd.fromArray( positions, 3 * i + 3 );\n\n\t\t\t\t\tvar distSq = ray.distanceSqToSegment( vStart, vEnd, interRay, interSegment );\n\n\t\t\t\t\tif ( distSq > precisionSq ) continue;\n\n\t\t\t\t\tinterRay.applyMatrix4( this.matrixWorld ); //Move back to world space for distance calculation\n\n\t\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( interRay );\n\n\t\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) continue;\n\n\t\t\t\t\tintersects.push( {\n\n\t\t\t\t\t\tdistance: distance,\n\t\t\t\t\t\t// What do we want? intersection point on the ray or on the segment??\n\t\t\t\t\t\t// point: raycaster.ray.at( distance ),\n\t\t\t\t\t\tpoint: interSegment.clone().applyMatrix4( this.matrixWorld ),\n\t\t\t\t\t\tindex: i,\n\t\t\t\t\t\tface: null,\n\t\t\t\t\t\tfaceIndex: null,\n\t\t\t\t\t\tobject: this\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( geometry instanceof THREE.Geometry ) {\n\n\t\t\tvar vertices = geometry.vertices;\n\t\t\tvar nbVertices = vertices.length;\n\n\t\t\tfor ( var i = 0; i < nbVertices - 1; i += step ) {\n\n\t\t\t\tvar distSq = ray.distanceSqToSegment( vertices[ i ], vertices[ i + 1 ], interRay, interSegment );\n\n\t\t\t\tif ( distSq > precisionSq ) continue;\n\n\t\t\t\tinterRay.applyMatrix4( this.matrixWorld ); //Move back to world space for distance calculation\n\n\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( interRay );\n\n\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) continue;\n\n\t\t\t\tintersects.push( {\n\n\t\t\t\t\tdistance: distance,\n\t\t\t\t\t// What do we want? intersection point on the ray or on the segment??\n\t\t\t\t\t// point: raycaster.ray.at( distance ),\n\t\t\t\t\tpoint: interSegment.clone().applyMatrix4( this.matrixWorld ),\n\t\t\t\t\tindex: i,\n\t\t\t\t\tface: null,\n\t\t\t\t\tfaceIndex: null,\n\t\t\t\t\tobject: this\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t}\n\n\t};\n\n}() );\n\nTHREE.Line.prototype.clone = function () {\n\n\treturn new this.constructor( this.geometry, this.material ).copy( this );\n\n};\n\nTHREE.Line.prototype.toJSON = function ( meta ) {\n\n\tvar data = THREE.Object3D.prototype.toJSON.call( this, meta );\n\n\t// only serialize if not in meta geometries cache\n\tif ( meta.geometries[ this.geometry.uuid ] === undefined ) {\n\n\t\tmeta.geometries[ this.geometry.uuid ] = this.geometry.toJSON();\n\n\t}\n\n\t// only serialize if not in meta materials cache\n\tif ( meta.materials[ this.material.uuid ] === undefined ) {\n\n\t\tmeta.materials[ this.material.uuid ] = this.material.toJSON();\n\n\t}\n\n\tdata.object.geometry = this.geometry.uuid;\n\tdata.object.material = this.material.uuid;\n\n\treturn data;\n\n};\n\n// DEPRECATED\n\nTHREE.LineStrip = 0;\nTHREE.LinePieces = 1;\n\n// File:src/objects/LineSegments.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.LineSegments = function ( geometry, material ) {\n\n\tTHREE.Line.call( this, geometry, material );\n\n\tthis.type = 'LineSegments';\n\n};\n\nTHREE.LineSegments.prototype = Object.create( THREE.Line.prototype );\nTHREE.LineSegments.prototype.constructor = THREE.LineSegments;\n\n// File:src/objects/Mesh.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n * @author alteredq / http://alteredqualia.com/\n * @author mikael emtinger / http://gomo.se/\n * @author jonobr1 / http://jonobr1.com/\n */\n\nTHREE.Mesh = function ( geometry, material ) {\n\n\tTHREE.Object3D.call( this );\n\n\tthis.type = 'Mesh';\n\n\tthis.geometry = geometry !== undefined ? geometry : new THREE.Geometry();\n\tthis.material = material !== undefined ? material : new THREE.MeshBasicMaterial( { color: Math.random() * 0xffffff } );\n\n\tthis.updateMorphTargets();\n\n};\n\nTHREE.Mesh.prototype = Object.create( THREE.Object3D.prototype );\nTHREE.Mesh.prototype.constructor = THREE.Mesh;\n\nTHREE.Mesh.prototype.updateMorphTargets = function () {\n\n\tif ( this.geometry.morphTargets !== undefined && this.geometry.morphTargets.length > 0 ) {\n\n\t\tthis.morphTargetBase = - 1;\n\t\tthis.morphTargetInfluences = [];\n\t\tthis.morphTargetDictionary = {};\n\n\t\tfor ( var m = 0, ml = this.geometry.morphTargets.length; m < ml; m ++ ) {\n\n\t\t\tthis.morphTargetInfluences.push( 0 );\n\t\t\tthis.morphTargetDictionary[ this.geometry.morphTargets[ m ].name ] = m;\n\n\t\t}\n\n\t}\n\n};\n\nTHREE.Mesh.prototype.getMorphTargetIndexByName = function ( name ) {\n\n\tif ( this.morphTargetDictionary[ name ] !== undefined ) {\n\n\t\treturn this.morphTargetDictionary[ name ];\n\n\t}\n\n\tconsole.warn( 'THREE.Mesh.getMorphTargetIndexByName: morph target ' + name + ' does not exist. Returning 0.' );\n\n\treturn 0;\n\n};\n\n\nTHREE.Mesh.prototype.raycast = ( function () {\n\n\tvar inverseMatrix = new THREE.Matrix4();\n\tvar ray = new THREE.Ray();\n\tvar sphere = new THREE.Sphere();\n\n\tvar vA = new THREE.Vector3();\n\tvar vB = new THREE.Vector3();\n\tvar vC = new THREE.Vector3();\n\n\tvar tempA = new THREE.Vector3();\n\tvar tempB = new THREE.Vector3();\n\tvar tempC = new THREE.Vector3();\n\n\tvar uvA = new THREE.Vector2();\n\tvar uvB = new THREE.Vector2();\n\tvar uvC = new THREE.Vector2();\n\n\tvar barycoord = new THREE.Vector3();\n\n\tvar intersectionPoint = new THREE.Vector3();\n\tvar intersectionPointWorld = new THREE.Vector3();\n\n\tfunction uvIntersection( point, p1, p2, p3, uv1, uv2, uv3 ) {\n\n\t\tTHREE.Triangle.barycoordFromPoint( point, p1, p2, p3, barycoord );\n\n\t\tuv1.multiplyScalar( barycoord.x );\n\t\tuv2.multiplyScalar( barycoord.y );\n\t\tuv3.multiplyScalar( barycoord.z );\n\n\t\tuv1.add( uv2 ).add( uv3 );\n\n\t\treturn uv1.clone();\n\n\t}\n\n\treturn function raycast( raycaster, intersects ) {\n\n\t\tvar geometry = this.geometry;\n\t\tvar material = this.material;\n\n\t\tif ( material === undefined ) return;\n\n\t\t// Checking boundingSphere distance to ray\n\n\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\n\n\t\tsphere.copy( geometry.boundingSphere );\n\t\tsphere.applyMatrix4( this.matrixWorld );\n\n\t\tif ( raycaster.ray.isIntersectionSphere( sphere ) === false ) {\n\n\t\t\treturn;\n\n\t\t}\n\n\t\t// Check boundingBox before continuing\n\n\t\tinverseMatrix.getInverse( this.matrixWorld );\n\t\tray.copy( raycaster.ray ).applyMatrix4( inverseMatrix );\n\n\t\tif ( geometry.boundingBox !== null ) {\n\n\t\t\tif ( ray.isIntersectionBox( geometry.boundingBox ) === false ) {\n\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t}\n\n\t\tvar a, b, c;\n\n\t\tif ( geometry instanceof THREE.BufferGeometry ) {\n\n\t\t\tvar index = geometry.index;\n\t\t\tvar attributes = geometry.attributes;\n\n\t\t\tif ( index !== null ) {\n\n\t\t\t\tvar indices = index.array;\n\t\t\t\tvar positions = attributes.position.array;\n\n\t\t\t\tfor ( var i = 0, l = indices.length; i < l; i += 3 ) {\n\n\t\t\t\t\ta = indices[ i ];\n\t\t\t\t\tb = indices[ i + 1 ];\n\t\t\t\t\tc = indices[ i + 2 ];\n\n\t\t\t\t\tvA.fromArray( positions, a * 3 );\n\t\t\t\t\tvB.fromArray( positions, b * 3 );\n\t\t\t\t\tvC.fromArray( positions, c * 3 );\n\n\t\t\t\t\tif ( material.side === THREE.BackSide ) {\n\n\t\t\t\t\t\tif ( ray.intersectTriangle( vC, vB, vA, true, intersectionPoint ) === null ) continue;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tif ( ray.intersectTriangle( vA, vB, vC, material.side !== THREE.DoubleSide, intersectionPoint ) === null ) continue;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tintersectionPointWorld.copy( intersectionPoint );\n\t\t\t\t\tintersectionPointWorld.applyMatrix4( this.matrixWorld );\n\n\t\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( intersectionPointWorld );\n\n\t\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) continue;\n\n\t\t\t\t\tvar uv;\n\n\t\t\t\t\tif ( attributes.uv !== undefined ) {\n\n\t\t\t\t\t\tvar uvs = attributes.uv.array;\n\t\t\t\t\t\tuvA.fromArray( uvs, a * 2 );\n\t\t\t\t\t\tuvB.fromArray( uvs, b * 2 );\n\t\t\t\t\t\tuvC.fromArray( uvs, c * 2 );\n\t\t\t\t\t\tuv = uvIntersection( intersectionPoint, vA, vB, vC, uvA, uvB, uvC );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tintersects.push( {\n\n\t\t\t\t\t\tdistance: distance,\n\t\t\t\t\t\tpoint: intersectionPointWorld.clone(),\n\t\t\t\t\t\tuv: uv,\n\t\t\t\t\t\tface: new THREE.Face3( a, b, c, THREE.Triangle.normal( vA, vB, vC ) ),\n\t\t\t\t\t\tfaceIndex: Math.floor( i / 3 ), // triangle number in indices buffer semantics\n\t\t\t\t\t\tobject: this\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tvar positions = attributes.position.array;\n\n\t\t\t\tfor ( var i = 0, l = positions.length; i < l; i += 9 ) {\n\n\t\t\t\t\tvA.fromArray( positions, i );\n\t\t\t\t\tvB.fromArray( positions, i + 3 );\n\t\t\t\t\tvC.fromArray( positions, i + 6 );\n\n\t\t\t\t\tif ( material.side === THREE.BackSide ) {\n\n\t\t\t\t\t\tif ( ray.intersectTriangle( vC, vB, vA, true, intersectionPoint ) === null ) continue;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tif ( ray.intersectTriangle( vA, vB, vC, material.side !== THREE.DoubleSide, intersectionPoint ) === null ) continue;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tintersectionPointWorld.copy( intersectionPoint );\n\t\t\t\t\tintersectionPointWorld.applyMatrix4( this.matrixWorld );\n\n\t\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( intersectionPointWorld );\n\n\t\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) continue;\n\n\t\t\t\t\tvar uv;\n\n\t\t\t\t\tif ( attributes.uv !== undefined ) {\n\n\t\t\t\t\t\tvar uvs = attributes.uv.array;\n\t\t\t\t\t\tuvA.fromArray( uvs, i );\n\t\t\t\t\t\tuvB.fromArray( uvs, i + 2 );\n\t\t\t\t\t\tuvC.fromArray( uvs, i + 4 );\n\t\t\t\t\t\tuv = uvIntersection( intersectionPoint, vA, vB, vC, uvA, uvB, uvC );\n\n\t\t\t\t\t}\n\n\t\t\t\t\ta = i / 3;\n\t\t\t\t\tb = a + 1;\n\t\t\t\t\tc = a + 2;\n\n\t\t\t\t\tintersects.push( {\n\n\t\t\t\t\t\tdistance: distance,\n\t\t\t\t\t\tpoint: intersectionPointWorld.clone(),\n\t\t\t\t\t\tuv: uv,\n\t\t\t\t\t\tface: new THREE.Face3( a, b, c, THREE.Triangle.normal( vA, vB, vC ) ),\n\t\t\t\t\t\tindex: a, // triangle number in positions buffer semantics\n\t\t\t\t\t\tobject: this\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( geometry instanceof THREE.Geometry ) {\n\n\t\t\tvar isFaceMaterial = material instanceof THREE.MeshFaceMaterial;\n\t\t\tvar materials = isFaceMaterial === true ? material.materials : null;\n\n\t\t\tvar vertices = geometry.vertices;\n\t\t\tvar faces = geometry.faces;\n\n\t\t\tfor ( var f = 0, fl = faces.length; f < fl; f ++ ) {\n\n\t\t\t\tvar face = faces[ f ];\n\t\t\t\tvar faceMaterial = isFaceMaterial === true ? materials[ face.materialIndex ] : material;\n\n\t\t\t\tif ( faceMaterial === undefined ) continue;\n\n\t\t\t\ta = vertices[ face.a ];\n\t\t\t\tb = vertices[ face.b ];\n\t\t\t\tc = vertices[ face.c ];\n\n\t\t\t\tif ( faceMaterial.morphTargets === true ) {\n\n\t\t\t\t\tvar morphTargets = geometry.morphTargets;\n\t\t\t\t\tvar morphInfluences = this.morphTargetInfluences;\n\n\t\t\t\t\tvA.set( 0, 0, 0 );\n\t\t\t\t\tvB.set( 0, 0, 0 );\n\t\t\t\t\tvC.set( 0, 0, 0 );\n\n\t\t\t\t\tfor ( var t = 0, tl = morphTargets.length; t < tl; t ++ ) {\n\n\t\t\t\t\t\tvar influence = morphInfluences[ t ];\n\n\t\t\t\t\t\tif ( influence === 0 ) continue;\n\n\t\t\t\t\t\tvar targets = morphTargets[ t ].vertices;\n\n\t\t\t\t\t\tvA.addScaledVector( tempA.subVectors( targets[ face.a ], a ), influence );\n\t\t\t\t\t\tvB.addScaledVector( tempB.subVectors( targets[ face.b ], b ), influence );\n\t\t\t\t\t\tvC.addScaledVector( tempC.subVectors( targets[ face.c ], c ), influence );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tvA.add( a );\n\t\t\t\t\tvB.add( b );\n\t\t\t\t\tvC.add( c );\n\n\t\t\t\t\ta = vA;\n\t\t\t\t\tb = vB;\n\t\t\t\t\tc = vC;\n\n\t\t\t\t}\n\n\t\t\t\tif ( faceMaterial.side === THREE.BackSide ) {\n\n\t\t\t\t\tif ( ray.intersectTriangle( c, b, a, true, intersectionPoint ) === null ) continue;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( ray.intersectTriangle( a, b, c, faceMaterial.side !== THREE.DoubleSide, intersectionPoint ) === null ) continue;\n\n\t\t\t\t}\n\n\t\t\t\tintersectionPointWorld.copy( intersectionPoint );\n\t\t\t\tintersectionPointWorld.applyMatrix4( this.matrixWorld );\n\n\t\t\t\tvar distance = raycaster.ray.origin.distanceTo( intersectionPointWorld );\n\n\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) continue;\n\n\t\t\t\tvar uv;\n\n\t\t\t\tif ( geometry.faceVertexUvs[ 0 ].length > 0 ) {\n\n\t\t\t\t\tvar uvs = geometry.faceVertexUvs[ 0 ][ f ];\n\t\t\t\t\tuvA.copy( uvs[ 0 ] );\n\t\t\t\t\tuvB.copy( uvs[ 1 ] );\n\t\t\t\t\tuvC.copy( uvs[ 2 ] );\n\t\t\t\t\tuv = uvIntersection( intersectionPoint, a, b, c, uvA, uvB, uvC );\n\n\t\t\t\t}\n\n\t\t\t\tintersects.push( {\n\n\t\t\t\t\tdistance: distance,\n\t\t\t\t\tpoint: intersectionPointWorld.clone(),\n\t\t\t\t\tuv: uv,\n\t\t\t\t\tface: face,\n\t\t\t\t\tfaceIndex: f,\n\t\t\t\t\tobject: this\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t}\n\n\t};\n\n}() );\n\nTHREE.Mesh.prototype.clone = function () {\n\n\treturn new this.constructor( this.geometry, this.material ).copy( this );\n\n};\n\nTHREE.Mesh.prototype.toJSON = function ( meta ) {\n\n\tvar data = THREE.Object3D.prototype.toJSON.call( this, meta );\n\n\t// only serialize if not in meta geometries cache\n\tif ( meta.geometries[ this.geometry.uuid ] === undefined ) {\n\n\t\tmeta.geometries[ this.geometry.uuid ] = this.geometry.toJSON( meta );\n\n\t}\n\n\t// only serialize if not in meta materials cache\n\tif ( meta.materials[ this.material.uuid ] === undefined ) {\n\n\t\tmeta.materials[ this.material.uuid ] = this.material.toJSON( meta );\n\n\t}\n\n\tdata.object.geometry = this.geometry.uuid;\n\tdata.object.material = this.material.uuid;\n\n\treturn data;\n\n};\n\n// File:src/objects/Bone.js\n\n/**\n * @author mikael emtinger / http://gomo.se/\n * @author alteredq / http://alteredqualia.com/\n * @author ikerr / http://verold.com\n */\n\nTHREE.Bone = function ( skin ) {\n\n\tTHREE.Object3D.call( this );\n\n\tthis.type = 'Bone';\n\n\tthis.skin = skin;\n\n};\n\nTHREE.Bone.prototype = Object.create( THREE.Object3D.prototype );\nTHREE.Bone.prototype.constructor = THREE.Bone;\n\nTHREE.Bone.prototype.copy = function ( source ) {\n\t\n\tTHREE.Object3D.prototype.copy.call( this, source );\n\t\n\tthis.skin = source.skin;\n\t\n\treturn this;\n\n};\n\n// File:src/objects/Skeleton.js\n\n/**\n * @author mikael emtinger / http://gomo.se/\n * @author alteredq / http://alteredqualia.com/\n * @author michael guerrero / http://realitymeltdown.com\n * @author ikerr / http://verold.com\n */\n\nTHREE.Skeleton = function ( bones, boneInverses, useVertexTexture ) {\n\n\tthis.useVertexTexture = useVertexTexture !== undefined ? useVertexTexture : true;\n\n\tthis.identityMatrix = new THREE.Matrix4();\n\n\t// copy the bone array\n\n\tbones = bones || [];\n\n\tthis.bones = bones.slice( 0 );\n\n\t// create a bone texture or an array of floats\n\n\tif ( this.useVertexTexture ) {\n\n\t\t// layout (1 matrix = 4 pixels)\n\t\t//      RGBA RGBA RGBA RGBA (=> column1, column2, column3, column4)\n\t\t//  with  8x8  pixel texture max   16 bones * 4 pixels =  (8 * 8)\n\t\t//       16x16 pixel texture max   64 bones * 4 pixels = (16 * 16)\n\t\t//       32x32 pixel texture max  256 bones * 4 pixels = (32 * 32)\n\t\t//       64x64 pixel texture max 1024 bones * 4 pixels = (64 * 64)\n\n\t\t\n\t\tvar size = Math.sqrt( this.bones.length * 4 ); // 4 pixels needed for 1 matrix\n\t\tsize = THREE.Math.nextPowerOfTwo( Math.ceil( size ) );\n\t\tsize = Math.max( size, 4 );\n\n\t\tthis.boneTextureWidth = size;\n\t\tthis.boneTextureHeight = size;\n\n\t\tthis.boneMatrices = new Float32Array( this.boneTextureWidth * this.boneTextureHeight * 4 ); // 4 floats per RGBA pixel\n\t\tthis.boneTexture = new THREE.DataTexture( this.boneMatrices, this.boneTextureWidth, this.boneTextureHeight, THREE.RGBAFormat, THREE.FloatType );\n\n\t} else {\n\n\t\tthis.boneMatrices = new Float32Array( 16 * this.bones.length );\n\n\t}\n\n\t// use the supplied bone inverses or calculate the inverses\n\n\tif ( boneInverses === undefined ) {\n\n\t\tthis.calculateInverses();\n\n\t} else {\n\n\t\tif ( this.bones.length === boneInverses.length ) {\n\n\t\t\tthis.boneInverses = boneInverses.slice( 0 );\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.Skeleton bonInverses is the wrong length.' );\n\n\t\t\tthis.boneInverses = [];\n\n\t\t\tfor ( var b = 0, bl = this.bones.length; b < bl; b ++ ) {\n\n\t\t\t\tthis.boneInverses.push( new THREE.Matrix4() );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n};\n\nTHREE.Skeleton.prototype.calculateInverses = function () {\n\n\tthis.boneInverses = [];\n\n\tfor ( var b = 0, bl = this.bones.length; b < bl; b ++ ) {\n\n\t\tvar inverse = new THREE.Matrix4();\n\n\t\tif ( this.bones[ b ] ) {\n\n\t\t\tinverse.getInverse( this.bones[ b ].matrixWorld );\n\n\t\t}\n\n\t\tthis.boneInverses.push( inverse );\n\n\t}\n\n};\n\nTHREE.Skeleton.prototype.pose = function () {\n\n\tvar bone;\n\n\t// recover the bind-time world matrices\n\n\tfor ( var b = 0, bl = this.bones.length; b < bl; b ++ ) {\n\n\t\tbone = this.bones[ b ];\n\n\t\tif ( bone ) {\n\n\t\t\tbone.matrixWorld.getInverse( this.boneInverses[ b ] );\n\n\t\t}\n\n\t}\n\n\t// compute the local matrices, positions, rotations and scales\n\n\tfor ( var b = 0, bl = this.bones.length; b < bl; b ++ ) {\n\n\t\tbone = this.bones[ b ];\n\n\t\tif ( bone ) {\n\n\t\t\tif ( bone.parent ) {\n\n\t\t\t\tbone.matrix.getInverse( bone.parent.matrixWorld );\n\t\t\t\tbone.matrix.multiply( bone.matrixWorld );\n\n\t\t\t} else {\n\n\t\t\t\tbone.matrix.copy( bone.matrixWorld );\n\n\t\t\t}\n\n\t\t\tbone.matrix.decompose( bone.position, bone.quaternion, bone.scale );\n\n\t\t}\n\n\t}\n\n};\n\nTHREE.Skeleton.prototype.update = ( function () {\n\n\tvar offsetMatrix = new THREE.Matrix4();\n\n\treturn function update() {\n\n\t\t// flatten bone matrices to array\n\n\t\tfor ( var b = 0, bl = this.bones.length; b < bl; b ++ ) {\n\n\t\t\t// compute the offset between the current and the original transform\n\n\t\t\tvar matrix = this.bones[ b ] ? this.bones[ b ].matrixWorld : this.identityMatrix;\n\n\t\t\toffsetMatrix.multiplyMatrices( matrix, this.boneInverses[ b ] );\n\t\t\toffsetMatrix.flattenToArrayOffset( this.boneMatrices, b * 16 );\n\n\t\t}\n\n\t\tif ( this.useVertexTexture ) {\n\n\t\t\tthis.boneTexture.needsUpdate = true;\n\n\t\t}\n\n\t};\n\n} )();\n\nTHREE.Skeleton.prototype.clone = function () {\n\n\treturn new THREE.Skeleton( this.bones, this.boneInverses, this.useVertexTexture );\n\n};\n\n// File:src/objects/SkinnedMesh.js\n\n/**\n * @author mikael emtinger / http://gomo.se/\n * @author alteredq / http://alteredqualia.com/\n * @author ikerr / http://verold.com\n */\n\nTHREE.SkinnedMesh = function ( geometry, material, useVertexTexture ) {\n\n\tTHREE.Mesh.call( this, geometry, material );\n\n\tthis.type = 'SkinnedMesh';\n\n\tthis.bindMode = \"attached\";\n\tthis.bindMatrix = new THREE.Matrix4();\n\tthis.bindMatrixInverse = new THREE.Matrix4();\n\n\t// init bones\n\n\t// TODO: remove bone creation as there is no reason (other than\n\t// convenience) for THREE.SkinnedMesh to do this.\n\n\tvar bones = [];\n\n\tif ( this.geometry && this.geometry.bones !== undefined ) {\n\n\t\tvar bone, gbone;\n\n\t\tfor ( var b = 0, bl = this.geometry.bones.length; b < bl; ++ b ) {\n\n\t\t\tgbone = this.geometry.bones[ b ];\n\n\t\t\tbone = new THREE.Bone( this );\n\t\t\tbones.push( bone );\n\n\t\t\tbone.name = gbone.name;\n\t\t\tbone.position.fromArray( gbone.pos );\n\t\t\tbone.quaternion.fromArray( gbone.rotq );\n\t\t\tif ( gbone.scl !== undefined ) bone.scale.fromArray( gbone.scl );\n\n\t\t}\n\n\t\tfor ( var b = 0, bl = this.geometry.bones.length; b < bl; ++ b ) {\n\n\t\t\tgbone = this.geometry.bones[ b ];\n\n\t\t\tif ( gbone.parent !== - 1 ) {\n\n\t\t\t\tbones[ gbone.parent ].add( bones[ b ] );\n\n\t\t\t} else {\n\n\t\t\t\tthis.add( bones[ b ] );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tthis.normalizeSkinWeights();\n\n\tthis.updateMatrixWorld( true );\n\tthis.bind( new THREE.Skeleton( bones, undefined, useVertexTexture ), this.matrixWorld );\n\n};\n\n\nTHREE.SkinnedMesh.prototype = Object.create( THREE.Mesh.prototype );\nTHREE.SkinnedMesh.prototype.constructor = THREE.SkinnedMesh;\n\nTHREE.SkinnedMesh.prototype.bind = function( skeleton, bindMatrix ) {\n\n\tthis.skeleton = skeleton;\n\n\tif ( bindMatrix === undefined ) {\n\n\t\tthis.updateMatrixWorld( true );\n\t\t\n\t\tthis.skeleton.calculateInverses();\n\n\t\tbindMatrix = this.matrixWorld;\n\n\t}\n\n\tthis.bindMatrix.copy( bindMatrix );\n\tthis.bindMatrixInverse.getInverse( bindMatrix );\n\n};\n\nTHREE.SkinnedMesh.prototype.pose = function () {\n\n\tthis.skeleton.pose();\n\n};\n\nTHREE.SkinnedMesh.prototype.normalizeSkinWeights = function () {\n\n\tif ( this.geometry instanceof THREE.Geometry ) {\n\n\t\tfor ( var i = 0; i < this.geometry.skinIndices.length; i ++ ) {\n\n\t\t\tvar sw = this.geometry.skinWeights[ i ];\n\n\t\t\tvar scale = 1.0 / sw.lengthManhattan();\n\n\t\t\tif ( scale !== Infinity ) {\n\n\t\t\t\tsw.multiplyScalar( scale );\n\n\t\t\t} else {\n\n\t\t\t\tsw.set( 1 ); // this will be normalized by the shader anyway\n\n\t\t\t}\n\n\t\t}\n\n\t} else {\n\n\t\t// skinning weights assumed to be normalized for THREE.BufferGeometry\n\n\t}\n\n};\n\nTHREE.SkinnedMesh.prototype.updateMatrixWorld = function( force ) {\n\n\tTHREE.Mesh.prototype.updateMatrixWorld.call( this, true );\n\n\tif ( this.bindMode === \"attached\" ) {\n\n\t\tthis.bindMatrixInverse.getInverse( this.matrixWorld );\n\n\t} else if ( this.bindMode === \"detached\" ) {\n\n\t\tthis.bindMatrixInverse.getInverse( this.bindMatrix );\n\n\t} else {\n\n\t\tconsole.warn( 'THREE.SkinnedMesh unrecognized bindMode: ' + this.bindMode );\n\n\t}\n\n};\n\nTHREE.SkinnedMesh.prototype.clone = function() {\n\n\treturn new this.constructor( this.geometry, this.material, this.useVertexTexture ).copy( this );\n\n};\n\n// File:src/objects/MorphAnimMesh.js\n\n/**\n * @author alteredq / http://alteredqualia.com/\n */\n\nTHREE.MorphAnimMesh = function ( geometry, material ) {\n\n\tTHREE.Mesh.call( this, geometry, material );\n\n\tthis.type = 'MorphAnimMesh';\n\n\t// API\n\n\tthis.duration = 1000; // milliseconds\n\tthis.mirroredLoop = false;\n\tthis.time = 0;\n\n\t// internals\n\n\tthis.lastKeyframe = 0;\n\tthis.currentKeyframe = 0;\n\n\tthis.direction = 1;\n\tthis.directionBackwards = false;\n\n\tthis.setFrameRange( 0, geometry.morphTargets.length - 1 );\n\n};\n\nTHREE.MorphAnimMesh.prototype = Object.create( THREE.Mesh.prototype );\nTHREE.MorphAnimMesh.prototype.constructor = THREE.MorphAnimMesh;\n\nTHREE.MorphAnimMesh.prototype.setFrameRange = function ( start, end ) {\n\n\tthis.startKeyframe = start;\n\tthis.endKeyframe = end;\n\n\tthis.length = this.endKeyframe - this.startKeyframe + 1;\n\n};\n\nTHREE.MorphAnimMesh.prototype.setDirectionForward = function () {\n\n\tthis.direction = 1;\n\tthis.directionBackwards = false;\n\n};\n\nTHREE.MorphAnimMesh.prototype.setDirectionBackward = function () {\n\n\tthis.direction = - 1;\n\tthis.directionBackwards = true;\n\n};\n\nTHREE.MorphAnimMesh.prototype.parseAnimations = function () {\n\n\tvar geometry = this.geometry;\n\n\tif ( ! geometry.animations ) geometry.animations = {};\n\n\tvar firstAnimation, animations = geometry.animations;\n\n\tvar pattern = /([a-z]+)_?(\\d+)/;\n\n\tfor ( var i = 0, il = geometry.morphTargets.length; i < il; i ++ ) {\n\n\t\tvar morph = geometry.morphTargets[ i ];\n\t\tvar parts = morph.name.match( pattern );\n\n\t\tif ( parts && parts.length > 1 ) {\n\n\t\t\tvar label = parts[ 1 ];\n\n\t\t\tif ( ! animations[ label ] ) animations[ label ] = { start: Infinity, end: - Infinity };\n\n\t\t\tvar animation = animations[ label ];\n\n\t\t\tif ( i < animation.start ) animation.start = i;\n\t\t\tif ( i > animation.end ) animation.end = i;\n\n\t\t\tif ( ! firstAnimation ) firstAnimation = label;\n\n\t\t}\n\n\t}\n\n\tgeometry.firstAnimation = firstAnimation;\n\n};\n\nTHREE.MorphAnimMesh.prototype.setAnimationLabel = function ( label, start, end ) {\n\n\tif ( ! this.geometry.animations ) this.geometry.animations = {};\n\n\tthis.geometry.animations[ label ] = { start: start, end: end };\n\n};\n\nTHREE.MorphAnimMesh.prototype.playAnimation = function ( label, fps ) {\n\n\tvar animation = this.geometry.animations[ label ];\n\n\tif ( animation ) {\n\n\t\tthis.setFrameRange( animation.start, animation.end );\n\t\tthis.duration = 1000 * ( ( animation.end - animation.start ) / fps );\n\t\tthis.time = 0;\n\n\t} else {\n\n\t\tconsole.warn( 'THREE.MorphAnimMesh: animation[' + label + '] undefined in .playAnimation()' );\n\n\t}\n\n};\n\nTHREE.MorphAnimMesh.prototype.updateAnimation = function ( delta ) {\n\n\tvar frameTime = this.duration / this.length;\n\n\tthis.time += this.direction * delta;\n\n\tif ( this.mirroredLoop ) {\n\n\t\tif ( this.time > this.duration || this.time < 0 ) {\n\n\t\t\tthis.direction *= - 1;\n\n\t\t\tif ( this.time > this.duration ) {\n\n\t\t\t\tthis.time = this.duration;\n\t\t\t\tthis.directionBackwards = true;\n\n\t\t\t}\n\n\t\t\tif ( this.time < 0 ) {\n\n\t\t\t\tthis.time = 0;\n\t\t\t\tthis.directionBackwards = false;\n\n\t\t\t}\n\n\t\t}\n\n\t} else {\n\n\t\tthis.time = this.time % this.duration;\n\n\t\tif ( this.time < 0 ) this.time += this.duration;\n\n\t}\n\n\tvar keyframe = this.startKeyframe + THREE.Math.clamp( Math.floor( this.time / frameTime ), 0, this.length - 1 );\n\n\tvar influences = this.morphTargetInfluences;\n\n\tif ( keyframe !== this.currentKeyframe ) {\n\n\t\tinfluences[ this.lastKeyframe ] = 0;\n\t\tinfluences[ this.currentKeyframe ] = 1;\n\t\tinfluences[ keyframe ] = 0;\n\n\t\tthis.lastKeyframe = this.currentKeyframe;\n\t\tthis.currentKeyframe = keyframe;\n\n\t}\n\n\tvar mix = ( this.time % frameTime ) / frameTime;\n\n\tif ( this.directionBackwards ) {\n\n\t\tmix = 1 - mix;\n\n\t}\n\n\tinfluences[ this.currentKeyframe ] = mix;\n\tinfluences[ this.lastKeyframe ] = 1 - mix;\n\n};\n\nTHREE.MorphAnimMesh.prototype.interpolateTargets = function ( a, b, t ) {\n\n\tvar influences = this.morphTargetInfluences;\n\n\tfor ( var i = 0, l = influences.length; i < l; i ++ ) {\n\n\t\tinfluences[ i ] = 0;\n\n\t}\n\n\tif ( a > - 1 ) influences[ a ] = 1 - t;\n\tif ( b > - 1 ) influences[ b ] = t;\n\n};\n\nTHREE.MorphAnimMesh.prototype.copy = function ( source ) {\n\n\tTHREE.Mesh.prototype.copy.call( this, source );\n\n\tthis.duration = source.duration;\n\tthis.mirroredLoop = source.mirroredLoop;\n\tthis.time = source.time;\n\n\tthis.lastKeyframe = source.lastKeyframe;\n\tthis.currentKeyframe = source.currentKeyframe;\n\n\tthis.direction = source.direction;\n\tthis.directionBackwards = source.directionBackwards;\n\n\treturn this;\n\n};\n\n// File:src/objects/LOD.js\n\n/**\n * @author mikael emtinger / http://gomo.se/\n * @author alteredq / http://alteredqualia.com/\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.LOD = function () {\n\n\tTHREE.Object3D.call( this );\n\n\tthis.type = 'LOD';\n\n\tObject.defineProperties( this, {\n\t\tlevels: {\n\t\t\tenumerable: true,\n\t\t\tvalue: []\n\t\t},\n\t\tobjects: {\n\t\t\tget: function () {\n\n\t\t\t\tconsole.warn( 'THREE.LOD: .objects has been renamed to .levels.' );\n\t\t\t\treturn this.levels;\n\n\t\t\t}\n\t\t}\n\t} );\n\n};\n\n\nTHREE.LOD.prototype = Object.create( THREE.Object3D.prototype );\nTHREE.LOD.prototype.constructor = THREE.LOD;\n\nTHREE.LOD.prototype.addLevel = function ( object, distance ) {\n\n\tif ( distance === undefined ) distance = 0;\n\n\tdistance = Math.abs( distance );\n\n\tvar levels = this.levels;\n\n\tfor ( var l = 0; l < levels.length; l ++ ) {\n\n\t\tif ( distance < levels[ l ].distance ) {\n\n\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\tlevels.splice( l, 0, { distance: distance, object: object } );\n\n\tthis.add( object );\n\n};\n\nTHREE.LOD.prototype.getObjectForDistance = function ( distance ) {\n\n\tvar levels = this.levels;\n\n\tfor ( var i = 1, l = levels.length; i < l; i ++ ) {\n\n\t\tif ( distance < levels[ i ].distance ) {\n\n\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\treturn levels[ i - 1 ].object;\n\n};\n\nTHREE.LOD.prototype.raycast = ( function () {\n\n\tvar matrixPosition = new THREE.Vector3();\n\n\treturn function raycast( raycaster, intersects ) {\n\n\t\tmatrixPosition.setFromMatrixPosition( this.matrixWorld );\n\n\t\tvar distance = raycaster.ray.origin.distanceTo( matrixPosition );\n\n\t\tthis.getObjectForDistance( distance ).raycast( raycaster, intersects );\n\n\t};\n\n}() );\n\nTHREE.LOD.prototype.update = function () {\n\n\tvar v1 = new THREE.Vector3();\n\tvar v2 = new THREE.Vector3();\n\n\treturn function update( camera ) {\n\n\t\tvar levels = this.levels;\n\n\t\tif ( levels.length > 1 ) {\n\n\t\t\tv1.setFromMatrixPosition( camera.matrixWorld );\n\t\t\tv2.setFromMatrixPosition( this.matrixWorld );\n\n\t\t\tvar distance = v1.distanceTo( v2 );\n\n\t\t\tlevels[ 0 ].object.visible = true;\n\n\t\t\tfor ( var i = 1, l = levels.length; i < l; i ++ ) {\n\n\t\t\t\tif ( distance >= levels[ i ].distance ) {\n\n\t\t\t\t\tlevels[ i - 1 ].object.visible = false;\n\t\t\t\t\tlevels[ i ].object.visible = true;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tfor ( ; i < l; i ++ ) {\n\n\t\t\t\tlevels[ i ].object.visible = false;\n\n\t\t\t}\n\n\t\t}\n\n\t};\n\n}();\n\nTHREE.LOD.prototype.copy = function ( source ) {\n\n\tTHREE.Object3D.prototype.copy.call( this, source, false );\n\n\tvar levels = source.levels;\n\n\tfor ( var i = 0, l = levels.length; i < l; i ++ ) {\n\n\t\tvar level = levels[ i ];\n\n\t\tthis.addLevel( level.object.clone(), level.distance );\n\n\t}\n\n\treturn this;\n\n};\n\nTHREE.LOD.prototype.toJSON = function ( meta ) {\n\n\tvar data = THREE.Object3D.prototype.toJSON.call( this, meta );\n\n\tdata.object.levels = [];\n\n\tvar levels = this.levels;\n\n\tfor ( var i = 0, l = levels.length; i < l; i ++ ) {\n\n\t\tvar level = levels[ i ];\n\n\t\tdata.object.levels.push( {\n\t\t\tobject: level.object.uuid,\n\t\t\tdistance: level.distance\n\t\t} );\n\n\t}\n\n\treturn data;\n\n};\n\n// File:src/objects/Sprite.js\n\n/**\n * @author mikael emtinger / http://gomo.se/\n * @author alteredq / http://alteredqualia.com/\n */\n\nTHREE.Sprite = ( function () {\n\n\tvar indices = new Uint16Array( [ 0, 1, 2,  0, 2, 3 ] );\n\tvar vertices = new Float32Array( [ - 0.5, - 0.5, 0,   0.5, - 0.5, 0,   0.5, 0.5, 0,   - 0.5, 0.5, 0 ] );\n\tvar uvs = new Float32Array( [ 0, 0,   1, 0,   1, 1,   0, 1 ] );\n\n\tvar geometry = new THREE.BufferGeometry();\n\tgeometry.setIndex( new THREE.BufferAttribute( indices, 1 ) );\n\tgeometry.addAttribute( 'position', new THREE.BufferAttribute( vertices, 3 ) );\n\tgeometry.addAttribute( 'uv', new THREE.BufferAttribute( uvs, 2 ) );\n\n\treturn function Sprite( material ) {\n\n\t\tTHREE.Object3D.call( this );\n\n\t\tthis.type = 'Sprite';\n\n\t\tthis.geometry = geometry;\n\t\tthis.material = ( material !== undefined ) ? material : new THREE.SpriteMaterial();\n\n\t};\n\n} )();\n\nTHREE.Sprite.prototype = Object.create( THREE.Object3D.prototype );\nTHREE.Sprite.prototype.constructor = THREE.Sprite;\n\nTHREE.Sprite.prototype.raycast = ( function () {\n\n\tvar matrixPosition = new THREE.Vector3();\n\n\treturn function raycast( raycaster, intersects ) {\n\n\t\tmatrixPosition.setFromMatrixPosition( this.matrixWorld );\n\n\t\tvar distanceSq = raycaster.ray.distanceSqToPoint( matrixPosition );\n\t\tvar guessSizeSq = this.scale.x * this.scale.y;\n\n\t\tif ( distanceSq > guessSizeSq ) {\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tintersects.push( {\n\n\t\t\tdistance: Math.sqrt( distanceSq ),\n\t\t\tpoint: this.position,\n\t\t\tface: null,\n\t\t\tobject: this\n\n\t\t} );\n\n\t};\n\n}() );\n\nTHREE.Sprite.prototype.clone = function () {\n\n\treturn new this.constructor( this.material ).copy( this );\n\n};\n\nTHREE.Sprite.prototype.toJSON = function ( meta ) {\n\n\tvar data = THREE.Object3D.prototype.toJSON.call( this, meta );\n\n\t// only serialize if not in meta materials cache\n\tif ( meta.materials[ this.material.uuid ] === undefined ) {\n\n\t\tmeta.materials[ this.material.uuid ] = this.material.toJSON();\n\n\t}\n\n\tdata.object.material = this.material.uuid;\n\n\treturn data;\n\n};\n\n// Backwards compatibility\n\nTHREE.Particle = THREE.Sprite;\n\n// File:src/objects/LensFlare.js\n\n/**\n * @author mikael emtinger / http://gomo.se/\n * @author alteredq / http://alteredqualia.com/\n */\n\nTHREE.LensFlare = function ( texture, size, distance, blending, color ) {\n\n\tTHREE.Object3D.call( this );\n\n\tthis.lensFlares = [];\n\n\tthis.positionScreen = new THREE.Vector3();\n\tthis.customUpdateCallback = undefined;\n\n\tif ( texture !== undefined ) {\n\n\t\tthis.add( texture, size, distance, blending, color );\n\n\t}\n\n};\n\nTHREE.LensFlare.prototype = Object.create( THREE.Object3D.prototype );\nTHREE.LensFlare.prototype.constructor = THREE.LensFlare;\n\n\n/*\n * Add: adds another flare\n */\n\nTHREE.LensFlare.prototype.add = function ( texture, size, distance, blending, color, opacity ) {\n\n\tif ( size === undefined ) size = - 1;\n\tif ( distance === undefined ) distance = 0;\n\tif ( opacity === undefined ) opacity = 1;\n\tif ( color === undefined ) color = new THREE.Color( 0xffffff );\n\tif ( blending === undefined ) blending = THREE.NormalBlending;\n\n\tdistance = Math.min( distance, Math.max( 0, distance ) );\n\n\tthis.lensFlares.push( {\n\t\ttexture: texture,\t// THREE.Texture\n\t\tsize: size, \t\t// size in pixels (-1 = use texture.width)\n\t\tdistance: distance, \t// distance (0-1) from light source (0=at light source)\n\t\tx: 0, y: 0, z: 0,\t// screen position (-1 => 1) z = 0 is in front z = 1 is back\n\t\tscale: 1, \t\t// scale\n\t\trotation: 0, \t\t// rotation\n\t\topacity: opacity,\t// opacity\n\t\tcolor: color,\t\t// color\n\t\tblending: blending\t// blending\n\t} );\n\n};\n\n/*\n * Update lens flares update positions on all flares based on the screen position\n * Set myLensFlare.customUpdateCallback to alter the flares in your project specific way.\n */\n\nTHREE.LensFlare.prototype.updateLensFlares = function () {\n\n\tvar f, fl = this.lensFlares.length;\n\tvar flare;\n\tvar vecX = - this.positionScreen.x * 2;\n\tvar vecY = - this.positionScreen.y * 2;\n\n\tfor ( f = 0; f < fl; f ++ ) {\n\n\t\tflare = this.lensFlares[ f ];\n\n\t\tflare.x = this.positionScreen.x + vecX * flare.distance;\n\t\tflare.y = this.positionScreen.y + vecY * flare.distance;\n\n\t\tflare.wantedRotation = flare.x * Math.PI * 0.25;\n\t\tflare.rotation += ( flare.wantedRotation - flare.rotation ) * 0.25;\n\n\t}\n\n};\n\nTHREE.LensFlare.prototype.copy = function ( source ) {\n\n\tTHREE.Object3D.prototype.copy.call( this, source );\n\n\tthis.positionScreen.copy( source.positionScreen );\n\tthis.customUpdateCallback = source.customUpdateCallback;\n\n\tfor ( var i = 0, l = source.lensFlares.length; i < l; i ++ ) {\n\n\t\tthis.lensFlares.push( source.lensFlares[ i ] );\n\n\t}\n\n\treturn this;\n\n};\n\n// File:src/scenes/Scene.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.Scene = function () {\n\n\tTHREE.Object3D.call( this );\n\n\tthis.type = 'Scene';\n\n\tthis.fog = null;\n\tthis.overrideMaterial = null;\n\n\tthis.autoUpdate = true; // checked by the renderer\n\n};\n\nTHREE.Scene.prototype = Object.create( THREE.Object3D.prototype );\nTHREE.Scene.prototype.constructor = THREE.Scene;\n\nTHREE.Scene.prototype.copy = function ( source ) {\n\n\tTHREE.Object3D.prototype.copy.call( this, source );\n\n\tif ( source.fog !== null ) this.fog = source.fog.clone();\n\tif ( source.overrideMaterial !== null ) this.overrideMaterial = source.overrideMaterial.clone();\n\n\tthis.autoUpdate = source.autoUpdate;\n\tthis.matrixAutoUpdate = source.matrixAutoUpdate;\n\n\treturn this;\n\n};\n\n// File:src/scenes/Fog.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n * @author alteredq / http://alteredqualia.com/\n */\n\nTHREE.Fog = function ( color, near, far ) {\n\n\tthis.name = '';\n\n\tthis.color = new THREE.Color( color );\n\n\tthis.near = ( near !== undefined ) ? near : 1;\n\tthis.far = ( far !== undefined ) ? far : 1000;\n\n};\n\nTHREE.Fog.prototype.clone = function () {\n\n\treturn new THREE.Fog( this.color.getHex(), this.near, this.far );\n\n};\n\n// File:src/scenes/FogExp2.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n * @author alteredq / http://alteredqualia.com/\n */\n\nTHREE.FogExp2 = function ( color, density ) {\n\n\tthis.name = '';\n\n\tthis.color = new THREE.Color( color );\n\tthis.density = ( density !== undefined ) ? density : 0.00025;\n\n};\n\nTHREE.FogExp2.prototype.clone = function () {\n\n\treturn new THREE.FogExp2( this.color.getHex(), this.density );\n\n};\n\n// File:src/renderers/shaders/ShaderChunk.js\n\nTHREE.ShaderChunk = {};\n\n// File:src/renderers/shaders/ShaderChunk/alphamap_fragment.glsl\n\nTHREE.ShaderChunk[ 'alphamap_fragment'] = \"#ifdef USE_ALPHAMAP\\n\\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\\n\\n#endif\\n\";\n\n// File:src/renderers/shaders/ShaderChunk/alphamap_pars_fragment.glsl\n\nTHREE.ShaderChunk[ 'alphamap_pars_fragment'] = \"#ifdef USE_ALPHAMAP\\n\\n\tuniform sampler2D alphaMap;\\n\\n#endif\\n\";\n\n// File:src/renderers/shaders/ShaderChunk/alphatest_fragment.glsl\n\nTHREE.ShaderChunk[ 'alphatest_fragment'] = \"#ifdef ALPHATEST\\n\\n\tif ( diffuseColor.a < ALPHATEST ) discard;\\n\\n#endif\\n\";\n\n// File:src/renderers/shaders/ShaderChunk/aomap_fragment.glsl\n\nTHREE.ShaderChunk[ 'aomap_fragment'] = \"#ifdef USE_AOMAP\\n\\n\ttotalAmbientLight *= ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\\n\\n#endif\\n\";\n\n// File:src/renderers/shaders/ShaderChunk/aomap_pars_fragment.glsl\n\nTHREE.ShaderChunk[ 'aomap_pars_fragment'] = \"#ifdef USE_AOMAP\\n\\n\tuniform sampler2D aoMap;\\n\tuniform float aoMapIntensity;\\n\\n#endif\";\n\n// File:src/renderers/shaders/ShaderChunk/begin_vertex.glsl\n\nTHREE.ShaderChunk[ 'begin_vertex'] = \"\\nvec3 transformed = vec3( position );\\n\";\n\n// File:src/renderers/shaders/ShaderChunk/beginnormal_vertex.glsl\n\nTHREE.ShaderChunk[ 'beginnormal_vertex'] = \"\\nvec3 objectNormal = vec3( normal );\\n\";\n\n// File:src/renderers/shaders/ShaderChunk/bumpmap_pars_fragment.glsl\n\nTHREE.ShaderChunk[ 'bumpmap_pars_fragment'] = \"#ifdef USE_BUMPMAP\\n\\n\tuniform sampler2D bumpMap;\\n\tuniform float bumpScale;\\n\\n\t// Derivative maps - bump mapping unparametrized surfaces by Morten Mikkelsen\\n\t// http://mmikkelsen3d.blogspot.sk/2011/07/derivative-maps.html\\n\\n\t// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)\\n\\n\tvec2 dHdxy_fwd() {\\n\\n\t\tvec2 dSTdx = dFdx( vUv );\\n\t\tvec2 dSTdy = dFdy( vUv );\\n\\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\\n\\n\t\treturn vec2( dBx, dBy );\\n\\n\t}\\n\\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\\n\\n\t\tvec3 vSigmaX = dFdx( surf_pos );\\n\t\tvec3 vSigmaY = dFdy( surf_pos );\\n\t\tvec3 vN = surf_norm;\t\t// normalized\\n\\n\t\tvec3 R1 = cross( vSigmaY, vN );\\n\t\tvec3 R2 = cross( vN, vSigmaX );\\n\\n\t\tfloat fDet = dot( vSigmaX, R1 );\\n\\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\\n\\n\t}\\n\\n#endif\\n\";\n\n// File:src/renderers/shaders/ShaderChunk/color_fragment.glsl\n\nTHREE.ShaderChunk[ 'color_fragment'] = \"#ifdef USE_COLOR\\n\\n\tdiffuseColor.rgb *= vColor;\\n\\n#endif\";\n\n// File:src/renderers/shaders/ShaderChunk/color_pars_fragment.glsl\n\nTHREE.ShaderChunk[ 'color_pars_fragment'] = \"#ifdef USE_COLOR\\n\\n\tvarying vec3 vColor;\\n\\n#endif\\n\";\n\n// File:src/renderers/shaders/ShaderChunk/color_pars_vertex.glsl\n\nTHREE.ShaderChunk[ 'color_pars_vertex'] = \"#ifdef USE_COLOR\\n\\n\tvarying vec3 vColor;\\n\\n#endif\";\n\n// File:src/renderers/shaders/ShaderChunk/color_vertex.glsl\n\nTHREE.ShaderChunk[ 'color_vertex'] = \"#ifdef USE_COLOR\\n\\n\tvColor.xyz = color.xyz;\\n\\n#endif\";\n\n// File:src/renderers/shaders/ShaderChunk/common.glsl\n\nTHREE.ShaderChunk[ 'common'] = \"#define PI 3.14159\\n#define PI2 6.28318\\n#define RECIPROCAL_PI2 0.15915494\\n#define LOG2 1.442695\\n#define EPSILON 1e-6\\n\\n#define saturate(a) clamp( a, 0.0, 1.0 )\\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\\n\\nvec3 transformDirection( in vec3 normal, in mat4 matrix ) {\\n\\n\treturn normalize( ( matrix * vec4( normal, 0.0 ) ).xyz );\\n\\n}\\n\\n// http://en.wikibooks.org/wiki/GLSL_Programming/Applying_Matrix_Transformations\\nvec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {\\n\\n\treturn normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );\\n\\n}\\n\\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\\n\\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\\n\\n\treturn - distance * planeNormal + point;\\n\\n}\\n\\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\\n\\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\\n\\n}\\n\\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\\n\\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\\n\\n}\\n\\nfloat calcLightAttenuation( float lightDistance, float cutoffDistance, float decayExponent ) {\\n\\n\tif ( decayExponent > 0.0 ) {\\n\\n\t  return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\\n\\n\t}\\n\\n\treturn 1.0;\\n\\n}\\n\\nvec3 F_Schlick( in vec3 specularColor, in float dotLH ) {\\n\\n\t// Original approximation by Christophe Schlick '94\\n\t//;float fresnel = pow( 1.0 - dotLH, 5.0 );\\n\\n\t// Optimized variant (presented by Epic at SIGGRAPH '13)\\n\tfloat fresnel = exp2( ( -5.55437 * dotLH - 6.98316 ) * dotLH );\\n\\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\\n\\n}\\n\\nfloat G_BlinnPhong_Implicit( /* in float dotNL, in float dotNV */ ) {\\n\\n\t// geometry term is (nl)(nv) / 4(nl)(nv)\\n\\n\treturn 0.25;\\n\\n}\\n\\nfloat D_BlinnPhong( in float shininess, in float dotNH ) {\\n\\n\t// factor of 1/PI in distribution term omitted\\n\\n\treturn ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\\n\\n}\\n\\nvec3 BRDF_BlinnPhong( in vec3 specularColor, in float shininess, in vec3 normal, in vec3 lightDir, in vec3 viewDir ) {\\n\\n\tvec3 halfDir = normalize( lightDir + viewDir );\\n\\n\t//float dotNL = saturate( dot( normal, lightDir ) );\\n\t//float dotNV = saturate( dot( normal, viewDir ) );\\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\\n\tfloat dotLH = saturate( dot( lightDir, halfDir ) );\\n\\n\tvec3 F = F_Schlick( specularColor, dotLH );\\n\\n\tfloat G = G_BlinnPhong_Implicit( /* dotNL, dotNV */ );\\n\\n\tfloat D = D_BlinnPhong( shininess, dotNH );\\n\\n\treturn F * G * D;\\n\\n}\\n\\nvec3 inputToLinear( in vec3 a ) {\\n\\n\t#ifdef GAMMA_INPUT\\n\\n\t\treturn pow( a, vec3( float( GAMMA_FACTOR ) ) );\\n\\n\t#else\\n\\n\t\treturn a;\\n\\n\t#endif\\n\\n}\\n\\nvec3 linearToOutput( in vec3 a ) {\\n\\n\t#ifdef GAMMA_OUTPUT\\n\\n\t\treturn pow( a, vec3( 1.0 / float( GAMMA_FACTOR ) ) );\\n\\n\t#else\\n\\n\t\treturn a;\\n\\n\t#endif\\n\\n}\\n\";\n\n// File:src/renderers/shaders/ShaderChunk/defaultnormal_vertex.glsl\n\nTHREE.ShaderChunk[ 'defaultnormal_vertex'] = \"#ifdef FLIP_SIDED\\n\\n\tobjectNormal = -objectNormal;\\n\\n#endif\\n\\nvec3 transformedNormal = normalMatrix * objectNormal;\\n\";\n\n// File:src/renderers/shaders/ShaderChunk/displacementmap_vertex.glsl\n\nTHREE.ShaderChunk[ 'displacementmap_vertex'] = \"#ifdef USE_DISPLACEMENTMAP\\n\\n\ttransformed += normal * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\\n\\n#endif\\n\";\n\n// File:src/renderers/shaders/ShaderChunk/displacementmap_pars_vertex.glsl\n\nTHREE.ShaderChunk[ 'displacementmap_pars_vertex'] = \"#ifdef USE_DISPLACEMENTMAP\\n\\n\tuniform sampler2D displacementMap;\\n\tuniform float displacementScale;\\n\tuniform float displacementBias;\\n\\n#endif\\n\";\n\n// File:src/renderers/shaders/ShaderChunk/emissivemap_fragment.glsl\n\nTHREE.ShaderChunk[ 'emissivemap_fragment'] = \"#ifdef USE_EMISSIVEMAP\\n\\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\\n\\n\temissiveColor.rgb = inputToLinear( emissiveColor.rgb );\\n\\n\ttotalEmissiveLight *= emissiveColor.rgb;\\n\\n#endif\\n\";\n\n// File:src/renderers/shaders/ShaderChunk/emissivemap_pars_fragment.glsl\n\nTHREE.ShaderChunk[ 'emissivemap_pars_fragment'] = \"#ifdef USE_EMISSIVEMAP\\n\\n\tuniform sampler2D emissiveMap;\\n\\n#endif\\n\";\n\n// File:src/renderers/shaders/ShaderChunk/envmap_fragment.glsl\n\nTHREE.ShaderChunk[ 'envmap_fragment'] = \"#ifdef USE_ENVMAP\\n\\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\\n\\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\\n\\n\t\t// Transforming Normal Vectors with the Inverse Transformation\\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\\n\\n\t\t#ifdef ENVMAP_MODE_REFLECTION\\n\\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\\n\\n\t\t#else\\n\\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\\n\\n\t\t#endif\\n\\n\t#else\\n\\n\t\tvec3 reflectVec = vReflect;\\n\\n\t#endif\\n\\n\t#ifdef DOUBLE_SIDED\\n\t\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\\n\t#else\\n\t\tfloat flipNormal = 1.0;\\n\t#endif\\n\\n\t#ifdef ENVMAP_TYPE_CUBE\\n\t\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\\n\\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\\n\t\tvec2 sampleUV;\\n\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\\n\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\\n\\n\t#elif defined( ENVMAP_TYPE_SPHERE )\\n\t\tvec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\\n\t#endif\\n\\n\tenvColor.xyz = inputToLinear( envColor.xyz );\\n\\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\\n\\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\\n\\n\t#elif defined( ENVMAP_BLENDING_MIX )\\n\\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\\n\\n\t#elif defined( ENVMAP_BLENDING_ADD )\\n\\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\\n\\n\t#endif\\n\\n#endif\\n\";\n\n// File:src/renderers/shaders/ShaderChunk/envmap_pars_fragment.glsl\n\nTHREE.ShaderChunk[ 'envmap_pars_fragment'] = \"#ifdef USE_ENVMAP\\n\\n\tuniform float reflectivity;\\n\t#ifdef ENVMAP_TYPE_CUBE\\n\t\tuniform samplerCube envMap;\\n\t#else\\n\t\tuniform sampler2D envMap;\\n\t#endif\\n\tuniform float flipEnvMap;\\n\\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\\n\\n\t\tuniform float refractionRatio;\\n\\n\t#else\\n\\n\t\tvarying vec3 vReflect;\\n\\n\t#endif\\n\\n#endif\\n\";\n\n// File:src/renderers/shaders/ShaderChunk/envmap_pars_vertex.glsl\n\nTHREE.ShaderChunk[ 'envmap_pars_vertex'] = \"#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\\n\\n\tvarying vec3 vReflect;\\n\\n\tuniform float refractionRatio;\\n\\n#endif\\n\";\n\n// File:src/renderers/shaders/ShaderChunk/envmap_vertex.glsl\n\nTHREE.ShaderChunk[ 'envmap_vertex'] = \"#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\\n\\n\tvec3 worldNormal = transformDirection( objectNormal, modelMatrix );\\n\\n\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\\n\\n\t#ifdef ENVMAP_MODE_REFLECTION\\n\\n\t\tvReflect = reflect( cameraToVertex, worldNormal );\\n\\n\t#else\\n\\n\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\\n\\n\t#endif\\n\\n#endif\\n\";\n\n// File:src/renderers/shaders/ShaderChunk/fog_fragment.glsl\n\nTHREE.ShaderChunk[ 'fog_fragment'] = \"#ifdef USE_FOG\\n\\n\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\\n\\n\t#else\\n\\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\\n\\n\t#endif\\n\\n\t#ifdef FOG_EXP2\\n\\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * depth * depth * LOG2 ) );\\n\\n\t#else\\n\\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, depth );\\n\\n\t#endif\\n\t\\n\toutgoingLight = mix( outgoingLight, fogColor, fogFactor );\\n\\n#endif\";\n\n// File:src/renderers/shaders/ShaderChunk/fog_pars_fragment.glsl\n\nTHREE.ShaderChunk[ 'fog_pars_fragment'] = \"#ifdef USE_FOG\\n\\n\tuniform vec3 fogColor;\\n\\n\t#ifdef FOG_EXP2\\n\\n\t\tuniform float fogDensity;\\n\\n\t#else\\n\\n\t\tuniform float fogNear;\\n\t\tuniform float fogFar;\\n\t#endif\\n\\n#endif\";\n\n// File:src/renderers/shaders/ShaderChunk/lightmap_fragment.glsl\n\nTHREE.ShaderChunk[ 'lightmap_fragment'] = \"#ifdef USE_LIGHTMAP\\n\\n\ttotalAmbientLight += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\\n\\n#endif\\n\";\n\n// File:src/renderers/shaders/ShaderChunk/lightmap_pars_fragment.glsl\n\nTHREE.ShaderChunk[ 'lightmap_pars_fragment'] = \"#ifdef USE_LIGHTMAP\\n\\n\tuniform sampler2D lightMap;\\n\tuniform float lightMapIntensity;\\n\\n#endif\";\n\n// File:src/renderers/shaders/ShaderChunk/lights_lambert_pars_vertex.glsl\n\nTHREE.ShaderChunk[ 'lights_lambert_pars_vertex'] = \"uniform vec3 ambientLightColor;\\n\\n#if MAX_DIR_LIGHTS > 0\\n\\n\tuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\\n\tuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_HEMI_LIGHTS > 0\\n\\n\tuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\\n\tuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\\n\tuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_POINT_LIGHTS > 0\\n\\n\tuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\\n\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\\n\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\\n\tuniform float pointLightDecay[ MAX_POINT_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0\\n\\n\tuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\\n\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\\n\tuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\\n\\n#endif\\n\";\n\n// File:src/renderers/shaders/ShaderChunk/lights_lambert_vertex.glsl\n\nTHREE.ShaderChunk[ 'lights_lambert_vertex'] = \"vLightFront = vec3( 0.0 );\\n\\n#ifdef DOUBLE_SIDED\\n\\n\tvLightBack = vec3( 0.0 );\\n\\n#endif\\n\\nvec3 normal = normalize( transformedNormal );\\n\\n#if MAX_POINT_LIGHTS > 0\\n\\n\tfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\\n\\n\t\tvec3 lightColor = pointLightColor[ i ];\\n\\n\t\tvec3 lVector = pointLightPosition[ i ] - mvPosition.xyz;\\n\t\tvec3 lightDir = normalize( lVector );\\n\\n\t\t// attenuation\\n\\n\t\tfloat attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\\n\\n\t\t// diffuse\\n\\n\t\tfloat dotProduct = dot( normal, lightDir );\\n\\n\t\tvLightFront += lightColor * attenuation * saturate( dotProduct );\\n\\n\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\tvLightBack += lightColor * attenuation * saturate( - dotProduct );\\n\\n\t\t#endif\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0\\n\\n\tfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\\n\\n\t\tvec3 lightColor = spotLightColor[ i ];\\n\\n\t\tvec3 lightPosition = spotLightPosition[ i ];\\n\t\tvec3 lVector = lightPosition - mvPosition.xyz;\\n\t\tvec3 lightDir = normalize( lVector );\\n\\n\t\tfloat spotEffect = dot( spotLightDirection[ i ], lightDir );\\n\\n\t\tif ( spotEffect > spotLightAngleCos[ i ] ) {\\n\\n\t\t\tspotEffect = saturate( pow( saturate( spotEffect ), spotLightExponent[ i ] ) );\\n\\n\t\t\t// attenuation\\n\\n\t\t\tfloat attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\\n\\n\t\t\tattenuation *= spotEffect;\\n\\n\t\t\t// diffuse\\n\\n\t\t\tfloat dotProduct = dot( normal, lightDir );\\n\\n\t\t\tvLightFront += lightColor * attenuation * saturate( dotProduct );\\n\\n\t\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\t\tvLightBack += lightColor * attenuation * saturate( - dotProduct );\\n\\n\t\t\t#endif\\n\\n\t\t}\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_DIR_LIGHTS > 0\\n\\n\tfor ( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\\n\\n\t\tvec3 lightColor = directionalLightColor[ i ];\\n\\n\t\tvec3 lightDir = directionalLightDirection[ i ];\\n\\n\t\t// diffuse\\n\\n\t\tfloat dotProduct = dot( normal, lightDir );\\n\\n\t\tvLightFront += lightColor * saturate( dotProduct );\\n\\n\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\tvLightBack += lightColor * saturate( - dotProduct );\\n\\n\t\t#endif\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_HEMI_LIGHTS > 0\\n\\n\tfor ( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\\n\\n\t\tvec3 lightDir = hemisphereLightDirection[ i ];\\n\\n\t\t// diffuse\\n\\n\t\tfloat dotProduct = dot( normal, lightDir );\\n\\n\t\tfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\\n\\n\t\tvLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\\n\\n\t\t#ifdef DOUBLE_SIDED\\n\\n\t\t\tfloat hemiDiffuseWeightBack = - 0.5 * dotProduct + 0.5;\\n\\n\t\t\tvLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );\\n\\n\t\t#endif\\n\\n\t}\\n\\n#endif\\n\\nvLightFront += ambientLightColor;\\n\\n#ifdef DOUBLE_SIDED\\n\\n\tvLightBack += ambientLightColor;\\n\\n#endif\\n\";\n\n// File:src/renderers/shaders/ShaderChunk/lights_phong_fragment.glsl\n\nTHREE.ShaderChunk[ 'lights_phong_fragment'] = \"#ifndef FLAT_SHADED\\n\\n\tvec3 normal = normalize( vNormal );\\n\\n\t#ifdef DOUBLE_SIDED\\n\\n\t\tnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\\n\\n\t#endif\\n\\n#else\\n\\n\tvec3 fdx = dFdx( vViewPosition );\\n\tvec3 fdy = dFdy( vViewPosition );\\n\tvec3 normal = normalize( cross( fdx, fdy ) );\\n\\n#endif\\n\\n#ifdef USE_NORMALMAP\\n\\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\\n\\n#elif defined( USE_BUMPMAP )\\n\\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\\n\\n#endif\\n\\nvec3 viewDir = normalize( vViewPosition );\\n\\nvec3 totalDiffuseLight = vec3( 0.0 );\\nvec3 totalSpecularLight = vec3( 0.0 );\\n\\n#if MAX_POINT_LIGHTS > 0\\n\\n\tfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\\n\\n\t\tvec3 lightColor = pointLightColor[ i ];\\n\\n\t\tvec3 lightPosition = pointLightPosition[ i ];\\n\t\tvec3 lVector = lightPosition + vViewPosition.xyz;\\n\t\tvec3 lightDir = normalize( lVector );\\n\\n\t\t// attenuation\\n\\n\t\tfloat attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\\n\\n\t\t// diffuse\\n\\n\t\tfloat cosineTerm = saturate( dot( normal, lightDir ) );\\n\\n\t\ttotalDiffuseLight += lightColor * attenuation * cosineTerm;\\n\\n\t\t// specular\\n\\n\t\tvec3 brdf = BRDF_BlinnPhong( specular, shininess, normal, lightDir, viewDir );\\n\\n\t\ttotalSpecularLight += brdf * specularStrength * lightColor * attenuation * cosineTerm;\\n\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0\\n\\n\tfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\\n\\n\t\tvec3 lightColor = spotLightColor[ i ];\\n\\n\t\tvec3 lightPosition = spotLightPosition[ i ];\\n\t\tvec3 lVector = lightPosition + vViewPosition.xyz;\\n\t\tvec3 lightDir = normalize( lVector );\\n\\n\t\tfloat spotEffect = dot( spotLightDirection[ i ], lightDir );\\n\\n\t\tif ( spotEffect > spotLightAngleCos[ i ] ) {\\n\\n\t\t\tspotEffect = saturate( pow( saturate( spotEffect ), spotLightExponent[ i ] ) );\\n\\n\t\t\t// attenuation\\n\\n\t\t\tfloat attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\\n\\n\t\t\tattenuation *= spotEffect;\\n\\n\t\t\t// diffuse\\n\\n\t\t\tfloat cosineTerm = saturate( dot( normal, lightDir ) );\\n\\n\t\t\ttotalDiffuseLight += lightColor * attenuation * cosineTerm;\\n\\n\t\t\t// specular\\n\\n\t\t\tvec3 brdf = BRDF_BlinnPhong( specular, shininess, normal, lightDir, viewDir );\\n\\n\t\t\ttotalSpecularLight += brdf * specularStrength * lightColor * attenuation * cosineTerm;\\n\\n\t\t}\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_DIR_LIGHTS > 0\\n\\n\tfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\\n\\n\t\tvec3 lightColor = directionalLightColor[ i ];\\n\\n\t\tvec3 lightDir = directionalLightDirection[ i ];\\n\\n\t\t// diffuse\\n\\n\t\tfloat cosineTerm = saturate( dot( normal, lightDir ) );\\n\\n\t\ttotalDiffuseLight += lightColor * cosineTerm;\\n\\n\t\t// specular\\n\\n\t\tvec3 brdf = BRDF_BlinnPhong( specular, shininess, normal, lightDir, viewDir );\\n\\n\t\ttotalSpecularLight += brdf * specularStrength * lightColor * cosineTerm;\\n\\n\t}\\n\\n#endif\\n\\n#if MAX_HEMI_LIGHTS > 0\\n\\n\tfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\\n\\n\t\tvec3 lightDir = hemisphereLightDirection[ i ];\\n\\n\t\t// diffuse\\n\\n\t\tfloat dotProduct = dot( normal, lightDir );\\n\\n\t\tfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\\n\\n\t\tvec3 lightColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\\n\\n\t\ttotalDiffuseLight += lightColor;\\n\\n\t\t// specular (sky term only)\\n\\n\t\tvec3 brdf = BRDF_BlinnPhong( specular, shininess, normal, lightDir, viewDir );\\n\\n\t\ttotalSpecularLight += brdf * specularStrength * lightColor * max( dotProduct, 0.0 );\\n\\n\t}\\n\\n#endif\\n\\n#ifdef METAL\\n\\n\toutgoingLight += diffuseColor.rgb * ( totalDiffuseLight + totalAmbientLight ) * specular + totalSpecularLight + totalEmissiveLight;\\n\\n#else\\n\\n\toutgoingLight += diffuseColor.rgb * ( totalDiffuseLight + totalAmbientLight ) + totalSpecularLight + totalEmissiveLight;\\n\\n#endif\\n\";\n\n// File:src/renderers/shaders/ShaderChunk/lights_phong_pars_fragment.glsl\n\nTHREE.ShaderChunk[ 'lights_phong_pars_fragment'] = \"uniform vec3 ambientLightColor;\\n\\n#if MAX_DIR_LIGHTS > 0\\n\\n\tuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\\n\tuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_HEMI_LIGHTS > 0\\n\\n\tuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\\n\tuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\\n\tuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_POINT_LIGHTS > 0\\n\\n\tuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\\n\\n\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\\n\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\\n\tuniform float pointLightDecay[ MAX_POINT_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0\\n\\n\tuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\\n\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\\n\tuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\\n\tuniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\\n\\n#endif\\n\\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_ENVMAP )\\n\\n\tvarying vec3 vWorldPosition;\\n\\n#endif\\n\\nvarying vec3 vViewPosition;\\n\\n#ifndef FLAT_SHADED\\n\\n\tvarying vec3 vNormal;\\n\\n#endif\\n\";\n\n// File:src/renderers/shaders/ShaderChunk/lights_phong_pars_vertex.glsl\n\nTHREE.ShaderChunk[ 'lights_phong_pars_vertex'] = \"#if MAX_SPOT_LIGHTS > 0 || defined( USE_ENVMAP )\\n\\n\tvarying vec3 vWorldPosition;\\n\\n#endif\\n\";\n\n// File:src/renderers/shaders/ShaderChunk/lights_phong_vertex.glsl\n\nTHREE.ShaderChunk[ 'lights_phong_vertex'] = \"#if MAX_SPOT_LIGHTS > 0 || defined( USE_ENVMAP )\\n\\n\tvWorldPosition = worldPosition.xyz;\\n\\n#endif\\n\";\n\n// File:src/renderers/shaders/ShaderChunk/linear_to_gamma_fragment.glsl\n\nTHREE.ShaderChunk[ 'linear_to_gamma_fragment'] = \"\\n\toutgoingLight = linearToOutput( outgoingLight );\\n\";\n\n// File:src/renderers/shaders/ShaderChunk/logdepthbuf_fragment.glsl\n\nTHREE.ShaderChunk[ 'logdepthbuf_fragment'] = \"#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\\n\\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\\n\\n#endif\";\n\n// File:src/renderers/shaders/ShaderChunk/logdepthbuf_pars_fragment.glsl\n\nTHREE.ShaderChunk[ 'logdepthbuf_pars_fragment'] = \"#ifdef USE_LOGDEPTHBUF\\n\\n\tuniform float logDepthBufFC;\\n\\n\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\n\t\tvarying float vFragDepth;\\n\\n\t#endif\\n\\n#endif\\n\";\n\n// File:src/renderers/shaders/ShaderChunk/logdepthbuf_pars_vertex.glsl\n\nTHREE.ShaderChunk[ 'logdepthbuf_pars_vertex'] = \"#ifdef USE_LOGDEPTHBUF\\n\\n\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\n\t\tvarying float vFragDepth;\\n\\n\t#endif\\n\\n\tuniform float logDepthBufFC;\\n\\n#endif\";\n\n// File:src/renderers/shaders/ShaderChunk/logdepthbuf_vertex.glsl\n\nTHREE.ShaderChunk[ 'logdepthbuf_vertex'] = \"#ifdef USE_LOGDEPTHBUF\\n\\n\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\\n\\n\t#ifdef USE_LOGDEPTHBUF_EXT\\n\\n\t\tvFragDepth = 1.0 + gl_Position.w;\\n\\n#else\\n\\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\\n\\n\t#endif\\n\\n#endif\";\n\n// File:src/renderers/shaders/ShaderChunk/map_fragment.glsl\n\nTHREE.ShaderChunk[ 'map_fragment'] = \"#ifdef USE_MAP\\n\\n\tvec4 texelColor = texture2D( map, vUv );\\n\\n\ttexelColor.xyz = inputToLinear( texelColor.xyz );\\n\\n\tdiffuseColor *= texelColor;\\n\\n#endif\\n\";\n\n// File:src/renderers/shaders/ShaderChunk/map_pars_fragment.glsl\n\nTHREE.ShaderChunk[ 'map_pars_fragment'] = \"#ifdef USE_MAP\\n\\n\tuniform sampler2D map;\\n\\n#endif\";\n\n// File:src/renderers/shaders/ShaderChunk/map_particle_fragment.glsl\n\nTHREE.ShaderChunk[ 'map_particle_fragment'] = \"#ifdef USE_MAP\\n\\n\tdiffuseColor *= texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\\n\\n#endif\\n\";\n\n// File:src/renderers/shaders/ShaderChunk/map_particle_pars_fragment.glsl\n\nTHREE.ShaderChunk[ 'map_particle_pars_fragment'] = \"#ifdef USE_MAP\\n\\n\tuniform vec4 offsetRepeat;\\n\tuniform sampler2D map;\\n\\n#endif\\n\";\n\n// File:src/renderers/shaders/ShaderChunk/morphnormal_vertex.glsl\n\nTHREE.ShaderChunk[ 'morphnormal_vertex'] = \"#ifdef USE_MORPHNORMALS\\n\\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\\n\\n#endif\\n\";\n\n// File:src/renderers/shaders/ShaderChunk/morphtarget_pars_vertex.glsl\n\nTHREE.ShaderChunk[ 'morphtarget_pars_vertex'] = \"#ifdef USE_MORPHTARGETS\\n\\n\t#ifndef USE_MORPHNORMALS\\n\\n\tuniform float morphTargetInfluences[ 8 ];\\n\\n\t#else\\n\\n\tuniform float morphTargetInfluences[ 4 ];\\n\\n\t#endif\\n\\n#endif\";\n\n// File:src/renderers/shaders/ShaderChunk/morphtarget_vertex.glsl\n\nTHREE.ShaderChunk[ 'morphtarget_vertex'] = \"#ifdef USE_MORPHTARGETS\\n\\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\\n\\n\t#ifndef USE_MORPHNORMALS\\n\\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\\n\\n\t#endif\\n\\n#endif\\n\";\n\n// File:src/renderers/shaders/ShaderChunk/normalmap_pars_fragment.glsl\n\nTHREE.ShaderChunk[ 'normalmap_pars_fragment'] = \"#ifdef USE_NORMALMAP\\n\\n\tuniform sampler2D normalMap;\\n\tuniform vec2 normalScale;\\n\\n\t// Per-Pixel Tangent Space Normal Mapping\\n\t// http://hacksoflife.blogspot.ch/2009/11/per-pixel-tangent-space-normal-mapping.html\\n\\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\\n\\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\\n\t\tvec2 st0 = dFdx( vUv.st );\\n\t\tvec2 st1 = dFdy( vUv.st );\\n\\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\\n\t\tvec3 N = normalize( surf_norm );\\n\\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\\n\t\tmapN.xy = normalScale * mapN.xy;\\n\t\tmat3 tsn = mat3( S, T, N );\\n\t\treturn normalize( tsn * mapN );\\n\\n\t}\\n\\n#endif\\n\";\n\n// File:src/renderers/shaders/ShaderChunk/project_vertex.glsl\n\nTHREE.ShaderChunk[ 'project_vertex'] = \"#ifdef USE_SKINNING\\n\\n\tvec4 mvPosition = modelViewMatrix * skinned;\\n\\n#else\\n\\n\tvec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\\n\\n#endif\\n\\ngl_Position = projectionMatrix * mvPosition;\\n\";\n\n// File:src/renderers/shaders/ShaderChunk/shadowmap_fragment.glsl\n\nTHREE.ShaderChunk[ 'shadowmap_fragment'] = \"#ifdef USE_SHADOWMAP\\n\\n\t#ifdef SHADOWMAP_DEBUG\\n\\n\t\tvec3 frustumColors[3];\\n\t\tfrustumColors[0] = vec3( 1.0, 0.5, 0.0 );\\n\t\tfrustumColors[1] = vec3( 0.0, 1.0, 0.8 );\\n\t\tfrustumColors[2] = vec3( 0.0, 0.5, 1.0 );\\n\\n\t#endif\\n\\n\tfloat fDepth;\\n\tvec3 shadowColor = vec3( 1.0 );\\n\\n\tfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\\n\\n\t\tvec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\\n\\n\t\t\t\t// if ( something && something ) breaks ATI OpenGL shader compiler\\n\t\t\t\t// if ( all( something, something ) ) using this instead\\n\\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\\n\t\tbool inFrustum = all( inFrustumVec );\\n\\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\\n\\n\t\tbool frustumTest = all( frustumTestVec );\\n\\n\t\tif ( frustumTest ) {\\n\\n\t\t\tshadowCoord.z += shadowBias[ i ];\\n\\n\t\t\t#if defined( SHADOWMAP_TYPE_PCF )\\n\\n\t\t\t\t\t\t// Percentage-close filtering\\n\t\t\t\t\t\t// (9 pixel kernel)\\n\t\t\t\t\t\t// http://fabiensanglard.net/shadowmappingPCF/\\n\\n\t\t\t\tfloat shadow = 0.0;\\n\\n\t\t/*\\n\t\t\t\t\t\t// nested loops breaks shader compiler / validator on some ATI cards when using OpenGL\\n\t\t\t\t\t\t// must enroll loop manually\\n\\n\t\t\t\tfor ( float y = -1.25; y <= 1.25; y += 1.25 )\\n\t\t\t\t\tfor ( float x = -1.25; x <= 1.25; x += 1.25 ) {\\n\\n\t\t\t\t\t\tvec4 rgbaDepth = texture2D( shadowMap[ i ], vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy );\\n\\n\t\t\t\t\t\t\t\t// doesn't seem to produce any noticeable visual difference compared to simple texture2D lookup\\n\t\t\t\t\t\t\t\t//vec4 rgbaDepth = texture2DProj( shadowMap[ i ], vec4( vShadowCoord[ i ].w * ( vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy ), 0.05, vShadowCoord[ i ].w ) );\\n\\n\t\t\t\t\t\tfloat fDepth = unpackDepth( rgbaDepth );\\n\\n\t\t\t\t\t\tif ( fDepth < shadowCoord.z )\\n\t\t\t\t\t\t\tshadow += 1.0;\\n\\n\t\t\t\t}\\n\\n\t\t\t\tshadow /= 9.0;\\n\\n\t\t*/\\n\\n\t\t\t\tconst float shadowDelta = 1.0 / 9.0;\\n\\n\t\t\t\tfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\\n\t\t\t\tfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\\n\\n\t\t\t\tfloat dx0 = -1.25 * xPixelOffset;\\n\t\t\t\tfloat dy0 = -1.25 * yPixelOffset;\\n\t\t\t\tfloat dx1 = 1.25 * xPixelOffset;\\n\t\t\t\tfloat dy1 = 1.25 * yPixelOffset;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\\n\\n\t\t\t\tshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\\n\\n\t\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\\n\\n\t\t\t\t\t\t// Percentage-close filtering\\n\t\t\t\t\t\t// (9 pixel kernel)\\n\t\t\t\t\t\t// http://fabiensanglard.net/shadowmappingPCF/\\n\\n\t\t\t\tfloat shadow = 0.0;\\n\\n\t\t\t\tfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\\n\t\t\t\tfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\\n\\n\t\t\t\tfloat dx0 = -1.0 * xPixelOffset;\\n\t\t\t\tfloat dy0 = -1.0 * yPixelOffset;\\n\t\t\t\tfloat dx1 = 1.0 * xPixelOffset;\\n\t\t\t\tfloat dy1 = 1.0 * yPixelOffset;\\n\\n\t\t\t\tmat3 shadowKernel;\\n\t\t\t\tmat3 depthKernel;\\n\\n\t\t\t\tdepthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\\n\t\t\t\tdepthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\\n\t\t\t\tdepthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\\n\t\t\t\tdepthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\\n\t\t\t\tdepthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\\n\t\t\t\tdepthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\\n\t\t\t\tdepthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\\n\t\t\t\tdepthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\\n\t\t\t\tdepthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\\n\\n\t\t\t\tvec3 shadowZ = vec3( shadowCoord.z );\\n\t\t\t\tshadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));\\n\t\t\t\tshadowKernel[0] *= vec3(0.25);\\n\\n\t\t\t\tshadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));\\n\t\t\t\tshadowKernel[1] *= vec3(0.25);\\n\\n\t\t\t\tshadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));\\n\t\t\t\tshadowKernel[2] *= vec3(0.25);\\n\\n\t\t\t\tvec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );\\n\\n\t\t\t\tshadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );\\n\t\t\t\tshadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );\\n\\n\t\t\t\tvec4 shadowValues;\\n\t\t\t\tshadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );\\n\t\t\t\tshadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );\\n\t\t\t\tshadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );\\n\t\t\t\tshadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );\\n\\n\t\t\t\tshadow = dot( shadowValues, vec4( 1.0 ) );\\n\\n\t\t\t\tshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\\n\\n\t\t\t#else\\n\\n\t\t\t\tvec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\\n\t\t\t\tfloat fDepth = unpackDepth( rgbaDepth );\\n\\n\t\t\t\tif ( fDepth < shadowCoord.z )\\n\\n\t\t// spot with multiple shadows is darker\\n\\n\t\t\t\t\tshadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );\\n\\n\t\t// spot with multiple shadows has the same color as single shadow spot\\n\\n\t\t// \t\t\t\t\tshadowColor = min( shadowColor, vec3( shadowDarkness[ i ] ) );\\n\\n\t\t\t#endif\\n\\n\t\t}\\n\\n\\n\t\t#ifdef SHADOWMAP_DEBUG\\n\\n\t\t\tif ( inFrustum ) outgoingLight *= frustumColors[ i ];\\n\\n\t\t#endif\\n\\n\t}\\n\\n\toutgoingLight = outgoingLight * shadowColor;\\n\\n#endif\\n\";\n\n// File:src/renderers/shaders/ShaderChunk/shadowmap_pars_fragment.glsl\n\nTHREE.ShaderChunk[ 'shadowmap_pars_fragment'] = \"#ifdef USE_SHADOWMAP\\n\\n\tuniform sampler2D shadowMap[ MAX_SHADOWS ];\\n\tuniform vec2 shadowMapSize[ MAX_SHADOWS ];\\n\\n\tuniform float shadowDarkness[ MAX_SHADOWS ];\\n\tuniform float shadowBias[ MAX_SHADOWS ];\\n\\n\tvarying vec4 vShadowCoord[ MAX_SHADOWS ];\\n\\n\tfloat unpackDepth( const in vec4 rgba_depth ) {\\n\\n\t\tconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\\n\t\tfloat depth = dot( rgba_depth, bit_shift );\\n\t\treturn depth;\\n\\n\t}\\n\\n#endif\";\n\n// File:src/renderers/shaders/ShaderChunk/shadowmap_pars_vertex.glsl\n\nTHREE.ShaderChunk[ 'shadowmap_pars_vertex'] = \"#ifdef USE_SHADOWMAP\\n\\n\tvarying vec4 vShadowCoord[ MAX_SHADOWS ];\\n\tuniform mat4 shadowMatrix[ MAX_SHADOWS ];\\n\\n#endif\";\n\n// File:src/renderers/shaders/ShaderChunk/shadowmap_vertex.glsl\n\nTHREE.ShaderChunk[ 'shadowmap_vertex'] = \"#ifdef USE_SHADOWMAP\\n\\n\tfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\\n\\n\t\tvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\\n\\n\t}\\n\\n#endif\";\n\n// File:src/renderers/shaders/ShaderChunk/skinbase_vertex.glsl\n\nTHREE.ShaderChunk[ 'skinbase_vertex'] = \"#ifdef USE_SKINNING\\n\\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\\n\\n#endif\";\n\n// File:src/renderers/shaders/ShaderChunk/skinning_pars_vertex.glsl\n\nTHREE.ShaderChunk[ 'skinning_pars_vertex'] = \"#ifdef USE_SKINNING\\n\\n\tuniform mat4 bindMatrix;\\n\tuniform mat4 bindMatrixInverse;\\n\\n\t#ifdef BONE_TEXTURE\\n\\n\t\tuniform sampler2D boneTexture;\\n\t\tuniform int boneTextureWidth;\\n\t\tuniform int boneTextureHeight;\\n\\n\t\tmat4 getBoneMatrix( const in float i ) {\\n\\n\t\t\tfloat j = i * 4.0;\\n\t\t\tfloat x = mod( j, float( boneTextureWidth ) );\\n\t\t\tfloat y = floor( j / float( boneTextureWidth ) );\\n\\n\t\t\tfloat dx = 1.0 / float( boneTextureWidth );\\n\t\t\tfloat dy = 1.0 / float( boneTextureHeight );\\n\\n\t\t\ty = dy * ( y + 0.5 );\\n\\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\\n\\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\\n\\n\t\t\treturn bone;\\n\\n\t\t}\\n\\n\t#else\\n\\n\t\tuniform mat4 boneGlobalMatrices[ MAX_BONES ];\\n\\n\t\tmat4 getBoneMatrix( const in float i ) {\\n\\n\t\t\tmat4 bone = boneGlobalMatrices[ int(i) ];\\n\t\t\treturn bone;\\n\\n\t\t}\\n\\n\t#endif\\n\\n#endif\\n\";\n\n// File:src/renderers/shaders/ShaderChunk/skinning_vertex.glsl\n\nTHREE.ShaderChunk[ 'skinning_vertex'] = \"#ifdef USE_SKINNING\\n\\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\\n\\n\tvec4 skinned = vec4( 0.0 );\\n\tskinned += boneMatX * skinVertex * skinWeight.x;\\n\tskinned += boneMatY * skinVertex * skinWeight.y;\\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\\n\tskinned += boneMatW * skinVertex * skinWeight.w;\\n\tskinned  = bindMatrixInverse * skinned;\\n\\n#endif\\n\";\n\n// File:src/renderers/shaders/ShaderChunk/skinnormal_vertex.glsl\n\nTHREE.ShaderChunk[ 'skinnormal_vertex'] = \"#ifdef USE_SKINNING\\n\\n\tmat4 skinMatrix = mat4( 0.0 );\\n\tskinMatrix += skinWeight.x * boneMatX;\\n\tskinMatrix += skinWeight.y * boneMatY;\\n\tskinMatrix += skinWeight.z * boneMatZ;\\n\tskinMatrix += skinWeight.w * boneMatW;\\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\\n\\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\\n\\n#endif\\n\";\n\n// File:src/renderers/shaders/ShaderChunk/specularmap_fragment.glsl\n\nTHREE.ShaderChunk[ 'specularmap_fragment'] = \"float specularStrength;\\n\\n#ifdef USE_SPECULARMAP\\n\\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\\n\tspecularStrength = texelSpecular.r;\\n\\n#else\\n\\n\tspecularStrength = 1.0;\\n\\n#endif\";\n\n// File:src/renderers/shaders/ShaderChunk/specularmap_pars_fragment.glsl\n\nTHREE.ShaderChunk[ 'specularmap_pars_fragment'] = \"#ifdef USE_SPECULARMAP\\n\\n\tuniform sampler2D specularMap;\\n\\n#endif\";\n\n// File:src/renderers/shaders/ShaderChunk/uv2_pars_fragment.glsl\n\nTHREE.ShaderChunk[ 'uv2_pars_fragment'] = \"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\n\\n\tvarying vec2 vUv2;\\n\\n#endif\";\n\n// File:src/renderers/shaders/ShaderChunk/uv2_pars_vertex.glsl\n\nTHREE.ShaderChunk[ 'uv2_pars_vertex'] = \"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\n\\n\tattribute vec2 uv2;\\n\tvarying vec2 vUv2;\\n\\n#endif\";\n\n// File:src/renderers/shaders/ShaderChunk/uv2_vertex.glsl\n\nTHREE.ShaderChunk[ 'uv2_vertex'] = \"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\\n\\n\tvUv2 = uv2;\\n\\n#endif\";\n\n// File:src/renderers/shaders/ShaderChunk/uv_pars_fragment.glsl\n\nTHREE.ShaderChunk[ 'uv_pars_fragment'] = \"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP )\\n\\n\tvarying vec2 vUv;\\n\\n#endif\";\n\n// File:src/renderers/shaders/ShaderChunk/uv_pars_vertex.glsl\n\nTHREE.ShaderChunk[ 'uv_pars_vertex'] = \"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP )\\n\\n\tvarying vec2 vUv;\\n\tuniform vec4 offsetRepeat;\\n\\n#endif\\n\";\n\n// File:src/renderers/shaders/ShaderChunk/uv_vertex.glsl\n\nTHREE.ShaderChunk[ 'uv_vertex'] = \"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP )\\n\\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\\n\\n#endif\";\n\n// File:src/renderers/shaders/ShaderChunk/worldpos_vertex.glsl\n\nTHREE.ShaderChunk[ 'worldpos_vertex'] = \"#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\\n\\n\t#ifdef USE_SKINNING\\n\\n\t\tvec4 worldPosition = modelMatrix * skinned;\\n\\n\t#else\\n\\n\t\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\\n\\n\t#endif\\n\\n#endif\\n\";\n\n// File:src/renderers/shaders/UniformsUtils.js\n\n/**\n * Uniform Utilities\n */\n\nTHREE.UniformsUtils = {\n\n\tmerge: function ( uniforms ) {\n\n\t\tvar merged = {};\n\n\t\tfor ( var u = 0; u < uniforms.length; u ++ ) {\n\n\t\t\tvar tmp = this.clone( uniforms[ u ] );\n\n\t\t\tfor ( var p in tmp ) {\n\n\t\t\t\tmerged[ p ] = tmp[ p ];\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn merged;\n\n\t},\n\n\tclone: function ( uniforms_src ) {\n\n\t\tvar uniforms_dst = {};\n\n\t\tfor ( var u in uniforms_src ) {\n\n\t\t\tuniforms_dst[ u ] = {};\n\n\t\t\tfor ( var p in uniforms_src[ u ] ) {\n\n\t\t\t\tvar parameter_src = uniforms_src[ u ][ p ];\n\n\t\t\t\tif ( parameter_src instanceof THREE.Color ||\n\t\t\t\t\t parameter_src instanceof THREE.Vector2 ||\n\t\t\t\t\t parameter_src instanceof THREE.Vector3 ||\n\t\t\t\t\t parameter_src instanceof THREE.Vector4 ||\n\t\t\t\t\t parameter_src instanceof THREE.Matrix3 ||\n\t\t\t\t\t parameter_src instanceof THREE.Matrix4 ||\n\t\t\t\t\t parameter_src instanceof THREE.Texture ) {\n\n\t\t\t\t\tuniforms_dst[ u ][ p ] = parameter_src.clone();\n\n\t\t\t\t} else if ( Array.isArray( parameter_src ) ) {\n\n\t\t\t\t\tuniforms_dst[ u ][ p ] = parameter_src.slice();\n\n\t\t\t\t} else {\n\n\t\t\t\t\tuniforms_dst[ u ][ p ] = parameter_src;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn uniforms_dst;\n\n\t}\n\n};\n\n// File:src/renderers/shaders/UniformsLib.js\n\n/**\n * Uniforms library for shared webgl shaders\n */\n\nTHREE.UniformsLib = {\n\n\tcommon: {\n\n\t\t\"diffuse\" : { type: \"c\", value: new THREE.Color( 0xeeeeee ) },\n\t\t\"opacity\" : { type: \"f\", value: 1.0 },\n\n\t\t\"map\" : { type: \"t\", value: null },\n\t\t\"offsetRepeat\" : { type: \"v4\", value: new THREE.Vector4( 0, 0, 1, 1 ) },\n\n\t\t\"specularMap\" : { type: \"t\", value: null },\n\t\t\"alphaMap\" : { type: \"t\", value: null },\n\n\t\t\"envMap\" : { type: \"t\", value: null },\n\t\t\"flipEnvMap\" : { type: \"f\", value: - 1 },\n\t\t\"reflectivity\" : { type: \"f\", value: 1.0 },\n\t\t\"refractionRatio\" : { type: \"f\", value: 0.98 }\n\n\t},\n\n\taomap: {\n\n\t\t\"aoMap\" : { type: \"t\", value: null },\n\t\t\"aoMapIntensity\" : { type: \"f\", value: 1 },\n\n\t},\n\n\tlightmap: {\n\n\t\t\"lightMap\" : { type: \"t\", value: null },\n\t\t\"lightMapIntensity\" : { type: \"f\", value: 1 },\n\n\t},\n\n\temissivemap: {\n\n\t\t\"emissiveMap\" : { type: \"t\", value: null },\n\n\t},\n\n\tbumpmap: {\n\n\t\t\"bumpMap\" : { type: \"t\", value: null },\n\t\t\"bumpScale\" : { type: \"f\", value: 1 }\n\n\t},\n\n\tnormalmap: {\n\n\t\t\"normalMap\" : { type: \"t\", value: null },\n\t\t\"normalScale\" : { type: \"v2\", value: new THREE.Vector2( 1, 1 ) }\n\n\t},\n\n\tdisplacementmap: {\n\n\t\t\"displacementMap\" : { type: \"t\", value: null },\n\t\t\"displacementScale\" : { type: \"f\", value: 1 },\n\t\t\"displacementBias\" : { type: \"f\", value: 0 }\n\n\t},\n\n\tfog : {\n\n\t\t\"fogDensity\" : { type: \"f\", value: 0.00025 },\n\t\t\"fogNear\" : { type: \"f\", value: 1 },\n\t\t\"fogFar\" : { type: \"f\", value: 2000 },\n\t\t\"fogColor\" : { type: \"c\", value: new THREE.Color( 0xffffff ) }\n\n\t},\n\n\tlights: {\n\n\t\t\"ambientLightColor\" : { type: \"fv\", value: [] },\n\n\t\t\"directionalLightDirection\" : { type: \"fv\", value: [] },\n\t\t\"directionalLightColor\" : { type: \"fv\", value: [] },\n\n\t\t\"hemisphereLightDirection\" : { type: \"fv\", value: [] },\n\t\t\"hemisphereLightSkyColor\" : { type: \"fv\", value: [] },\n\t\t\"hemisphereLightGroundColor\" : { type: \"fv\", value: [] },\n\n\t\t\"pointLightColor\" : { type: \"fv\", value: [] },\n\t\t\"pointLightPosition\" : { type: \"fv\", value: [] },\n\t\t\"pointLightDistance\" : { type: \"fv1\", value: [] },\n\t\t\"pointLightDecay\" : { type: \"fv1\", value: [] },\n\n\t\t\"spotLightColor\" : { type: \"fv\", value: [] },\n\t\t\"spotLightPosition\" : { type: \"fv\", value: [] },\n\t\t\"spotLightDirection\" : { type: \"fv\", value: [] },\n\t\t\"spotLightDistance\" : { type: \"fv1\", value: [] },\n\t\t\"spotLightAngleCos\" : { type: \"fv1\", value: [] },\n\t\t\"spotLightExponent\" : { type: \"fv1\", value: [] },\n\t\t\"spotLightDecay\" : { type: \"fv1\", value: [] }\n\n\t},\n\n\tpoints: {\n\n\t\t\"psColor\" : { type: \"c\", value: new THREE.Color( 0xeeeeee ) },\n\t\t\"opacity\" : { type: \"f\", value: 1.0 },\n\t\t\"size\" : { type: \"f\", value: 1.0 },\n\t\t\"scale\" : { type: \"f\", value: 1.0 },\n\t\t\"map\" : { type: \"t\", value: null },\n\t\t\"offsetRepeat\" : { type: \"v4\", value: new THREE.Vector4( 0, 0, 1, 1 ) },\n\n\t\t\"fogDensity\" : { type: \"f\", value: 0.00025 },\n\t\t\"fogNear\" : { type: \"f\", value: 1 },\n\t\t\"fogFar\" : { type: \"f\", value: 2000 },\n\t\t\"fogColor\" : { type: \"c\", value: new THREE.Color( 0xffffff ) }\n\n\t},\n\n\tshadowmap: {\n\n\t\t\"shadowMap\": { type: \"tv\", value: [] },\n\t\t\"shadowMapSize\": { type: \"v2v\", value: [] },\n\n\t\t\"shadowBias\" : { type: \"fv1\", value: [] },\n\t\t\"shadowDarkness\": { type: \"fv1\", value: [] },\n\n\t\t\"shadowMatrix\" : { type: \"m4v\", value: [] }\n\n\t}\n\n};\n\n// File:src/renderers/shaders/ShaderLib.js\n\n/**\n * Webgl Shader Library for three.js\n *\n * @author alteredq / http://alteredqualia.com/\n * @author mrdoob / http://mrdoob.com/\n * @author mikael emtinger / http://gomo.se/\n */\n\n\nTHREE.ShaderLib = {\n\n\t'basic': {\n\n\t\tuniforms: THREE.UniformsUtils.merge( [\n\n\t\t\tTHREE.UniformsLib[ \"common\" ],\n\t\t\tTHREE.UniformsLib[ \"aomap\" ],\n\t\t\tTHREE.UniformsLib[ \"fog\" ],\n\t\t\tTHREE.UniformsLib[ \"shadowmap\" ]\n\n\t\t] ),\n\n\t\tvertexShader: [\n\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\n\t\t\tTHREE.ShaderChunk[ \"uv_pars_vertex\" ],\n\t\t\tTHREE.ShaderChunk[ \"uv2_pars_vertex\" ],\n\t\t\tTHREE.ShaderChunk[ \"envmap_pars_vertex\" ],\n\t\t\tTHREE.ShaderChunk[ \"color_pars_vertex\" ],\n\t\t\tTHREE.ShaderChunk[ \"morphtarget_pars_vertex\" ],\n\t\t\tTHREE.ShaderChunk[ \"skinning_pars_vertex\" ],\n\t\t\tTHREE.ShaderChunk[ \"shadowmap_pars_vertex\" ],\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_vertex\" ],\n\n\t\t\t\"void main() {\",\n\n\t\t\t\tTHREE.ShaderChunk[ \"uv_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"uv2_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"color_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"skinbase_vertex\" ],\n\n\t\t\t\"\t#ifdef USE_ENVMAP\",\n\n\t\t\t\tTHREE.ShaderChunk[ \"beginnormal_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"morphnormal_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"skinnormal_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"defaultnormal_vertex\" ],\n\n\t\t\t\"\t#endif\",\n\n\t\t\t\tTHREE.ShaderChunk[ \"begin_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"morphtarget_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"skinning_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"project_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_vertex\" ],\n\n\t\t\t\tTHREE.ShaderChunk[ \"worldpos_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"envmap_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"shadowmap_vertex\" ],\n\n\t\t\t\"}\"\n\n\t\t].join( \"\\n\" ),\n\n\t\tfragmentShader: [\n\n\t\t\t\"uniform vec3 diffuse;\",\n\t\t\t\"uniform float opacity;\",\n\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\n\t\t\tTHREE.ShaderChunk[ \"color_pars_fragment\" ],\n\t\t\tTHREE.ShaderChunk[ \"uv_pars_fragment\" ],\n\t\t\tTHREE.ShaderChunk[ \"uv2_pars_fragment\" ],\n\t\t\tTHREE.ShaderChunk[ \"map_pars_fragment\" ],\n\t\t\tTHREE.ShaderChunk[ \"alphamap_pars_fragment\" ],\n\t\t\tTHREE.ShaderChunk[ \"aomap_pars_fragment\" ],\n\t\t\tTHREE.ShaderChunk[ \"envmap_pars_fragment\" ],\n\t\t\tTHREE.ShaderChunk[ \"fog_pars_fragment\" ],\n\t\t\tTHREE.ShaderChunk[ \"shadowmap_pars_fragment\" ],\n\t\t\tTHREE.ShaderChunk[ \"specularmap_pars_fragment\" ],\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_fragment\" ],\n\n\t\t\t\"void main() {\",\n\n\t\t\t\"\tvec3 outgoingLight = vec3( 0.0 );\",\n\t\t\t\"\tvec4 diffuseColor = vec4( diffuse, opacity );\",\n\t\t\t\"\tvec3 totalAmbientLight = vec3( 1.0 );\", // hardwired\n\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_fragment\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"map_fragment\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"color_fragment\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"alphamap_fragment\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"alphatest_fragment\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"specularmap_fragment\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"aomap_fragment\" ],\n\n\t\t\t\"\toutgoingLight = diffuseColor.rgb * totalAmbientLight;\", // simple shader\n\n\t\t\t\tTHREE.ShaderChunk[ \"envmap_fragment\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"shadowmap_fragment\" ],\t\t// TODO: Shadows on an otherwise unlit surface doesn't make sense.\n\n\t\t\t\tTHREE.ShaderChunk[ \"linear_to_gamma_fragment\" ],\n\n\t\t\t\tTHREE.ShaderChunk[ \"fog_fragment\" ],\n\n\t\t\t\"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\",\n\n\t\t\t\"}\"\n\n\t\t].join( \"\\n\" )\n\n\t},\n\n\t'lambert': {\n\n\t\tuniforms: THREE.UniformsUtils.merge( [\n\n\t\t\tTHREE.UniformsLib[ \"common\" ],\n\t\t\tTHREE.UniformsLib[ \"fog\" ],\n\t\t\tTHREE.UniformsLib[ \"lights\" ],\n\t\t\tTHREE.UniformsLib[ \"shadowmap\" ],\n\n\t\t\t{\n\t\t\t\t\"emissive\" : { type: \"c\", value: new THREE.Color( 0x000000 ) }\n\t\t\t}\n\n\t\t] ),\n\n\t\tvertexShader: [\n\n\t\t\t\"#define LAMBERT\",\n\n\t\t\t\"varying vec3 vLightFront;\",\n\n\t\t\t\"#ifdef DOUBLE_SIDED\",\n\n\t\t\t\"\tvarying vec3 vLightBack;\",\n\n\t\t\t\"#endif\",\n\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\n\t\t\tTHREE.ShaderChunk[ \"uv_pars_vertex\" ],\n\t\t\tTHREE.ShaderChunk[ \"uv2_pars_vertex\" ],\n\t\t\tTHREE.ShaderChunk[ \"envmap_pars_vertex\" ],\n\t\t\tTHREE.ShaderChunk[ \"lights_lambert_pars_vertex\" ],\n\t\t\tTHREE.ShaderChunk[ \"color_pars_vertex\" ],\n\t\t\tTHREE.ShaderChunk[ \"morphtarget_pars_vertex\" ],\n\t\t\tTHREE.ShaderChunk[ \"skinning_pars_vertex\" ],\n\t\t\tTHREE.ShaderChunk[ \"shadowmap_pars_vertex\" ],\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_vertex\" ],\n\n\t\t\t\"void main() {\",\n\n\t\t\t\tTHREE.ShaderChunk[ \"uv_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"uv2_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"color_vertex\" ],\n\n\t\t\t\tTHREE.ShaderChunk[ \"beginnormal_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"morphnormal_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"skinbase_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"skinnormal_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"defaultnormal_vertex\" ],\n\n\t\t\t\tTHREE.ShaderChunk[ \"begin_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"morphtarget_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"skinning_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"project_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_vertex\" ],\n\n\t\t\t\tTHREE.ShaderChunk[ \"worldpos_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"envmap_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"lights_lambert_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"shadowmap_vertex\" ],\n\n\t\t\t\"}\"\n\n\t\t].join( \"\\n\" ),\n\n\t\tfragmentShader: [\n\n\t\t\t\"uniform vec3 diffuse;\",\n\t\t\t\"uniform vec3 emissive;\",\n\t\t\t\"uniform float opacity;\",\n\n\t\t\t\"varying vec3 vLightFront;\",\n\n\t\t\t\"#ifdef DOUBLE_SIDED\",\n\n\t\t\t\"\tvarying vec3 vLightBack;\",\n\n\t\t\t\"#endif\",\n\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\n\t\t\tTHREE.ShaderChunk[ \"color_pars_fragment\" ],\n\t\t\tTHREE.ShaderChunk[ \"uv_pars_fragment\" ],\n\t\t\tTHREE.ShaderChunk[ \"uv2_pars_fragment\" ],\n\t\t\tTHREE.ShaderChunk[ \"map_pars_fragment\" ],\n\t\t\tTHREE.ShaderChunk[ \"alphamap_pars_fragment\" ],\n\t\t\tTHREE.ShaderChunk[ \"envmap_pars_fragment\" ],\n\t\t\tTHREE.ShaderChunk[ \"fog_pars_fragment\" ],\n\t\t\tTHREE.ShaderChunk[ \"shadowmap_pars_fragment\" ],\n\t\t\tTHREE.ShaderChunk[ \"specularmap_pars_fragment\" ],\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_fragment\" ],\n\n\t\t\t\"void main() {\",\n\n\t\t\t\"\tvec3 outgoingLight = vec3( 0.0 );\",\t// outgoing light does not have an alpha, the surface does\n\t\t\t\"\tvec4 diffuseColor = vec4( diffuse, opacity );\",\n\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_fragment\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"map_fragment\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"color_fragment\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"alphamap_fragment\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"alphatest_fragment\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"specularmap_fragment\" ],\n\n\t\t\t\"\t#ifdef DOUBLE_SIDED\",\n\n\t\t\t\"\t\tif ( gl_FrontFacing )\",\n\t\t\t\"\t\t\toutgoingLight += diffuseColor.rgb * vLightFront + emissive;\",\n\t\t\t\"\t\telse\",\n\t\t\t\"\t\t\toutgoingLight += diffuseColor.rgb * vLightBack + emissive;\",\n\n\t\t\t\"\t#else\",\n\n\t\t\t\"\t\toutgoingLight += diffuseColor.rgb * vLightFront + emissive;\",\n\n\t\t\t\"\t#endif\",\n\n\t\t\t\tTHREE.ShaderChunk[ \"envmap_fragment\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"shadowmap_fragment\" ],\n\n\t\t\t\tTHREE.ShaderChunk[ \"linear_to_gamma_fragment\" ],\n\n\t\t\t\tTHREE.ShaderChunk[ \"fog_fragment\" ],\n\n\t\t\t\"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\",\n\n\t\t\t\"}\"\n\n\t\t].join( \"\\n\" )\n\n\t},\n\n\t'phong': {\n\n\t\tuniforms: THREE.UniformsUtils.merge( [\n\n\t\t\tTHREE.UniformsLib[ \"common\" ],\n\t\t\tTHREE.UniformsLib[ \"aomap\" ],\n\t\t\tTHREE.UniformsLib[ \"lightmap\" ],\n\t\t\tTHREE.UniformsLib[ \"emissivemap\" ],\n\t\t\tTHREE.UniformsLib[ \"bumpmap\" ],\n\t\t\tTHREE.UniformsLib[ \"normalmap\" ],\n\t\t\tTHREE.UniformsLib[ \"displacementmap\" ],\n\t\t\tTHREE.UniformsLib[ \"fog\" ],\n\t\t\tTHREE.UniformsLib[ \"lights\" ],\n\t\t\tTHREE.UniformsLib[ \"shadowmap\" ],\n\n\t\t\t{\n\t\t\t\t\"emissive\" : { type: \"c\", value: new THREE.Color( 0x000000 ) },\n\t\t\t\t\"specular\" : { type: \"c\", value: new THREE.Color( 0x111111 ) },\n\t\t\t\t\"shininess\": { type: \"f\", value: 30 }\n\t\t\t}\n\n\t\t] ),\n\n\t\tvertexShader: [\n\n\t\t\t\"#define PHONG\",\n\n\t\t\t\"varying vec3 vViewPosition;\",\n\n\t\t\t\"#ifndef FLAT_SHADED\",\n\n\t\t\t\"\tvarying vec3 vNormal;\",\n\n\t\t\t\"#endif\",\n\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\n\t\t\tTHREE.ShaderChunk[ \"uv_pars_vertex\" ],\n\t\t\tTHREE.ShaderChunk[ \"uv2_pars_vertex\" ],\n\t\t\tTHREE.ShaderChunk[ \"displacementmap_pars_vertex\" ],\n\t\t\tTHREE.ShaderChunk[ \"envmap_pars_vertex\" ],\n\t\t\tTHREE.ShaderChunk[ \"lights_phong_pars_vertex\" ],\n\t\t\tTHREE.ShaderChunk[ \"color_pars_vertex\" ],\n\t\t\tTHREE.ShaderChunk[ \"morphtarget_pars_vertex\" ],\n\t\t\tTHREE.ShaderChunk[ \"skinning_pars_vertex\" ],\n\t\t\tTHREE.ShaderChunk[ \"shadowmap_pars_vertex\" ],\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_vertex\" ],\n\n\t\t\t\"void main() {\",\n\n\t\t\t\tTHREE.ShaderChunk[ \"uv_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"uv2_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"color_vertex\" ],\n\n\t\t\t\tTHREE.ShaderChunk[ \"beginnormal_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"morphnormal_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"skinbase_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"skinnormal_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"defaultnormal_vertex\" ],\n\n\t\t\t\"#ifndef FLAT_SHADED\", // Normal computed with derivatives when FLAT_SHADED\n\n\t\t\t\"\tvNormal = normalize( transformedNormal );\",\n\n\t\t\t\"#endif\",\n\n\t\t\t\tTHREE.ShaderChunk[ \"begin_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"displacementmap_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"morphtarget_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"skinning_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"project_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_vertex\" ],\n\n\t\t\t\"\tvViewPosition = - mvPosition.xyz;\",\n\n\t\t\t\tTHREE.ShaderChunk[ \"worldpos_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"envmap_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"lights_phong_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"shadowmap_vertex\" ],\n\n\t\t\t\"}\"\n\n\t\t].join( \"\\n\" ),\n\n\t\tfragmentShader: [\n\n\t\t\t\"#define PHONG\",\n\n\t\t\t\"uniform vec3 diffuse;\",\n\t\t\t\"uniform vec3 emissive;\",\n\t\t\t\"uniform vec3 specular;\",\n\t\t\t\"uniform float shininess;\",\n\t\t\t\"uniform float opacity;\",\n\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\n\t\t\tTHREE.ShaderChunk[ \"color_pars_fragment\" ],\n\t\t\tTHREE.ShaderChunk[ \"uv_pars_fragment\" ],\n\t\t\tTHREE.ShaderChunk[ \"uv2_pars_fragment\" ],\n\t\t\tTHREE.ShaderChunk[ \"map_pars_fragment\" ],\n\t\t\tTHREE.ShaderChunk[ \"alphamap_pars_fragment\" ],\n\t\t\tTHREE.ShaderChunk[ \"aomap_pars_fragment\" ],\n\t\t\tTHREE.ShaderChunk[ \"lightmap_pars_fragment\" ],\n\t\t\tTHREE.ShaderChunk[ \"emissivemap_pars_fragment\" ],\n\t\t\tTHREE.ShaderChunk[ \"envmap_pars_fragment\" ],\n\t\t\tTHREE.ShaderChunk[ \"fog_pars_fragment\" ],\n\t\t\tTHREE.ShaderChunk[ \"lights_phong_pars_fragment\" ],\n\t\t\tTHREE.ShaderChunk[ \"shadowmap_pars_fragment\" ],\n\t\t\tTHREE.ShaderChunk[ \"bumpmap_pars_fragment\" ],\n\t\t\tTHREE.ShaderChunk[ \"normalmap_pars_fragment\" ],\n\t\t\tTHREE.ShaderChunk[ \"specularmap_pars_fragment\" ],\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_fragment\" ],\n\n\t\t\t\"void main() {\",\n\n\t\t\t\"\tvec3 outgoingLight = vec3( 0.0 );\",\n\t\t\t\"\tvec4 diffuseColor = vec4( diffuse, opacity );\",\n\t\t\t\"\tvec3 totalAmbientLight = ambientLightColor;\",\n\t\t\t\"\tvec3 totalEmissiveLight = emissive;\",\n\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_fragment\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"map_fragment\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"color_fragment\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"alphamap_fragment\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"alphatest_fragment\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"specularmap_fragment\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"lightmap_fragment\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"aomap_fragment\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"emissivemap_fragment\" ],\n\n\t\t\t\tTHREE.ShaderChunk[ \"lights_phong_fragment\" ],\n\n\t\t\t\tTHREE.ShaderChunk[ \"envmap_fragment\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"shadowmap_fragment\" ],\n\n\t\t\t\tTHREE.ShaderChunk[ \"linear_to_gamma_fragment\" ],\n\n\t\t\t\tTHREE.ShaderChunk[ \"fog_fragment\" ],\n\n\t\t\t\"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\",\n\n\t\t\t\"}\"\n\n\t\t].join( \"\\n\" )\n\n\t},\n\n\t'points': {\n\n\t\tuniforms: THREE.UniformsUtils.merge( [\n\n\t\t\tTHREE.UniformsLib[ \"points\" ],\n\t\t\tTHREE.UniformsLib[ \"shadowmap\" ]\n\n\t\t] ),\n\n\t\tvertexShader: [\n\n\t\t\t\"uniform float size;\",\n\t\t\t\"uniform float scale;\",\n\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\n\t\t\tTHREE.ShaderChunk[ \"color_pars_vertex\" ],\n\t\t\tTHREE.ShaderChunk[ \"shadowmap_pars_vertex\" ],\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_vertex\" ],\n\n\t\t\t\"void main() {\",\n\n\t\t\t\tTHREE.ShaderChunk[ \"color_vertex\" ],\n\n\t\t\t\"\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\",\n\n\t\t\t\"\t#ifdef USE_SIZEATTENUATION\",\n\t\t\t\"\t\tgl_PointSize = size * ( scale / length( mvPosition.xyz ) );\",\n\t\t\t\"\t#else\",\n\t\t\t\"\t\tgl_PointSize = size;\",\n\t\t\t\"\t#endif\",\n\n\t\t\t\"\tgl_Position = projectionMatrix * mvPosition;\",\n\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"worldpos_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"shadowmap_vertex\" ],\n\n\t\t\t\"}\"\n\n\t\t].join( \"\\n\" ),\n\n\t\tfragmentShader: [\n\n\t\t\t\"uniform vec3 psColor;\",\n\t\t\t\"uniform float opacity;\",\n\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\n\t\t\tTHREE.ShaderChunk[ \"color_pars_fragment\" ],\n\t\t\tTHREE.ShaderChunk[ \"map_particle_pars_fragment\" ],\n\t\t\tTHREE.ShaderChunk[ \"fog_pars_fragment\" ],\n\t\t\tTHREE.ShaderChunk[ \"shadowmap_pars_fragment\" ],\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_fragment\" ],\n\n\t\t\t\"void main() {\",\n\n\t\t\t\"\tvec3 outgoingLight = vec3( 0.0 );\",\n\t\t\t\"\tvec4 diffuseColor = vec4( psColor, opacity );\",\n\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_fragment\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"map_particle_fragment\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"color_fragment\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"alphatest_fragment\" ],\n\n\t\t\t\"\toutgoingLight = diffuseColor.rgb;\", // simple shader\n\n\t\t\t\tTHREE.ShaderChunk[ \"shadowmap_fragment\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"fog_fragment\" ],\n\n\t\t\t\"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\",\n\n\t\t\t\"}\"\n\n\t\t].join( \"\\n\" )\n\n\t},\n\n\t'dashed': {\n\n\t\tuniforms: THREE.UniformsUtils.merge( [\n\n\t\t\tTHREE.UniformsLib[ \"common\" ],\n\t\t\tTHREE.UniformsLib[ \"fog\" ],\n\n\t\t\t{\n\t\t\t\t\"scale\"    : { type: \"f\", value: 1 },\n\t\t\t\t\"dashSize\" : { type: \"f\", value: 1 },\n\t\t\t\t\"totalSize\": { type: \"f\", value: 2 }\n\t\t\t}\n\n\t\t] ),\n\n\t\tvertexShader: [\n\n\t\t\t\"uniform float scale;\",\n\t\t\t\"attribute float lineDistance;\",\n\n\t\t\t\"varying float vLineDistance;\",\n\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\n\t\t\tTHREE.ShaderChunk[ \"color_pars_vertex\" ],\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_vertex\" ],\n\n\t\t\t\"void main() {\",\n\n\t\t\t\tTHREE.ShaderChunk[ \"color_vertex\" ],\n\n\t\t\t\"\tvLineDistance = scale * lineDistance;\",\n\n\t\t\t\"\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\",\n\t\t\t\"\tgl_Position = projectionMatrix * mvPosition;\",\n\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_vertex\" ],\n\n\t\t\t\"}\"\n\n\t\t].join( \"\\n\" ),\n\n\t\tfragmentShader: [\n\n\t\t\t\"uniform vec3 diffuse;\",\n\t\t\t\"uniform float opacity;\",\n\n\t\t\t\"uniform float dashSize;\",\n\t\t\t\"uniform float totalSize;\",\n\n\t\t\t\"varying float vLineDistance;\",\n\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\n\t\t\tTHREE.ShaderChunk[ \"color_pars_fragment\" ],\n\t\t\tTHREE.ShaderChunk[ \"fog_pars_fragment\" ],\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_fragment\" ],\n\n\t\t\t\"void main() {\",\n\n\t\t\t\"\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\",\n\n\t\t\t\"\t\tdiscard;\",\n\n\t\t\t\"\t}\",\n\n\t\t\t\"\tvec3 outgoingLight = vec3( 0.0 );\",\n\t\t\t\"\tvec4 diffuseColor = vec4( diffuse, opacity );\",\n\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_fragment\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"color_fragment\" ],\n\n\t\t\t\"\toutgoingLight = diffuseColor.rgb;\", // simple shader\n\n\t\t\t\tTHREE.ShaderChunk[ \"fog_fragment\" ],\n\n\t\t\t\"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\",\n\n\t\t\t\"}\"\n\n\t\t].join( \"\\n\" )\n\n\t},\n\n\t'depth': {\n\n\t\tuniforms: {\n\n\t\t\t\"mNear\": { type: \"f\", value: 1.0 },\n\t\t\t\"mFar\" : { type: \"f\", value: 2000.0 },\n\t\t\t\"opacity\" : { type: \"f\", value: 1.0 }\n\n\t\t},\n\n\t\tvertexShader: [\n\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\n\t\t\tTHREE.ShaderChunk[ \"morphtarget_pars_vertex\" ],\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_vertex\" ],\n\n\t\t\t\"void main() {\",\n\n\t\t\t\tTHREE.ShaderChunk[ \"begin_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"morphtarget_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"project_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_vertex\" ],\n\n\t\t\t\"}\"\n\n\t\t].join( \"\\n\" ),\n\n\t\tfragmentShader: [\n\n\t\t\t\"uniform float mNear;\",\n\t\t\t\"uniform float mFar;\",\n\t\t\t\"uniform float opacity;\",\n\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_fragment\" ],\n\n\t\t\t\"void main() {\",\n\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_fragment\" ],\n\n\t\t\t\"\t#ifdef USE_LOGDEPTHBUF_EXT\",\n\n\t\t\t\"\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\",\n\n\t\t\t\"\t#else\",\n\n\t\t\t\"\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\",\n\n\t\t\t\"\t#endif\",\n\n\t\t\t\"\tfloat color = 1.0 - smoothstep( mNear, mFar, depth );\",\n\t\t\t\"\tgl_FragColor = vec4( vec3( color ), opacity );\",\n\n\t\t\t\"}\"\n\n\t\t].join( \"\\n\" )\n\n\t},\n\n\t'normal': {\n\n\t\tuniforms: {\n\n\t\t\t\"opacity\" : { type: \"f\", value: 1.0 }\n\n\t\t},\n\n\t\tvertexShader: [\n\n\t\t\t\"varying vec3 vNormal;\",\n\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\n\t\t\tTHREE.ShaderChunk[ \"morphtarget_pars_vertex\" ],\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_vertex\" ],\n\n\t\t\t\"void main() {\",\n\n\t\t\t\"\tvNormal = normalize( normalMatrix * normal );\",\n\n\t\t\t\tTHREE.ShaderChunk[ \"begin_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"morphtarget_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"project_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_vertex\" ],\n\n\t\t\t\"}\"\n\n\t\t].join( \"\\n\" ),\n\n\t\tfragmentShader: [\n\n\t\t\t\"uniform float opacity;\",\n\t\t\t\"varying vec3 vNormal;\",\n\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_fragment\" ],\n\n\t\t\t\"void main() {\",\n\n\t\t\t\"\tgl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );\",\n\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_fragment\" ],\n\n\t\t\t\"}\"\n\n\t\t].join( \"\\n\" )\n\n\t},\n\n\t/* -------------------------------------------------------------------------\n\t//\tCube map shader\n\t ------------------------------------------------------------------------- */\n\n\t'cube': {\n\n\t\tuniforms: { \"tCube\": { type: \"t\", value: null },\n\t\t\t\t\t\"tFlip\": { type: \"f\", value: - 1 } },\n\n\t\tvertexShader: [\n\n\t\t\t\"varying vec3 vWorldPosition;\",\n\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_vertex\" ],\n\n\t\t\t\"void main() {\",\n\n\t\t\t\"\tvWorldPosition = transformDirection( position, modelMatrix );\",\n\n\t\t\t\"\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\n\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_vertex\" ],\n\n\t\t\t\"}\"\n\n\t\t].join( \"\\n\" ),\n\n\t\tfragmentShader: [\n\n\t\t\t\"uniform samplerCube tCube;\",\n\t\t\t\"uniform float tFlip;\",\n\n\t\t\t\"varying vec3 vWorldPosition;\",\n\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_fragment\" ],\n\n\t\t\t\"void main() {\",\n\n\t\t\t\"\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\",\n\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_fragment\" ],\n\n\t\t\t\"}\"\n\n\t\t].join( \"\\n\" )\n\n\t},\n\n\t/* -------------------------------------------------------------------------\n\t//\tCube map shader\n\t ------------------------------------------------------------------------- */\n\n\t'equirect': {\n\n\t\tuniforms: { \"tEquirect\": { type: \"t\", value: null },\n\t\t\t\t\t\"tFlip\": { type: \"f\", value: - 1 } },\n\n\t\tvertexShader: [\n\n\t\t\t\"varying vec3 vWorldPosition;\",\n\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_vertex\" ],\n\n\t\t\t\"void main() {\",\n\n\t\t\t\"\tvWorldPosition = transformDirection( position, modelMatrix );\",\n\n\t\t\t\"\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\n\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_vertex\" ],\n\n\t\t\t\"}\"\n\n\t\t].join( \"\\n\" ),\n\n\t\tfragmentShader: [\n\n\t\t\t\"uniform sampler2D tEquirect;\",\n\t\t\t\"uniform float tFlip;\",\n\n\t\t\t\"varying vec3 vWorldPosition;\",\n\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_fragment\" ],\n\n\t\t\t\"void main() {\",\n\n\t\t\t\t// \"\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\",\n\t\t\t\t\"vec3 direction = normalize( vWorldPosition );\",\n\t\t\t\t\"vec2 sampleUV;\",\n\t\t\t\t\"sampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );\",\n\t\t\t\t\"sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\",\n\t\t\t\t\"gl_FragColor = texture2D( tEquirect, sampleUV );\",\n\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_fragment\" ],\n\n\t\t\t\"}\"\n\n\t\t].join( \"\\n\" )\n\n\t},\n\n\t/* Depth encoding into RGBA texture\n\t *\n\t * based on SpiderGL shadow map example\n\t * http://spidergl.org/example.php?id=6\n\t *\n\t * originally from\n\t * http://www.gamedev.net/topic/442138-packing-a-float-into-a-a8r8g8b8-texture-shader/page__whichpage__1%25EF%25BF%25BD\n\t *\n\t * see also\n\t * http://aras-p.info/blog/2009/07/30/encoding-floats-to-rgba-the-final/\n\t */\n\n\t'depthRGBA': {\n\n\t\tuniforms: {},\n\n\t\tvertexShader: [\n\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\n\t\t\tTHREE.ShaderChunk[ \"morphtarget_pars_vertex\" ],\n\t\t\tTHREE.ShaderChunk[ \"skinning_pars_vertex\" ],\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_vertex\" ],\n\n\t\t\t\"void main() {\",\n\n\t\t\t\tTHREE.ShaderChunk[ \"skinbase_vertex\" ],\n\n\t\t\t\tTHREE.ShaderChunk[ \"begin_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"morphtarget_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"skinning_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"project_vertex\" ],\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_vertex\" ],\n\n\t\t\t\"}\"\n\n\t\t].join( \"\\n\" ),\n\n\t\tfragmentShader: [\n\n\t\t\tTHREE.ShaderChunk[ \"common\" ],\n\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_pars_fragment\" ],\n\n\t\t\t\"vec4 pack_depth( const in float depth ) {\",\n\n\t\t\t\"\tconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\",\n\t\t\t\"\tconst vec4 bit_mask = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\",\n\t\t\t\"\tvec4 res = mod( depth * bit_shift * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );\", // \"\tvec4 res = fract( depth * bit_shift );\",\n\t\t\t\"\tres -= res.xxyz * bit_mask;\",\n\t\t\t\"\treturn res;\",\n\n\t\t\t\"}\",\n\n\t\t\t\"void main() {\",\n\n\t\t\t\tTHREE.ShaderChunk[ \"logdepthbuf_fragment\" ],\n\n\t\t\t\"\t#ifdef USE_LOGDEPTHBUF_EXT\",\n\n\t\t\t\"\t\tgl_FragData[ 0 ] = pack_depth( gl_FragDepthEXT );\",\n\n\t\t\t\"\t#else\",\n\n\t\t\t\"\t\tgl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );\",\n\n\t\t\t\"\t#endif\",\n\n\t\t\t\t//\"gl_FragData[ 0 ] = pack_depth( gl_FragCoord.z / gl_FragCoord.w );\",\n\t\t\t\t//\"float z = ( ( gl_FragCoord.z / gl_FragCoord.w ) - 3.0 ) / ( 4000.0 - 3.0 );\",\n\t\t\t\t//\"gl_FragData[ 0 ] = pack_depth( z );\",\n\t\t\t\t//\"gl_FragData[ 0 ] = vec4( z, z, z, 1.0 );\",\n\n\t\t\t\"}\"\n\n\t\t].join( \"\\n\" )\n\n\t}\n\n};\n\n// File:src/renderers/WebGLRenderer.js\n\n/**\n * @author supereggbert / http://www.paulbrunt.co.uk/\n * @author mrdoob / http://mrdoob.com/\n * @author alteredq / http://alteredqualia.com/\n * @author szimek / https://github.com/szimek/\n */\n\nTHREE.WebGLRenderer = function ( parameters ) {\n\n\tconsole.log( 'THREE.WebGLRenderer', THREE.REVISION );\n\n\tparameters = parameters || {};\n\n\tvar _canvas = parameters.canvas !== undefined ? parameters.canvas : document.createElement( 'canvas' ),\n\t_context = parameters.context !== undefined ? parameters.context : null,\n\n\t_width = _canvas.width,\n\t_height = _canvas.height,\n\n\tpixelRatio = 1,\n\n\t_alpha = parameters.alpha !== undefined ? parameters.alpha : false,\n\t_depth = parameters.depth !== undefined ? parameters.depth : true,\n\t_stencil = parameters.stencil !== undefined ? parameters.stencil : true,\n\t_antialias = parameters.antialias !== undefined ? parameters.antialias : false,\n\t_premultipliedAlpha = parameters.premultipliedAlpha !== undefined ? parameters.premultipliedAlpha : true,\n\t_preserveDrawingBuffer = parameters.preserveDrawingBuffer !== undefined ? parameters.preserveDrawingBuffer : false,\n\n\t_clearColor = new THREE.Color( 0x000000 ),\n\t_clearAlpha = 0;\n\n\tvar lights = [];\n\n\tvar opaqueObjects = [];\n\tvar opaqueObjectsLastIndex = -1;\n\tvar transparentObjects = [];\n\tvar transparentObjectsLastIndex = -1;\n\n\tvar opaqueImmediateObjects = [];\n\tvar opaqueImmediateObjectsLastIndex = -1;\n\tvar transparentImmediateObjects = [];\n\tvar transparentImmediateObjectsLastIndex = -1;\n\n\tvar morphInfluences = new Float32Array( 8 );\n\n\n\tvar sprites = [];\n\tvar lensFlares = [];\n\n\t// public properties\n\n\tthis.domElement = _canvas;\n\tthis.context = null;\n\n\t// clearing\n\n\tthis.autoClear = true;\n\tthis.autoClearColor = true;\n\tthis.autoClearDepth = true;\n\tthis.autoClearStencil = true;\n\n\t// scene graph\n\n\tthis.sortObjects = true;\n\n\t// physically based shading\n\n\tthis.gammaFactor = 2.0;\t// for backwards compatibility\n\tthis.gammaInput = false;\n\tthis.gammaOutput = false;\n\n\t// morphs\n\n\tthis.maxMorphTargets = 8;\n\tthis.maxMorphNormals = 4;\n\n\t// flags\n\n\tthis.autoScaleCubemaps = true;\n\n\t// internal properties\n\n\tvar _this = this,\n\n\t// internal state cache\n\n\t_currentProgram = null,\n\t_currentFramebuffer = null,\n\t_currentMaterialId = - 1,\n\t_currentGeometryProgram = '',\n\t_currentCamera = null,\n\n\t_usedTextureUnits = 0,\n\n\t_viewportX = 0,\n\t_viewportY = 0,\n\t_viewportWidth = _canvas.width,\n\t_viewportHeight = _canvas.height,\n\t_currentWidth = 0,\n\t_currentHeight = 0,\n\n\t// frustum\n\n\t_frustum = new THREE.Frustum(),\n\n\t // camera matrices cache\n\n\t_projScreenMatrix = new THREE.Matrix4(),\n\n\t_vector3 = new THREE.Vector3(),\n\n\t// light arrays cache\n\n\t_direction = new THREE.Vector3(),\n\n\t_lightsNeedUpdate = true,\n\n\t_lights = {\n\n\t\tambient: [ 0, 0, 0 ],\n\t\tdirectional: { length: 0, colors: [], positions: [] },\n\t\tpoint: { length: 0, colors: [], positions: [], distances: [], decays: [] },\n\t\tspot: { length: 0, colors: [], positions: [], distances: [], directions: [], anglesCos: [], exponents: [], decays: [] },\n\t\themi: { length: 0, skyColors: [], groundColors: [], positions: [] }\n\n\t},\n\n\t// info\n\n\t_infoMemory = {\n\n\t\tgeometries: 0,\n\t\ttextures: 0\n\n\t},\n\n\t_infoRender = {\n\n\t\tcalls: 0,\n\t\tvertices: 0,\n\t\tfaces: 0,\n\t\tpoints: 0\n\n\t};\n\n\tthis.info = {\n\n\t\trender: _infoRender,\n\t\tmemory: _infoMemory,\n\t\tprograms: null\n\n\t};\n\n\n\t// initialize\n\n\tvar _gl;\n\n\ttry {\n\n\t\tvar attributes = {\n\t\t\talpha: _alpha,\n\t\t\tdepth: _depth,\n\t\t\tstencil: _stencil,\n\t\t\tantialias: _antialias,\n\t\t\tpremultipliedAlpha: _premultipliedAlpha,\n\t\t\tpreserveDrawingBuffer: _preserveDrawingBuffer\n\t\t};\n\n\t\t_gl = _context || _canvas.getContext( 'webgl', attributes ) || _canvas.getContext( 'experimental-webgl', attributes );\n\n\t\tif ( _gl === null ) {\n\n\t\t\tif ( _canvas.getContext( 'webgl' ) !== null ) {\n\n\t\t\t\tthrow 'Error creating WebGL context with your selected attributes.';\n\n\t\t\t} else {\n\n\t\t\t\tthrow 'Error creating WebGL context.';\n\n\t\t\t}\n\n\t\t}\n\n\t\t_canvas.addEventListener( 'webglcontextlost', onContextLost, false );\n\n\t} catch ( error ) {\n\n\t\tconsole.error( 'THREE.WebGLRenderer: ' + error );\n\n\t}\n\n\tvar extensions = new THREE.WebGLExtensions( _gl );\n\n\textensions.get( 'OES_texture_float' );\n\textensions.get( 'OES_texture_float_linear' );\n\textensions.get( 'OES_texture_half_float' );\n\textensions.get( 'OES_texture_half_float_linear' );\n\textensions.get( 'OES_standard_derivatives' );\n\textensions.get( 'ANGLE_instanced_arrays' );\n\n\tif ( extensions.get( 'OES_element_index_uint' ) ) {\n\n\t\tTHREE.BufferGeometry.MaxIndex = 4294967296;\n\n\t}\n\n\tvar capabilities = new THREE.WebGLCapabilities( _gl, extensions, parameters );\n\n\tvar state = new THREE.WebGLState( _gl, extensions, paramThreeToGL );\n\tvar properties = new THREE.WebGLProperties();\n\tvar objects = new THREE.WebGLObjects( _gl, properties, this.info );\n\tvar programCache = new THREE.WebGLPrograms( this, capabilities );\n\n\tthis.info.programs = programCache.programs;\n\n\tvar bufferRenderer = new THREE.WebGLBufferRenderer( _gl, extensions, _infoRender );\n\tvar indexedBufferRenderer = new THREE.WebGLIndexedBufferRenderer( _gl, extensions, _infoRender );\n\n\t//\n\n\tfunction glClearColor( r, g, b, a ) {\n\n\t\tif ( _premultipliedAlpha === true ) {\n\n\t\t\tr *= a; g *= a; b *= a;\n\n\t\t}\n\n\t\t_gl.clearColor( r, g, b, a );\n\n\t}\n\n\tfunction setDefaultGLState() {\n\n\t\tstate.init();\n\n\t\t_gl.viewport( _viewportX, _viewportY, _viewportWidth, _viewportHeight );\n\n\t\tglClearColor( _clearColor.r, _clearColor.g, _clearColor.b, _clearAlpha );\n\n\t}\n\n\tfunction resetGLState() {\n\n\t\t_currentProgram = null;\n\t\t_currentCamera = null;\n\n\t\t_currentGeometryProgram = '';\n\t\t_currentMaterialId = - 1;\n\n\t\t_lightsNeedUpdate = true;\n\n\t\tstate.reset();\n\n\t}\n\n\tsetDefaultGLState();\n\n\tthis.context = _gl;\n\tthis.capabilities = capabilities;\n\tthis.extensions = extensions;\n\tthis.state = state;\n\n\t// shadow map\n\n\tvar shadowMap = new THREE.WebGLShadowMap( this, lights, objects );\n\n\tthis.shadowMap = shadowMap;\n\n\n\t// Plugins\n\n\tvar spritePlugin = new THREE.SpritePlugin( this, sprites );\n\tvar lensFlarePlugin = new THREE.LensFlarePlugin( this, lensFlares );\n\n\t// API\n\n\tthis.getContext = function () {\n\n\t\treturn _gl;\n\n\t};\n\n\tthis.getContextAttributes = function () {\n\n\t\treturn _gl.getContextAttributes();\n\n\t};\n\n\tthis.forceContextLoss = function () {\n\n\t\textensions.get( 'WEBGL_lose_context' ).loseContext();\n\n\t};\n\n\tthis.getMaxAnisotropy = ( function () {\n\n\t\tvar value;\n\n\t\treturn function getMaxAnisotropy() {\n\n\t\t\tif ( value !== undefined ) return value;\n\n\t\t\tvar extension = extensions.get( 'EXT_texture_filter_anisotropic' );\n\n\t\t\tif ( extension !== null ) {\n\n\t\t\t\tvalue = _gl.getParameter( extension.MAX_TEXTURE_MAX_ANISOTROPY_EXT );\n\n\t\t\t} else {\n\n\t\t\t\tvalue = 0;\n\n\t\t\t}\n\n\t\t\treturn value;\n\n\t\t}\n\n\t} )();\n\n\tthis.getPrecision = function () {\n\n\t\treturn capabilities.precision;\n\n\t};\n\n\tthis.getPixelRatio = function () {\n\n\t\treturn pixelRatio;\n\n\t};\n\n\tthis.setPixelRatio = function ( value ) {\n\n\t\tif ( value !== undefined ) pixelRatio = value;\n\n\t};\n\n\tthis.getSize = function () {\n\n\t\treturn {\n\t\t\twidth: _width,\n\t\t\theight: _height\n\t\t};\n\n\t};\n\n\tthis.setSize = function ( width, height, updateStyle ) {\n\n\t\t_width = width;\n\t\t_height = height;\n\n\t\t_canvas.width = width * pixelRatio;\n\t\t_canvas.height = height * pixelRatio;\n\n\t\tif ( updateStyle !== false ) {\n\n\t\t\t_canvas.style.width = width + 'px';\n\t\t\t_canvas.style.height = height + 'px';\n\n\t\t}\n\n\t\tthis.setViewport( 0, 0, width, height );\n\n\t};\n\n\tthis.setViewport = function ( x, y, width, height ) {\n\n\t\t_viewportX = x * pixelRatio;\n\t\t_viewportY = y * pixelRatio;\n\n\t\t_viewportWidth = width * pixelRatio;\n\t\t_viewportHeight = height * pixelRatio;\n\n\t\t_gl.viewport( _viewportX, _viewportY, _viewportWidth, _viewportHeight );\n\n\t};\n\n\tthis.setScissor = function ( x, y, width, height ) {\n\n\t\t_gl.scissor(\n\t\t\tx * pixelRatio,\n\t\t\ty * pixelRatio,\n\t\t\twidth * pixelRatio,\n\t\t\theight * pixelRatio\n\t\t);\n\n\t};\n\n\tthis.enableScissorTest = function ( boolean ) {\n\n\t\tstate.setScissorTest( boolean );\n\n\t};\n\n\t// Clearing\n\n\tthis.getClearColor = function () {\n\n\t\treturn _clearColor;\n\n\t};\n\n\tthis.setClearColor = function ( color, alpha ) {\n\n\t\t_clearColor.set( color );\n\n\t\t_clearAlpha = alpha !== undefined ? alpha : 1;\n\n\t\tglClearColor( _clearColor.r, _clearColor.g, _clearColor.b, _clearAlpha );\n\n\t};\n\n\tthis.getClearAlpha = function () {\n\n\t\treturn _clearAlpha;\n\n\t};\n\n\tthis.setClearAlpha = function ( alpha ) {\n\n\t\t_clearAlpha = alpha;\n\n\t\tglClearColor( _clearColor.r, _clearColor.g, _clearColor.b, _clearAlpha );\n\n\t};\n\n\tthis.clear = function ( color, depth, stencil ) {\n\n\t\tvar bits = 0;\n\n\t\tif ( color === undefined || color ) bits |= _gl.COLOR_BUFFER_BIT;\n\t\tif ( depth === undefined || depth ) bits |= _gl.DEPTH_BUFFER_BIT;\n\t\tif ( stencil === undefined || stencil ) bits |= _gl.STENCIL_BUFFER_BIT;\n\n\t\t_gl.clear( bits );\n\n\t};\n\n\tthis.clearColor = function () {\n\n\t\t_gl.clear( _gl.COLOR_BUFFER_BIT );\n\n\t};\n\n\tthis.clearDepth = function () {\n\n\t\t_gl.clear( _gl.DEPTH_BUFFER_BIT );\n\n\t};\n\n\tthis.clearStencil = function () {\n\n\t\t_gl.clear( _gl.STENCIL_BUFFER_BIT );\n\n\t};\n\n\tthis.clearTarget = function ( renderTarget, color, depth, stencil ) {\n\n\t\tthis.setRenderTarget( renderTarget );\n\t\tthis.clear( color, depth, stencil );\n\n\t};\n\n\t// Reset\n\n\tthis.resetGLState = resetGLState;\n\n\tthis.dispose = function() {\n\n\t\t_canvas.removeEventListener( 'webglcontextlost', onContextLost, false );\n\n\t};\n\n\t// Events\n\n\tfunction onContextLost( event ) {\n\n\t\tevent.preventDefault();\n\n\t\tresetGLState();\n\t\tsetDefaultGLState();\n\n\t\tproperties.clear();\n\n\t};\n\n\tfunction onTextureDispose( event ) {\n\n\t\tvar texture = event.target;\n\n\t\ttexture.removeEventListener( 'dispose', onTextureDispose );\n\n\t\tdeallocateTexture( texture );\n\n\t\t_infoMemory.textures --;\n\n\n\t}\n\n\tfunction onRenderTargetDispose( event ) {\n\n\t\tvar renderTarget = event.target;\n\n\t\trenderTarget.removeEventListener( 'dispose', onRenderTargetDispose );\n\n\t\tdeallocateRenderTarget( renderTarget );\n\n\t\t_infoMemory.textures --;\n\n\t}\n\n\tfunction onMaterialDispose( event ) {\n\n\t\tvar material = event.target;\n\n\t\tmaterial.removeEventListener( 'dispose', onMaterialDispose );\n\n\t\tdeallocateMaterial( material );\n\n\t}\n\n\t// Buffer deallocation\n\n\tfunction deallocateTexture( texture ) {\n\n\t\tvar textureProperties = properties.get( texture );\n\n\t\tif ( texture.image && textureProperties.__image__webglTextureCube ) {\n\n\t\t\t// cube texture\n\n\t\t\t_gl.deleteTexture( textureProperties.__image__webglTextureCube );\n\n\t\t} else {\n\n\t\t\t// 2D texture\n\n\t\t\tif ( textureProperties.__webglInit === undefined ) return;\n\n\t\t\t_gl.deleteTexture( textureProperties.__webglTexture );\n\n\t\t}\n\n\t\t// remove all webgl properties\n\t\tproperties.delete( texture );\n\n\t}\n\n\tfunction deallocateRenderTarget( renderTarget ) {\n\n\t\tvar renderTargetProperties = properties.get( renderTarget );\n\n\t\tif ( ! renderTarget || renderTargetProperties.__webglTexture === undefined ) return;\n\n\t\t_gl.deleteTexture( renderTargetProperties.__webglTexture );\n\n\t\tif ( renderTarget instanceof THREE.WebGLRenderTargetCube ) {\n\n\t\t\tfor ( var i = 0; i < 6; i ++ ) {\n\n\t\t\t\t_gl.deleteFramebuffer( renderTargetProperties.__webglFramebuffer[ i ] );\n\t\t\t\t_gl.deleteRenderbuffer( renderTargetProperties.__webglRenderbuffer[ i ] );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t_gl.deleteFramebuffer( renderTargetProperties.__webglFramebuffer );\n\t\t\t_gl.deleteRenderbuffer( renderTargetProperties.__webglRenderbuffer );\n\n\t\t}\n\n\t\tproperties.delete( renderTarget );\n\n\t}\n\n\tfunction deallocateMaterial( material ) {\n\n\t\treleaseMaterialProgramReference( material );\n\n\t\tproperties.delete( material );\n\n\t}\n\n\n\tfunction releaseMaterialProgramReference( material ) {\n\n\t\tvar programInfo = properties.get( material ).program;\n\n\t\tmaterial.program = undefined;\n\n\t\tif ( programInfo !== undefined ) {\n\n\t\t\tprogramCache.releaseProgram( programInfo );\n\t\t}\n\n\t}\n\n\t// Buffer rendering\n\n\tthis.renderBufferImmediate = function ( object, program, material ) {\n\n\t\tstate.initAttributes();\n\n\t\tvar buffers = properties.get( object );\n\n\t\tif ( object.hasPositions && ! buffers.position ) buffers.position = _gl.createBuffer();\n\t\tif ( object.hasNormals && ! buffers.normal ) buffers.normal = _gl.createBuffer();\n\t\tif ( object.hasUvs && ! buffers.uv ) buffers.uv = _gl.createBuffer();\n\t\tif ( object.hasColors && ! buffers.color ) buffers.color = _gl.createBuffer();\n\n\t\tvar attributes = program.getAttributes();\n\n\t\tif ( object.hasPositions ) {\n\n\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffers.position );\n\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, object.positionArray, _gl.DYNAMIC_DRAW );\n\n\t\t\tstate.enableAttribute( attributes.position );\n\t\t\t_gl.vertexAttribPointer( attributes.position, 3, _gl.FLOAT, false, 0, 0 );\n\n\t\t}\n\n\t\tif ( object.hasNormals ) {\n\n\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffers.normal );\n\n\t\t\tif ( material.type !== 'MeshPhongMaterial' && material.shading === THREE.FlatShading ) {\n\n\t\t\t\tfor ( var i = 0, l = object.count * 3; i < l; i += 9 ) {\n\n\t\t\t\t\tvar array = object.normalArray;\n\n\t\t\t\t\tvar nx = ( array[ i + 0 ] + array[ i + 3 ] + array[ i + 6 ] ) / 3;\n\t\t\t\t\tvar ny = ( array[ i + 1 ] + array[ i + 4 ] + array[ i + 7 ] ) / 3;\n\t\t\t\t\tvar nz = ( array[ i + 2 ] + array[ i + 5 ] + array[ i + 8 ] ) / 3;\n\n\t\t\t\t\tarray[ i + 0 ] = nx;\n\t\t\t\t\tarray[ i + 1 ] = ny;\n\t\t\t\t\tarray[ i + 2 ] = nz;\n\n\t\t\t\t\tarray[ i + 3 ] = nx;\n\t\t\t\t\tarray[ i + 4 ] = ny;\n\t\t\t\t\tarray[ i + 5 ] = nz;\n\n\t\t\t\t\tarray[ i + 6 ] = nx;\n\t\t\t\t\tarray[ i + 7 ] = ny;\n\t\t\t\t\tarray[ i + 8 ] = nz;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, object.normalArray, _gl.DYNAMIC_DRAW );\n\n\t\t\tstate.enableAttribute( attributes.normal );\n\n\t\t\t_gl.vertexAttribPointer( attributes.normal, 3, _gl.FLOAT, false, 0, 0 );\n\n\t\t}\n\n\t\tif ( object.hasUvs && material.map ) {\n\n\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffers.uv );\n\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, object.uvArray, _gl.DYNAMIC_DRAW );\n\n\t\t\tstate.enableAttribute( attributes.uv );\n\n\t\t\t_gl.vertexAttribPointer( attributes.uv, 2, _gl.FLOAT, false, 0, 0 );\n\n\t\t}\n\n\t\tif ( object.hasColors && material.vertexColors !== THREE.NoColors ) {\n\n\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffers.color );\n\t\t\t_gl.bufferData( _gl.ARRAY_BUFFER, object.colorArray, _gl.DYNAMIC_DRAW );\n\n\t\t\tstate.enableAttribute( attributes.color );\n\n\t\t\t_gl.vertexAttribPointer( attributes.color, 3, _gl.FLOAT, false, 0, 0 );\n\n\t\t}\n\n\t\tstate.disableUnusedAttributes();\n\n\t\t_gl.drawArrays( _gl.TRIANGLES, 0, object.count );\n\n\t\tobject.count = 0;\n\n\t};\n\n\tthis.renderBufferDirect = function ( camera, lights, fog, geometry, material, object, group ) {\n\n\t\tsetMaterial( material );\n\n\t\tvar program = setProgram( camera, lights, fog, material, object );\n\n\t\tvar updateBuffers = false;\n\t\tvar geometryProgram = geometry.id + '_' + program.id + '_' + material.wireframe;\n\n\t\tif ( geometryProgram !== _currentGeometryProgram ) {\n\n\t\t\t_currentGeometryProgram = geometryProgram;\n\t\t\tupdateBuffers = true;\n\n\t\t}\n\n\t\t// morph targets\n\n\t\tvar morphTargetInfluences = object.morphTargetInfluences;\n\n\t\tif ( morphTargetInfluences !== undefined ) {\n\n\t\t\tvar activeInfluences = [];\n\n\t\t\tfor ( var i = 0, l = morphTargetInfluences.length; i < l; i ++ ) {\n\n\t\t\t\tvar influence = morphTargetInfluences[ i ];\n\t\t\t\tactiveInfluences.push( [ influence, i ] );\n\n\t\t\t}\n\n\t\t\tactiveInfluences.sort( numericalSort );\n\n\t\t\tif ( activeInfluences.length > 8 ) {\n\n\t\t\t\tactiveInfluences.length = 8;\n\n\t\t\t}\n\n\t\t\tvar morphAttributes = geometry.morphAttributes;\n\n\t\t\tfor ( var i = 0, l = activeInfluences.length; i < l; i ++ ) {\n\n\t\t\t\tvar influence = activeInfluences[ i ];\n\t\t\t\tmorphInfluences[ i ] = influence[ 0 ];\n\n\t\t\t\tif ( influence[ 0 ] !== 0 ) {\n\n\t\t\t\t\tvar index = influence[ 1 ];\n\n\t\t\t\t\tif ( material.morphTargets === true && morphAttributes.position ) geometry.addAttribute( 'morphTarget' + i, morphAttributes.position[ index ] );\n\t\t\t\t\tif ( material.morphNormals === true && morphAttributes.normal ) geometry.addAttribute( 'morphNormal' + i, morphAttributes.normal[ index ] );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( material.morphTargets === true ) geometry.removeAttribute( 'morphTarget' + i );\n\t\t\t\t\tif ( material.morphNormals === true ) geometry.removeAttribute( 'morphNormal' + i );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar uniforms = program.getUniforms();\n\n\t\t\tif ( uniforms.morphTargetInfluences !== null ) {\n\n\t\t\t\t_gl.uniform1fv( uniforms.morphTargetInfluences, morphInfluences );\n\n\t\t\t}\n\n\t\t\tupdateBuffers = true;\n\n\t\t}\n\n\t\t//\n\n\t\tvar index = geometry.index;\n\t\tvar position = geometry.attributes.position;\n\n\t\tif ( material.wireframe === true ) {\n\n\t\t\tindex = objects.getWireframeAttribute( geometry );\n\n\t\t}\n\n\t\tvar renderer;\n\n\t\tif ( index !== null ) {\n\n\t\t\trenderer = indexedBufferRenderer;\n\t\t\trenderer.setIndex( index );\n\n\t\t} else {\n\n\t\t\trenderer = bufferRenderer;\n\n\t\t}\n\n\t\tif ( updateBuffers ) {\n\n\t\t\tsetupVertexAttributes( material, program, geometry );\n\n\t\t\tif ( index !== null ) {\n\n\t\t\t\t_gl.bindBuffer( _gl.ELEMENT_ARRAY_BUFFER, objects.getAttributeBuffer( index ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( group === undefined ) {\n\n\t\t\tvar count;\n\n\t\t\tif ( index !== null ) {\n\n\t\t\t\tcount = index.count;\n\n\t\t\t} else if ( position instanceof THREE.InterleavedBufferAttribute ) {\n\n\t\t\t\tcount = position.data.array.length / 3;\n\n\t\t\t} else {\n\n\t\t\t\tcount = position.count;\n\n\t\t\t}\n\n\t\t\tvar drawRange = geometry.drawRange;\n\n\t\t\tgroup = {\n\t\t\t\tstart: drawRange.start,\n\t\t\t\tcount: Math.min( drawRange.count, count )\n\t\t\t};\n\n\t\t}\n\n\t\tif ( object instanceof THREE.Mesh ) {\n\n\t\t\tif ( material.wireframe === true ) {\n\n\t\t\t\tstate.setLineWidth( material.wireframeLinewidth * pixelRatio );\n\t\t\t\trenderer.setMode( _gl.LINES );\n\n\t\t\t} else {\n\n\t\t\t\trenderer.setMode( _gl.TRIANGLES );\n\n\t\t\t}\n\n\t\t\tif ( geometry instanceof THREE.InstancedBufferGeometry && geometry.maxInstancedCount > 0 ) {\n\n\t\t\t\trenderer.renderInstances( geometry );\n\n\t\t\t} else {\n\n\t\t\t\trenderer.render( group.start, group.count );\n\n\t\t\t}\n\n\t\t} else if ( object instanceof THREE.Line ) {\n\n\t\t\tvar lineWidth = material.linewidth;\n\n\t\t\tif ( lineWidth === undefined ) lineWidth = 1; // Not using Line*Material\n\n\t\t\tstate.setLineWidth( lineWidth * pixelRatio );\n\n\t\t\tif ( object instanceof THREE.LineSegments ) {\n\n\t\t\t\trenderer.setMode( _gl.LINES );\n\n\t\t\t} else {\n\n\t\t\t\trenderer.setMode( _gl.LINE_STRIP );\n\n\t\t\t}\n\n\t\t\trenderer.render( group.start, group.count );\n\n\t\t} else if ( object instanceof THREE.Points ) {\n\n\t\t\trenderer.setMode( _gl.POINTS );\n\t\t\trenderer.render( group.start, group.count );\n\n\t\t}\n\n\t};\n\n\tfunction setupVertexAttributes( material, program, geometry, startIndex ) {\n\n\t\tvar extension;\n\n\t\tif ( geometry instanceof THREE.InstancedBufferGeometry ) {\n\n\t\t\textension = extensions.get( 'ANGLE_instanced_arrays' );\n\n\t\t\tif ( extension === null ) {\n\n\t\t\t\tconsole.error( 'THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.' );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( startIndex === undefined ) startIndex = 0;\n\n\t\tstate.initAttributes();\n\n\t\tvar geometryAttributes = geometry.attributes;\n\n\t\tvar programAttributes = program.getAttributes();\n\n\t\tvar materialDefaultAttributeValues = material.defaultAttributeValues;\n\n\t\tfor ( var name in programAttributes ) {\n\n\t\t\tvar programAttribute = programAttributes[ name ];\n\n\t\t\tif ( programAttribute >= 0 ) {\n\n\t\t\t\tvar geometryAttribute = geometryAttributes[ name ];\n\n\t\t\t\tif ( geometryAttribute !== undefined ) {\n\n\t\t\t\t\tstate.enableAttribute( programAttribute );\n\n\t\t\t\t\tvar size = geometryAttribute.itemSize;\n\t\t\t\t\tvar buffer = objects.getAttributeBuffer( geometryAttribute );\n\n\t\t\t\t\tif ( geometryAttribute instanceof THREE.InterleavedBufferAttribute ) {\n\n\t\t\t\t\t\tvar data = geometryAttribute.data;\n\t\t\t\t\t\tvar stride = data.stride;\n\t\t\t\t\t\tvar offset = geometryAttribute.offset;\n\n\t\t\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffer );\n\t\t\t\t\t\t_gl.vertexAttribPointer( programAttribute, size, _gl.FLOAT, false, stride * data.array.BYTES_PER_ELEMENT, ( startIndex * stride + offset ) * data.array.BYTES_PER_ELEMENT );\n\n\t\t\t\t\t\tif ( data instanceof THREE.InstancedInterleavedBuffer ) {\n\n\t\t\t\t\t\t\tif ( extension === null ) {\n\n\t\t\t\t\t\t\t\tconsole.error( 'THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferAttribute but hardware does not support extension ANGLE_instanced_arrays.' );\n\t\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\textension.vertexAttribDivisorANGLE( programAttribute, data.meshPerAttribute );\n\n\t\t\t\t\t\t\tif ( geometry.maxInstancedCount === undefined ) {\n\n\t\t\t\t\t\t\t\tgeometry.maxInstancedCount = data.meshPerAttribute * data.count;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t_gl.bindBuffer( _gl.ARRAY_BUFFER, buffer );\n\t\t\t\t\t\t_gl.vertexAttribPointer( programAttribute, size, _gl.FLOAT, false, 0, startIndex * size * 4 ); // 4 bytes per Float32\n\n\t\t\t\t\t\tif ( geometryAttribute instanceof THREE.InstancedBufferAttribute ) {\n\n\t\t\t\t\t\t\tif ( extension === null ) {\n\n\t\t\t\t\t\t\t\tconsole.error( 'THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferAttribute but hardware does not support extension ANGLE_instanced_arrays.' );\n\t\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\textension.vertexAttribDivisorANGLE( programAttribute, geometryAttribute.meshPerAttribute );\n\n\t\t\t\t\t\t\tif ( geometry.maxInstancedCount === undefined ) {\n\n\t\t\t\t\t\t\t\tgeometry.maxInstancedCount = geometryAttribute.meshPerAttribute * geometryAttribute.count;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( materialDefaultAttributeValues !== undefined ) {\n\n\t\t\t\t\tvar value = materialDefaultAttributeValues[ name ];\n\n\t\t\t\t\tif ( value !== undefined ) {\n\n\t\t\t\t\t\tswitch ( value.length ) {\n\n\t\t\t\t\t\t\tcase 2:\n\t\t\t\t\t\t\t\t_gl.vertexAttrib2fv( programAttribute, value );\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase 3:\n\t\t\t\t\t\t\t\t_gl.vertexAttrib3fv( programAttribute, value );\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase 4:\n\t\t\t\t\t\t\t\t_gl.vertexAttrib4fv( programAttribute, value );\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t_gl.vertexAttrib1fv( programAttribute, value );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tstate.disableUnusedAttributes();\n\n\t}\n\n\t// Sorting\n\n\tfunction numericalSort ( a, b ) {\n\n\t\treturn b[ 0 ] - a[ 0 ];\n\n\t}\n\n\tfunction painterSortStable ( a, b ) {\n\n\t\tif ( a.object.renderOrder !== b.object.renderOrder ) {\n\n\t\t\treturn a.object.renderOrder - b.object.renderOrder;\n\n\t\t} else if ( a.material.id !== b.material.id ) {\n\n\t\t\treturn a.material.id - b.material.id;\n\n\t\t} else if ( a.z !== b.z ) {\n\n\t\t\treturn a.z - b.z;\n\n\t\t} else {\n\n\t\t\treturn a.id - b.id;\n\n\t\t}\n\n\t}\n\n\tfunction reversePainterSortStable ( a, b ) {\n\n\t\tif ( a.object.renderOrder !== b.object.renderOrder ) {\n\n\t\t\treturn a.object.renderOrder - b.object.renderOrder;\n\n\t\t} if ( a.z !== b.z ) {\n\n\t\t\treturn b.z - a.z;\n\n\t\t} else {\n\n\t\t\treturn a.id - b.id;\n\n\t\t}\n\n\t}\n\n\t// Rendering\n\n\tthis.render = function ( scene, camera, renderTarget, forceClear ) {\n\n\t\tif ( camera instanceof THREE.Camera === false ) {\n\n\t\t\tconsole.error( 'THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tvar fog = scene.fog;\n\n\t\t// reset caching for this frame\n\n\t\t_currentGeometryProgram = '';\n\t\t_currentMaterialId = - 1;\n\t\t_currentCamera = null;\n\t\t_lightsNeedUpdate = true;\n\n\t\t// update scene graph\n\n\t\tif ( scene.autoUpdate === true ) scene.updateMatrixWorld();\n\n\t\t// update camera matrices and frustum\n\n\t\tif ( camera.parent === null ) camera.updateMatrixWorld();\n\n\t\tcamera.matrixWorldInverse.getInverse( camera.matrixWorld );\n\n\t\t_projScreenMatrix.multiplyMatrices( camera.projectionMatrix, camera.matrixWorldInverse );\n\t\t_frustum.setFromMatrix( _projScreenMatrix );\n\n\t\tlights.length = 0;\n\n\t\topaqueObjectsLastIndex = -1;\n\t\ttransparentObjectsLastIndex = -1;\n\n\t\topaqueImmediateObjectsLastIndex = -1;\n\t\ttransparentImmediateObjectsLastIndex = -1;\n\n\t\tsprites.length = 0;\n\t\tlensFlares.length = 0;\n\n\t\tprojectObject( scene );\n\n\t\topaqueObjects.length = opaqueObjectsLastIndex + 1;\n\t\ttransparentObjects.length = transparentObjectsLastIndex + 1;\n\n\t\topaqueImmediateObjects.length = opaqueImmediateObjectsLastIndex + 1;\n\t\ttransparentImmediateObjects.length = transparentImmediateObjectsLastIndex + 1;\n\n\t\tif ( _this.sortObjects === true ) {\n\n\t\t\topaqueObjects.sort( painterSortStable );\n\t\t\ttransparentObjects.sort( reversePainterSortStable );\n\n\t\t}\n\n\t\t//\n\n\t\tshadowMap.render( scene, camera );\n\n\t\t//\n\n\t\t_infoRender.calls = 0;\n\t\t_infoRender.vertices = 0;\n\t\t_infoRender.faces = 0;\n\t\t_infoRender.points = 0;\n\n\t\tthis.setRenderTarget( renderTarget );\n\n\t\tif ( this.autoClear || forceClear ) {\n\n\t\t\tthis.clear( this.autoClearColor, this.autoClearDepth, this.autoClearStencil );\n\n\t\t}\n\n\t\t//\n\n\t\tif ( scene.overrideMaterial ) {\n\n\t\t\tvar overrideMaterial = scene.overrideMaterial;\n\n\t\t\trenderObjects( opaqueObjects, camera, lights, fog, overrideMaterial );\n\t\t\trenderObjects( transparentObjects, camera, lights, fog, overrideMaterial );\n\n\t\t\trenderObjectsImmediate( opaqueImmediateObjects, camera, lights, fog, overrideMaterial );\n\t\t\trenderObjectsImmediate( transparentImmediateObjects, camera, lights, fog, overrideMaterial );\n\n\t\t} else {\n\n\t\t\t// opaque pass (front-to-back order)\n\n\t\t\tstate.setBlending( THREE.NoBlending );\n\n\t\t\trenderObjects( opaqueObjects, camera, lights, fog );\n\t\t\trenderObjectsImmediate( opaqueImmediateObjects, camera, lights, fog );\n\n\t\t\t// transparent pass (back-to-front order)\n\n\t\t\trenderObjects( transparentObjects, camera, lights, fog );\n\t\t\trenderObjectsImmediate( transparentImmediateObjects, camera, lights, fog );\n\n\t\t}\n\n\t\t// custom render plugins (post pass)\n\n\t\tspritePlugin.render( scene, camera );\n\t\tlensFlarePlugin.render( scene, camera, _currentWidth, _currentHeight );\n\n\t\t// Generate mipmap if we're using any kind of mipmap filtering\n\n\t\tif ( renderTarget && renderTarget.generateMipmaps && renderTarget.minFilter !== THREE.NearestFilter && renderTarget.minFilter !== THREE.LinearFilter ) {\n\n\t\t\tupdateRenderTargetMipmap( renderTarget );\n\n\t\t}\n\n\t\t// Ensure depth buffer writing is enabled so it can be cleared on next render\n\n\t\tstate.setDepthTest( true );\n\t\tstate.setDepthWrite( true );\n\t\tstate.setColorWrite( true );\n\n\t\t// _gl.finish();\n\n\t};\n\n\tfunction pushImmediateRenderItem( object ) {\n\n\t\tvar array, index;\n\n\t\t// allocate the next position in the appropriate array\n\n\t\tif ( object.material.transparent ) {\n\n\t\t\tarray = transparentImmediateObjects;\n\t\t\tindex = ++ transparentImmediateObjectsLastIndex;\n\n\t\t} else {\n\n\t\t\tarray = opaqueImmediateObjects;\n\t\t\tindex = ++ opaqueImmediateObjectsLastIndex;\n\n\t\t}\n\n\t\t// recycle existing position or grow the array\n\n\t\tif ( index < array.length ) {\n\n\t\t\tarray[ index ] = object;\n\n\t\t} else {\n\n\t\t\t// assert( index === array.length );\n\t\t\tarray.push( object );\n\n\t\t}\n\n\n\t}\n\n\tfunction pushRenderItem( object, geometry, material, z, group ) {\n\n\t\tvar array, index;\n\n\t\t// allocate the next position in the appropriate array\n\n\t\tif ( material.transparent ) {\n\n\t\t\tarray = transparentObjects;\n\t\t\tindex = ++ transparentObjectsLastIndex;\n\n\t\t} else {\n\n\t\t\tarray = opaqueObjects;\n\t\t\tindex = ++ opaqueObjectsLastIndex;\n\n\t\t}\n\n\t\t// recycle existing render item or grow the array\n\n\t\tvar renderItem = array[ index ];\n\n\t\tif ( renderItem !== undefined ) {\n\n\t\t\trenderItem.id = object.id;\n\t\t\trenderItem.object = object;\n\t\t\trenderItem.geometry = geometry;\n\t\t\trenderItem.material = material;\n\t\t\trenderItem.z = _vector3.z;\n\t\t\trenderItem.group = group;\n\n\t\t} else {\n\n\t\t\trenderItem = {\n\t\t\t\tid: object.id,\n\t\t\t\tobject: object,\n\t\t\t\tgeometry: geometry,\n\t\t\t\tmaterial: material,\n\t\t\t\tz: _vector3.z,\n\t\t\t\tgroup: group\n\t\t\t};\n\n\t\t\t// assert( index === array.length );\n\t\t\tarray.push( renderItem );\n\n\t\t}\n\n\t}\n\n\tfunction projectObject( object ) {\n\n\t\tif ( object.visible === false ) return;\n\n\t\tif ( object instanceof THREE.Light ) {\n\n\t\t\tlights.push( object );\n\n\t\t} else if ( object instanceof THREE.Sprite ) {\n\n\t\t\tsprites.push( object );\n\n\t\t} else if ( object instanceof THREE.LensFlare ) {\n\n\t\t\tlensFlares.push( object );\n\n\t\t} else if ( object instanceof THREE.ImmediateRenderObject ) {\n\n\t\t\tpushImmediateRenderItem( object );\n\n\t\t} else if ( object instanceof THREE.Mesh || object instanceof THREE.Line || object instanceof THREE.Points ) {\n\n\t\t\tif ( object instanceof THREE.SkinnedMesh ) {\n\n\t\t\t\tobject.skeleton.update();\n\n\t\t\t}\n\n\t\t\tif ( object.frustumCulled === false || _frustum.intersectsObject( object ) === true ) {\n\n\t\t\t\tvar material = object.material;\n\n\t\t\t\tif ( material.visible === true ) {\n\n\t\t\t\t\tif ( _this.sortObjects === true ) {\n\n\t\t\t\t\t\t_vector3.setFromMatrixPosition( object.matrixWorld );\n\t\t\t\t\t\t_vector3.applyProjection( _projScreenMatrix );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tvar geometry = objects.update( object );\n\n\t\t\t\t\tif ( material instanceof THREE.MeshFaceMaterial ) {\n\n\t\t\t\t\t\tvar groups = geometry.groups;\n\t\t\t\t\t\tvar materials = material.materials;\n\n\t\t\t\t\t\tfor ( var i = 0, l = groups.length; i < l; i ++ ) {\n\n\t\t\t\t\t\t\tvar group = groups[ i ];\n\t\t\t\t\t\t\tvar groupMaterial = materials[ group.materialIndex ];\n\n\t\t\t\t\t\t\tif ( groupMaterial.visible === true ) {\n\n\t\t\t\t\t\t\t\tpushRenderItem( object, geometry, groupMaterial, _vector3.z, group );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tpushRenderItem( object, geometry, material, _vector3.z );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tvar children = object.children;\n\n\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\tprojectObject( children[ i ] );\n\n\t\t}\n\n\t}\n\n\tfunction renderObjects( renderList, camera, lights, fog, overrideMaterial ) {\n\n\t\tfor ( var i = 0, l = renderList.length; i < l; i ++ ) {\n\n\t\t\tvar renderItem = renderList[ i ];\n\n\t\t\tvar object = renderItem.object;\n\t\t\tvar geometry = renderItem.geometry;\n\t\t\tvar material = overrideMaterial === undefined ? renderItem.material : overrideMaterial;\n\t\t\tvar group = renderItem.group;\n\n\t\t\tobject.modelViewMatrix.multiplyMatrices( camera.matrixWorldInverse, object.matrixWorld );\n\t\t\tobject.normalMatrix.getNormalMatrix( object.modelViewMatrix );\n\n\t\t\t_this.renderBufferDirect( camera, lights, fog, geometry, material, object, group );\n\n\t\t}\n\n\t}\n\n\tfunction renderObjectsImmediate( renderList, camera, lights, fog, overrideMaterial ) {\n\n\t\tvar material = overrideMaterial;\n\n\t\tfor ( var i = 0, l = renderList.length; i < l; i ++ ) {\n\n\t\t\tvar object = renderList[ i ];\n\n\t\t\tobject.modelViewMatrix.multiplyMatrices( camera.matrixWorldInverse, object.matrixWorld );\n\t\t\tobject.normalMatrix.getNormalMatrix( object.modelViewMatrix );\n\n\t\t\tif ( overrideMaterial === undefined ) material = object.material;\n\n\t\t\tsetMaterial( material );\n\n\t\t\tvar program = setProgram( camera, lights, fog, material, object );\n\n\t\t\t_currentGeometryProgram = '';\n\n\t\t\tobject.render( function ( object ) {\n\n\t\t\t\t_this.renderBufferImmediate( object, program, material );\n\n\t\t\t} );\n\n\t\t}\n\n\t}\n\n\tfunction initMaterial( material, lights, fog, object ) {\n\n\t\tvar materialProperties = properties.get( material );\n\n\t\tvar parameters = programCache.getParameters( material, lights, fog, object );\n\t\tvar code = programCache.getProgramCode( material, parameters );\n\n\t\tvar program = materialProperties.program;\n\t\tvar programChange = true;\n\n\t\tif ( program === undefined ) {\n\n\t\t\t// new material\n\t\t\tmaterial.addEventListener( 'dispose', onMaterialDispose );\n\n\t\t} else if ( program.code !== code ) {\n\n\t\t\t// changed glsl or parameters\n\t\t\treleaseMaterialProgramReference( material );\n\n\t\t} else if ( parameters.shaderID !== undefined ) {\n\n\t\t\t// same glsl and uniform list\n\t\t\treturn;\n\n\t\t} else {\n\n\t\t\t// only rebuild uniform list\n\t\t\tprogramChange = false;\n\n\t\t}\n\n\t\tif ( programChange ) {\n\n\t\t\tif ( parameters.shaderID ) {\n\n\t\t\t\tvar shader = THREE.ShaderLib[ parameters.shaderID ];\n\n\t\t\t\tmaterialProperties.__webglShader = {\n\t\t\t\t\tname: material.type,\n\t\t\t\t\tuniforms: THREE.UniformsUtils.clone( shader.uniforms ),\n\t\t\t\t\tvertexShader: shader.vertexShader,\n\t\t\t\t\tfragmentShader: shader.fragmentShader\n\t\t\t\t};\n\n\t\t\t} else {\n\n\t\t\t\tmaterialProperties.__webglShader = {\n\t\t\t\t\tname: material.type,\n\t\t\t\t\tuniforms: material.uniforms,\n\t\t\t\t\tvertexShader: material.vertexShader,\n\t\t\t\t\tfragmentShader: material.fragmentShader\n\t\t\t\t};\n\n\t\t\t}\n\n\t\t\tmaterial.__webglShader = materialProperties.__webglShader;\n\n\t\t\tprogram = programCache.acquireProgram( material, parameters, code );\n\n\t\t\tmaterialProperties.program = program;\n\t\t\tmaterial.program = program;\n\n\t\t}\n\n\t\tvar attributes = program.getAttributes();\n\n\t\tif ( material.morphTargets ) {\n\n\t\t\tmaterial.numSupportedMorphTargets = 0;\n\n\t\t\tfor ( var i = 0; i < _this.maxMorphTargets; i ++ ) {\n\n\t\t\t\tif ( attributes[ 'morphTarget' + i ] >= 0 ) {\n\n\t\t\t\t\tmaterial.numSupportedMorphTargets ++;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( material.morphNormals ) {\n\n\t\t\tmaterial.numSupportedMorphNormals = 0;\n\n\t\t\tfor ( i = 0; i < _this.maxMorphNormals; i ++ ) {\n\n\t\t\t\tif ( attributes[ 'morphNormal' + i ] >= 0 ) {\n\n\t\t\t\t\tmaterial.numSupportedMorphNormals ++;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tmaterialProperties.uniformsList = [];\n\n\t\tvar uniformLocations = materialProperties.program.getUniforms();\n\n\t\tfor ( var u in materialProperties.__webglShader.uniforms ) {\n\n\t\t\tvar location = uniformLocations[ u ];\n\n\t\t\tif ( location ) {\n\n\t\t\t\tmaterialProperties.uniformsList.push( [ materialProperties.__webglShader.uniforms[ u ], location ] );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tfunction setMaterial( material ) {\n\n\t\tsetMaterialFaces( material );\n\n\t\tif ( material.transparent === true ) {\n\n\t\t\tstate.setBlending( material.blending, material.blendEquation, material.blendSrc, material.blendDst, material.blendEquationAlpha, material.blendSrcAlpha, material.blendDstAlpha );\n\n\t\t} else {\n\n\t\t\tstate.setBlending( THREE.NoBlending );\n\n\t\t}\n\n\t\tstate.setDepthFunc( material.depthFunc );\n\t\tstate.setDepthTest( material.depthTest );\n\t\tstate.setDepthWrite( material.depthWrite );\n\t\tstate.setColorWrite( material.colorWrite );\n\t\tstate.setPolygonOffset( material.polygonOffset, material.polygonOffsetFactor, material.polygonOffsetUnits );\n\n\t}\n\n\tfunction setMaterialFaces( material ) {\n\n\t\tmaterial.side !== THREE.DoubleSide ? state.enable( _gl.CULL_FACE ) : state.disable( _gl.CULL_FACE );\n\t\tstate.setFlipSided( material.side === THREE.BackSide );\n\n\t}\n\n\tfunction setProgram( camera, lights, fog, material, object ) {\n\n\t\t_usedTextureUnits = 0;\n\n\t\tvar materialProperties = properties.get( material );\n\n\t\tif ( material.needsUpdate || ! materialProperties.program ) {\n\n\t\t\tinitMaterial( material, lights, fog, object );\n\t\t\tmaterial.needsUpdate = false;\n\n\t\t}\n\n\t\tvar refreshProgram = false;\n\t\tvar refreshMaterial = false;\n\t\tvar refreshLights = false;\n\n\t\tvar program = materialProperties.program,\n\t\t\tp_uniforms = program.getUniforms(),\n\t\t\tm_uniforms = materialProperties.__webglShader.uniforms;\n\n\t\tif ( program.id !== _currentProgram ) {\n\n\t\t\t_gl.useProgram( program.program );\n\t\t\t_currentProgram = program.id;\n\n\t\t\trefreshProgram = true;\n\t\t\trefreshMaterial = true;\n\t\t\trefreshLights = true;\n\n\t\t}\n\n\t\tif ( material.id !== _currentMaterialId ) {\n\n\t\t\tif ( _currentMaterialId === - 1 ) refreshLights = true;\n\t\t\t_currentMaterialId = material.id;\n\n\t\t\trefreshMaterial = true;\n\n\t\t}\n\n\t\tif ( refreshProgram || camera !== _currentCamera ) {\n\n\t\t\t_gl.uniformMatrix4fv( p_uniforms.projectionMatrix, false, camera.projectionMatrix.elements );\n\n\t\t\tif ( capabilities.logarithmicDepthBuffer ) {\n\n\t\t\t\t_gl.uniform1f( p_uniforms.logDepthBufFC, 2.0 / ( Math.log( camera.far + 1.0 ) / Math.LN2 ) );\n\n\t\t\t}\n\n\n\t\t\tif ( camera !== _currentCamera ) _currentCamera = camera;\n\n\t\t\t// load material specific uniforms\n\t\t\t// (shader material also gets them for the sake of genericity)\n\n\t\t\tif ( material instanceof THREE.ShaderMaterial ||\n\t\t\t\t material instanceof THREE.MeshPhongMaterial ||\n\t\t\t\t material.envMap ) {\n\n\t\t\t\tif ( p_uniforms.cameraPosition !== undefined ) {\n\n\t\t\t\t\t_vector3.setFromMatrixPosition( camera.matrixWorld );\n\t\t\t\t\t_gl.uniform3f( p_uniforms.cameraPosition, _vector3.x, _vector3.y, _vector3.z );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( material instanceof THREE.MeshPhongMaterial ||\n\t\t\t\t material instanceof THREE.MeshLambertMaterial ||\n\t\t\t\t material instanceof THREE.MeshBasicMaterial ||\n\t\t\t\t material instanceof THREE.ShaderMaterial ||\n\t\t\t\t material.skinning ) {\n\n\t\t\t\tif ( p_uniforms.viewMatrix !== undefined ) {\n\n\t\t\t\t\t_gl.uniformMatrix4fv( p_uniforms.viewMatrix, false, camera.matrixWorldInverse.elements );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t// skinning uniforms must be set even if material didn't change\n\t\t// auto-setting of texture unit for bone texture must go before other textures\n\t\t// not sure why, but otherwise weird things happen\n\n\t\tif ( material.skinning ) {\n\n\t\t\tif ( object.bindMatrix && p_uniforms.bindMatrix !== undefined ) {\n\n\t\t\t\t_gl.uniformMatrix4fv( p_uniforms.bindMatrix, false, object.bindMatrix.elements );\n\n\t\t\t}\n\n\t\t\tif ( object.bindMatrixInverse && p_uniforms.bindMatrixInverse !== undefined ) {\n\n\t\t\t\t_gl.uniformMatrix4fv( p_uniforms.bindMatrixInverse, false, object.bindMatrixInverse.elements );\n\n\t\t\t}\n\n\t\t\tif ( capabilities.floatVertexTextures && object.skeleton && object.skeleton.useVertexTexture ) {\n\n\t\t\t\tif ( p_uniforms.boneTexture !== undefined ) {\n\n\t\t\t\t\tvar textureUnit = getTextureUnit();\n\n\t\t\t\t\t_gl.uniform1i( p_uniforms.boneTexture, textureUnit );\n\t\t\t\t\t_this.setTexture( object.skeleton.boneTexture, textureUnit );\n\n\t\t\t\t}\n\n\t\t\t\tif ( p_uniforms.boneTextureWidth !== undefined ) {\n\n\t\t\t\t\t_gl.uniform1i( p_uniforms.boneTextureWidth, object.skeleton.boneTextureWidth );\n\n\t\t\t\t}\n\n\t\t\t\tif ( p_uniforms.boneTextureHeight !== undefined ) {\n\n\t\t\t\t\t_gl.uniform1i( p_uniforms.boneTextureHeight, object.skeleton.boneTextureHeight );\n\n\t\t\t\t}\n\n\t\t\t} else if ( object.skeleton && object.skeleton.boneMatrices ) {\n\n\t\t\t\tif ( p_uniforms.boneGlobalMatrices !== undefined ) {\n\n\t\t\t\t\t_gl.uniformMatrix4fv( p_uniforms.boneGlobalMatrices, false, object.skeleton.boneMatrices );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( refreshMaterial ) {\n\n\t\t\t// refresh uniforms common to several materials\n\n\t\t\tif ( fog && material.fog ) {\n\n\t\t\t\trefreshUniformsFog( m_uniforms, fog );\n\n\t\t\t}\n\n\t\t\tif ( material instanceof THREE.MeshPhongMaterial ||\n\t\t\t\t material instanceof THREE.MeshLambertMaterial ||\n\t\t\t\t material.lights ) {\n\n\t\t\t\tif ( _lightsNeedUpdate ) {\n\n\t\t\t\t\trefreshLights = true;\n\t\t\t\t\tsetupLights( lights, camera );\n\t\t\t\t\t_lightsNeedUpdate = false;\n\n\t\t\t\t}\n\n\t\t\t\tif ( refreshLights ) {\n\n\t\t\t\t\trefreshUniformsLights( m_uniforms, _lights );\n\t\t\t\t\tmarkUniformsLightsNeedsUpdate( m_uniforms, true );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tmarkUniformsLightsNeedsUpdate( m_uniforms, false );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( material instanceof THREE.MeshBasicMaterial ||\n\t\t\t\t material instanceof THREE.MeshLambertMaterial ||\n\t\t\t\t material instanceof THREE.MeshPhongMaterial ) {\n\n\t\t\t\trefreshUniformsCommon( m_uniforms, material );\n\n\t\t\t}\n\n\t\t\t// refresh single material specific uniforms\n\n\t\t\tif ( material instanceof THREE.LineBasicMaterial ) {\n\n\t\t\t\trefreshUniformsLine( m_uniforms, material );\n\n\t\t\t} else if ( material instanceof THREE.LineDashedMaterial ) {\n\n\t\t\t\trefreshUniformsLine( m_uniforms, material );\n\t\t\t\trefreshUniformsDash( m_uniforms, material );\n\n\t\t\t} else if ( material instanceof THREE.PointsMaterial ) {\n\n\t\t\t\trefreshUniformsParticle( m_uniforms, material );\n\n\t\t\t} else if ( material instanceof THREE.MeshPhongMaterial ) {\n\n\t\t\t\trefreshUniformsPhong( m_uniforms, material );\n\n\t\t\t} else if ( material instanceof THREE.MeshDepthMaterial ) {\n\n\t\t\t\tm_uniforms.mNear.value = camera.near;\n\t\t\t\tm_uniforms.mFar.value = camera.far;\n\t\t\t\tm_uniforms.opacity.value = material.opacity;\n\n\t\t\t} else if ( material instanceof THREE.MeshNormalMaterial ) {\n\n\t\t\t\tm_uniforms.opacity.value = material.opacity;\n\n\t\t\t}\n\n\t\t\tif ( object.receiveShadow && ! material._shadowPass ) {\n\n\t\t\t\trefreshUniformsShadow( m_uniforms, lights );\n\n\t\t\t}\n\n\t\t\t// load common uniforms\n\n\t\t\tloadUniformsGeneric( materialProperties.uniformsList );\n\n\t\t}\n\n\t\tloadUniformsMatrices( p_uniforms, object );\n\n\t\tif ( p_uniforms.modelMatrix !== undefined ) {\n\n\t\t\t_gl.uniformMatrix4fv( p_uniforms.modelMatrix, false, object.matrixWorld.elements );\n\n\t\t}\n\n\t\treturn program;\n\n\t}\n\n\t// Uniforms (refresh uniforms objects)\n\n\tfunction refreshUniformsCommon ( uniforms, material ) {\n\n\t\tuniforms.opacity.value = material.opacity;\n\n\t\tuniforms.diffuse.value = material.color;\n\n\t\tif ( material.emissive ) {\n\n\t\t\tuniforms.emissive.value = material.emissive;\n\n\t\t}\n\n\t\tuniforms.map.value = material.map;\n\t\tuniforms.specularMap.value = material.specularMap;\n\t\tuniforms.alphaMap.value = material.alphaMap;\n\n\t\tif ( material.aoMap ) {\n\n\t\t\tuniforms.aoMap.value = material.aoMap;\n\t\t\tuniforms.aoMapIntensity.value = material.aoMapIntensity;\n\n\t\t}\n\n\t\t// uv repeat and offset setting priorities\n\t\t// 1. color map\n\t\t// 2. specular map\n\t\t// 3. normal map\n\t\t// 4. bump map\n\t\t// 5. alpha map\n\t\t// 6. emissive map\n\n\t\tvar uvScaleMap;\n\n\t\tif ( material.map ) {\n\n\t\t\tuvScaleMap = material.map;\n\n\t\t} else if ( material.specularMap ) {\n\n\t\t\tuvScaleMap = material.specularMap;\n\n\t\t} else if ( material.displacementMap ) {\n\n\t\t\tuvScaleMap = material.displacementMap;\n\n\t\t} else if ( material.normalMap ) {\n\n\t\t\tuvScaleMap = material.normalMap;\n\n\t\t} else if ( material.bumpMap ) {\n\n\t\t\tuvScaleMap = material.bumpMap;\n\n\t\t} else if ( material.alphaMap ) {\n\n\t\t\tuvScaleMap = material.alphaMap;\n\n\t\t} else if ( material.emissiveMap ) {\n\n\t\t\tuvScaleMap = material.emissiveMap;\n\n\t\t}\n\n\t\tif ( uvScaleMap !== undefined ) {\n\n\t\t\tvar offset = uvScaleMap.offset;\n\t\t\tvar repeat = uvScaleMap.repeat;\n\n\t\t\tuniforms.offsetRepeat.value.set( offset.x, offset.y, repeat.x, repeat.y );\n\n\t\t}\n\n\t\tuniforms.envMap.value = material.envMap;\n\t\tuniforms.flipEnvMap.value = ( material.envMap instanceof THREE.WebGLRenderTargetCube ) ? 1 : - 1;\n\n\t\tuniforms.reflectivity.value = material.reflectivity;\n\t\tuniforms.refractionRatio.value = material.refractionRatio;\n\n\t}\n\n\tfunction refreshUniformsLine ( uniforms, material ) {\n\n\t\tuniforms.diffuse.value = material.color;\n\t\tuniforms.opacity.value = material.opacity;\n\n\t}\n\n\tfunction refreshUniformsDash ( uniforms, material ) {\n\n\t\tuniforms.dashSize.value = material.dashSize;\n\t\tuniforms.totalSize.value = material.dashSize + material.gapSize;\n\t\tuniforms.scale.value = material.scale;\n\n\t}\n\n\tfunction refreshUniformsParticle ( uniforms, material ) {\n\n\t\tuniforms.psColor.value = material.color;\n\t\tuniforms.opacity.value = material.opacity;\n\t\tuniforms.size.value = material.size;\n\t\tuniforms.scale.value = _canvas.height / 2.0; // TODO: Cache this.\n\n\t\tuniforms.map.value = material.map;\n\n\t\tif ( material.map !== null ) {\n\n\t\t\tvar offset = material.map.offset;\n\t\t\tvar repeat = material.map.repeat;\n\n\t\t\tuniforms.offsetRepeat.value.set( offset.x, offset.y, repeat.x, repeat.y );\n\n\t\t}\n\n\t}\n\n\tfunction refreshUniformsFog ( uniforms, fog ) {\n\n\t\tuniforms.fogColor.value = fog.color;\n\n\t\tif ( fog instanceof THREE.Fog ) {\n\n\t\t\tuniforms.fogNear.value = fog.near;\n\t\t\tuniforms.fogFar.value = fog.far;\n\n\t\t} else if ( fog instanceof THREE.FogExp2 ) {\n\n\t\t\tuniforms.fogDensity.value = fog.density;\n\n\t\t}\n\n\t}\n\n\tfunction refreshUniformsPhong ( uniforms, material ) {\n\n\t\tuniforms.specular.value = material.specular;\n\t\tuniforms.shininess.value = material.shininess;\n\n\t\tif ( material.lightMap ) {\n\n\t\t\tuniforms.lightMap.value = material.lightMap;\n\t\t\tuniforms.lightMapIntensity.value = material.lightMapIntensity;\n\n\t\t}\n\n\t\tif ( material.emissiveMap ) {\n\n\t\t\tuniforms.emissiveMap.value = material.emissiveMap;\n\n\t\t}\n\n\t\tif ( material.bumpMap ) {\n\n\t\t\tuniforms.bumpMap.value = material.bumpMap;\n\t\t\tuniforms.bumpScale.value = material.bumpScale;\n\n\t\t}\n\n\t\tif ( material.normalMap ) {\n\n\t\t\tuniforms.normalMap.value = material.normalMap;\n\t\t\tuniforms.normalScale.value.copy( material.normalScale );\n\n\t\t}\n\n\t\tif ( material.displacementMap ) {\n\n\t\t\tuniforms.displacementMap.value = material.displacementMap;\n\t\t\tuniforms.displacementScale.value = material.displacementScale;\n\t\t\tuniforms.displacementBias.value = material.displacementBias;\n\n\t\t}\n\n\t}\n\n\tfunction refreshUniformsLights ( uniforms, lights ) {\n\n\t\tuniforms.ambientLightColor.value = lights.ambient;\n\n\t\tuniforms.directionalLightColor.value = lights.directional.colors;\n\t\tuniforms.directionalLightDirection.value = lights.directional.positions;\n\n\t\tuniforms.pointLightColor.value = lights.point.colors;\n\t\tuniforms.pointLightPosition.value = lights.point.positions;\n\t\tuniforms.pointLightDistance.value = lights.point.distances;\n\t\tuniforms.pointLightDecay.value = lights.point.decays;\n\n\t\tuniforms.spotLightColor.value = lights.spot.colors;\n\t\tuniforms.spotLightPosition.value = lights.spot.positions;\n\t\tuniforms.spotLightDistance.value = lights.spot.distances;\n\t\tuniforms.spotLightDirection.value = lights.spot.directions;\n\t\tuniforms.spotLightAngleCos.value = lights.spot.anglesCos;\n\t\tuniforms.spotLightExponent.value = lights.spot.exponents;\n\t\tuniforms.spotLightDecay.value = lights.spot.decays;\n\n\t\tuniforms.hemisphereLightSkyColor.value = lights.hemi.skyColors;\n\t\tuniforms.hemisphereLightGroundColor.value = lights.hemi.groundColors;\n\t\tuniforms.hemisphereLightDirection.value = lights.hemi.positions;\n\n\t}\n\n\t// If uniforms are marked as clean, they don't need to be loaded to the GPU.\n\n\tfunction markUniformsLightsNeedsUpdate ( uniforms, value ) {\n\n\t\tuniforms.ambientLightColor.needsUpdate = value;\n\n\t\tuniforms.directionalLightColor.needsUpdate = value;\n\t\tuniforms.directionalLightDirection.needsUpdate = value;\n\n\t\tuniforms.pointLightColor.needsUpdate = value;\n\t\tuniforms.pointLightPosition.needsUpdate = value;\n\t\tuniforms.pointLightDistance.needsUpdate = value;\n\t\tuniforms.pointLightDecay.needsUpdate = value;\n\n\t\tuniforms.spotLightColor.needsUpdate = value;\n\t\tuniforms.spotLightPosition.needsUpdate = value;\n\t\tuniforms.spotLightDistance.needsUpdate = value;\n\t\tuniforms.spotLightDirection.needsUpdate = value;\n\t\tuniforms.spotLightAngleCos.needsUpdate = value;\n\t\tuniforms.spotLightExponent.needsUpdate = value;\n\t\tuniforms.spotLightDecay.needsUpdate = value;\n\n\t\tuniforms.hemisphereLightSkyColor.needsUpdate = value;\n\t\tuniforms.hemisphereLightGroundColor.needsUpdate = value;\n\t\tuniforms.hemisphereLightDirection.needsUpdate = value;\n\n\t}\n\n\tfunction refreshUniformsShadow ( uniforms, lights ) {\n\n\t\tif ( uniforms.shadowMatrix ) {\n\n\t\t\tvar j = 0;\n\n\t\t\tfor ( var i = 0, il = lights.length; i < il; i ++ ) {\n\n\t\t\t\tvar light = lights[ i ];\n\n\t\t\t\tif ( ! light.castShadow ) continue;\n\n\t\t\t\tif ( light instanceof THREE.SpotLight || ( light instanceof THREE.DirectionalLight ) ) {\n\n\t\t\t\t\tuniforms.shadowMap.value[ j ] = light.shadowMap;\n\t\t\t\t\tuniforms.shadowMapSize.value[ j ] = light.shadowMapSize;\n\n\t\t\t\t\tuniforms.shadowMatrix.value[ j ] = light.shadowMatrix;\n\n\t\t\t\t\tuniforms.shadowDarkness.value[ j ] = light.shadowDarkness;\n\t\t\t\t\tuniforms.shadowBias.value[ j ] = light.shadowBias;\n\n\t\t\t\t\tj ++;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t// Uniforms (load to GPU)\n\n\tfunction loadUniformsMatrices ( uniforms, object ) {\n\n\t\t_gl.uniformMatrix4fv( uniforms.modelViewMatrix, false, object.modelViewMatrix.elements );\n\n\t\tif ( uniforms.normalMatrix ) {\n\n\t\t\t_gl.uniformMatrix3fv( uniforms.normalMatrix, false, object.normalMatrix.elements );\n\n\t\t}\n\n\t}\n\n\tfunction getTextureUnit() {\n\n\t\tvar textureUnit = _usedTextureUnits;\n\n\t\tif ( textureUnit >= capabilities.maxTextures ) {\n\n\t\t\tconsole.warn( 'WebGLRenderer: trying to use ' + textureUnit + ' texture units while this GPU supports only ' + capabilities.maxTextures );\n\n\t\t}\n\n\t\t_usedTextureUnits += 1;\n\n\t\treturn textureUnit;\n\n\t}\n\n\tfunction loadUniformsGeneric ( uniforms ) {\n\n\t\tvar texture, textureUnit;\n\n\t\tfor ( var j = 0, jl = uniforms.length; j < jl; j ++ ) {\n\n\t\t\tvar uniform = uniforms[ j ][ 0 ];\n\n\t\t\t// needsUpdate property is not added to all uniforms.\n\t\t\tif ( uniform.needsUpdate === false ) continue;\n\n\t\t\tvar type = uniform.type;\n\t\t\tvar value = uniform.value;\n\t\t\tvar location = uniforms[ j ][ 1 ];\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\tcase '1i':\n\t\t\t\t\t_gl.uniform1i( location, value );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase '1f':\n\t\t\t\t\t_gl.uniform1f( location, value );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase '2f':\n\t\t\t\t\t_gl.uniform2f( location, value[ 0 ], value[ 1 ] );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase '3f':\n\t\t\t\t\t_gl.uniform3f( location, value[ 0 ], value[ 1 ], value[ 2 ] );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase '4f':\n\t\t\t\t\t_gl.uniform4f( location, value[ 0 ], value[ 1 ], value[ 2 ], value[ 3 ] );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase '1iv':\n\t\t\t\t\t_gl.uniform1iv( location, value );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase '3iv':\n\t\t\t\t\t_gl.uniform3iv( location, value );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase '1fv':\n\t\t\t\t\t_gl.uniform1fv( location, value );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase '2fv':\n\t\t\t\t\t_gl.uniform2fv( location, value );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase '3fv':\n\t\t\t\t\t_gl.uniform3fv( location, value );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase '4fv':\n\t\t\t\t\t_gl.uniform4fv( location, value );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'Matrix3fv':\n\t\t\t\t\t_gl.uniformMatrix3fv( location, false, value );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'Matrix4fv':\n\t\t\t\t\t_gl.uniformMatrix4fv( location, false, value );\n\t\t\t\t\tbreak;\n\n\t\t\t\t//\n\n\t\t\t\tcase 'i':\n\n\t\t\t\t\t// single integer\n\t\t\t\t\t_gl.uniform1i( location, value );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'f':\n\n\t\t\t\t\t// single float\n\t\t\t\t\t_gl.uniform1f( location, value );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'v2':\n\n\t\t\t\t\t// single THREE.Vector2\n\t\t\t\t\t_gl.uniform2f( location, value.x, value.y );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'v3':\n\n\t\t\t\t\t// single THREE.Vector3\n\t\t\t\t\t_gl.uniform3f( location, value.x, value.y, value.z );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'v4':\n\n\t\t\t\t\t// single THREE.Vector4\n\t\t\t\t\t_gl.uniform4f( location, value.x, value.y, value.z, value.w );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'c':\n\n\t\t\t\t\t// single THREE.Color\n\t\t\t\t\t_gl.uniform3f( location, value.r, value.g, value.b );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'iv1':\n\n\t\t\t\t\t// flat array of integers (JS or typed array)\n\t\t\t\t\t_gl.uniform1iv( location, value );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'iv':\n\n\t\t\t\t\t// flat array of integers with 3 x N size (JS or typed array)\n\t\t\t\t\t_gl.uniform3iv( location, value );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'fv1':\n\n\t\t\t\t\t// flat array of floats (JS or typed array)\n\t\t\t\t\t_gl.uniform1fv( location, value );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'fv':\n\n\t\t\t\t\t// flat array of floats with 3 x N size (JS or typed array)\n\t\t\t\t\t_gl.uniform3fv( location, value );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'v2v':\n\n\t\t\t\t\t// array of THREE.Vector2\n\n\t\t\t\t\tif ( uniform._array === undefined ) {\n\n\t\t\t\t\t\tuniform._array = new Float32Array( 2 * value.length );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfor ( var i = 0, i2 = 0, il = value.length; i < il; i ++, i2 += 2 ) {\n\n\t\t\t\t\t\tuniform._array[ i2 + 0 ] = value[ i ].x;\n\t\t\t\t\t\tuniform._array[ i2 + 1 ] = value[ i ].y;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t_gl.uniform2fv( location, uniform._array );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'v3v':\n\n\t\t\t\t\t// array of THREE.Vector3\n\n\t\t\t\t\tif ( uniform._array === undefined ) {\n\n\t\t\t\t\t\tuniform._array = new Float32Array( 3 * value.length );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfor ( var i = 0, i3 = 0, il = value.length; i < il; i ++, i3 += 3 ) {\n\n\t\t\t\t\t\tuniform._array[ i3 + 0 ] = value[ i ].x;\n\t\t\t\t\t\tuniform._array[ i3 + 1 ] = value[ i ].y;\n\t\t\t\t\t\tuniform._array[ i3 + 2 ] = value[ i ].z;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t_gl.uniform3fv( location, uniform._array );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'v4v':\n\n\t\t\t\t\t// array of THREE.Vector4\n\n\t\t\t\t\tif ( uniform._array === undefined ) {\n\n\t\t\t\t\t\tuniform._array = new Float32Array( 4 * value.length );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfor ( var i = 0, i4 = 0, il = value.length; i < il; i ++, i4 += 4 ) {\n\n\t\t\t\t\t\tuniform._array[ i4 + 0 ] = value[ i ].x;\n\t\t\t\t\t\tuniform._array[ i4 + 1 ] = value[ i ].y;\n\t\t\t\t\t\tuniform._array[ i4 + 2 ] = value[ i ].z;\n\t\t\t\t\t\tuniform._array[ i4 + 3 ] = value[ i ].w;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t_gl.uniform4fv( location, uniform._array );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'm3':\n\n\t\t\t\t\t// single THREE.Matrix3\n\t\t\t\t\t_gl.uniformMatrix3fv( location, false, value.elements );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'm3v':\n\n\t\t\t\t\t// array of THREE.Matrix3\n\n\t\t\t\t\tif ( uniform._array === undefined ) {\n\n\t\t\t\t\t\tuniform._array = new Float32Array( 9 * value.length );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfor ( var i = 0, il = value.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tvalue[ i ].flattenToArrayOffset( uniform._array, i * 9 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\t_gl.uniformMatrix3fv( location, false, uniform._array );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'm4':\n\n\t\t\t\t\t// single THREE.Matrix4\n\t\t\t\t\t_gl.uniformMatrix4fv( location, false, value.elements );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'm4v':\n\n\t\t\t\t\t// array of THREE.Matrix4\n\n\t\t\t\t\tif ( uniform._array === undefined ) {\n\n\t\t\t\t\t\tuniform._array = new Float32Array( 16 * value.length );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfor ( var i = 0, il = value.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tvalue[ i ].flattenToArrayOffset( uniform._array, i * 16 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\t_gl.uniformMatrix4fv( location, false, uniform._array );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 't':\n\n\t\t\t\t\t// single THREE.Texture (2d or cube)\n\n\t\t\t\t\ttexture = value;\n\t\t\t\t\ttextureUnit = getTextureUnit();\n\n\t\t\t\t\t_gl.uniform1i( location, textureUnit );\n\n\t\t\t\t\tif ( ! texture ) continue;\n\n\t\t\t\t\tif ( texture instanceof THREE.CubeTexture ||\n\t\t\t\t\t\t ( Array.isArray( texture.image ) && texture.image.length === 6 ) ) {\n\n\t\t\t\t\t\t// CompressedTexture can have Array in image :/\n\n\t\t\t\t\t\tsetCubeTexture( texture, textureUnit );\n\n\t\t\t\t\t} else if ( texture instanceof THREE.WebGLRenderTargetCube ) {\n\n\t\t\t\t\t\tsetCubeTextureDynamic( texture, textureUnit );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t_this.setTexture( texture, textureUnit );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'tv':\n\n\t\t\t\t\t// array of THREE.Texture (2d)\n\n\t\t\t\t\tif ( uniform._array === undefined ) {\n\n\t\t\t\t\t\tuniform._array = [];\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfor ( var i = 0, il = uniform.value.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tuniform._array[ i ] = getTextureUnit();\n\n\t\t\t\t\t}\n\n\t\t\t\t\t_gl.uniform1iv( location, uniform._array );\n\n\t\t\t\t\tfor ( var i = 0, il = uniform.value.length; i < il; i ++ ) {\n\n\t\t\t\t\t\ttexture = uniform.value[ i ];\n\t\t\t\t\t\ttextureUnit = uniform._array[ i ];\n\n\t\t\t\t\t\tif ( ! texture ) continue;\n\n\t\t\t\t\t\t_this.setTexture( texture, textureUnit );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Unknown uniform type: ' + type );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tfunction setColorLinear( array, offset, color, intensity ) {\n\n\t\tarray[ offset + 0 ] = color.r * intensity;\n\t\tarray[ offset + 1 ] = color.g * intensity;\n\t\tarray[ offset + 2 ] = color.b * intensity;\n\n\t}\n\n\tfunction setupLights ( lights, camera ) {\n\n\t\tvar l, ll, light,\n\t\tr = 0, g = 0, b = 0,\n\t\tcolor, skyColor, groundColor,\n\t\tintensity,\n\t\tdistance,\n\n\t\tzlights = _lights,\n\n\t\tviewMatrix = camera.matrixWorldInverse,\n\n\t\tdirColors = zlights.directional.colors,\n\t\tdirPositions = zlights.directional.positions,\n\n\t\tpointColors = zlights.point.colors,\n\t\tpointPositions = zlights.point.positions,\n\t\tpointDistances = zlights.point.distances,\n\t\tpointDecays = zlights.point.decays,\n\n\t\tspotColors = zlights.spot.colors,\n\t\tspotPositions = zlights.spot.positions,\n\t\tspotDistances = zlights.spot.distances,\n\t\tspotDirections = zlights.spot.directions,\n\t\tspotAnglesCos = zlights.spot.anglesCos,\n\t\tspotExponents = zlights.spot.exponents,\n\t\tspotDecays = zlights.spot.decays,\n\n\t\themiSkyColors = zlights.hemi.skyColors,\n\t\themiGroundColors = zlights.hemi.groundColors,\n\t\themiPositions = zlights.hemi.positions,\n\n\t\tdirLength = 0,\n\t\tpointLength = 0,\n\t\tspotLength = 0,\n\t\themiLength = 0,\n\n\t\tdirCount = 0,\n\t\tpointCount = 0,\n\t\tspotCount = 0,\n\t\themiCount = 0,\n\n\t\tdirOffset = 0,\n\t\tpointOffset = 0,\n\t\tspotOffset = 0,\n\t\themiOffset = 0;\n\n\t\tfor ( l = 0, ll = lights.length; l < ll; l ++ ) {\n\n\t\t\tlight = lights[ l ];\n\n\t\t\tif ( light.onlyShadow ) continue;\n\n\t\t\tcolor = light.color;\n\t\t\tintensity = light.intensity;\n\t\t\tdistance = light.distance;\n\n\t\t\tif ( light instanceof THREE.AmbientLight ) {\n\n\t\t\t\tif ( ! light.visible ) continue;\n\n\t\t\t\tr += color.r;\n\t\t\t\tg += color.g;\n\t\t\t\tb += color.b;\n\n\t\t\t} else if ( light instanceof THREE.DirectionalLight ) {\n\n\t\t\t\tdirCount += 1;\n\n\t\t\t\tif ( ! light.visible ) continue;\n\n\t\t\t\t_direction.setFromMatrixPosition( light.matrixWorld );\n\t\t\t\t_vector3.setFromMatrixPosition( light.target.matrixWorld );\n\t\t\t\t_direction.sub( _vector3 );\n\t\t\t\t_direction.transformDirection( viewMatrix );\n\n\t\t\t\tdirOffset = dirLength * 3;\n\n\t\t\t\tdirPositions[ dirOffset + 0 ] = _direction.x;\n\t\t\t\tdirPositions[ dirOffset + 1 ] = _direction.y;\n\t\t\t\tdirPositions[ dirOffset + 2 ] = _direction.z;\n\n\t\t\t\tsetColorLinear( dirColors, dirOffset, color, intensity );\n\n\t\t\t\tdirLength += 1;\n\n\t\t\t} else if ( light instanceof THREE.PointLight ) {\n\n\t\t\t\tpointCount += 1;\n\n\t\t\t\tif ( ! light.visible ) continue;\n\n\t\t\t\tpointOffset = pointLength * 3;\n\n\t\t\t\tsetColorLinear( pointColors, pointOffset, color, intensity );\n\n\t\t\t\t_vector3.setFromMatrixPosition( light.matrixWorld );\n\t\t\t\t_vector3.applyMatrix4( viewMatrix );\n\n\t\t\t\tpointPositions[ pointOffset + 0 ] = _vector3.x;\n\t\t\t\tpointPositions[ pointOffset + 1 ] = _vector3.y;\n\t\t\t\tpointPositions[ pointOffset + 2 ] = _vector3.z;\n\n\t\t\t\t// distance is 0 if decay is 0, because there is no attenuation at all.\n\t\t\t\tpointDistances[ pointLength ] = distance;\n\t\t\t\tpointDecays[ pointLength ] = ( light.distance === 0 ) ? 0.0 : light.decay;\n\n\t\t\t\tpointLength += 1;\n\n\t\t\t} else if ( light instanceof THREE.SpotLight ) {\n\n\t\t\t\tspotCount += 1;\n\n\t\t\t\tif ( ! light.visible ) continue;\n\n\t\t\t\tspotOffset = spotLength * 3;\n\n\t\t\t\tsetColorLinear( spotColors, spotOffset, color, intensity );\n\n\t\t\t\t_direction.setFromMatrixPosition( light.matrixWorld );\n\t\t\t\t_vector3.copy( _direction ).applyMatrix4( viewMatrix );\n\n\t\t\t\tspotPositions[ spotOffset + 0 ] = _vector3.x;\n\t\t\t\tspotPositions[ spotOffset + 1 ] = _vector3.y;\n\t\t\t\tspotPositions[ spotOffset + 2 ] = _vector3.z;\n\n\t\t\t\tspotDistances[ spotLength ] = distance;\n\n\t\t\t\t_vector3.setFromMatrixPosition( light.target.matrixWorld );\n\t\t\t\t_direction.sub( _vector3 );\n\t\t\t\t_direction.transformDirection( viewMatrix );\n\n\t\t\t\tspotDirections[ spotOffset + 0 ] = _direction.x;\n\t\t\t\tspotDirections[ spotOffset + 1 ] = _direction.y;\n\t\t\t\tspotDirections[ spotOffset + 2 ] = _direction.z;\n\n\t\t\t\tspotAnglesCos[ spotLength ] = Math.cos( light.angle );\n\t\t\t\tspotExponents[ spotLength ] = light.exponent;\n\t\t\t\tspotDecays[ spotLength ] = ( light.distance === 0 ) ? 0.0 : light.decay;\n\n\t\t\t\tspotLength += 1;\n\n\t\t\t} else if ( light instanceof THREE.HemisphereLight ) {\n\n\t\t\t\themiCount += 1;\n\n\t\t\t\tif ( ! light.visible ) continue;\n\n\t\t\t\t_direction.setFromMatrixPosition( light.matrixWorld );\n\t\t\t\t_direction.transformDirection( viewMatrix );\n\n\t\t\t\themiOffset = hemiLength * 3;\n\n\t\t\t\themiPositions[ hemiOffset + 0 ] = _direction.x;\n\t\t\t\themiPositions[ hemiOffset + 1 ] = _direction.y;\n\t\t\t\themiPositions[ hemiOffset + 2 ] = _direction.z;\n\n\t\t\t\tskyColor = light.color;\n\t\t\t\tgroundColor = light.groundColor;\n\n\t\t\t\tsetColorLinear( hemiSkyColors, hemiOffset, skyColor, intensity );\n\t\t\t\tsetColorLinear( hemiGroundColors, hemiOffset, groundColor, intensity );\n\n\t\t\t\themiLength += 1;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// null eventual remains from removed lights\n\t\t// (this is to avoid if in shader)\n\n\t\tfor ( l = dirLength * 3, ll = Math.max( dirColors.length, dirCount * 3 ); l < ll; l ++ ) dirColors[ l ] = 0.0;\n\t\tfor ( l = pointLength * 3, ll = Math.max( pointColors.length, pointCount * 3 ); l < ll; l ++ ) pointColors[ l ] = 0.0;\n\t\tfor ( l = spotLength * 3, ll = Math.max( spotColors.length, spotCount * 3 ); l < ll; l ++ ) spotColors[ l ] = 0.0;\n\t\tfor ( l = hemiLength * 3, ll = Math.max( hemiSkyColors.length, hemiCount * 3 ); l < ll; l ++ ) hemiSkyColors[ l ] = 0.0;\n\t\tfor ( l = hemiLength * 3, ll = Math.max( hemiGroundColors.length, hemiCount * 3 ); l < ll; l ++ ) hemiGroundColors[ l ] = 0.0;\n\n\t\tzlights.directional.length = dirLength;\n\t\tzlights.point.length = pointLength;\n\t\tzlights.spot.length = spotLength;\n\t\tzlights.hemi.length = hemiLength;\n\n\t\tzlights.ambient[ 0 ] = r;\n\t\tzlights.ambient[ 1 ] = g;\n\t\tzlights.ambient[ 2 ] = b;\n\n\t}\n\n\t// GL state setting\n\n\tthis.setFaceCulling = function ( cullFace, frontFaceDirection ) {\n\n\t\tif ( cullFace === THREE.CullFaceNone ) {\n\n\t\t\tstate.disable( _gl.CULL_FACE );\n\n\t\t} else {\n\n\t\t\tif ( frontFaceDirection === THREE.FrontFaceDirectionCW ) {\n\n\t\t\t\t_gl.frontFace( _gl.CW );\n\n\t\t\t} else {\n\n\t\t\t\t_gl.frontFace( _gl.CCW );\n\n\t\t\t}\n\n\t\t\tif ( cullFace === THREE.CullFaceBack ) {\n\n\t\t\t\t_gl.cullFace( _gl.BACK );\n\n\t\t\t} else if ( cullFace === THREE.CullFaceFront ) {\n\n\t\t\t\t_gl.cullFace( _gl.FRONT );\n\n\t\t\t} else {\n\n\t\t\t\t_gl.cullFace( _gl.FRONT_AND_BACK );\n\n\t\t\t}\n\n\t\t\tstate.enable( _gl.CULL_FACE );\n\n\t\t}\n\n\t};\n\n\t// Textures\n\n\tfunction setTextureParameters ( textureType, texture, isImagePowerOfTwo ) {\n\n\t\tvar extension;\n\n\t\tif ( isImagePowerOfTwo ) {\n\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_WRAP_S, paramThreeToGL( texture.wrapS ) );\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_WRAP_T, paramThreeToGL( texture.wrapT ) );\n\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_MAG_FILTER, paramThreeToGL( texture.magFilter ) );\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_MIN_FILTER, paramThreeToGL( texture.minFilter ) );\n\n\t\t} else {\n\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_WRAP_S, _gl.CLAMP_TO_EDGE );\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_WRAP_T, _gl.CLAMP_TO_EDGE );\n\n\t\t\tif ( texture.wrapS !== THREE.ClampToEdgeWrapping || texture.wrapT !== THREE.ClampToEdgeWrapping ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping. ( ' + texture.sourceFile + ' )' );\n\n\t\t\t}\n\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_MAG_FILTER, filterFallback( texture.magFilter ) );\n\t\t\t_gl.texParameteri( textureType, _gl.TEXTURE_MIN_FILTER, filterFallback( texture.minFilter ) );\n\n\t\t\tif ( texture.minFilter !== THREE.NearestFilter && texture.minFilter !== THREE.LinearFilter ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter. ( ' + texture.sourceFile + ' )' );\n\n\t\t\t}\n\n\t\t}\n\n\t\textension = extensions.get( 'EXT_texture_filter_anisotropic' );\n\n\t\tif ( extension ) {\n\n\t\t\tif ( texture.type === THREE.FloatType && extensions.get( 'OES_texture_float_linear' ) === null ) return;\n\t\t\tif ( texture.type === THREE.HalfFloatType && extensions.get( 'OES_texture_half_float_linear' ) === null ) return;\n\n\t\t\tif ( texture.anisotropy > 1 || properties.get( texture ).__currentAnisotropy ) {\n\n\t\t\t\t_gl.texParameterf( textureType, extension.TEXTURE_MAX_ANISOTROPY_EXT, Math.min( texture.anisotropy, _this.getMaxAnisotropy() ) );\n\t\t\t\tproperties.get( texture ).__currentAnisotropy = texture.anisotropy;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tfunction uploadTexture( textureProperties, texture, slot ) {\n\n\t\tif ( textureProperties.__webglInit === undefined ) {\n\n\t\t\ttextureProperties.__webglInit = true;\n\n\t\t\ttexture.__webglInit = true;\n\n\t\t\ttexture.addEventListener( 'dispose', onTextureDispose );\n\n\t\t\ttextureProperties.__webglTexture = _gl.createTexture();\n\n\t\t\t_infoMemory.textures ++;\n\n\t\t}\n\n\t\tstate.activeTexture( _gl.TEXTURE0 + slot );\n\t\tstate.bindTexture( _gl.TEXTURE_2D, textureProperties.__webglTexture );\n\n\t\t_gl.pixelStorei( _gl.UNPACK_FLIP_Y_WEBGL, texture.flipY );\n\t\t_gl.pixelStorei( _gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, texture.premultiplyAlpha );\n\t\t_gl.pixelStorei( _gl.UNPACK_ALIGNMENT, texture.unpackAlignment );\n\n\t\ttexture.image = clampToMaxSize( texture.image, capabilities.maxTextureSize );\n\n\t\tvar image = texture.image,\n\t\tisImagePowerOfTwo = THREE.Math.isPowerOfTwo( image.width ) && THREE.Math.isPowerOfTwo( image.height ),\n\t\tglFormat = paramThreeToGL( texture.format ),\n\t\tglType = paramThreeToGL( texture.type );\n\n\t\tsetTextureParameters( _gl.TEXTURE_2D, texture, isImagePowerOfTwo );\n\n\t\tvar mipmap, mipmaps = texture.mipmaps;\n\n\t\tif ( texture instanceof THREE.DataTexture ) {\n\n\t\t\t// use manually created mipmaps if available\n\t\t\t// if there are no manual mipmaps\n\t\t\t// set 0 level mipmap and then use GL to generate other mipmap levels\n\n\t\t\tif ( mipmaps.length > 0 && isImagePowerOfTwo ) {\n\n\t\t\t\tfor ( var i = 0, il = mipmaps.length; i < il; i ++ ) {\n\n\t\t\t\t\tmipmap = mipmaps[ i ];\n\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, i, glFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data );\n\n\t\t\t\t}\n\n\t\t\t\ttexture.generateMipmaps = false;\n\n\t\t\t} else {\n\n\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, 0, glFormat, image.width, image.height, 0, glFormat, glType, image.data );\n\n\t\t\t}\n\n\t\t} else if ( texture instanceof THREE.CompressedTexture ) {\n\n\t\t\tfor ( var i = 0, il = mipmaps.length; i < il; i ++ ) {\n\n\t\t\t\tmipmap = mipmaps[ i ];\n\n\t\t\t\tif ( texture.format !== THREE.RGBAFormat && texture.format !== THREE.RGBFormat ) {\n\n\t\t\t\t\tif ( state.getCompressedTextureFormats().indexOf( glFormat ) > - 1 ) {\n\n\t\t\t\t\t\tstate.compressedTexImage2D( _gl.TEXTURE_2D, i, glFormat, mipmap.width, mipmap.height, 0, mipmap.data );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tconsole.warn( \"THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()\" );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, i, glFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t// regular Texture (image, video, canvas)\n\n\t\t\t// use manually created mipmaps if available\n\t\t\t// if there are no manual mipmaps\n\t\t\t// set 0 level mipmap and then use GL to generate other mipmap levels\n\n\t\t\tif ( mipmaps.length > 0 && isImagePowerOfTwo ) {\n\n\t\t\t\tfor ( var i = 0, il = mipmaps.length; i < il; i ++ ) {\n\n\t\t\t\t\tmipmap = mipmaps[ i ];\n\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, i, glFormat, glFormat, glType, mipmap );\n\n\t\t\t\t}\n\n\t\t\t\ttexture.generateMipmaps = false;\n\n\t\t\t} else {\n\n\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, 0, glFormat, glFormat, glType, texture.image );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( texture.generateMipmaps && isImagePowerOfTwo ) _gl.generateMipmap( _gl.TEXTURE_2D );\n\n\t\ttextureProperties.__version = texture.version;\n\n\t\tif ( texture.onUpdate ) texture.onUpdate( texture );\n\n\t}\n\n\tthis.setTexture = function ( texture, slot ) {\n\n\t\tvar textureProperties = properties.get( texture );\n\n\t\tif ( texture.version > 0 && textureProperties.__version !== texture.version ) {\n\n\t\t\tvar image = texture.image;\n\n\t\t\tif ( image === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture marked for update but image is undefined', texture );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tif ( image.complete === false ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Texture marked for update but image is incomplete', texture );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tuploadTexture( textureProperties, texture, slot );\n\t\t\treturn;\n\n\t\t}\n\n\t\tstate.activeTexture( _gl.TEXTURE0 + slot );\n\t\tstate.bindTexture( _gl.TEXTURE_2D, textureProperties.__webglTexture );\n\n\t};\n\n\tfunction clampToMaxSize ( image, maxSize ) {\n\n\t\tif ( image.width > maxSize || image.height > maxSize ) {\n\n\t\t\t// Warning: Scaling through the canvas will only work with images that use\n\t\t\t// premultiplied alpha.\n\n\t\t\tvar scale = maxSize / Math.max( image.width, image.height );\n\n\t\t\tvar canvas = document.createElement( 'canvas' );\n\t\t\tcanvas.width = Math.floor( image.width * scale );\n\t\t\tcanvas.height = Math.floor( image.height * scale );\n\n\t\t\tvar context = canvas.getContext( '2d' );\n\t\t\tcontext.drawImage( image, 0, 0, image.width, image.height, 0, 0, canvas.width, canvas.height );\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: image is too big (' + image.width + 'x' + image.height + '). Resized to ' + canvas.width + 'x' + canvas.height, image );\n\n\t\t\treturn canvas;\n\n\t\t}\n\n\t\treturn image;\n\n\t}\n\n\tfunction setCubeTexture ( texture, slot ) {\n\n\t\tvar textureProperties = properties.get( texture );\n\n\t\tif ( texture.image.length === 6 ) {\n\n\t\t\tif ( texture.version > 0 && textureProperties.__version !== texture.version ) {\n\n\t\t\t\tif ( ! textureProperties.__image__webglTextureCube ) {\n\n\t\t\t\t\ttexture.addEventListener( 'dispose', onTextureDispose );\n\n\t\t\t\t\ttextureProperties.__image__webglTextureCube = _gl.createTexture();\n\n\t\t\t\t\t_infoMemory.textures ++;\n\n\t\t\t\t}\n\n\t\t\t\tstate.activeTexture( _gl.TEXTURE0 + slot );\n\t\t\t\tstate.bindTexture( _gl.TEXTURE_CUBE_MAP, textureProperties.__image__webglTextureCube );\n\n\t\t\t\t_gl.pixelStorei( _gl.UNPACK_FLIP_Y_WEBGL, texture.flipY );\n\n\t\t\t\tvar isCompressed = texture instanceof THREE.CompressedTexture;\n\t\t\t\tvar isDataTexture = texture.image[ 0 ] instanceof THREE.DataTexture;\n\n\t\t\t\tvar cubeImage = [];\n\n\t\t\t\tfor ( var i = 0; i < 6; i ++ ) {\n\n\t\t\t\t\tif ( _this.autoScaleCubemaps && ! isCompressed && ! isDataTexture ) {\n\n\t\t\t\t\t\tcubeImage[ i ] = clampToMaxSize( texture.image[ i ], capabilities.maxCubemapSize );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tcubeImage[ i ] = isDataTexture ? texture.image[ i ].image : texture.image[ i ];\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tvar image = cubeImage[ 0 ],\n\t\t\t\tisImagePowerOfTwo = THREE.Math.isPowerOfTwo( image.width ) && THREE.Math.isPowerOfTwo( image.height ),\n\t\t\t\tglFormat = paramThreeToGL( texture.format ),\n\t\t\t\tglType = paramThreeToGL( texture.type );\n\n\t\t\t\tsetTextureParameters( _gl.TEXTURE_CUBE_MAP, texture, isImagePowerOfTwo );\n\n\t\t\t\tfor ( var i = 0; i < 6; i ++ ) {\n\n\t\t\t\t\tif ( ! isCompressed ) {\n\n\t\t\t\t\t\tif ( isDataTexture ) {\n\n\t\t\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, 0, glFormat, cubeImage[ i ].width, cubeImage[ i ].height, 0, glFormat, glType, cubeImage[ i ].data );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, 0, glFormat, glFormat, glType, cubeImage[ i ] );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tvar mipmap, mipmaps = cubeImage[ i ].mipmaps;\n\n\t\t\t\t\t\tfor ( var j = 0, jl = mipmaps.length; j < jl; j ++ ) {\n\n\t\t\t\t\t\t\tmipmap = mipmaps[ j ];\n\n\t\t\t\t\t\t\tif ( texture.format !== THREE.RGBAFormat && texture.format !== THREE.RGBFormat ) {\n\n\t\t\t\t\t\t\t\tif ( state.getCompressedTextureFormats().indexOf( glFormat ) > - 1 ) {\n\n\t\t\t\t\t\t\t\t\tstate.compressedTexImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, j, glFormat, mipmap.width, mipmap.height, 0, mipmap.data );\n\n\t\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t\tconsole.warn( \"THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setCubeTexture()\" );\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, j, glFormat, mipmap.width, mipmap.height, 0, glFormat, glType, mipmap.data );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( texture.generateMipmaps && isImagePowerOfTwo ) {\n\n\t\t\t\t\t_gl.generateMipmap( _gl.TEXTURE_CUBE_MAP );\n\n\t\t\t\t}\n\n\t\t\t\ttextureProperties.__version = texture.version;\n\n\t\t\t\tif ( texture.onUpdate ) texture.onUpdate( texture );\n\n\t\t\t} else {\n\n\t\t\t\tstate.activeTexture( _gl.TEXTURE0 + slot );\n\t\t\t\tstate.bindTexture( _gl.TEXTURE_CUBE_MAP, textureProperties.__image__webglTextureCube );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tfunction setCubeTextureDynamic ( texture, slot ) {\n\n\t\tstate.activeTexture( _gl.TEXTURE0 + slot );\n\t\tstate.bindTexture( _gl.TEXTURE_CUBE_MAP, properties.get( texture ).__webglTexture );\n\n\t}\n\n\t// Render targets\n\n\tfunction setupFrameBuffer ( framebuffer, renderTarget, textureTarget ) {\n\n\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, framebuffer );\n\t\t_gl.framebufferTexture2D( _gl.FRAMEBUFFER, _gl.COLOR_ATTACHMENT0, textureTarget, properties.get( renderTarget ).__webglTexture, 0 );\n\n\t}\n\n\tfunction setupRenderBuffer ( renderbuffer, renderTarget ) {\n\n\t\t_gl.bindRenderbuffer( _gl.RENDERBUFFER, renderbuffer );\n\n\t\tif ( renderTarget.depthBuffer && ! renderTarget.stencilBuffer ) {\n\n\t\t\t_gl.renderbufferStorage( _gl.RENDERBUFFER, _gl.DEPTH_COMPONENT16, renderTarget.width, renderTarget.height );\n\t\t\t_gl.framebufferRenderbuffer( _gl.FRAMEBUFFER, _gl.DEPTH_ATTACHMENT, _gl.RENDERBUFFER, renderbuffer );\n\n\t\t/* For some reason this is not working. Defaulting to RGBA4.\n\t\t} else if ( ! renderTarget.depthBuffer && renderTarget.stencilBuffer ) {\n\n\t\t\t_gl.renderbufferStorage( _gl.RENDERBUFFER, _gl.STENCIL_INDEX8, renderTarget.width, renderTarget.height );\n\t\t\t_gl.framebufferRenderbuffer( _gl.FRAMEBUFFER, _gl.STENCIL_ATTACHMENT, _gl.RENDERBUFFER, renderbuffer );\n\t\t*/\n\n\t\t} else if ( renderTarget.depthBuffer && renderTarget.stencilBuffer ) {\n\n\t\t\t_gl.renderbufferStorage( _gl.RENDERBUFFER, _gl.DEPTH_STENCIL, renderTarget.width, renderTarget.height );\n\t\t\t_gl.framebufferRenderbuffer( _gl.FRAMEBUFFER, _gl.DEPTH_STENCIL_ATTACHMENT, _gl.RENDERBUFFER, renderbuffer );\n\n\t\t} else {\n\n\t\t\t_gl.renderbufferStorage( _gl.RENDERBUFFER, _gl.RGBA4, renderTarget.width, renderTarget.height );\n\n\t\t}\n\n\t}\n\n\tthis.setRenderTarget = function ( renderTarget ) {\n\n\t\tvar isCube = ( renderTarget instanceof THREE.WebGLRenderTargetCube );\n\n\t\tif ( renderTarget && properties.get( renderTarget ).__webglFramebuffer === undefined ) {\n\n\t\t\tvar renderTargetProperties = properties.get( renderTarget );\n\n\t\t\tif ( renderTarget.depthBuffer === undefined ) renderTarget.depthBuffer = true;\n\t\t\tif ( renderTarget.stencilBuffer === undefined ) renderTarget.stencilBuffer = true;\n\n\t\t\trenderTarget.addEventListener( 'dispose', onRenderTargetDispose );\n\n\t\t\trenderTargetProperties.__webglTexture = _gl.createTexture();\n\n\t\t\t_infoMemory.textures ++;\n\n\t\t\t// Setup texture, create render and frame buffers\n\n\t\t\tvar isTargetPowerOfTwo = THREE.Math.isPowerOfTwo( renderTarget.width ) && THREE.Math.isPowerOfTwo( renderTarget.height ),\n\t\t\t\tglFormat = paramThreeToGL( renderTarget.format ),\n\t\t\t\tglType = paramThreeToGL( renderTarget.type );\n\n\t\t\tif ( isCube ) {\n\n\t\t\t\trenderTargetProperties.__webglFramebuffer = [];\n\t\t\t\trenderTargetProperties.__webglRenderbuffer = [];\n\n\t\t\t\tstate.bindTexture( _gl.TEXTURE_CUBE_MAP, renderTargetProperties.__webglTexture );\n\n\t\t\t\tsetTextureParameters( _gl.TEXTURE_CUBE_MAP, renderTarget, isTargetPowerOfTwo );\n\n\t\t\t\tfor ( var i = 0; i < 6; i ++ ) {\n\n\t\t\t\t\trenderTargetProperties.__webglFramebuffer[ i ] = _gl.createFramebuffer();\n\t\t\t\t\trenderTargetProperties.__webglRenderbuffer[ i ] = _gl.createRenderbuffer();\n\n\t\t\t\t\tstate.texImage2D( _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, 0, glFormat, renderTarget.width, renderTarget.height, 0, glFormat, glType, null );\n\n\t\t\t\t\tsetupFrameBuffer( renderTargetProperties.__webglFramebuffer[ i ], renderTarget, _gl.TEXTURE_CUBE_MAP_POSITIVE_X + i );\n\t\t\t\t\tsetupRenderBuffer( renderTargetProperties.__webglRenderbuffer[ i ], renderTarget );\n\n\t\t\t\t}\n\n\t\t\t\tif ( renderTarget.generateMipmaps && isTargetPowerOfTwo ) _gl.generateMipmap( _gl.TEXTURE_CUBE_MAP );\n\n\t\t\t} else {\n\n\t\t\t\trenderTargetProperties.__webglFramebuffer = _gl.createFramebuffer();\n\n\t\t\t\tif ( renderTarget.shareDepthFrom ) {\n\n\t\t\t\t\trenderTargetProperties.__webglRenderbuffer = renderTarget.shareDepthFrom.__webglRenderbuffer;\n\n\t\t\t\t} else {\n\n\t\t\t\t\trenderTargetProperties.__webglRenderbuffer = _gl.createRenderbuffer();\n\n\t\t\t\t}\n\n\t\t\t\tstate.bindTexture( _gl.TEXTURE_2D, renderTargetProperties.__webglTexture );\n\t\t\t\tsetTextureParameters( _gl.TEXTURE_2D, renderTarget, isTargetPowerOfTwo );\n\n\t\t\t\tstate.texImage2D( _gl.TEXTURE_2D, 0, glFormat, renderTarget.width, renderTarget.height, 0, glFormat, glType, null );\n\n\t\t\t\tsetupFrameBuffer( renderTargetProperties.__webglFramebuffer, renderTarget, _gl.TEXTURE_2D );\n\n\t\t\t\tif ( renderTarget.shareDepthFrom ) {\n\n\t\t\t\t\tif ( renderTarget.depthBuffer && ! renderTarget.stencilBuffer ) {\n\n\t\t\t\t\t\t_gl.framebufferRenderbuffer( _gl.FRAMEBUFFER, _gl.DEPTH_ATTACHMENT, _gl.RENDERBUFFER, renderTargetProperties.__webglRenderbuffer );\n\n\t\t\t\t\t} else if ( renderTarget.depthBuffer && renderTarget.stencilBuffer ) {\n\n\t\t\t\t\t\t_gl.framebufferRenderbuffer( _gl.FRAMEBUFFER, _gl.DEPTH_STENCIL_ATTACHMENT, _gl.RENDERBUFFER, renderTargetProperties.__webglRenderbuffer );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tsetupRenderBuffer( renderTargetProperties.__webglRenderbuffer, renderTarget );\n\n\t\t\t\t}\n\n\t\t\t\tif ( renderTarget.generateMipmaps && isTargetPowerOfTwo ) _gl.generateMipmap( _gl.TEXTURE_2D );\n\n\t\t\t}\n\n\t\t\t// Release everything\n\n\t\t\tif ( isCube ) {\n\n\t\t\t\tstate.bindTexture( _gl.TEXTURE_CUBE_MAP, null );\n\n\t\t\t} else {\n\n\t\t\t\tstate.bindTexture( _gl.TEXTURE_2D, null );\n\n\t\t\t}\n\n\t\t\t_gl.bindRenderbuffer( _gl.RENDERBUFFER, null );\n\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, null );\n\n\t\t}\n\n\t\tvar framebuffer, width, height, vx, vy;\n\n\t\tif ( renderTarget ) {\n\n\t\t\tvar renderTargetProperties = properties.get( renderTarget );\n\n\t\t\tif ( isCube ) {\n\n\t\t\t\tframebuffer = renderTargetProperties.__webglFramebuffer[ renderTarget.activeCubeFace ];\n\n\t\t\t} else {\n\n\t\t\t\tframebuffer = renderTargetProperties.__webglFramebuffer;\n\n\t\t\t}\n\n\t\t\twidth = renderTarget.width;\n\t\t\theight = renderTarget.height;\n\n\t\t\tvx = 0;\n\t\t\tvy = 0;\n\n\t\t} else {\n\n\t\t\tframebuffer = null;\n\n\t\t\twidth = _viewportWidth;\n\t\t\theight = _viewportHeight;\n\n\t\t\tvx = _viewportX;\n\t\t\tvy = _viewportY;\n\n\t\t}\n\n\t\tif ( framebuffer !== _currentFramebuffer ) {\n\n\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, framebuffer );\n\t\t\t_gl.viewport( vx, vy, width, height );\n\n\t\t\t_currentFramebuffer = framebuffer;\n\n\t\t}\n\n\t\t_currentWidth = width;\n\t\t_currentHeight = height;\n\n\t};\n\n\tthis.readRenderTargetPixels = function( renderTarget, x, y, width, height, buffer ) {\n\n\t\tif ( ! ( renderTarget instanceof THREE.WebGLRenderTarget ) ) {\n\n\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( properties.get( renderTarget ).__webglFramebuffer ) {\n\n\t\t\tif ( renderTarget.format !== THREE.RGBAFormat ) {\n\n\t\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA format. readPixels can read only RGBA format.' );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tvar restore = false;\n\n\t\t\tif ( properties.get( renderTarget ).__webglFramebuffer !== _currentFramebuffer ) {\n\n\t\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, properties.get( renderTarget ).__webglFramebuffer );\n\n\t\t\t\trestore = true;\n\n\t\t\t}\n\n\t\t\tif ( _gl.checkFramebufferStatus( _gl.FRAMEBUFFER ) === _gl.FRAMEBUFFER_COMPLETE ) {\n\n\t\t\t\t_gl.readPixels( x, y, width, height, _gl.RGBA, _gl.UNSIGNED_BYTE, buffer );\n\n\t\t\t} else {\n\n\t\t\t\tconsole.error( 'THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.' );\n\n\t\t\t}\n\n\t\t\tif ( restore ) {\n\n\t\t\t\t_gl.bindFramebuffer( _gl.FRAMEBUFFER, _currentFramebuffer );\n\n\t\t\t}\n\n\t\t}\n\n\t};\n\n\tfunction updateRenderTargetMipmap ( renderTarget ) {\n\n\t\tif ( renderTarget instanceof THREE.WebGLRenderTargetCube ) {\n\n\t\t\tstate.bindTexture( _gl.TEXTURE_CUBE_MAP, properties.get( renderTarget ).__webglTexture );\n\t\t\t_gl.generateMipmap( _gl.TEXTURE_CUBE_MAP );\n\t\t\tstate.bindTexture( _gl.TEXTURE_CUBE_MAP, null );\n\n\t\t} else {\n\n\t\t\tstate.bindTexture( _gl.TEXTURE_2D, properties.get( renderTarget ).__webglTexture );\n\t\t\t_gl.generateMipmap( _gl.TEXTURE_2D );\n\t\t\tstate.bindTexture( _gl.TEXTURE_2D, null );\n\n\t\t}\n\n\t}\n\n\t// Fallback filters for non-power-of-2 textures\n\n\tfunction filterFallback ( f ) {\n\n\t\tif ( f === THREE.NearestFilter || f === THREE.NearestMipMapNearestFilter || f === THREE.NearestMipMapLinearFilter ) {\n\n\t\t\treturn _gl.NEAREST;\n\n\t\t}\n\n\t\treturn _gl.LINEAR;\n\n\t}\n\n\t// Map three.js constants to WebGL constants\n\n\tfunction paramThreeToGL ( p ) {\n\n\t\tvar extension;\n\n\t\tif ( p === THREE.RepeatWrapping ) return _gl.REPEAT;\n\t\tif ( p === THREE.ClampToEdgeWrapping ) return _gl.CLAMP_TO_EDGE;\n\t\tif ( p === THREE.MirroredRepeatWrapping ) return _gl.MIRRORED_REPEAT;\n\n\t\tif ( p === THREE.NearestFilter ) return _gl.NEAREST;\n\t\tif ( p === THREE.NearestMipMapNearestFilter ) return _gl.NEAREST_MIPMAP_NEAREST;\n\t\tif ( p === THREE.NearestMipMapLinearFilter ) return _gl.NEAREST_MIPMAP_LINEAR;\n\n\t\tif ( p === THREE.LinearFilter ) return _gl.LINEAR;\n\t\tif ( p === THREE.LinearMipMapNearestFilter ) return _gl.LINEAR_MIPMAP_NEAREST;\n\t\tif ( p === THREE.LinearMipMapLinearFilter ) return _gl.LINEAR_MIPMAP_LINEAR;\n\n\t\tif ( p === THREE.UnsignedByteType ) return _gl.UNSIGNED_BYTE;\n\t\tif ( p === THREE.UnsignedShort4444Type ) return _gl.UNSIGNED_SHORT_4_4_4_4;\n\t\tif ( p === THREE.UnsignedShort5551Type ) return _gl.UNSIGNED_SHORT_5_5_5_1;\n\t\tif ( p === THREE.UnsignedShort565Type ) return _gl.UNSIGNED_SHORT_5_6_5;\n\n\t\tif ( p === THREE.ByteType ) return _gl.BYTE;\n\t\tif ( p === THREE.ShortType ) return _gl.SHORT;\n\t\tif ( p === THREE.UnsignedShortType ) return _gl.UNSIGNED_SHORT;\n\t\tif ( p === THREE.IntType ) return _gl.INT;\n\t\tif ( p === THREE.UnsignedIntType ) return _gl.UNSIGNED_INT;\n\t\tif ( p === THREE.FloatType ) return _gl.FLOAT;\n\n\t\textension = extensions.get( 'OES_texture_half_float' );\n\n\t\tif ( extension !== null ) {\n\n\t\t\tif ( p === THREE.HalfFloatType ) return extension.HALF_FLOAT_OES;\n\n\t\t}\n\n\t\tif ( p === THREE.AlphaFormat ) return _gl.ALPHA;\n\t\tif ( p === THREE.RGBFormat ) return _gl.RGB;\n\t\tif ( p === THREE.RGBAFormat ) return _gl.RGBA;\n\t\tif ( p === THREE.LuminanceFormat ) return _gl.LUMINANCE;\n\t\tif ( p === THREE.LuminanceAlphaFormat ) return _gl.LUMINANCE_ALPHA;\n\n\t\tif ( p === THREE.AddEquation ) return _gl.FUNC_ADD;\n\t\tif ( p === THREE.SubtractEquation ) return _gl.FUNC_SUBTRACT;\n\t\tif ( p === THREE.ReverseSubtractEquation ) return _gl.FUNC_REVERSE_SUBTRACT;\n\n\t\tif ( p === THREE.ZeroFactor ) return _gl.ZERO;\n\t\tif ( p === THREE.OneFactor ) return _gl.ONE;\n\t\tif ( p === THREE.SrcColorFactor ) return _gl.SRC_COLOR;\n\t\tif ( p === THREE.OneMinusSrcColorFactor ) return _gl.ONE_MINUS_SRC_COLOR;\n\t\tif ( p === THREE.SrcAlphaFactor ) return _gl.SRC_ALPHA;\n\t\tif ( p === THREE.OneMinusSrcAlphaFactor ) return _gl.ONE_MINUS_SRC_ALPHA;\n\t\tif ( p === THREE.DstAlphaFactor ) return _gl.DST_ALPHA;\n\t\tif ( p === THREE.OneMinusDstAlphaFactor ) return _gl.ONE_MINUS_DST_ALPHA;\n\n\t\tif ( p === THREE.DstColorFactor ) return _gl.DST_COLOR;\n\t\tif ( p === THREE.OneMinusDstColorFactor ) return _gl.ONE_MINUS_DST_COLOR;\n\t\tif ( p === THREE.SrcAlphaSaturateFactor ) return _gl.SRC_ALPHA_SATURATE;\n\n\t\textension = extensions.get( 'WEBGL_compressed_texture_s3tc' );\n\n\t\tif ( extension !== null ) {\n\n\t\t\tif ( p === THREE.RGB_S3TC_DXT1_Format ) return extension.COMPRESSED_RGB_S3TC_DXT1_EXT;\n\t\t\tif ( p === THREE.RGBA_S3TC_DXT1_Format ) return extension.COMPRESSED_RGBA_S3TC_DXT1_EXT;\n\t\t\tif ( p === THREE.RGBA_S3TC_DXT3_Format ) return extension.COMPRESSED_RGBA_S3TC_DXT3_EXT;\n\t\t\tif ( p === THREE.RGBA_S3TC_DXT5_Format ) return extension.COMPRESSED_RGBA_S3TC_DXT5_EXT;\n\n\t\t}\n\n\t\textension = extensions.get( 'WEBGL_compressed_texture_pvrtc' );\n\n\t\tif ( extension !== null ) {\n\n\t\t\tif ( p === THREE.RGB_PVRTC_4BPPV1_Format ) return extension.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;\n\t\t\tif ( p === THREE.RGB_PVRTC_2BPPV1_Format ) return extension.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;\n\t\t\tif ( p === THREE.RGBA_PVRTC_4BPPV1_Format ) return extension.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;\n\t\t\tif ( p === THREE.RGBA_PVRTC_2BPPV1_Format ) return extension.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG;\n\n\t\t}\n\n\t\textension = extensions.get( 'EXT_blend_minmax' );\n\n\t\tif ( extension !== null ) {\n\n\t\t\tif ( p === THREE.MinEquation ) return extension.MIN_EXT;\n\t\t\tif ( p === THREE.MaxEquation ) return extension.MAX_EXT;\n\n\t\t}\n\n\t\treturn 0;\n\n\t}\n\n\t// DEPRECATED\n\n\tthis.supportsFloatTextures = function () {\n\n\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( \\'OES_texture_float\\' ).' );\n\t\treturn extensions.get( 'OES_texture_float' );\n\n\t};\n\n\tthis.supportsHalfFloatTextures = function () {\n\n\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( \\'OES_texture_half_float\\' ).' );\n\t\treturn extensions.get( 'OES_texture_half_float' );\n\n\t};\n\n\tthis.supportsStandardDerivatives = function () {\n\n\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( \\'OES_standard_derivatives\\' ).' );\n\t\treturn extensions.get( 'OES_standard_derivatives' );\n\n\t};\n\n\tthis.supportsCompressedTextureS3TC = function () {\n\n\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( \\'WEBGL_compressed_texture_s3tc\\' ).' );\n\t\treturn extensions.get( 'WEBGL_compressed_texture_s3tc' );\n\n\t};\n\n\tthis.supportsCompressedTexturePVRTC = function () {\n\n\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( \\'WEBGL_compressed_texture_pvrtc\\' ).' );\n\t\treturn extensions.get( 'WEBGL_compressed_texture_pvrtc' );\n\n\t};\n\n\tthis.supportsBlendMinMax = function () {\n\n\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( \\'EXT_blend_minmax\\' ).' );\n\t\treturn extensions.get( 'EXT_blend_minmax' );\n\n\t};\n\n\tthis.supportsVertexTextures = function () {\n\n\t\treturn capabilities.vertexTextures;\n\n\t};\n\n\tthis.supportsInstancedArrays = function () {\n\n\t\tconsole.warn( 'THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( \\'ANGLE_instanced_arrays\\' ).' );\n\t\treturn extensions.get( 'ANGLE_instanced_arrays' );\n\n\t};\n\n\t//\n\n\tthis.initMaterial = function () {\n\n\t\tconsole.warn( 'THREE.WebGLRenderer: .initMaterial() has been removed.' );\n\n\t};\n\n\tthis.addPrePlugin = function () {\n\n\t\tconsole.warn( 'THREE.WebGLRenderer: .addPrePlugin() has been removed.' );\n\n\t};\n\n\tthis.addPostPlugin = function () {\n\n\t\tconsole.warn( 'THREE.WebGLRenderer: .addPostPlugin() has been removed.' );\n\n\t};\n\n\tthis.updateShadowMap = function () {\n\n\t\tconsole.warn( 'THREE.WebGLRenderer: .updateShadowMap() has been removed.' );\n\n\t};\n\n\tObject.defineProperties( this, {\n\t\tshadowMapEnabled: {\n\t\t\tget: function () {\n\n\t\t\t\treturn shadowMap.enabled;\n\n\t\t\t},\n\t\t\tset: function ( value ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled.' );\n\t\t\t\tshadowMap.enabled = value;\n\n\t\t\t}\n\t\t},\n\t\tshadowMapType: {\n\t\t\tget: function () {\n\n\t\t\t\treturn shadowMap.type;\n\n\t\t\t},\n\t\t\tset: function ( value ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type.' );\n\t\t\t\tshadowMap.type = value;\n\n\t\t\t}\n\t\t},\n\t\tshadowMapCullFace: {\n\t\t\tget: function () {\n\n\t\t\t\treturn shadowMap.cullFace;\n\n\t\t\t},\n\t\t\tset: function ( value ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace.' );\n\t\t\t\tshadowMap.cullFace = value;\n\n\t\t\t}\n\t\t},\n\t\tshadowMapDebug: {\n\t\t\tget: function () {\n\n\t\t\t\treturn shadowMap.debug;\n\n\t\t\t},\n\t\t\tset: function ( value ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: .shadowMapDebug is now .shadowMap.debug.' );\n\t\t\t\tshadowMap.debug = value;\n\n\t\t\t}\n\t\t}\n\t} );\n\n};\n\n// File:src/renderers/WebGLRenderTarget.js\n\n/**\n * @author szimek / https://github.com/szimek/\n * @author alteredq / http://alteredqualia.com/\n */\n\nTHREE.WebGLRenderTarget = function ( width, height, options ) {\n\n\tthis.uuid = THREE.Math.generateUUID();\n\n\tthis.width = width;\n\tthis.height = height;\n\n\toptions = options || {};\n\n\tthis.wrapS = options.wrapS !== undefined ? options.wrapS : THREE.ClampToEdgeWrapping;\n\tthis.wrapT = options.wrapT !== undefined ? options.wrapT : THREE.ClampToEdgeWrapping;\n\n\tthis.magFilter = options.magFilter !== undefined ? options.magFilter : THREE.LinearFilter;\n\tthis.minFilter = options.minFilter !== undefined ? options.minFilter : THREE.LinearMipMapLinearFilter;\n\n\tthis.anisotropy = options.anisotropy !== undefined ? options.anisotropy : 1;\n\n\tthis.offset = new THREE.Vector2( 0, 0 );\n\tthis.repeat = new THREE.Vector2( 1, 1 );\n\n\tthis.format = options.format !== undefined ? options.format : THREE.RGBAFormat;\n\tthis.type = options.type !== undefined ? options.type : THREE.UnsignedByteType;\n\n\tthis.depthBuffer = options.depthBuffer !== undefined ? options.depthBuffer : true;\n\tthis.stencilBuffer = options.stencilBuffer !== undefined ? options.stencilBuffer : true;\n\n\tthis.generateMipmaps = true;\n\n\tthis.shareDepthFrom = options.shareDepthFrom !== undefined ? options.shareDepthFrom : null;\n\n};\n\nTHREE.WebGLRenderTarget.prototype = {\n\n\tconstructor: THREE.WebGLRenderTarget,\n\n\tsetSize: function ( width, height ) {\n\n\t\tif ( this.width !== width || this.height !== height ) {\n\n\t\t\tthis.width = width;\n\t\t\tthis.height = height;\n\n\t\t\tthis.dispose();\n\n\t\t}\n\n\t},\n\n\tclone: function () {\n\n\t\treturn new this.constructor().copy( this );\n\n\t},\n\n\tcopy: function ( source ) {\n\n\t\tthis.width = source.width;\n\t\tthis.height = source.height;\n\n\t\tthis.wrapS = source.wrapS;\n\t\tthis.wrapT = source.wrapT;\n\n\t\tthis.magFilter = source.magFilter;\n\t\tthis.minFilter = source.minFilter;\n\n\t\tthis.anisotropy = source.anisotropy;\n\n\t\tthis.offset.copy( source.offset );\n\t\tthis.repeat.copy( source.repeat );\n\n\t\tthis.format = source.format;\n\t\tthis.type = source.type;\n\n\t\tthis.depthBuffer = source.depthBuffer;\n\t\tthis.stencilBuffer = source.stencilBuffer;\n\n\t\tthis.generateMipmaps = source.generateMipmaps;\n\n\t\tthis.shareDepthFrom = source.shareDepthFrom;\n\n\t\treturn this;\n\n\t},\n\n\tdispose: function () {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t}\n\n};\n\nTHREE.EventDispatcher.prototype.apply( THREE.WebGLRenderTarget.prototype );\n\n// File:src/renderers/WebGLRenderTargetCube.js\n\n/**\n * @author alteredq / http://alteredqualia.com\n */\n\nTHREE.WebGLRenderTargetCube = function ( width, height, options ) {\n\n\tTHREE.WebGLRenderTarget.call( this, width, height, options );\n\n\tthis.activeCubeFace = 0; // PX 0, NX 1, PY 2, NY 3, PZ 4, NZ 5\n\n};\n\nTHREE.WebGLRenderTargetCube.prototype = Object.create( THREE.WebGLRenderTarget.prototype );\nTHREE.WebGLRenderTargetCube.prototype.constructor = THREE.WebGLRenderTargetCube;\n\n// File:src/renderers/webgl/WebGLBufferRenderer.js\n\n/**\n* @author mrdoob / http://mrdoob.com/\n*/\n\nTHREE.WebGLBufferRenderer = function ( _gl, extensions, _infoRender ) {\n\n\tvar mode;\n\n\tfunction setMode( value ) {\n\n\t\tmode = value;\n\n\t}\n\n\tfunction render( start, count ) {\n\n\t\t_gl.drawArrays( mode, start, count );\n\n\t\t_infoRender.calls ++;\n\t\t_infoRender.vertices += count;\n\t\tif ( mode === _gl.TRIANGLES ) _infoRender.faces += count / 3;\n\n\t}\n\n\tfunction renderInstances( geometry ) {\n\n\t\tvar extension = extensions.get( 'ANGLE_instanced_arrays' );\n\n\t\tif ( extension === null ) {\n\n\t\t\tconsole.error( 'THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tvar position = geometry.attributes.position;\n\n\t\tif ( position instanceof THREE.InterleavedBufferAttribute ) {\n\n\t\t\textension.drawArraysInstancedANGLE( mode, 0, position.data.count, geometry.maxInstancedCount );\n\n\t\t} else {\n\n\t\t\textension.drawArraysInstancedANGLE( mode, 0, position.count, geometry.maxInstancedCount );\n\n\t\t}\n\n\t}\n\n\tthis.setMode = setMode;\n\tthis.render = render;\n\tthis.renderInstances = renderInstances;\n\n};\n\n// File:src/renderers/webgl/WebGLIndexedBufferRenderer.js\n\n/**\n* @author mrdoob / http://mrdoob.com/\n*/\n\nTHREE.WebGLIndexedBufferRenderer = function ( _gl, extensions, _infoRender ) {\n\n\tvar mode;\n\n\tfunction setMode( value ) {\n\n\t\tmode = value;\n\n\t}\n\n\tvar type, size;\n\n\tfunction setIndex( index ) {\n\n\t\tif ( index.array instanceof Uint32Array && extensions.get( 'OES_element_index_uint' ) ) {\n\n\t\t\ttype = _gl.UNSIGNED_INT;\n\t\t\tsize = 4;\n\n\t\t} else {\n\n\t\t\ttype = _gl.UNSIGNED_SHORT;\n\t\t\tsize = 2;\n\n\t\t}\n\n\t}\n\n\tfunction render( start, count ) {\n\n\t\t_gl.drawElements( mode, count, type, start * size );\n\n\t\t_infoRender.calls ++;\n\t\t_infoRender.vertices += count;\n\t\tif ( mode === _gl.TRIANGLES ) _infoRender.faces += count / 3;\n\n\t}\n\n\tfunction renderInstances( geometry ) {\n\n\t\tvar extension = extensions.get( 'ANGLE_instanced_arrays' );\n\n\t\tif ( extension === null ) {\n\n\t\t\tconsole.error( 'THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tvar index = geometry.index;\n\n\t\textension.drawElementsInstancedANGLE( mode, index.array.length, type, 0, geometry.maxInstancedCount );\n\n\t}\n\n\tthis.setMode = setMode;\n\tthis.setIndex = setIndex;\n\tthis.render = render;\n\tthis.renderInstances = renderInstances;\n\n};\n\n// File:src/renderers/webgl/WebGLExtensions.js\n\n/**\n* @author mrdoob / http://mrdoob.com/\n*/\n\nTHREE.WebGLExtensions = function ( gl ) {\n\n\tvar extensions = {};\n\n\tthis.get = function ( name ) {\n\n\t\tif ( extensions[ name ] !== undefined ) {\n\n\t\t\treturn extensions[ name ];\n\n\t\t}\n\n\t\tvar extension;\n\n\t\tswitch ( name ) {\n\n\t\t\tcase 'EXT_texture_filter_anisotropic':\n\t\t\t\textension = gl.getExtension( 'EXT_texture_filter_anisotropic' ) || gl.getExtension( 'MOZ_EXT_texture_filter_anisotropic' ) || gl.getExtension( 'WEBKIT_EXT_texture_filter_anisotropic' );\n\t\t\t\tbreak;\n\n\t\t\tcase 'WEBGL_compressed_texture_s3tc':\n\t\t\t\textension = gl.getExtension( 'WEBGL_compressed_texture_s3tc' ) || gl.getExtension( 'MOZ_WEBGL_compressed_texture_s3tc' ) || gl.getExtension( 'WEBKIT_WEBGL_compressed_texture_s3tc' );\n\t\t\t\tbreak;\n\n\t\t\tcase 'WEBGL_compressed_texture_pvrtc':\n\t\t\t\textension = gl.getExtension( 'WEBGL_compressed_texture_pvrtc' ) || gl.getExtension( 'WEBKIT_WEBGL_compressed_texture_pvrtc' );\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\textension = gl.getExtension( name );\n\n\t\t}\n\n\t\tif ( extension === null ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: ' + name + ' extension not supported.' );\n\n\t\t}\n\n\t\textensions[ name ] = extension;\n\n\t\treturn extension;\n\n\t};\n\n};\n\n// File:src/renderers/webgl/WebGLCapabilities.js\n\nTHREE.WebGLCapabilities = function ( gl, extensions, parameters ) {\n\n\tfunction getMaxPrecision( precision ) {\n\n\t\tif ( precision === 'highp' ) {\n\n\t\t\tif ( gl.getShaderPrecisionFormat( gl.VERTEX_SHADER, gl.HIGH_FLOAT ).precision > 0 &&\n\t\t\t     gl.getShaderPrecisionFormat( gl.FRAGMENT_SHADER, gl.HIGH_FLOAT ).precision > 0 ) {\n\n\t\t\t\treturn 'highp';\n\n\t\t\t}\n\n\t\t\tprecision = 'mediump';\n\n\t\t}\n\n\t\tif ( precision === 'mediump' ) {\n\n\t\t\tif ( gl.getShaderPrecisionFormat( gl.VERTEX_SHADER, gl.MEDIUM_FLOAT ).precision > 0 &&\n\t\t\t     gl.getShaderPrecisionFormat( gl.FRAGMENT_SHADER, gl.MEDIUM_FLOAT ).precision > 0 ) {\n\n\t\t\t\treturn 'mediump';\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn 'lowp';\n\n\t}\n\n\tthis.getMaxPrecision = getMaxPrecision;\n\n\tthis.precision = parameters.precision !== undefined ? parameters.precision : 'highp',\n\tthis.logarithmicDepthBuffer = parameters.logarithmicDepthBuffer !== undefined ? parameters.logarithmicDepthBuffer : false;\n\n\tthis.maxTextures = gl.getParameter( gl.MAX_TEXTURE_IMAGE_UNITS );\n\tthis.maxVertexTextures = gl.getParameter( gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS );\n\tthis.maxTextureSize = gl.getParameter( gl.MAX_TEXTURE_SIZE );\n\tthis.maxCubemapSize = gl.getParameter( gl.MAX_CUBE_MAP_TEXTURE_SIZE );\n\n\tthis.maxAttributes = gl.getParameter( gl.MAX_VERTEX_ATTRIBS );\n\tthis.maxVertexUniforms = gl.getParameter( gl.MAX_VERTEX_UNIFORM_VECTORS );\n\tthis.maxVaryings = gl.getParameter( gl.MAX_VARYING_VECTORS );\n\tthis.maxFragmentUniforms = gl.getParameter( gl.MAX_FRAGMENT_UNIFORM_VECTORS );\n\n\tthis.vertexTextures = this.maxVertexTextures > 0;\n\tthis.floatFragmentTextures = !! extensions.get( 'OES_texture_float' );\n\tthis.floatVertexTextures = this.vertexTextures && this.floatFragmentTextures;\n\n\tvar _maxPrecision = getMaxPrecision( this.precision );\n\n\tif ( _maxPrecision !== this.precision ) {\n\n\t\tconsole.warn( 'THREE.WebGLRenderer:', this.precision, 'not supported, using', _maxPrecision, 'instead.' );\n\t\tthis.precision = _maxPrecision;\n\n\t}\n\n\tif ( this.logarithmicDepthBuffer ) {\n\n\t\tthis.logarithmicDepthBuffer = !! extensions.get( 'EXT_frag_depth' );\n\n\t}\n\n};\n\n// File:src/renderers/webgl/WebGLGeometries.js\n\n/**\n* @author mrdoob / http://mrdoob.com/\n*/\n\nTHREE.WebGLGeometries = function ( gl, properties, info ) {\n\n\tvar geometries = {};\n\n\tfunction get( object ) {\n\n\t\tvar geometry = object.geometry;\n\n\t\tif ( geometries[ geometry.id ] !== undefined ) {\n\n\t\t\treturn geometries[ geometry.id ];\n\n\t\t}\n\n\t\tgeometry.addEventListener( 'dispose', onGeometryDispose );\n\n\t\tvar buffergeometry;\n\n\t\tif ( geometry instanceof THREE.BufferGeometry ) {\n\n\t\t\tbuffergeometry = geometry;\n\n\t\t} else if ( geometry instanceof THREE.Geometry ) {\n\n\t\t\tif ( geometry._bufferGeometry === undefined ) {\n\n\t\t\t\tgeometry._bufferGeometry = new THREE.BufferGeometry().setFromObject( object );\n\n\t\t\t}\n\n\t\t\tbuffergeometry = geometry._bufferGeometry;\n\n\t\t}\n\n\t\tgeometries[ geometry.id ] = buffergeometry;\n\n\t\tinfo.memory.geometries ++;\n\n\t\treturn buffergeometry;\n\n\t}\n\n\tfunction onGeometryDispose( event ) {\n\n\t\tvar geometry = event.target;\n\t\tvar buffergeometry = geometries[ geometry.id ];\n\n\t\tdeleteAttributes( buffergeometry.attributes );\n\n\t\tgeometry.removeEventListener( 'dispose', onGeometryDispose );\n\n\t\tdelete geometries[ geometry.id ];\n\n\t\tvar property = properties.get( geometry );\n\t\tif ( property.wireframe ) deleteAttribute( property.wireframe );\n\n\t\tinfo.memory.geometries --;\n\n\t}\n\n\tfunction getAttributeBuffer( attribute ) {\n\n\t\tif ( attribute instanceof THREE.InterleavedBufferAttribute ) {\n\n\t\t\treturn properties.get( attribute.data ).__webglBuffer;\n\n\t\t}\n\n\t\treturn properties.get( attribute ).__webglBuffer;\n\n\t}\n\n\tfunction deleteAttribute( attribute ) {\n\n\t\tvar buffer = getAttributeBuffer( attribute );\n\n\t\tif ( buffer !== undefined ) {\n\n\t\t\tgl.deleteBuffer( buffer );\n\t\t\tremoveAttributeBuffer( attribute );\n\n\t\t}\n\n\t}\n\n\tfunction deleteAttributes( attributes ) {\n\n\t\tfor ( var name in attributes ) {\n\n\t\t\tdeleteAttribute( attributes[ name ] );\n\n\t\t}\n\n\t}\n\n\tfunction removeAttributeBuffer( attribute ) {\n\n\t\tif ( attribute instanceof THREE.InterleavedBufferAttribute ) {\n\n\t\t\tproperties.delete( attribute.data );\n\n\t\t} else {\n\n\t\t\tproperties.delete( attribute );\n\n\t\t}\n\n\t}\n\n\tthis.get = get;\n\n};\n\n// File:src/renderers/webgl/WebGLObjects.js\n\n/**\n* @author mrdoob / http://mrdoob.com/\n*/\n\nTHREE.WebGLObjects = function ( gl, properties, info ) {\n\n\tvar geometries = new THREE.WebGLGeometries( gl, properties, info );\n\n\t//\n\n\tfunction update( object ) {\n\n\t\t// TODO: Avoid updating twice (when using shadowMap). Maybe add frame counter.\n\n\t\tvar geometry = geometries.get( object );\n\n\t\tif ( object.geometry instanceof THREE.Geometry ) {\n\n\t\t\tgeometry.updateFromObject( object );\n\n\t\t}\n\n\t\tvar index = geometry.index;\n\t\tvar attributes = geometry.attributes;\n\n\t\tif ( index !== null ) {\n\n\t\t\tupdateAttribute( index, gl.ELEMENT_ARRAY_BUFFER );\n\n\t\t}\n\n\t\tfor ( var name in attributes ) {\n\n\t\t\tupdateAttribute( attributes[ name ], gl.ARRAY_BUFFER );\n\n\t\t}\n\n\t\t// morph targets\n\n\t\tvar morphAttributes = geometry.morphAttributes;\n\n\t\tfor ( var name in morphAttributes ) {\n\n\t\t\tvar array = morphAttributes[ name ];\n\n\t\t\tfor ( var i = 0, l = array.length; i < l; i ++ ) {\n\n\t\t\t\tupdateAttribute( array[ i ], gl.ARRAY_BUFFER );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn geometry;\n\n\t}\n\n\tfunction updateAttribute( attribute, bufferType ) {\n\n\t\tvar data = ( attribute instanceof THREE.InterleavedBufferAttribute ) ? attribute.data : attribute;\n\n\t\tvar attributeProperties = properties.get( data );\n\n\t\tif ( attributeProperties.__webglBuffer === undefined ) {\n\n\t\t\tcreateBuffer( attributeProperties, data, bufferType );\n\n\t\t} else if ( attributeProperties.version !== data.version ) {\n\n\t\t\tupdateBuffer( attributeProperties, data, bufferType );\n\n\t\t}\n\n\t}\n\n\tfunction createBuffer( attributeProperties, data, bufferType ) {\n\n\t\tattributeProperties.__webglBuffer = gl.createBuffer();\n\t\tgl.bindBuffer( bufferType, attributeProperties.__webglBuffer );\n\n\t\tvar usage = data.dynamic ? gl.DYNAMIC_DRAW : gl.STATIC_DRAW;\n\n\t\tgl.bufferData( bufferType, data.array, usage );\n\n\t\tattributeProperties.version = data.version;\n\n\t}\n\n\tfunction updateBuffer( attributeProperties, data, bufferType ) {\n\n\t\tgl.bindBuffer( bufferType, attributeProperties.__webglBuffer );\n\n\t\tif ( data.dynamic === false || data.updateRange.count === - 1 ) {\n\n\t\t\t// Not using update ranges\n\n\t\t\tgl.bufferSubData( bufferType, 0, data.array );\n\n\t\t} else if ( data.updateRange.count === 0 ) {\n\n\t\t\tconsole.error( 'THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually.' );\n\n\t\t} else {\n\n\t\t\tgl.bufferSubData( bufferType, data.updateRange.offset * data.array.BYTES_PER_ELEMENT,\n\t\t\t\t\t\t\t  data.array.subarray( data.updateRange.offset, data.updateRange.offset + data.updateRange.count ) );\n\n\t\t\tdata.updateRange.count = 0; // reset range\n\n\t\t}\n\n\t\tattributeProperties.version = data.version;\n\n\t}\n\n\tfunction getAttributeBuffer( attribute ) {\n\n\t\tif ( attribute instanceof THREE.InterleavedBufferAttribute ) {\n\n\t\t\treturn properties.get( attribute.data ).__webglBuffer;\n\n\t\t}\n\n\t\treturn properties.get( attribute ).__webglBuffer;\n\n\t}\n\n\tfunction getWireframeAttribute( geometry ) {\n\n\t\tvar property = properties.get( geometry );\n\n\t\tif ( property.wireframe !== undefined ) {\n\n\t\t\treturn property.wireframe;\n\n\t\t}\n\n\t\tvar indices = [];\n\n\t\tvar index = geometry.index;\n\t\tvar attributes = geometry.attributes;\n\t\tvar position = attributes.position;\n\n\t\t// console.time( 'wireframe' );\n\n\t\tif ( index !== null ) {\n\n\t\t\tvar edges = {};\n\t\t\tvar array = index.array;\n\n\t\t\tfor ( var i = 0, l = array.length; i < l; i += 3 ) {\n\n\t\t\t\tvar a = array[ i + 0 ];\n\t\t\t\tvar b = array[ i + 1 ];\n\t\t\t\tvar c = array[ i + 2 ];\n\n\t\t\t\tif ( checkEdge( edges, a, b ) ) indices.push( a, b );\n\t\t\t\tif ( checkEdge( edges, b, c ) ) indices.push( b, c );\n\t\t\t\tif ( checkEdge( edges, c, a ) ) indices.push( c, a );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tvar array = attributes.position.array;\n\n\t\t\tfor ( var i = 0, l = ( array.length / 3 ) - 1; i < l; i += 3 ) {\n\n\t\t\t\tvar a = i + 0;\n\t\t\t\tvar b = i + 1;\n\t\t\t\tvar c = i + 2;\n\n\t\t\t\tindices.push( a, b, b, c, c, a );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// console.timeEnd( 'wireframe' );\n\n\t\tvar TypeArray = position.count > 65535 ? Uint32Array : Uint16Array;\n\t\tvar attribute = new THREE.BufferAttribute( new TypeArray( indices ), 1 );\n\n\t\tupdateAttribute( attribute, gl.ELEMENT_ARRAY_BUFFER );\n\n\t\tproperty.wireframe = attribute;\n\n\t\treturn attribute;\n\n\t}\n\n\tfunction checkEdge( edges, a, b ) {\n\n\t\tif ( a > b ) {\n\n\t\t\tvar tmp = a;\n\t\t\ta = b;\n\t\t\tb = tmp;\n\n\t\t}\n\n\t\tvar list = edges[ a ];\n\n\t\tif ( list === undefined ) {\n\n\t\t\tedges[ a ] = [ b ];\n\t\t\treturn true;\n\n\t\t} else if ( list.indexOf( b ) === -1 ) {\n\n\t\t\tlist.push( b );\n\t\t\treturn true;\n\n\t\t}\n\n\t\treturn false;\n\n\t}\n\n\tthis.getAttributeBuffer = getAttributeBuffer;\n\tthis.getWireframeAttribute = getWireframeAttribute;\n\n\tthis.update = update;\n\n};\n\n// File:src/renderers/webgl/WebGLProgram.js\n\nTHREE.WebGLProgram = ( function () {\n\n\tvar programIdCount = 0;\n\n\tfunction generateDefines( defines ) {\n\n\t\tvar chunks = [];\n\n\t\tfor ( var name in defines ) {\n\n\t\t\tvar value = defines[ name ];\n\n\t\t\tif ( value === false ) continue;\n\n\t\t\tchunks.push( '#define ' + name + ' ' + value );\n\n\t\t}\n\n\t\treturn chunks.join( '\\n' );\n\n\t}\n\n\tfunction fetchUniformLocations( gl, program, identifiers ) {\n\n\t\tvar uniforms = {};\n\n\t\tvar n = gl.getProgramParameter( program, gl.ACTIVE_UNIFORMS );\n\n\t\tfor ( var i = 0; i < n; i ++ ) {\n\n\t\t\tvar info = gl.getActiveUniform( program, i );\n\t\t\tvar name = info.name;\n\t\t\tvar location = gl.getUniformLocation( program, name );\n\n\t\t\t// console.log(\"THREE.WebGLProgram: ACTIVE UNIFORM:\", name);\n\n\t\t\tvar suffixPos = name.lastIndexOf( '[0]' );\n\t\t\tif ( suffixPos !== - 1 && suffixPos === name.length - 3 ) {\n\n\t\t\t\tuniforms[ name.substr( 0, suffixPos ) ] = location;\n\n\t\t\t}\n\n\t\t\tuniforms[ name ] = location;\n\n\t\t}\n\n\t\treturn uniforms;\n\n\t}\n\n\tfunction fetchAttributeLocations( gl, program, identifiers ) {\n\n\t\tvar attributes = {};\n\n\t\tvar n = gl.getProgramParameter( program, gl.ACTIVE_ATTRIBUTES );\n\n\t\tfor ( var i = 0; i < n; i ++ ) {\n\n\t\t\tvar info = gl.getActiveAttrib( program, i );\n\t\t\tvar name = info.name;\n\n\t\t\t// console.log(\"THREE.WebGLProgram: ACTIVE VERTEX ATTRIBUTE:\", name, i );\n\n\t\t\tattributes[ name ] = gl.getAttribLocation( program, name );\n\n\t\t}\n\n\t\treturn attributes;\n\n\t}\n\n\tfunction filterEmptyLine( string ) {\n\n\t\treturn string !== '';\n\n\t}\n\n\treturn function WebGLProgram( renderer, code, material, parameters ) {\n\n\t\tvar gl = renderer.context;\n\n\t\tvar defines = material.defines;\n\n\t\tvar vertexShader = material.__webglShader.vertexShader;\n\t\tvar fragmentShader = material.__webglShader.fragmentShader;\n\n\t\tvar shadowMapTypeDefine = 'SHADOWMAP_TYPE_BASIC';\n\n\t\tif ( parameters.shadowMapType === THREE.PCFShadowMap ) {\n\n\t\t\tshadowMapTypeDefine = 'SHADOWMAP_TYPE_PCF';\n\n\t\t} else if ( parameters.shadowMapType === THREE.PCFSoftShadowMap ) {\n\n\t\t\tshadowMapTypeDefine = 'SHADOWMAP_TYPE_PCF_SOFT';\n\n\t\t}\n\n\t\tvar envMapTypeDefine = 'ENVMAP_TYPE_CUBE';\n\t\tvar envMapModeDefine = 'ENVMAP_MODE_REFLECTION';\n\t\tvar envMapBlendingDefine = 'ENVMAP_BLENDING_MULTIPLY';\n\n\t\tif ( parameters.envMap ) {\n\n\t\t\tswitch ( material.envMap.mapping ) {\n\n\t\t\t\tcase THREE.CubeReflectionMapping:\n\t\t\t\tcase THREE.CubeRefractionMapping:\n\t\t\t\t\tenvMapTypeDefine = 'ENVMAP_TYPE_CUBE';\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase THREE.EquirectangularReflectionMapping:\n\t\t\t\tcase THREE.EquirectangularRefractionMapping:\n\t\t\t\t\tenvMapTypeDefine = 'ENVMAP_TYPE_EQUIREC';\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase THREE.SphericalReflectionMapping:\n\t\t\t\t\tenvMapTypeDefine = 'ENVMAP_TYPE_SPHERE';\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tswitch ( material.envMap.mapping ) {\n\n\t\t\t\tcase THREE.CubeRefractionMapping:\n\t\t\t\tcase THREE.EquirectangularRefractionMapping:\n\t\t\t\t\tenvMapModeDefine = 'ENVMAP_MODE_REFRACTION';\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tswitch ( material.combine ) {\n\n\t\t\t\tcase THREE.MultiplyOperation:\n\t\t\t\t\tenvMapBlendingDefine = 'ENVMAP_BLENDING_MULTIPLY';\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase THREE.MixOperation:\n\t\t\t\t\tenvMapBlendingDefine = 'ENVMAP_BLENDING_MIX';\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase THREE.AddOperation:\n\t\t\t\t\tenvMapBlendingDefine = 'ENVMAP_BLENDING_ADD';\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tvar gammaFactorDefine = ( renderer.gammaFactor > 0 ) ? renderer.gammaFactor : 1.0;\n\n\t\t// console.log( 'building new program ' );\n\n\t\t//\n\n\t\tvar customDefines = generateDefines( defines );\n\n\t\t//\n\n\t\tvar program = gl.createProgram();\n\n\t\tvar prefixVertex, prefixFragment;\n\n\t\tif ( material instanceof THREE.RawShaderMaterial ) {\n\n\t\t\tprefixVertex = '';\n\t\t\tprefixFragment = '';\n\n\t\t} else {\n\n\t\t\tprefixVertex = [\n\n\t\t\t\t'precision ' + parameters.precision + ' float;',\n\t\t\t\t'precision ' + parameters.precision + ' int;',\n\n\t\t\t\t'#define SHADER_NAME ' + material.__webglShader.name,\n\n\t\t\t\tcustomDefines,\n\n\t\t\t\tparameters.supportsVertexTextures ? '#define VERTEX_TEXTURES' : '',\n\n\t\t\t\trenderer.gammaInput ? '#define GAMMA_INPUT' : '',\n\t\t\t\trenderer.gammaOutput ? '#define GAMMA_OUTPUT' : '',\n\t\t\t\t'#define GAMMA_FACTOR ' + gammaFactorDefine,\n\n\t\t\t\t'#define MAX_DIR_LIGHTS ' + parameters.maxDirLights,\n\t\t\t\t'#define MAX_POINT_LIGHTS ' + parameters.maxPointLights,\n\t\t\t\t'#define MAX_SPOT_LIGHTS ' + parameters.maxSpotLights,\n\t\t\t\t'#define MAX_HEMI_LIGHTS ' + parameters.maxHemiLights,\n\n\t\t\t\t'#define MAX_SHADOWS ' + parameters.maxShadows,\n\n\t\t\t\t'#define MAX_BONES ' + parameters.maxBones,\n\n\t\t\t\tparameters.map ? '#define USE_MAP' : '',\n\t\t\t\tparameters.envMap ? '#define USE_ENVMAP' : '',\n\t\t\t\tparameters.envMap ? '#define ' + envMapModeDefine : '',\n\t\t\t\tparameters.lightMap ? '#define USE_LIGHTMAP' : '',\n\t\t\t\tparameters.aoMap ? '#define USE_AOMAP' : '',\n\t\t\t\tparameters.emissiveMap ? '#define USE_EMISSIVEMAP' : '',\n\t\t\t\tparameters.bumpMap ? '#define USE_BUMPMAP' : '',\n\t\t\t\tparameters.normalMap ? '#define USE_NORMALMAP' : '',\n\t\t\t\tparameters.displacementMap && parameters.supportsVertexTextures ? '#define USE_DISPLACEMENTMAP' : '',\n\t\t\t\tparameters.specularMap ? '#define USE_SPECULARMAP' : '',\n\t\t\t\tparameters.alphaMap ? '#define USE_ALPHAMAP' : '',\n\t\t\t\tparameters.vertexColors ? '#define USE_COLOR' : '',\n\n\t\t\t\tparameters.flatShading ? '#define FLAT_SHADED' : '',\n\n\t\t\t\tparameters.skinning ? '#define USE_SKINNING' : '',\n\t\t\t\tparameters.useVertexTexture ? '#define BONE_TEXTURE' : '',\n\n\t\t\t\tparameters.morphTargets ? '#define USE_MORPHTARGETS' : '',\n\t\t\t\tparameters.morphNormals && parameters.flatShading === false ? '#define USE_MORPHNORMALS' : '',\n\t\t\t\tparameters.doubleSided ? '#define DOUBLE_SIDED' : '',\n\t\t\t\tparameters.flipSided ? '#define FLIP_SIDED' : '',\n\n\t\t\t\tparameters.shadowMapEnabled ? '#define USE_SHADOWMAP' : '',\n\t\t\t\tparameters.shadowMapEnabled ? '#define ' + shadowMapTypeDefine : '',\n\t\t\t\tparameters.shadowMapDebug ? '#define SHADOWMAP_DEBUG' : '',\n\n\t\t\t\tparameters.sizeAttenuation ? '#define USE_SIZEATTENUATION' : '',\n\n\t\t\t\tparameters.logarithmicDepthBuffer ? '#define USE_LOGDEPTHBUF' : '',\n\t\t\t\tparameters.logarithmicDepthBuffer && renderer.extensions.get( 'EXT_frag_depth' ) ? '#define USE_LOGDEPTHBUF_EXT' : '',\n\n\n\t\t\t\t'uniform mat4 modelMatrix;',\n\t\t\t\t'uniform mat4 modelViewMatrix;',\n\t\t\t\t'uniform mat4 projectionMatrix;',\n\t\t\t\t'uniform mat4 viewMatrix;',\n\t\t\t\t'uniform mat3 normalMatrix;',\n\t\t\t\t'uniform vec3 cameraPosition;',\n\n\t\t\t\t'attribute vec3 position;',\n\t\t\t\t'attribute vec3 normal;',\n\t\t\t\t'attribute vec2 uv;',\n\n\t\t\t\t'#ifdef USE_COLOR',\n\n\t\t\t\t'\tattribute vec3 color;',\n\n\t\t\t\t'#endif',\n\n\t\t\t\t'#ifdef USE_MORPHTARGETS',\n\n\t\t\t\t'\tattribute vec3 morphTarget0;',\n\t\t\t\t'\tattribute vec3 morphTarget1;',\n\t\t\t\t'\tattribute vec3 morphTarget2;',\n\t\t\t\t'\tattribute vec3 morphTarget3;',\n\n\t\t\t\t'\t#ifdef USE_MORPHNORMALS',\n\n\t\t\t\t'\t\tattribute vec3 morphNormal0;',\n\t\t\t\t'\t\tattribute vec3 morphNormal1;',\n\t\t\t\t'\t\tattribute vec3 morphNormal2;',\n\t\t\t\t'\t\tattribute vec3 morphNormal3;',\n\n\t\t\t\t'\t#else',\n\n\t\t\t\t'\t\tattribute vec3 morphTarget4;',\n\t\t\t\t'\t\tattribute vec3 morphTarget5;',\n\t\t\t\t'\t\tattribute vec3 morphTarget6;',\n\t\t\t\t'\t\tattribute vec3 morphTarget7;',\n\n\t\t\t\t'\t#endif',\n\n\t\t\t\t'#endif',\n\n\t\t\t\t'#ifdef USE_SKINNING',\n\n\t\t\t\t'\tattribute vec4 skinIndex;',\n\t\t\t\t'\tattribute vec4 skinWeight;',\n\n\t\t\t\t'#endif',\n\n\t\t\t\t'\\n'\n\n\t\t\t].filter( filterEmptyLine ).join( '\\n' );\n\n\t\t\tprefixFragment = [\n\n\t\t\t\tparameters.bumpMap || parameters.normalMap || parameters.flatShading || material.derivatives ? '#extension GL_OES_standard_derivatives : enable' : '',\n\t\t\t\tparameters.logarithmicDepthBuffer && renderer.extensions.get( 'EXT_frag_depth' ) ? '#extension GL_EXT_frag_depth : enable' : '',\n\n\t\t\t\t'precision ' + parameters.precision + ' float;',\n\t\t\t\t'precision ' + parameters.precision + ' int;',\n\n\t\t\t\t'#define SHADER_NAME ' + material.__webglShader.name,\n\n\t\t\t\tcustomDefines,\n\n\t\t\t\t'#define MAX_DIR_LIGHTS ' + parameters.maxDirLights,\n\t\t\t\t'#define MAX_POINT_LIGHTS ' + parameters.maxPointLights,\n\t\t\t\t'#define MAX_SPOT_LIGHTS ' + parameters.maxSpotLights,\n\t\t\t\t'#define MAX_HEMI_LIGHTS ' + parameters.maxHemiLights,\n\n\t\t\t\t'#define MAX_SHADOWS ' + parameters.maxShadows,\n\n\t\t\t\tparameters.alphaTest ? '#define ALPHATEST ' + parameters.alphaTest : '',\n\n\t\t\t\trenderer.gammaInput ? '#define GAMMA_INPUT' : '',\n\t\t\t\trenderer.gammaOutput ? '#define GAMMA_OUTPUT' : '',\n\t\t\t\t'#define GAMMA_FACTOR ' + gammaFactorDefine,\n\n\t\t\t\t( parameters.useFog && parameters.fog ) ? '#define USE_FOG' : '',\n\t\t\t\t( parameters.useFog && parameters.fogExp ) ? '#define FOG_EXP2' : '',\n\n\t\t\t\tparameters.map ? '#define USE_MAP' : '',\n\t\t\t\tparameters.envMap ? '#define USE_ENVMAP' : '',\n\t\t\t\tparameters.envMap ? '#define ' + envMapTypeDefine : '',\n\t\t\t\tparameters.envMap ? '#define ' + envMapModeDefine : '',\n\t\t\t\tparameters.envMap ? '#define ' + envMapBlendingDefine : '',\n\t\t\t\tparameters.lightMap ? '#define USE_LIGHTMAP' : '',\n\t\t\t\tparameters.aoMap ? '#define USE_AOMAP' : '',\n\t\t\t\tparameters.emissiveMap ? '#define USE_EMISSIVEMAP' : '',\n\t\t\t\tparameters.bumpMap ? '#define USE_BUMPMAP' : '',\n\t\t\t\tparameters.normalMap ? '#define USE_NORMALMAP' : '',\n\t\t\t\tparameters.specularMap ? '#define USE_SPECULARMAP' : '',\n\t\t\t\tparameters.alphaMap ? '#define USE_ALPHAMAP' : '',\n\t\t\t\tparameters.vertexColors ? '#define USE_COLOR' : '',\n\n\t\t\t\tparameters.flatShading ? '#define FLAT_SHADED' : '',\n\n\t\t\t\tparameters.metal ? '#define METAL' : '',\n\t\t\t\tparameters.doubleSided ? '#define DOUBLE_SIDED' : '',\n\t\t\t\tparameters.flipSided ? '#define FLIP_SIDED' : '',\n\n\t\t\t\tparameters.shadowMapEnabled ? '#define USE_SHADOWMAP' : '',\n\t\t\t\tparameters.shadowMapEnabled ? '#define ' + shadowMapTypeDefine : '',\n\t\t\t\tparameters.shadowMapDebug ? '#define SHADOWMAP_DEBUG' : '',\n\n\t\t\t\tparameters.logarithmicDepthBuffer ? '#define USE_LOGDEPTHBUF' : '',\n\t\t\t\tparameters.logarithmicDepthBuffer && renderer.extensions.get( 'EXT_frag_depth' ) ? '#define USE_LOGDEPTHBUF_EXT' : '',\n\n\t\t\t\t'uniform mat4 viewMatrix;',\n\t\t\t\t'uniform vec3 cameraPosition;',\n\n\t\t\t\t'\\n'\n\n\t\t\t].filter( filterEmptyLine ).join( '\\n' );\n\n\t\t}\n\n\t\tvar vertexGlsl = prefixVertex + vertexShader;\n\t\tvar fragmentGlsl = prefixFragment + fragmentShader;\n\n\t\tvar glVertexShader = THREE.WebGLShader( gl, gl.VERTEX_SHADER, vertexGlsl );\n\t\tvar glFragmentShader = THREE.WebGLShader( gl, gl.FRAGMENT_SHADER, fragmentGlsl );\n\n\t\tgl.attachShader( program, glVertexShader );\n\t\tgl.attachShader( program, glFragmentShader );\n\n\t\t// Force a particular attribute to index 0.\n\n\t\tif ( material.index0AttributeName !== undefined ) {\n\n\t\t\tgl.bindAttribLocation( program, 0, material.index0AttributeName );\n\n\t\t} else if ( parameters.morphTargets === true ) {\n\n\t\t\t// programs with morphTargets displace position out of attribute 0\n\t\t\tgl.bindAttribLocation( program, 0, 'position' );\n\n\t\t}\n\n\t\tgl.linkProgram( program );\n\n\t\tvar programLog = gl.getProgramInfoLog( program );\n\t\tvar vertexLog = gl.getShaderInfoLog( glVertexShader );\n\t\tvar fragmentLog = gl.getShaderInfoLog( glFragmentShader );\n\n\t\tvar runnable = true;\n\t\tvar haveDiagnostics = true;\n\n\t\tif ( gl.getProgramParameter( program, gl.LINK_STATUS ) === false ) {\n\n\t\t\trunnable = false;\n\n\t\t\tconsole.error( 'THREE.WebGLProgram: shader error: ', gl.getError(), 'gl.VALIDATE_STATUS', gl.getProgramParameter( program, gl.VALIDATE_STATUS ), 'gl.getProgramInfoLog', programLog, vertexLog, fragmentLog );\n\n\t\t} else if ( programLog !== '' ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLProgram: gl.getProgramInfoLog()', programLog );\n\n\t\t} else if ( vertexLog === '' || fragmentLog === '' ) {\n\n\t\t\thaveDiagnostics = false;\n\n\t\t}\n\n\t\tif ( haveDiagnostics ) {\n\n\t\t\tthis.diagnostics = {\n\n\t\t\t\trunnable: runnable,\n\t\t\t\tmaterial: material,\n\n\t\t\t\tprogramLog: programLog,\n\n\t\t\t\tvertexShader: {\n\n\t\t\t\t\tlog: vertexLog,\n\t\t\t\t\tprefix: prefixVertex\n\n\t\t\t\t},\n\n\t\t\t\tfragmentShader: {\n\n\t\t\t\t\tlog: fragmentLog,\n\t\t\t\t\tprefix: prefixFragment\n\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t}\n\n\t\t// clean up\n\n\t\tgl.deleteShader( glVertexShader );\n\t\tgl.deleteShader( glFragmentShader );\n\n\t\t// set up caching for uniform locations\n\n\t\tvar cachedUniforms;\n\n\t\tthis.getUniforms = function() {\n\n\t\t\tif ( cachedUniforms === undefined ) {\n\n\t\t\t\tcachedUniforms = fetchUniformLocations( gl, program );\n\n\t\t\t}\n\n\t\t\treturn cachedUniforms;\n\n\t\t};\n\n\t\t// set up caching for attribute locations\n\n\t\tvar cachedAttributes;\n\n\t\tthis.getAttributes = function() {\n\n\t\t\tif ( cachedAttributes === undefined ) {\n\n\t\t\t\tcachedAttributes = fetchAttributeLocations( gl, program );\n\n\t\t\t}\n\n\t\t\treturn cachedAttributes;\n\n\t\t};\n\n\t\t// free resource\n\n\t\tthis.destroy = function() {\n\n\t\t\tgl.deleteProgram( program );\n\t\t\tthis.program = undefined;\n\n\t\t};\n\n\t\t// DEPRECATED\n\n\t\tObject.defineProperties( this, {\n\n\t\t\tuniforms: {\n\t\t\t\tget: function() {\n\n\t\t\t\t\tconsole.warn( 'THREE.WebGLProgram: .uniforms is now .getUniforms().' );\n\t\t\t\t\treturn this.getUniforms();\n\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tattributes: {\n\t\t\t\tget: function() {\n\n\t\t\t\t\tconsole.warn( 'THREE.WebGLProgram: .attributes is now .getAttributes().' );\n\t\t\t\t\treturn this.getAttributes();\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t} );\n\n\n\t\t//\n\n\t\tthis.id = programIdCount ++;\n\t\tthis.code = code;\n\t\tthis.usedTimes = 1;\n\t\tthis.program = program;\n\t\tthis.vertexShader = glVertexShader;\n\t\tthis.fragmentShader = glFragmentShader;\n\n\t\treturn this;\n\n\t};\n\n} )();\n\n// File:src/renderers/webgl/WebGLPrograms.js\n\nTHREE.WebGLPrograms = function ( renderer, capabilities ) {\n\n\tvar programs = [];\n\n\tvar shaderIDs = {\n\t\tMeshDepthMaterial: 'depth',\n\t\tMeshNormalMaterial: 'normal',\n\t\tMeshBasicMaterial: 'basic',\n\t\tMeshLambertMaterial: 'lambert',\n\t\tMeshPhongMaterial: 'phong',\n\t\tLineBasicMaterial: 'basic',\n\t\tLineDashedMaterial: 'dashed',\n\t\tPointsMaterial: 'points'\n\t};\n\n\tvar parameterNames = [\n\t\t\"precision\", \"supportsVertexTextures\", \"map\", \"envMap\", \"envMapMode\",\n\t\t\"lightMap\", \"aoMap\", \"emissiveMap\", \"bumpMap\", \"normalMap\", \"specularMap\",\n\t\t\"alphaMap\", \"combine\", \"vertexColors\", \"fog\", \"useFog\", \"fogExp\",\n\t\t\"flatShading\", \"sizeAttenuation\", \"logarithmicDepthBuffer\", \"skinning\",\n\t\t\"maxBones\", \"useVertexTexture\", \"morphTargets\", \"morphNormals\",\n\t\t\"maxMorphTargets\", \"maxMorphNormals\", \"maxDirLights\", \"maxPointLights\",\n\t\t\"maxSpotLights\", \"maxHemiLights\", \"maxShadows\", \"shadowMapEnabled\",\n\t\t\"shadowMapType\", \"shadowMapDebug\", \"alphaTest\", \"metal\", \"doubleSided\",\n\t\t\"flipSided\"\n\t];\n\n\n\tfunction allocateBones ( object ) {\n\n\t\tif ( capabilities.floatVertexTextures && object && object.skeleton && object.skeleton.useVertexTexture ) {\n\n\t\t\treturn 1024;\n\n\t\t} else {\n\n\t\t\t// default for when object is not specified\n\t\t\t// ( for example when prebuilding shader to be used with multiple objects )\n\t\t\t//\n\t\t\t//  - leave some extra space for other uniforms\n\t\t\t//  - limit here is ANGLE's 254 max uniform vectors\n\t\t\t//    (up to 54 should be safe)\n\n\t\t\tvar nVertexUniforms = capabilities.maxVertexUniforms;\n\t\t\tvar nVertexMatrices = Math.floor( ( nVertexUniforms - 20 ) / 4 );\n\n\t\t\tvar maxBones = nVertexMatrices;\n\n\t\t\tif ( object !== undefined && object instanceof THREE.SkinnedMesh ) {\n\n\t\t\t\tmaxBones = Math.min( object.skeleton.bones.length, maxBones );\n\n\t\t\t\tif ( maxBones < object.skeleton.bones.length ) {\n\n\t\t\t\t\tconsole.warn( 'WebGLRenderer: too many bones - ' + object.skeleton.bones.length + ', this GPU supports just ' + maxBones + ' (try OpenGL instead of ANGLE)' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn maxBones;\n\n\t\t}\n\n\t}\n\n\tfunction allocateLights( lights ) {\n\n\t\tvar dirLights = 0;\n\t\tvar pointLights = 0;\n\t\tvar spotLights = 0;\n\t\tvar hemiLights = 0;\n\n\t\tfor ( var l = 0, ll = lights.length; l < ll; l ++ ) {\n\n\t\t\tvar light = lights[ l ];\n\n\t\t\tif ( light.onlyShadow || light.visible === false ) continue;\n\n\t\t\tif ( light instanceof THREE.DirectionalLight ) dirLights ++;\n\t\t\tif ( light instanceof THREE.PointLight ) pointLights ++;\n\t\t\tif ( light instanceof THREE.SpotLight ) spotLights ++;\n\t\t\tif ( light instanceof THREE.HemisphereLight ) hemiLights ++;\n\n\t\t}\n\n\t\treturn { 'directional': dirLights, 'point': pointLights, 'spot': spotLights, 'hemi': hemiLights };\n\n\t}\n\n\tfunction allocateShadows( lights ) {\n\n\t\tvar maxShadows = 0;\n\n\t\tfor ( var l = 0, ll = lights.length; l < ll; l ++ ) {\n\n\t\t\tvar light = lights[ l ];\n\n\t\t\tif ( ! light.castShadow ) continue;\n\n\t\t\tif ( light instanceof THREE.SpotLight ) maxShadows ++;\n\t\t\tif ( light instanceof THREE.DirectionalLight ) maxShadows ++;\n\n\t\t}\n\n\t\treturn maxShadows;\n\n\t}\n\n\tthis.getParameters = function ( material, lights, fog, object ) {\n\n\t\tvar shaderID = shaderIDs[ material.type ];\n\t\t// heuristics to create shader parameters according to lights in the scene\n\t\t// (not to blow over maxLights budget)\n\n\t\tvar maxLightCount = allocateLights( lights );\n\t\tvar maxShadows = allocateShadows( lights );\n\t\tvar maxBones = allocateBones( object );\n\t\tvar precision = renderer.getPrecision();\n\n\t\tif ( material.precision !== null ) {\n\n\t\t\tprecision = capabilities.getMaxPrecision( material.precision );\n\n\t\t\tif ( precision !== material.precision ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLRenderer.initMaterial:', material.precision, 'not supported, using', precision, 'instead.' );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvar parameters = {\n\n\t\t\tshaderID: shaderID,\n\n\t\t\tprecision: precision,\n\t\t\tsupportsVertexTextures: capabilities.vertexTextures,\n\n\t\t\tmap: !! material.map,\n\t\t\tenvMap: !! material.envMap,\n\t\t\tenvMapMode: material.envMap && material.envMap.mapping,\n\t\t\tlightMap: !! material.lightMap,\n\t\t\taoMap: !! material.aoMap,\n\t\t\temissiveMap: !! material.emissiveMap,\n\t\t\tbumpMap: !! material.bumpMap,\n\t\t\tnormalMap: !! material.normalMap,\n\t\t\tdisplacementMap: !! material.displacementMap,\n\t\t\tspecularMap: !! material.specularMap,\n\t\t\talphaMap: !! material.alphaMap,\n\n\t\t\tcombine: material.combine,\n\n\t\t\tvertexColors: material.vertexColors,\n\n\t\t\tfog: fog,\n\t\t\tuseFog: material.fog,\n\t\t\tfogExp: fog instanceof THREE.FogExp2,\n\n\t\t\tflatShading: material.shading === THREE.FlatShading,\n\n\t\t\tsizeAttenuation: material.sizeAttenuation,\n\t\t\tlogarithmicDepthBuffer: renderer.logarithmicDepthBuffer,\n\n\t\t\tskinning: material.skinning,\n\t\t\tmaxBones: maxBones,\n\t\t\tuseVertexTexture: capabilities.floatVertexTextures && object && object.skeleton && object.skeleton.useVertexTexture,\n\n\t\t\tmorphTargets: material.morphTargets,\n\t\t\tmorphNormals: material.morphNormals,\n\t\t\tmaxMorphTargets: renderer.maxMorphTargets,\n\t\t\tmaxMorphNormals: renderer.maxMorphNormals,\n\n\t\t\tmaxDirLights: maxLightCount.directional,\n\t\t\tmaxPointLights: maxLightCount.point,\n\t\t\tmaxSpotLights: maxLightCount.spot,\n\t\t\tmaxHemiLights: maxLightCount.hemi,\n\n\t\t\tmaxShadows: maxShadows,\n\t\t\tshadowMapEnabled: renderer.shadowMap.enabled && object.receiveShadow && maxShadows > 0,\n\t\t\tshadowMapType: renderer.shadowMap.type,\n\t\t\tshadowMapDebug: renderer.shadowMap.debug,\n\n\t\t\talphaTest: material.alphaTest,\n\t\t\tmetal: material.metal,\n\t\t\tdoubleSided: material.side === THREE.DoubleSide,\n\t\t\tflipSided: material.side === THREE.BackSide\n\n\t\t};\n\n\t\treturn parameters;\n\n\t};\n\n\tthis.getProgramCode = function ( material, parameters ) {\n\n\t\tvar chunks = [];\n\n\t\tif ( parameters.shaderID ) {\n\n\t\t\tchunks.push( parameters.shaderID );\n\n\t\t} else {\n\n\t\t\tchunks.push( material.fragmentShader );\n\t\t\tchunks.push( material.vertexShader );\n\n\t\t}\n\n\t\tif ( material.defines !== undefined ) {\n\n\t\t\tfor ( var name in material.defines ) {\n\n\t\t\t\tchunks.push( name );\n\t\t\t\tchunks.push( material.defines[ name ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfor ( var i = 0; i < parameterNames.length; i ++ ) {\n\n\t\t\tvar parameterName = parameterNames[ i ];\n\t\t\tchunks.push( parameterName );\n\t\t\tchunks.push( parameters[ parameterName ] );\n\n\t\t}\n\n\t\treturn chunks.join();\n\n\t};\n\n\tthis.acquireProgram = function ( material, parameters, code ) {\n\n\t\tvar program;\n\n\t\t// Check if code has been already compiled\n\t\tfor ( var p = 0, pl = programs.length; p < pl; p ++ ) {\n\n\t\t\tvar programInfo = programs[ p ];\n\n\t\t\tif ( programInfo.code === code ) {\n\n\t\t\t\tprogram = programInfo;\n\t\t\t\t++ program.usedTimes;\n\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( program === undefined ) {\n\n\t\t\tprogram = new THREE.WebGLProgram( renderer, code, material, parameters );\n\t\t\tprograms.push( program );\n\n\t\t}\n\n\t\treturn program;\n\n\t};\n\n\tthis.releaseProgram = function( program ) {\n\n\t\tif ( -- program.usedTimes === 0 ) {\n\n\t\t\t// Remove from unordered set\n\t\t\tvar i = programs.indexOf( program );\n\t\t\tprograms[ i ] = programs[ programs.length - 1 ];\n\t\t\tprograms.pop();\n\n\t\t\t// Free WebGL resources\n\t\t\tprogram.destroy();\n\n\t\t}\n\n\t};\n\n\t// Exposed for resource monitoring & error feedback via renderer.info:\n\tthis.programs = programs;\n\n};\n\n// File:src/renderers/webgl/WebGLProperties.js\n\n/**\n* @author fordacious / fordacious.github.io\n*/\n\nTHREE.WebGLProperties = function () {\n\n\tvar properties = {};\n\n\tthis.get = function ( object ) {\n\n\t\tvar uuid = object.uuid;\n\t\tvar map = properties[ uuid ];\n\n\t\tif ( map === undefined ) {\n\n\t\t\tmap = {};\n\t\t\tproperties[ uuid ] = map;\n\n\t\t}\n\n\t\treturn map;\n\n\t};\n\n\tthis.delete = function ( object ) {\n\n\t\tdelete properties[ object.uuid ];\n\n\t};\n\n\tthis.clear = function () {\n\n\t\tproperties = {};\n\n\t};\n\n};\n\n// File:src/renderers/webgl/WebGLShader.js\n\nTHREE.WebGLShader = ( function () {\n\n\tvar addLineNumbers = function ( string ) {\n\n\t\tvar lines = string.split( '\\n' );\n\n\t\tfor ( var i = 0; i < lines.length; i ++ ) {\n\n\t\t\tlines[ i ] = ( i + 1 ) + ': ' + lines[ i ];\n\n\t\t}\n\n\t\treturn lines.join( '\\n' );\n\n\t};\n\n\treturn function WebGLShader( gl, type, string ) {\n\n\t\tvar shader = gl.createShader( type );\n\n\t\tgl.shaderSource( shader, string );\n\t\tgl.compileShader( shader );\n\n\t\tif ( gl.getShaderParameter( shader, gl.COMPILE_STATUS ) === false ) {\n\n\t\t\tconsole.error( 'THREE.WebGLShader: Shader couldn\\'t compile.' );\n\n\t\t}\n\n\t\tif ( gl.getShaderInfoLog( shader ) !== '' ) {\n\n\t\t\tconsole.warn( 'THREE.WebGLShader: gl.getShaderInfoLog()', type === gl.VERTEX_SHADER ? 'vertex' : 'fragment', gl.getShaderInfoLog( shader ), addLineNumbers( string ) );\n\n\t\t}\n\n\t\t// --enable-privileged-webgl-extension\n\t\t// console.log( type, gl.getExtension( 'WEBGL_debug_shaders' ).getTranslatedShaderSource( shader ) );\n\n\t\treturn shader;\n\n\t};\n\n} )();\n\n// File:src/renderers/webgl/WebGLShadowMap.js\n\n/**\n * @author alteredq / http://alteredqualia.com/\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.WebGLShadowMap = function ( _renderer, _lights, _objects ) {\n\n\tvar _gl = _renderer.context,\n\t_state = _renderer.state,\n\t_frustum = new THREE.Frustum(),\n\t_projScreenMatrix = new THREE.Matrix4(),\n\n\t_min = new THREE.Vector3(),\n\t_max = new THREE.Vector3(),\n\n\t_matrixPosition = new THREE.Vector3(),\n\n\t_renderList = [];\n\n\t// init\n\n\tvar depthShader = THREE.ShaderLib[ \"depthRGBA\" ];\n\tvar depthUniforms = THREE.UniformsUtils.clone( depthShader.uniforms );\n\n\tvar _depthMaterial = new THREE.ShaderMaterial( {\n\t\tuniforms: depthUniforms,\n\t\tvertexShader: depthShader.vertexShader,\n\t\tfragmentShader: depthShader.fragmentShader\n\t } );\n\n\tvar _depthMaterialMorph = new THREE.ShaderMaterial( {\n\t\tuniforms: depthUniforms,\n\t\tvertexShader: depthShader.vertexShader,\n\t\tfragmentShader: depthShader.fragmentShader,\n\t\tmorphTargets: true\n\t} );\n\n\tvar _depthMaterialSkin = new THREE.ShaderMaterial( {\n\t\tuniforms: depthUniforms,\n\t\tvertexShader: depthShader.vertexShader,\n\t\tfragmentShader: depthShader.fragmentShader,\n\t\tskinning: true\n\t} );\n\n\tvar _depthMaterialMorphSkin = new THREE.ShaderMaterial( {\n\t\tuniforms: depthUniforms,\n\t\tvertexShader: depthShader.vertexShader,\n\t\tfragmentShader: depthShader.fragmentShader,\n\t\tmorphTargets: true,\n\t\tskinning: true\n\t} );\n\n\t_depthMaterial._shadowPass = true;\n\t_depthMaterialMorph._shadowPass = true;\n\t_depthMaterialSkin._shadowPass = true;\n\t_depthMaterialMorphSkin._shadowPass = true;\n\n\t//\n\n\tvar scope = this;\n\n\tthis.enabled = false;\n\n\tthis.autoUpdate = true;\n\tthis.needsUpdate = false;\n\n\tthis.type = THREE.PCFShadowMap;\n\tthis.cullFace = THREE.CullFaceFront;\n\n\tthis.render = function ( scene, camera ) {\n\n\t\tif ( scope.enabled === false ) return;\n\t\tif ( scope.autoUpdate === false && scope.needsUpdate === false ) return;\n\n\t\t// set GL state for depth map\n\n\t\t_gl.clearColor( 1, 1, 1, 1 );\n\t\t_state.disable( _gl.BLEND );\n\n\t\t_state.enable( _gl.CULL_FACE );\n\t\t_gl.frontFace( _gl.CCW );\n\n\t\tif ( scope.cullFace === THREE.CullFaceFront ) {\n\n\t\t\t_gl.cullFace( _gl.FRONT );\n\n\t\t} else {\n\n\t\t\t_gl.cullFace( _gl.BACK );\n\n\t\t}\n\n\t\t_state.setDepthTest( true );\n\n\t\t// render depth map\n\n\t\tfor ( var i = 0, il = _lights.length; i < il; i ++ ) {\n\n\t\t\tvar light = _lights[ i ];\n\n\t\t\tif ( ! light.castShadow ) continue;\n\n\t\t\tif ( ! light.shadowMap ) {\n\n\t\t\t\tvar shadowFilter = THREE.LinearFilter;\n\n\t\t\t\tif ( scope.type === THREE.PCFSoftShadowMap ) {\n\n\t\t\t\t\tshadowFilter = THREE.NearestFilter;\n\n\t\t\t\t}\n\n\t\t\t\tvar pars = { minFilter: shadowFilter, magFilter: shadowFilter, format: THREE.RGBAFormat };\n\n\t\t\t\tlight.shadowMap = new THREE.WebGLRenderTarget( light.shadowMapWidth, light.shadowMapHeight, pars );\n\t\t\t\tlight.shadowMapSize = new THREE.Vector2( light.shadowMapWidth, light.shadowMapHeight );\n\n\t\t\t\tlight.shadowMatrix = new THREE.Matrix4();\n\n\t\t\t}\n\n\t\t\tif ( ! light.shadowCamera ) {\n\n\t\t\t\tif ( light instanceof THREE.SpotLight ) {\n\n\t\t\t\t\tlight.shadowCamera = new THREE.PerspectiveCamera( light.shadowCameraFov, light.shadowMapWidth / light.shadowMapHeight, light.shadowCameraNear, light.shadowCameraFar );\n\n\t\t\t\t} else if ( light instanceof THREE.DirectionalLight ) {\n\n\t\t\t\t\tlight.shadowCamera = new THREE.OrthographicCamera( light.shadowCameraLeft, light.shadowCameraRight, light.shadowCameraTop, light.shadowCameraBottom, light.shadowCameraNear, light.shadowCameraFar );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( \"THREE.ShadowMapPlugin: Unsupported light type for shadow\", light );\n\t\t\t\t\tcontinue;\n\n\t\t\t\t}\n\n\t\t\t\tscene.add( light.shadowCamera );\n\n\t\t\t\tif ( scene.autoUpdate === true ) scene.updateMatrixWorld();\n\n\t\t\t}\n\n\t\t\tif ( light.shadowCameraVisible && ! light.cameraHelper ) {\n\n\t\t\t\tlight.cameraHelper = new THREE.CameraHelper( light.shadowCamera );\n\t\t\t\tscene.add( light.cameraHelper );\n\n\t\t\t}\n\n\t\t\tvar shadowMap = light.shadowMap;\n\t\t\tvar shadowMatrix = light.shadowMatrix;\n\t\t\tvar shadowCamera = light.shadowCamera;\n\n\t\t\t//\n\n\t\t\tshadowCamera.position.setFromMatrixPosition( light.matrixWorld );\n\t\t\t_matrixPosition.setFromMatrixPosition( light.target.matrixWorld );\n\t\t\tshadowCamera.lookAt( _matrixPosition );\n\t\t\tshadowCamera.updateMatrixWorld();\n\n\t\t\tshadowCamera.matrixWorldInverse.getInverse( shadowCamera.matrixWorld );\n\n\t\t\t//\n\n\t\t\tif ( light.cameraHelper ) light.cameraHelper.visible = light.shadowCameraVisible;\n\t\t\tif ( light.shadowCameraVisible ) light.cameraHelper.update();\n\n\t\t\t// compute shadow matrix\n\n\t\t\tshadowMatrix.set(\n\t\t\t\t0.5, 0.0, 0.0, 0.5,\n\t\t\t\t0.0, 0.5, 0.0, 0.5,\n\t\t\t\t0.0, 0.0, 0.5, 0.5,\n\t\t\t\t0.0, 0.0, 0.0, 1.0\n\t\t\t);\n\n\t\t\tshadowMatrix.multiply( shadowCamera.projectionMatrix );\n\t\t\tshadowMatrix.multiply( shadowCamera.matrixWorldInverse );\n\n\t\t\t// update camera matrices and frustum\n\n\t\t\t_projScreenMatrix.multiplyMatrices( shadowCamera.projectionMatrix, shadowCamera.matrixWorldInverse );\n\t\t\t_frustum.setFromMatrix( _projScreenMatrix );\n\n\t\t\t// render shadow map\n\n\t\t\t_renderer.setRenderTarget( shadowMap );\n\t\t\t_renderer.clear();\n\n\t\t\t// set object matrices & frustum culling\n\n\t\t\t_renderList.length = 0;\n\n\t\t\tprojectObject( scene, shadowCamera );\n\n\n\t\t\t// render regular objects\n\n\t\t\tfor ( var j = 0, jl = _renderList.length; j < jl; j ++ ) {\n\n\t\t\t\tvar object = _renderList[ j ];\n\t\t\t\tvar geometry = _objects.update( object );\n\t\t\t\tvar material = object.material;\n\n\t\t\t\tif ( material instanceof THREE.MeshFaceMaterial ) {\n\n\t\t\t\t\tvar groups = geometry.groups;\n\t\t\t\t\tvar materials = material.materials;\n\n\t\t\t\t\tfor ( var k = 0, kl = groups.length; k < kl; k ++ ) {\n\n\t\t\t\t\t\tvar group = groups[ k ];\n\t\t\t\t\t\tvar groupMaterial = materials[ group.materialIndex ];\n\n\t\t\t\t\t\tif ( groupMaterial.visible === true ) {\n\n\t\t\t\t\t\t\t_renderer.renderBufferDirect( shadowCamera, _lights, null, geometry, getDepthMaterial( object, groupMaterial ), object, group );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t_renderer.renderBufferDirect( shadowCamera, _lights, null, geometry, getDepthMaterial( object, material ), object );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t// restore GL state\n\n\t\tvar clearColor = _renderer.getClearColor(),\n\t\tclearAlpha = _renderer.getClearAlpha();\n\n\t\t_renderer.setClearColor( clearColor, clearAlpha );\n\t\t_state.enable( _gl.BLEND );\n\n\t\tif ( scope.cullFace === THREE.CullFaceFront ) {\n\n\t\t\t_gl.cullFace( _gl.BACK );\n\n\t\t}\n\n\t\t_renderer.resetGLState();\n\n\t\tscope.needsUpdate = false;\n\n\t};\n\n\tfunction getDepthMaterial( object, material ) {\n\n\t\tvar geometry = object.geometry;\n\n\t\tvar useMorphing = geometry.morphTargets !== undefined && geometry.morphTargets.length > 0 && material.morphTargets;\n\t\tvar useSkinning = object instanceof THREE.SkinnedMesh && material.skinning;\n\n\t\tvar depthMaterial;\n\n\t\tif ( object.customDepthMaterial ) {\n\n\t\t\tdepthMaterial = object.customDepthMaterial;\n\n\t\t} else if ( useSkinning ) {\n\n\t\t\tdepthMaterial = useMorphing ? _depthMaterialMorphSkin : _depthMaterialSkin;\n\n\t\t} else if ( useMorphing ) {\n\n\t\t\tdepthMaterial = _depthMaterialMorph;\n\n\t\t} else {\n\n\t\t\tdepthMaterial = _depthMaterial;\n\n\t\t}\n\n\t\tdepthMaterial.visible = material.visible;\n\t\tdepthMaterial.wireframe = material.wireframe;\n\t\tdepthMaterial.wireframeLinewidth = material.wireframeLinewidth;\n\n\t\treturn depthMaterial;\n\n\t}\n\n\tfunction projectObject( object, camera ) {\n\n\t\tif ( object.visible === false ) return;\n\n\t\tif ( object instanceof THREE.Mesh || object instanceof THREE.Line || object instanceof THREE.Points ) {\n\n\t\t\tif ( object.castShadow && ( object.frustumCulled === false || _frustum.intersectsObject( object ) === true ) ) {\n\n\t\t\t\tvar material = object.material;\n\n\t\t\t\tif ( material.visible === true ) {\n\n\t\t\t\t\tobject.modelViewMatrix.multiplyMatrices( camera.matrixWorldInverse, object.matrixWorld );\n\t\t\t\t\t_renderList.push( object );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tvar children = object.children;\n\n\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\tprojectObject( children[ i ], camera );\n\n\t\t}\n\n\t}\n\n};\n\n// File:src/renderers/webgl/WebGLState.js\n\n/**\n* @author mrdoob / http://mrdoob.com/\n*/\n\nTHREE.WebGLState = function ( gl, extensions, paramThreeToGL ) {\n\n\tvar _this = this;\n\n\tvar newAttributes = new Uint8Array( 16 );\n\tvar enabledAttributes = new Uint8Array( 16 );\n\n\tvar capabilities = {};\n\n\tvar compressedTextureFormats = null;\n\n\tvar currentBlending = null;\n\tvar currentBlendEquation = null;\n\tvar currentBlendSrc = null;\n\tvar currentBlendDst = null;\n\tvar currentBlendEquationAlpha = null;\n\tvar currentBlendSrcAlpha = null;\n\tvar currentBlendDstAlpha = null;\n\n\tvar currentDepthFunc = null;\n\tvar currentDepthWrite = null;\n\n\tvar currentColorWrite = null;\n\n\tvar currentFlipSided = null;\n\n\tvar currentLineWidth = null;\n\n\tvar currentPolygonOffsetFactor = null;\n\tvar currentPolygonOffsetUnits = null;\n\n\tvar maxTextures = gl.getParameter( gl.MAX_TEXTURE_IMAGE_UNITS );\n\n\tvar currentTextureSlot = undefined;\n\tvar currentBoundTextures = {};\n\n\tthis.init = function () {\n\n\t\tgl.clearColor( 0, 0, 0, 1 );\n\t\tgl.clearDepth( 1 );\n\t\tgl.clearStencil( 0 );\n\n\t\tthis.enable( gl.DEPTH_TEST );\n\t\tgl.depthFunc( gl.LEQUAL );\n\n\t\tgl.frontFace( gl.CCW );\n\t\tgl.cullFace( gl.BACK );\n\t\tthis.enable( gl.CULL_FACE );\n\n\t\tthis.enable( gl.BLEND );\n\t\tgl.blendEquation( gl.FUNC_ADD );\n\t\tgl.blendFunc( gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA );\n\n\t};\n\n\tthis.initAttributes = function () {\n\n\t\tfor ( var i = 0, l = newAttributes.length; i < l; i ++ ) {\n\n\t\t\tnewAttributes[ i ] = 0;\n\n\t\t}\n\n\t};\n\n\tthis.enableAttribute = function ( attribute ) {\n\n\t\tnewAttributes[ attribute ] = 1;\n\n\t\tif ( enabledAttributes[ attribute ] === 0 ) {\n\n\t\t\tgl.enableVertexAttribArray( attribute );\n\t\t\tenabledAttributes[ attribute ] = 1;\n\n\t\t}\n\n\t};\n\n\tthis.disableUnusedAttributes = function () {\n\n\t\tfor ( var i = 0, l = enabledAttributes.length; i < l; i ++ ) {\n\n\t\t\tif ( enabledAttributes[ i ] !== newAttributes[ i ] ) {\n\n\t\t\t\tgl.disableVertexAttribArray( i );\n\t\t\t\tenabledAttributes[ i ] = 0;\n\n\t\t\t}\n\n\t\t}\n\n\t};\n\n\tthis.enable = function ( id ) {\n\n\t\tif ( capabilities[ id ] !== true ) {\n\n\t\t\tgl.enable( id );\n\t\t\tcapabilities[ id ] = true;\n\n\t\t}\n\n\t};\n\n\tthis.disable = function ( id ) {\n\n\t\tif ( capabilities[ id ] !== false ) {\n\n\t\t\tgl.disable( id );\n\t\t\tcapabilities[ id ] = false;\n\n\t\t}\n\n\t};\n\n\tthis.getCompressedTextureFormats = function () {\n\n\t\tif ( compressedTextureFormats === null ) {\n\n\t\t\tcompressedTextureFormats = [];\n\n\t\t\tif ( extensions.get( 'WEBGL_compressed_texture_pvrtc' ) ||\n\t\t\t     extensions.get( 'WEBGL_compressed_texture_s3tc' ) ) {\n\n\t\t\t\tvar formats = gl.getParameter( gl.COMPRESSED_TEXTURE_FORMATS );\n\n\t\t\t\tfor ( var i = 0; i < formats.length; i ++ ) {\n\n\t\t\t\t\tcompressedTextureFormats.push( formats[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn compressedTextureFormats;\n\n\t};\n\n\tthis.setBlending = function ( blending, blendEquation, blendSrc, blendDst, blendEquationAlpha, blendSrcAlpha, blendDstAlpha ) {\n\n\t\tif ( blending !== currentBlending ) {\n\n\t\t\tif ( blending === THREE.NoBlending ) {\n\n\t\t\t\tthis.disable( gl.BLEND );\n\n\t\t\t} else if ( blending === THREE.AdditiveBlending ) {\n\n\t\t\t\tthis.enable( gl.BLEND );\n\t\t\t\tgl.blendEquation( gl.FUNC_ADD );\n\t\t\t\tgl.blendFunc( gl.SRC_ALPHA, gl.ONE );\n\n\t\t\t} else if ( blending === THREE.SubtractiveBlending ) {\n\n\t\t\t\t// TODO: Find blendFuncSeparate() combination\n\n\t\t\t\tthis.enable( gl.BLEND );\n\t\t\t\tgl.blendEquation( gl.FUNC_ADD );\n\t\t\t\tgl.blendFunc( gl.ZERO, gl.ONE_MINUS_SRC_COLOR );\n\n\t\t\t} else if ( blending === THREE.MultiplyBlending ) {\n\n\t\t\t\t// TODO: Find blendFuncSeparate() combination\n\n\t\t\t\tthis.enable( gl.BLEND );\n\t\t\t\tgl.blendEquation( gl.FUNC_ADD );\n\t\t\t\tgl.blendFunc( gl.ZERO, gl.SRC_COLOR );\n\n\t\t\t} else if ( blending === THREE.CustomBlending ) {\n\n\t\t\t\tthis.enable( gl.BLEND );\n\n\t\t\t} else {\n\n\t\t\t\tthis.enable( gl.BLEND );\n\t\t\t\tgl.blendEquationSeparate( gl.FUNC_ADD, gl.FUNC_ADD );\n\t\t\t\tgl.blendFuncSeparate( gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA );\n\n\t\t\t}\n\n\t\t\tcurrentBlending = blending;\n\n\t\t}\n\n\t\tif ( blending === THREE.CustomBlending ) {\n\n\t\t\tblendEquationAlpha = blendEquationAlpha || blendEquation;\n\t\t\tblendSrcAlpha = blendSrcAlpha || blendSrc;\n\t\t\tblendDstAlpha = blendDstAlpha || blendDst;\n\n\t\t\tif ( blendEquation !== currentBlendEquation || blendEquationAlpha !== currentBlendEquationAlpha ) {\n\n\t\t\t\tgl.blendEquationSeparate( paramThreeToGL( blendEquation ), paramThreeToGL( blendEquationAlpha ) );\n\n\t\t\t\tcurrentBlendEquation = blendEquation;\n\t\t\t\tcurrentBlendEquationAlpha = blendEquationAlpha;\n\n\t\t\t}\n\n\t\t\tif ( blendSrc !== currentBlendSrc || blendDst !== currentBlendDst || blendSrcAlpha !== currentBlendSrcAlpha || blendDstAlpha !== currentBlendDstAlpha ) {\n\n\t\t\t\tgl.blendFuncSeparate( paramThreeToGL( blendSrc ), paramThreeToGL( blendDst ), paramThreeToGL( blendSrcAlpha ), paramThreeToGL( blendDstAlpha ) );\n\n\t\t\t\tcurrentBlendSrc = blendSrc;\n\t\t\t\tcurrentBlendDst = blendDst;\n\t\t\t\tcurrentBlendSrcAlpha = blendSrcAlpha;\n\t\t\t\tcurrentBlendDstAlpha = blendDstAlpha;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tcurrentBlendEquation = null;\n\t\t\tcurrentBlendSrc = null;\n\t\t\tcurrentBlendDst = null;\n\t\t\tcurrentBlendEquationAlpha = null;\n\t\t\tcurrentBlendSrcAlpha = null;\n\t\t\tcurrentBlendDstAlpha = null;\n\n\t\t}\n\n\t};\n\n\tthis.setDepthFunc = function ( depthFunc ) {\n\n\t\tif ( currentDepthFunc !== depthFunc ) {\n\n\t\t\tif ( depthFunc ) {\n\n\t\t\t\tswitch ( depthFunc ) {\n\n\t\t\t\t\tcase THREE.NeverDepth:\n\n\t\t\t\t\t\tgl.depthFunc( gl.NEVER );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase THREE.AlwaysDepth:\n\n\t\t\t\t\t\tgl.depthFunc( gl.ALWAYS );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase THREE.LessDepth:\n\n\t\t\t\t\t\tgl.depthFunc( gl.LESS );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase THREE.LessEqualDepth:\n\n\t\t\t\t\t\tgl.depthFunc( gl.LEQUAL );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase THREE.EqualDepth:\n\n\t\t\t\t\t\tgl.depthFunc( gl.EQUAL );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase THREE.GreaterEqualDepth:\n\n\t\t\t\t\t\tgl.depthFunc( gl.GEQUAL );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase THREE.GreaterDepth:\n\n\t\t\t\t\t\tgl.depthFunc( gl.GREATER );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase THREE.NotEqualDepth:\n\n\t\t\t\t\t\tgl.depthFunc( gl.NOTEQUAL );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tgl.depthFunc( gl.LEQUAL );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tgl.depthFunc( gl.LEQUAL );\n\n\t\t\t}\n\n\t\t\tcurrentDepthFunc = depthFunc;\n\n\t\t}\n\n\t};\n\n\tthis.setDepthTest = function ( depthTest ) {\n\n\t\tif ( depthTest ) {\n\n\t\t\tthis.enable( gl.DEPTH_TEST );\n\n\t\t} else {\n\n\t\t\tthis.disable( gl.DEPTH_TEST );\n\n\t\t}\n\n\t};\n\n\tthis.setDepthWrite = function ( depthWrite ) {\n\n\t\tif ( currentDepthWrite !== depthWrite ) {\n\n\t\t\tgl.depthMask( depthWrite );\n\t\t\tcurrentDepthWrite = depthWrite;\n\n\t\t}\n\n\t};\n\n\tthis.setColorWrite = function ( colorWrite ) {\n\n\t\tif ( currentColorWrite !== colorWrite ) {\n\n\t\t\tgl.colorMask( colorWrite, colorWrite, colorWrite, colorWrite );\n\t\t\tcurrentColorWrite = colorWrite;\n\n\t\t}\n\n\t};\n\n\tthis.setFlipSided = function ( flipSided ) {\n\n\t\tif ( currentFlipSided !== flipSided ) {\n\n\t\t\tif ( flipSided ) {\n\n\t\t\t\tgl.frontFace( gl.CW );\n\n\t\t\t} else {\n\n\t\t\t\tgl.frontFace( gl.CCW );\n\n\t\t\t}\n\n\t\t\tcurrentFlipSided = flipSided;\n\n\t\t}\n\n\t};\n\n\tthis.setLineWidth = function ( width ) {\n\n\t\tif ( width !== currentLineWidth ) {\n\n\t\t\tgl.lineWidth( width );\n\n\t\t\tcurrentLineWidth = width;\n\n\t\t}\n\n\t};\n\n\tthis.setPolygonOffset = function ( polygonOffset, factor, units ) {\n\n\t\tif ( polygonOffset ) {\n\n\t\t\tthis.enable( gl.POLYGON_OFFSET_FILL );\n\n\t\t} else {\n\n\t\t\tthis.disable( gl.POLYGON_OFFSET_FILL );\n\n\t\t}\n\n\t\tif ( polygonOffset && ( currentPolygonOffsetFactor !== factor || currentPolygonOffsetUnits !== units ) ) {\n\n\t\t\tgl.polygonOffset( factor, units );\n\n\t\t\tcurrentPolygonOffsetFactor = factor;\n\t\t\tcurrentPolygonOffsetUnits = units;\n\n\t\t}\n\n\t};\n\n\tthis.setScissorTest = function ( scissorTest ) {\n\n\t\tif ( scissorTest ) {\n\n\t\t\tthis.enable( gl.SCISSOR_TEST );\n\n\t\t} else {\n\n\t\t\tthis.disable( gl.SCISSOR_TEST );\n\n\t\t}\n\n\t};\n\n\t// texture\n\n\tthis.activeTexture = function ( webglSlot ) {\n\n\t\tif ( webglSlot === undefined ) webglSlot = gl.TEXTURE0 + maxTextures - 1;\n\n\t\tif ( currentTextureSlot !== webglSlot ) {\n\n\t\t\tgl.activeTexture( webglSlot );\n\t\t\tcurrentTextureSlot = webglSlot;\n\n\t\t}\n\n\t}\n\n\tthis.bindTexture = function ( webglType, webglTexture ) {\n\n\t\tif ( currentTextureSlot === undefined ) {\n\n\t\t\t_this.activeTexture();\n\n\t\t}\n\n\t\tvar boundTexture = currentBoundTextures[ currentTextureSlot ];\n\n\t\tif ( boundTexture === undefined ) {\n\n\t\t\tboundTexture = { type: undefined, texture: undefined };\n\t\t\tcurrentBoundTextures[ currentTextureSlot ] = boundTexture;\n\n\t\t}\n\n\t\tif ( boundTexture.type !== webglType || boundTexture.texture !== webglTexture ) {\n\n\t\t\tgl.bindTexture( webglType, webglTexture );\n\n\t\t\tboundTexture.type = webglType;\n\t\t\tboundTexture.texture = webglTexture;\n\n\t\t}\n\n\t};\n\n\tthis.compressedTexImage2D = function () {\n\n\t\ttry {\n\n\t\t\tgl.compressedTexImage2D.apply( gl, arguments );\n\n\t\t} catch ( error ) {\n\n\t\t\tconsole.error( error );\n\n\t\t}\n\n\t};\n\n\tthis.texImage2D = function () {\n\n\t\ttry {\n\n\t\t\tgl.texImage2D.apply( gl, arguments );\n\n\t\t} catch ( error ) {\n\n\t\t\tconsole.error( error );\n\n\t\t}\n\n\t};\n\n\t//\n\n\tthis.reset = function () {\n\n\t\tfor ( var i = 0; i < enabledAttributes.length; i ++ ) {\n\n\t\t\tif ( enabledAttributes[ i ] === 1 ) {\n\n\t\t\t\tgl.disableVertexAttribArray( i );\n\t\t\t\tenabledAttributes[ i ] = 0;\n\n\t\t\t}\n\n\t\t}\n\n\t\tcapabilities = {};\n\n\t\tcompressedTextureFormats = null;\n\n\t\tcurrentBlending = null;\n\n\t\tcurrentDepthWrite = null;\n\t\tcurrentColorWrite = null;\n\n\t\tcurrentFlipSided = null;\n\n\t};\n\n};\n\n// File:src/renderers/webgl/plugins/LensFlarePlugin.js\n\n/**\n * @author mikael emtinger / http://gomo.se/\n * @author alteredq / http://alteredqualia.com/\n */\n\nTHREE.LensFlarePlugin = function ( renderer, flares ) {\n\n\tvar gl = renderer.context;\n\tvar state = renderer.state;\n\n\tvar vertexBuffer, elementBuffer;\n\tvar program, attributes, uniforms;\n\tvar hasVertexTexture;\n\n\tvar tempTexture, occlusionTexture;\n\n\tvar init = function () {\n\n\t\tvar vertices = new Float32Array( [\n\t\t\t- 1, - 1,  0, 0,\n\t\t\t 1, - 1,  1, 0,\n\t\t\t 1,  1,  1, 1,\n\t\t\t- 1,  1,  0, 1\n\t\t] );\n\n\t\tvar faces = new Uint16Array( [\n\t\t\t0, 1, 2,\n\t\t\t0, 2, 3\n\t\t] );\n\n\t\t// buffers\n\n\t\tvertexBuffer     = gl.createBuffer();\n\t\telementBuffer    = gl.createBuffer();\n\n\t\tgl.bindBuffer( gl.ARRAY_BUFFER, vertexBuffer );\n\t\tgl.bufferData( gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW );\n\n\t\tgl.bindBuffer( gl.ELEMENT_ARRAY_BUFFER, elementBuffer );\n\t\tgl.bufferData( gl.ELEMENT_ARRAY_BUFFER, faces, gl.STATIC_DRAW );\n\n\t\t// textures\n\n\t\ttempTexture      = gl.createTexture();\n\t\tocclusionTexture = gl.createTexture();\n\n\t\tstate.bindTexture( gl.TEXTURE_2D, tempTexture );\n\t\tgl.texImage2D( gl.TEXTURE_2D, 0, gl.RGB, 16, 16, 0, gl.RGB, gl.UNSIGNED_BYTE, null );\n\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE );\n\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE );\n\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST );\n\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST );\n\n\t\tstate.bindTexture( gl.TEXTURE_2D, occlusionTexture );\n\t\tgl.texImage2D( gl.TEXTURE_2D, 0, gl.RGBA, 16, 16, 0, gl.RGBA, gl.UNSIGNED_BYTE, null );\n\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE );\n\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE );\n\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST );\n\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST );\n\n\t\thasVertexTexture = gl.getParameter( gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS ) > 0;\n\n\t\tvar shader;\n\n\t\tif ( hasVertexTexture ) {\n\n\t\t\tshader = {\n\n\t\t\t\tvertexShader: [\n\n\t\t\t\t\t\"uniform lowp int renderType;\",\n\n\t\t\t\t\t\"uniform vec3 screenPosition;\",\n\t\t\t\t\t\"uniform vec2 scale;\",\n\t\t\t\t\t\"uniform float rotation;\",\n\n\t\t\t\t\t\"uniform sampler2D occlusionMap;\",\n\n\t\t\t\t\t\"attribute vec2 position;\",\n\t\t\t\t\t\"attribute vec2 uv;\",\n\n\t\t\t\t\t\"varying vec2 vUV;\",\n\t\t\t\t\t\"varying float vVisibility;\",\n\n\t\t\t\t\t\"void main() {\",\n\n\t\t\t\t\t\t\"vUV = uv;\",\n\n\t\t\t\t\t\t\"vec2 pos = position;\",\n\n\t\t\t\t\t\t\"if( renderType == 2 ) {\",\n\n\t\t\t\t\t\t\t\"vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );\",\n\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );\",\n\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );\",\n\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );\",\n\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );\",\n\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );\",\n\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );\",\n\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );\",\n\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );\",\n\n\t\t\t\t\t\t\t\"vVisibility =        visibility.r / 9.0;\",\n\t\t\t\t\t\t\t\"vVisibility *= 1.0 - visibility.g / 9.0;\",\n\t\t\t\t\t\t\t\"vVisibility *=       visibility.b / 9.0;\",\n\t\t\t\t\t\t\t\"vVisibility *= 1.0 - visibility.a / 9.0;\",\n\n\t\t\t\t\t\t\t\"pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\",\n\t\t\t\t\t\t\t\"pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\",\n\n\t\t\t\t\t\t\"}\",\n\n\t\t\t\t\t\t\"gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\",\n\n\t\t\t\t\t\"}\"\n\n\t\t\t\t].join( \"\\n\" ),\n\n\t\t\t\tfragmentShader: [\n\n\t\t\t\t\t\"uniform lowp int renderType;\",\n\n\t\t\t\t\t\"uniform sampler2D map;\",\n\t\t\t\t\t\"uniform float opacity;\",\n\t\t\t\t\t\"uniform vec3 color;\",\n\n\t\t\t\t\t\"varying vec2 vUV;\",\n\t\t\t\t\t\"varying float vVisibility;\",\n\n\t\t\t\t\t\"void main() {\",\n\n\t\t\t\t\t\t// pink square\n\n\t\t\t\t\t\t\"if( renderType == 0 ) {\",\n\n\t\t\t\t\t\t\t\"gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\",\n\n\t\t\t\t\t\t// restore\n\n\t\t\t\t\t\t\"} else if( renderType == 1 ) {\",\n\n\t\t\t\t\t\t\t\"gl_FragColor = texture2D( map, vUV );\",\n\n\t\t\t\t\t\t// flare\n\n\t\t\t\t\t\t\"} else {\",\n\n\t\t\t\t\t\t\t\"vec4 texture = texture2D( map, vUV );\",\n\t\t\t\t\t\t\t\"texture.a *= opacity * vVisibility;\",\n\t\t\t\t\t\t\t\"gl_FragColor = texture;\",\n\t\t\t\t\t\t\t\"gl_FragColor.rgb *= color;\",\n\n\t\t\t\t\t\t\"}\",\n\n\t\t\t\t\t\"}\"\n\n\t\t\t\t].join( \"\\n\" )\n\n\t\t\t};\n\n\t\t} else {\n\n\t\t\tshader = {\n\n\t\t\t\tvertexShader: [\n\n\t\t\t\t\t\"uniform lowp int renderType;\",\n\n\t\t\t\t\t\"uniform vec3 screenPosition;\",\n\t\t\t\t\t\"uniform vec2 scale;\",\n\t\t\t\t\t\"uniform float rotation;\",\n\n\t\t\t\t\t\"attribute vec2 position;\",\n\t\t\t\t\t\"attribute vec2 uv;\",\n\n\t\t\t\t\t\"varying vec2 vUV;\",\n\n\t\t\t\t\t\"void main() {\",\n\n\t\t\t\t\t\t\"vUV = uv;\",\n\n\t\t\t\t\t\t\"vec2 pos = position;\",\n\n\t\t\t\t\t\t\"if( renderType == 2 ) {\",\n\n\t\t\t\t\t\t\t\"pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\",\n\t\t\t\t\t\t\t\"pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\",\n\n\t\t\t\t\t\t\"}\",\n\n\t\t\t\t\t\t\"gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\",\n\n\t\t\t\t\t\"}\"\n\n\t\t\t\t].join( \"\\n\" ),\n\n\t\t\t\tfragmentShader: [\n\n\t\t\t\t\t\"precision mediump float;\",\n\n\t\t\t\t\t\"uniform lowp int renderType;\",\n\n\t\t\t\t\t\"uniform sampler2D map;\",\n\t\t\t\t\t\"uniform sampler2D occlusionMap;\",\n\t\t\t\t\t\"uniform float opacity;\",\n\t\t\t\t\t\"uniform vec3 color;\",\n\n\t\t\t\t\t\"varying vec2 vUV;\",\n\n\t\t\t\t\t\"void main() {\",\n\n\t\t\t\t\t\t// pink square\n\n\t\t\t\t\t\t\"if( renderType == 0 ) {\",\n\n\t\t\t\t\t\t\t\"gl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );\",\n\n\t\t\t\t\t\t// restore\n\n\t\t\t\t\t\t\"} else if( renderType == 1 ) {\",\n\n\t\t\t\t\t\t\t\"gl_FragColor = texture2D( map, vUV );\",\n\n\t\t\t\t\t\t// flare\n\n\t\t\t\t\t\t\"} else {\",\n\n\t\t\t\t\t\t\t\"float visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a;\",\n\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a;\",\n\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a;\",\n\t\t\t\t\t\t\t\"visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;\",\n\t\t\t\t\t\t\t\"visibility = ( 1.0 - visibility / 4.0 );\",\n\n\t\t\t\t\t\t\t\"vec4 texture = texture2D( map, vUV );\",\n\t\t\t\t\t\t\t\"texture.a *= opacity * visibility;\",\n\t\t\t\t\t\t\t\"gl_FragColor = texture;\",\n\t\t\t\t\t\t\t\"gl_FragColor.rgb *= color;\",\n\n\t\t\t\t\t\t\"}\",\n\n\t\t\t\t\t\"}\"\n\n\t\t\t\t].join( \"\\n\" )\n\n\t\t\t};\n\n\t\t}\n\n\t\tprogram = createProgram( shader );\n\n\t\tattributes = {\n\t\t\tvertex: gl.getAttribLocation ( program, \"position\" ),\n\t\t\tuv:     gl.getAttribLocation ( program, \"uv\" )\n\t\t};\n\n\t\tuniforms = {\n\t\t\trenderType:     gl.getUniformLocation( program, \"renderType\" ),\n\t\t\tmap:            gl.getUniformLocation( program, \"map\" ),\n\t\t\tocclusionMap:   gl.getUniformLocation( program, \"occlusionMap\" ),\n\t\t\topacity:        gl.getUniformLocation( program, \"opacity\" ),\n\t\t\tcolor:          gl.getUniformLocation( program, \"color\" ),\n\t\t\tscale:          gl.getUniformLocation( program, \"scale\" ),\n\t\t\trotation:       gl.getUniformLocation( program, \"rotation\" ),\n\t\t\tscreenPosition: gl.getUniformLocation( program, \"screenPosition\" )\n\t\t};\n\n\t};\n\n\t/*\n\t * Render lens flares\n\t * Method: renders 16x16 0xff00ff-colored points scattered over the light source area,\n\t *         reads these back and calculates occlusion.\n\t */\n\n\tthis.render = function ( scene, camera, viewportWidth, viewportHeight ) {\n\n\t\tif ( flares.length === 0 ) return;\n\n\t\tvar tempPosition = new THREE.Vector3();\n\n\t\tvar invAspect = viewportHeight / viewportWidth,\n\t\t\thalfViewportWidth = viewportWidth * 0.5,\n\t\t\thalfViewportHeight = viewportHeight * 0.5;\n\n\t\tvar size = 16 / viewportHeight,\n\t\t\tscale = new THREE.Vector2( size * invAspect, size );\n\n\t\tvar screenPosition = new THREE.Vector3( 1, 1, 0 ),\n\t\t\tscreenPositionPixels = new THREE.Vector2( 1, 1 );\n\n\t\tif ( program === undefined ) {\n\n\t\t\tinit();\n\n\t\t}\n\n\t\tgl.useProgram( program );\n\n\t\tstate.initAttributes();\n\t\tstate.enableAttribute( attributes.vertex );\n\t\tstate.enableAttribute( attributes.uv );\n\t\tstate.disableUnusedAttributes();\n\n\t\t// loop through all lens flares to update their occlusion and positions\n\t\t// setup gl and common used attribs/uniforms\n\n\t\tgl.uniform1i( uniforms.occlusionMap, 0 );\n\t\tgl.uniform1i( uniforms.map, 1 );\n\n\t\tgl.bindBuffer( gl.ARRAY_BUFFER, vertexBuffer );\n\t\tgl.vertexAttribPointer( attributes.vertex, 2, gl.FLOAT, false, 2 * 8, 0 );\n\t\tgl.vertexAttribPointer( attributes.uv, 2, gl.FLOAT, false, 2 * 8, 8 );\n\n\t\tgl.bindBuffer( gl.ELEMENT_ARRAY_BUFFER, elementBuffer );\n\n\t\tstate.disable( gl.CULL_FACE );\n\t\tgl.depthMask( false );\n\n\t\tfor ( var i = 0, l = flares.length; i < l; i ++ ) {\n\n\t\t\tsize = 16 / viewportHeight;\n\t\t\tscale.set( size * invAspect, size );\n\n\t\t\t// calc object screen position\n\n\t\t\tvar flare = flares[ i ];\n\n\t\t\ttempPosition.set( flare.matrixWorld.elements[ 12 ], flare.matrixWorld.elements[ 13 ], flare.matrixWorld.elements[ 14 ] );\n\n\t\t\ttempPosition.applyMatrix4( camera.matrixWorldInverse );\n\t\t\ttempPosition.applyProjection( camera.projectionMatrix );\n\n\t\t\t// setup arrays for gl programs\n\n\t\t\tscreenPosition.copy( tempPosition );\n\n\t\t\tscreenPositionPixels.x = screenPosition.x * halfViewportWidth + halfViewportWidth;\n\t\t\tscreenPositionPixels.y = screenPosition.y * halfViewportHeight + halfViewportHeight;\n\n\t\t\t// screen cull\n\n\t\t\tif ( hasVertexTexture || (\n\t\t\t\tscreenPositionPixels.x > 0 &&\n\t\t\t\tscreenPositionPixels.x < viewportWidth &&\n\t\t\t\tscreenPositionPixels.y > 0 &&\n\t\t\t\tscreenPositionPixels.y < viewportHeight ) ) {\n\n\t\t\t\t// save current RGB to temp texture\n\n\t\t\t\tstate.activeTexture( gl.TEXTURE0 );\n\t\t\t\tstate.bindTexture( gl.TEXTURE_2D, null );\n\t\t\t\tstate.activeTexture( gl.TEXTURE1 );\n\t\t\t\tstate.bindTexture( gl.TEXTURE_2D, tempTexture );\n\t\t\t\tgl.copyTexImage2D( gl.TEXTURE_2D, 0, gl.RGB, screenPositionPixels.x - 8, screenPositionPixels.y - 8, 16, 16, 0 );\n\n\n\t\t\t\t// render pink quad\n\n\t\t\t\tgl.uniform1i( uniforms.renderType, 0 );\n\t\t\t\tgl.uniform2f( uniforms.scale, scale.x, scale.y );\n\t\t\t\tgl.uniform3f( uniforms.screenPosition, screenPosition.x, screenPosition.y, screenPosition.z );\n\n\t\t\t\tstate.disable( gl.BLEND );\n\t\t\t\tstate.enable( gl.DEPTH_TEST );\n\n\t\t\t\tgl.drawElements( gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0 );\n\n\n\t\t\t\t// copy result to occlusionMap\n\n\t\t\t\tstate.activeTexture( gl.TEXTURE0 );\n\t\t\t\tstate.bindTexture( gl.TEXTURE_2D, occlusionTexture );\n\t\t\t\tgl.copyTexImage2D( gl.TEXTURE_2D, 0, gl.RGBA, screenPositionPixels.x - 8, screenPositionPixels.y - 8, 16, 16, 0 );\n\n\n\t\t\t\t// restore graphics\n\n\t\t\t\tgl.uniform1i( uniforms.renderType, 1 );\n\t\t\t\tstate.disable( gl.DEPTH_TEST );\n\n\t\t\t\tstate.activeTexture( gl.TEXTURE1 );\n\t\t\t\tstate.bindTexture( gl.TEXTURE_2D, tempTexture );\n\t\t\t\tgl.drawElements( gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0 );\n\n\n\t\t\t\t// update object positions\n\n\t\t\t\tflare.positionScreen.copy( screenPosition );\n\n\t\t\t\tif ( flare.customUpdateCallback ) {\n\n\t\t\t\t\tflare.customUpdateCallback( flare );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tflare.updateLensFlares();\n\n\t\t\t\t}\n\n\t\t\t\t// render flares\n\n\t\t\t\tgl.uniform1i( uniforms.renderType, 2 );\n\t\t\t\tstate.enable( gl.BLEND );\n\n\t\t\t\tfor ( var j = 0, jl = flare.lensFlares.length; j < jl; j ++ ) {\n\n\t\t\t\t\tvar sprite = flare.lensFlares[ j ];\n\n\t\t\t\t\tif ( sprite.opacity > 0.001 && sprite.scale > 0.001 ) {\n\n\t\t\t\t\t\tscreenPosition.x = sprite.x;\n\t\t\t\t\t\tscreenPosition.y = sprite.y;\n\t\t\t\t\t\tscreenPosition.z = sprite.z;\n\n\t\t\t\t\t\tsize = sprite.size * sprite.scale / viewportHeight;\n\n\t\t\t\t\t\tscale.x = size * invAspect;\n\t\t\t\t\t\tscale.y = size;\n\n\t\t\t\t\t\tgl.uniform3f( uniforms.screenPosition, screenPosition.x, screenPosition.y, screenPosition.z );\n\t\t\t\t\t\tgl.uniform2f( uniforms.scale, scale.x, scale.y );\n\t\t\t\t\t\tgl.uniform1f( uniforms.rotation, sprite.rotation );\n\n\t\t\t\t\t\tgl.uniform1f( uniforms.opacity, sprite.opacity );\n\t\t\t\t\t\tgl.uniform3f( uniforms.color, sprite.color.r, sprite.color.g, sprite.color.b );\n\n\t\t\t\t\t\tstate.setBlending( sprite.blending, sprite.blendEquation, sprite.blendSrc, sprite.blendDst );\n\t\t\t\t\t\trenderer.setTexture( sprite.texture, 1 );\n\n\t\t\t\t\t\tgl.drawElements( gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0 );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t// restore gl\n\n\t\tstate.enable( gl.CULL_FACE );\n\t\tstate.enable( gl.DEPTH_TEST );\n\t\tgl.depthMask( true );\n\n\t\trenderer.resetGLState();\n\n\t};\n\n\tfunction createProgram ( shader ) {\n\n\t\tvar program = gl.createProgram();\n\n\t\tvar fragmentShader = gl.createShader( gl.FRAGMENT_SHADER );\n\t\tvar vertexShader = gl.createShader( gl.VERTEX_SHADER );\n\n\t\tvar prefix = \"precision \" + renderer.getPrecision() + \" float;\\n\";\n\n\t\tgl.shaderSource( fragmentShader, prefix + shader.fragmentShader );\n\t\tgl.shaderSource( vertexShader, prefix + shader.vertexShader );\n\n\t\tgl.compileShader( fragmentShader );\n\t\tgl.compileShader( vertexShader );\n\n\t\tgl.attachShader( program, fragmentShader );\n\t\tgl.attachShader( program, vertexShader );\n\n\t\tgl.linkProgram( program );\n\n\t\treturn program;\n\n\t}\n\n};\n\n// File:src/renderers/webgl/plugins/SpritePlugin.js\n\n/**\n * @author mikael emtinger / http://gomo.se/\n * @author alteredq / http://alteredqualia.com/\n */\n\nTHREE.SpritePlugin = function ( renderer, sprites ) {\n\n\tvar gl = renderer.context;\n\tvar state = renderer.state;\n\n\tvar vertexBuffer, elementBuffer;\n\tvar program, attributes, uniforms;\n\n\tvar texture;\n\n\t// decompose matrixWorld\n\n\tvar spritePosition = new THREE.Vector3();\n\tvar spriteRotation = new THREE.Quaternion();\n\tvar spriteScale = new THREE.Vector3();\n\n\tvar init = function () {\n\n\t\tvar vertices = new Float32Array( [\n\t\t\t- 0.5, - 0.5,  0, 0,\n\t\t\t  0.5, - 0.5,  1, 0,\n\t\t\t  0.5,   0.5,  1, 1,\n\t\t\t- 0.5,   0.5,  0, 1\n\t\t] );\n\n\t\tvar faces = new Uint16Array( [\n\t\t\t0, 1, 2,\n\t\t\t0, 2, 3\n\t\t] );\n\n\t\tvertexBuffer  = gl.createBuffer();\n\t\telementBuffer = gl.createBuffer();\n\n\t\tgl.bindBuffer( gl.ARRAY_BUFFER, vertexBuffer );\n\t\tgl.bufferData( gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW );\n\n\t\tgl.bindBuffer( gl.ELEMENT_ARRAY_BUFFER, elementBuffer );\n\t\tgl.bufferData( gl.ELEMENT_ARRAY_BUFFER, faces, gl.STATIC_DRAW );\n\n\t\tprogram = createProgram();\n\n\t\tattributes = {\n\t\t\tposition:\t\t\tgl.getAttribLocation ( program, 'position' ),\n\t\t\tuv:\t\t\t\t\tgl.getAttribLocation ( program, 'uv' )\n\t\t};\n\n\t\tuniforms = {\n\t\t\tuvOffset:\t\t\tgl.getUniformLocation( program, 'uvOffset' ),\n\t\t\tuvScale:\t\t\tgl.getUniformLocation( program, 'uvScale' ),\n\n\t\t\trotation:\t\t\tgl.getUniformLocation( program, 'rotation' ),\n\t\t\tscale:\t\t\t\tgl.getUniformLocation( program, 'scale' ),\n\n\t\t\tcolor:\t\t\t\tgl.getUniformLocation( program, 'color' ),\n\t\t\tmap:\t\t\t\tgl.getUniformLocation( program, 'map' ),\n\t\t\topacity:\t\t\tgl.getUniformLocation( program, 'opacity' ),\n\n\t\t\tmodelViewMatrix: \tgl.getUniformLocation( program, 'modelViewMatrix' ),\n\t\t\tprojectionMatrix:\tgl.getUniformLocation( program, 'projectionMatrix' ),\n\n\t\t\tfogType:\t\t\tgl.getUniformLocation( program, 'fogType' ),\n\t\t\tfogDensity:\t\t\tgl.getUniformLocation( program, 'fogDensity' ),\n\t\t\tfogNear:\t\t\tgl.getUniformLocation( program, 'fogNear' ),\n\t\t\tfogFar:\t\t\t\tgl.getUniformLocation( program, 'fogFar' ),\n\t\t\tfogColor:\t\t\tgl.getUniformLocation( program, 'fogColor' ),\n\n\t\t\talphaTest:\t\t\tgl.getUniformLocation( program, 'alphaTest' )\n\t\t};\n\n\t\tvar canvas = document.createElement( 'canvas' );\n\t\tcanvas.width = 8;\n\t\tcanvas.height = 8;\n\n\t\tvar context = canvas.getContext( '2d' );\n\t\tcontext.fillStyle = 'white';\n\t\tcontext.fillRect( 0, 0, 8, 8 );\n\n\t\ttexture = new THREE.Texture( canvas );\n\t\ttexture.needsUpdate = true;\n\n\t};\n\n\tthis.render = function ( scene, camera ) {\n\n\t\tif ( sprites.length === 0 ) return;\n\n\t\t// setup gl\n\n\t\tif ( program === undefined ) {\n\n\t\t\tinit();\n\n\t\t}\n\n\t\tgl.useProgram( program );\n\n\t\tstate.initAttributes();\n\t\tstate.enableAttribute( attributes.position );\n\t\tstate.enableAttribute( attributes.uv );\n\t\tstate.disableUnusedAttributes();\n\n\t\tstate.disable( gl.CULL_FACE );\n\t\tstate.enable( gl.BLEND );\n\n\t\tgl.bindBuffer( gl.ARRAY_BUFFER, vertexBuffer );\n\t\tgl.vertexAttribPointer( attributes.position, 2, gl.FLOAT, false, 2 * 8, 0 );\n\t\tgl.vertexAttribPointer( attributes.uv, 2, gl.FLOAT, false, 2 * 8, 8 );\n\n\t\tgl.bindBuffer( gl.ELEMENT_ARRAY_BUFFER, elementBuffer );\n\n\t\tgl.uniformMatrix4fv( uniforms.projectionMatrix, false, camera.projectionMatrix.elements );\n\n\t\tstate.activeTexture( gl.TEXTURE0 );\n\t\tgl.uniform1i( uniforms.map, 0 );\n\n\t\tvar oldFogType = 0;\n\t\tvar sceneFogType = 0;\n\t\tvar fog = scene.fog;\n\n\t\tif ( fog ) {\n\n\t\t\tgl.uniform3f( uniforms.fogColor, fog.color.r, fog.color.g, fog.color.b );\n\n\t\t\tif ( fog instanceof THREE.Fog ) {\n\n\t\t\t\tgl.uniform1f( uniforms.fogNear, fog.near );\n\t\t\t\tgl.uniform1f( uniforms.fogFar, fog.far );\n\n\t\t\t\tgl.uniform1i( uniforms.fogType, 1 );\n\t\t\t\toldFogType = 1;\n\t\t\t\tsceneFogType = 1;\n\n\t\t\t} else if ( fog instanceof THREE.FogExp2 ) {\n\n\t\t\t\tgl.uniform1f( uniforms.fogDensity, fog.density );\n\n\t\t\t\tgl.uniform1i( uniforms.fogType, 2 );\n\t\t\t\toldFogType = 2;\n\t\t\t\tsceneFogType = 2;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tgl.uniform1i( uniforms.fogType, 0 );\n\t\t\toldFogType = 0;\n\t\t\tsceneFogType = 0;\n\n\t\t}\n\n\n\t\t// update positions and sort\n\n\t\tfor ( var i = 0, l = sprites.length; i < l; i ++ ) {\n\n\t\t\tvar sprite = sprites[ i ];\n\n\t\t\tsprite.modelViewMatrix.multiplyMatrices( camera.matrixWorldInverse, sprite.matrixWorld );\n\t\t\tsprite.z = - sprite.modelViewMatrix.elements[ 14 ];\n\n\t\t}\n\n\t\tsprites.sort( painterSortStable );\n\n\t\t// render all sprites\n\n\t\tvar scale = [];\n\n\t\tfor ( var i = 0, l = sprites.length; i < l; i ++ ) {\n\n\t\t\tvar sprite = sprites[ i ];\n\t\t\tvar material = sprite.material;\n\n\t\t\tgl.uniform1f( uniforms.alphaTest, material.alphaTest );\n\t\t\tgl.uniformMatrix4fv( uniforms.modelViewMatrix, false, sprite.modelViewMatrix.elements );\n\n\t\t\tsprite.matrixWorld.decompose( spritePosition, spriteRotation, spriteScale );\n\n\t\t\tscale[ 0 ] = spriteScale.x;\n\t\t\tscale[ 1 ] = spriteScale.y;\n\n\t\t\tvar fogType = 0;\n\n\t\t\tif ( scene.fog && material.fog ) {\n\n\t\t\t\tfogType = sceneFogType;\n\n\t\t\t}\n\n\t\t\tif ( oldFogType !== fogType ) {\n\n\t\t\t\tgl.uniform1i( uniforms.fogType, fogType );\n\t\t\t\toldFogType = fogType;\n\n\t\t\t}\n\n\t\t\tif ( material.map !== null ) {\n\n\t\t\t\tgl.uniform2f( uniforms.uvOffset, material.map.offset.x, material.map.offset.y );\n\t\t\t\tgl.uniform2f( uniforms.uvScale, material.map.repeat.x, material.map.repeat.y );\n\n\t\t\t} else {\n\n\t\t\t\tgl.uniform2f( uniforms.uvOffset, 0, 0 );\n\t\t\t\tgl.uniform2f( uniforms.uvScale, 1, 1 );\n\n\t\t\t}\n\n\t\t\tgl.uniform1f( uniforms.opacity, material.opacity );\n\t\t\tgl.uniform3f( uniforms.color, material.color.r, material.color.g, material.color.b );\n\n\t\t\tgl.uniform1f( uniforms.rotation, material.rotation );\n\t\t\tgl.uniform2fv( uniforms.scale, scale );\n\n\t\t\tstate.setBlending( material.blending, material.blendEquation, material.blendSrc, material.blendDst );\n\t\t\tstate.setDepthTest( material.depthTest );\n\t\t\tstate.setDepthWrite( material.depthWrite );\n\n\t\t\tif ( material.map && material.map.image && material.map.image.width ) {\n\n\t\t\t\trenderer.setTexture( material.map, 0 );\n\n\t\t\t} else {\n\n\t\t\t\trenderer.setTexture( texture, 0 );\n\n\t\t\t}\n\n\t\t\tgl.drawElements( gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0 );\n\n\t\t}\n\n\t\t// restore gl\n\n\t\tstate.enable( gl.CULL_FACE );\n\n\t\trenderer.resetGLState();\n\n\t};\n\n\tfunction createProgram () {\n\n\t\tvar program = gl.createProgram();\n\n\t\tvar vertexShader = gl.createShader( gl.VERTEX_SHADER );\n\t\tvar fragmentShader = gl.createShader( gl.FRAGMENT_SHADER );\n\n\t\tgl.shaderSource( vertexShader, [\n\n\t\t\t'precision ' + renderer.getPrecision() + ' float;',\n\n\t\t\t'uniform mat4 modelViewMatrix;',\n\t\t\t'uniform mat4 projectionMatrix;',\n\t\t\t'uniform float rotation;',\n\t\t\t'uniform vec2 scale;',\n\t\t\t'uniform vec2 uvOffset;',\n\t\t\t'uniform vec2 uvScale;',\n\n\t\t\t'attribute vec2 position;',\n\t\t\t'attribute vec2 uv;',\n\n\t\t\t'varying vec2 vUV;',\n\n\t\t\t'void main() {',\n\n\t\t\t\t'vUV = uvOffset + uv * uvScale;',\n\n\t\t\t\t'vec2 alignedPosition = position * scale;',\n\n\t\t\t\t'vec2 rotatedPosition;',\n\t\t\t\t'rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;',\n\t\t\t\t'rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;',\n\n\t\t\t\t'vec4 finalPosition;',\n\n\t\t\t\t'finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );',\n\t\t\t\t'finalPosition.xy += rotatedPosition;',\n\t\t\t\t'finalPosition = projectionMatrix * finalPosition;',\n\n\t\t\t\t'gl_Position = finalPosition;',\n\n\t\t\t'}'\n\n\t\t].join( '\\n' ) );\n\n\t\tgl.shaderSource( fragmentShader, [\n\n\t\t\t'precision ' + renderer.getPrecision() + ' float;',\n\n\t\t\t'uniform vec3 color;',\n\t\t\t'uniform sampler2D map;',\n\t\t\t'uniform float opacity;',\n\n\t\t\t'uniform int fogType;',\n\t\t\t'uniform vec3 fogColor;',\n\t\t\t'uniform float fogDensity;',\n\t\t\t'uniform float fogNear;',\n\t\t\t'uniform float fogFar;',\n\t\t\t'uniform float alphaTest;',\n\n\t\t\t'varying vec2 vUV;',\n\n\t\t\t'void main() {',\n\n\t\t\t\t'vec4 texture = texture2D( map, vUV );',\n\n\t\t\t\t'if ( texture.a < alphaTest ) discard;',\n\n\t\t\t\t'gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );',\n\n\t\t\t\t'if ( fogType > 0 ) {',\n\n\t\t\t\t\t'float depth = gl_FragCoord.z / gl_FragCoord.w;',\n\t\t\t\t\t'float fogFactor = 0.0;',\n\n\t\t\t\t\t'if ( fogType == 1 ) {',\n\n\t\t\t\t\t\t'fogFactor = smoothstep( fogNear, fogFar, depth );',\n\n\t\t\t\t\t'} else {',\n\n\t\t\t\t\t\t'const float LOG2 = 1.442695;',\n\t\t\t\t\t\t'fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );',\n\t\t\t\t\t\t'fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );',\n\n\t\t\t\t\t'}',\n\n\t\t\t\t\t'gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );',\n\n\t\t\t\t'}',\n\n\t\t\t'}'\n\n\t\t].join( '\\n' ) );\n\n\t\tgl.compileShader( vertexShader );\n\t\tgl.compileShader( fragmentShader );\n\n\t\tgl.attachShader( program, vertexShader );\n\t\tgl.attachShader( program, fragmentShader );\n\n\t\tgl.linkProgram( program );\n\n\t\treturn program;\n\n\t}\n\n\tfunction painterSortStable ( a, b ) {\n\n\t\tif ( a.z !== b.z ) {\n\n\t\t\treturn b.z - a.z;\n\n\t\t} else {\n\n\t\t\treturn b.id - a.id;\n\n\t\t}\n\n\t}\n\n};\n\n// File:src/extras/GeometryUtils.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.GeometryUtils = {\n\n\tmerge: function ( geometry1, geometry2, materialIndexOffset ) {\n\n\t\tconsole.warn( 'THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.' );\n\n\t\tvar matrix;\n\n\t\tif ( geometry2 instanceof THREE.Mesh ) {\n\n\t\t\tgeometry2.matrixAutoUpdate && geometry2.updateMatrix();\n\n\t\t\tmatrix = geometry2.matrix;\n\t\t\tgeometry2 = geometry2.geometry;\n\n\t\t}\n\n\t\tgeometry1.merge( geometry2, matrix, materialIndexOffset );\n\n\t},\n\n\tcenter: function ( geometry ) {\n\n\t\tconsole.warn( 'THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead.' );\n\t\treturn geometry.center();\n\n\t}\n\n};\n\n// File:src/extras/ImageUtils.js\n\n/**\n * @author alteredq / http://alteredqualia.com/\n * @author mrdoob / http://mrdoob.com/\n * @author Daosheng Mu / https://github.com/DaoshengMu/\n */\n\nTHREE.ImageUtils = {\n\n\tcrossOrigin: undefined,\n\n\tloadTexture: function ( url, mapping, onLoad, onError ) {\n\n\t\tvar loader = new THREE.ImageLoader();\n\t\tloader.crossOrigin = this.crossOrigin;\n\n\t\tvar texture = new THREE.Texture( undefined, mapping );\n\n\t\tloader.load( url, function ( image ) {\n\n\t\t\ttexture.image = image;\n\t\t\ttexture.needsUpdate = true;\n\n\t\t\tif ( onLoad ) onLoad( texture );\n\n\t\t}, undefined, function ( event ) {\n\n\t\t\tif ( onError ) onError( event );\n\n\t\t} );\n\n\t\ttexture.sourceFile = url;\n\n\t\treturn texture;\n\n\t},\n\n\tloadTextureCube: function ( array, mapping, onLoad, onError ) {\n\n\t\tvar images = [];\n\n\t\tvar loader = new THREE.ImageLoader();\n\t\tloader.crossOrigin = this.crossOrigin;\n\n\t\tvar texture = new THREE.CubeTexture( images, mapping );\n\n\t\tvar loaded = 0;\n\n\t\tvar loadTexture = function ( i ) {\n\n\t\t\tloader.load( array[ i ], function ( image ) {\n\n\t\t\t\ttexture.images[ i ] = image;\n\n\t\t\t\tloaded += 1;\n\n\t\t\t\tif ( loaded === 6 ) {\n\n\t\t\t\t\ttexture.needsUpdate = true;\n\n\t\t\t\t\tif ( onLoad ) onLoad( texture );\n\n\t\t\t\t}\n\n\t\t\t}, undefined, onError );\n\n\t\t};\n\n\t\tfor ( var i = 0, il = array.length; i < il; ++ i ) {\n\n\t\t\tloadTexture( i );\n\n\t\t}\n\n\t\treturn texture;\n\n\t},\n\n\tloadCompressedTexture: function () {\n\n\t\tconsole.error( 'THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.' )\n\n\t},\n\n\tloadCompressedTextureCube: function () {\n\n\t\tconsole.error( 'THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.' )\n\n\t},\n\n\tgetNormalMap: function ( image, depth ) {\n\n\t\t// Adapted from http://www.paulbrunt.co.uk/lab/heightnormal/\n\n\t\tvar cross = function ( a, b ) {\n\n\t\t\treturn [ a[ 1 ] * b[ 2 ] - a[ 2 ] * b[ 1 ], a[ 2 ] * b[ 0 ] - a[ 0 ] * b[ 2 ], a[ 0 ] * b[ 1 ] - a[ 1 ] * b[ 0 ] ];\n\n\t\t};\n\n\t\tvar subtract = function ( a, b ) {\n\n\t\t\treturn [ a[ 0 ] - b[ 0 ], a[ 1 ] - b[ 1 ], a[ 2 ] - b[ 2 ] ];\n\n\t\t};\n\n\t\tvar normalize = function ( a ) {\n\n\t\t\tvar l = Math.sqrt( a[ 0 ] * a[ 0 ] + a[ 1 ] * a[ 1 ] + a[ 2 ] * a[ 2 ] );\n\t\t\treturn [ a[ 0 ] / l, a[ 1 ] / l, a[ 2 ] / l ];\n\n\t\t};\n\n\t\tdepth = depth | 1;\n\n\t\tvar width = image.width;\n\t\tvar height = image.height;\n\n\t\tvar canvas = document.createElement( 'canvas' );\n\t\tcanvas.width = width;\n\t\tcanvas.height = height;\n\n\t\tvar context = canvas.getContext( '2d' );\n\t\tcontext.drawImage( image, 0, 0 );\n\n\t\tvar data = context.getImageData( 0, 0, width, height ).data;\n\t\tvar imageData = context.createImageData( width, height );\n\t\tvar output = imageData.data;\n\n\t\tfor ( var x = 0; x < width; x ++ ) {\n\n\t\t\tfor ( var y = 0; y < height; y ++ ) {\n\n\t\t\t\tvar ly = y - 1 < 0 ? 0 : y - 1;\n\t\t\t\tvar uy = y + 1 > height - 1 ? height - 1 : y + 1;\n\t\t\t\tvar lx = x - 1 < 0 ? 0 : x - 1;\n\t\t\t\tvar ux = x + 1 > width - 1 ? width - 1 : x + 1;\n\n\t\t\t\tvar points = [];\n\t\t\t\tvar origin = [ 0, 0, data[ ( y * width + x ) * 4 ] / 255 * depth ];\n\t\t\t\tpoints.push( [ - 1, 0, data[ ( y * width + lx ) * 4 ] / 255 * depth ] );\n\t\t\t\tpoints.push( [ - 1, - 1, data[ ( ly * width + lx ) * 4 ] / 255 * depth ] );\n\t\t\t\tpoints.push( [ 0, - 1, data[ ( ly * width + x ) * 4 ] / 255 * depth ] );\n\t\t\t\tpoints.push( [ 1, - 1, data[ ( ly * width + ux ) * 4 ] / 255 * depth ] );\n\t\t\t\tpoints.push( [ 1, 0, data[ ( y * width + ux ) * 4 ] / 255 * depth ] );\n\t\t\t\tpoints.push( [ 1, 1, data[ ( uy * width + ux ) * 4 ] / 255 * depth ] );\n\t\t\t\tpoints.push( [ 0, 1, data[ ( uy * width + x ) * 4 ] / 255 * depth ] );\n\t\t\t\tpoints.push( [ - 1, 1, data[ ( uy * width + lx ) * 4 ] / 255 * depth ] );\n\n\t\t\t\tvar normals = [];\n\t\t\t\tvar num_points = points.length;\n\n\t\t\t\tfor ( var i = 0; i < num_points; i ++ ) {\n\n\t\t\t\t\tvar v1 = points[ i ];\n\t\t\t\t\tvar v2 = points[ ( i + 1 ) % num_points ];\n\t\t\t\t\tv1 = subtract( v1, origin );\n\t\t\t\t\tv2 = subtract( v2, origin );\n\t\t\t\t\tnormals.push( normalize( cross( v1, v2 ) ) );\n\n\t\t\t\t}\n\n\t\t\t\tvar normal = [ 0, 0, 0 ];\n\n\t\t\t\tfor ( var i = 0; i < normals.length; i ++ ) {\n\n\t\t\t\t\tnormal[ 0 ] += normals[ i ][ 0 ];\n\t\t\t\t\tnormal[ 1 ] += normals[ i ][ 1 ];\n\t\t\t\t\tnormal[ 2 ] += normals[ i ][ 2 ];\n\n\t\t\t\t}\n\n\t\t\t\tnormal[ 0 ] /= normals.length;\n\t\t\t\tnormal[ 1 ] /= normals.length;\n\t\t\t\tnormal[ 2 ] /= normals.length;\n\n\t\t\t\tvar idx = ( y * width + x ) * 4;\n\n\t\t\t\toutput[ idx ] = ( ( normal[ 0 ] + 1.0 ) / 2.0 * 255 ) | 0;\n\t\t\t\toutput[ idx + 1 ] = ( ( normal[ 1 ] + 1.0 ) / 2.0 * 255 ) | 0;\n\t\t\t\toutput[ idx + 2 ] = ( normal[ 2 ] * 255 ) | 0;\n\t\t\t\toutput[ idx + 3 ] = 255;\n\n\t\t\t}\n\n\t\t}\n\n\t\tcontext.putImageData( imageData, 0, 0 );\n\n\t\treturn canvas;\n\n\t},\n\n\tgenerateDataTexture: function ( width, height, color ) {\n\n\t\tvar size = width * height;\n\t\tvar data = new Uint8Array( 3 * size );\n\n\t\tvar r = Math.floor( color.r * 255 );\n\t\tvar g = Math.floor( color.g * 255 );\n\t\tvar b = Math.floor( color.b * 255 );\n\n\t\tfor ( var i = 0; i < size; i ++ ) {\n\n\t\t\tdata[ i * 3 ] \t   = r;\n\t\t\tdata[ i * 3 + 1 ] = g;\n\t\t\tdata[ i * 3 + 2 ] = b;\n\n\t\t}\n\n\t\tvar texture = new THREE.DataTexture( data, width, height, THREE.RGBFormat );\n\t\ttexture.needsUpdate = true;\n\n\t\treturn texture;\n\n\t}\n\n};\n\n// File:src/extras/SceneUtils.js\n\n/**\n * @author alteredq / http://alteredqualia.com/\n */\n\nTHREE.SceneUtils = {\n\n\tcreateMultiMaterialObject: function ( geometry, materials ) {\n\n\t\tvar group = new THREE.Group();\n\n\t\tfor ( var i = 0, l = materials.length; i < l; i ++ ) {\n\n\t\t\tgroup.add( new THREE.Mesh( geometry, materials[ i ] ) );\n\n\t\t}\n\n\t\treturn group;\n\n\t},\n\n\tdetach: function ( child, parent, scene ) {\n\n\t\tchild.applyMatrix( parent.matrixWorld );\n\t\tparent.remove( child );\n\t\tscene.add( child );\n\n\t},\n\n\tattach: function ( child, scene, parent ) {\n\n\t\tvar matrixWorldInverse = new THREE.Matrix4();\n\t\tmatrixWorldInverse.getInverse( parent.matrixWorld );\n\t\tchild.applyMatrix( matrixWorldInverse );\n\n\t\tscene.remove( child );\n\t\tparent.add( child );\n\n\t}\n\n};\n\n// File:src/extras/FontUtils.js\n\n/**\n * @author zz85 / http://www.lab4games.net/zz85/blog\n * @author alteredq / http://alteredqualia.com/\n *\n * For Text operations in three.js (See TextGeometry)\n *\n * It uses techniques used in:\n *\n *\tTriangulation ported from AS3\n *\t\tSimple Polygon Triangulation\n *\t\thttp://actionsnippet.com/?p=1462\n *\n * \tA Method to triangulate shapes with holes\n *\t\thttp://www.sakri.net/blog/2009/06/12/an-approach-to-triangulating-polygons-with-holes/\n *\n */\n\nTHREE.FontUtils = {\n\n\tfaces: {},\n\n\t// Just for now. face[weight][style]\n\n\tface: 'helvetiker',\n\tweight: 'normal',\n\tstyle: 'normal',\n\tsize: 150,\n\tdivisions: 10,\n\n\tgetFace: function () {\n\n\t\ttry {\n\n\t\t\treturn this.faces[ this.face.toLowerCase() ][ this.weight ][ this.style ];\n\n\t\t} catch ( e ) {\n\n\t\t\tthrow \"The font \" + this.face + \" with \" + this.weight + \" weight and \" + this.style + \" style is missing.\"\n\n\t\t}\n\n\t},\n\n\tloadFace: function ( data ) {\n\n\t\tvar family = data.familyName.toLowerCase();\n\n\t\tvar ThreeFont = this;\n\n\t\tThreeFont.faces[ family ] = ThreeFont.faces[ family ] || {};\n\n\t\tThreeFont.faces[ family ][ data.cssFontWeight ] = ThreeFont.faces[ family ][ data.cssFontWeight ] || {};\n\t\tThreeFont.faces[ family ][ data.cssFontWeight ][ data.cssFontStyle ] = data;\n\n\t\tThreeFont.faces[ family ][ data.cssFontWeight ][ data.cssFontStyle ] = data;\n\n\t\treturn data;\n\n\t},\n\n\tdrawText: function ( text ) {\n\n\t\t// RenderText\n\n\t\tvar i,\n\t\t\tface = this.getFace(),\n\t\t\tscale = this.size / face.resolution,\n\t\t\toffset = 0,\n\t\t\tchars = String( text ).split( '' ),\n\t\t\tlength = chars.length;\n\n\t\tvar fontPaths = [];\n\n\t\tfor ( i = 0; i < length; i ++ ) {\n\n\t\t\tvar path = new THREE.Path();\n\n\t\t\tvar ret = this.extractGlyphPoints( chars[ i ], face, scale, offset, path );\n\t\t\toffset += ret.offset;\n\n\t\t\tfontPaths.push( ret.path );\n\n\t\t}\n\n\t\t// get the width\n\n\t\tvar width = offset / 2;\n\t\t//\n\t\t// for ( p = 0; p < allPts.length; p++ ) {\n\t\t//\n\t\t// \tallPts[ p ].x -= width;\n\t\t//\n\t\t// }\n\n\t\t//var extract = this.extractPoints( allPts, characterPts );\n\t\t//extract.contour = allPts;\n\n\t\t//extract.paths = fontPaths;\n\t\t//extract.offset = width;\n\n\t\treturn { paths: fontPaths, offset: width };\n\n\t},\n\n\n\n\n\textractGlyphPoints: function ( c, face, scale, offset, path ) {\n\n\t\tvar pts = [];\n\n\t\tvar i, i2, divisions,\n\t\t\toutline, action, length,\n\t\t\tscaleX, scaleY,\n\t\t\tx, y, cpx, cpy, cpx0, cpy0, cpx1, cpy1, cpx2, cpy2,\n\t\t\tlaste,\n\t\t\tglyph = face.glyphs[ c ] || face.glyphs[ '?' ];\n\n\t\tif ( ! glyph ) return;\n\n\t\tif ( glyph.o ) {\n\n\t\t\toutline = glyph._cachedOutline || ( glyph._cachedOutline = glyph.o.split( ' ' ) );\n\t\t\tlength = outline.length;\n\n\t\t\tscaleX = scale;\n\t\t\tscaleY = scale;\n\n\t\t\tfor ( i = 0; i < length; ) {\n\n\t\t\t\taction = outline[ i ++ ];\n\n\t\t\t\t//console.log( action );\n\n\t\t\t\tswitch ( action ) {\n\n\t\t\t\tcase 'm':\n\n\t\t\t\t\t// Move To\n\n\t\t\t\t\tx = outline[ i ++ ] * scaleX + offset;\n\t\t\t\t\ty = outline[ i ++ ] * scaleY;\n\n\t\t\t\t\tpath.moveTo( x, y );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'l':\n\n\t\t\t\t\t// Line To\n\n\t\t\t\t\tx = outline[ i ++ ] * scaleX + offset;\n\t\t\t\t\ty = outline[ i ++ ] * scaleY;\n\t\t\t\t\tpath.lineTo( x, y );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'q':\n\n\t\t\t\t\t// QuadraticCurveTo\n\n\t\t\t\t\tcpx  = outline[ i ++ ] * scaleX + offset;\n\t\t\t\t\tcpy  = outline[ i ++ ] * scaleY;\n\t\t\t\t\tcpx1 = outline[ i ++ ] * scaleX + offset;\n\t\t\t\t\tcpy1 = outline[ i ++ ] * scaleY;\n\n\t\t\t\t\tpath.quadraticCurveTo( cpx1, cpy1, cpx, cpy );\n\n\t\t\t\t\tlaste = pts[ pts.length - 1 ];\n\n\t\t\t\t\tif ( laste ) {\n\n\t\t\t\t\t\tcpx0 = laste.x;\n\t\t\t\t\t\tcpy0 = laste.y;\n\n\t\t\t\t\t\tfor ( i2 = 1, divisions = this.divisions; i2 <= divisions; i2 ++ ) {\n\n\t\t\t\t\t\t\tvar t = i2 / divisions;\n\t\t\t\t\t\t\tTHREE.Shape.Utils.b2( t, cpx0, cpx1, cpx );\n\t\t\t\t\t\t\tTHREE.Shape.Utils.b2( t, cpy0, cpy1, cpy );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'b':\n\n\t\t\t\t\t// Cubic Bezier Curve\n\n\t\t\t\t\tcpx  = outline[ i ++ ] *  scaleX + offset;\n\t\t\t\t\tcpy  = outline[ i ++ ] *  scaleY;\n\t\t\t\t\tcpx1 = outline[ i ++ ] *  scaleX + offset;\n\t\t\t\t\tcpy1 = outline[ i ++ ] *  scaleY;\n\t\t\t\t\tcpx2 = outline[ i ++ ] *  scaleX + offset;\n\t\t\t\t\tcpy2 = outline[ i ++ ] *  scaleY;\n\n\t\t\t\t\tpath.bezierCurveTo( cpx1, cpy1, cpx2, cpy2, cpx, cpy );\n\n\t\t\t\t\tlaste = pts[ pts.length - 1 ];\n\n\t\t\t\t\tif ( laste ) {\n\n\t\t\t\t\t\tcpx0 = laste.x;\n\t\t\t\t\t\tcpy0 = laste.y;\n\n\t\t\t\t\t\tfor ( i2 = 1, divisions = this.divisions; i2 <= divisions; i2 ++ ) {\n\n\t\t\t\t\t\t\tvar t = i2 / divisions;\n\t\t\t\t\t\t\tTHREE.Shape.Utils.b3( t, cpx0, cpx1, cpx2, cpx );\n\t\t\t\t\t\t\tTHREE.Shape.Utils.b3( t, cpy0, cpy1, cpy2, cpy );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\n\n\t\treturn { offset: glyph.ha * scale, path: path };\n\n\t}\n\n};\n\n\nTHREE.FontUtils.generateShapes = function ( text, parameters ) {\n\n\t// Parameters\n\n\tparameters = parameters || {};\n\n\tvar size = parameters.size !== undefined ? parameters.size : 100;\n\tvar curveSegments = parameters.curveSegments !== undefined ? parameters.curveSegments : 4;\n\n\tvar font = parameters.font !== undefined ? parameters.font : 'helvetiker';\n\tvar weight = parameters.weight !== undefined ? parameters.weight : 'normal';\n\tvar style = parameters.style !== undefined ? parameters.style : 'normal';\n\n\tTHREE.FontUtils.size = size;\n\tTHREE.FontUtils.divisions = curveSegments;\n\n\tTHREE.FontUtils.face = font;\n\tTHREE.FontUtils.weight = weight;\n\tTHREE.FontUtils.style = style;\n\n\t// Get a Font data json object\n\n\tvar data = THREE.FontUtils.drawText( text );\n\n\tvar paths = data.paths;\n\tvar shapes = [];\n\n\tfor ( var p = 0, pl = paths.length; p < pl; p ++ ) {\n\n\t\tArray.prototype.push.apply( shapes, paths[ p ].toShapes() );\n\n\t}\n\n\treturn shapes;\n\n};\n\n\n/**\n * This code is a quick port of code written in C++ which was submitted to\n * flipcode.com by John W. Ratcliff  // July 22, 2000\n * See original code and more information here:\n * http://www.flipcode.com/archives/Efficient_Polygon_Triangulation.shtml\n *\n * ported to actionscript by Zevan Rosser\n * www.actionsnippet.com\n *\n * ported to javascript by Joshua Koo\n * http://www.lab4games.net/zz85/blog\n *\n */\n\n\n( function ( namespace ) {\n\n\tvar EPSILON = 0.0000000001;\n\n\t// takes in an contour array and returns\n\n\tvar process = function ( contour, indices ) {\n\n\t\tvar n = contour.length;\n\n\t\tif ( n < 3 ) return null;\n\n\t\tvar result = [],\n\t\t\tverts = [],\n\t\t\tvertIndices = [];\n\n\t\t/* we want a counter-clockwise polygon in verts */\n\n\t\tvar u, v, w;\n\n\t\tif ( area( contour ) > 0.0 ) {\n\n\t\t\tfor ( v = 0; v < n; v ++ ) verts[ v ] = v;\n\n\t\t} else {\n\n\t\t\tfor ( v = 0; v < n; v ++ ) verts[ v ] = ( n - 1 ) - v;\n\n\t\t}\n\n\t\tvar nv = n;\n\n\t\t/*  remove nv - 2 vertices, creating 1 triangle every time */\n\n\t\tvar count = 2 * nv;   /* error detection */\n\n\t\tfor ( v = nv - 1; nv > 2; ) {\n\n\t\t\t/* if we loop, it is probably a non-simple polygon */\n\n\t\t\tif ( ( count -- ) <= 0 ) {\n\n\t\t\t\t//** Triangulate: ERROR - probable bad polygon!\n\n\t\t\t\t//throw ( \"Warning, unable to triangulate polygon!\" );\n\t\t\t\t//return null;\n\t\t\t\t// Sometimes warning is fine, especially polygons are triangulated in reverse.\n\t\t\t\tconsole.warn( 'THREE.FontUtils: Warning, unable to triangulate polygon! in Triangulate.process()' );\n\n\t\t\t\tif ( indices ) return vertIndices;\n\t\t\t\treturn result;\n\n\t\t\t}\n\n\t\t\t/* three consecutive vertices in current polygon, <u,v,w> */\n\n\t\t\tu = v; \t \tif ( nv <= u ) u = 0;     /* previous */\n\t\t\tv = u + 1;  if ( nv <= v ) v = 0;     /* new v    */\n\t\t\tw = v + 1;  if ( nv <= w ) w = 0;     /* next     */\n\n\t\t\tif ( snip( contour, u, v, w, nv, verts ) ) {\n\n\t\t\t\tvar a, b, c, s, t;\n\n\t\t\t\t/* true names of the vertices */\n\n\t\t\t\ta = verts[ u ];\n\t\t\t\tb = verts[ v ];\n\t\t\t\tc = verts[ w ];\n\n\t\t\t\t/* output Triangle */\n\n\t\t\t\tresult.push( [ contour[ a ],\n\t\t\t\t\tcontour[ b ],\n\t\t\t\t\tcontour[ c ] ] );\n\n\n\t\t\t\tvertIndices.push( [ verts[ u ], verts[ v ], verts[ w ] ] );\n\n\t\t\t\t/* remove v from the remaining polygon */\n\n\t\t\t\tfor ( s = v, t = v + 1; t < nv; s ++, t ++ ) {\n\n\t\t\t\t\tverts[ s ] = verts[ t ];\n\n\t\t\t\t}\n\n\t\t\t\tnv --;\n\n\t\t\t\t/* reset error detection counter */\n\n\t\t\t\tcount = 2 * nv;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( indices ) return vertIndices;\n\t\treturn result;\n\n\t};\n\n\t// calculate area of the contour polygon\n\n\tvar area = function ( contour ) {\n\n\t\tvar n = contour.length;\n\t\tvar a = 0.0;\n\n\t\tfor ( var p = n - 1, q = 0; q < n; p = q ++ ) {\n\n\t\t\ta += contour[ p ].x * contour[ q ].y - contour[ q ].x * contour[ p ].y;\n\n\t\t}\n\n\t\treturn a * 0.5;\n\n\t};\n\n\tvar snip = function ( contour, u, v, w, n, verts ) {\n\n\t\tvar p;\n\t\tvar ax, ay, bx, by;\n\t\tvar cx, cy, px, py;\n\n\t\tax = contour[ verts[ u ] ].x;\n\t\tay = contour[ verts[ u ] ].y;\n\n\t\tbx = contour[ verts[ v ] ].x;\n\t\tby = contour[ verts[ v ] ].y;\n\n\t\tcx = contour[ verts[ w ] ].x;\n\t\tcy = contour[ verts[ w ] ].y;\n\n\t\tif ( EPSILON > ( ( ( bx - ax ) * ( cy - ay ) ) - ( ( by - ay ) * ( cx - ax ) ) ) ) return false;\n\n\t\tvar aX, aY, bX, bY, cX, cY;\n\t\tvar apx, apy, bpx, bpy, cpx, cpy;\n\t\tvar cCROSSap, bCROSScp, aCROSSbp;\n\n\t\taX = cx - bx;  aY = cy - by;\n\t\tbX = ax - cx;  bY = ay - cy;\n\t\tcX = bx - ax;  cY = by - ay;\n\n\t\tfor ( p = 0; p < n; p ++ ) {\n\n\t\t\tpx = contour[ verts[ p ] ].x;\n\t\t\tpy = contour[ verts[ p ] ].y;\n\n\t\t\tif ( ( ( px === ax ) && ( py === ay ) ) ||\n\t\t\t\t ( ( px === bx ) && ( py === by ) ) ||\n\t\t\t\t ( ( px === cx ) && ( py === cy ) ) )\tcontinue;\n\n\t\t\tapx = px - ax;  apy = py - ay;\n\t\t\tbpx = px - bx;  bpy = py - by;\n\t\t\tcpx = px - cx;  cpy = py - cy;\n\n\t\t\t// see if p is inside triangle abc\n\n\t\t\taCROSSbp = aX * bpy - aY * bpx;\n\t\t\tcCROSSap = cX * apy - cY * apx;\n\t\t\tbCROSScp = bX * cpy - bY * cpx;\n\n\t\t\tif ( ( aCROSSbp >= - EPSILON ) && ( bCROSScp >= - EPSILON ) && ( cCROSSap >= - EPSILON ) ) return false;\n\n\t\t}\n\n\t\treturn true;\n\n\t};\n\n\n\tnamespace.Triangulate = process;\n\tnamespace.Triangulate.area = area;\n\n\treturn namespace;\n\n} )( THREE.FontUtils );\n\n// To use the typeface.js face files, hook up the API\n\nTHREE.typeface_js = { faces: THREE.FontUtils.faces, loadFace: THREE.FontUtils.loadFace };\nif ( typeof self !== 'undefined' ) self._typeface_js = THREE.typeface_js;\n\n// File:src/extras/audio/Audio.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.Audio = function ( listener ) {\n\n\tTHREE.Object3D.call( this );\n\n\tthis.type = 'Audio';\n\n\tthis.context = listener.context;\n\tthis.source = this.context.createBufferSource();\n\tthis.source.onended = this.onEnded.bind( this );\n\n\tthis.gain = this.context.createGain();\n\tthis.gain.connect( this.context.destination );\n\n\tthis.panner = this.context.createPanner();\n\tthis.panner.connect( this.gain );\n\n\tthis.autoplay = false;\n\n\tthis.startTime = 0;\n\tthis.playbackRate = 1;\n\tthis.isPlaying = false;\n\n};\n\nTHREE.Audio.prototype = Object.create( THREE.Object3D.prototype );\nTHREE.Audio.prototype.constructor = THREE.Audio;\n\nTHREE.Audio.prototype.load = function ( file ) {\n\n\tvar scope = this;\n\n\tvar request = new XMLHttpRequest();\n\trequest.open( 'GET', file, true );\n\trequest.responseType = 'arraybuffer';\n\trequest.onload = function ( e ) {\n\n\t\tscope.context.decodeAudioData( this.response, function ( buffer ) {\n\n\t\t\tscope.source.buffer = buffer;\n\n\t\t\tif ( scope.autoplay ) scope.play();\n\n\t\t} );\n\n\t};\n\trequest.send();\n\n\treturn this;\n\n};\n\nTHREE.Audio.prototype.play = function () {\n\n\tif ( this.isPlaying === true ) {\n\n\t\tconsole.warn( 'THREE.Audio: Audio is already playing.' );\n\t\treturn;\n\n\t}\n\n\tvar source = this.context.createBufferSource();\n\n\tsource.buffer = this.source.buffer;\n\tsource.loop = this.source.loop;\n\tsource.onended = this.source.onended;\n\tsource.start( 0, this.startTime );\n\tsource.playbackRate.value = this.playbackRate;\n\n\tthis.isPlaying = true;\n\n\tthis.source = source;\n\n\tthis.connect();\n\n};\n\nTHREE.Audio.prototype.pause = function () {\n\n\tthis.source.stop();\n\tthis.startTime = this.context.currentTime;\n\n};\n\nTHREE.Audio.prototype.stop = function () {\n\n\tthis.source.stop();\n\tthis.startTime = 0;\n\n};\n\nTHREE.Audio.prototype.connect = function () {\n\n\tif ( this.filter !== undefined ) {\n\n\t\tthis.source.connect( this.filter );\n\t\tthis.filter.connect( this.panner );\n\n\t} else {\n\n\t\tthis.source.connect( this.panner );\n\n\t}\n\n};\n\nTHREE.Audio.prototype.disconnect = function () {\n\n\tif ( this.filter !== undefined ) {\n\n\t\tthis.source.disconnect( this.filter );\n\t\tthis.filter.disconnect( this.panner );\n\n\t} else {\n\n\t\tthis.source.disconnect( this.panner );\n\n\t}\n\n};\n\nTHREE.Audio.prototype.setFilter = function ( value ) {\n\n\tif ( this.isPlaying === true ) {\n\n\t\tthis.disconnect();\n\t\tthis.filter = value;\n\t\tthis.connect();\n\n\t} else {\n\n\t\tthis.filter = value;\n\n\t}\n\n};\n\nTHREE.Audio.prototype.getFilter = function () {\n\n\treturn this.filter;\n\n};\n\nTHREE.Audio.prototype.setPlaybackRate = function ( value ) {\n\n\tthis.playbackRate = value;\n\n\tif ( this.isPlaying === true ) {\n\n\t\tthis.source.playbackRate.value = this.playbackRate;\n\n\t}\n\n};\n\nTHREE.Audio.prototype.getPlaybackRate = function () {\n\n\treturn this.playbackRate;\n\n};\n\nTHREE.Audio.prototype.onEnded = function() {\n\n\tthis.isPlaying = false;\n\n};\n\nTHREE.Audio.prototype.setLoop = function ( value ) {\n\n\tthis.source.loop = value;\n\n};\n\nTHREE.Audio.prototype.getLoop = function () {\n\n\treturn this.source.loop;\n\n};\n\nTHREE.Audio.prototype.setRefDistance = function ( value ) {\n\n\tthis.panner.refDistance = value;\n\n};\n\nTHREE.Audio.prototype.getRefDistance = function () {\n\n\treturn this.panner.refDistance;\n\n};\n\nTHREE.Audio.prototype.setRolloffFactor = function ( value ) {\n\n\tthis.panner.rolloffFactor = value;\n\n};\n\nTHREE.Audio.prototype.getRolloffFactor = function () {\n\n\treturn this.panner.rolloffFactor;\n\n};\n\nTHREE.Audio.prototype.setVolume = function ( value ) {\n\n\tthis.gain.gain.value = value;\n\n};\n\nTHREE.Audio.prototype.getVolume = function () {\n\n\treturn this.gain.gain.value;\n\n};\n\nTHREE.Audio.prototype.updateMatrixWorld = ( function () {\n\n\tvar position = new THREE.Vector3();\n\n\treturn function updateMatrixWorld( force ) {\n\n\t\tTHREE.Object3D.prototype.updateMatrixWorld.call( this, force );\n\n\t\tposition.setFromMatrixPosition( this.matrixWorld );\n\n\t\tthis.panner.setPosition( position.x, position.y, position.z );\n\n\t};\n\n} )();\n\n// File:src/extras/audio/AudioListener.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.AudioListener = function () {\n\n\tTHREE.Object3D.call( this );\n\n\tthis.type = 'AudioListener';\n\n\tthis.context = new ( window.AudioContext || window.webkitAudioContext )();\n\n};\n\nTHREE.AudioListener.prototype = Object.create( THREE.Object3D.prototype );\nTHREE.AudioListener.prototype.constructor = THREE.AudioListener;\n\nTHREE.AudioListener.prototype.updateMatrixWorld = ( function () {\n\n\tvar position = new THREE.Vector3();\n\tvar quaternion = new THREE.Quaternion();\n\tvar scale = new THREE.Vector3();\n\n\tvar orientation = new THREE.Vector3();\n\n\treturn function updateMatrixWorld( force ) {\n\n\t\tTHREE.Object3D.prototype.updateMatrixWorld.call( this, force );\n\n\t\tvar listener = this.context.listener;\n\t\tvar up = this.up;\n\n\t\tthis.matrixWorld.decompose( position, quaternion, scale );\n\n\t\torientation.set( 0, 0, - 1 ).applyQuaternion( quaternion );\n\n\t\tlistener.setPosition( position.x, position.y, position.z );\n\t\tlistener.setOrientation( orientation.x, orientation.y, orientation.z, up.x, up.y, up.z );\n\n\t};\n\n} )();\n\n// File:src/extras/core/Curve.js\n\n/**\n * @author zz85 / http://www.lab4games.net/zz85/blog\n * Extensible curve object\n *\n * Some common of Curve methods\n * .getPoint(t), getTangent(t)\n * .getPointAt(u), getTagentAt(u)\n * .getPoints(), .getSpacedPoints()\n * .getLength()\n * .updateArcLengths()\n *\n * This following classes subclasses THREE.Curve:\n *\n * -- 2d classes --\n * THREE.LineCurve\n * THREE.QuadraticBezierCurve\n * THREE.CubicBezierCurve\n * THREE.SplineCurve\n * THREE.ArcCurve\n * THREE.EllipseCurve\n *\n * -- 3d classes --\n * THREE.LineCurve3\n * THREE.QuadraticBezierCurve3\n * THREE.CubicBezierCurve3\n * THREE.SplineCurve3\n * THREE.ClosedSplineCurve3\n *\n * A series of curves can be represented as a THREE.CurvePath\n *\n **/\n\n/**************************************************************\n *\tAbstract Curve base class\n **************************************************************/\n\nTHREE.Curve = function () {\n\n};\n\n// Virtual base class method to overwrite and implement in subclasses\n//\t- t [0 .. 1]\n\nTHREE.Curve.prototype.getPoint = function ( t ) {\n\n\tconsole.warn( \"THREE.Curve: Warning, getPoint() not implemented!\" );\n\treturn null;\n\n};\n\n// Get point at relative position in curve according to arc length\n// - u [0 .. 1]\n\nTHREE.Curve.prototype.getPointAt = function ( u ) {\n\n\tvar t = this.getUtoTmapping( u );\n\treturn this.getPoint( t );\n\n};\n\n// Get sequence of points using getPoint( t )\n\nTHREE.Curve.prototype.getPoints = function ( divisions ) {\n\n\tif ( ! divisions ) divisions = 5;\n\n\tvar d, pts = [];\n\n\tfor ( d = 0; d <= divisions; d ++ ) {\n\n\t\tpts.push( this.getPoint( d / divisions ) );\n\n\t}\n\n\treturn pts;\n\n};\n\n// Get sequence of points using getPointAt( u )\n\nTHREE.Curve.prototype.getSpacedPoints = function ( divisions ) {\n\n\tif ( ! divisions ) divisions = 5;\n\n\tvar d, pts = [];\n\n\tfor ( d = 0; d <= divisions; d ++ ) {\n\n\t\tpts.push( this.getPointAt( d / divisions ) );\n\n\t}\n\n\treturn pts;\n\n};\n\n// Get total curve arc length\n\nTHREE.Curve.prototype.getLength = function () {\n\n\tvar lengths = this.getLengths();\n\treturn lengths[ lengths.length - 1 ];\n\n};\n\n// Get list of cumulative segment lengths\n\nTHREE.Curve.prototype.getLengths = function ( divisions ) {\n\n\tif ( ! divisions ) divisions = ( this.__arcLengthDivisions ) ? ( this.__arcLengthDivisions ) : 200;\n\n\tif ( this.cacheArcLengths\n\t\t&& ( this.cacheArcLengths.length === divisions + 1 )\n\t\t&& ! this.needsUpdate ) {\n\n\t\t//console.log( \"cached\", this.cacheArcLengths );\n\t\treturn this.cacheArcLengths;\n\n\t}\n\n\tthis.needsUpdate = false;\n\n\tvar cache = [];\n\tvar current, last = this.getPoint( 0 );\n\tvar p, sum = 0;\n\n\tcache.push( 0 );\n\n\tfor ( p = 1; p <= divisions; p ++ ) {\n\n\t\tcurrent = this.getPoint ( p / divisions );\n\t\tsum += current.distanceTo( last );\n\t\tcache.push( sum );\n\t\tlast = current;\n\n\t}\n\n\tthis.cacheArcLengths = cache;\n\n\treturn cache; // { sums: cache, sum:sum }; Sum is in the last element.\n\n};\n\n\nTHREE.Curve.prototype.updateArcLengths = function() {\n\n\tthis.needsUpdate = true;\n\tthis.getLengths();\n\n};\n\n// Given u ( 0 .. 1 ), get a t to find p. This gives you points which are equidistant\n\nTHREE.Curve.prototype.getUtoTmapping = function ( u, distance ) {\n\n\tvar arcLengths = this.getLengths();\n\n\tvar i = 0, il = arcLengths.length;\n\n\tvar targetArcLength; // The targeted u distance value to get\n\n\tif ( distance ) {\n\n\t\ttargetArcLength = distance;\n\n\t} else {\n\n\t\ttargetArcLength = u * arcLengths[ il - 1 ];\n\n\t}\n\n\t//var time = Date.now();\n\n\t// binary search for the index with largest value smaller than target u distance\n\n\tvar low = 0, high = il - 1, comparison;\n\n\twhile ( low <= high ) {\n\n\t\ti = Math.floor( low + ( high - low ) / 2 ); // less likely to overflow, though probably not issue here, JS doesn't really have integers, all numbers are floats\n\n\t\tcomparison = arcLengths[ i ] - targetArcLength;\n\n\t\tif ( comparison < 0 ) {\n\n\t\t\tlow = i + 1;\n\n\t\t} else if ( comparison > 0 ) {\n\n\t\t\thigh = i - 1;\n\n\t\t} else {\n\n\t\t\thigh = i;\n\t\t\tbreak;\n\n\t\t\t// DONE\n\n\t\t}\n\n\t}\n\n\ti = high;\n\n\t//console.log('b' , i, low, high, Date.now()- time);\n\n\tif ( arcLengths[ i ] === targetArcLength ) {\n\n\t\tvar t = i / ( il - 1 );\n\t\treturn t;\n\n\t}\n\n\t// we could get finer grain at lengths, or use simple interpolation between two points\n\n\tvar lengthBefore = arcLengths[ i ];\n\tvar lengthAfter = arcLengths[ i + 1 ];\n\n\tvar segmentLength = lengthAfter - lengthBefore;\n\n\t// determine where we are between the 'before' and 'after' points\n\n\tvar segmentFraction = ( targetArcLength - lengthBefore ) / segmentLength;\n\n\t// add that fractional amount to t\n\n\tvar t = ( i + segmentFraction ) / ( il - 1 );\n\n\treturn t;\n\n};\n\n// Returns a unit vector tangent at t\n// In case any sub curve does not implement its tangent derivation,\n// 2 points a small delta apart will be used to find its gradient\n// which seems to give a reasonable approximation\n\nTHREE.Curve.prototype.getTangent = function( t ) {\n\n\tvar delta = 0.0001;\n\tvar t1 = t - delta;\n\tvar t2 = t + delta;\n\n\t// Capping in case of danger\n\n\tif ( t1 < 0 ) t1 = 0;\n\tif ( t2 > 1 ) t2 = 1;\n\n\tvar pt1 = this.getPoint( t1 );\n\tvar pt2 = this.getPoint( t2 );\n\n\tvar vec = pt2.clone().sub( pt1 );\n\treturn vec.normalize();\n\n};\n\n\nTHREE.Curve.prototype.getTangentAt = function ( u ) {\n\n\tvar t = this.getUtoTmapping( u );\n\treturn this.getTangent( t );\n\n};\n\n\n\n\n\n/**************************************************************\n *\tUtils\n **************************************************************/\n\nTHREE.Curve.Utils = {\n\n\ttangentQuadraticBezier: function ( t, p0, p1, p2 ) {\n\n\t\treturn 2 * ( 1 - t ) * ( p1 - p0 ) + 2 * t * ( p2 - p1 );\n\n\t},\n\n\t// Puay Bing, thanks for helping with this derivative!\n\n\ttangentCubicBezier: function ( t, p0, p1, p2, p3 ) {\n\n\t\treturn - 3 * p0 * ( 1 - t ) * ( 1 - t )  +\n\t\t\t3 * p1 * ( 1 - t ) * ( 1 - t ) - 6 * t * p1 * ( 1 - t ) +\n\t\t\t6 * t *  p2 * ( 1 - t ) - 3 * t * t * p2 +\n\t\t\t3 * t * t * p3;\n\n\t},\n\n\ttangentSpline: function ( t, p0, p1, p2, p3 ) {\n\n\t\t// To check if my formulas are correct\n\n\t\tvar h00 = 6 * t * t - 6 * t; \t// derived from 2t^3  3t^2 + 1\n\t\tvar h10 = 3 * t * t - 4 * t + 1; // t^3  2t^2 + t\n\t\tvar h01 = - 6 * t * t + 6 * t; \t//  2t3 + 3t2\n\t\tvar h11 = 3 * t * t - 2 * t;\t// t3  t2\n\n\t\treturn h00 + h10 + h01 + h11;\n\n\t},\n\n\t// Catmull-Rom\n\n\tinterpolate: function( p0, p1, p2, p3, t ) {\n\n\t\tvar v0 = ( p2 - p0 ) * 0.5;\n\t\tvar v1 = ( p3 - p1 ) * 0.5;\n\t\tvar t2 = t * t;\n\t\tvar t3 = t * t2;\n\t\treturn ( 2 * p1 - 2 * p2 + v0 + v1 ) * t3 + ( - 3 * p1 + 3 * p2 - 2 * v0 - v1 ) * t2 + v0 * t + p1;\n\n\t}\n\n};\n\n\n// TODO: Transformation for Curves?\n\n/**************************************************************\n *\t3D Curves\n **************************************************************/\n\n// A Factory method for creating new curve subclasses\n\nTHREE.Curve.create = function ( constructor, getPointFunc ) {\n\n\tconstructor.prototype = Object.create( THREE.Curve.prototype );\n\tconstructor.prototype.constructor = constructor;\n\tconstructor.prototype.getPoint = getPointFunc;\n\n\treturn constructor;\n\n};\n\n// File:src/extras/core/CurvePath.js\n\n/**\n * @author zz85 / http://www.lab4games.net/zz85/blog\n *\n **/\n\n/**************************************************************\n *\tCurved Path - a curve path is simply a array of connected\n *  curves, but retains the api of a curve\n **************************************************************/\n\nTHREE.CurvePath = function () {\n\n\tthis.curves = [];\n\tthis.bends = [];\n\n\tthis.autoClose = false; // Automatically closes the path\n\n};\n\nTHREE.CurvePath.prototype = Object.create( THREE.Curve.prototype );\nTHREE.CurvePath.prototype.constructor = THREE.CurvePath;\n\nTHREE.CurvePath.prototype.add = function ( curve ) {\n\n\tthis.curves.push( curve );\n\n};\n\nTHREE.CurvePath.prototype.checkConnection = function() {\n\t// TODO\n\t// If the ending of curve is not connected to the starting\n\t// or the next curve, then, this is not a real path\n};\n\nTHREE.CurvePath.prototype.closePath = function() {\n\n\t// TODO Test\n\t// and verify for vector3 (needs to implement equals)\n\t// Add a line curve if start and end of lines are not connected\n\tvar startPoint = this.curves[ 0 ].getPoint( 0 );\n\tvar endPoint = this.curves[ this.curves.length - 1 ].getPoint( 1 );\n\n\tif ( ! startPoint.equals( endPoint ) ) {\n\n\t\tthis.curves.push( new THREE.LineCurve( endPoint, startPoint ) );\n\n\t}\n\n};\n\n// To get accurate point with reference to\n// entire path distance at time t,\n// following has to be done:\n\n// 1. Length of each sub path have to be known\n// 2. Locate and identify type of curve\n// 3. Get t for the curve\n// 4. Return curve.getPointAt(t')\n\nTHREE.CurvePath.prototype.getPoint = function( t ) {\n\n\tvar d = t * this.getLength();\n\tvar curveLengths = this.getCurveLengths();\n\tvar i = 0, diff, curve;\n\n\t// To think about boundaries points.\n\n\twhile ( i < curveLengths.length ) {\n\n\t\tif ( curveLengths[ i ] >= d ) {\n\n\t\t\tdiff = curveLengths[ i ] - d;\n\t\t\tcurve = this.curves[ i ];\n\n\t\t\tvar u = 1 - diff / curve.getLength();\n\n\t\t\treturn curve.getPointAt( u );\n\n\t\t}\n\n\t\ti ++;\n\n\t}\n\n\treturn null;\n\n\t// loop where sum != 0, sum > d , sum+1 <d\n\n};\n\n/*\nTHREE.CurvePath.prototype.getTangent = function( t ) {\n};*/\n\n\n// We cannot use the default THREE.Curve getPoint() with getLength() because in\n// THREE.Curve, getLength() depends on getPoint() but in THREE.CurvePath\n// getPoint() depends on getLength\n\nTHREE.CurvePath.prototype.getLength = function() {\n\n\tvar lens = this.getCurveLengths();\n\treturn lens[ lens.length - 1 ];\n\n};\n\n// Compute lengths and cache them\n// We cannot overwrite getLengths() because UtoT mapping uses it.\n\nTHREE.CurvePath.prototype.getCurveLengths = function() {\n\n\t// We use cache values if curves and cache array are same length\n\n\tif ( this.cacheLengths && this.cacheLengths.length === this.curves.length ) {\n\n\t\treturn this.cacheLengths;\n\n\t}\n\n\t// Get length of sub-curve\n\t// Push sums into cached array\n\n\tvar lengths = [], sums = 0;\n\tvar i, il = this.curves.length;\n\n\tfor ( i = 0; i < il; i ++ ) {\n\n\t\tsums += this.curves[ i ].getLength();\n\t\tlengths.push( sums );\n\n\t}\n\n\tthis.cacheLengths = lengths;\n\n\treturn lengths;\n\n};\n\n\n\n// Returns min and max coordinates\n\nTHREE.CurvePath.prototype.getBoundingBox = function () {\n\n\tvar points = this.getPoints();\n\n\tvar maxX, maxY, maxZ;\n\tvar minX, minY, minZ;\n\n\tmaxX = maxY = Number.NEGATIVE_INFINITY;\n\tminX = minY = Number.POSITIVE_INFINITY;\n\n\tvar p, i, il, sum;\n\n\tvar v3 = points[ 0 ] instanceof THREE.Vector3;\n\n\tsum = v3 ? new THREE.Vector3() : new THREE.Vector2();\n\n\tfor ( i = 0, il = points.length; i < il; i ++ ) {\n\n\t\tp = points[ i ];\n\n\t\tif ( p.x > maxX ) maxX = p.x;\n\t\telse if ( p.x < minX ) minX = p.x;\n\n\t\tif ( p.y > maxY ) maxY = p.y;\n\t\telse if ( p.y < minY ) minY = p.y;\n\n\t\tif ( v3 ) {\n\n\t\t\tif ( p.z > maxZ ) maxZ = p.z;\n\t\t\telse if ( p.z < minZ ) minZ = p.z;\n\n\t\t}\n\n\t\tsum.add( p );\n\n\t}\n\n\tvar ret = {\n\n\t\tminX: minX,\n\t\tminY: minY,\n\t\tmaxX: maxX,\n\t\tmaxY: maxY\n\n\t};\n\n\tif ( v3 ) {\n\n\t\tret.maxZ = maxZ;\n\t\tret.minZ = minZ;\n\n\t}\n\n\treturn ret;\n\n};\n\n/**************************************************************\n *\tCreate Geometries Helpers\n **************************************************************/\n\n/// Generate geometry from path points (for Line or Points objects)\n\nTHREE.CurvePath.prototype.createPointsGeometry = function( divisions ) {\n\n\tvar pts = this.getPoints( divisions, true );\n\treturn this.createGeometry( pts );\n\n};\n\n// Generate geometry from equidistant sampling along the path\n\nTHREE.CurvePath.prototype.createSpacedPointsGeometry = function( divisions ) {\n\n\tvar pts = this.getSpacedPoints( divisions, true );\n\treturn this.createGeometry( pts );\n\n};\n\nTHREE.CurvePath.prototype.createGeometry = function( points ) {\n\n\tvar geometry = new THREE.Geometry();\n\n\tfor ( var i = 0; i < points.length; i ++ ) {\n\n\t\tgeometry.vertices.push( new THREE.Vector3( points[ i ].x, points[ i ].y, points[ i ].z || 0 ) );\n\n\t}\n\n\treturn geometry;\n\n};\n\n\n/**************************************************************\n *\tBend / Wrap Helper Methods\n **************************************************************/\n\n// Wrap path / Bend modifiers?\n\nTHREE.CurvePath.prototype.addWrapPath = function ( bendpath ) {\n\n\tthis.bends.push( bendpath );\n\n};\n\nTHREE.CurvePath.prototype.getTransformedPoints = function( segments, bends ) {\n\n\tvar oldPts = this.getPoints( segments ); // getPoints getSpacedPoints\n\tvar i, il;\n\n\tif ( ! bends ) {\n\n\t\tbends = this.bends;\n\n\t}\n\n\tfor ( i = 0, il = bends.length; i < il; i ++ ) {\n\n\t\toldPts = this.getWrapPoints( oldPts, bends[ i ] );\n\n\t}\n\n\treturn oldPts;\n\n};\n\nTHREE.CurvePath.prototype.getTransformedSpacedPoints = function( segments, bends ) {\n\n\tvar oldPts = this.getSpacedPoints( segments );\n\n\tvar i, il;\n\n\tif ( ! bends ) {\n\n\t\tbends = this.bends;\n\n\t}\n\n\tfor ( i = 0, il = bends.length; i < il; i ++ ) {\n\n\t\toldPts = this.getWrapPoints( oldPts, bends[ i ] );\n\n\t}\n\n\treturn oldPts;\n\n};\n\n// This returns getPoints() bend/wrapped around the contour of a path.\n// Read http://www.planetclegg.com/projects/WarpingTextToSplines.html\n\nTHREE.CurvePath.prototype.getWrapPoints = function ( oldPts, path ) {\n\n\tvar bounds = this.getBoundingBox();\n\n\tvar i, il, p, oldX, oldY, xNorm;\n\n\tfor ( i = 0, il = oldPts.length; i < il; i ++ ) {\n\n\t\tp = oldPts[ i ];\n\n\t\toldX = p.x;\n\t\toldY = p.y;\n\n\t\txNorm = oldX / bounds.maxX;\n\n\t\t// If using actual distance, for length > path, requires line extrusions\n\t\t//xNorm = path.getUtoTmapping(xNorm, oldX); // 3 styles. 1) wrap stretched. 2) wrap stretch by arc length 3) warp by actual distance\n\n\t\txNorm = path.getUtoTmapping( xNorm, oldX );\n\n\t\t// check for out of bounds?\n\n\t\tvar pathPt = path.getPoint( xNorm );\n\t\tvar normal = path.getTangent( xNorm );\n\t\tnormal.set( - normal.y, normal.x ).multiplyScalar( oldY );\n\n\t\tp.x = pathPt.x + normal.x;\n\t\tp.y = pathPt.y + normal.y;\n\n\t}\n\n\treturn oldPts;\n\n};\n\n// File:src/extras/core/Path.js\n\n/**\n * @author zz85 / http://www.lab4games.net/zz85/blog\n * Creates free form 2d path using series of points, lines or curves.\n *\n **/\n\nTHREE.Path = function ( points ) {\n\n\tTHREE.CurvePath.call( this );\n\n\tthis.actions = [];\n\n\tif ( points ) {\n\n\t\tthis.fromPoints( points );\n\n\t}\n\n};\n\nTHREE.Path.prototype = Object.create( THREE.CurvePath.prototype );\nTHREE.Path.prototype.constructor = THREE.Path;\n\nTHREE.PathActions = {\n\n\tMOVE_TO: 'moveTo',\n\tLINE_TO: 'lineTo',\n\tQUADRATIC_CURVE_TO: 'quadraticCurveTo', // Bezier quadratic curve\n\tBEZIER_CURVE_TO: 'bezierCurveTo', \t\t// Bezier cubic curve\n\tCSPLINE_THRU: 'splineThru',\t\t\t\t// Catmull-Rom spline\n\tARC: 'arc',\t\t\t\t\t\t\t\t// Circle\n\tELLIPSE: 'ellipse'\n};\n\n// TODO Clean up PATH API\n\n// Create path using straight lines to connect all points\n// - vectors: array of Vector2\n\nTHREE.Path.prototype.fromPoints = function ( vectors ) {\n\n\tthis.moveTo( vectors[ 0 ].x, vectors[ 0 ].y );\n\n\tfor ( var v = 1, vlen = vectors.length; v < vlen; v ++ ) {\n\n\t\tthis.lineTo( vectors[ v ].x, vectors[ v ].y );\n\n\t}\n\n};\n\n// startPath() endPath()?\n\nTHREE.Path.prototype.moveTo = function ( x, y ) {\n\n\tvar args = Array.prototype.slice.call( arguments );\n\tthis.actions.push( { action: THREE.PathActions.MOVE_TO, args: args } );\n\n};\n\nTHREE.Path.prototype.lineTo = function ( x, y ) {\n\n\tvar args = Array.prototype.slice.call( arguments );\n\n\tvar lastargs = this.actions[ this.actions.length - 1 ].args;\n\n\tvar x0 = lastargs[ lastargs.length - 2 ];\n\tvar y0 = lastargs[ lastargs.length - 1 ];\n\n\tvar curve = new THREE.LineCurve( new THREE.Vector2( x0, y0 ), new THREE.Vector2( x, y ) );\n\tthis.curves.push( curve );\n\n\tthis.actions.push( { action: THREE.PathActions.LINE_TO, args: args } );\n\n};\n\nTHREE.Path.prototype.quadraticCurveTo = function( aCPx, aCPy, aX, aY ) {\n\n\tvar args = Array.prototype.slice.call( arguments );\n\n\tvar lastargs = this.actions[ this.actions.length - 1 ].args;\n\n\tvar x0 = lastargs[ lastargs.length - 2 ];\n\tvar y0 = lastargs[ lastargs.length - 1 ];\n\n\tvar curve = new THREE.QuadraticBezierCurve( new THREE.Vector2( x0, y0 ),\n\t\t\t\t\t\t\t\t\t\t\t\tnew THREE.Vector2( aCPx, aCPy ),\n\t\t\t\t\t\t\t\t\t\t\t\tnew THREE.Vector2( aX, aY ) );\n\tthis.curves.push( curve );\n\n\tthis.actions.push( { action: THREE.PathActions.QUADRATIC_CURVE_TO, args: args } );\n\n};\n\nTHREE.Path.prototype.bezierCurveTo = function( aCP1x, aCP1y,\n\t\t\t\t\t\t\t\t\t\t\t   aCP2x, aCP2y,\n\t\t\t\t\t\t\t\t\t\t\t   aX, aY ) {\n\n\tvar args = Array.prototype.slice.call( arguments );\n\n\tvar lastargs = this.actions[ this.actions.length - 1 ].args;\n\n\tvar x0 = lastargs[ lastargs.length - 2 ];\n\tvar y0 = lastargs[ lastargs.length - 1 ];\n\n\tvar curve = new THREE.CubicBezierCurve( new THREE.Vector2( x0, y0 ),\n\t\t\t\t\t\t\t\t\t\t\tnew THREE.Vector2( aCP1x, aCP1y ),\n\t\t\t\t\t\t\t\t\t\t\tnew THREE.Vector2( aCP2x, aCP2y ),\n\t\t\t\t\t\t\t\t\t\t\tnew THREE.Vector2( aX, aY ) );\n\tthis.curves.push( curve );\n\n\tthis.actions.push( { action: THREE.PathActions.BEZIER_CURVE_TO, args: args } );\n\n};\n\nTHREE.Path.prototype.splineThru = function( pts /*Array of Vector*/ ) {\n\n\tvar args = Array.prototype.slice.call( arguments );\n\tvar lastargs = this.actions[ this.actions.length - 1 ].args;\n\n\tvar x0 = lastargs[ lastargs.length - 2 ];\n\tvar y0 = lastargs[ lastargs.length - 1 ];\n\t//---\n\tvar npts = [ new THREE.Vector2( x0, y0 ) ];\n\tArray.prototype.push.apply( npts, pts );\n\n\tvar curve = new THREE.SplineCurve( npts );\n\tthis.curves.push( curve );\n\n\tthis.actions.push( { action: THREE.PathActions.CSPLINE_THRU, args: args } );\n\n};\n\n// FUTURE: Change the API or follow canvas API?\n\nTHREE.Path.prototype.arc = function ( aX, aY, aRadius,\n\t\t\t\t\t\t\t\t\t  aStartAngle, aEndAngle, aClockwise ) {\n\n\tvar lastargs = this.actions[ this.actions.length - 1 ].args;\n\tvar x0 = lastargs[ lastargs.length - 2 ];\n\tvar y0 = lastargs[ lastargs.length - 1 ];\n\n\tthis.absarc( aX + x0, aY + y0, aRadius,\n\t\taStartAngle, aEndAngle, aClockwise );\n\n };\n\n THREE.Path.prototype.absarc = function ( aX, aY, aRadius,\n\t\t\t\t\t\t\t\t\t  aStartAngle, aEndAngle, aClockwise ) {\n\n\tthis.absellipse( aX, aY, aRadius, aRadius, aStartAngle, aEndAngle, aClockwise );\n\n };\n\nTHREE.Path.prototype.ellipse = function ( aX, aY, xRadius, yRadius,\n\t\t\t\t\t\t\t\t\t  aStartAngle, aEndAngle, aClockwise, aRotation ) {\n\n\tvar lastargs = this.actions[ this.actions.length - 1 ].args;\n\tvar x0 = lastargs[ lastargs.length - 2 ];\n\tvar y0 = lastargs[ lastargs.length - 1 ];\n\n\tthis.absellipse( aX + x0, aY + y0, xRadius, yRadius,\n\t\taStartAngle, aEndAngle, aClockwise, aRotation );\n\n };\n\n\nTHREE.Path.prototype.absellipse = function ( aX, aY, xRadius, yRadius,\n\t\t\t\t\t\t\t\t\t  aStartAngle, aEndAngle, aClockwise, aRotation ) {\n\n\tvar args = [\n\t\taX, aY,\n\t\txRadius, yRadius,\n\t\taStartAngle, aEndAngle,\n\t\taClockwise,\n\t\taRotation || 0 // aRotation is optional.\n\t];\n\tvar curve = new THREE.EllipseCurve( aX, aY, xRadius, yRadius,\n\t\t\t\t\t\t\t\t\taStartAngle, aEndAngle, aClockwise, aRotation );\n\tthis.curves.push( curve );\n\n\tvar lastPoint = curve.getPoint( 1 );\n\targs.push( lastPoint.x );\n\targs.push( lastPoint.y );\n\n\tthis.actions.push( { action: THREE.PathActions.ELLIPSE, args: args } );\n\n };\n\nTHREE.Path.prototype.getSpacedPoints = function ( divisions, closedPath ) {\n\n\tif ( ! divisions ) divisions = 40;\n\n\tvar points = [];\n\n\tfor ( var i = 0; i < divisions; i ++ ) {\n\n\t\tpoints.push( this.getPoint( i / divisions ) );\n\n\t\t//if( !this.getPoint( i / divisions ) ) throw \"DIE\";\n\n\t}\n\n\t// if ( closedPath ) {\n\t//\n\t// \tpoints.push( points[ 0 ] );\n\t//\n\t// }\n\n\treturn points;\n\n};\n\n/* Return an array of vectors based on contour of the path */\n\nTHREE.Path.prototype.getPoints = function( divisions, closedPath ) {\n\n\tif ( this.useSpacedPoints ) {\n\n\t\treturn this.getSpacedPoints( divisions, closedPath );\n\n\t}\n\n\tdivisions = divisions || 12;\n\n\tvar points = [];\n\n\tvar i, il, item, action, args;\n\tvar cpx, cpy, cpx2, cpy2, cpx1, cpy1, cpx0, cpy0,\n\t\tlaste, j,\n\t\tt, tx, ty;\n\n\tfor ( i = 0, il = this.actions.length; i < il; i ++ ) {\n\n\t\titem = this.actions[ i ];\n\n\t\taction = item.action;\n\t\targs = item.args;\n\n\t\tswitch ( action ) {\n\n\t\tcase THREE.PathActions.MOVE_TO:\n\n\t\t\tpoints.push( new THREE.Vector2( args[ 0 ], args[ 1 ] ) );\n\n\t\t\tbreak;\n\n\t\tcase THREE.PathActions.LINE_TO:\n\n\t\t\tpoints.push( new THREE.Vector2( args[ 0 ], args[ 1 ] ) );\n\n\t\t\tbreak;\n\n\t\tcase THREE.PathActions.QUADRATIC_CURVE_TO:\n\n\t\t\tcpx  = args[ 2 ];\n\t\t\tcpy  = args[ 3 ];\n\n\t\t\tcpx1 = args[ 0 ];\n\t\t\tcpy1 = args[ 1 ];\n\n\t\t\tif ( points.length > 0 ) {\n\n\t\t\t\tlaste = points[ points.length - 1 ];\n\n\t\t\t\tcpx0 = laste.x;\n\t\t\t\tcpy0 = laste.y;\n\n\t\t\t} else {\n\n\t\t\t\tlaste = this.actions[ i - 1 ].args;\n\n\t\t\t\tcpx0 = laste[ laste.length - 2 ];\n\t\t\t\tcpy0 = laste[ laste.length - 1 ];\n\n\t\t\t}\n\n\t\t\tfor ( j = 1; j <= divisions; j ++ ) {\n\n\t\t\t\tt = j / divisions;\n\n\t\t\t\ttx = THREE.Shape.Utils.b2( t, cpx0, cpx1, cpx );\n\t\t\t\tty = THREE.Shape.Utils.b2( t, cpy0, cpy1, cpy );\n\n\t\t\t\tpoints.push( new THREE.Vector2( tx, ty ) );\n\n\t\t\t}\n\n\t\t\tbreak;\n\n\t\tcase THREE.PathActions.BEZIER_CURVE_TO:\n\n\t\t\tcpx  = args[ 4 ];\n\t\t\tcpy  = args[ 5 ];\n\n\t\t\tcpx1 = args[ 0 ];\n\t\t\tcpy1 = args[ 1 ];\n\n\t\t\tcpx2 = args[ 2 ];\n\t\t\tcpy2 = args[ 3 ];\n\n\t\t\tif ( points.length > 0 ) {\n\n\t\t\t\tlaste = points[ points.length - 1 ];\n\n\t\t\t\tcpx0 = laste.x;\n\t\t\t\tcpy0 = laste.y;\n\n\t\t\t} else {\n\n\t\t\t\tlaste = this.actions[ i - 1 ].args;\n\n\t\t\t\tcpx0 = laste[ laste.length - 2 ];\n\t\t\t\tcpy0 = laste[ laste.length - 1 ];\n\n\t\t\t}\n\n\n\t\t\tfor ( j = 1; j <= divisions; j ++ ) {\n\n\t\t\t\tt = j / divisions;\n\n\t\t\t\ttx = THREE.Shape.Utils.b3( t, cpx0, cpx1, cpx2, cpx );\n\t\t\t\tty = THREE.Shape.Utils.b3( t, cpy0, cpy1, cpy2, cpy );\n\n\t\t\t\tpoints.push( new THREE.Vector2( tx, ty ) );\n\n\t\t\t}\n\n\t\t\tbreak;\n\n\t\tcase THREE.PathActions.CSPLINE_THRU:\n\n\t\t\tlaste = this.actions[ i - 1 ].args;\n\n\t\t\tvar last = new THREE.Vector2( laste[ laste.length - 2 ], laste[ laste.length - 1 ] );\n\t\t\tvar spts = [ last ];\n\n\t\t\tvar n = divisions * args[ 0 ].length;\n\n\t\t\tspts = spts.concat( args[ 0 ] );\n\n\t\t\tvar spline = new THREE.SplineCurve( spts );\n\n\t\t\tfor ( j = 1; j <= n; j ++ ) {\n\n\t\t\t\tpoints.push( spline.getPointAt( j / n ) );\n\n\t\t\t}\n\n\t\t\tbreak;\n\n\t\tcase THREE.PathActions.ARC:\n\n\t\t\tvar aX = args[ 0 ], aY = args[ 1 ],\n\t\t\t\taRadius = args[ 2 ],\n\t\t\t\taStartAngle = args[ 3 ], aEndAngle = args[ 4 ],\n\t\t\t\taClockwise = !! args[ 5 ];\n\n\t\t\tvar deltaAngle = aEndAngle - aStartAngle;\n\t\t\tvar angle;\n\t\t\tvar tdivisions = divisions * 2;\n\n\t\t\tfor ( j = 1; j <= tdivisions; j ++ ) {\n\n\t\t\t\tt = j / tdivisions;\n\n\t\t\t\tif ( ! aClockwise ) {\n\n\t\t\t\t\tt = 1 - t;\n\n\t\t\t\t}\n\n\t\t\t\tangle = aStartAngle + t * deltaAngle;\n\n\t\t\t\ttx = aX + aRadius * Math.cos( angle );\n\t\t\t\tty = aY + aRadius * Math.sin( angle );\n\n\t\t\t\t//console.log('t', t, 'angle', angle, 'tx', tx, 'ty', ty);\n\n\t\t\t\tpoints.push( new THREE.Vector2( tx, ty ) );\n\n\t\t\t}\n\n\t\t\t//console.log(points);\n\n\t\t\tbreak;\n\n\t\tcase THREE.PathActions.ELLIPSE:\n\n\t\t\tvar aX = args[ 0 ], aY = args[ 1 ],\n\t\t\t\txRadius = args[ 2 ],\n\t\t\t\tyRadius = args[ 3 ],\n\t\t\t\taStartAngle = args[ 4 ], aEndAngle = args[ 5 ],\n\t\t\t\taClockwise = !! args[ 6 ],\n\t\t\t\taRotation = args[ 7 ];\n\n\n\t\t\tvar deltaAngle = aEndAngle - aStartAngle;\n\t\t\tvar angle;\n\t\t\tvar tdivisions = divisions * 2;\n\n\t\t\tvar cos, sin;\n\t\t\tif ( aRotation !== 0 ) {\n\t\t\n\t\t\t\tcos = Math.cos( aRotation );\n\t\t\t\tsin = Math.sin( aRotation );\n\n\t\t\t}\n\n\t\t\tfor ( j = 1; j <= tdivisions; j ++ ) {\n\n\t\t\t\tt = j / tdivisions;\n\n\t\t\t\tif ( ! aClockwise ) {\n\n\t\t\t\t\tt = 1 - t;\n\n\t\t\t\t}\n\n\t\t\t\tangle = aStartAngle + t * deltaAngle;\n\n\t\t\t\ttx = aX + xRadius * Math.cos( angle );\n\t\t\t\tty = aY + yRadius * Math.sin( angle );\n\n\t\t\t\tif ( aRotation !== 0 ) {\n\n\t\t\t\t\tvar x = tx, y = ty;\n\n\t\t\t\t\t// Rotate the point about the center of the ellipse.\n\t\t\t\t\ttx = ( x - aX ) * cos - ( y - aY ) * sin + aX;\n\t\t\t\t\tty = ( x - aX ) * sin + ( y - aY ) * cos + aY;\n\n\t\t\t\t}\n\n\t\t\t\t//console.log('t', t, 'angle', angle, 'tx', tx, 'ty', ty);\n\n\t\t\t\tpoints.push( new THREE.Vector2( tx, ty ) );\n\n\t\t\t}\n\n\t\t\t//console.log(points);\n\n\t\t\tbreak;\n\n\t\t} // end switch\n\n\t}\n\n\n\n\t// Normalize to remove the closing point by default.\n\tvar lastPoint = points[ points.length - 1 ];\n\tvar EPSILON = 0.0000000001;\n\tif ( Math.abs( lastPoint.x - points[ 0 ].x ) < EPSILON &&\n\t\t\t Math.abs( lastPoint.y - points[ 0 ].y ) < EPSILON )\n\t\tpoints.splice( points.length - 1, 1 );\n\tif ( closedPath ) {\n\n\t\tpoints.push( points[ 0 ] );\n\n\t}\n\n\treturn points;\n\n};\n\n//\n// Breaks path into shapes\n//\n//\tAssumptions (if parameter isCCW==true the opposite holds):\n//\t- solid shapes are defined clockwise (CW)\n//\t- holes are defined counterclockwise (CCW)\n//\n//\tIf parameter noHoles==true:\n//  - all subPaths are regarded as solid shapes\n//  - definition order CW/CCW has no relevance\n//\n\nTHREE.Path.prototype.toShapes = function( isCCW, noHoles ) {\n\n\tfunction extractSubpaths( inActions ) {\n\n\t\tvar i, il, item, action, args;\n\n\t\tvar subPaths = [], lastPath = new THREE.Path();\n\n\t\tfor ( i = 0, il = inActions.length; i < il; i ++ ) {\n\n\t\t\titem = inActions[ i ];\n\n\t\t\targs = item.args;\n\t\t\taction = item.action;\n\n\t\t\tif ( action === THREE.PathActions.MOVE_TO ) {\n\n\t\t\t\tif ( lastPath.actions.length !== 0 ) {\n\n\t\t\t\t\tsubPaths.push( lastPath );\n\t\t\t\t\tlastPath = new THREE.Path();\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tlastPath[ action ].apply( lastPath, args );\n\n\t\t}\n\n\t\tif ( lastPath.actions.length !== 0 ) {\n\n\t\t\tsubPaths.push( lastPath );\n\n\t\t}\n\n\t\t// console.log(subPaths);\n\n\t\treturn\tsubPaths;\n\n\t}\n\n\tfunction toShapesNoHoles( inSubpaths ) {\n\n\t\tvar shapes = [];\n\n\t\tfor ( var i = 0, il = inSubpaths.length; i < il; i ++ ) {\n\n\t\t\tvar tmpPath = inSubpaths[ i ];\n\n\t\t\tvar tmpShape = new THREE.Shape();\n\t\t\ttmpShape.actions = tmpPath.actions;\n\t\t\ttmpShape.curves = tmpPath.curves;\n\n\t\t\tshapes.push( tmpShape );\n\n\t\t}\n\n\t\t//console.log(\"shape\", shapes);\n\n\t\treturn shapes;\n\n\t}\n\n\tfunction isPointInsidePolygon( inPt, inPolygon ) {\n\n\t\tvar EPSILON = 0.0000000001;\n\n\t\tvar polyLen = inPolygon.length;\n\n\t\t// inPt on polygon contour => immediate success    or\n\t\t// toggling of inside/outside at every single! intersection point of an edge\n\t\t//  with the horizontal line through inPt, left of inPt\n\t\t//  not counting lowerY endpoints of edges and whole edges on that line\n\t\tvar inside = false;\n\t\tfor ( var p = polyLen - 1, q = 0; q < polyLen; p = q ++ ) {\n\n\t\t\tvar edgeLowPt  = inPolygon[ p ];\n\t\t\tvar edgeHighPt = inPolygon[ q ];\n\n\t\t\tvar edgeDx = edgeHighPt.x - edgeLowPt.x;\n\t\t\tvar edgeDy = edgeHighPt.y - edgeLowPt.y;\n\n\t\t\tif ( Math.abs( edgeDy ) > EPSILON ) {\n\n\t\t\t\t// not parallel\n\t\t\t\tif ( edgeDy < 0 ) {\n\n\t\t\t\t\tedgeLowPt  = inPolygon[ q ]; edgeDx = - edgeDx;\n\t\t\t\t\tedgeHighPt = inPolygon[ p ]; edgeDy = - edgeDy;\n\n\t\t\t\t}\n\t\t\t\tif ( ( inPt.y < edgeLowPt.y ) || ( inPt.y > edgeHighPt.y ) ) \t\tcontinue;\n\n\t\t\t\tif ( inPt.y === edgeLowPt.y ) {\n\n\t\t\t\t\tif ( inPt.x === edgeLowPt.x )\t\treturn\ttrue;\t\t// inPt is on contour ?\n\t\t\t\t\t// continue;\t\t\t\t// no intersection or edgeLowPt => doesn't count !!!\n\n\t\t\t\t} else {\n\n\t\t\t\t\tvar perpEdge = edgeDy * ( inPt.x - edgeLowPt.x ) - edgeDx * ( inPt.y - edgeLowPt.y );\n\t\t\t\t\tif ( perpEdge === 0 )\t\t\t\treturn\ttrue;\t\t// inPt is on contour ?\n\t\t\t\t\tif ( perpEdge < 0 ) \t\t\t\tcontinue;\n\t\t\t\t\tinside = ! inside;\t\t// true intersection left of inPt\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// parallel or collinear\n\t\t\t\tif ( inPt.y !== edgeLowPt.y ) \t\tcontinue;\t\t\t// parallel\n\t\t\t\t// edge lies on the same horizontal line as inPt\n\t\t\t\tif ( ( ( edgeHighPt.x <= inPt.x ) && ( inPt.x <= edgeLowPt.x ) ) ||\n\t\t\t\t\t ( ( edgeLowPt.x <= inPt.x ) && ( inPt.x <= edgeHighPt.x ) ) )\t\treturn\ttrue;\t// inPt: Point on contour !\n\t\t\t\t// continue;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn\tinside;\n\n\t}\n\n\n\tvar subPaths = extractSubpaths( this.actions );\n\tif ( subPaths.length === 0 ) return [];\n\n\tif ( noHoles === true )\treturn\ttoShapesNoHoles( subPaths );\n\n\n\tvar solid, tmpPath, tmpShape, shapes = [];\n\n\tif ( subPaths.length === 1 ) {\n\n\t\ttmpPath = subPaths[ 0 ];\n\t\ttmpShape = new THREE.Shape();\n\t\ttmpShape.actions = tmpPath.actions;\n\t\ttmpShape.curves = tmpPath.curves;\n\t\tshapes.push( tmpShape );\n\t\treturn shapes;\n\n\t}\n\n\tvar holesFirst = ! THREE.Shape.Utils.isClockWise( subPaths[ 0 ].getPoints() );\n\tholesFirst = isCCW ? ! holesFirst : holesFirst;\n\n\t// console.log(\"Holes first\", holesFirst);\n\n\tvar betterShapeHoles = [];\n\tvar newShapes = [];\n\tvar newShapeHoles = [];\n\tvar mainIdx = 0;\n\tvar tmpPoints;\n\n\tnewShapes[ mainIdx ] = undefined;\n\tnewShapeHoles[ mainIdx ] = [];\n\n\tvar i, il;\n\n\tfor ( i = 0, il = subPaths.length; i < il; i ++ ) {\n\n\t\ttmpPath = subPaths[ i ];\n\t\ttmpPoints = tmpPath.getPoints();\n\t\tsolid = THREE.Shape.Utils.isClockWise( tmpPoints );\n\t\tsolid = isCCW ? ! solid : solid;\n\n\t\tif ( solid ) {\n\n\t\t\tif ( ( ! holesFirst ) && ( newShapes[ mainIdx ] ) )\tmainIdx ++;\n\n\t\t\tnewShapes[ mainIdx ] = { s: new THREE.Shape(), p: tmpPoints };\n\t\t\tnewShapes[ mainIdx ].s.actions = tmpPath.actions;\n\t\t\tnewShapes[ mainIdx ].s.curves = tmpPath.curves;\n\n\t\t\tif ( holesFirst )\tmainIdx ++;\n\t\t\tnewShapeHoles[ mainIdx ] = [];\n\n\t\t\t//console.log('cw', i);\n\n\t\t} else {\n\n\t\t\tnewShapeHoles[ mainIdx ].push( { h: tmpPath, p: tmpPoints[ 0 ] } );\n\n\t\t\t//console.log('ccw', i);\n\n\t\t}\n\n\t}\n\n\t// only Holes? -> probably all Shapes with wrong orientation\n\tif ( ! newShapes[ 0 ] )\treturn\ttoShapesNoHoles( subPaths );\n\n\n\tif ( newShapes.length > 1 ) {\n\n\t\tvar ambiguous = false;\n\t\tvar toChange = [];\n\n\t\tfor ( var sIdx = 0, sLen = newShapes.length; sIdx < sLen; sIdx ++ ) {\n\n\t\t\tbetterShapeHoles[ sIdx ] = [];\n\n\t\t}\n\t\tfor ( var sIdx = 0, sLen = newShapes.length; sIdx < sLen; sIdx ++ ) {\n\n\t\t\tvar sho = newShapeHoles[ sIdx ];\n\t\t\tfor ( var hIdx = 0; hIdx < sho.length; hIdx ++ ) {\n\n\t\t\t\tvar ho = sho[ hIdx ];\n\t\t\t\tvar hole_unassigned = true;\n\t\t\t\tfor ( var s2Idx = 0; s2Idx < newShapes.length; s2Idx ++ ) {\n\n\t\t\t\t\tif ( isPointInsidePolygon( ho.p, newShapes[ s2Idx ].p ) ) {\n\n\t\t\t\t\t\tif ( sIdx !== s2Idx )\ttoChange.push( { froms: sIdx, tos: s2Idx, hole: hIdx } );\n\t\t\t\t\t\tif ( hole_unassigned ) {\n\n\t\t\t\t\t\t\thole_unassigned = false;\n\t\t\t\t\t\t\tbetterShapeHoles[ s2Idx ].push( ho );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tambiguous = true;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\tif ( hole_unassigned ) {\n\n\t\t\t\t\tbetterShapeHoles[ sIdx ].push( ho );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\t\t// console.log(\"ambiguous: \", ambiguous);\n\t\tif ( toChange.length > 0 ) {\n\n\t\t\t// console.log(\"to change: \", toChange);\n\t\t\tif ( ! ambiguous )\tnewShapeHoles = betterShapeHoles;\n\n\t\t}\n\n\t}\n\n\tvar tmpHoles, j, jl;\n\tfor ( i = 0, il = newShapes.length; i < il; i ++ ) {\n\n\t\ttmpShape = newShapes[ i ].s;\n\t\tshapes.push( tmpShape );\n\t\ttmpHoles = newShapeHoles[ i ];\n\t\tfor ( j = 0, jl = tmpHoles.length; j < jl; j ++ ) {\n\n\t\t\ttmpShape.holes.push( tmpHoles[ j ].h );\n\n\t\t}\n\n\t}\n\n\t//console.log(\"shape\", shapes);\n\n\treturn shapes;\n\n};\n\n// File:src/extras/core/Shape.js\n\n/**\n * @author zz85 / http://www.lab4games.net/zz85/blog\n * Defines a 2d shape plane using paths.\n **/\n\n// STEP 1 Create a path.\n// STEP 2 Turn path into shape.\n// STEP 3 ExtrudeGeometry takes in Shape/Shapes\n// STEP 3a - Extract points from each shape, turn to vertices\n// STEP 3b - Triangulate each shape, add faces.\n\nTHREE.Shape = function () {\n\n\tTHREE.Path.apply( this, arguments );\n\tthis.holes = [];\n\n};\n\nTHREE.Shape.prototype = Object.create( THREE.Path.prototype );\nTHREE.Shape.prototype.constructor = THREE.Shape;\n\n// Convenience method to return ExtrudeGeometry\n\nTHREE.Shape.prototype.extrude = function ( options ) {\n\n\tvar extruded = new THREE.ExtrudeGeometry( this, options );\n\treturn extruded;\n\n};\n\n// Convenience method to return ShapeGeometry\n\nTHREE.Shape.prototype.makeGeometry = function ( options ) {\n\n\tvar geometry = new THREE.ShapeGeometry( this, options );\n\treturn geometry;\n\n};\n\n// Get points of holes\n\nTHREE.Shape.prototype.getPointsHoles = function ( divisions ) {\n\n\tvar i, il = this.holes.length, holesPts = [];\n\n\tfor ( i = 0; i < il; i ++ ) {\n\n\t\tholesPts[ i ] = this.holes[ i ].getTransformedPoints( divisions, this.bends );\n\n\t}\n\n\treturn holesPts;\n\n};\n\n// Get points of holes (spaced by regular distance)\n\nTHREE.Shape.prototype.getSpacedPointsHoles = function ( divisions ) {\n\n\tvar i, il = this.holes.length, holesPts = [];\n\n\tfor ( i = 0; i < il; i ++ ) {\n\n\t\tholesPts[ i ] = this.holes[ i ].getTransformedSpacedPoints( divisions, this.bends );\n\n\t}\n\n\treturn holesPts;\n\n};\n\n\n// Get points of shape and holes (keypoints based on segments parameter)\n\nTHREE.Shape.prototype.extractAllPoints = function ( divisions ) {\n\n\treturn {\n\n\t\tshape: this.getTransformedPoints( divisions ),\n\t\tholes: this.getPointsHoles( divisions )\n\n\t};\n\n};\n\nTHREE.Shape.prototype.extractPoints = function ( divisions ) {\n\n\tif ( this.useSpacedPoints ) {\n\n\t\treturn this.extractAllSpacedPoints( divisions );\n\n\t}\n\n\treturn this.extractAllPoints( divisions );\n\n};\n\n//\n// THREE.Shape.prototype.extractAllPointsWithBend = function ( divisions, bend ) {\n//\n// \treturn {\n//\n// \t\tshape: this.transform( bend, divisions ),\n// \t\tholes: this.getPointsHoles( divisions, bend )\n//\n// \t};\n//\n// };\n\n// Get points of shape and holes (spaced by regular distance)\n\nTHREE.Shape.prototype.extractAllSpacedPoints = function ( divisions ) {\n\n\treturn {\n\n\t\tshape: this.getTransformedSpacedPoints( divisions ),\n\t\tholes: this.getSpacedPointsHoles( divisions )\n\n\t};\n\n};\n\n/**************************************************************\n *\tUtils\n **************************************************************/\n\nTHREE.Shape.Utils = {\n\n\ttriangulateShape: function ( contour, holes ) {\n\n\t\tfunction point_in_segment_2D_colin( inSegPt1, inSegPt2, inOtherPt ) {\n\n\t\t\t// inOtherPt needs to be collinear to the inSegment\n\t\t\tif ( inSegPt1.x !== inSegPt2.x ) {\n\n\t\t\t\tif ( inSegPt1.x < inSegPt2.x ) {\n\n\t\t\t\t\treturn\t( ( inSegPt1.x <= inOtherPt.x ) && ( inOtherPt.x <= inSegPt2.x ) );\n\n\t\t\t\t} else {\n\n\t\t\t\t\treturn\t( ( inSegPt2.x <= inOtherPt.x ) && ( inOtherPt.x <= inSegPt1.x ) );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tif ( inSegPt1.y < inSegPt2.y ) {\n\n\t\t\t\t\treturn\t( ( inSegPt1.y <= inOtherPt.y ) && ( inOtherPt.y <= inSegPt2.y ) );\n\n\t\t\t\t} else {\n\n\t\t\t\t\treturn\t( ( inSegPt2.y <= inOtherPt.y ) && ( inOtherPt.y <= inSegPt1.y ) );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction intersect_segments_2D( inSeg1Pt1, inSeg1Pt2, inSeg2Pt1, inSeg2Pt2, inExcludeAdjacentSegs ) {\n\n\t\t\tvar EPSILON = 0.0000000001;\n\n\t\t\tvar seg1dx = inSeg1Pt2.x - inSeg1Pt1.x,   seg1dy = inSeg1Pt2.y - inSeg1Pt1.y;\n\t\t\tvar seg2dx = inSeg2Pt2.x - inSeg2Pt1.x,   seg2dy = inSeg2Pt2.y - inSeg2Pt1.y;\n\n\t\t\tvar seg1seg2dx = inSeg1Pt1.x - inSeg2Pt1.x;\n\t\t\tvar seg1seg2dy = inSeg1Pt1.y - inSeg2Pt1.y;\n\n\t\t\tvar limit\t\t= seg1dy * seg2dx - seg1dx * seg2dy;\n\t\t\tvar perpSeg1\t= seg1dy * seg1seg2dx - seg1dx * seg1seg2dy;\n\n\t\t\tif ( Math.abs( limit ) > EPSILON ) {\n\n\t\t\t\t// not parallel\n\n\t\t\t\tvar perpSeg2;\n\t\t\t\tif ( limit > 0 ) {\n\n\t\t\t\t\tif ( ( perpSeg1 < 0 ) || ( perpSeg1 > limit ) ) \t\treturn [];\n\t\t\t\t\tperpSeg2 = seg2dy * seg1seg2dx - seg2dx * seg1seg2dy;\n\t\t\t\t\tif ( ( perpSeg2 < 0 ) || ( perpSeg2 > limit ) ) \t\treturn [];\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( ( perpSeg1 > 0 ) || ( perpSeg1 < limit ) ) \t\treturn [];\n\t\t\t\t\tperpSeg2 = seg2dy * seg1seg2dx - seg2dx * seg1seg2dy;\n\t\t\t\t\tif ( ( perpSeg2 > 0 ) || ( perpSeg2 < limit ) ) \t\treturn [];\n\n\t\t\t\t}\n\n\t\t\t\t// i.e. to reduce rounding errors\n\t\t\t\t// intersection at endpoint of segment#1?\n\t\t\t\tif ( perpSeg2 === 0 ) {\n\n\t\t\t\t\tif ( ( inExcludeAdjacentSegs ) &&\n\t\t\t\t\t\t ( ( perpSeg1 === 0 ) || ( perpSeg1 === limit ) ) )\t\treturn [];\n\t\t\t\t\treturn [ inSeg1Pt1 ];\n\n\t\t\t\t}\n\t\t\t\tif ( perpSeg2 === limit ) {\n\n\t\t\t\t\tif ( ( inExcludeAdjacentSegs ) &&\n\t\t\t\t\t\t ( ( perpSeg1 === 0 ) || ( perpSeg1 === limit ) ) )\t\treturn [];\n\t\t\t\t\treturn [ inSeg1Pt2 ];\n\n\t\t\t\t}\n\t\t\t\t// intersection at endpoint of segment#2?\n\t\t\t\tif ( perpSeg1 === 0 )\t\treturn [ inSeg2Pt1 ];\n\t\t\t\tif ( perpSeg1 === limit )\treturn [ inSeg2Pt2 ];\n\n\t\t\t\t// return real intersection point\n\t\t\t\tvar factorSeg1 = perpSeg2 / limit;\n\t\t\t\treturn\t[ { x: inSeg1Pt1.x + factorSeg1 * seg1dx,\n\t\t\t\t\t\t\ty: inSeg1Pt1.y + factorSeg1 * seg1dy } ];\n\n\t\t\t} else {\n\n\t\t\t\t// parallel or collinear\n\t\t\t\tif ( ( perpSeg1 !== 0 ) ||\n\t\t\t\t\t ( seg2dy * seg1seg2dx !== seg2dx * seg1seg2dy ) ) \t\t\treturn [];\n\n\t\t\t\t// they are collinear or degenerate\n\t\t\t\tvar seg1Pt = ( ( seg1dx === 0 ) && ( seg1dy === 0 ) );\t// segment1 is just a point?\n\t\t\t\tvar seg2Pt = ( ( seg2dx === 0 ) && ( seg2dy === 0 ) );\t// segment2 is just a point?\n\t\t\t\t// both segments are points\n\t\t\t\tif ( seg1Pt && seg2Pt ) {\n\n\t\t\t\t\tif ( ( inSeg1Pt1.x !== inSeg2Pt1.x ) ||\n\t\t\t\t\t\t ( inSeg1Pt1.y !== inSeg2Pt1.y ) )\t\treturn [];\t// they are distinct  points\n\t\t\t\t\treturn [ inSeg1Pt1 ];                 \t\t\t\t\t\t// they are the same point\n\n\t\t\t\t}\n\t\t\t\t// segment#1  is a single point\n\t\t\t\tif ( seg1Pt ) {\n\n\t\t\t\t\tif ( ! point_in_segment_2D_colin( inSeg2Pt1, inSeg2Pt2, inSeg1Pt1 ) )\t\treturn [];\t\t// but not in segment#2\n\t\t\t\t\treturn [ inSeg1Pt1 ];\n\n\t\t\t\t}\n\t\t\t\t// segment#2  is a single point\n\t\t\t\tif ( seg2Pt ) {\n\n\t\t\t\t\tif ( ! point_in_segment_2D_colin( inSeg1Pt1, inSeg1Pt2, inSeg2Pt1 ) )\t\treturn [];\t\t// but not in segment#1\n\t\t\t\t\treturn [ inSeg2Pt1 ];\n\n\t\t\t\t}\n\n\t\t\t\t// they are collinear segments, which might overlap\n\t\t\t\tvar seg1min, seg1max, seg1minVal, seg1maxVal;\n\t\t\t\tvar seg2min, seg2max, seg2minVal, seg2maxVal;\n\t\t\t\tif ( seg1dx !== 0 ) {\n\n\t\t\t\t\t// the segments are NOT on a vertical line\n\t\t\t\t\tif ( inSeg1Pt1.x < inSeg1Pt2.x ) {\n\n\t\t\t\t\t\tseg1min = inSeg1Pt1; seg1minVal = inSeg1Pt1.x;\n\t\t\t\t\t\tseg1max = inSeg1Pt2; seg1maxVal = inSeg1Pt2.x;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tseg1min = inSeg1Pt2; seg1minVal = inSeg1Pt2.x;\n\t\t\t\t\t\tseg1max = inSeg1Pt1; seg1maxVal = inSeg1Pt1.x;\n\n\t\t\t\t\t}\n\t\t\t\t\tif ( inSeg2Pt1.x < inSeg2Pt2.x ) {\n\n\t\t\t\t\t\tseg2min = inSeg2Pt1; seg2minVal = inSeg2Pt1.x;\n\t\t\t\t\t\tseg2max = inSeg2Pt2; seg2maxVal = inSeg2Pt2.x;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tseg2min = inSeg2Pt2; seg2minVal = inSeg2Pt2.x;\n\t\t\t\t\t\tseg2max = inSeg2Pt1; seg2maxVal = inSeg2Pt1.x;\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// the segments are on a vertical line\n\t\t\t\t\tif ( inSeg1Pt1.y < inSeg1Pt2.y ) {\n\n\t\t\t\t\t\tseg1min = inSeg1Pt1; seg1minVal = inSeg1Pt1.y;\n\t\t\t\t\t\tseg1max = inSeg1Pt2; seg1maxVal = inSeg1Pt2.y;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tseg1min = inSeg1Pt2; seg1minVal = inSeg1Pt2.y;\n\t\t\t\t\t\tseg1max = inSeg1Pt1; seg1maxVal = inSeg1Pt1.y;\n\n\t\t\t\t\t}\n\t\t\t\t\tif ( inSeg2Pt1.y < inSeg2Pt2.y ) {\n\n\t\t\t\t\t\tseg2min = inSeg2Pt1; seg2minVal = inSeg2Pt1.y;\n\t\t\t\t\t\tseg2max = inSeg2Pt2; seg2maxVal = inSeg2Pt2.y;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tseg2min = inSeg2Pt2; seg2minVal = inSeg2Pt2.y;\n\t\t\t\t\t\tseg2max = inSeg2Pt1; seg2maxVal = inSeg2Pt1.y;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\tif ( seg1minVal <= seg2minVal ) {\n\n\t\t\t\t\tif ( seg1maxVal <  seg2minVal )\treturn [];\n\t\t\t\t\tif ( seg1maxVal === seg2minVal )\t{\n\n\t\t\t\t\t\tif ( inExcludeAdjacentSegs )\t\treturn [];\n\t\t\t\t\t\treturn [ seg2min ];\n\n\t\t\t\t\t}\n\t\t\t\t\tif ( seg1maxVal <= seg2maxVal )\treturn [ seg2min, seg1max ];\n\t\t\t\t\treturn\t[ seg2min, seg2max ];\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( seg1minVal >  seg2maxVal )\treturn [];\n\t\t\t\t\tif ( seg1minVal === seg2maxVal )\t{\n\n\t\t\t\t\t\tif ( inExcludeAdjacentSegs )\t\treturn [];\n\t\t\t\t\t\treturn [ seg1min ];\n\n\t\t\t\t\t}\n\t\t\t\t\tif ( seg1maxVal <= seg2maxVal )\treturn [ seg1min, seg1max ];\n\t\t\t\t\treturn\t[ seg1min, seg2max ];\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction isPointInsideAngle( inVertex, inLegFromPt, inLegToPt, inOtherPt ) {\n\n\t\t\t// The order of legs is important\n\n\t\t\tvar EPSILON = 0.0000000001;\n\n\t\t\t// translation of all points, so that Vertex is at (0,0)\n\t\t\tvar legFromPtX\t= inLegFromPt.x - inVertex.x,  legFromPtY\t= inLegFromPt.y - inVertex.y;\n\t\t\tvar legToPtX\t= inLegToPt.x\t- inVertex.x,  legToPtY\t\t= inLegToPt.y\t- inVertex.y;\n\t\t\tvar otherPtX\t= inOtherPt.x\t- inVertex.x,  otherPtY\t\t= inOtherPt.y\t- inVertex.y;\n\n\t\t\t// main angle >0: < 180 deg.; 0: 180 deg.; <0: > 180 deg.\n\t\t\tvar from2toAngle\t= legFromPtX * legToPtY - legFromPtY * legToPtX;\n\t\t\tvar from2otherAngle\t= legFromPtX * otherPtY - legFromPtY * otherPtX;\n\n\t\t\tif ( Math.abs( from2toAngle ) > EPSILON ) {\n\n\t\t\t\t// angle != 180 deg.\n\n\t\t\t\tvar other2toAngle\t\t= otherPtX * legToPtY - otherPtY * legToPtX;\n\t\t\t\t// console.log( \"from2to: \" + from2toAngle + \", from2other: \" + from2otherAngle + \", other2to: \" + other2toAngle );\n\n\t\t\t\tif ( from2toAngle > 0 ) {\n\n\t\t\t\t\t// main angle < 180 deg.\n\t\t\t\t\treturn\t( ( from2otherAngle >= 0 ) && ( other2toAngle >= 0 ) );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// main angle > 180 deg.\n\t\t\t\t\treturn\t( ( from2otherAngle >= 0 ) || ( other2toAngle >= 0 ) );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// angle == 180 deg.\n\t\t\t\t// console.log( \"from2to: 180 deg., from2other: \" + from2otherAngle  );\n\t\t\t\treturn\t( from2otherAngle > 0 );\n\n\t\t\t}\n\n\t\t}\n\n\n\t\tfunction removeHoles( contour, holes ) {\n\n\t\t\tvar shape = contour.concat(); // work on this shape\n\t\t\tvar hole;\n\n\t\t\tfunction isCutLineInsideAngles( inShapeIdx, inHoleIdx ) {\n\n\t\t\t\t// Check if hole point lies within angle around shape point\n\t\t\t\tvar lastShapeIdx = shape.length - 1;\n\n\t\t\t\tvar prevShapeIdx = inShapeIdx - 1;\n\t\t\t\tif ( prevShapeIdx < 0 )\t\t\tprevShapeIdx = lastShapeIdx;\n\n\t\t\t\tvar nextShapeIdx = inShapeIdx + 1;\n\t\t\t\tif ( nextShapeIdx > lastShapeIdx )\tnextShapeIdx = 0;\n\n\t\t\t\tvar insideAngle = isPointInsideAngle( shape[ inShapeIdx ], shape[ prevShapeIdx ], shape[ nextShapeIdx ], hole[ inHoleIdx ] );\n\t\t\t\tif ( ! insideAngle ) {\n\n\t\t\t\t\t// console.log( \"Vertex (Shape): \" + inShapeIdx + \", Point: \" + hole[inHoleIdx].x + \"/\" + hole[inHoleIdx].y );\n\t\t\t\t\treturn\tfalse;\n\n\t\t\t\t}\n\n\t\t\t\t// Check if shape point lies within angle around hole point\n\t\t\t\tvar lastHoleIdx = hole.length - 1;\n\n\t\t\t\tvar prevHoleIdx = inHoleIdx - 1;\n\t\t\t\tif ( prevHoleIdx < 0 )\t\t\tprevHoleIdx = lastHoleIdx;\n\n\t\t\t\tvar nextHoleIdx = inHoleIdx + 1;\n\t\t\t\tif ( nextHoleIdx > lastHoleIdx )\tnextHoleIdx = 0;\n\n\t\t\t\tinsideAngle = isPointInsideAngle( hole[ inHoleIdx ], hole[ prevHoleIdx ], hole[ nextHoleIdx ], shape[ inShapeIdx ] );\n\t\t\t\tif ( ! insideAngle ) {\n\n\t\t\t\t\t// console.log( \"Vertex (Hole): \" + inHoleIdx + \", Point: \" + shape[inShapeIdx].x + \"/\" + shape[inShapeIdx].y );\n\t\t\t\t\treturn\tfalse;\n\n\t\t\t\t}\n\n\t\t\t\treturn\ttrue;\n\n\t\t\t}\n\n\t\t\tfunction intersectsShapeEdge( inShapePt, inHolePt ) {\n\n\t\t\t\t// checks for intersections with shape edges\n\t\t\t\tvar sIdx, nextIdx, intersection;\n\t\t\t\tfor ( sIdx = 0; sIdx < shape.length; sIdx ++ ) {\n\n\t\t\t\t\tnextIdx = sIdx + 1; nextIdx %= shape.length;\n\t\t\t\t\tintersection = intersect_segments_2D( inShapePt, inHolePt, shape[ sIdx ], shape[ nextIdx ], true );\n\t\t\t\t\tif ( intersection.length > 0 )\t\treturn\ttrue;\n\n\t\t\t\t}\n\n\t\t\t\treturn\tfalse;\n\n\t\t\t}\n\n\t\t\tvar indepHoles = [];\n\n\t\t\tfunction intersectsHoleEdge( inShapePt, inHolePt ) {\n\n\t\t\t\t// checks for intersections with hole edges\n\t\t\t\tvar ihIdx, chkHole,\n\t\t\t\t\thIdx, nextIdx, intersection;\n\t\t\t\tfor ( ihIdx = 0; ihIdx < indepHoles.length; ihIdx ++ ) {\n\n\t\t\t\t\tchkHole = holes[ indepHoles[ ihIdx ]];\n\t\t\t\t\tfor ( hIdx = 0; hIdx < chkHole.length; hIdx ++ ) {\n\n\t\t\t\t\t\tnextIdx = hIdx + 1; nextIdx %= chkHole.length;\n\t\t\t\t\t\tintersection = intersect_segments_2D( inShapePt, inHolePt, chkHole[ hIdx ], chkHole[ nextIdx ], true );\n\t\t\t\t\t\tif ( intersection.length > 0 )\t\treturn\ttrue;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\treturn\tfalse;\n\n\t\t\t}\n\n\t\t\tvar holeIndex, shapeIndex,\n\t\t\t\tshapePt, holePt,\n\t\t\t\tholeIdx, cutKey, failedCuts = [],\n\t\t\t\ttmpShape1, tmpShape2,\n\t\t\t\ttmpHole1, tmpHole2;\n\n\t\t\tfor ( var h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\t\tindepHoles.push( h );\n\n\t\t\t}\n\n\t\t\tvar minShapeIndex = 0;\n\t\t\tvar counter = indepHoles.length * 2;\n\t\t\twhile ( indepHoles.length > 0 ) {\n\n\t\t\t\tcounter --;\n\t\t\t\tif ( counter < 0 ) {\n\n\t\t\t\t\tconsole.log( \"Infinite Loop! Holes left:\" + indepHoles.length + \", Probably Hole outside Shape!\" );\n\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t\t// search for shape-vertex and hole-vertex,\n\t\t\t\t// which can be connected without intersections\n\t\t\t\tfor ( shapeIndex = minShapeIndex; shapeIndex < shape.length; shapeIndex ++ ) {\n\n\t\t\t\t\tshapePt = shape[ shapeIndex ];\n\t\t\t\t\tholeIndex\t= - 1;\n\n\t\t\t\t\t// search for hole which can be reached without intersections\n\t\t\t\t\tfor ( var h = 0; h < indepHoles.length; h ++ ) {\n\n\t\t\t\t\t\tholeIdx = indepHoles[ h ];\n\n\t\t\t\t\t\t// prevent multiple checks\n\t\t\t\t\t\tcutKey = shapePt.x + \":\" + shapePt.y + \":\" + holeIdx;\n\t\t\t\t\t\tif ( failedCuts[ cutKey ] !== undefined )\t\t\tcontinue;\n\n\t\t\t\t\t\thole = holes[ holeIdx ];\n\t\t\t\t\t\tfor ( var h2 = 0; h2 < hole.length; h2 ++ ) {\n\n\t\t\t\t\t\t\tholePt = hole[ h2 ];\n\t\t\t\t\t\t\tif ( ! isCutLineInsideAngles( shapeIndex, h2 ) )\t\tcontinue;\n\t\t\t\t\t\t\tif ( intersectsShapeEdge( shapePt, holePt ) )\t\tcontinue;\n\t\t\t\t\t\t\tif ( intersectsHoleEdge( shapePt, holePt ) )\t\tcontinue;\n\n\t\t\t\t\t\t\tholeIndex = h2;\n\t\t\t\t\t\t\tindepHoles.splice( h, 1 );\n\n\t\t\t\t\t\t\ttmpShape1 = shape.slice( 0, shapeIndex + 1 );\n\t\t\t\t\t\t\ttmpShape2 = shape.slice( shapeIndex );\n\t\t\t\t\t\t\ttmpHole1 = hole.slice( holeIndex );\n\t\t\t\t\t\t\ttmpHole2 = hole.slice( 0, holeIndex + 1 );\n\n\t\t\t\t\t\t\tshape = tmpShape1.concat( tmpHole1 ).concat( tmpHole2 ).concat( tmpShape2 );\n\n\t\t\t\t\t\t\tminShapeIndex = shapeIndex;\n\n\t\t\t\t\t\t\t// Debug only, to show the selected cuts\n\t\t\t\t\t\t\t// glob_CutLines.push( [ shapePt, holePt ] );\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ( holeIndex >= 0 )\tbreak;\t\t// hole-vertex found\n\n\t\t\t\t\t\tfailedCuts[ cutKey ] = true;\t\t\t// remember failure\n\n\t\t\t\t\t}\n\t\t\t\t\tif ( holeIndex >= 0 )\tbreak;\t\t// hole-vertex found\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn shape; \t\t\t/* shape with no holes */\n\n\t\t}\n\n\n\t\tvar i, il, f, face,\n\t\t\tkey, index,\n\t\t\tallPointsMap = {};\n\n\t\t// To maintain reference to old shape, one must match coordinates, or offset the indices from original arrays. It's probably easier to do the first.\n\n\t\tvar allpoints = contour.concat();\n\n\t\tfor ( var h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\tArray.prototype.push.apply( allpoints, holes[ h ] );\n\n\t\t}\n\n\t\t//console.log( \"allpoints\",allpoints, allpoints.length );\n\n\t\t// prepare all points map\n\n\t\tfor ( i = 0, il = allpoints.length; i < il; i ++ ) {\n\n\t\t\tkey = allpoints[ i ].x + \":\" + allpoints[ i ].y;\n\n\t\t\tif ( allPointsMap[ key ] !== undefined ) {\n\n\t\t\t\tconsole.warn( \"THREE.Shape: Duplicate point\", key );\n\n\t\t\t}\n\n\t\t\tallPointsMap[ key ] = i;\n\n\t\t}\n\n\t\t// remove holes by cutting paths to holes and adding them to the shape\n\t\tvar shapeWithoutHoles = removeHoles( contour, holes );\n\n\t\tvar triangles = THREE.FontUtils.Triangulate( shapeWithoutHoles, false ); // True returns indices for points of spooled shape\n\t\t//console.log( \"triangles\",triangles, triangles.length );\n\n\t\t// check all face vertices against all points map\n\n\t\tfor ( i = 0, il = triangles.length; i < il; i ++ ) {\n\n\t\t\tface = triangles[ i ];\n\n\t\t\tfor ( f = 0; f < 3; f ++ ) {\n\n\t\t\t\tkey = face[ f ].x + \":\" + face[ f ].y;\n\n\t\t\t\tindex = allPointsMap[ key ];\n\n\t\t\t\tif ( index !== undefined ) {\n\n\t\t\t\t\tface[ f ] = index;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn triangles.concat();\n\n\t},\n\n\tisClockWise: function ( pts ) {\n\n\t\treturn THREE.FontUtils.Triangulate.area( pts ) < 0;\n\n\t},\n\n\t// Bezier Curves formulas obtained from\n\t// http://en.wikipedia.org/wiki/B%C3%A9zier_curve\n\n\t// Quad Bezier Functions\n\n\tb2p0: function ( t, p ) {\n\n\t\tvar k = 1 - t;\n\t\treturn k * k * p;\n\n\t},\n\n\tb2p1: function ( t, p ) {\n\n\t\treturn 2 * ( 1 - t ) * t * p;\n\n\t},\n\n\tb2p2: function ( t, p ) {\n\n\t\treturn t * t * p;\n\n\t},\n\n\tb2: function ( t, p0, p1, p2 ) {\n\n\t\treturn this.b2p0( t, p0 ) + this.b2p1( t, p1 ) + this.b2p2( t, p2 );\n\n\t},\n\n\t// Cubic Bezier Functions\n\n\tb3p0: function ( t, p ) {\n\n\t\tvar k = 1 - t;\n\t\treturn k * k * k * p;\n\n\t},\n\n\tb3p1: function ( t, p ) {\n\n\t\tvar k = 1 - t;\n\t\treturn 3 * k * k * t * p;\n\n\t},\n\n\tb3p2: function ( t, p ) {\n\n\t\tvar k = 1 - t;\n\t\treturn 3 * k * t * t * p;\n\n\t},\n\n\tb3p3: function ( t, p ) {\n\n\t\treturn t * t * t * p;\n\n\t},\n\n\tb3: function ( t, p0, p1, p2, p3 ) {\n\n\t\treturn this.b3p0( t, p0 ) + this.b3p1( t, p1 ) + this.b3p2( t, p2 ) +  this.b3p3( t, p3 );\n\n\t}\n\n};\n\n// File:src/extras/curves/LineCurve.js\n\n/**************************************************************\n *\tLine\n **************************************************************/\n\nTHREE.LineCurve = function ( v1, v2 ) {\n\n\tthis.v1 = v1;\n\tthis.v2 = v2;\n\n};\n\nTHREE.LineCurve.prototype = Object.create( THREE.Curve.prototype );\nTHREE.LineCurve.prototype.constructor = THREE.LineCurve;\n\nTHREE.LineCurve.prototype.getPoint = function ( t ) {\n\n\tvar point = this.v2.clone().sub( this.v1 );\n\tpoint.multiplyScalar( t ).add( this.v1 );\n\n\treturn point;\n\n};\n\n// Line curve is linear, so we can overwrite default getPointAt\n\nTHREE.LineCurve.prototype.getPointAt = function ( u ) {\n\n\treturn this.getPoint( u );\n\n};\n\nTHREE.LineCurve.prototype.getTangent = function( t ) {\n\n\tvar tangent = this.v2.clone().sub( this.v1 );\n\n\treturn tangent.normalize();\n\n};\n\n// File:src/extras/curves/QuadraticBezierCurve.js\n\n/**************************************************************\n *\tQuadratic Bezier curve\n **************************************************************/\n\n\nTHREE.QuadraticBezierCurve = function ( v0, v1, v2 ) {\n\n\tthis.v0 = v0;\n\tthis.v1 = v1;\n\tthis.v2 = v2;\n\n};\n\nTHREE.QuadraticBezierCurve.prototype = Object.create( THREE.Curve.prototype );\nTHREE.QuadraticBezierCurve.prototype.constructor = THREE.QuadraticBezierCurve;\n\n\nTHREE.QuadraticBezierCurve.prototype.getPoint = function ( t ) {\n\n\tvar vector = new THREE.Vector2();\n\n\tvector.x = THREE.Shape.Utils.b2( t, this.v0.x, this.v1.x, this.v2.x );\n\tvector.y = THREE.Shape.Utils.b2( t, this.v0.y, this.v1.y, this.v2.y );\n\n\treturn vector;\n\n};\n\n\nTHREE.QuadraticBezierCurve.prototype.getTangent = function( t ) {\n\n\tvar vector = new THREE.Vector2();\n\n\tvector.x = THREE.Curve.Utils.tangentQuadraticBezier( t, this.v0.x, this.v1.x, this.v2.x );\n\tvector.y = THREE.Curve.Utils.tangentQuadraticBezier( t, this.v0.y, this.v1.y, this.v2.y );\n\n\t// returns unit vector\n\n\treturn vector.normalize();\n\n};\n\n// File:src/extras/curves/CubicBezierCurve.js\n\n/**************************************************************\n *\tCubic Bezier curve\n **************************************************************/\n\nTHREE.CubicBezierCurve = function ( v0, v1, v2, v3 ) {\n\n\tthis.v0 = v0;\n\tthis.v1 = v1;\n\tthis.v2 = v2;\n\tthis.v3 = v3;\n\n};\n\nTHREE.CubicBezierCurve.prototype = Object.create( THREE.Curve.prototype );\nTHREE.CubicBezierCurve.prototype.constructor = THREE.CubicBezierCurve;\n\nTHREE.CubicBezierCurve.prototype.getPoint = function ( t ) {\n\n\tvar tx, ty;\n\n\ttx = THREE.Shape.Utils.b3( t, this.v0.x, this.v1.x, this.v2.x, this.v3.x );\n\tty = THREE.Shape.Utils.b3( t, this.v0.y, this.v1.y, this.v2.y, this.v3.y );\n\n\treturn new THREE.Vector2( tx, ty );\n\n};\n\nTHREE.CubicBezierCurve.prototype.getTangent = function( t ) {\n\n\tvar tx, ty;\n\n\ttx = THREE.Curve.Utils.tangentCubicBezier( t, this.v0.x, this.v1.x, this.v2.x, this.v3.x );\n\tty = THREE.Curve.Utils.tangentCubicBezier( t, this.v0.y, this.v1.y, this.v2.y, this.v3.y );\n\n\tvar tangent = new THREE.Vector2( tx, ty );\n\ttangent.normalize();\n\n\treturn tangent;\n\n};\n\n// File:src/extras/curves/SplineCurve.js\n\n/**************************************************************\n *\tSpline curve\n **************************************************************/\n\nTHREE.SplineCurve = function ( points /* array of Vector2 */ ) {\n\n\tthis.points = ( points == undefined ) ? [] : points;\n\n};\n\nTHREE.SplineCurve.prototype = Object.create( THREE.Curve.prototype );\nTHREE.SplineCurve.prototype.constructor = THREE.SplineCurve;\n\nTHREE.SplineCurve.prototype.getPoint = function ( t ) {\n\n\tvar points = this.points;\n\tvar point = ( points.length - 1 ) * t;\n\n\tvar intPoint = Math.floor( point );\n\tvar weight = point - intPoint;\n\n\tvar point0 = points[ intPoint === 0 ? intPoint : intPoint - 1 ];\n\tvar point1 = points[ intPoint ];\n\tvar point2 = points[ intPoint > points.length - 2 ? points.length - 1 : intPoint + 1 ];\n\tvar point3 = points[ intPoint > points.length - 3 ? points.length - 1 : intPoint + 2 ];\n\n\tvar vector = new THREE.Vector2();\n\n\tvector.x = THREE.Curve.Utils.interpolate( point0.x, point1.x, point2.x, point3.x, weight );\n\tvector.y = THREE.Curve.Utils.interpolate( point0.y, point1.y, point2.y, point3.y, weight );\n\n\treturn vector;\n\n};\n\n// File:src/extras/curves/EllipseCurve.js\n\n/**************************************************************\n *\tEllipse curve\n **************************************************************/\n\nTHREE.EllipseCurve = function ( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation ) {\n\n\tthis.aX = aX;\n\tthis.aY = aY;\n\n\tthis.xRadius = xRadius;\n\tthis.yRadius = yRadius;\n\n\tthis.aStartAngle = aStartAngle;\n\tthis.aEndAngle = aEndAngle;\n\n\tthis.aClockwise = aClockwise;\n\t\n\tthis.aRotation = aRotation || 0;\n\n};\n\nTHREE.EllipseCurve.prototype = Object.create( THREE.Curve.prototype );\nTHREE.EllipseCurve.prototype.constructor = THREE.EllipseCurve;\n\nTHREE.EllipseCurve.prototype.getPoint = function ( t ) {\n\n\tvar deltaAngle = this.aEndAngle - this.aStartAngle;\n\n\tif ( deltaAngle < 0 ) deltaAngle += Math.PI * 2;\n\tif ( deltaAngle > Math.PI * 2 ) deltaAngle -= Math.PI * 2;\n\n\tvar angle;\n\n\tif ( this.aClockwise === true ) {\n\n\t\tangle = this.aEndAngle + ( 1 - t ) * ( Math.PI * 2 - deltaAngle );\n\n\t} else {\n\n\t\tangle = this.aStartAngle + t * deltaAngle;\n\n\t}\n\t\n\tvar x = this.aX + this.xRadius * Math.cos( angle );\n\tvar y = this.aY + this.yRadius * Math.sin( angle );\n\n\tif ( this.aRotation !== 0 ) {\n\n\t\tvar cos = Math.cos( this.aRotation );\n\t\tvar sin = Math.sin( this.aRotation );\n\n\t\tvar tx = x, ty = y;\n\n\t\t// Rotate the point about the center of the ellipse.\n\t\tx = ( tx - this.aX ) * cos - ( ty - this.aY ) * sin + this.aX;\n\t\ty = ( tx - this.aX ) * sin + ( ty - this.aY ) * cos + this.aY;\n\n\t}\n\n\treturn new THREE.Vector2( x, y );\n\n};\n\n// File:src/extras/curves/ArcCurve.js\n\n/**************************************************************\n *\tArc curve\n **************************************************************/\n\nTHREE.ArcCurve = function ( aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise ) {\n\n\tTHREE.EllipseCurve.call( this, aX, aY, aRadius, aRadius, aStartAngle, aEndAngle, aClockwise );\n\n};\n\nTHREE.ArcCurve.prototype = Object.create( THREE.EllipseCurve.prototype );\nTHREE.ArcCurve.prototype.constructor = THREE.ArcCurve;\n\n// File:src/extras/curves/LineCurve3.js\n\n/**************************************************************\n *\tLine3D\n **************************************************************/\n\nTHREE.LineCurve3 = THREE.Curve.create(\n\n\tfunction ( v1, v2 ) {\n\n\t\tthis.v1 = v1;\n\t\tthis.v2 = v2;\n\n\t},\n\n\tfunction ( t ) {\n\n\t\tvar vector = new THREE.Vector3();\n\n\t\tvector.subVectors( this.v2, this.v1 ); // diff\n\t\tvector.multiplyScalar( t );\n\t\tvector.add( this.v1 );\n\n\t\treturn vector;\n\n\t}\n\n);\n\n// File:src/extras/curves/QuadraticBezierCurve3.js\n\n/**************************************************************\n *\tQuadratic Bezier 3D curve\n **************************************************************/\n\nTHREE.QuadraticBezierCurve3 = THREE.Curve.create(\n\n\tfunction ( v0, v1, v2 ) {\n\n\t\tthis.v0 = v0;\n\t\tthis.v1 = v1;\n\t\tthis.v2 = v2;\n\n\t},\n\n\tfunction ( t ) {\n\n\t\tvar vector = new THREE.Vector3();\n\n\t\tvector.x = THREE.Shape.Utils.b2( t, this.v0.x, this.v1.x, this.v2.x );\n\t\tvector.y = THREE.Shape.Utils.b2( t, this.v0.y, this.v1.y, this.v2.y );\n\t\tvector.z = THREE.Shape.Utils.b2( t, this.v0.z, this.v1.z, this.v2.z );\n\n\t\treturn vector;\n\n\t}\n\n);\n\n// File:src/extras/curves/CubicBezierCurve3.js\n\n/**************************************************************\n *\tCubic Bezier 3D curve\n **************************************************************/\n\nTHREE.CubicBezierCurve3 = THREE.Curve.create(\n\n\tfunction ( v0, v1, v2, v3 ) {\n\n\t\tthis.v0 = v0;\n\t\tthis.v1 = v1;\n\t\tthis.v2 = v2;\n\t\tthis.v3 = v3;\n\n\t},\n\n\tfunction ( t ) {\n\n\t\tvar vector = new THREE.Vector3();\n\n\t\tvector.x = THREE.Shape.Utils.b3( t, this.v0.x, this.v1.x, this.v2.x, this.v3.x );\n\t\tvector.y = THREE.Shape.Utils.b3( t, this.v0.y, this.v1.y, this.v2.y, this.v3.y );\n\t\tvector.z = THREE.Shape.Utils.b3( t, this.v0.z, this.v1.z, this.v2.z, this.v3.z );\n\n\t\treturn vector;\n\n\t}\n\n);\n\n// File:src/extras/curves/SplineCurve3.js\n\n/**************************************************************\n *\tSpline 3D curve\n **************************************************************/\n\n\nTHREE.SplineCurve3 = THREE.Curve.create(\n\n\tfunction ( points /* array of Vector3 */ ) {\n\n\t\tconsole.warn( 'THREE.SplineCurve3 will be deprecated. Please use THREE.CatmullRomCurve3' );\n\t\tthis.points = ( points == undefined ) ? [] : points;\n\n\t},\n\n\tfunction ( t ) {\n\n\t\tvar points = this.points;\n\t\tvar point = ( points.length - 1 ) * t;\n\n\t\tvar intPoint = Math.floor( point );\n\t\tvar weight = point - intPoint;\n\n\t\tvar point0 = points[ intPoint == 0 ? intPoint : intPoint - 1 ];\n\t\tvar point1 = points[ intPoint ];\n\t\tvar point2 = points[ intPoint > points.length - 2 ? points.length - 1 : intPoint + 1 ];\n\t\tvar point3 = points[ intPoint > points.length - 3 ? points.length - 1 : intPoint + 2 ];\n\n\t\tvar vector = new THREE.Vector3();\n\n\t\tvector.x = THREE.Curve.Utils.interpolate( point0.x, point1.x, point2.x, point3.x, weight );\n\t\tvector.y = THREE.Curve.Utils.interpolate( point0.y, point1.y, point2.y, point3.y, weight );\n\t\tvector.z = THREE.Curve.Utils.interpolate( point0.z, point1.z, point2.z, point3.z, weight );\n\n\t\treturn vector;\n\n\t}\n\n);\n\n// File:src/extras/curves/CatmullRomCurve3.js\n\n/**\n * @author zz85 https://github.com/zz85\n *\n * Centripetal CatmullRom Curve - which is useful for avoiding\n * cusps and self-intersections in non-uniform catmull rom curves.\n * http://www.cemyuksel.com/research/catmullrom_param/catmullrom.pdf\n *\n * curve.type accepts centripetal(default), chordal and catmullrom\n * curve.tension is used for catmullrom which defaults to 0.5\n */\n\nTHREE.CatmullRomCurve3 = ( function() {\n\n\tvar\n\t\ttmp = new THREE.Vector3(),\n\t\tpx = new CubicPoly(),\n\t\tpy = new CubicPoly(),\n\t\tpz = new CubicPoly();\n\n\t/*\n\tBased on an optimized c++ solution in\n\t - http://stackoverflow.com/questions/9489736/catmull-rom-curve-with-no-cusps-and-no-self-intersections/\n\t - http://ideone.com/NoEbVM\n\n\tThis CubicPoly class could be used for reusing some variables and calculations,\n\tbut for three.js curve use, it could be possible inlined and flatten into a single function call\n\twhich can be placed in CurveUtils.\n\t*/\n\n\tfunction CubicPoly() {\n\n\t}\n\n\t/*\n\t * Compute coefficients for a cubic polynomial\n\t *   p(s) = c0 + c1*s + c2*s^2 + c3*s^3\n\t * such that\n\t *   p(0) = x0, p(1) = x1\n\t *  and\n\t *   p'(0) = t0, p'(1) = t1.\n\t */\n\tCubicPoly.prototype.init = function( x0, x1, t0, t1 ) {\n\n\t\tthis.c0 = x0;\n\t\tthis.c1 = t0;\n\t\tthis.c2 = - 3 * x0 + 3 * x1 - 2 * t0 - t1;\n\t\tthis.c3 = 2 * x0 - 2 * x1 + t0 + t1;\n\n\t};\n\n\tCubicPoly.prototype.initNonuniformCatmullRom = function( x0, x1, x2, x3, dt0, dt1, dt2 ) {\n\n\t\t// compute tangents when parameterized in [t1,t2]\n\t\tvar t1 = ( x1 - x0 ) / dt0 - ( x2 - x0 ) / ( dt0 + dt1 ) + ( x2 - x1 ) / dt1;\n\t\tvar t2 = ( x2 - x1 ) / dt1 - ( x3 - x1 ) / ( dt1 + dt2 ) + ( x3 - x2 ) / dt2;\n\n\t\t// rescale tangents for parametrization in [0,1]\n\t\tt1 *= dt1;\n\t\tt2 *= dt1;\n\n\t\t// initCubicPoly\n\t\tthis.init( x1, x2, t1, t2 );\n\n\t};\n\n\t// standard Catmull-Rom spline: interpolate between x1 and x2 with previous/following points x1/x4\n\tCubicPoly.prototype.initCatmullRom = function( x0, x1, x2, x3, tension ) {\n\n\t\tthis.init( x1, x2, tension * ( x2 - x0 ), tension * ( x3 - x1 ) );\n\n\t};\n\n\tCubicPoly.prototype.calc = function( t ) {\n\n\t\tvar t2 = t * t;\n\t\tvar t3 = t2 * t;\n\t\treturn this.c0 + this.c1 * t + this.c2 * t2 + this.c3 * t3;\n\n\t};\n\n\t// Subclass Three.js curve\n\treturn THREE.Curve.create(\n\n\t\tfunction ( p /* array of Vector3 */ ) {\n\n\t\t\tthis.points = p || [];\n\n\t\t},\n\n\t\tfunction ( t ) {\n\n\t\t\tvar points = this.points,\n\t\t\t\tpoint, intPoint, weight, l;\n\n\t\t\tl = points.length;\n\n\t\t\tif ( l < 2 ) console.log( 'duh, you need at least 2 points' );\n\n\t\t\tpoint = ( l - 1 ) * t;\n\t\t\tintPoint = Math.floor( point );\n\t\t\tweight = point - intPoint;\n\n\t\t\tif ( weight === 0 && intPoint === l - 1 ) {\n\n\t\t\t\tintPoint = l - 2;\n\t\t\t\tweight = 1;\n\n\t\t\t}\n\n\t\t\tvar p0, p1, p2, p3;\n\n\t\t\tif ( intPoint === 0 ) {\n\n\t\t\t\t// extrapolate first point\n\t\t\t\ttmp.subVectors( points[ 0 ], points[ 1 ] ).add( points[ 0 ] );\n\t\t\t\tp0 = tmp;\n\n\t\t\t} else {\n\n\t\t\t\tp0 = points[ intPoint - 1 ];\n\n\t\t\t}\n\n\t\t\tp1 = points[ intPoint ];\n\t\t\tp2 = points[ intPoint + 1 ];\n\n\t\t\tif ( intPoint + 2 < l ) {\n\n\t\t\t\tp3 = points[ intPoint + 2 ]\n\n\t\t\t} else {\n\n\t\t\t\t// extrapolate last point\n\t\t\t\ttmp.subVectors( points[ l - 1 ], points[ l - 2 ] ).add( points[ l - 2 ] );\n\t\t\t\tp3 = tmp;\n\n\t\t\t}\n\n\t\t\tif ( this.type === undefined || this.type === 'centripetal' || this.type === 'chordal' ) {\n\n\t\t\t\t// init Centripetal / Chordal Catmull-Rom\n\t\t\t\tvar pow = this.type === 'chordal' ? 0.5 : 0.25;\n\t\t\t\tvar dt0 = Math.pow( p0.distanceToSquared( p1 ), pow );\n\t\t\t\tvar dt1 = Math.pow( p1.distanceToSquared( p2 ), pow );\n\t\t\t\tvar dt2 = Math.pow( p2.distanceToSquared( p3 ), pow );\n\n\t\t\t\t// safety check for repeated points\n\t\t\t\tif ( dt1 < 1e-4 ) dt1 = 1.0;\n\t\t\t\tif ( dt0 < 1e-4 ) dt0 = dt1;\n\t\t\t\tif ( dt2 < 1e-4 ) dt2 = dt1;\n\n\t\t\t\tpx.initNonuniformCatmullRom( p0.x, p1.x, p2.x, p3.x, dt0, dt1, dt2 );\n\t\t\t\tpy.initNonuniformCatmullRom( p0.y, p1.y, p2.y, p3.y, dt0, dt1, dt2 );\n\t\t\t\tpz.initNonuniformCatmullRom( p0.z, p1.z, p2.z, p3.z, dt0, dt1, dt2 );\n\n\t\t\t} else if ( this.type === 'catmullrom' ) {\n\n\t\t\t\tvar tension = this.tension !== undefined ? this.tension : 0.5;\n\t\t\t\tpx.initCatmullRom( p0.x, p1.x, p2.x, p3.x, tension );\n\t\t\t\tpy.initCatmullRom( p0.y, p1.y, p2.y, p3.y, tension );\n\t\t\t\tpz.initCatmullRom( p0.z, p1.z, p2.z, p3.z, tension );\n\n\t\t\t}\n\n\t\t\tvar v = new THREE.Vector3(\n\t\t\t\tpx.calc( weight ),\n\t\t\t\tpy.calc( weight ),\n\t\t\t\tpz.calc( weight )\n\t\t\t);\n\n\t\t\treturn v;\n\n\t\t}\n\n\t);\n\n} )();\n\n// File:src/extras/curves/ClosedSplineCurve3.js\n\n/**************************************************************\n *\tClosed Spline 3D curve\n **************************************************************/\n\n\nTHREE.ClosedSplineCurve3 = THREE.Curve.create(\n\n\tfunction ( points /* array of Vector3 */ ) {\n\n\t\tthis.points = ( points == undefined ) ? [] : points;\n\n\t},\n\n\tfunction ( t ) {\n\n\t\tvar points = this.points;\n\t\tvar point = ( points.length - 0 ) * t; // This needs to be from 0-length +1\n\n\t\tvar intPoint = Math.floor( point );\n\t\tvar weight = point - intPoint;\n\n\t\tintPoint += intPoint > 0 ? 0 : ( Math.floor( Math.abs( intPoint ) / points.length ) + 1 ) * points.length;\n\n\t\tvar point0 = points[ ( intPoint - 1 ) % points.length ];\n\t\tvar point1 = points[ ( intPoint     ) % points.length ];\n\t\tvar point2 = points[ ( intPoint + 1 ) % points.length ];\n\t\tvar point3 = points[ ( intPoint + 2 ) % points.length ];\n\n\t\tvar vector = new THREE.Vector3();\n\n\t\tvector.x = THREE.Curve.Utils.interpolate( point0.x, point1.x, point2.x, point3.x, weight );\n\t\tvector.y = THREE.Curve.Utils.interpolate( point0.y, point1.y, point2.y, point3.y, weight );\n\t\tvector.z = THREE.Curve.Utils.interpolate( point0.z, point1.z, point2.z, point3.z, weight );\n\n\t\treturn vector;\n\n\t}\n\n);\n\n// File:src/extras/animation/AnimationHandler.js\n\n/**\n * @author mikael emtinger / http://gomo.se/\n */\n\nTHREE.AnimationHandler = {\n\n\tLINEAR: 0,\n\tCATMULLROM: 1,\n\tCATMULLROM_FORWARD: 2,\n\n\t//\n\n\tadd: function () {\n\n\t\tconsole.warn( 'THREE.AnimationHandler.add() has been deprecated.' );\n\n\t},\n\tget: function () {\n\n\t\tconsole.warn( 'THREE.AnimationHandler.get() has been deprecated.' );\n\n\t},\n\tremove: function () {\n\n\t\tconsole.warn( 'THREE.AnimationHandler.remove() has been deprecated.' );\n\n\t},\n\n\t//\n\n\tanimations: [],\n\n\tinit: function ( data ) {\n\n\t\tif ( data.initialized === true ) return data;\n\n\t\t// loop through all keys\n\n\t\tfor ( var h = 0; h < data.hierarchy.length; h ++ ) {\n\n\t\t\tfor ( var k = 0; k < data.hierarchy[ h ].keys.length; k ++ ) {\n\n\t\t\t\t// remove minus times\n\n\t\t\t\tif ( data.hierarchy[ h ].keys[ k ].time < 0 ) {\n\n\t\t\t\t\t data.hierarchy[ h ].keys[ k ].time = 0;\n\n\t\t\t\t}\n\n\t\t\t\t// create quaternions\n\n\t\t\t\tif ( data.hierarchy[ h ].keys[ k ].rot !== undefined &&\n\t\t\t\t  ! ( data.hierarchy[ h ].keys[ k ].rot instanceof THREE.Quaternion ) ) {\n\n\t\t\t\t\tvar quat = data.hierarchy[ h ].keys[ k ].rot;\n\t\t\t\t\tdata.hierarchy[ h ].keys[ k ].rot = new THREE.Quaternion().fromArray( quat );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// prepare morph target keys\n\n\t\t\tif ( data.hierarchy[ h ].keys.length && data.hierarchy[ h ].keys[ 0 ].morphTargets !== undefined ) {\n\n\t\t\t\t// get all used\n\n\t\t\t\tvar usedMorphTargets = {};\n\n\t\t\t\tfor ( var k = 0; k < data.hierarchy[ h ].keys.length; k ++ ) {\n\n\t\t\t\t\tfor ( var m = 0; m < data.hierarchy[ h ].keys[ k ].morphTargets.length; m ++ ) {\n\n\t\t\t\t\t\tvar morphTargetName = data.hierarchy[ h ].keys[ k ].morphTargets[ m ];\n\t\t\t\t\t\tusedMorphTargets[ morphTargetName ] = - 1;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tdata.hierarchy[ h ].usedMorphTargets = usedMorphTargets;\n\n\n\t\t\t\t// set all used on all frames\n\n\t\t\t\tfor ( var k = 0; k < data.hierarchy[ h ].keys.length; k ++ ) {\n\n\t\t\t\t\tvar influences = {};\n\n\t\t\t\t\tfor ( var morphTargetName in usedMorphTargets ) {\n\n\t\t\t\t\t\tfor ( var m = 0; m < data.hierarchy[ h ].keys[ k ].morphTargets.length; m ++ ) {\n\n\t\t\t\t\t\t\tif ( data.hierarchy[ h ].keys[ k ].morphTargets[ m ] === morphTargetName ) {\n\n\t\t\t\t\t\t\t\tinfluences[ morphTargetName ] = data.hierarchy[ h ].keys[ k ].morphTargetsInfluences[ m ];\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( m === data.hierarchy[ h ].keys[ k ].morphTargets.length ) {\n\n\t\t\t\t\t\t\tinfluences[ morphTargetName ] = 0;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tdata.hierarchy[ h ].keys[ k ].morphTargetsInfluences = influences;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\n\t\t\t// remove all keys that are on the same time\n\n\t\t\tfor ( var k = 1; k < data.hierarchy[ h ].keys.length; k ++ ) {\n\n\t\t\t\tif ( data.hierarchy[ h ].keys[ k ].time === data.hierarchy[ h ].keys[ k - 1 ].time ) {\n\n\t\t\t\t\tdata.hierarchy[ h ].keys.splice( k, 1 );\n\t\t\t\t\tk --;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\n\t\t\t// set index\n\n\t\t\tfor ( var k = 0; k < data.hierarchy[ h ].keys.length; k ++ ) {\n\n\t\t\t\tdata.hierarchy[ h ].keys[ k ].index = k;\n\n\t\t\t}\n\n\t\t}\n\n\t\tdata.initialized = true;\n\n\t\treturn data;\n\n\t},\n\n\tparse: function ( root ) {\n\n\t\tvar parseRecurseHierarchy = function ( root, hierarchy ) {\n\n\t\t\thierarchy.push( root );\n\n\t\t\tfor ( var c = 0; c < root.children.length; c ++ )\n\t\t\t\tparseRecurseHierarchy( root.children[ c ], hierarchy );\n\n\t\t};\n\n\t\t// setup hierarchy\n\n\t\tvar hierarchy = [];\n\n\t\tif ( root instanceof THREE.SkinnedMesh ) {\n\n\t\t\tfor ( var b = 0; b < root.skeleton.bones.length; b ++ ) {\n\n\t\t\t\thierarchy.push( root.skeleton.bones[ b ] );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tparseRecurseHierarchy( root, hierarchy );\n\n\t\t}\n\n\t\treturn hierarchy;\n\n\t},\n\n\tplay: function ( animation ) {\n\n\t\tif ( this.animations.indexOf( animation ) === - 1 ) {\n\n\t\t\tthis.animations.push( animation );\n\n\t\t}\n\n\t},\n\n\tstop: function ( animation ) {\n\n\t\tvar index = this.animations.indexOf( animation );\n\n\t\tif ( index !== - 1 ) {\n\n\t\t\tthis.animations.splice( index, 1 );\n\n\t\t}\n\n\t},\n\n\tupdate: function ( deltaTimeMS ) {\n\n\t\tfor ( var i = 0; i < this.animations.length; i ++ ) {\n\n\t\t\tthis.animations[ i ].resetBlendWeights();\n\n\t\t}\n\n\t\tfor ( var i = 0; i < this.animations.length; i ++ ) {\n\n\t\t\tthis.animations[ i ].update( deltaTimeMS );\n\n\t\t}\n\n\t}\n\n};\n\n// File:src/extras/animation/Animation.js\n\n/**\n * @author mikael emtinger / http://gomo.se/\n * @author mrdoob / http://mrdoob.com/\n * @author alteredq / http://alteredqualia.com/\n */\n\nTHREE.Animation = function ( root, data ) {\n\n\tthis.root = root;\n\tthis.data = THREE.AnimationHandler.init( data );\n\tthis.hierarchy = THREE.AnimationHandler.parse( root );\n\n\tthis.currentTime = 0;\n\tthis.timeScale = 1;\n\n\tthis.isPlaying = false;\n\tthis.loop = true;\n\tthis.weight = 0;\n\n\tthis.interpolationType = THREE.AnimationHandler.LINEAR;\n\n};\n\nTHREE.Animation.prototype = {\n\n\tconstructor: THREE.Animation,\n\n\tkeyTypes:  [ \"pos\", \"rot\", \"scl\" ],\n\n\tplay: function ( startTime, weight ) {\n\n\t\tthis.currentTime = startTime !== undefined ? startTime : 0;\n\t\tthis.weight = weight !== undefined ? weight : 1;\n\n\t\tthis.isPlaying = true;\n\n\t\tthis.reset();\n\n\t\tTHREE.AnimationHandler.play( this );\n\n\t},\n\n\tstop: function() {\n\n\t\tthis.isPlaying = false;\n\n\t\tTHREE.AnimationHandler.stop( this );\n\n\t},\n\n\treset: function () {\n\n\t\tfor ( var h = 0, hl = this.hierarchy.length; h < hl; h ++ ) {\n\n\t\t\tvar object = this.hierarchy[ h ];\n\n\t\t\tif ( object.animationCache === undefined ) {\n\n\t\t\t\tobject.animationCache = {\n\t\t\t\t\tanimations: {},\n\t\t\t\t\tblending: {\n\t\t\t\t\t\tpositionWeight: 0.0,\n\t\t\t\t\t\tquaternionWeight: 0.0,\n\t\t\t\t\t\tscaleWeight: 0.0\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t}\n\n\t\t\tvar name = this.data.name;\n\t\t\tvar animations = object.animationCache.animations;\n\t\t\tvar animationCache = animations[ name ];\n\n\t\t\tif ( animationCache === undefined ) {\n\n\t\t\t\tanimationCache = {\n\t\t\t\t\tprevKey: { pos: 0, rot: 0, scl: 0 },\n\t\t\t\t\tnextKey: { pos: 0, rot: 0, scl: 0 },\n\t\t\t\t\toriginalMatrix: object.matrix\n\t\t\t\t};\n\n\t\t\t\tanimations[ name ] = animationCache;\n\n\t\t\t}\n\n\t\t\t// Get keys to match our current time\n\n\t\t\tfor ( var t = 0; t < 3; t ++ ) {\n\n\t\t\t\tvar type = this.keyTypes[ t ];\n\n\t\t\t\tvar prevKey = this.data.hierarchy[ h ].keys[ 0 ];\n\t\t\t\tvar nextKey = this.getNextKeyWith( type, h, 1 );\n\n\t\t\t\twhile ( nextKey.time < this.currentTime && nextKey.index > prevKey.index ) {\n\n\t\t\t\t\tprevKey = nextKey;\n\t\t\t\t\tnextKey = this.getNextKeyWith( type, h, nextKey.index + 1 );\n\n\t\t\t\t}\n\n\t\t\t\tanimationCache.prevKey[ type ] = prevKey;\n\t\t\t\tanimationCache.nextKey[ type ] = nextKey;\n\n\t\t\t}\n\n\t\t}\n\n\t},\n\n\tresetBlendWeights: function () {\n\n\t\tfor ( var h = 0, hl = this.hierarchy.length; h < hl; h ++ ) {\n\n\t\t\tvar object = this.hierarchy[ h ];\n\t\t\tvar animationCache = object.animationCache;\n\n\t\t\tif ( animationCache !== undefined ) {\n\n\t\t\t\tvar blending = animationCache.blending;\n\n\t\t\t\tblending.positionWeight = 0.0;\n\t\t\t\tblending.quaternionWeight = 0.0;\n\t\t\t\tblending.scaleWeight = 0.0;\n\n\t\t\t}\n\n\t\t}\n\n\t},\n\n\tupdate: ( function() {\n\n\t\tvar points = [];\n\t\tvar target = new THREE.Vector3();\n\t\tvar newVector = new THREE.Vector3();\n\t\tvar newQuat = new THREE.Quaternion();\n\n\t\t// Catmull-Rom spline\n\n\t\tvar interpolateCatmullRom = function ( points, scale ) {\n\n\t\t\tvar c = [], v3 = [],\n\t\t\tpoint, intPoint, weight, w2, w3,\n\t\t\tpa, pb, pc, pd;\n\n\t\t\tpoint = ( points.length - 1 ) * scale;\n\t\t\tintPoint = Math.floor( point );\n\t\t\tweight = point - intPoint;\n\n\t\t\tc[ 0 ] = intPoint === 0 ? intPoint : intPoint - 1;\n\t\t\tc[ 1 ] = intPoint;\n\t\t\tc[ 2 ] = intPoint > points.length - 2 ? intPoint : intPoint + 1;\n\t\t\tc[ 3 ] = intPoint > points.length - 3 ? intPoint : intPoint + 2;\n\n\t\t\tpa = points[ c[ 0 ] ];\n\t\t\tpb = points[ c[ 1 ] ];\n\t\t\tpc = points[ c[ 2 ] ];\n\t\t\tpd = points[ c[ 3 ] ];\n\n\t\t\tw2 = weight * weight;\n\t\t\tw3 = weight * w2;\n\n\t\t\tv3[ 0 ] = interpolate( pa[ 0 ], pb[ 0 ], pc[ 0 ], pd[ 0 ], weight, w2, w3 );\n\t\t\tv3[ 1 ] = interpolate( pa[ 1 ], pb[ 1 ], pc[ 1 ], pd[ 1 ], weight, w2, w3 );\n\t\t\tv3[ 2 ] = interpolate( pa[ 2 ], pb[ 2 ], pc[ 2 ], pd[ 2 ], weight, w2, w3 );\n\n\t\t\treturn v3;\n\n\t\t};\n\n\t\tvar interpolate = function ( p0, p1, p2, p3, t, t2, t3 ) {\n\n\t\t\tvar v0 = ( p2 - p0 ) * 0.5,\n\t\t\t\tv1 = ( p3 - p1 ) * 0.5;\n\n\t\t\treturn ( 2 * ( p1 - p2 ) + v0 + v1 ) * t3 + ( - 3 * ( p1 - p2 ) - 2 * v0 - v1 ) * t2 + v0 * t + p1;\n\n\t\t};\n\n\t\treturn function ( delta ) {\n\n\t\t\tif ( this.isPlaying === false ) return;\n\n\t\t\tthis.currentTime += delta * this.timeScale;\n\n\t\t\tif ( this.weight === 0 )\n\t\t\t\treturn;\n\n\t\t\t//\n\n\t\t\tvar duration = this.data.length;\n\n\t\t\tif ( this.currentTime > duration || this.currentTime < 0 ) {\n\n\t\t\t\tif ( this.loop ) {\n\n\t\t\t\t\tthis.currentTime %= duration;\n\n\t\t\t\t\tif ( this.currentTime < 0 )\n\t\t\t\t\t\tthis.currentTime += duration;\n\n\t\t\t\t\tthis.reset();\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis.stop();\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tfor ( var h = 0, hl = this.hierarchy.length; h < hl; h ++ ) {\n\n\t\t\t\tvar object = this.hierarchy[ h ];\n\t\t\t\tvar animationCache = object.animationCache.animations[ this.data.name ];\n\t\t\t\tvar blending = object.animationCache.blending;\n\n\t\t\t\t// loop through pos/rot/scl\n\n\t\t\t\tfor ( var t = 0; t < 3; t ++ ) {\n\n\t\t\t\t\t// get keys\n\n\t\t\t\t\tvar type    = this.keyTypes[ t ];\n\t\t\t\t\tvar prevKey = animationCache.prevKey[ type ];\n\t\t\t\t\tvar nextKey = animationCache.nextKey[ type ];\n\n\t\t\t\t\tif ( ( this.timeScale > 0 && nextKey.time <= this.currentTime ) ||\n\t\t\t\t\t\t( this.timeScale < 0 && prevKey.time >= this.currentTime ) ) {\n\n\t\t\t\t\t\tprevKey = this.data.hierarchy[ h ].keys[ 0 ];\n\t\t\t\t\t\tnextKey = this.getNextKeyWith( type, h, 1 );\n\n\t\t\t\t\t\twhile ( nextKey.time < this.currentTime && nextKey.index > prevKey.index ) {\n\n\t\t\t\t\t\t\tprevKey = nextKey;\n\t\t\t\t\t\t\tnextKey = this.getNextKeyWith( type, h, nextKey.index + 1 );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tanimationCache.prevKey[ type ] = prevKey;\n\t\t\t\t\t\tanimationCache.nextKey[ type ] = nextKey;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tvar scale = ( this.currentTime - prevKey.time ) / ( nextKey.time - prevKey.time );\n\n\t\t\t\t\tvar prevXYZ = prevKey[ type ];\n\t\t\t\t\tvar nextXYZ = nextKey[ type ];\n\n\t\t\t\t\tif ( scale < 0 ) scale = 0;\n\t\t\t\t\tif ( scale > 1 ) scale = 1;\n\n\t\t\t\t\t// interpolate\n\n\t\t\t\t\tif ( type === \"pos\" ) {\n\n\t\t\t\t\t\tif ( this.interpolationType === THREE.AnimationHandler.LINEAR ) {\n\n\t\t\t\t\t\t\tnewVector.x = prevXYZ[ 0 ] + ( nextXYZ[ 0 ] - prevXYZ[ 0 ] ) * scale;\n\t\t\t\t\t\t\tnewVector.y = prevXYZ[ 1 ] + ( nextXYZ[ 1 ] - prevXYZ[ 1 ] ) * scale;\n\t\t\t\t\t\t\tnewVector.z = prevXYZ[ 2 ] + ( nextXYZ[ 2 ] - prevXYZ[ 2 ] ) * scale;\n\n\t\t\t\t\t\t\t// blend\n\t\t\t\t\t\t\tvar proportionalWeight = this.weight / ( this.weight + blending.positionWeight );\n\t\t\t\t\t\t\tobject.position.lerp( newVector, proportionalWeight );\n\t\t\t\t\t\t\tblending.positionWeight += this.weight;\n\n\t\t\t\t\t\t} else if ( this.interpolationType === THREE.AnimationHandler.CATMULLROM ||\n\t\t\t\t\t\t\t\t\tthis.interpolationType === THREE.AnimationHandler.CATMULLROM_FORWARD ) {\n\n\t\t\t\t\t\t\tpoints[ 0 ] = this.getPrevKeyWith( \"pos\", h, prevKey.index - 1 )[ \"pos\" ];\n\t\t\t\t\t\t\tpoints[ 1 ] = prevXYZ;\n\t\t\t\t\t\t\tpoints[ 2 ] = nextXYZ;\n\t\t\t\t\t\t\tpoints[ 3 ] = this.getNextKeyWith( \"pos\", h, nextKey.index + 1 )[ \"pos\" ];\n\n\t\t\t\t\t\t\tscale = scale * 0.33 + 0.33;\n\n\t\t\t\t\t\t\tvar currentPoint = interpolateCatmullRom( points, scale );\n\t\t\t\t\t\t\tvar proportionalWeight = this.weight / ( this.weight + blending.positionWeight );\n\t\t\t\t\t\t\tblending.positionWeight += this.weight;\n\n\t\t\t\t\t\t\t// blend\n\n\t\t\t\t\t\t\tvar vector = object.position;\n\n\t\t\t\t\t\t\tvector.x = vector.x + ( currentPoint[ 0 ] - vector.x ) * proportionalWeight;\n\t\t\t\t\t\t\tvector.y = vector.y + ( currentPoint[ 1 ] - vector.y ) * proportionalWeight;\n\t\t\t\t\t\t\tvector.z = vector.z + ( currentPoint[ 2 ] - vector.z ) * proportionalWeight;\n\n\t\t\t\t\t\t\tif ( this.interpolationType === THREE.AnimationHandler.CATMULLROM_FORWARD ) {\n\n\t\t\t\t\t\t\t\tvar forwardPoint = interpolateCatmullRom( points, scale * 1.01 );\n\n\t\t\t\t\t\t\t\ttarget.set( forwardPoint[ 0 ], forwardPoint[ 1 ], forwardPoint[ 2 ] );\n\t\t\t\t\t\t\t\ttarget.sub( vector );\n\t\t\t\t\t\t\t\ttarget.y = 0;\n\t\t\t\t\t\t\t\ttarget.normalize();\n\n\t\t\t\t\t\t\t\tvar angle = Math.atan2( target.x, target.z );\n\t\t\t\t\t\t\t\tobject.rotation.set( 0, angle, 0 );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else if ( type === \"rot\" ) {\n\n\t\t\t\t\t\tTHREE.Quaternion.slerp( prevXYZ, nextXYZ, newQuat, scale );\n\n\t\t\t\t\t\t// Avoid paying the cost of an additional slerp if we don't have to\n\t\t\t\t\t\tif ( blending.quaternionWeight === 0 ) {\n\n\t\t\t\t\t\t\tobject.quaternion.copy( newQuat );\n\t\t\t\t\t\t\tblending.quaternionWeight = this.weight;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tvar proportionalWeight = this.weight / ( this.weight + blending.quaternionWeight );\n\t\t\t\t\t\t\tTHREE.Quaternion.slerp( object.quaternion, newQuat, object.quaternion, proportionalWeight );\n\t\t\t\t\t\t\tblending.quaternionWeight += this.weight;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else if ( type === \"scl\" ) {\n\n\t\t\t\t\t\tnewVector.x = prevXYZ[ 0 ] + ( nextXYZ[ 0 ] - prevXYZ[ 0 ] ) * scale;\n\t\t\t\t\t\tnewVector.y = prevXYZ[ 1 ] + ( nextXYZ[ 1 ] - prevXYZ[ 1 ] ) * scale;\n\t\t\t\t\t\tnewVector.z = prevXYZ[ 2 ] + ( nextXYZ[ 2 ] - prevXYZ[ 2 ] ) * scale;\n\n\t\t\t\t\t\tvar proportionalWeight = this.weight / ( this.weight + blending.scaleWeight );\n\t\t\t\t\t\tobject.scale.lerp( newVector, proportionalWeight );\n\t\t\t\t\t\tblending.scaleWeight += this.weight;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn true;\n\n\t\t};\n\n\t} )(),\n\n\tgetNextKeyWith: function ( type, h, key ) {\n\n\t\tvar keys = this.data.hierarchy[ h ].keys;\n\n\t\tif ( this.interpolationType === THREE.AnimationHandler.CATMULLROM ||\n\t\t\t this.interpolationType === THREE.AnimationHandler.CATMULLROM_FORWARD ) {\n\n\t\t\tkey = key < keys.length - 1 ? key : keys.length - 1;\n\n\t\t} else {\n\n\t\t\tkey = key % keys.length;\n\n\t\t}\n\n\t\tfor ( ; key < keys.length; key ++ ) {\n\n\t\t\tif ( keys[ key ][ type ] !== undefined ) {\n\n\t\t\t\treturn keys[ key ];\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this.data.hierarchy[ h ].keys[ 0 ];\n\n\t},\n\n\tgetPrevKeyWith: function ( type, h, key ) {\n\n\t\tvar keys = this.data.hierarchy[ h ].keys;\n\n\t\tif ( this.interpolationType === THREE.AnimationHandler.CATMULLROM ||\n\t\t\tthis.interpolationType === THREE.AnimationHandler.CATMULLROM_FORWARD ) {\n\n\t\t\tkey = key > 0 ? key : 0;\n\n\t\t} else {\n\n\t\t\tkey = key >= 0 ? key : key + keys.length;\n\n\t\t}\n\n\n\t\tfor ( ; key >= 0; key -- ) {\n\n\t\t\tif ( keys[ key ][ type ] !== undefined ) {\n\n\t\t\t\treturn keys[ key ];\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this.data.hierarchy[ h ].keys[ keys.length - 1 ];\n\n\t}\n\n};\n\n// File:src/extras/animation/KeyFrameAnimation.js\n\n/**\n * @author mikael emtinger / http://gomo.se/\n * @author mrdoob / http://mrdoob.com/\n * @author alteredq / http://alteredqualia.com/\n * @author khang duong\n * @author erik kitson\n */\n\nTHREE.KeyFrameAnimation = function ( data ) {\n\n\tthis.root = data.node;\n\tthis.data = THREE.AnimationHandler.init( data );\n\tthis.hierarchy = THREE.AnimationHandler.parse( this.root );\n\tthis.currentTime = 0;\n\tthis.timeScale = 0.001;\n\tthis.isPlaying = false;\n\tthis.isPaused = true;\n\tthis.loop = true;\n\n\t// initialize to first keyframes\n\n\tfor ( var h = 0, hl = this.hierarchy.length; h < hl; h ++ ) {\n\n\t\tvar keys = this.data.hierarchy[ h ].keys,\n\t\t\tsids = this.data.hierarchy[ h ].sids,\n\t\t\tobj = this.hierarchy[ h ];\n\n\t\tif ( keys.length && sids ) {\n\n\t\t\tfor ( var s = 0; s < sids.length; s ++ ) {\n\n\t\t\t\tvar sid = sids[ s ],\n\t\t\t\t\tnext = this.getNextKeyWith( sid, h, 0 );\n\n\t\t\t\tif ( next ) {\n\n\t\t\t\t\tnext.apply( sid );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tobj.matrixAutoUpdate = false;\n\t\t\tthis.data.hierarchy[ h ].node.updateMatrix();\n\t\t\tobj.matrixWorldNeedsUpdate = true;\n\n\t\t}\n\n\t}\n\n};\n\nTHREE.KeyFrameAnimation.prototype = {\n\n\tconstructor: THREE.KeyFrameAnimation,\n\n\tplay: function ( startTime ) {\n\n\t\tthis.currentTime = startTime !== undefined ? startTime : 0;\n\n\t\tif ( this.isPlaying === false ) {\n\n\t\t\tthis.isPlaying = true;\n\n\t\t\t// reset key cache\n\n\t\t\tvar h, hl = this.hierarchy.length,\n\t\t\t\tobject,\n\t\t\t\tnode;\n\n\t\t\tfor ( h = 0; h < hl; h ++ ) {\n\n\t\t\t\tobject = this.hierarchy[ h ];\n\t\t\t\tnode = this.data.hierarchy[ h ];\n\n\t\t\t\tif ( node.animationCache === undefined ) {\n\n\t\t\t\t\tnode.animationCache = {};\n\t\t\t\t\tnode.animationCache.prevKey = null;\n\t\t\t\t\tnode.animationCache.nextKey = null;\n\t\t\t\t\tnode.animationCache.originalMatrix = object.matrix;\n\n\t\t\t\t}\n\n\t\t\t\tvar keys = this.data.hierarchy[ h ].keys;\n\n\t\t\t\tif ( keys.length ) {\n\n\t\t\t\t\tnode.animationCache.prevKey = keys[ 0 ];\n\t\t\t\t\tnode.animationCache.nextKey = keys[ 1 ];\n\n\t\t\t\t\tthis.startTime = Math.min( keys[ 0 ].time, this.startTime );\n\t\t\t\t\tthis.endTime = Math.max( keys[ keys.length - 1 ].time, this.endTime );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.update( 0 );\n\n\t\t}\n\n\t\tthis.isPaused = false;\n\n\t\tTHREE.AnimationHandler.play( this );\n\n\t},\n\n\tstop: function () {\n\n\t\tthis.isPlaying = false;\n\t\tthis.isPaused  = false;\n\n\t\tTHREE.AnimationHandler.stop( this );\n\n\t\t// reset JIT matrix and remove cache\n\n\t\tfor ( var h = 0; h < this.data.hierarchy.length; h ++ ) {\n\n\t\t\tvar obj = this.hierarchy[ h ];\n\t\t\tvar node = this.data.hierarchy[ h ];\n\n\t\t\tif ( node.animationCache !== undefined ) {\n\n\t\t\t\tvar original = node.animationCache.originalMatrix;\n\n\t\t\t\toriginal.copy( obj.matrix );\n\t\t\t\tobj.matrix = original;\n\n\t\t\t\tdelete node.animationCache;\n\n\t\t\t}\n\n\t\t}\n\n\t},\n\n\tupdate: function ( delta ) {\n\n\t\tif ( this.isPlaying === false ) return;\n\n\t\tthis.currentTime += delta * this.timeScale;\n\n\t\t//\n\n\t\tvar duration = this.data.length;\n\n\t\tif ( this.loop === true && this.currentTime > duration ) {\n\n\t\t\tthis.currentTime %= duration;\n\n\t\t}\n\n\t\tthis.currentTime = Math.min( this.currentTime, duration );\n\n\t\tfor ( var h = 0, hl = this.hierarchy.length; h < hl; h ++ ) {\n\n\t\t\tvar object = this.hierarchy[ h ];\n\t\t\tvar node = this.data.hierarchy[ h ];\n\n\t\t\tvar keys = node.keys,\n\t\t\t\tanimationCache = node.animationCache;\n\n\n\t\t\tif ( keys.length ) {\n\n\t\t\t\tvar prevKey = animationCache.prevKey;\n\t\t\t\tvar nextKey = animationCache.nextKey;\n\n\t\t\t\tif ( nextKey.time <= this.currentTime ) {\n\n\t\t\t\t\twhile ( nextKey.time < this.currentTime && nextKey.index > prevKey.index ) {\n\n\t\t\t\t\t\tprevKey = nextKey;\n\t\t\t\t\t\tnextKey = keys[ prevKey.index + 1 ];\n\n\t\t\t\t\t}\n\n\t\t\t\t\tanimationCache.prevKey = prevKey;\n\t\t\t\t\tanimationCache.nextKey = nextKey;\n\n\t\t\t\t}\n\n\t\t\t\tif ( nextKey.time >= this.currentTime ) {\n\n\t\t\t\t\tprevKey.interpolate( nextKey, this.currentTime );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tprevKey.interpolate( nextKey, nextKey.time );\n\n\t\t\t\t}\n\n\t\t\t\tthis.data.hierarchy[ h ].node.updateMatrix();\n\t\t\t\tobject.matrixWorldNeedsUpdate = true;\n\n\t\t\t}\n\n\t\t}\n\n\t},\n\n\tgetNextKeyWith: function ( sid, h, key ) {\n\n\t\tvar keys = this.data.hierarchy[ h ].keys;\n\t\tkey = key % keys.length;\n\n\t\tfor ( ; key < keys.length; key ++ ) {\n\n\t\t\tif ( keys[ key ].hasTarget( sid ) ) {\n\n\t\t\t\treturn keys[ key ];\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn keys[ 0 ];\n\n\t},\n\n\tgetPrevKeyWith: function ( sid, h, key ) {\n\n\t\tvar keys = this.data.hierarchy[ h ].keys;\n\t\tkey = key >= 0 ? key : key + keys.length;\n\n\t\tfor ( ; key >= 0; key -- ) {\n\n\t\t\tif ( keys[ key ].hasTarget( sid ) ) {\n\n\t\t\t\treturn keys[ key ];\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn keys[ keys.length - 1 ];\n\n\t}\n\n};\n\n// File:src/extras/animation/MorphAnimation.js\n\n/**\n * @author mrdoob / http://mrdoob.com\n * @author willy-vvu / http://willy-vvu.github.io\n */\n\nTHREE.MorphAnimation = function ( mesh ) {\n\n\tthis.mesh = mesh;\n\tthis.frames = mesh.morphTargetInfluences.length;\n\tthis.currentTime = 0;\n\tthis.duration = 1000;\n\tthis.loop = true;\n\tthis.lastFrame = 0;\n\tthis.currentFrame = 0;\n\n\tthis.isPlaying = false;\n\n};\n\nTHREE.MorphAnimation.prototype = {\n\n\tconstructor: THREE.MorphAnimation,\n\n\tplay: function () {\n\n\t\tthis.isPlaying = true;\n\n\t},\n\n\tpause: function () {\n\n\t\tthis.isPlaying = false;\n\n\t},\n\n\tupdate: function ( delta ) {\n\n\t\tif ( this.isPlaying === false ) return;\n\n\t\tthis.currentTime += delta;\n\n\t\tif ( this.loop === true && this.currentTime > this.duration ) {\n\n\t\t\tthis.currentTime %= this.duration;\n\n\t\t}\n\n\t\tthis.currentTime = Math.min( this.currentTime, this.duration );\n\n\t\tvar frameTime = this.duration / this.frames;\n\t\tvar frame = Math.floor( this.currentTime / frameTime );\n\n\t\tvar influences = this.mesh.morphTargetInfluences;\n\n\t\tif ( frame !== this.currentFrame ) {\n\n\t\t\tinfluences[ this.lastFrame ] = 0;\n\t\t\tinfluences[ this.currentFrame ] = 1;\n\t\t\tinfluences[ frame ] = 0;\n\n\t\t\tthis.lastFrame = this.currentFrame;\n\t\t\tthis.currentFrame = frame;\n\n\t\t}\n\n\t\tvar mix = ( this.currentTime % frameTime ) / frameTime;\n\n\t\tinfluences[ frame ] = mix;\n\t\tinfluences[ this.lastFrame ] = 1 - mix;\n\n\t}\n\n};\n\n// File:src/extras/geometries/BoxGeometry.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n * based on http://papervision3d.googlecode.com/svn/trunk/as3/trunk/src/org/papervision3d/objects/primitives/Cube.as\n */\n\nTHREE.BoxGeometry = function ( width, height, depth, widthSegments, heightSegments, depthSegments ) {\n\n\tTHREE.Geometry.call( this );\n\n\tthis.type = 'BoxGeometry';\n\n\tthis.parameters = {\n\t\twidth: width,\n\t\theight: height,\n\t\tdepth: depth,\n\t\twidthSegments: widthSegments,\n\t\theightSegments: heightSegments,\n\t\tdepthSegments: depthSegments\n\t};\n\n\tthis.widthSegments = widthSegments || 1;\n\tthis.heightSegments = heightSegments || 1;\n\tthis.depthSegments = depthSegments || 1;\n\n\tvar scope = this;\n\n\tvar width_half = width / 2;\n\tvar height_half = height / 2;\n\tvar depth_half = depth / 2;\n\n\tbuildPlane( 'z', 'y', - 1, - 1, depth, height, width_half, 0 ); // px\n\tbuildPlane( 'z', 'y',   1, - 1, depth, height, - width_half, 1 ); // nx\n\tbuildPlane( 'x', 'z',   1,   1, width, depth, height_half, 2 ); // py\n\tbuildPlane( 'x', 'z',   1, - 1, width, depth, - height_half, 3 ); // ny\n\tbuildPlane( 'x', 'y',   1, - 1, width, height, depth_half, 4 ); // pz\n\tbuildPlane( 'x', 'y', - 1, - 1, width, height, - depth_half, 5 ); // nz\n\n\tfunction buildPlane( u, v, udir, vdir, width, height, depth, materialIndex ) {\n\n\t\tvar w, ix, iy,\n\t\tgridX = scope.widthSegments,\n\t\tgridY = scope.heightSegments,\n\t\twidth_half = width / 2,\n\t\theight_half = height / 2,\n\t\toffset = scope.vertices.length;\n\n\t\tif ( ( u === 'x' && v === 'y' ) || ( u === 'y' && v === 'x' ) ) {\n\n\t\t\tw = 'z';\n\n\t\t} else if ( ( u === 'x' && v === 'z' ) || ( u === 'z' && v === 'x' ) ) {\n\n\t\t\tw = 'y';\n\t\t\tgridY = scope.depthSegments;\n\n\t\t} else if ( ( u === 'z' && v === 'y' ) || ( u === 'y' && v === 'z' ) ) {\n\n\t\t\tw = 'x';\n\t\t\tgridX = scope.depthSegments;\n\n\t\t}\n\n\t\tvar gridX1 = gridX + 1,\n\t\tgridY1 = gridY + 1,\n\t\tsegment_width = width / gridX,\n\t\tsegment_height = height / gridY,\n\t\tnormal = new THREE.Vector3();\n\n\t\tnormal[ w ] = depth > 0 ? 1 : - 1;\n\n\t\tfor ( iy = 0; iy < gridY1; iy ++ ) {\n\n\t\t\tfor ( ix = 0; ix < gridX1; ix ++ ) {\n\n\t\t\t\tvar vector = new THREE.Vector3();\n\t\t\t\tvector[ u ] = ( ix * segment_width - width_half ) * udir;\n\t\t\t\tvector[ v ] = ( iy * segment_height - height_half ) * vdir;\n\t\t\t\tvector[ w ] = depth;\n\n\t\t\t\tscope.vertices.push( vector );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfor ( iy = 0; iy < gridY; iy ++ ) {\n\n\t\t\tfor ( ix = 0; ix < gridX; ix ++ ) {\n\n\t\t\t\tvar a = ix + gridX1 * iy;\n\t\t\t\tvar b = ix + gridX1 * ( iy + 1 );\n\t\t\t\tvar c = ( ix + 1 ) + gridX1 * ( iy + 1 );\n\t\t\t\tvar d = ( ix + 1 ) + gridX1 * iy;\n\n\t\t\t\tvar uva = new THREE.Vector2( ix / gridX, 1 - iy / gridY );\n\t\t\t\tvar uvb = new THREE.Vector2( ix / gridX, 1 - ( iy + 1 ) / gridY );\n\t\t\t\tvar uvc = new THREE.Vector2( ( ix + 1 ) / gridX, 1 - ( iy + 1 ) / gridY );\n\t\t\t\tvar uvd = new THREE.Vector2( ( ix + 1 ) / gridX, 1 - iy / gridY );\n\n\t\t\t\tvar face = new THREE.Face3( a + offset, b + offset, d + offset );\n\t\t\t\tface.normal.copy( normal );\n\t\t\t\tface.vertexNormals.push( normal.clone(), normal.clone(), normal.clone() );\n\t\t\t\tface.materialIndex = materialIndex;\n\n\t\t\t\tscope.faces.push( face );\n\t\t\t\tscope.faceVertexUvs[ 0 ].push( [ uva, uvb, uvd ] );\n\n\t\t\t\tface = new THREE.Face3( b + offset, c + offset, d + offset );\n\t\t\t\tface.normal.copy( normal );\n\t\t\t\tface.vertexNormals.push( normal.clone(), normal.clone(), normal.clone() );\n\t\t\t\tface.materialIndex = materialIndex;\n\n\t\t\t\tscope.faces.push( face );\n\t\t\t\tscope.faceVertexUvs[ 0 ].push( [ uvb.clone(), uvc, uvd.clone() ] );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tthis.mergeVertices();\n\n};\n\nTHREE.BoxGeometry.prototype = Object.create( THREE.Geometry.prototype );\nTHREE.BoxGeometry.prototype.constructor = THREE.BoxGeometry;\n\nTHREE.BoxGeometry.prototype.clone = function () {\n\n\tvar geometry = new THREE.BoxGeometry(\n\t\tthis.parameters.width,\n\t\tthis.parameters.height,\n\t\tthis.parameters.depth,\n\t\tthis.parameters.widthSegments,\n\t\tthis.parameters.heightSegments,\n\t\tthis.parameters.depthSegments\n\t);\n\n\treturn geometry;\n\n};\n\nTHREE.CubeGeometry = THREE.BoxGeometry; // backwards compatibility\n\n// File:src/extras/geometries/CircleGeometry.js\n\n/**\n * @author hughes\n */\n\nTHREE.CircleGeometry = function ( radius, segments, thetaStart, thetaLength ) {\n\n\tTHREE.Geometry.call( this );\n\n\tthis.type = 'CircleGeometry';\n\n\tthis.parameters = {\n\t\tradius: radius,\n\t\tsegments: segments,\n\t\tthetaStart: thetaStart,\n\t\tthetaLength: thetaLength\n\t};\n\n\tradius = radius || 50;\n\tsegments = segments !== undefined ? Math.max( 3, segments ) : 8;\n\n\tthetaStart = thetaStart !== undefined ? thetaStart : 0;\n\tthetaLength = thetaLength !== undefined ? thetaLength : Math.PI * 2;\n\n\tvar i, uvs = [],\n\tcenter = new THREE.Vector3(), centerUV = new THREE.Vector2( 0.5, 0.5 );\n\n\tthis.vertices.push( center );\n\tuvs.push( centerUV );\n\n\tfor ( i = 0; i <= segments; i ++ ) {\n\n\t\tvar vertex = new THREE.Vector3();\n\t\tvar segment = thetaStart + i / segments * thetaLength;\n\n\t\tvertex.x = radius * Math.cos( segment );\n\t\tvertex.y = radius * Math.sin( segment );\n\n\t\tthis.vertices.push( vertex );\n\t\tuvs.push( new THREE.Vector2( ( vertex.x / radius + 1 ) / 2, ( vertex.y / radius + 1 ) / 2 ) );\n\n\t}\n\n\tvar n = new THREE.Vector3( 0, 0, 1 );\n\n\tfor ( i = 1; i <= segments; i ++ ) {\n\n\t\tthis.faces.push( new THREE.Face3( i, i + 1, 0, [ n.clone(), n.clone(), n.clone() ] ) );\n\t\tthis.faceVertexUvs[ 0 ].push( [ uvs[ i ].clone(), uvs[ i + 1 ].clone(), centerUV.clone() ] );\n\n\t}\n\n\tthis.computeFaceNormals();\n\n\tthis.boundingSphere = new THREE.Sphere( new THREE.Vector3(), radius );\n\n};\n\nTHREE.CircleGeometry.prototype = Object.create( THREE.Geometry.prototype );\nTHREE.CircleGeometry.prototype.constructor = THREE.CircleGeometry;\n\nTHREE.CircleGeometry.prototype.clone = function () {\n\n\tvar geometry = new THREE.CircleGeometry(\n\t\tthis.parameters.radius,\n\t\tthis.parameters.segments,\n\t\tthis.parameters.thetaStart,\n\t\tthis.parameters.thetaLength\n\t);\n\n\treturn geometry;\n\n};\n\n// File:src/extras/geometries/CircleBufferGeometry.js\n\n/**\n * @author benaadams / https://twitter.com/ben_a_adams\n */\n\nTHREE.CircleBufferGeometry = function ( radius, segments, thetaStart, thetaLength ) {\n\n\tTHREE.BufferGeometry.call( this );\n\n\tthis.type = 'CircleBufferGeometry';\n\n\tthis.parameters = {\n\t\tradius: radius,\n\t\tsegments: segments,\n\t\tthetaStart: thetaStart,\n\t\tthetaLength: thetaLength\n\t};\n\n\tradius = radius || 50;\n\tsegments = segments !== undefined ? Math.max( 3, segments ) : 8;\n\n\tthetaStart = thetaStart !== undefined ? thetaStart : 0;\n\tthetaLength = thetaLength !== undefined ? thetaLength : Math.PI * 2;\n\n\tvar vertices = segments + 2;\n\n\tvar positions = new Float32Array( vertices * 3 );\n\tvar normals = new Float32Array( vertices * 3 );\n\tvar uvs = new Float32Array( vertices * 2 );\n\n\t// center data is already zero, but need to set a few extras\n\tnormals[ 3 ] = 1.0;\n\tuvs[ 0 ] = 0.5;\n\tuvs[ 1 ] = 0.5;\n\n\tfor ( var s = 0, i = 3, ii = 2 ; s <= segments; s ++, i += 3, ii += 2 ) {\n\n\t\tvar segment = thetaStart + s / segments * thetaLength;\n\n\t\tpositions[ i ] = radius * Math.cos( segment );\n\t\tpositions[ i + 1 ] = radius * Math.sin( segment );\n\n\t\tnormals[ i + 2 ] = 1; // normal z\n\n\t\tuvs[ ii ] = ( positions[ i ] / radius + 1 ) / 2;\n\t\tuvs[ ii + 1 ] = ( positions[ i + 1 ] / radius + 1 ) / 2;\n\n\t}\n\n\tvar indices = [];\n\n\tfor ( var i = 1; i <= segments; i ++ ) {\n\n\t\tindices.push( i );\n\t\tindices.push( i + 1 );\n\t\tindices.push( 0 );\n\n\t}\n\n\tthis.setIndex( new THREE.BufferAttribute( new Uint16Array( indices ), 1 ) );\n\tthis.addAttribute( 'position', new THREE.BufferAttribute( positions, 3 ) );\n\tthis.addAttribute( 'normal', new THREE.BufferAttribute( normals, 3 ) );\n\tthis.addAttribute( 'uv', new THREE.BufferAttribute( uvs, 2 ) );\n\n\tthis.boundingSphere = new THREE.Sphere( new THREE.Vector3(), radius );\n\n};\n\nTHREE.CircleBufferGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\nTHREE.CircleBufferGeometry.prototype.constructor = THREE.CircleBufferGeometry;\n\nTHREE.CircleBufferGeometry.prototype.clone = function () {\n\n\tvar geometry = new THREE.CircleBufferGeometry(\n\t\tthis.parameters.radius,\n\t\tthis.parameters.segments,\n\t\tthis.parameters.thetaStart,\n\t\tthis.parameters.thetaLength\n\t);\n\n\tgeometry.copy( this );\n\n\treturn geometry;\n\n};\n\n// File:src/extras/geometries/CylinderGeometry.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.CylinderGeometry = function ( radiusTop, radiusBottom, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength ) {\n\n\tTHREE.Geometry.call( this );\n\n\tthis.type = 'CylinderGeometry';\n\n\tthis.parameters = {\n\t\tradiusTop: radiusTop,\n\t\tradiusBottom: radiusBottom,\n\t\theight: height,\n\t\tradialSegments: radialSegments,\n\t\theightSegments: heightSegments,\n\t\topenEnded: openEnded,\n\t\tthetaStart: thetaStart,\n\t\tthetaLength: thetaLength\n\t};\n\n\tradiusTop = radiusTop !== undefined ? radiusTop : 20;\n\tradiusBottom = radiusBottom !== undefined ? radiusBottom : 20;\n\theight = height !== undefined ? height : 100;\n\n\tradialSegments = radialSegments || 8;\n\theightSegments = heightSegments || 1;\n\n\topenEnded = openEnded !== undefined ? openEnded : false;\n\tthetaStart = thetaStart !== undefined ? thetaStart : 0;\n\tthetaLength = thetaLength !== undefined ? thetaLength : 2 * Math.PI;\n\n\tvar heightHalf = height / 2;\n\n\tvar x, y, vertices = [], uvs = [];\n\n\tfor ( y = 0; y <= heightSegments; y ++ ) {\n\n\t\tvar verticesRow = [];\n\t\tvar uvsRow = [];\n\n\t\tvar v = y / heightSegments;\n\t\tvar radius = v * ( radiusBottom - radiusTop ) + radiusTop;\n\n\t\tfor ( x = 0; x <= radialSegments; x ++ ) {\n\n\t\t\tvar u = x / radialSegments;\n\n\t\t\tvar vertex = new THREE.Vector3();\n\t\t\tvertex.x = radius * Math.sin( u * thetaLength + thetaStart );\n\t\t\tvertex.y = - v * height + heightHalf;\n\t\t\tvertex.z = radius * Math.cos( u * thetaLength + thetaStart );\n\n\t\t\tthis.vertices.push( vertex );\n\n\t\t\tverticesRow.push( this.vertices.length - 1 );\n\t\t\tuvsRow.push( new THREE.Vector2( u, 1 - v ) );\n\n\t\t}\n\n\t\tvertices.push( verticesRow );\n\t\tuvs.push( uvsRow );\n\n\t}\n\n\tvar tanTheta = ( radiusBottom - radiusTop ) / height;\n\tvar na, nb;\n\n\tfor ( x = 0; x < radialSegments; x ++ ) {\n\n\t\tif ( radiusTop !== 0 ) {\n\n\t\t\tna = this.vertices[ vertices[ 0 ][ x ] ].clone();\n\t\t\tnb = this.vertices[ vertices[ 0 ][ x + 1 ] ].clone();\n\n\t\t} else {\n\n\t\t\tna = this.vertices[ vertices[ 1 ][ x ] ].clone();\n\t\t\tnb = this.vertices[ vertices[ 1 ][ x + 1 ] ].clone();\n\n\t\t}\n\n\t\tna.setY( Math.sqrt( na.x * na.x + na.z * na.z ) * tanTheta ).normalize();\n\t\tnb.setY( Math.sqrt( nb.x * nb.x + nb.z * nb.z ) * tanTheta ).normalize();\n\n\t\tfor ( y = 0; y < heightSegments; y ++ ) {\n\n\t\t\tvar v1 = vertices[ y ][ x ];\n\t\t\tvar v2 = vertices[ y + 1 ][ x ];\n\t\t\tvar v3 = vertices[ y + 1 ][ x + 1 ];\n\t\t\tvar v4 = vertices[ y ][ x + 1 ];\n\n\t\t\tvar n1 = na.clone();\n\t\t\tvar n2 = na.clone();\n\t\t\tvar n3 = nb.clone();\n\t\t\tvar n4 = nb.clone();\n\n\t\t\tvar uv1 = uvs[ y ][ x ].clone();\n\t\t\tvar uv2 = uvs[ y + 1 ][ x ].clone();\n\t\t\tvar uv3 = uvs[ y + 1 ][ x + 1 ].clone();\n\t\t\tvar uv4 = uvs[ y ][ x + 1 ].clone();\n\n\t\t\tthis.faces.push( new THREE.Face3( v1, v2, v4, [ n1, n2, n4 ] ) );\n\t\t\tthis.faceVertexUvs[ 0 ].push( [ uv1, uv2, uv4 ] );\n\n\t\t\tthis.faces.push( new THREE.Face3( v2, v3, v4, [ n2.clone(), n3, n4.clone() ] ) );\n\t\t\tthis.faceVertexUvs[ 0 ].push( [ uv2.clone(), uv3, uv4.clone() ] );\n\n\t\t}\n\n\t}\n\n\t// top cap\n\n\tif ( openEnded === false && radiusTop > 0 ) {\n\n\t\tthis.vertices.push( new THREE.Vector3( 0, heightHalf, 0 ) );\n\n\t\tfor ( x = 0; x < radialSegments; x ++ ) {\n\n\t\t\tvar v1 = vertices[ 0 ][ x ];\n\t\t\tvar v2 = vertices[ 0 ][ x + 1 ];\n\t\t\tvar v3 = this.vertices.length - 1;\n\n\t\t\tvar n1 = new THREE.Vector3( 0, 1, 0 );\n\t\t\tvar n2 = new THREE.Vector3( 0, 1, 0 );\n\t\t\tvar n3 = new THREE.Vector3( 0, 1, 0 );\n\n\t\t\tvar uv1 = uvs[ 0 ][ x ].clone();\n\t\t\tvar uv2 = uvs[ 0 ][ x + 1 ].clone();\n\t\t\tvar uv3 = new THREE.Vector2( uv2.x, 0 );\n\n\t\t\tthis.faces.push( new THREE.Face3( v1, v2, v3, [ n1, n2, n3 ], undefined, 1 ) );\n\t\t\tthis.faceVertexUvs[ 0 ].push( [ uv1, uv2, uv3 ] );\n\n\t\t}\n\n\t}\n\n\t// bottom cap\n\n\tif ( openEnded === false && radiusBottom > 0 ) {\n\n\t\tthis.vertices.push( new THREE.Vector3( 0, - heightHalf, 0 ) );\n\n\t\tfor ( x = 0; x < radialSegments; x ++ ) {\n\n\t\t\tvar v1 = vertices[ heightSegments ][ x + 1 ];\n\t\t\tvar v2 = vertices[ heightSegments ][ x ];\n\t\t\tvar v3 = this.vertices.length - 1;\n\n\t\t\tvar n1 = new THREE.Vector3( 0, - 1, 0 );\n\t\t\tvar n2 = new THREE.Vector3( 0, - 1, 0 );\n\t\t\tvar n3 = new THREE.Vector3( 0, - 1, 0 );\n\n\t\t\tvar uv1 = uvs[ heightSegments ][ x + 1 ].clone();\n\t\t\tvar uv2 = uvs[ heightSegments ][ x ].clone();\n\t\t\tvar uv3 = new THREE.Vector2( uv2.x, 1 );\n\n\t\t\tthis.faces.push( new THREE.Face3( v1, v2, v3, [ n1, n2, n3 ], undefined, 2 ) );\n\t\t\tthis.faceVertexUvs[ 0 ].push( [ uv1, uv2, uv3 ] );\n\n\t\t}\n\n\t}\n\n\tthis.computeFaceNormals();\n\n};\n\nTHREE.CylinderGeometry.prototype = Object.create( THREE.Geometry.prototype );\nTHREE.CylinderGeometry.prototype.constructor = THREE.CylinderGeometry;\n\nTHREE.CylinderGeometry.prototype.clone = function () {\n\n\tvar geometry = new THREE.CylinderGeometry(\n\t\tthis.parameters.radiusTop,\n\t\tthis.parameters.radiusBottom,\n\t\tthis.parameters.height,\n\t\tthis.parameters.radialSegments,\n\t\tthis.parameters.heightSegments,\n\t\tthis.parameters.openEnded,\n\t\tthis.parameters.thetaStart,\n\t\tthis.parameters.thetaLength\n\t);\n\n\treturn geometry;\n\n};\n\n// File:src/extras/geometries/EdgesGeometry.js\n\n/**\n * @author WestLangley / http://github.com/WestLangley\n */\n\nTHREE.EdgesGeometry = function ( geometry, thresholdAngle ) {\n\n\tTHREE.BufferGeometry.call( this );\n\n\tthresholdAngle = ( thresholdAngle !== undefined ) ? thresholdAngle : 1;\n\n\tvar thresholdDot = Math.cos( THREE.Math.degToRad( thresholdAngle ) );\n\n\tvar edge = [ 0, 0 ], hash = {};\n\tvar sortFunction = function ( a, b ) {\n\n\t\treturn a - b;\n\n\t};\n\n\tvar keys = [ 'a', 'b', 'c' ];\n\n\tvar geometry2;\n\n\tif ( geometry instanceof THREE.BufferGeometry ) {\n\n\t\tgeometry2 = new THREE.Geometry();\n\t\tgeometry2.fromBufferGeometry( geometry );\n\n\t} else {\n\n\t\tgeometry2 = geometry.clone();\n\n\t}\n\n\tgeometry2.mergeVertices();\n\tgeometry2.computeFaceNormals();\n\n\tvar vertices = geometry2.vertices;\n\tvar faces = geometry2.faces;\n\n\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\n\n\t\tvar face = faces[ i ];\n\n\t\tfor ( var j = 0; j < 3; j ++ ) {\n\n\t\t\tedge[ 0 ] = face[ keys[ j ] ];\n\t\t\tedge[ 1 ] = face[ keys[ ( j + 1 ) % 3 ] ];\n\t\t\tedge.sort( sortFunction );\n\n\t\t\tvar key = edge.toString();\n\n\t\t\tif ( hash[ key ] === undefined ) {\n\n\t\t\t\thash[ key ] = { vert1: edge[ 0 ], vert2: edge[ 1 ], face1: i, face2: undefined };\n\n\t\t\t} else {\n\n\t\t\t\thash[ key ].face2 = i;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tvar coords = [];\n\n\tfor ( var key in hash ) {\n\n\t\tvar h = hash[ key ];\n\n\t\tif ( h.face2 === undefined || faces[ h.face1 ].normal.dot( faces[ h.face2 ].normal ) <= thresholdDot ) {\n\n\t\t\tvar vertex = vertices[ h.vert1 ];\n\t\t\tcoords.push( vertex.x );\n\t\t\tcoords.push( vertex.y );\n\t\t\tcoords.push( vertex.z );\n\n\t\t\tvertex = vertices[ h.vert2 ];\n\t\t\tcoords.push( vertex.x );\n\t\t\tcoords.push( vertex.y );\n\t\t\tcoords.push( vertex.z );\n\n\t\t}\n\n\t}\n\n\tthis.addAttribute( 'position', new THREE.BufferAttribute( new Float32Array( coords ), 3 ) );\n\n};\n\nTHREE.EdgesGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\nTHREE.EdgesGeometry.prototype.constructor = THREE.EdgesGeometry;\n\n// File:src/extras/geometries/ExtrudeGeometry.js\n\n/**\n * @author zz85 / http://www.lab4games.net/zz85/blog\n *\n * Creates extruded geometry from a path shape.\n *\n * parameters = {\n *\n *  curveSegments: <int>, // number of points on the curves\n *  steps: <int>, // number of points for z-side extrusions / used for subdividing segments of extrude spline too\n *  amount: <int>, // Depth to extrude the shape\n *\n *  bevelEnabled: <bool>, // turn on bevel\n *  bevelThickness: <float>, // how deep into the original shape bevel goes\n *  bevelSize: <float>, // how far from shape outline is bevel\n *  bevelSegments: <int>, // number of bevel layers\n *\n *  extrudePath: <THREE.CurvePath> // 3d spline path to extrude shape along. (creates Frames if .frames aren't defined)\n *  frames: <THREE.TubeGeometry.FrenetFrames> // containing arrays of tangents, normals, binormals\n *\n *  uvGenerator: <Object> // object that provides UV generator functions\n *\n * }\n **/\n\nTHREE.ExtrudeGeometry = function ( shapes, options ) {\n\n\tif ( typeof( shapes ) === \"undefined\" ) {\n\n\t\tshapes = [];\n\t\treturn;\n\n\t}\n\n\tTHREE.Geometry.call( this );\n\n\tthis.type = 'ExtrudeGeometry';\n\n\tshapes = Array.isArray( shapes ) ? shapes : [ shapes ];\n\n\tthis.addShapeList( shapes, options );\n\n\tthis.computeFaceNormals();\n\n\t// can't really use automatic vertex normals\n\t// as then front and back sides get smoothed too\n\t// should do separate smoothing just for sides\n\n\t//this.computeVertexNormals();\n\n\t//console.log( \"took\", ( Date.now() - startTime ) );\n\n};\n\nTHREE.ExtrudeGeometry.prototype = Object.create( THREE.Geometry.prototype );\nTHREE.ExtrudeGeometry.prototype.constructor = THREE.ExtrudeGeometry;\n\nTHREE.ExtrudeGeometry.prototype.addShapeList = function ( shapes, options ) {\n\n\tvar sl = shapes.length;\n\n\tfor ( var s = 0; s < sl; s ++ ) {\n\n\t\tvar shape = shapes[ s ];\n\t\tthis.addShape( shape, options );\n\n\t}\n\n};\n\nTHREE.ExtrudeGeometry.prototype.addShape = function ( shape, options ) {\n\n\tvar amount = options.amount !== undefined ? options.amount : 100;\n\n\tvar bevelThickness = options.bevelThickness !== undefined ? options.bevelThickness : 6; // 10\n\tvar bevelSize = options.bevelSize !== undefined ? options.bevelSize : bevelThickness - 2; // 8\n\tvar bevelSegments = options.bevelSegments !== undefined ? options.bevelSegments : 3;\n\n\tvar bevelEnabled = options.bevelEnabled !== undefined ? options.bevelEnabled : true; // false\n\n\tvar curveSegments = options.curveSegments !== undefined ? options.curveSegments : 12;\n\n\tvar steps = options.steps !== undefined ? options.steps : 1;\n\n\tvar extrudePath = options.extrudePath;\n\tvar extrudePts, extrudeByPath = false;\n\n\t// Use default WorldUVGenerator if no UV generators are specified.\n\tvar uvgen = options.UVGenerator !== undefined ? options.UVGenerator : THREE.ExtrudeGeometry.WorldUVGenerator;\n\n\tvar splineTube, binormal, normal, position2;\n\tif ( extrudePath ) {\n\n\t\textrudePts = extrudePath.getSpacedPoints( steps );\n\n\t\textrudeByPath = true;\n\t\tbevelEnabled = false; // bevels not supported for path extrusion\n\n\t\t// SETUP TNB variables\n\n\t\t// Reuse TNB from TubeGeomtry for now.\n\t\t// TODO1 - have a .isClosed in spline?\n\n\t\tsplineTube = options.frames !== undefined ? options.frames : new THREE.TubeGeometry.FrenetFrames( extrudePath, steps, false );\n\n\t\t// console.log(splineTube, 'splineTube', splineTube.normals.length, 'steps', steps, 'extrudePts', extrudePts.length);\n\n\t\tbinormal = new THREE.Vector3();\n\t\tnormal = new THREE.Vector3();\n\t\tposition2 = new THREE.Vector3();\n\n\t}\n\n\t// Safeguards if bevels are not enabled\n\n\tif ( ! bevelEnabled ) {\n\n\t\tbevelSegments = 0;\n\t\tbevelThickness = 0;\n\t\tbevelSize = 0;\n\n\t}\n\n\t// Variables initialization\n\n\tvar ahole, h, hl; // looping of holes\n\tvar scope = this;\n\n\tvar shapesOffset = this.vertices.length;\n\n\tvar shapePoints = shape.extractPoints( curveSegments );\n\n\tvar vertices = shapePoints.shape;\n\tvar holes = shapePoints.holes;\n\n\tvar reverse = ! THREE.Shape.Utils.isClockWise( vertices );\n\n\tif ( reverse ) {\n\n\t\tvertices = vertices.reverse();\n\n\t\t// Maybe we should also check if holes are in the opposite direction, just to be safe ...\n\n\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\tahole = holes[ h ];\n\n\t\t\tif ( THREE.Shape.Utils.isClockWise( ahole ) ) {\n\n\t\t\t\tholes[ h ] = ahole.reverse();\n\n\t\t\t}\n\n\t\t}\n\n\t\treverse = false; // If vertices are in order now, we shouldn't need to worry about them again (hopefully)!\n\n\t}\n\n\n\tvar faces = THREE.Shape.Utils.triangulateShape ( vertices, holes );\n\n\t/* Vertices */\n\n\tvar contour = vertices; // vertices has all points but contour has only points of circumference\n\n\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\tahole = holes[ h ];\n\n\t\tvertices = vertices.concat( ahole );\n\n\t}\n\n\n\tfunction scalePt2 ( pt, vec, size ) {\n\n\t\tif ( ! vec ) console.error( \"THREE.ExtrudeGeometry: vec does not exist\" );\n\n\t\treturn vec.clone().multiplyScalar( size ).add( pt );\n\n\t}\n\n\tvar b, bs, t, z,\n\t\tvert, vlen = vertices.length,\n\t\tface, flen = faces.length;\n\n\n\t// Find directions for point movement\n\n\n\tfunction getBevelVec( inPt, inPrev, inNext ) {\n\n\t\tvar EPSILON = 0.0000000001;\n\n\t\t// computes for inPt the corresponding point inPt' on a new contour\n\t\t//   shifted by 1 unit (length of normalized vector) to the left\n\t\t// if we walk along contour clockwise, this new contour is outside the old one\n\t\t//\n\t\t// inPt' is the intersection of the two lines parallel to the two\n\t\t//  adjacent edges of inPt at a distance of 1 unit on the left side.\n\n\t\tvar v_trans_x, v_trans_y, shrink_by = 1;\t\t// resulting translation vector for inPt\n\n\t\t// good reading for geometry algorithms (here: line-line intersection)\n\t\t// http://geomalgorithms.com/a05-_intersect-1.html\n\n\t\tvar v_prev_x = inPt.x - inPrev.x, v_prev_y = inPt.y - inPrev.y;\n\t\tvar v_next_x = inNext.x - inPt.x, v_next_y = inNext.y - inPt.y;\n\n\t\tvar v_prev_lensq = ( v_prev_x * v_prev_x + v_prev_y * v_prev_y );\n\n\t\t// check for collinear edges\n\t\tvar collinear0 = ( v_prev_x * v_next_y - v_prev_y * v_next_x );\n\n\t\tif ( Math.abs( collinear0 ) > EPSILON ) {\n\n\t\t\t// not collinear\n\n\t\t\t// length of vectors for normalizing\n\n\t\t\tvar v_prev_len = Math.sqrt( v_prev_lensq );\n\t\t\tvar v_next_len = Math.sqrt( v_next_x * v_next_x + v_next_y * v_next_y );\n\n\t\t\t// shift adjacent points by unit vectors to the left\n\n\t\t\tvar ptPrevShift_x = ( inPrev.x - v_prev_y / v_prev_len );\n\t\t\tvar ptPrevShift_y = ( inPrev.y + v_prev_x / v_prev_len );\n\n\t\t\tvar ptNextShift_x = ( inNext.x - v_next_y / v_next_len );\n\t\t\tvar ptNextShift_y = ( inNext.y + v_next_x / v_next_len );\n\n\t\t\t// scaling factor for v_prev to intersection point\n\n\t\t\tvar sf = (  ( ptNextShift_x - ptPrevShift_x ) * v_next_y -\n\t\t\t\t\t\t( ptNextShift_y - ptPrevShift_y ) * v_next_x    ) /\n\t\t\t\t\t  ( v_prev_x * v_next_y - v_prev_y * v_next_x );\n\n\t\t\t// vector from inPt to intersection point\n\n\t\t\tv_trans_x = ( ptPrevShift_x + v_prev_x * sf - inPt.x );\n\t\t\tv_trans_y = ( ptPrevShift_y + v_prev_y * sf - inPt.y );\n\n\t\t\t// Don't normalize!, otherwise sharp corners become ugly\n\t\t\t//  but prevent crazy spikes\n\t\t\tvar v_trans_lensq = ( v_trans_x * v_trans_x + v_trans_y * v_trans_y );\n\t\t\tif ( v_trans_lensq <= 2 ) {\n\n\t\t\t\treturn\tnew THREE.Vector2( v_trans_x, v_trans_y );\n\n\t\t\t} else {\n\n\t\t\t\tshrink_by = Math.sqrt( v_trans_lensq / 2 );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t// handle special case of collinear edges\n\n\t\t\tvar direction_eq = false;\t\t// assumes: opposite\n\t\t\tif ( v_prev_x > EPSILON ) {\n\n\t\t\t\tif ( v_next_x > EPSILON ) {\n\n\t\t\t\t\tdirection_eq = true;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tif ( v_prev_x < - EPSILON ) {\n\n\t\t\t\t\tif ( v_next_x < - EPSILON ) {\n\n\t\t\t\t\t\tdirection_eq = true;\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( Math.sign( v_prev_y ) === Math.sign( v_next_y ) ) {\n\n\t\t\t\t\t\tdirection_eq = true;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( direction_eq ) {\n\n\t\t\t\t// console.log(\"Warning: lines are a straight sequence\");\n\t\t\t\tv_trans_x = - v_prev_y;\n\t\t\t\tv_trans_y =  v_prev_x;\n\t\t\t\tshrink_by = Math.sqrt( v_prev_lensq );\n\n\t\t\t} else {\n\n\t\t\t\t// console.log(\"Warning: lines are a straight spike\");\n\t\t\t\tv_trans_x = v_prev_x;\n\t\t\t\tv_trans_y = v_prev_y;\n\t\t\t\tshrink_by = Math.sqrt( v_prev_lensq / 2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn\tnew THREE.Vector2( v_trans_x / shrink_by, v_trans_y / shrink_by );\n\n\t}\n\n\n\tvar contourMovements = [];\n\n\tfor ( var i = 0, il = contour.length, j = il - 1, k = i + 1; i < il; i ++, j ++, k ++ ) {\n\n\t\tif ( j === il ) j = 0;\n\t\tif ( k === il ) k = 0;\n\n\t\t//  (j)---(i)---(k)\n\t\t// console.log('i,j,k', i, j , k)\n\n\t\tcontourMovements[ i ] = getBevelVec( contour[ i ], contour[ j ], contour[ k ] );\n\n\t}\n\n\tvar holesMovements = [], oneHoleMovements, verticesMovements = contourMovements.concat();\n\n\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\tahole = holes[ h ];\n\n\t\toneHoleMovements = [];\n\n\t\tfor ( i = 0, il = ahole.length, j = il - 1, k = i + 1; i < il; i ++, j ++, k ++ ) {\n\n\t\t\tif ( j === il ) j = 0;\n\t\t\tif ( k === il ) k = 0;\n\n\t\t\t//  (j)---(i)---(k)\n\t\t\toneHoleMovements[ i ] = getBevelVec( ahole[ i ], ahole[ j ], ahole[ k ] );\n\n\t\t}\n\n\t\tholesMovements.push( oneHoleMovements );\n\t\tverticesMovements = verticesMovements.concat( oneHoleMovements );\n\n\t}\n\n\n\t// Loop bevelSegments, 1 for the front, 1 for the back\n\n\tfor ( b = 0; b < bevelSegments; b ++ ) {\n\n\t\t//for ( b = bevelSegments; b > 0; b -- ) {\n\n\t\tt = b / bevelSegments;\n\t\tz = bevelThickness * ( 1 - t );\n\n\t\t//z = bevelThickness * t;\n\t\tbs = bevelSize * ( Math.sin ( t * Math.PI / 2 ) ); // curved\n\t\t//bs = bevelSize * t; // linear\n\n\t\t// contract shape\n\n\t\tfor ( i = 0, il = contour.length; i < il; i ++ ) {\n\n\t\t\tvert = scalePt2( contour[ i ], contourMovements[ i ], bs );\n\n\t\t\tv( vert.x, vert.y,  - z );\n\n\t\t}\n\n\t\t// expand holes\n\n\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\tahole = holes[ h ];\n\t\t\toneHoleMovements = holesMovements[ h ];\n\n\t\t\tfor ( i = 0, il = ahole.length; i < il; i ++ ) {\n\n\t\t\t\tvert = scalePt2( ahole[ i ], oneHoleMovements[ i ], bs );\n\n\t\t\t\tv( vert.x, vert.y,  - z );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tbs = bevelSize;\n\n\t// Back facing vertices\n\n\tfor ( i = 0; i < vlen; i ++ ) {\n\n\t\tvert = bevelEnabled ? scalePt2( vertices[ i ], verticesMovements[ i ], bs ) : vertices[ i ];\n\n\t\tif ( ! extrudeByPath ) {\n\n\t\t\tv( vert.x, vert.y, 0 );\n\n\t\t} else {\n\n\t\t\t// v( vert.x, vert.y + extrudePts[ 0 ].y, extrudePts[ 0 ].x );\n\n\t\t\tnormal.copy( splineTube.normals[ 0 ] ).multiplyScalar( vert.x );\n\t\t\tbinormal.copy( splineTube.binormals[ 0 ] ).multiplyScalar( vert.y );\n\n\t\t\tposition2.copy( extrudePts[ 0 ] ).add( normal ).add( binormal );\n\n\t\t\tv( position2.x, position2.y, position2.z );\n\n\t\t}\n\n\t}\n\n\t// Add stepped vertices...\n\t// Including front facing vertices\n\n\tvar s;\n\n\tfor ( s = 1; s <= steps; s ++ ) {\n\n\t\tfor ( i = 0; i < vlen; i ++ ) {\n\n\t\t\tvert = bevelEnabled ? scalePt2( vertices[ i ], verticesMovements[ i ], bs ) : vertices[ i ];\n\n\t\t\tif ( ! extrudeByPath ) {\n\n\t\t\t\tv( vert.x, vert.y, amount / steps * s );\n\n\t\t\t} else {\n\n\t\t\t\t// v( vert.x, vert.y + extrudePts[ s - 1 ].y, extrudePts[ s - 1 ].x );\n\n\t\t\t\tnormal.copy( splineTube.normals[ s ] ).multiplyScalar( vert.x );\n\t\t\t\tbinormal.copy( splineTube.binormals[ s ] ).multiplyScalar( vert.y );\n\n\t\t\t\tposition2.copy( extrudePts[ s ] ).add( normal ).add( binormal );\n\n\t\t\t\tv( position2.x, position2.y, position2.z );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\n\t// Add bevel segments planes\n\n\t//for ( b = 1; b <= bevelSegments; b ++ ) {\n\tfor ( b = bevelSegments - 1; b >= 0; b -- ) {\n\n\t\tt = b / bevelSegments;\n\t\tz = bevelThickness * ( 1 - t );\n\t\t//bs = bevelSize * ( 1-Math.sin ( ( 1 - t ) * Math.PI/2 ) );\n\t\tbs = bevelSize * Math.sin ( t * Math.PI / 2 );\n\n\t\t// contract shape\n\n\t\tfor ( i = 0, il = contour.length; i < il; i ++ ) {\n\n\t\t\tvert = scalePt2( contour[ i ], contourMovements[ i ], bs );\n\t\t\tv( vert.x, vert.y,  amount + z );\n\n\t\t}\n\n\t\t// expand holes\n\n\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\tahole = holes[ h ];\n\t\t\toneHoleMovements = holesMovements[ h ];\n\n\t\t\tfor ( i = 0, il = ahole.length; i < il; i ++ ) {\n\n\t\t\t\tvert = scalePt2( ahole[ i ], oneHoleMovements[ i ], bs );\n\n\t\t\t\tif ( ! extrudeByPath ) {\n\n\t\t\t\t\tv( vert.x, vert.y,  amount + z );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tv( vert.x, vert.y + extrudePts[ steps - 1 ].y, extrudePts[ steps - 1 ].x + z );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t/* Faces */\n\n\t// Top and bottom faces\n\n\tbuildLidFaces();\n\n\t// Sides faces\n\n\tbuildSideFaces();\n\n\n\t/////  Internal functions\n\n\tfunction buildLidFaces() {\n\n\t\tif ( bevelEnabled ) {\n\n\t\t\tvar layer = 0; // steps + 1\n\t\t\tvar offset = vlen * layer;\n\n\t\t\t// Bottom faces\n\n\t\t\tfor ( i = 0; i < flen; i ++ ) {\n\n\t\t\t\tface = faces[ i ];\n\t\t\t\tf3( face[ 2 ] + offset, face[ 1 ] + offset, face[ 0 ] + offset );\n\n\t\t\t}\n\n\t\t\tlayer = steps + bevelSegments * 2;\n\t\t\toffset = vlen * layer;\n\n\t\t\t// Top faces\n\n\t\t\tfor ( i = 0; i < flen; i ++ ) {\n\n\t\t\t\tface = faces[ i ];\n\t\t\t\tf3( face[ 0 ] + offset, face[ 1 ] + offset, face[ 2 ] + offset );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t// Bottom faces\n\n\t\t\tfor ( i = 0; i < flen; i ++ ) {\n\n\t\t\t\tface = faces[ i ];\n\t\t\t\tf3( face[ 2 ], face[ 1 ], face[ 0 ] );\n\n\t\t\t}\n\n\t\t\t// Top faces\n\n\t\t\tfor ( i = 0; i < flen; i ++ ) {\n\n\t\t\t\tface = faces[ i ];\n\t\t\t\tf3( face[ 0 ] + vlen * steps, face[ 1 ] + vlen * steps, face[ 2 ] + vlen * steps );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t// Create faces for the z-sides of the shape\n\n\tfunction buildSideFaces() {\n\n\t\tvar layeroffset = 0;\n\t\tsidewalls( contour, layeroffset );\n\t\tlayeroffset += contour.length;\n\n\t\tfor ( h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\tahole = holes[ h ];\n\t\t\tsidewalls( ahole, layeroffset );\n\n\t\t\t//, true\n\t\t\tlayeroffset += ahole.length;\n\n\t\t}\n\n\t}\n\n\tfunction sidewalls( contour, layeroffset ) {\n\n\t\tvar j, k;\n\t\ti = contour.length;\n\n\t\twhile ( -- i >= 0 ) {\n\n\t\t\tj = i;\n\t\t\tk = i - 1;\n\t\t\tif ( k < 0 ) k = contour.length - 1;\n\n\t\t\t//console.log('b', i,j, i-1, k,vertices.length);\n\n\t\t\tvar s = 0, sl = steps  + bevelSegments * 2;\n\n\t\t\tfor ( s = 0; s < sl; s ++ ) {\n\n\t\t\t\tvar slen1 = vlen * s;\n\t\t\t\tvar slen2 = vlen * ( s + 1 );\n\n\t\t\t\tvar a = layeroffset + j + slen1,\n\t\t\t\t\tb = layeroffset + k + slen1,\n\t\t\t\t\tc = layeroffset + k + slen2,\n\t\t\t\t\td = layeroffset + j + slen2;\n\n\t\t\t\tf4( a, b, c, d, contour, s, sl, j, k );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\n\tfunction v( x, y, z ) {\n\n\t\tscope.vertices.push( new THREE.Vector3( x, y, z ) );\n\n\t}\n\n\tfunction f3( a, b, c ) {\n\n\t\ta += shapesOffset;\n\t\tb += shapesOffset;\n\t\tc += shapesOffset;\n\n\t\tscope.faces.push( new THREE.Face3( a, b, c ) );\n\n\t\tvar uvs = uvgen.generateTopUV( scope, a, b, c );\n\n\t\tscope.faceVertexUvs[ 0 ].push( uvs );\n\n\t}\n\n\tfunction f4( a, b, c, d, wallContour, stepIndex, stepsLength, contourIndex1, contourIndex2 ) {\n\n\t\ta += shapesOffset;\n\t\tb += shapesOffset;\n\t\tc += shapesOffset;\n\t\td += shapesOffset;\n\n\t\tscope.faces.push( new THREE.Face3( a, b, d ) );\n\t\tscope.faces.push( new THREE.Face3( b, c, d ) );\n\n\t\tvar uvs = uvgen.generateSideWallUV( scope, a, b, c, d );\n\n\t\tscope.faceVertexUvs[ 0 ].push( [ uvs[ 0 ], uvs[ 1 ], uvs[ 3 ] ] );\n\t\tscope.faceVertexUvs[ 0 ].push( [ uvs[ 1 ], uvs[ 2 ], uvs[ 3 ] ] );\n\n\t}\n\n};\n\nTHREE.ExtrudeGeometry.WorldUVGenerator = {\n\n\tgenerateTopUV: function ( geometry, indexA, indexB, indexC ) {\n\n\t\tvar vertices = geometry.vertices;\n\n\t\tvar a = vertices[ indexA ];\n\t\tvar b = vertices[ indexB ];\n\t\tvar c = vertices[ indexC ];\n\n\t\treturn [\n\t\t\tnew THREE.Vector2( a.x, a.y ),\n\t\t\tnew THREE.Vector2( b.x, b.y ),\n\t\t\tnew THREE.Vector2( c.x, c.y )\n\t\t];\n\n\t},\n\n\tgenerateSideWallUV: function ( geometry, indexA, indexB, indexC, indexD ) {\n\n\t\tvar vertices = geometry.vertices;\n\n\t\tvar a = vertices[ indexA ];\n\t\tvar b = vertices[ indexB ];\n\t\tvar c = vertices[ indexC ];\n\t\tvar d = vertices[ indexD ];\n\n\t\tif ( Math.abs( a.y - b.y ) < 0.01 ) {\n\n\t\t\treturn [\n\t\t\t\tnew THREE.Vector2( a.x, 1 - a.z ),\n\t\t\t\tnew THREE.Vector2( b.x, 1 - b.z ),\n\t\t\t\tnew THREE.Vector2( c.x, 1 - c.z ),\n\t\t\t\tnew THREE.Vector2( d.x, 1 - d.z )\n\t\t\t];\n\n\t\t} else {\n\n\t\t\treturn [\n\t\t\t\tnew THREE.Vector2( a.y, 1 - a.z ),\n\t\t\t\tnew THREE.Vector2( b.y, 1 - b.z ),\n\t\t\t\tnew THREE.Vector2( c.y, 1 - c.z ),\n\t\t\t\tnew THREE.Vector2( d.y, 1 - d.z )\n\t\t\t];\n\n\t\t}\n\n\t}\n};\n\n// File:src/extras/geometries/ShapeGeometry.js\n\n/**\n * @author jonobr1 / http://jonobr1.com\n *\n * Creates a one-sided polygonal geometry from a path shape. Similar to\n * ExtrudeGeometry.\n *\n * parameters = {\n *\n *\tcurveSegments: <int>, // number of points on the curves. NOT USED AT THE MOMENT.\n *\n *\tmaterial: <int> // material index for front and back faces\n *\tuvGenerator: <Object> // object that provides UV generator functions\n *\n * }\n **/\n\nTHREE.ShapeGeometry = function ( shapes, options ) {\n\n\tTHREE.Geometry.call( this );\n\n\tthis.type = 'ShapeGeometry';\n\n\tif ( Array.isArray( shapes ) === false ) shapes = [ shapes ];\n\n\tthis.addShapeList( shapes, options );\n\n\tthis.computeFaceNormals();\n\n};\n\nTHREE.ShapeGeometry.prototype = Object.create( THREE.Geometry.prototype );\nTHREE.ShapeGeometry.prototype.constructor = THREE.ShapeGeometry;\n\n/**\n * Add an array of shapes to THREE.ShapeGeometry.\n */\nTHREE.ShapeGeometry.prototype.addShapeList = function ( shapes, options ) {\n\n\tfor ( var i = 0, l = shapes.length; i < l; i ++ ) {\n\n\t\tthis.addShape( shapes[ i ], options );\n\n\t}\n\n\treturn this;\n\n};\n\n/**\n * Adds a shape to THREE.ShapeGeometry, based on THREE.ExtrudeGeometry.\n */\nTHREE.ShapeGeometry.prototype.addShape = function ( shape, options ) {\n\n\tif ( options === undefined ) options = {};\n\tvar curveSegments = options.curveSegments !== undefined ? options.curveSegments : 12;\n\n\tvar material = options.material;\n\tvar uvgen = options.UVGenerator === undefined ? THREE.ExtrudeGeometry.WorldUVGenerator : options.UVGenerator;\n\n\t//\n\n\tvar i, l, hole;\n\n\tvar shapesOffset = this.vertices.length;\n\tvar shapePoints = shape.extractPoints( curveSegments );\n\n\tvar vertices = shapePoints.shape;\n\tvar holes = shapePoints.holes;\n\n\tvar reverse = ! THREE.Shape.Utils.isClockWise( vertices );\n\n\tif ( reverse ) {\n\n\t\tvertices = vertices.reverse();\n\n\t\t// Maybe we should also check if holes are in the opposite direction, just to be safe...\n\n\t\tfor ( i = 0, l = holes.length; i < l; i ++ ) {\n\n\t\t\thole = holes[ i ];\n\n\t\t\tif ( THREE.Shape.Utils.isClockWise( hole ) ) {\n\n\t\t\t\tholes[ i ] = hole.reverse();\n\n\t\t\t}\n\n\t\t}\n\n\t\treverse = false;\n\n\t}\n\n\tvar faces = THREE.Shape.Utils.triangulateShape( vertices, holes );\n\n\t// Vertices\n\n\tfor ( i = 0, l = holes.length; i < l; i ++ ) {\n\n\t\thole = holes[ i ];\n\t\tvertices = vertices.concat( hole );\n\n\t}\n\n\t//\n\n\tvar vert, vlen = vertices.length;\n\tvar face, flen = faces.length;\n\n\tfor ( i = 0; i < vlen; i ++ ) {\n\n\t\tvert = vertices[ i ];\n\n\t\tthis.vertices.push( new THREE.Vector3( vert.x, vert.y, 0 ) );\n\n\t}\n\n\tfor ( i = 0; i < flen; i ++ ) {\n\n\t\tface = faces[ i ];\n\n\t\tvar a = face[ 0 ] + shapesOffset;\n\t\tvar b = face[ 1 ] + shapesOffset;\n\t\tvar c = face[ 2 ] + shapesOffset;\n\n\t\tthis.faces.push( new THREE.Face3( a, b, c, null, null, material ) );\n\t\tthis.faceVertexUvs[ 0 ].push( uvgen.generateTopUV( this, a, b, c ) );\n\n\t}\n\n};\n\n// File:src/extras/geometries/LatheGeometry.js\n\n/**\n * @author astrodud / http://astrodud.isgreat.org/\n * @author zz85 / https://github.com/zz85\n * @author bhouston / http://exocortex.com\n */\n\n// points - to create a closed torus, one must use a set of points \n//    like so: [ a, b, c, d, a ], see first is the same as last.\n// segments - the number of circumference segments to create\n// phiStart - the starting radian\n// phiLength - the radian (0 to 2*PI) range of the lathed section\n//    2*pi is a closed lathe, less than 2PI is a portion.\n\nTHREE.LatheGeometry = function ( points, segments, phiStart, phiLength ) {\n\n\tTHREE.Geometry.call( this );\n\n\tthis.type = 'LatheGeometry';\n\n\tthis.parameters = {\n\t\tpoints: points,\n\t\tsegments: segments,\n\t\tphiStart: phiStart,\n\t\tphiLength: phiLength\n\t};\n\n\tsegments = segments || 12;\n\tphiStart = phiStart || 0;\n\tphiLength = phiLength || 2 * Math.PI;\n\n\tvar inversePointLength = 1.0 / ( points.length - 1 );\n\tvar inverseSegments = 1.0 / segments;\n\n\tfor ( var i = 0, il = segments; i <= il; i ++ ) {\n\n\t\tvar phi = phiStart + i * inverseSegments * phiLength;\n\n\t\tvar c = Math.cos( phi ),\n\t\t\ts = Math.sin( phi );\n\n\t\tfor ( var j = 0, jl = points.length; j < jl; j ++ ) {\n\n\t\t\tvar pt = points[ j ];\n\n\t\t\tvar vertex = new THREE.Vector3();\n\n\t\t\tvertex.x = c * pt.x - s * pt.y;\n\t\t\tvertex.y = s * pt.x + c * pt.y;\n\t\t\tvertex.z = pt.z;\n\n\t\t\tthis.vertices.push( vertex );\n\n\t\t}\n\n\t}\n\n\tvar np = points.length;\n\n\tfor ( var i = 0, il = segments; i < il; i ++ ) {\n\n\t\tfor ( var j = 0, jl = points.length - 1; j < jl; j ++ ) {\n\n\t\t\tvar base = j + np * i;\n\t\t\tvar a = base;\n\t\t\tvar b = base + np;\n\t\t\tvar c = base + 1 + np;\n\t\t\tvar d = base + 1;\n\n\t\t\tvar u0 = i * inverseSegments;\n\t\t\tvar v0 = j * inversePointLength;\n\t\t\tvar u1 = u0 + inverseSegments;\n\t\t\tvar v1 = v0 + inversePointLength;\n\n\t\t\tthis.faces.push( new THREE.Face3( a, b, d ) );\n\n\t\t\tthis.faceVertexUvs[ 0 ].push( [\n\n\t\t\t\tnew THREE.Vector2( u0, v0 ),\n\t\t\t\tnew THREE.Vector2( u1, v0 ),\n\t\t\t\tnew THREE.Vector2( u0, v1 )\n\n\t\t\t] );\n\n\t\t\tthis.faces.push( new THREE.Face3( b, c, d ) );\n\n\t\t\tthis.faceVertexUvs[ 0 ].push( [\n\n\t\t\t\tnew THREE.Vector2( u1, v0 ),\n\t\t\t\tnew THREE.Vector2( u1, v1 ),\n\t\t\t\tnew THREE.Vector2( u0, v1 )\n\n\t\t\t] );\n\n\n\t\t}\n\n\t}\n\n\tthis.mergeVertices();\n\tthis.computeFaceNormals();\n\tthis.computeVertexNormals();\n\n};\n\nTHREE.LatheGeometry.prototype = Object.create( THREE.Geometry.prototype );\nTHREE.LatheGeometry.prototype.constructor = THREE.LatheGeometry;\n\n// File:src/extras/geometries/PlaneGeometry.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n * based on http://papervision3d.googlecode.com/svn/trunk/as3/trunk/src/org/papervision3d/objects/primitives/Plane.as\n */\n\nTHREE.PlaneGeometry = function ( width, height, widthSegments, heightSegments ) {\n\n\tTHREE.Geometry.call( this );\n\n\tthis.type = 'PlaneGeometry';\n\n\tthis.parameters = {\n\t\twidth: width,\n\t\theight: height,\n\t\twidthSegments: widthSegments,\n\t\theightSegments: heightSegments\n\t};\n\n\tthis.fromBufferGeometry( new THREE.PlaneBufferGeometry( width, height, widthSegments, heightSegments ) );\n\n};\n\nTHREE.PlaneGeometry.prototype = Object.create( THREE.Geometry.prototype );\nTHREE.PlaneGeometry.prototype.constructor = THREE.PlaneGeometry;\n\nTHREE.PlaneGeometry.prototype.clone = function () {\n\n\tvar geometry = new THREE.PlaneGeometry(\n\t\tthis.parameters.width,\n\t\tthis.parameters.height,\n\t\tthis.parameters.widthSegments,\n\t\tthis.parameters.heightSegments\n\t);\n\n\treturn geometry;\n\n};\n\n// File:src/extras/geometries/PlaneBufferGeometry.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n * based on http://papervision3d.googlecode.com/svn/trunk/as3/trunk/src/org/papervision3d/objects/primitives/Plane.as\n */\n\nTHREE.PlaneBufferGeometry = function ( width, height, widthSegments, heightSegments ) {\n\n\tTHREE.BufferGeometry.call( this );\n\n\tthis.type = 'PlaneBufferGeometry';\n\n\tthis.parameters = {\n\t\twidth: width,\n\t\theight: height,\n\t\twidthSegments: widthSegments,\n\t\theightSegments: heightSegments\n\t};\n\n\tvar width_half = width / 2;\n\tvar height_half = height / 2;\n\n\tvar gridX = Math.floor( widthSegments ) || 1;\n\tvar gridY = Math.floor( heightSegments ) || 1;\n\n\tvar gridX1 = gridX + 1;\n\tvar gridY1 = gridY + 1;\n\n\tvar segment_width = width / gridX;\n\tvar segment_height = height / gridY;\n\n\tvar vertices = new Float32Array( gridX1 * gridY1 * 3 );\n\tvar normals = new Float32Array( gridX1 * gridY1 * 3 );\n\tvar uvs = new Float32Array( gridX1 * gridY1 * 2 );\n\n\tvar offset = 0;\n\tvar offset2 = 0;\n\n\tfor ( var iy = 0; iy < gridY1; iy ++ ) {\n\n\t\tvar y = iy * segment_height - height_half;\n\n\t\tfor ( var ix = 0; ix < gridX1; ix ++ ) {\n\n\t\t\tvar x = ix * segment_width - width_half;\n\n\t\t\tvertices[ offset ] = x;\n\t\t\tvertices[ offset + 1 ] = - y;\n\n\t\t\tnormals[ offset + 2 ] = 1;\n\n\t\t\tuvs[ offset2 ] = ix / gridX;\n\t\t\tuvs[ offset2 + 1 ] = 1 - ( iy / gridY );\n\n\t\t\toffset += 3;\n\t\t\toffset2 += 2;\n\n\t\t}\n\n\t}\n\n\toffset = 0;\n\n\tvar indices = new ( ( vertices.length / 3 ) > 65535 ? Uint32Array : Uint16Array )( gridX * gridY * 6 );\n\n\tfor ( var iy = 0; iy < gridY; iy ++ ) {\n\n\t\tfor ( var ix = 0; ix < gridX; ix ++ ) {\n\n\t\t\tvar a = ix + gridX1 * iy;\n\t\t\tvar b = ix + gridX1 * ( iy + 1 );\n\t\t\tvar c = ( ix + 1 ) + gridX1 * ( iy + 1 );\n\t\t\tvar d = ( ix + 1 ) + gridX1 * iy;\n\n\t\t\tindices[ offset ] = a;\n\t\t\tindices[ offset + 1 ] = b;\n\t\t\tindices[ offset + 2 ] = d;\n\n\t\t\tindices[ offset + 3 ] = b;\n\t\t\tindices[ offset + 4 ] = c;\n\t\t\tindices[ offset + 5 ] = d;\n\n\t\t\toffset += 6;\n\n\t\t}\n\n\t}\n\n\tthis.setIndex( new THREE.BufferAttribute( indices, 1 ) );\n\tthis.addAttribute( 'position', new THREE.BufferAttribute( vertices, 3 ) );\n\tthis.addAttribute( 'normal', new THREE.BufferAttribute( normals, 3 ) );\n\tthis.addAttribute( 'uv', new THREE.BufferAttribute( uvs, 2 ) );\n\n};\n\nTHREE.PlaneBufferGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\nTHREE.PlaneBufferGeometry.prototype.constructor = THREE.PlaneBufferGeometry;\n\nTHREE.PlaneBufferGeometry.prototype.clone = function () {\n\n\tvar geometry = new THREE.PlaneBufferGeometry(\n\t\tthis.parameters.width,\n\t\tthis.parameters.height,\n\t\tthis.parameters.widthSegments,\n\t\tthis.parameters.heightSegments\n\t);\n\n\tgeometry.copy( this );\n\n\treturn geometry;\n\n};\n\n// File:src/extras/geometries/RingGeometry.js\n\n/**\n * @author Kaleb Murphy\n */\n\nTHREE.RingGeometry = function ( innerRadius, outerRadius, thetaSegments, phiSegments, thetaStart, thetaLength ) {\n\n\tTHREE.Geometry.call( this );\n\n\tthis.type = 'RingGeometry';\n\n\tthis.parameters = {\n\t\tinnerRadius: innerRadius,\n\t\touterRadius: outerRadius,\n\t\tthetaSegments: thetaSegments,\n\t\tphiSegments: phiSegments,\n\t\tthetaStart: thetaStart,\n\t\tthetaLength: thetaLength\n\t};\n\n\tinnerRadius = innerRadius || 0;\n\touterRadius = outerRadius || 50;\n\n\tthetaStart = thetaStart !== undefined ? thetaStart : 0;\n\tthetaLength = thetaLength !== undefined ? thetaLength : Math.PI * 2;\n\n\tthetaSegments = thetaSegments !== undefined ? Math.max( 3, thetaSegments ) : 8;\n\tphiSegments = phiSegments !== undefined ? Math.max( 1, phiSegments ) : 8;\n\n\tvar i, o, uvs = [], radius = innerRadius, radiusStep = ( ( outerRadius - innerRadius ) / phiSegments );\n\n\tfor ( i = 0; i < phiSegments + 1; i ++ ) {\n\n\t\t// concentric circles inside ring\n\n\t\tfor ( o = 0; o < thetaSegments + 1; o ++ ) {\n\n\t\t\t// number of segments per circle\n\n\t\t\tvar vertex = new THREE.Vector3();\n\t\t\tvar segment = thetaStart + o / thetaSegments * thetaLength;\n\t\t\tvertex.x = radius * Math.cos( segment );\n\t\t\tvertex.y = radius * Math.sin( segment );\n\n\t\t\tthis.vertices.push( vertex );\n\t\t\tuvs.push( new THREE.Vector2( ( vertex.x / outerRadius + 1 ) / 2, ( vertex.y / outerRadius + 1 ) / 2 ) );\n\n\t\t}\n\n\t\tradius += radiusStep;\n\n\t}\n\n\tvar n = new THREE.Vector3( 0, 0, 1 );\n\n\tfor ( i = 0; i < phiSegments; i ++ ) {\n\n\t\t// concentric circles inside ring\n\n\t\tvar thetaSegment = i * ( thetaSegments + 1 );\n\n\t\tfor ( o = 0; o < thetaSegments ; o ++ ) {\n\n\t\t\t// number of segments per circle\n\n\t\t\tvar segment = o + thetaSegment;\n\n\t\t\tvar v1 = segment;\n\t\t\tvar v2 = segment + thetaSegments + 1;\n\t\t\tvar v3 = segment + thetaSegments + 2;\n\n\t\t\tthis.faces.push( new THREE.Face3( v1, v2, v3, [ n.clone(), n.clone(), n.clone() ] ) );\n\t\t\tthis.faceVertexUvs[ 0 ].push( [ uvs[ v1 ].clone(), uvs[ v2 ].clone(), uvs[ v3 ].clone() ] );\n\n\t\t\tv1 = segment;\n\t\t\tv2 = segment + thetaSegments + 2;\n\t\t\tv3 = segment + 1;\n\n\t\t\tthis.faces.push( new THREE.Face3( v1, v2, v3, [ n.clone(), n.clone(), n.clone() ] ) );\n\t\t\tthis.faceVertexUvs[ 0 ].push( [ uvs[ v1 ].clone(), uvs[ v2 ].clone(), uvs[ v3 ].clone() ] );\n\n\t\t}\n\n\t}\n\n\tthis.computeFaceNormals();\n\n\tthis.boundingSphere = new THREE.Sphere( new THREE.Vector3(), radius );\n\n};\n\nTHREE.RingGeometry.prototype = Object.create( THREE.Geometry.prototype );\nTHREE.RingGeometry.prototype.constructor = THREE.RingGeometry;\n\nTHREE.RingGeometry.prototype.clone = function () {\n\n\tvar geometry = new THREE.RingGeometry(\n\t\tthis.parameters.innerRadius,\n\t\tthis.parameters.outerRadius,\n\t\tthis.parameters.thetaSegments,\n\t\tthis.parameters.phiSegments,\n\t\tthis.parameters.thetaStart,\n\t\tthis.parameters.thetaLength\n\t);\n\n\treturn geometry;\n\n};\n\n// File:src/extras/geometries/SphereGeometry.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.SphereGeometry = function ( radius, widthSegments, heightSegments, phiStart, phiLength, thetaStart, thetaLength ) {\n\n\tTHREE.Geometry.call( this );\n\n\tthis.type = 'SphereGeometry';\n\n\tthis.parameters = {\n\t\tradius: radius,\n\t\twidthSegments: widthSegments,\n\t\theightSegments: heightSegments,\n\t\tphiStart: phiStart,\n\t\tphiLength: phiLength,\n\t\tthetaStart: thetaStart,\n\t\tthetaLength: thetaLength\n\t};\n\n\tthis.fromBufferGeometry( new THREE.SphereBufferGeometry( radius, widthSegments, heightSegments, phiStart, phiLength, thetaStart, thetaLength ) );\n\n};\n\nTHREE.SphereGeometry.prototype = Object.create( THREE.Geometry.prototype );\nTHREE.SphereGeometry.prototype.constructor = THREE.SphereGeometry;\n\nTHREE.SphereGeometry.prototype.clone = function () {\n\n\tvar geometry = new THREE.SphereGeometry(\n\t\tthis.parameters.radius,\n\t\tthis.parameters.widthSegments,\n\t\tthis.parameters.heightSegments,\n\t\tthis.parameters.phiStart,\n\t\tthis.parameters.phiLength,\n\t\tthis.parameters.thetaStart,\n\t\tthis.parameters.thetaLength\n\t);\n\n\treturn geometry;\n\n};\n\n// File:src/extras/geometries/SphereBufferGeometry.js\n\n/**\n * @author benaadams / https://twitter.com/ben_a_adams\n * based on THREE.SphereGeometry\n */\n\nTHREE.SphereBufferGeometry = function ( radius, widthSegments, heightSegments, phiStart, phiLength, thetaStart, thetaLength ) {\n\n\tTHREE.BufferGeometry.call( this );\n\n\tthis.type = 'SphereBufferGeometry';\n\n\tthis.parameters = {\n\t\tradius: radius,\n\t\twidthSegments: widthSegments,\n\t\theightSegments: heightSegments,\n\t\tphiStart: phiStart,\n\t\tphiLength: phiLength,\n\t\tthetaStart: thetaStart,\n\t\tthetaLength: thetaLength\n\t};\n\n\tradius = radius || 50;\n\n\twidthSegments = Math.max( 3, Math.floor( widthSegments ) || 8 );\n\theightSegments = Math.max( 2, Math.floor( heightSegments ) || 6 );\n\n\tphiStart = phiStart !== undefined ? phiStart : 0;\n\tphiLength = phiLength !== undefined ? phiLength : Math.PI * 2;\n\n\tthetaStart = thetaStart !== undefined ? thetaStart : 0;\n\tthetaLength = thetaLength !== undefined ? thetaLength : Math.PI;\n\n\tvar thetaEnd = thetaStart + thetaLength;\n\n\tvar vertexCount = ( ( widthSegments + 1 ) * ( heightSegments + 1 ) );\n\n\tvar positions = new THREE.BufferAttribute( new Float32Array( vertexCount * 3 ), 3 );\n\tvar normals = new THREE.BufferAttribute( new Float32Array( vertexCount * 3 ), 3 );\n\tvar uvs = new THREE.BufferAttribute( new Float32Array( vertexCount * 2 ), 2 );\n\n\tvar index = 0, vertices = [], normal = new THREE.Vector3();\n\n\tfor ( var y = 0; y <= heightSegments; y ++ ) {\n\n\t\tvar verticesRow = [];\n\n\t\tvar v = y / heightSegments;\n\n\t\tfor ( var x = 0; x <= widthSegments; x ++ ) {\n\n\t\t\tvar u = x / widthSegments;\n\n\t\t\tvar px = - radius * Math.cos( phiStart + u * phiLength ) * Math.sin( thetaStart + v * thetaLength );\n\t\t\tvar py = radius * Math.cos( thetaStart + v * thetaLength );\n\t\t\tvar pz = radius * Math.sin( phiStart + u * phiLength ) * Math.sin( thetaStart + v * thetaLength );\n\n\t\t\tnormal.set( px, py, pz ).normalize();\n\n\t\t\tpositions.setXYZ( index, px, py, pz );\n\t\t\tnormals.setXYZ( index, normal.x, normal.y, normal.z );\n\t\t\tuvs.setXY( index, u, 1 - v );\n\n\t\t\tverticesRow.push( index );\n\n\t\t\tindex ++;\n\n\t\t}\n\n\t\tvertices.push( verticesRow );\n\n\t}\n\n\tvar indices = [];\n\n\tfor ( var y = 0; y < heightSegments; y ++ ) {\n\n\t\tfor ( var x = 0; x < widthSegments; x ++ ) {\n\n\t\t\tvar v1 = vertices[ y ][ x + 1 ];\n\t\t\tvar v2 = vertices[ y ][ x ];\n\t\t\tvar v3 = vertices[ y + 1 ][ x ];\n\t\t\tvar v4 = vertices[ y + 1 ][ x + 1 ];\n\n\t\t\tif ( y !== 0 || thetaStart > 0 ) indices.push( v1, v2, v4 );\n\t\t\tif ( y !== heightSegments - 1 || thetaEnd < Math.PI ) indices.push( v2, v3, v4 );\n\n\t\t}\n\n\t}\n\n\tthis.setIndex( new THREE.BufferAttribute( new Uint16Array( indices ), 1 ) );\n\tthis.addAttribute( 'position', positions );\n\tthis.addAttribute( 'normal', normals );\n\tthis.addAttribute( 'uv', uvs );\n\n\tthis.boundingSphere = new THREE.Sphere( new THREE.Vector3(), radius );\n\n};\n\nTHREE.SphereBufferGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\nTHREE.SphereBufferGeometry.prototype.constructor = THREE.SphereBufferGeometry;\n\nTHREE.SphereBufferGeometry.prototype.clone = function () {\n\n\tvar geometry = new THREE.SphereBufferGeometry(\n\t\tthis.parameters.radius,\n\t\tthis.parameters.widthSegments,\n\t\tthis.parameters.heightSegments,\n\t\tthis.parameters.phiStart,\n\t\tthis.parameters.phiLength,\n\t\tthis.parameters.thetaStart,\n\t\tthis.parameters.thetaLength\n\t);\n\n\tgeometry.copy( this );\n\n\treturn geometry;\n\n};\n\n// File:src/extras/geometries/TextGeometry.js\n\n/**\n * @author zz85 / http://www.lab4games.net/zz85/blog\n * @author alteredq / http://alteredqualia.com/\n *\n * For creating 3D text geometry in three.js\n *\n * Text = 3D Text\n *\n * parameters = {\n *  size: \t\t\t<float>, \t// size of the text\n *  height: \t\t<float>, \t// thickness to extrude text\n *  curveSegments: \t<int>,\t\t// number of points on the curves\n *\n *  font: \t\t\t<string>,\t\t// font name\n *  weight: \t\t<string>,\t\t// font weight (normal, bold)\n *  style: \t\t\t<string>,\t\t// font style  (normal, italics)\n *\n *  bevelEnabled:\t<bool>,\t\t\t// turn on bevel\n *  bevelThickness: <float>, \t\t// how deep into text bevel goes\n *  bevelSize:\t\t<float>, \t\t// how far from text outline is bevel\n *  }\n *\n */\n\n/*\tUsage Examples\n\n\t// TextGeometry wrapper\n\n\tvar text3d = new TextGeometry( text, options );\n\n\t// Complete manner\n\n\tvar textShapes = THREE.FontUtils.generateShapes( text, options );\n\tvar text3d = new ExtrudeGeometry( textShapes, options );\n\n*/\n\n\nTHREE.TextGeometry = function ( text, parameters ) {\n\n\tparameters = parameters || {};\n\n\tvar textShapes = THREE.FontUtils.generateShapes( text, parameters );\n\n\t// translate parameters to ExtrudeGeometry API\n\n\tparameters.amount = parameters.height !== undefined ? parameters.height : 50;\n\n\t// defaults\n\n\tif ( parameters.bevelThickness === undefined ) parameters.bevelThickness = 10;\n\tif ( parameters.bevelSize === undefined ) parameters.bevelSize = 8;\n\tif ( parameters.bevelEnabled === undefined ) parameters.bevelEnabled = false;\n\n\tTHREE.ExtrudeGeometry.call( this, textShapes, parameters );\n\n\tthis.type = 'TextGeometry';\n\n};\n\nTHREE.TextGeometry.prototype = Object.create( THREE.ExtrudeGeometry.prototype );\nTHREE.TextGeometry.prototype.constructor = THREE.TextGeometry;\n\n// File:src/extras/geometries/TorusGeometry.js\n\n/**\n * @author oosmoxiecode\n * @author mrdoob / http://mrdoob.com/\n * based on http://code.google.com/p/away3d/source/browse/trunk/fp10/Away3DLite/src/away3dlite/primitives/Torus.as?r=2888\n */\n\nTHREE.TorusGeometry = function ( radius, tube, radialSegments, tubularSegments, arc ) {\n\n\tTHREE.Geometry.call( this );\n\n\tthis.type = 'TorusGeometry';\n\n\tthis.parameters = {\n\t\tradius: radius,\n\t\ttube: tube,\n\t\tradialSegments: radialSegments,\n\t\ttubularSegments: tubularSegments,\n\t\tarc: arc\n\t};\n\n\tradius = radius || 100;\n\ttube = tube || 40;\n\tradialSegments = radialSegments || 8;\n\ttubularSegments = tubularSegments || 6;\n\tarc = arc || Math.PI * 2;\n\n\tvar center = new THREE.Vector3(), uvs = [], normals = [];\n\n\tfor ( var j = 0; j <= radialSegments; j ++ ) {\n\n\t\tfor ( var i = 0; i <= tubularSegments; i ++ ) {\n\n\t\t\tvar u = i / tubularSegments * arc;\n\t\t\tvar v = j / radialSegments * Math.PI * 2;\n\n\t\t\tcenter.x = radius * Math.cos( u );\n\t\t\tcenter.y = radius * Math.sin( u );\n\n\t\t\tvar vertex = new THREE.Vector3();\n\t\t\tvertex.x = ( radius + tube * Math.cos( v ) ) * Math.cos( u );\n\t\t\tvertex.y = ( radius + tube * Math.cos( v ) ) * Math.sin( u );\n\t\t\tvertex.z = tube * Math.sin( v );\n\n\t\t\tthis.vertices.push( vertex );\n\n\t\t\tuvs.push( new THREE.Vector2( i / tubularSegments, j / radialSegments ) );\n\t\t\tnormals.push( vertex.clone().sub( center ).normalize() );\n\n\t\t}\n\n\t}\n\n\tfor ( var j = 1; j <= radialSegments; j ++ ) {\n\n\t\tfor ( var i = 1; i <= tubularSegments; i ++ ) {\n\n\t\t\tvar a = ( tubularSegments + 1 ) * j + i - 1;\n\t\t\tvar b = ( tubularSegments + 1 ) * ( j - 1 ) + i - 1;\n\t\t\tvar c = ( tubularSegments + 1 ) * ( j - 1 ) + i;\n\t\t\tvar d = ( tubularSegments + 1 ) * j + i;\n\n\t\t\tvar face = new THREE.Face3( a, b, d, [ normals[ a ].clone(), normals[ b ].clone(), normals[ d ].clone() ] );\n\t\t\tthis.faces.push( face );\n\t\t\tthis.faceVertexUvs[ 0 ].push( [ uvs[ a ].clone(), uvs[ b ].clone(), uvs[ d ].clone() ] );\n\n\t\t\tface = new THREE.Face3( b, c, d, [ normals[ b ].clone(), normals[ c ].clone(), normals[ d ].clone() ] );\n\t\t\tthis.faces.push( face );\n\t\t\tthis.faceVertexUvs[ 0 ].push( [ uvs[ b ].clone(), uvs[ c ].clone(), uvs[ d ].clone() ] );\n\n\t\t}\n\n\t}\n\n\tthis.computeFaceNormals();\n\n};\n\nTHREE.TorusGeometry.prototype = Object.create( THREE.Geometry.prototype );\nTHREE.TorusGeometry.prototype.constructor = THREE.TorusGeometry;\n\nTHREE.TorusGeometry.prototype.clone = function () {\n\n\tvar geometry = new THREE.TorusGeometry(\n\t\tthis.parameters.radius,\n\t\tthis.parameters.tube,\n\t\tthis.parameters.radialSegments,\n\t\tthis.parameters.tubularSegments,\n\t\tthis.parameters.arc\n\t);\n\n\treturn geometry;\n\n};\n\n// File:src/extras/geometries/TorusKnotGeometry.js\n\n/**\n * @author oosmoxiecode\n * based on http://code.google.com/p/away3d/source/browse/trunk/fp10/Away3D/src/away3d/primitives/TorusKnot.as?spec=svn2473&r=2473\n */\n\nTHREE.TorusKnotGeometry = function ( radius, tube, radialSegments, tubularSegments, p, q, heightScale ) {\n\n\tTHREE.Geometry.call( this );\n\n\tthis.type = 'TorusKnotGeometry';\n\n\tthis.parameters = {\n\t\tradius: radius,\n\t\ttube: tube,\n\t\tradialSegments: radialSegments,\n\t\ttubularSegments: tubularSegments,\n\t\tp: p,\n\t\tq: q,\n\t\theightScale: heightScale\n\t};\n\n\tradius = radius || 100;\n\ttube = tube || 40;\n\tradialSegments = radialSegments || 64;\n\ttubularSegments = tubularSegments || 8;\n\tp = p || 2;\n\tq = q || 3;\n\theightScale = heightScale || 1;\n\n\tvar grid = new Array( radialSegments );\n\tvar tang = new THREE.Vector3();\n\tvar n = new THREE.Vector3();\n\tvar bitan = new THREE.Vector3();\n\n\tfor ( var i = 0; i < radialSegments; ++ i ) {\n\n\t\tgrid[ i ] = new Array( tubularSegments );\n\t\tvar u = i / radialSegments * 2 * p * Math.PI;\n\t\tvar p1 = getPos( u, q, p, radius, heightScale );\n\t\tvar p2 = getPos( u + 0.01, q, p, radius, heightScale );\n\t\ttang.subVectors( p2, p1 );\n\t\tn.addVectors( p2, p1 );\n\n\t\tbitan.crossVectors( tang, n );\n\t\tn.crossVectors( bitan, tang );\n\t\tbitan.normalize();\n\t\tn.normalize();\n\n\t\tfor ( var j = 0; j < tubularSegments; ++ j ) {\n\n\t\t\tvar v = j / tubularSegments * 2 * Math.PI;\n\t\t\tvar cx = - tube * Math.cos( v ); // TODO: Hack: Negating it so it faces outside.\n\t\t\tvar cy = tube * Math.sin( v );\n\n\t\t\tvar pos = new THREE.Vector3();\n\t\t\tpos.x = p1.x + cx * n.x + cy * bitan.x;\n\t\t\tpos.y = p1.y + cx * n.y + cy * bitan.y;\n\t\t\tpos.z = p1.z + cx * n.z + cy * bitan.z;\n\n\t\t\tgrid[ i ][ j ] = this.vertices.push( pos ) - 1;\n\n\t\t}\n\n\t}\n\n\tfor ( var i = 0; i < radialSegments; ++ i ) {\n\n\t\tfor ( var j = 0; j < tubularSegments; ++ j ) {\n\n\t\t\tvar ip = ( i + 1 ) % radialSegments;\n\t\t\tvar jp = ( j + 1 ) % tubularSegments;\n\n\t\t\tvar a = grid[ i ][ j ];\n\t\t\tvar b = grid[ ip ][ j ];\n\t\t\tvar c = grid[ ip ][ jp ];\n\t\t\tvar d = grid[ i ][ jp ];\n\n\t\t\tvar uva = new THREE.Vector2( i / radialSegments, j / tubularSegments );\n\t\t\tvar uvb = new THREE.Vector2( ( i + 1 ) / radialSegments, j / tubularSegments );\n\t\t\tvar uvc = new THREE.Vector2( ( i + 1 ) / radialSegments, ( j + 1 ) / tubularSegments );\n\t\t\tvar uvd = new THREE.Vector2( i / radialSegments, ( j + 1 ) / tubularSegments );\n\n\t\t\tthis.faces.push( new THREE.Face3( a, b, d ) );\n\t\t\tthis.faceVertexUvs[ 0 ].push( [ uva, uvb, uvd ] );\n\n\t\t\tthis.faces.push( new THREE.Face3( b, c, d ) );\n\t\t\tthis.faceVertexUvs[ 0 ].push( [ uvb.clone(), uvc, uvd.clone() ] );\n\n\t\t}\n\n\t}\n\n\tthis.computeFaceNormals();\n\tthis.computeVertexNormals();\n\n\tfunction getPos( u, in_q, in_p, radius, heightScale ) {\n\n\t\tvar cu = Math.cos( u );\n\t\tvar su = Math.sin( u );\n\t\tvar quOverP = in_q / in_p * u;\n\t\tvar cs = Math.cos( quOverP );\n\n\t\tvar tx = radius * ( 2 + cs ) * 0.5 * cu;\n\t\tvar ty = radius * ( 2 + cs ) * su * 0.5;\n\t\tvar tz = heightScale * radius * Math.sin( quOverP ) * 0.5;\n\n\t\treturn new THREE.Vector3( tx, ty, tz );\n\n\t}\n\n};\n\nTHREE.TorusKnotGeometry.prototype = Object.create( THREE.Geometry.prototype );\nTHREE.TorusKnotGeometry.prototype.constructor = THREE.TorusKnotGeometry;\n\nTHREE.TorusKnotGeometry.prototype.clone = function () {\n\n\tvar geometry = new THREE.TorusKnotGeometry(\n\t\tthis.parameters.radius,\n\t\tthis.parameters.tube,\n\t\tthis.parameters.radialSegments,\n\t\tthis.parameters.tubularSegments,\n\t\tthis.parameters.p,\n\t\tthis.parameters.q,\n\t\tthis.parameters.heightScale\n\t);\n\n\treturn geometry;\n\n};\n\n// File:src/extras/geometries/TubeGeometry.js\n\n/**\n * @author WestLangley / https://github.com/WestLangley\n * @author zz85 / https://github.com/zz85\n * @author miningold / https://github.com/miningold\n * @author jonobr1 / https://github.com/jonobr1\n *\n * Modified from the TorusKnotGeometry by @oosmoxiecode\n *\n * Creates a tube which extrudes along a 3d spline\n *\n * Uses parallel transport frames as described in\n * http://www.cs.indiana.edu/pub/techreports/TR425.pdf\n */\n\nTHREE.TubeGeometry = function ( path, segments, radius, radialSegments, closed, taper ) {\n\n\tTHREE.Geometry.call( this );\n\n\tthis.type = 'TubeGeometry';\n\n\tthis.parameters = {\n\t\tpath: path,\n\t\tsegments: segments,\n\t\tradius: radius,\n\t\tradialSegments: radialSegments,\n\t\tclosed: closed\n\t};\n\n\tsegments = segments || 64;\n\tradius = radius || 1;\n\tradialSegments = radialSegments || 8;\n\tclosed = closed || false;\n\ttaper = taper || THREE.TubeGeometry.NoTaper;\n\n\tvar grid = [];\n\n\tvar scope = this,\n\n\t\ttangent,\n\t\tnormal,\n\t\tbinormal,\n\n\t\tnumpoints = segments + 1,\n\n\t\tu, v, r,\n\n\t\tcx, cy,\n\t\tpos, pos2 = new THREE.Vector3(),\n\t\ti, j,\n\t\tip, jp,\n\t\ta, b, c, d,\n\t\tuva, uvb, uvc, uvd;\n\n\tvar frames = new THREE.TubeGeometry.FrenetFrames( path, segments, closed ),\n\t\ttangents = frames.tangents,\n\t\tnormals = frames.normals,\n\t\tbinormals = frames.binormals;\n\n\t// proxy internals\n\tthis.tangents = tangents;\n\tthis.normals = normals;\n\tthis.binormals = binormals;\n\n\tfunction vert( x, y, z ) {\n\n\t\treturn scope.vertices.push( new THREE.Vector3( x, y, z ) ) - 1;\n\n\t}\n\n\t// construct the grid\n\n\tfor ( i = 0; i < numpoints; i ++ ) {\n\n\t\tgrid[ i ] = [];\n\n\t\tu = i / ( numpoints - 1 );\n\n\t\tpos = path.getPointAt( u );\n\n\t\ttangent = tangents[ i ];\n\t\tnormal = normals[ i ];\n\t\tbinormal = binormals[ i ];\n\n\t\tr = radius * taper( u );\n\n\t\tfor ( j = 0; j < radialSegments; j ++ ) {\n\n\t\t\tv = j / radialSegments * 2 * Math.PI;\n\n\t\t\tcx = - r * Math.cos( v ); // TODO: Hack: Negating it so it faces outside.\n\t\t\tcy = r * Math.sin( v );\n\n\t\t\tpos2.copy( pos );\n\t\t\tpos2.x += cx * normal.x + cy * binormal.x;\n\t\t\tpos2.y += cx * normal.y + cy * binormal.y;\n\t\t\tpos2.z += cx * normal.z + cy * binormal.z;\n\n\t\t\tgrid[ i ][ j ] = vert( pos2.x, pos2.y, pos2.z );\n\n\t\t}\n\n\t}\n\n\n\t// construct the mesh\n\n\tfor ( i = 0; i < segments; i ++ ) {\n\n\t\tfor ( j = 0; j < radialSegments; j ++ ) {\n\n\t\t\tip = ( closed ) ? ( i + 1 ) % segments : i + 1;\n\t\t\tjp = ( j + 1 ) % radialSegments;\n\n\t\t\ta = grid[ i ][ j ];\t\t// *** NOT NECESSARILY PLANAR ! ***\n\t\t\tb = grid[ ip ][ j ];\n\t\t\tc = grid[ ip ][ jp ];\n\t\t\td = grid[ i ][ jp ];\n\n\t\t\tuva = new THREE.Vector2( i / segments, j / radialSegments );\n\t\t\tuvb = new THREE.Vector2( ( i + 1 ) / segments, j / radialSegments );\n\t\t\tuvc = new THREE.Vector2( ( i + 1 ) / segments, ( j + 1 ) / radialSegments );\n\t\t\tuvd = new THREE.Vector2( i / segments, ( j + 1 ) / radialSegments );\n\n\t\t\tthis.faces.push( new THREE.Face3( a, b, d ) );\n\t\t\tthis.faceVertexUvs[ 0 ].push( [ uva, uvb, uvd ] );\n\n\t\t\tthis.faces.push( new THREE.Face3( b, c, d ) );\n\t\t\tthis.faceVertexUvs[ 0 ].push( [ uvb.clone(), uvc, uvd.clone() ] );\n\n\t\t}\n\n\t}\n\n\tthis.computeFaceNormals();\n\tthis.computeVertexNormals();\n\n};\n\nTHREE.TubeGeometry.prototype = Object.create( THREE.Geometry.prototype );\nTHREE.TubeGeometry.prototype.constructor = THREE.TubeGeometry;\n\nTHREE.TubeGeometry.NoTaper = function ( u ) {\n\n\treturn 1;\n\n};\n\nTHREE.TubeGeometry.SinusoidalTaper = function ( u ) {\n\n\treturn Math.sin( Math.PI * u );\n\n};\n\n// For computing of Frenet frames, exposing the tangents, normals and binormals the spline\nTHREE.TubeGeometry.FrenetFrames = function ( path, segments, closed ) {\n\n\tvar\tnormal = new THREE.Vector3(),\n\n\t\ttangents = [],\n\t\tnormals = [],\n\t\tbinormals = [],\n\n\t\tvec = new THREE.Vector3(),\n\t\tmat = new THREE.Matrix4(),\n\n\t\tnumpoints = segments + 1,\n\t\ttheta,\n\t\tepsilon = 0.0001,\n\t\tsmallest,\n\n\t\ttx, ty, tz,\n\t\ti, u;\n\n\n\t// expose internals\n\tthis.tangents = tangents;\n\tthis.normals = normals;\n\tthis.binormals = binormals;\n\n\t// compute the tangent vectors for each segment on the path\n\n\tfor ( i = 0; i < numpoints; i ++ ) {\n\n\t\tu = i / ( numpoints - 1 );\n\n\t\ttangents[ i ] = path.getTangentAt( u );\n\t\ttangents[ i ].normalize();\n\n\t}\n\n\tinitialNormal3();\n\n\t/*\n\tfunction initialNormal1(lastBinormal) {\n\t\t// fixed start binormal. Has dangers of 0 vectors\n\t\tnormals[ 0 ] = new THREE.Vector3();\n\t\tbinormals[ 0 ] = new THREE.Vector3();\n\t\tif (lastBinormal===undefined) lastBinormal = new THREE.Vector3( 0, 0, 1 );\n\t\tnormals[ 0 ].crossVectors( lastBinormal, tangents[ 0 ] ).normalize();\n\t\tbinormals[ 0 ].crossVectors( tangents[ 0 ], normals[ 0 ] ).normalize();\n\t}\n\n\tfunction initialNormal2() {\n\n\t\t// This uses the Frenet-Serret formula for deriving binormal\n\t\tvar t2 = path.getTangentAt( epsilon );\n\n\t\tnormals[ 0 ] = new THREE.Vector3().subVectors( t2, tangents[ 0 ] ).normalize();\n\t\tbinormals[ 0 ] = new THREE.Vector3().crossVectors( tangents[ 0 ], normals[ 0 ] );\n\n\t\tnormals[ 0 ].crossVectors( binormals[ 0 ], tangents[ 0 ] ).normalize(); // last binormal x tangent\n\t\tbinormals[ 0 ].crossVectors( tangents[ 0 ], normals[ 0 ] ).normalize();\n\n\t}\n\t*/\n\n\tfunction initialNormal3() {\n\n\t\t// select an initial normal vector perpendicular to the first tangent vector,\n\t\t// and in the direction of the smallest tangent xyz component\n\n\t\tnormals[ 0 ] = new THREE.Vector3();\n\t\tbinormals[ 0 ] = new THREE.Vector3();\n\t\tsmallest = Number.MAX_VALUE;\n\t\ttx = Math.abs( tangents[ 0 ].x );\n\t\tty = Math.abs( tangents[ 0 ].y );\n\t\ttz = Math.abs( tangents[ 0 ].z );\n\n\t\tif ( tx <= smallest ) {\n\n\t\t\tsmallest = tx;\n\t\t\tnormal.set( 1, 0, 0 );\n\n\t\t}\n\n\t\tif ( ty <= smallest ) {\n\n\t\t\tsmallest = ty;\n\t\t\tnormal.set( 0, 1, 0 );\n\n\t\t}\n\n\t\tif ( tz <= smallest ) {\n\n\t\t\tnormal.set( 0, 0, 1 );\n\n\t\t}\n\n\t\tvec.crossVectors( tangents[ 0 ], normal ).normalize();\n\n\t\tnormals[ 0 ].crossVectors( tangents[ 0 ], vec );\n\t\tbinormals[ 0 ].crossVectors( tangents[ 0 ], normals[ 0 ] );\n\n\t}\n\n\n\t// compute the slowly-varying normal and binormal vectors for each segment on the path\n\n\tfor ( i = 1; i < numpoints; i ++ ) {\n\n\t\tnormals[ i ] = normals[ i - 1 ].clone();\n\n\t\tbinormals[ i ] = binormals[ i - 1 ].clone();\n\n\t\tvec.crossVectors( tangents[ i - 1 ], tangents[ i ] );\n\n\t\tif ( vec.length() > epsilon ) {\n\n\t\t\tvec.normalize();\n\n\t\t\ttheta = Math.acos( THREE.Math.clamp( tangents[ i - 1 ].dot( tangents[ i ] ), - 1, 1 ) ); // clamp for floating pt errors\n\n\t\t\tnormals[ i ].applyMatrix4( mat.makeRotationAxis( vec, theta ) );\n\n\t\t}\n\n\t\tbinormals[ i ].crossVectors( tangents[ i ], normals[ i ] );\n\n\t}\n\n\n\t// if the curve is closed, postprocess the vectors so the first and last normal vectors are the same\n\n\tif ( closed ) {\n\n\t\ttheta = Math.acos( THREE.Math.clamp( normals[ 0 ].dot( normals[ numpoints - 1 ] ), - 1, 1 ) );\n\t\ttheta /= ( numpoints - 1 );\n\n\t\tif ( tangents[ 0 ].dot( vec.crossVectors( normals[ 0 ], normals[ numpoints - 1 ] ) ) > 0 ) {\n\n\t\t\ttheta = - theta;\n\n\t\t}\n\n\t\tfor ( i = 1; i < numpoints; i ++ ) {\n\n\t\t\t// twist a little...\n\t\t\tnormals[ i ].applyMatrix4( mat.makeRotationAxis( tangents[ i ], theta * i ) );\n\t\t\tbinormals[ i ].crossVectors( tangents[ i ], normals[ i ] );\n\n\t\t}\n\n\t}\n\n};\n\n// File:src/extras/geometries/PolyhedronGeometry.js\n\n/**\n * @author clockworkgeek / https://github.com/clockworkgeek\n * @author timothypratley / https://github.com/timothypratley\n * @author WestLangley / http://github.com/WestLangley\n*/\n\nTHREE.PolyhedronGeometry = function ( vertices, indices, radius, detail ) {\n\n\tTHREE.Geometry.call( this );\n\n\tthis.type = 'PolyhedronGeometry';\n\n\tthis.parameters = {\n\t\tvertices: vertices,\n\t\tindices: indices,\n\t\tradius: radius,\n\t\tdetail: detail\n\t};\n\n\tradius = radius || 1;\n\tdetail = detail || 0;\n\n\tvar that = this;\n\n\tfor ( var i = 0, l = vertices.length; i < l; i += 3 ) {\n\n\t\tprepare( new THREE.Vector3( vertices[ i ], vertices[ i + 1 ], vertices[ i + 2 ] ) );\n\n\t}\n\n\tvar p = this.vertices;\n\n\tvar faces = [];\n\n\tfor ( var i = 0, j = 0, l = indices.length; i < l; i += 3, j ++ ) {\n\n\t\tvar v1 = p[ indices[ i ] ];\n\t\tvar v2 = p[ indices[ i + 1 ] ];\n\t\tvar v3 = p[ indices[ i + 2 ] ];\n\n\t\tfaces[ j ] = new THREE.Face3( v1.index, v2.index, v3.index, [ v1.clone(), v2.clone(), v3.clone() ], undefined, j );\n\n\t}\n\n\tvar centroid = new THREE.Vector3();\n\n\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\n\n\t\tsubdivide( faces[ i ], detail );\n\n\t}\n\n\n\t// Handle case when face straddles the seam\n\n\tfor ( var i = 0, l = this.faceVertexUvs[ 0 ].length; i < l; i ++ ) {\n\n\t\tvar uvs = this.faceVertexUvs[ 0 ][ i ];\n\n\t\tvar x0 = uvs[ 0 ].x;\n\t\tvar x1 = uvs[ 1 ].x;\n\t\tvar x2 = uvs[ 2 ].x;\n\n\t\tvar max = Math.max( x0, Math.max( x1, x2 ) );\n\t\tvar min = Math.min( x0, Math.min( x1, x2 ) );\n\n\t\tif ( max > 0.9 && min < 0.1 ) {\n\n\t\t\t// 0.9 is somewhat arbitrary\n\n\t\t\tif ( x0 < 0.2 ) uvs[ 0 ].x += 1;\n\t\t\tif ( x1 < 0.2 ) uvs[ 1 ].x += 1;\n\t\t\tif ( x2 < 0.2 ) uvs[ 2 ].x += 1;\n\n\t\t}\n\n\t}\n\n\n\t// Apply radius\n\n\tfor ( var i = 0, l = this.vertices.length; i < l; i ++ ) {\n\n\t\tthis.vertices[ i ].multiplyScalar( radius );\n\n\t}\n\n\n\t// Merge vertices\n\n\tthis.mergeVertices();\n\n\tthis.computeFaceNormals();\n\n\tthis.boundingSphere = new THREE.Sphere( new THREE.Vector3(), radius );\n\n\n\t// Project vector onto sphere's surface\n\n\tfunction prepare( vector ) {\n\n\t\tvar vertex = vector.normalize().clone();\n\t\tvertex.index = that.vertices.push( vertex ) - 1;\n\n\t\t// Texture coords are equivalent to map coords, calculate angle and convert to fraction of a circle.\n\n\t\tvar u = azimuth( vector ) / 2 / Math.PI + 0.5;\n\t\tvar v = inclination( vector ) / Math.PI + 0.5;\n\t\tvertex.uv = new THREE.Vector2( u, 1 - v );\n\n\t\treturn vertex;\n\n\t}\n\n\n\t// Approximate a curved face with recursively sub-divided triangles.\n\n\tfunction make( v1, v2, v3, materialIndex ) {\n\n\t\tvar face = new THREE.Face3( v1.index, v2.index, v3.index, [ v1.clone(), v2.clone(), v3.clone() ], undefined, materialIndex );\n\t\tthat.faces.push( face );\n\n\t\tcentroid.copy( v1 ).add( v2 ).add( v3 ).divideScalar( 3 );\n\n\t\tvar azi = azimuth( centroid );\n\n\t\tthat.faceVertexUvs[ 0 ].push( [\n\t\t\tcorrectUV( v1.uv, v1, azi ),\n\t\t\tcorrectUV( v2.uv, v2, azi ),\n\t\t\tcorrectUV( v3.uv, v3, azi )\n\t\t] );\n\n\t}\n\n\n\t// Analytically subdivide a face to the required detail level.\n\n\tfunction subdivide( face, detail ) {\n\n\t\tvar cols = Math.pow( 2, detail );\n\t\tvar a = prepare( that.vertices[ face.a ] );\n\t\tvar b = prepare( that.vertices[ face.b ] );\n\t\tvar c = prepare( that.vertices[ face.c ] );\n\t\tvar v = [];\n\n\t\tvar materialIndex = face.materialIndex;\n\n\t\t// Construct all of the vertices for this subdivision.\n\n\t\tfor ( var i = 0 ; i <= cols; i ++ ) {\n\n\t\t\tv[ i ] = [];\n\n\t\t\tvar aj = prepare( a.clone().lerp( c, i / cols ) );\n\t\t\tvar bj = prepare( b.clone().lerp( c, i / cols ) );\n\t\t\tvar rows = cols - i;\n\n\t\t\tfor ( var j = 0; j <= rows; j ++ ) {\n\n\t\t\t\tif ( j === 0 && i === cols ) {\n\n\t\t\t\t\tv[ i ][ j ] = aj;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tv[ i ][ j ] = prepare( aj.clone().lerp( bj, j / rows ) );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Construct all of the faces.\n\n\t\tfor ( var i = 0; i < cols ; i ++ ) {\n\n\t\t\tfor ( var j = 0; j < 2 * ( cols - i ) - 1; j ++ ) {\n\n\t\t\t\tvar k = Math.floor( j / 2 );\n\n\t\t\t\tif ( j % 2 === 0 ) {\n\n\t\t\t\t\tmake(\n\t\t\t\t\t\tv[ i ][ k + 1 ],\n\t\t\t\t\t\tv[ i + 1 ][ k ],\n\t\t\t\t\t\tv[ i ][ k ],\n\t\t\t\t\t\tmaterialIndex\n\t\t\t\t\t);\n\n\t\t\t\t} else {\n\n\t\t\t\t\tmake(\n\t\t\t\t\t\tv[ i ][ k + 1 ],\n\t\t\t\t\t\tv[ i + 1 ][ k + 1 ],\n\t\t\t\t\t\tv[ i + 1 ][ k ],\n\t\t\t\t\t\tmaterialIndex\n\t\t\t\t\t);\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\n\t// Angle around the Y axis, counter-clockwise when looking from above.\n\n\tfunction azimuth( vector ) {\n\n\t\treturn Math.atan2( vector.z, - vector.x );\n\n\t}\n\n\n\t// Angle above the XZ plane.\n\n\tfunction inclination( vector ) {\n\n\t\treturn Math.atan2( - vector.y, Math.sqrt( ( vector.x * vector.x ) + ( vector.z * vector.z ) ) );\n\n\t}\n\n\n\t// Texture fixing helper. Spheres have some odd behaviours.\n\n\tfunction correctUV( uv, vector, azimuth ) {\n\n\t\tif ( ( azimuth < 0 ) && ( uv.x === 1 ) ) uv = new THREE.Vector2( uv.x - 1, uv.y );\n\t\tif ( ( vector.x === 0 ) && ( vector.z === 0 ) ) uv = new THREE.Vector2( azimuth / 2 / Math.PI + 0.5, uv.y );\n\t\treturn uv.clone();\n\n\t}\n\n\n};\n\nTHREE.PolyhedronGeometry.prototype = Object.create( THREE.Geometry.prototype );\nTHREE.PolyhedronGeometry.prototype.constructor = THREE.PolyhedronGeometry;\n\nTHREE.PolyhedronGeometry.prototype.clone = function () {\n\n\tvar geometry = new THREE.PolyhedronGeometry(\n\t\tthis.parameters.vertices,\n\t\tthis.parameters.indices,\n\t\tthis.parameters.radius,\n\t\tthis.parameters.detail\n\t);\n\n\treturn geometry.copy( this );\n\n};\n\nTHREE.PolyhedronGeometry.prototype.copy = function ( source ) {\n\n\tTHREE.Geometry.prototype.copy.call( this, source );\n\treturn this;\n\n};\n\n// File:src/extras/geometries/DodecahedronGeometry.js\n\n/**\n * @author Abe Pazos / https://hamoid.com\n */\n\nTHREE.DodecahedronGeometry = function ( radius, detail ) {\n\n\tvar t = ( 1 + Math.sqrt( 5 ) ) / 2;\n\tvar r = 1 / t;\n\n\tvar vertices = [\n\n\t\t// (1, 1, 1)\n\t\t- 1, - 1, - 1,    - 1, - 1,  1,\n\t\t- 1,  1, - 1,    - 1,  1,  1,\n\t\t 1, - 1, - 1,     1, - 1,  1,\n\t\t 1,  1, - 1,     1,  1,  1,\n\n\t\t// (0, 1/, )\n\t\t 0, - r, - t,     0, - r,  t,\n\t\t 0,  r, - t,     0,  r,  t,\n\n\t\t// (1/, , 0)\n\t\t- r, - t,  0,    - r,  t,  0,\n\t\t r, - t,  0,     r,  t,  0,\n\n\t\t// (, 0, 1/)\n\t\t- t,  0, - r,     t,  0, - r,\n\t\t- t,  0,  r,     t,  0,  r\n\t];\n\n\tvar indices = [\n\t\t 3, 11,  7,      3,  7, 15,      3, 15, 13,\n\t\t 7, 19, 17,      7, 17,  6,      7,  6, 15,\n\t\t17,  4,  8,     17,  8, 10,     17, 10,  6,\n\t\t 8,  0, 16,      8, 16,  2,      8,  2, 10,\n\t\t 0, 12,  1,      0,  1, 18,      0, 18, 16,\n\t\t 6, 10,  2,      6,  2, 13,      6, 13, 15,\n\t\t 2, 16, 18,      2, 18,  3,      2,  3, 13,\n\t\t18,  1,  9,     18,  9, 11,     18, 11,  3,\n\t\t 4, 14, 12,      4, 12,  0,      4,  0,  8,\n\t\t11,  9,  5,     11,  5, 19,     11, 19,  7,\n\t\t19,  5, 14,     19, 14,  4,     19,  4, 17,\n\t\t 1, 12, 14,      1, 14,  5,      1,  5,  9\n\t];\n\n\tTHREE.PolyhedronGeometry.call( this, vertices, indices, radius, detail );\n\n\tthis.type = 'DodecahedronGeometry';\n\n\tthis.parameters = {\n\t\tradius: radius,\n\t\tdetail: detail\n\t};\n\n};\n\nTHREE.DodecahedronGeometry.prototype = Object.create( THREE.PolyhedronGeometry.prototype );\nTHREE.DodecahedronGeometry.prototype.constructor = THREE.DodecahedronGeometry;\n\nTHREE.DodecahedronGeometry.prototype.clone = function () {\n\n\tvar geometry = new THREE.DodecahedronGeometry(\n\t\tthis.parameters.radius,\n\t\tthis.parameters.detail\n\t);\n\n\tgeometry.copy( this );\n\n\treturn geometry;\n\n};\n\n// File:src/extras/geometries/IcosahedronGeometry.js\n\n/**\n * @author timothypratley / https://github.com/timothypratley\n */\n\nTHREE.IcosahedronGeometry = function ( radius, detail ) {\n\n\tvar t = ( 1 + Math.sqrt( 5 ) ) / 2;\n\n\tvar vertices = [\n\t\t- 1,  t,  0,    1,  t,  0,   - 1, - t,  0,    1, - t,  0,\n\t\t 0, - 1,  t,    0,  1,  t,    0, - 1, - t,    0,  1, - t,\n\t\t t,  0, - 1,    t,  0,  1,   - t,  0, - 1,   - t,  0,  1\n\t];\n\n\tvar indices = [\n\t\t 0, 11,  5,    0,  5,  1,    0,  1,  7,    0,  7, 10,    0, 10, 11,\n\t\t 1,  5,  9,    5, 11,  4,   11, 10,  2,   10,  7,  6,    7,  1,  8,\n\t\t 3,  9,  4,    3,  4,  2,    3,  2,  6,    3,  6,  8,    3,  8,  9,\n\t\t 4,  9,  5,    2,  4, 11,    6,  2, 10,    8,  6,  7,    9,  8,  1\n\t];\n\n\tTHREE.PolyhedronGeometry.call( this, vertices, indices, radius, detail );\n\n\tthis.type = 'IcosahedronGeometry';\n\n\tthis.parameters = {\n\t\tradius: radius,\n\t\tdetail: detail\n\t};\n\n};\n\nTHREE.IcosahedronGeometry.prototype = Object.create( THREE.PolyhedronGeometry.prototype );\nTHREE.IcosahedronGeometry.prototype.constructor = THREE.IcosahedronGeometry;\n\nTHREE.IcosahedronGeometry.prototype.clone = function () {\n\n\tvar geometry = new THREE.IcosahedronGeometry(\n\t\tthis.parameters.radius,\n\t\tthis.parameters.detail\n\t);\n\n\tgeometry.copy( this );\n\n\treturn geometry;\n\n};\n\n// File:src/extras/geometries/OctahedronGeometry.js\n\n/**\n * @author timothypratley / https://github.com/timothypratley\n */\n\nTHREE.OctahedronGeometry = function ( radius, detail ) {\n\n\tvar vertices = [\n\t\t1, 0, 0,   - 1, 0, 0,    0, 1, 0,    0, - 1, 0,    0, 0, 1,    0, 0, - 1\n\t];\n\n\tvar indices = [\n\t\t0, 2, 4,    0, 4, 3,    0, 3, 5,    0, 5, 2,    1, 2, 5,    1, 5, 3,    1, 3, 4,    1, 4, 2\n\t];\n\n\tTHREE.PolyhedronGeometry.call( this, vertices, indices, radius, detail );\n\n\tthis.type = 'OctahedronGeometry';\n\n\tthis.parameters = {\n\t\tradius: radius,\n\t\tdetail: detail\n\t};\n\n};\n\nTHREE.OctahedronGeometry.prototype = Object.create( THREE.PolyhedronGeometry.prototype );\nTHREE.OctahedronGeometry.prototype.constructor = THREE.OctahedronGeometry;\n\nTHREE.OctahedronGeometry.prototype.clone = function () {\n\n\tvar geometry = new THREE.OctahedronGeometry(\n\t\tthis.parameters.radius,\n\t\tthis.parameters.detail\n\t);\n\n\tgeometry.copy( this );\n\n\treturn geometry;\n\n};\n\n// File:src/extras/geometries/TetrahedronGeometry.js\n\n/**\n * @author timothypratley / https://github.com/timothypratley\n */\n\nTHREE.TetrahedronGeometry = function ( radius, detail ) {\n\n\tvar vertices = [\n\t\t 1,  1,  1,   - 1, - 1,  1,   - 1,  1, - 1,    1, - 1, - 1\n\t];\n\n\tvar indices = [\n\t\t 2,  1,  0,    0,  3,  2,    1,  3,  0,    2,  3,  1\n\t];\n\n\tTHREE.PolyhedronGeometry.call( this, vertices, indices, radius, detail );\n\n\tthis.type = 'TetrahedronGeometry';\n\n\tthis.parameters = {\n\t\tradius: radius,\n\t\tdetail: detail\n\t};\n\n};\n\nTHREE.TetrahedronGeometry.prototype = Object.create( THREE.PolyhedronGeometry.prototype );\nTHREE.TetrahedronGeometry.prototype.constructor = THREE.TetrahedronGeometry;\n\nTHREE.TetrahedronGeometry.prototype.clone = function () {\n\n\tvar geometry = new THREE.TetrahedronGeometry(\n\t\tthis.parameters.radius,\n\t\tthis.parameters.detail\n\t);\n\n\tgeometry.copy( this );\n\n\treturn geometry;\n\n};\n\n// File:src/extras/geometries/ParametricGeometry.js\n\n/**\n * @author zz85 / https://github.com/zz85\n * Parametric Surfaces Geometry\n * based on the brilliant article by @prideout http://prideout.net/blog/?p=44\n *\n * new THREE.ParametricGeometry( parametricFunction, uSegments, ySegements );\n *\n */\n\nTHREE.ParametricGeometry = function ( func, slices, stacks ) {\n\n\tTHREE.Geometry.call( this );\n\n\tthis.type = 'ParametricGeometry';\n\n\tthis.parameters = {\n\t\tfunc: func,\n\t\tslices: slices,\n\t\tstacks: stacks\n\t};\n\n\tvar verts = this.vertices;\n\tvar faces = this.faces;\n\tvar uvs = this.faceVertexUvs[ 0 ];\n\n\tvar i, j, p;\n\tvar u, v;\n\n\tvar sliceCount = slices + 1;\n\n\tfor ( i = 0; i <= stacks; i ++ ) {\n\n\t\tv = i / stacks;\n\n\t\tfor ( j = 0; j <= slices; j ++ ) {\n\n\t\t\tu = j / slices;\n\n\t\t\tp = func( u, v );\n\t\t\tverts.push( p );\n\n\t\t}\n\n\t}\n\n\tvar a, b, c, d;\n\tvar uva, uvb, uvc, uvd;\n\n\tfor ( i = 0; i < stacks; i ++ ) {\n\n\t\tfor ( j = 0; j < slices; j ++ ) {\n\n\t\t\ta = i * sliceCount + j;\n\t\t\tb = i * sliceCount + j + 1;\n\t\t\tc = ( i + 1 ) * sliceCount + j + 1;\n\t\t\td = ( i + 1 ) * sliceCount + j;\n\n\t\t\tuva = new THREE.Vector2( j / slices, i / stacks );\n\t\t\tuvb = new THREE.Vector2( ( j + 1 ) / slices, i / stacks );\n\t\t\tuvc = new THREE.Vector2( ( j + 1 ) / slices, ( i + 1 ) / stacks );\n\t\t\tuvd = new THREE.Vector2( j / slices, ( i + 1 ) / stacks );\n\n\t\t\tfaces.push( new THREE.Face3( a, b, d ) );\n\t\t\tuvs.push( [ uva, uvb, uvd ] );\n\n\t\t\tfaces.push( new THREE.Face3( b, c, d ) );\n\t\t\tuvs.push( [ uvb.clone(), uvc, uvd.clone() ] );\n\n\t\t}\n\n\t}\n\n\t// console.log(this);\n\n\t// magic bullet\n\t// var diff = this.mergeVertices();\n\t// console.log('removed ', diff, ' vertices by merging');\n\n\tthis.computeFaceNormals();\n\tthis.computeVertexNormals();\n\n};\n\nTHREE.ParametricGeometry.prototype = Object.create( THREE.Geometry.prototype );\nTHREE.ParametricGeometry.prototype.constructor = THREE.ParametricGeometry;\n\n// File:src/extras/geometries/WireframeGeometry.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.WireframeGeometry = function ( geometry ) {\n\n\tTHREE.BufferGeometry.call( this );\n\n\tvar edge = [ 0, 0 ], hash = {};\n\tvar sortFunction = function ( a, b ) {\n\n\t\treturn a - b;\n\n\t};\n\n\tvar keys = [ 'a', 'b', 'c' ];\n\n\tif ( geometry instanceof THREE.Geometry ) {\n\n\t\tvar vertices = geometry.vertices;\n\t\tvar faces = geometry.faces;\n\t\tvar numEdges = 0;\n\n\t\t// allocate maximal size\n\t\tvar edges = new Uint32Array( 6 * faces.length );\n\n\t\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\n\n\t\t\tvar face = faces[ i ];\n\n\t\t\tfor ( var j = 0; j < 3; j ++ ) {\n\n\t\t\t\tedge[ 0 ] = face[ keys[ j ] ];\n\t\t\t\tedge[ 1 ] = face[ keys[ ( j + 1 ) % 3 ] ];\n\t\t\t\tedge.sort( sortFunction );\n\n\t\t\t\tvar key = edge.toString();\n\n\t\t\t\tif ( hash[ key ] === undefined ) {\n\n\t\t\t\t\tedges[ 2 * numEdges ] = edge[ 0 ];\n\t\t\t\t\tedges[ 2 * numEdges + 1 ] = edge[ 1 ];\n\t\t\t\t\thash[ key ] = true;\n\t\t\t\t\tnumEdges ++;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tvar coords = new Float32Array( numEdges * 2 * 3 );\n\n\t\tfor ( var i = 0, l = numEdges; i < l; i ++ ) {\n\n\t\t\tfor ( var j = 0; j < 2; j ++ ) {\n\n\t\t\t\tvar vertex = vertices[ edges [ 2 * i + j ] ];\n\n\t\t\t\tvar index = 6 * i + 3 * j;\n\t\t\t\tcoords[ index + 0 ] = vertex.x;\n\t\t\t\tcoords[ index + 1 ] = vertex.y;\n\t\t\t\tcoords[ index + 2 ] = vertex.z;\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.addAttribute( 'position', new THREE.BufferAttribute( coords, 3 ) );\n\n\t} else if ( geometry instanceof THREE.BufferGeometry ) {\n\n\t\tif ( geometry.index !== null ) {\n\n\t\t\t// Indexed BufferGeometry\n\n\t\t\tvar indices = geometry.index.array;\n\t\t\tvar vertices = geometry.attributes.position;\n\t\t\tvar drawcalls = geometry.drawcalls;\n\t\t\tvar numEdges = 0;\n\n\t\t\tif ( drawcalls.length === 0 ) {\n\n\t\t\t\tgeometry.addDrawCall( 0, indices.length );\n\n\t\t\t}\n\n\t\t\t// allocate maximal size\n\t\t\tvar edges = new Uint32Array( 2 * indices.length );\n\n\t\t\tfor ( var o = 0, ol = drawcalls.length; o < ol; ++ o ) {\n\n\t\t\t\tvar drawcall = drawcalls[ o ];\n\n\t\t\t\tvar start = drawcall.start;\n\t\t\t\tvar count = drawcall.count;\n\n\t\t\t\tfor ( var i = start, il = start + count; i < il; i += 3 ) {\n\n\t\t\t\t\tfor ( var j = 0; j < 3; j ++ ) {\n\n\t\t\t\t\t\tedge[ 0 ] = indices[ i + j ];\n\t\t\t\t\t\tedge[ 1 ] = indices[ i + ( j + 1 ) % 3 ];\n\t\t\t\t\t\tedge.sort( sortFunction );\n\n\t\t\t\t\t\tvar key = edge.toString();\n\n\t\t\t\t\t\tif ( hash[ key ] === undefined ) {\n\n\t\t\t\t\t\t\tedges[ 2 * numEdges ] = edge[ 0 ];\n\t\t\t\t\t\t\tedges[ 2 * numEdges + 1 ] = edge[ 1 ];\n\t\t\t\t\t\t\thash[ key ] = true;\n\t\t\t\t\t\t\tnumEdges ++;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar coords = new Float32Array( numEdges * 2 * 3 );\n\n\t\t\tfor ( var i = 0, l = numEdges; i < l; i ++ ) {\n\n\t\t\t\tfor ( var j = 0; j < 2; j ++ ) {\n\n\t\t\t\t\tvar index = 6 * i + 3 * j;\n\t\t\t\t\tvar index2 = edges[ 2 * i + j ];\n\n\t\t\t\t\tcoords[ index + 0 ] = vertices.getX( index2 );\n\t\t\t\t\tcoords[ index + 1 ] = vertices.getY( index2 );\n\t\t\t\t\tcoords[ index + 2 ] = vertices.getZ( index2 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.addAttribute( 'position', new THREE.BufferAttribute( coords, 3 ) );\n\n\t\t} else {\n\n\t\t\t// non-indexed BufferGeometry\n\n\t\t\tvar vertices = geometry.attributes.position.array;\n\t\t\tvar numEdges = vertices.length / 3;\n\t\t\tvar numTris = numEdges / 3;\n\n\t\t\tvar coords = new Float32Array( numEdges * 2 * 3 );\n\n\t\t\tfor ( var i = 0, l = numTris; i < l; i ++ ) {\n\n\t\t\t\tfor ( var j = 0; j < 3; j ++ ) {\n\n\t\t\t\t\tvar index = 18 * i + 6 * j;\n\n\t\t\t\t\tvar index1 = 9 * i + 3 * j;\n\t\t\t\t\tcoords[ index + 0 ] = vertices[ index1 ];\n\t\t\t\t\tcoords[ index + 1 ] = vertices[ index1 + 1 ];\n\t\t\t\t\tcoords[ index + 2 ] = vertices[ index1 + 2 ];\n\n\t\t\t\t\tvar index2 = 9 * i + 3 * ( ( j + 1 ) % 3 );\n\t\t\t\t\tcoords[ index + 3 ] = vertices[ index2 ];\n\t\t\t\t\tcoords[ index + 4 ] = vertices[ index2 + 1 ];\n\t\t\t\t\tcoords[ index + 5 ] = vertices[ index2 + 2 ];\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.addAttribute( 'position', new THREE.BufferAttribute( coords, 3 ) );\n\n\t\t}\n\n\t}\n\n};\n\nTHREE.WireframeGeometry.prototype = Object.create( THREE.BufferGeometry.prototype );\nTHREE.WireframeGeometry.prototype.constructor = THREE.WireframeGeometry;\n\n// File:src/extras/helpers/AxisHelper.js\n\n/**\n * @author sroucheray / http://sroucheray.org/\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.AxisHelper = function ( size ) {\n\n\tsize = size || 1;\n\n\tvar vertices = new Float32Array( [\n\t\t0, 0, 0,  size, 0, 0,\n\t\t0, 0, 0,  0, size, 0,\n\t\t0, 0, 0,  0, 0, size\n\t] );\n\n\tvar colors = new Float32Array( [\n\t\t1, 0, 0,  1, 0.6, 0,\n\t\t0, 1, 0,  0.6, 1, 0,\n\t\t0, 0, 1,  0, 0.6, 1\n\t] );\n\n\tvar geometry = new THREE.BufferGeometry();\n\tgeometry.addAttribute( 'position', new THREE.BufferAttribute( vertices, 3 ) );\n\tgeometry.addAttribute( 'color', new THREE.BufferAttribute( colors, 3 ) );\n\n\tvar material = new THREE.LineBasicMaterial( { vertexColors: THREE.VertexColors } );\n\n\tTHREE.LineSegments.call( this, geometry, material );\n\n};\n\nTHREE.AxisHelper.prototype = Object.create( THREE.LineSegments.prototype );\nTHREE.AxisHelper.prototype.constructor = THREE.AxisHelper;\n\n// File:src/extras/helpers/ArrowHelper.js\n\n/**\n * @author WestLangley / http://github.com/WestLangley\n * @author zz85 / http://github.com/zz85\n * @author bhouston / http://exocortex.com\n *\n * Creates an arrow for visualizing directions\n *\n * Parameters:\n *  dir - Vector3\n *  origin - Vector3\n *  length - Number\n *  color - color in hex value\n *  headLength - Number\n *  headWidth - Number\n */\n\nTHREE.ArrowHelper = ( function () {\n\n\tvar lineGeometry = new THREE.Geometry();\n\tlineGeometry.vertices.push( new THREE.Vector3( 0, 0, 0 ), new THREE.Vector3( 0, 1, 0 ) );\n\n\tvar coneGeometry = new THREE.CylinderGeometry( 0, 0.5, 1, 5, 1 );\n\tconeGeometry.translate( 0, - 0.5, 0 );\n\n\treturn function ArrowHelper( dir, origin, length, color, headLength, headWidth ) {\n\n\t\t// dir is assumed to be normalized\n\n\t\tTHREE.Object3D.call( this );\n\n\t\tif ( color === undefined ) color = 0xffff00;\n\t\tif ( length === undefined ) length = 1;\n\t\tif ( headLength === undefined ) headLength = 0.2 * length;\n\t\tif ( headWidth === undefined ) headWidth = 0.2 * headLength;\n\n\t\tthis.position.copy( origin );\n\t\t\n\t\tif ( headLength < length ) {\n\t\t\tthis.line = new THREE.Line( lineGeometry, new THREE.LineBasicMaterial( { color: color } ) );\n\t\t\tthis.line.matrixAutoUpdate = false;\n\t\t\tthis.add( this.line );\n\t\t}\n\n\t\tthis.cone = new THREE.Mesh( coneGeometry, new THREE.MeshBasicMaterial( { color: color } ) );\n\t\tthis.cone.matrixAutoUpdate = false;\n\t\tthis.add( this.cone );\n\n\t\tthis.setDirection( dir );\n\t\tthis.setLength( length, headLength, headWidth );\n\n\t}\n\n}() );\n\nTHREE.ArrowHelper.prototype = Object.create( THREE.Object3D.prototype );\nTHREE.ArrowHelper.prototype.constructor = THREE.ArrowHelper;\n\nTHREE.ArrowHelper.prototype.setDirection = ( function () {\n\n\tvar axis = new THREE.Vector3();\n\tvar radians;\n\n\treturn function setDirection( dir ) {\n\n\t\t// dir is assumed to be normalized\n\n\t\tif ( dir.y > 0.99999 ) {\n\n\t\t\tthis.quaternion.set( 0, 0, 0, 1 );\n\n\t\t} else if ( dir.y < - 0.99999 ) {\n\n\t\t\tthis.quaternion.set( 1, 0, 0, 0 );\n\n\t\t} else {\n\n\t\t\taxis.set( dir.z, 0, - dir.x ).normalize();\n\n\t\t\tradians = Math.acos( dir.y );\n\n\t\t\tthis.quaternion.setFromAxisAngle( axis, radians );\n\n\t\t}\n\n\t};\n\n}() );\n\nTHREE.ArrowHelper.prototype.setLength = function ( length, headLength, headWidth ) {\n\n\tif ( headLength === undefined ) headLength = 0.2 * length;\n\tif ( headWidth === undefined ) headWidth = 0.2 * headLength;\n\n\tif ( headLength < length ){\n\t\tthis.line.scale.set( 1, length - headLength, 1 );\n\t\tthis.line.updateMatrix();\n\t}\n\n\tthis.cone.scale.set( headWidth, headLength, headWidth );\n\tthis.cone.position.y = length;\n\tthis.cone.updateMatrix();\n\n};\n\nTHREE.ArrowHelper.prototype.setColor = function ( color ) {\n\n\tif ( this.line !== undefined ) this.line.material.color.set( color );\n\tthis.cone.material.color.set( color );\n\n};\n\n// File:src/extras/helpers/BoxHelper.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.BoxHelper = function ( object ) {\n\n\tvar indices = new Uint16Array( [ 0, 1, 1, 2, 2, 3, 3, 0, 4, 5, 5, 6, 6, 7, 7, 4, 0, 4, 1, 5, 2, 6, 3, 7 ] );\n\tvar positions = new Float32Array( 8 * 3 );\n\n\tvar geometry = new THREE.BufferGeometry();\n\tgeometry.setIndex( new THREE.BufferAttribute( indices, 1 ) );\n\tgeometry.addAttribute( 'position', new THREE.BufferAttribute( positions, 3 ) );\n\n\tTHREE.LineSegments.call( this, geometry, new THREE.LineBasicMaterial( { color: 0xffff00 } ) );\n\n\tif ( object !== undefined ) {\n\n\t\tthis.update( object );\n\n\t}\n\n};\n\nTHREE.BoxHelper.prototype = Object.create( THREE.LineSegments.prototype );\nTHREE.BoxHelper.prototype.constructor = THREE.BoxHelper;\n\nTHREE.BoxHelper.prototype.update = ( function () {\n\n\tvar box = new THREE.Box3();\n\n\treturn function ( object ) {\n\n\t\tbox.setFromObject( object );\n\n\t\tif ( box.empty() ) return;\n\n\t\tvar min = box.min;\n\t\tvar max = box.max;\n\n\t\t/*\n\t\t  5____4\n\t\t1/___0/|\n\t\t| 6__|_7\n\t\t2/___3/\n\n\t\t0: max.x, max.y, max.z\n\t\t1: min.x, max.y, max.z\n\t\t2: min.x, min.y, max.z\n\t\t3: max.x, min.y, max.z\n\t\t4: max.x, max.y, min.z\n\t\t5: min.x, max.y, min.z\n\t\t6: min.x, min.y, min.z\n\t\t7: max.x, min.y, min.z\n\t\t*/\n\n\t\tvar position = this.geometry.attributes.position;\n\t\tvar array = position.array;\n\n\t\tarray[  0 ] = max.x; array[  1 ] = max.y; array[  2 ] = max.z;\n\t\tarray[  3 ] = min.x; array[  4 ] = max.y; array[  5 ] = max.z;\n\t\tarray[  6 ] = min.x; array[  7 ] = min.y; array[  8 ] = max.z;\n\t\tarray[  9 ] = max.x; array[ 10 ] = min.y; array[ 11 ] = max.z;\n\t\tarray[ 12 ] = max.x; array[ 13 ] = max.y; array[ 14 ] = min.z;\n\t\tarray[ 15 ] = min.x; array[ 16 ] = max.y; array[ 17 ] = min.z;\n\t\tarray[ 18 ] = min.x; array[ 19 ] = min.y; array[ 20 ] = min.z;\n\t\tarray[ 21 ] = max.x; array[ 22 ] = min.y; array[ 23 ] = min.z;\n\n\t\tposition.needsUpdate = true;\n\n\t\tthis.geometry.computeBoundingSphere();\n\n\t}\n\n} )();\n\n// File:src/extras/helpers/BoundingBoxHelper.js\n\n/**\n * @author WestLangley / http://github.com/WestLangley\n */\n\n// a helper to show the world-axis-aligned bounding box for an object\n\nTHREE.BoundingBoxHelper = function ( object, hex ) {\n\n\tvar color = ( hex !== undefined ) ? hex : 0x888888;\n\n\tthis.object = object;\n\n\tthis.box = new THREE.Box3();\n\n\tTHREE.Mesh.call( this, new THREE.BoxGeometry( 1, 1, 1 ), new THREE.MeshBasicMaterial( { color: color, wireframe: true } ) );\n\n};\n\nTHREE.BoundingBoxHelper.prototype = Object.create( THREE.Mesh.prototype );\nTHREE.BoundingBoxHelper.prototype.constructor = THREE.BoundingBoxHelper;\n\nTHREE.BoundingBoxHelper.prototype.update = function () {\n\n\tthis.box.setFromObject( this.object );\n\n\tthis.box.size( this.scale );\n\n\tthis.box.center( this.position );\n\n};\n\n// File:src/extras/helpers/CameraHelper.js\n\n/**\n * @author alteredq / http://alteredqualia.com/\n *\n *\t- shows frustum, line of sight and up of the camera\n *\t- suitable for fast updates\n * \t- based on frustum visualization in lightgl.js shadowmap example\n *\t\thttp://evanw.github.com/lightgl.js/tests/shadowmap.html\n */\n\nTHREE.CameraHelper = function ( camera ) {\n\n\tvar geometry = new THREE.Geometry();\n\tvar material = new THREE.LineBasicMaterial( { color: 0xffffff, vertexColors: THREE.FaceColors } );\n\n\tvar pointMap = {};\n\n\t// colors\n\n\tvar hexFrustum = 0xffaa00;\n\tvar hexCone = 0xff0000;\n\tvar hexUp = 0x00aaff;\n\tvar hexTarget = 0xffffff;\n\tvar hexCross = 0x333333;\n\n\t// near\n\n\taddLine( \"n1\", \"n2\", hexFrustum );\n\taddLine( \"n2\", \"n4\", hexFrustum );\n\taddLine( \"n4\", \"n3\", hexFrustum );\n\taddLine( \"n3\", \"n1\", hexFrustum );\n\n\t// far\n\n\taddLine( \"f1\", \"f2\", hexFrustum );\n\taddLine( \"f2\", \"f4\", hexFrustum );\n\taddLine( \"f4\", \"f3\", hexFrustum );\n\taddLine( \"f3\", \"f1\", hexFrustum );\n\n\t// sides\n\n\taddLine( \"n1\", \"f1\", hexFrustum );\n\taddLine( \"n2\", \"f2\", hexFrustum );\n\taddLine( \"n3\", \"f3\", hexFrustum );\n\taddLine( \"n4\", \"f4\", hexFrustum );\n\n\t// cone\n\n\taddLine( \"p\", \"n1\", hexCone );\n\taddLine( \"p\", \"n2\", hexCone );\n\taddLine( \"p\", \"n3\", hexCone );\n\taddLine( \"p\", \"n4\", hexCone );\n\n\t// up\n\n\taddLine( \"u1\", \"u2\", hexUp );\n\taddLine( \"u2\", \"u3\", hexUp );\n\taddLine( \"u3\", \"u1\", hexUp );\n\n\t// target\n\n\taddLine( \"c\", \"t\", hexTarget );\n\taddLine( \"p\", \"c\", hexCross );\n\n\t// cross\n\n\taddLine( \"cn1\", \"cn2\", hexCross );\n\taddLine( \"cn3\", \"cn4\", hexCross );\n\n\taddLine( \"cf1\", \"cf2\", hexCross );\n\taddLine( \"cf3\", \"cf4\", hexCross );\n\n\tfunction addLine( a, b, hex ) {\n\n\t\taddPoint( a, hex );\n\t\taddPoint( b, hex );\n\n\t}\n\n\tfunction addPoint( id, hex ) {\n\n\t\tgeometry.vertices.push( new THREE.Vector3() );\n\t\tgeometry.colors.push( new THREE.Color( hex ) );\n\n\t\tif ( pointMap[ id ] === undefined ) {\n\n\t\t\tpointMap[ id ] = [];\n\n\t\t}\n\n\t\tpointMap[ id ].push( geometry.vertices.length - 1 );\n\n\t}\n\n\tTHREE.LineSegments.call( this, geometry, material );\n\n\tthis.camera = camera;\n\tthis.matrix = camera.matrixWorld;\n\tthis.matrixAutoUpdate = false;\n\n\tthis.pointMap = pointMap;\n\n\tthis.update();\n\n};\n\nTHREE.CameraHelper.prototype = Object.create( THREE.LineSegments.prototype );\nTHREE.CameraHelper.prototype.constructor = THREE.CameraHelper;\n\nTHREE.CameraHelper.prototype.update = function () {\n\n\tvar geometry, pointMap;\n\n\tvar vector = new THREE.Vector3();\n\tvar camera = new THREE.Camera();\n\n\tvar setPoint = function ( point, x, y, z ) {\n\n\t\tvector.set( x, y, z ).unproject( camera );\n\n\t\tvar points = pointMap[ point ];\n\n\t\tif ( points !== undefined ) {\n\n\t\t\tfor ( var i = 0, il = points.length; i < il; i ++ ) {\n\n\t\t\t\tgeometry.vertices[ points[ i ] ].copy( vector );\n\n\t\t\t}\n\n\t\t}\n\n\t};\n\n\treturn function () {\n\n\t\tgeometry = this.geometry;\n\t\tpointMap = this.pointMap;\n\n\t\tvar w = 1, h = 1;\n\n\t\t// we need just camera projection matrix\n\t\t// world matrix must be identity\n\n\t\tcamera.projectionMatrix.copy( this.camera.projectionMatrix );\n\n\t\t// center / target\n\n\t\tsetPoint( \"c\", 0, 0, - 1 );\n\t\tsetPoint( \"t\", 0, 0,  1 );\n\n\t\t// near\n\n\t\tsetPoint( \"n1\", - w, - h, - 1 );\n\t\tsetPoint( \"n2\",   w, - h, - 1 );\n\t\tsetPoint( \"n3\", - w,   h, - 1 );\n\t\tsetPoint( \"n4\",   w,   h, - 1 );\n\n\t\t// far\n\n\t\tsetPoint( \"f1\", - w, - h, 1 );\n\t\tsetPoint( \"f2\",   w, - h, 1 );\n\t\tsetPoint( \"f3\", - w,   h, 1 );\n\t\tsetPoint( \"f4\",   w,   h, 1 );\n\n\t\t// up\n\n\t\tsetPoint( \"u1\",   w * 0.7, h * 1.1, - 1 );\n\t\tsetPoint( \"u2\", - w * 0.7, h * 1.1, - 1 );\n\t\tsetPoint( \"u3\",         0, h * 2,   - 1 );\n\n\t\t// cross\n\n\t\tsetPoint( \"cf1\", - w,   0, 1 );\n\t\tsetPoint( \"cf2\",   w,   0, 1 );\n\t\tsetPoint( \"cf3\",   0, - h, 1 );\n\t\tsetPoint( \"cf4\",   0,   h, 1 );\n\n\t\tsetPoint( \"cn1\", - w,   0, - 1 );\n\t\tsetPoint( \"cn2\",   w,   0, - 1 );\n\t\tsetPoint( \"cn3\",   0, - h, - 1 );\n\t\tsetPoint( \"cn4\",   0,   h, - 1 );\n\n\t\tgeometry.verticesNeedUpdate = true;\n\n\t};\n\n}();\n\n// File:src/extras/helpers/DirectionalLightHelper.js\n\n/**\n * @author alteredq / http://alteredqualia.com/\n * @author mrdoob / http://mrdoob.com/\n * @author WestLangley / http://github.com/WestLangley\n */\n\nTHREE.DirectionalLightHelper = function ( light, size ) {\n\n\tTHREE.Object3D.call( this );\n\n\tthis.light = light;\n\tthis.light.updateMatrixWorld();\n\n\tthis.matrix = light.matrixWorld;\n\tthis.matrixAutoUpdate = false;\n\n\tsize = size || 1;\n\n\tvar geometry = new THREE.Geometry();\n\tgeometry.vertices.push(\n\t\tnew THREE.Vector3( - size,   size, 0 ),\n\t\tnew THREE.Vector3(   size,   size, 0 ),\n\t\tnew THREE.Vector3(   size, - size, 0 ),\n\t\tnew THREE.Vector3( - size, - size, 0 ),\n\t\tnew THREE.Vector3( - size,   size, 0 )\n\t);\n\n\tvar material = new THREE.LineBasicMaterial( { fog: false } );\n\tmaterial.color.copy( this.light.color ).multiplyScalar( this.light.intensity );\n\n\tthis.lightPlane = new THREE.Line( geometry, material );\n\tthis.add( this.lightPlane );\n\n\tgeometry = new THREE.Geometry();\n\tgeometry.vertices.push(\n\t\tnew THREE.Vector3(),\n\t\tnew THREE.Vector3()\n\t);\n\n\tmaterial = new THREE.LineBasicMaterial( { fog: false } );\n\tmaterial.color.copy( this.light.color ).multiplyScalar( this.light.intensity );\n\n\tthis.targetLine = new THREE.Line( geometry, material );\n\tthis.add( this.targetLine );\n\n\tthis.update();\n\n};\n\nTHREE.DirectionalLightHelper.prototype = Object.create( THREE.Object3D.prototype );\nTHREE.DirectionalLightHelper.prototype.constructor = THREE.DirectionalLightHelper;\n\nTHREE.DirectionalLightHelper.prototype.dispose = function () {\n\n\tthis.lightPlane.geometry.dispose();\n\tthis.lightPlane.material.dispose();\n\tthis.targetLine.geometry.dispose();\n\tthis.targetLine.material.dispose();\n\n};\n\nTHREE.DirectionalLightHelper.prototype.update = function () {\n\n\tvar v1 = new THREE.Vector3();\n\tvar v2 = new THREE.Vector3();\n\tvar v3 = new THREE.Vector3();\n\n\treturn function () {\n\n\t\tv1.setFromMatrixPosition( this.light.matrixWorld );\n\t\tv2.setFromMatrixPosition( this.light.target.matrixWorld );\n\t\tv3.subVectors( v2, v1 );\n\n\t\tthis.lightPlane.lookAt( v3 );\n\t\tthis.lightPlane.material.color.copy( this.light.color ).multiplyScalar( this.light.intensity );\n\n\t\tthis.targetLine.geometry.vertices[ 1 ].copy( v3 );\n\t\tthis.targetLine.geometry.verticesNeedUpdate = true;\n\t\tthis.targetLine.material.color.copy( this.lightPlane.material.color );\n\n\t};\n\n}();\n\n// File:src/extras/helpers/EdgesHelper.js\n\n/**\n * @author WestLangley / http://github.com/WestLangley\n * @param object THREE.Mesh whose geometry will be used\n * @param hex line color\n * @param thresholdAngle the minimum angle (in degrees),\n * between the face normals of adjacent faces,\n * that is required to render an edge. A value of 10 means\n * an edge is only rendered if the angle is at least 10 degrees.\n */\n\nTHREE.EdgesHelper = function ( object, hex, thresholdAngle ) {\n\n\tvar color = ( hex !== undefined ) ? hex : 0xffffff;\n\n\tTHREE.LineSegments.call( this, new THREE.EdgesGeometry( object.geometry, thresholdAngle ), new THREE.LineBasicMaterial( { color: color } ) );\n\n\tthis.matrix = object.matrixWorld;\n\tthis.matrixAutoUpdate = false;\n\n};\n\nTHREE.EdgesHelper.prototype = Object.create( THREE.LineSegments.prototype );\nTHREE.EdgesHelper.prototype.constructor = THREE.EdgesHelper;\n\n// File:src/extras/helpers/FaceNormalsHelper.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n * @author WestLangley / http://github.com/WestLangley\n*/\n\nTHREE.FaceNormalsHelper = function ( object, size, hex, linewidth ) {\n\n\t// FaceNormalsHelper only supports THREE.Geometry\n\n\tthis.object = object;\n\n\tthis.size = ( size !== undefined ) ? size : 1;\n\n\tvar color = ( hex !== undefined ) ? hex : 0xffff00;\n\n\tvar width = ( linewidth !== undefined ) ? linewidth : 1;\n\n\t//\n\n\tvar nNormals = 0;\n\n\tvar objGeometry = this.object.geometry;\n\n\tif ( objGeometry instanceof THREE.Geometry ) {\n\n\t\tnNormals = objGeometry.faces.length;\n\n\t} else {\n\n\t\tconsole.warn( 'THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.' );\n\n\t}\n\n\t//\n\n\tvar geometry = new THREE.BufferGeometry();\n\n\tvar positions = new THREE.Float32Attribute( nNormals * 2 * 3, 3 );\n\n\tgeometry.addAttribute( 'position', positions );\n\n\tTHREE.LineSegments.call( this, geometry, new THREE.LineBasicMaterial( { color: color, linewidth: width } ) );\n\n\t//\n\n\tthis.matrixAutoUpdate = false;\n\tthis.update();\n\n};\n\nTHREE.FaceNormalsHelper.prototype = Object.create( THREE.LineSegments.prototype );\nTHREE.FaceNormalsHelper.prototype.constructor = THREE.FaceNormalsHelper;\n\nTHREE.FaceNormalsHelper.prototype.update = ( function () {\n\n\tvar v1 = new THREE.Vector3();\n\tvar v2 = new THREE.Vector3();\n\tvar normalMatrix = new THREE.Matrix3();\n\n\treturn function update() {\n\n\t\tthis.object.updateMatrixWorld( true );\n\n\t\tnormalMatrix.getNormalMatrix( this.object.matrixWorld );\n\n\t\tvar matrixWorld = this.object.matrixWorld;\n\n\t\tvar position = this.geometry.attributes.position;\n\n\t\t//\n\n\t\tvar objGeometry = this.object.geometry;\n\n\t\tvar vertices = objGeometry.vertices;\n\n\t\tvar faces = objGeometry.faces;\n\n\t\tvar idx = 0;\n\n\t\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\n\n\t\t\tvar face = faces[ i ];\n\n\t\t\tvar normal = face.normal;\n\n\t\t\tv1.copy( vertices[ face.a ] )\n\t\t\t\t.add( vertices[ face.b ] )\n\t\t\t\t.add( vertices[ face.c ] )\n\t\t\t\t.divideScalar( 3 )\n\t\t\t\t.applyMatrix4( matrixWorld );\n\n\t\t\tv2.copy( normal ).applyMatrix3( normalMatrix ).normalize().multiplyScalar( this.size ).add( v1 );\n\n\t\t\tposition.setXYZ( idx, v1.x, v1.y, v1.z );\n\n\t\t\tidx = idx + 1;\n\n\t\t\tposition.setXYZ( idx, v2.x, v2.y, v2.z );\n\n\t\t\tidx = idx + 1;\n\n\t\t}\n\n\t\tposition.needsUpdate = true;\n\n\t\treturn this;\n\n\t}\n\n}() );\n\n// File:src/extras/helpers/GridHelper.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.GridHelper = function ( size, step ) {\n\n\tvar geometry = new THREE.Geometry();\n\tvar material = new THREE.LineBasicMaterial( { vertexColors: THREE.VertexColors } );\n\n\tthis.color1 = new THREE.Color( 0x444444 );\n\tthis.color2 = new THREE.Color( 0x888888 );\n\n\tfor ( var i = - size; i <= size; i += step ) {\n\n\t\tgeometry.vertices.push(\n\t\t\tnew THREE.Vector3( - size, 0, i ), new THREE.Vector3( size, 0, i ),\n\t\t\tnew THREE.Vector3( i, 0, - size ), new THREE.Vector3( i, 0, size )\n\t\t);\n\n\t\tvar color = i === 0 ? this.color1 : this.color2;\n\n\t\tgeometry.colors.push( color, color, color, color );\n\n\t}\n\n\tTHREE.LineSegments.call( this, geometry, material );\n\n};\n\nTHREE.GridHelper.prototype = Object.create( THREE.LineSegments.prototype );\nTHREE.GridHelper.prototype.constructor = THREE.GridHelper;\n\nTHREE.GridHelper.prototype.setColors = function( colorCenterLine, colorGrid ) {\n\n\tthis.color1.set( colorCenterLine );\n\tthis.color2.set( colorGrid );\n\n\tthis.geometry.colorsNeedUpdate = true;\n\n};\n\n// File:src/extras/helpers/HemisphereLightHelper.js\n\n/**\n * @author alteredq / http://alteredqualia.com/\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.HemisphereLightHelper = function ( light, sphereSize ) {\n\n\tTHREE.Object3D.call( this );\n\n\tthis.light = light;\n\tthis.light.updateMatrixWorld();\n\n\tthis.matrix = light.matrixWorld;\n\tthis.matrixAutoUpdate = false;\n\n\tthis.colors = [ new THREE.Color(), new THREE.Color() ];\n\n\tvar geometry = new THREE.SphereGeometry( sphereSize, 4, 2 );\n\tgeometry.rotateX( - Math.PI / 2 );\n\n\tfor ( var i = 0, il = 8; i < il; i ++ ) {\n\n\t\tgeometry.faces[ i ].color = this.colors[ i < 4 ? 0 : 1 ];\n\n\t}\n\n\tvar material = new THREE.MeshBasicMaterial( { vertexColors: THREE.FaceColors, wireframe: true } );\n\n\tthis.lightSphere = new THREE.Mesh( geometry, material );\n\tthis.add( this.lightSphere );\n\n\tthis.update();\n\n};\n\nTHREE.HemisphereLightHelper.prototype = Object.create( THREE.Object3D.prototype );\nTHREE.HemisphereLightHelper.prototype.constructor = THREE.HemisphereLightHelper;\n\nTHREE.HemisphereLightHelper.prototype.dispose = function () {\n\n\tthis.lightSphere.geometry.dispose();\n\tthis.lightSphere.material.dispose();\n\n};\n\nTHREE.HemisphereLightHelper.prototype.update = function () {\n\n\tvar vector = new THREE.Vector3();\n\n\treturn function () {\n\n\t\tthis.colors[ 0 ].copy( this.light.color ).multiplyScalar( this.light.intensity );\n\t\tthis.colors[ 1 ].copy( this.light.groundColor ).multiplyScalar( this.light.intensity );\n\n\t\tthis.lightSphere.lookAt( vector.setFromMatrixPosition( this.light.matrixWorld ).negate() );\n\t\tthis.lightSphere.geometry.colorsNeedUpdate = true;\n\n\t}\n\n}();\n\n// File:src/extras/helpers/PointLightHelper.js\n\n/**\n * @author alteredq / http://alteredqualia.com/\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.PointLightHelper = function ( light, sphereSize ) {\n\n\tthis.light = light;\n\tthis.light.updateMatrixWorld();\n\n\tvar geometry = new THREE.SphereGeometry( sphereSize, 4, 2 );\n\tvar material = new THREE.MeshBasicMaterial( { wireframe: true, fog: false } );\n\tmaterial.color.copy( this.light.color ).multiplyScalar( this.light.intensity );\n\n\tTHREE.Mesh.call( this, geometry, material );\n\n\tthis.matrix = this.light.matrixWorld;\n\tthis.matrixAutoUpdate = false;\n\n\t/*\n\tvar distanceGeometry = new THREE.IcosahedronGeometry( 1, 2 );\n\tvar distanceMaterial = new THREE.MeshBasicMaterial( { color: hexColor, fog: false, wireframe: true, opacity: 0.1, transparent: true } );\n\n\tthis.lightSphere = new THREE.Mesh( bulbGeometry, bulbMaterial );\n\tthis.lightDistance = new THREE.Mesh( distanceGeometry, distanceMaterial );\n\n\tvar d = light.distance;\n\n\tif ( d === 0.0 ) {\n\n\t\tthis.lightDistance.visible = false;\n\n\t} else {\n\n\t\tthis.lightDistance.scale.set( d, d, d );\n\n\t}\n\n\tthis.add( this.lightDistance );\n\t*/\n\n};\n\nTHREE.PointLightHelper.prototype = Object.create( THREE.Mesh.prototype );\nTHREE.PointLightHelper.prototype.constructor = THREE.PointLightHelper;\n\nTHREE.PointLightHelper.prototype.dispose = function () {\n\n\tthis.geometry.dispose();\n\tthis.material.dispose();\n\n};\n\nTHREE.PointLightHelper.prototype.update = function () {\n\n\tthis.material.color.copy( this.light.color ).multiplyScalar( this.light.intensity );\n\n\t/*\n\tvar d = this.light.distance;\n\n\tif ( d === 0.0 ) {\n\n\t\tthis.lightDistance.visible = false;\n\n\t} else {\n\n\t\tthis.lightDistance.visible = true;\n\t\tthis.lightDistance.scale.set( d, d, d );\n\n\t}\n\t*/\n\n};\n\n// File:src/extras/helpers/SkeletonHelper.js\n\n/**\n * @author Sean Griffin / http://twitter.com/sgrif\n * @author Michael Guerrero / http://realitymeltdown.com\n * @author mrdoob / http://mrdoob.com/\n * @author ikerr / http://verold.com\n */\n\nTHREE.SkeletonHelper = function ( object ) {\n\n\tthis.bones = this.getBoneList( object );\n\n\tvar geometry = new THREE.Geometry();\n\n\tfor ( var i = 0; i < this.bones.length; i ++ ) {\n\n\t\tvar bone = this.bones[ i ];\n\n\t\tif ( bone.parent instanceof THREE.Bone ) {\n\n\t\t\tgeometry.vertices.push( new THREE.Vector3() );\n\t\t\tgeometry.vertices.push( new THREE.Vector3() );\n\t\t\tgeometry.colors.push( new THREE.Color( 0, 0, 1 ) );\n\t\t\tgeometry.colors.push( new THREE.Color( 0, 1, 0 ) );\n\n\t\t}\n\n\t}\n\n\tgeometry.dynamic = true;\n\n\tvar material = new THREE.LineBasicMaterial( { vertexColors: THREE.VertexColors, depthTest: false, depthWrite: false, transparent: true } );\n\n\tTHREE.LineSegments.call( this, geometry, material );\n\n\tthis.root = object;\n\n\tthis.matrix = object.matrixWorld;\n\tthis.matrixAutoUpdate = false;\n\n\tthis.update();\n\n};\n\n\nTHREE.SkeletonHelper.prototype = Object.create( THREE.LineSegments.prototype );\nTHREE.SkeletonHelper.prototype.constructor = THREE.SkeletonHelper;\n\nTHREE.SkeletonHelper.prototype.getBoneList = function( object ) {\n\n\tvar boneList = [];\n\n\tif ( object instanceof THREE.Bone ) {\n\n\t\tboneList.push( object );\n\n\t}\n\n\tfor ( var i = 0; i < object.children.length; i ++ ) {\n\n\t\tboneList.push.apply( boneList, this.getBoneList( object.children[ i ] ) );\n\n\t}\n\n\treturn boneList;\n\n};\n\nTHREE.SkeletonHelper.prototype.update = function () {\n\n\tvar geometry = this.geometry;\n\n\tvar matrixWorldInv = new THREE.Matrix4().getInverse( this.root.matrixWorld );\n\n\tvar boneMatrix = new THREE.Matrix4();\n\n\tvar j = 0;\n\n\tfor ( var i = 0; i < this.bones.length; i ++ ) {\n\n\t\tvar bone = this.bones[ i ];\n\n\t\tif ( bone.parent instanceof THREE.Bone ) {\n\n\t\t\tboneMatrix.multiplyMatrices( matrixWorldInv, bone.matrixWorld );\n\t\t\tgeometry.vertices[ j ].setFromMatrixPosition( boneMatrix );\n\n\t\t\tboneMatrix.multiplyMatrices( matrixWorldInv, bone.parent.matrixWorld );\n\t\t\tgeometry.vertices[ j + 1 ].setFromMatrixPosition( boneMatrix );\n\n\t\t\tj += 2;\n\n\t\t}\n\n\t}\n\n\tgeometry.verticesNeedUpdate = true;\n\n\tgeometry.computeBoundingSphere();\n\n};\n\n// File:src/extras/helpers/SpotLightHelper.js\n\n/**\n * @author alteredq / http://alteredqualia.com/\n * @author mrdoob / http://mrdoob.com/\n * @author WestLangley / http://github.com/WestLangley\n*/\n\nTHREE.SpotLightHelper = function ( light ) {\n\n\tTHREE.Object3D.call( this );\n\n\tthis.light = light;\n\tthis.light.updateMatrixWorld();\n\n\tthis.matrix = light.matrixWorld;\n\tthis.matrixAutoUpdate = false;\n\n\tvar geometry = new THREE.CylinderGeometry( 0, 1, 1, 8, 1, true );\n\n\tgeometry.translate( 0, - 0.5, 0 );\n\tgeometry.rotateX( - Math.PI / 2 );\n\n\tvar material = new THREE.MeshBasicMaterial( { wireframe: true, fog: false } );\n\n\tthis.cone = new THREE.Mesh( geometry, material );\n\tthis.add( this.cone );\n\n\tthis.update();\n\n};\n\nTHREE.SpotLightHelper.prototype = Object.create( THREE.Object3D.prototype );\nTHREE.SpotLightHelper.prototype.constructor = THREE.SpotLightHelper;\n\nTHREE.SpotLightHelper.prototype.dispose = function () {\n\n\tthis.cone.geometry.dispose();\n\tthis.cone.material.dispose();\n\n};\n\nTHREE.SpotLightHelper.prototype.update = function () {\n\n\tvar vector = new THREE.Vector3();\n\tvar vector2 = new THREE.Vector3();\n\n\treturn function () {\n\n\t\tvar coneLength = this.light.distance ? this.light.distance : 10000;\n\t\tvar coneWidth = coneLength * Math.tan( this.light.angle );\n\n\t\tthis.cone.scale.set( coneWidth, coneWidth, coneLength );\n\n\t\tvector.setFromMatrixPosition( this.light.matrixWorld );\n\t\tvector2.setFromMatrixPosition( this.light.target.matrixWorld );\n\n\t\tthis.cone.lookAt( vector2.sub( vector ) );\n\n\t\tthis.cone.material.color.copy( this.light.color ).multiplyScalar( this.light.intensity );\n\n\t};\n\n}();\n\n// File:src/extras/helpers/VertexNormalsHelper.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n * @author WestLangley / http://github.com/WestLangley\n*/\n\nTHREE.VertexNormalsHelper = function ( object, size, hex, linewidth ) {\n\n\tthis.object = object;\n\n\tthis.size = ( size !== undefined ) ? size : 1;\n\n\tvar color = ( hex !== undefined ) ? hex : 0xff0000;\n\n\tvar width = ( linewidth !== undefined ) ? linewidth : 1;\n\n\t//\n\n\tvar nNormals = 0;\n\n\tvar objGeometry = this.object.geometry;\n\n\tif ( objGeometry instanceof THREE.Geometry ) {\n\n\t\tnNormals = objGeometry.faces.length * 3;\n\n\t} else if ( objGeometry instanceof THREE.BufferGeometry ) {\n\n\t\tnNormals = objGeometry.attributes.normal.count\n\n\t}\n\n\t//\n\n\tvar geometry = new THREE.BufferGeometry();\n\n\tvar positions = new THREE.Float32Attribute( nNormals * 2 * 3, 3 );\n\n\tgeometry.addAttribute( 'position', positions );\n\n\tTHREE.LineSegments.call( this, geometry, new THREE.LineBasicMaterial( { color: color, linewidth: width } ) );\n\n\t//\n\n\tthis.matrixAutoUpdate = false;\n\n\tthis.update();\n\n};\n\nTHREE.VertexNormalsHelper.prototype = Object.create( THREE.LineSegments.prototype );\nTHREE.VertexNormalsHelper.prototype.constructor = THREE.VertexNormalsHelper;\n\nTHREE.VertexNormalsHelper.prototype.update = ( function () {\n\n\tvar v1 = new THREE.Vector3();\n\tvar v2 = new THREE.Vector3();\n\tvar normalMatrix = new THREE.Matrix3();\n\n\treturn function update() {\n\n\t\tvar keys = [ 'a', 'b', 'c' ];\n\n\t\tthis.object.updateMatrixWorld( true );\n\n\t\tnormalMatrix.getNormalMatrix( this.object.matrixWorld );\n\n\t\tvar matrixWorld = this.object.matrixWorld;\n\n\t\tvar position = this.geometry.attributes.position;\n\n\t\t//\n\n\t\tvar objGeometry = this.object.geometry;\n\n\t\tif ( objGeometry instanceof THREE.Geometry ) {\n\n\t\t\tvar vertices = objGeometry.vertices;\n\n\t\t\tvar faces = objGeometry.faces;\n\n\t\t\tvar idx = 0;\n\n\t\t\tfor ( var i = 0, l = faces.length; i < l; i ++ ) {\n\n\t\t\t\tvar face = faces[ i ];\n\n\t\t\t\tfor ( var j = 0, jl = face.vertexNormals.length; j < jl; j ++ ) {\n\n\t\t\t\t\tvar vertex = vertices[ face[ keys[ j ] ] ];\n\n\t\t\t\t\tvar normal = face.vertexNormals[ j ];\n\n\t\t\t\t\tv1.copy( vertex ).applyMatrix4( matrixWorld );\n\n\t\t\t\t\tv2.copy( normal ).applyMatrix3( normalMatrix ).normalize().multiplyScalar( this.size ).add( v1 );\n\n\t\t\t\t\tposition.setXYZ( idx, v1.x, v1.y, v1.z );\n\n\t\t\t\t\tidx = idx + 1;\n\n\t\t\t\t\tposition.setXYZ( idx, v2.x, v2.y, v2.z );\n\n\t\t\t\t\tidx = idx + 1;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( objGeometry instanceof THREE.BufferGeometry ) {\n\n\t\t\tvar objPos = objGeometry.attributes.position;\n\n\t\t\tvar objNorm = objGeometry.attributes.normal;\n\n\t\t\tvar idx = 0;\n\n\t\t\t// for simplicity, ignore index and drawcalls, and render every normal\n\n\t\t\tfor ( var j = 0, jl = objPos.count; j < jl; j ++ ) {\n\n\t\t\t\tv1.set( objPos.getX( j ), objPos.getY( j ), objPos.getZ( j ) ).applyMatrix4( matrixWorld );\n\n\t\t\t\tv2.set( objNorm.getX( j ), objNorm.getY( j ), objNorm.getZ( j ) );\n\n\t\t\t\tv2.applyMatrix3( normalMatrix ).normalize().multiplyScalar( this.size ).add( v1 );\n\n\t\t\t\tposition.setXYZ( idx, v1.x, v1.y, v1.z );\n\n\t\t\t\tidx = idx + 1;\n\n\t\t\t\tposition.setXYZ( idx, v2.x, v2.y, v2.z );\n\n\t\t\t\tidx = idx + 1;\n\n\t\t\t}\n\n\t\t}\n\n\t\tposition.needsUpdate = true;\n\n\t\treturn this;\n\n\t}\n\n}() );\n\n// File:src/extras/helpers/WireframeHelper.js\n\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.WireframeHelper = function ( object, hex ) {\n\n\tvar color = ( hex !== undefined ) ? hex : 0xffffff;\n\n\tTHREE.LineSegments.call( this, new THREE.WireframeGeometry( object.geometry ), new THREE.LineBasicMaterial( { color: color } ) );\n\n\tthis.matrix = object.matrixWorld;\n\tthis.matrixAutoUpdate = false;\n\n};\n\nTHREE.WireframeHelper.prototype = Object.create( THREE.LineSegments.prototype );\nTHREE.WireframeHelper.prototype.constructor = THREE.WireframeHelper;\n\n// File:src/extras/objects/ImmediateRenderObject.js\n\n/**\n * @author alteredq / http://alteredqualia.com/\n */\n\nTHREE.ImmediateRenderObject = function () {\n\n\tTHREE.Object3D.call( this );\n\n\tthis.render = function ( renderCallback ) {};\n\n};\n\nTHREE.ImmediateRenderObject.prototype = Object.create( THREE.Object3D.prototype );\nTHREE.ImmediateRenderObject.prototype.constructor = THREE.ImmediateRenderObject;\n\n// File:src/extras/objects/MorphBlendMesh.js\n\n/**\n * @author alteredq / http://alteredqualia.com/\n */\n\nTHREE.MorphBlendMesh = function( geometry, material ) {\n\n\tTHREE.Mesh.call( this, geometry, material );\n\n\tthis.animationsMap = {};\n\tthis.animationsList = [];\n\n\t// prepare default animation\n\t// (all frames played together in 1 second)\n\n\tvar numFrames = this.geometry.morphTargets.length;\n\n\tvar name = \"__default\";\n\n\tvar startFrame = 0;\n\tvar endFrame = numFrames - 1;\n\n\tvar fps = numFrames / 1;\n\n\tthis.createAnimation( name, startFrame, endFrame, fps );\n\tthis.setAnimationWeight( name, 1 );\n\n};\n\nTHREE.MorphBlendMesh.prototype = Object.create( THREE.Mesh.prototype );\nTHREE.MorphBlendMesh.prototype.constructor = THREE.MorphBlendMesh;\n\nTHREE.MorphBlendMesh.prototype.createAnimation = function ( name, start, end, fps ) {\n\n\tvar animation = {\n\n\t\tstart: start,\n\t\tend: end,\n\n\t\tlength: end - start + 1,\n\n\t\tfps: fps,\n\t\tduration: ( end - start ) / fps,\n\n\t\tlastFrame: 0,\n\t\tcurrentFrame: 0,\n\n\t\tactive: false,\n\n\t\ttime: 0,\n\t\tdirection: 1,\n\t\tweight: 1,\n\n\t\tdirectionBackwards: false,\n\t\tmirroredLoop: false\n\n\t};\n\n\tthis.animationsMap[ name ] = animation;\n\tthis.animationsList.push( animation );\n\n};\n\nTHREE.MorphBlendMesh.prototype.autoCreateAnimations = function ( fps ) {\n\n\tvar pattern = /([a-z]+)_?(\\d+)/;\n\n\tvar firstAnimation, frameRanges = {};\n\n\tvar geometry = this.geometry;\n\n\tfor ( var i = 0, il = geometry.morphTargets.length; i < il; i ++ ) {\n\n\t\tvar morph = geometry.morphTargets[ i ];\n\t\tvar chunks = morph.name.match( pattern );\n\n\t\tif ( chunks && chunks.length > 1 ) {\n\n\t\t\tvar name = chunks[ 1 ];\n\n\t\t\tif ( ! frameRanges[ name ] ) frameRanges[ name ] = { start: Infinity, end: - Infinity };\n\n\t\t\tvar range = frameRanges[ name ];\n\n\t\t\tif ( i < range.start ) range.start = i;\n\t\t\tif ( i > range.end ) range.end = i;\n\n\t\t\tif ( ! firstAnimation ) firstAnimation = name;\n\n\t\t}\n\n\t}\n\n\tfor ( var name in frameRanges ) {\n\n\t\tvar range = frameRanges[ name ];\n\t\tthis.createAnimation( name, range.start, range.end, fps );\n\n\t}\n\n\tthis.firstAnimation = firstAnimation;\n\n};\n\nTHREE.MorphBlendMesh.prototype.setAnimationDirectionForward = function ( name ) {\n\n\tvar animation = this.animationsMap[ name ];\n\n\tif ( animation ) {\n\n\t\tanimation.direction = 1;\n\t\tanimation.directionBackwards = false;\n\n\t}\n\n};\n\nTHREE.MorphBlendMesh.prototype.setAnimationDirectionBackward = function ( name ) {\n\n\tvar animation = this.animationsMap[ name ];\n\n\tif ( animation ) {\n\n\t\tanimation.direction = - 1;\n\t\tanimation.directionBackwards = true;\n\n\t}\n\n};\n\nTHREE.MorphBlendMesh.prototype.setAnimationFPS = function ( name, fps ) {\n\n\tvar animation = this.animationsMap[ name ];\n\n\tif ( animation ) {\n\n\t\tanimation.fps = fps;\n\t\tanimation.duration = ( animation.end - animation.start ) / animation.fps;\n\n\t}\n\n};\n\nTHREE.MorphBlendMesh.prototype.setAnimationDuration = function ( name, duration ) {\n\n\tvar animation = this.animationsMap[ name ];\n\n\tif ( animation ) {\n\n\t\tanimation.duration = duration;\n\t\tanimation.fps = ( animation.end - animation.start ) / animation.duration;\n\n\t}\n\n};\n\nTHREE.MorphBlendMesh.prototype.setAnimationWeight = function ( name, weight ) {\n\n\tvar animation = this.animationsMap[ name ];\n\n\tif ( animation ) {\n\n\t\tanimation.weight = weight;\n\n\t}\n\n};\n\nTHREE.MorphBlendMesh.prototype.setAnimationTime = function ( name, time ) {\n\n\tvar animation = this.animationsMap[ name ];\n\n\tif ( animation ) {\n\n\t\tanimation.time = time;\n\n\t}\n\n};\n\nTHREE.MorphBlendMesh.prototype.getAnimationTime = function ( name ) {\n\n\tvar time = 0;\n\n\tvar animation = this.animationsMap[ name ];\n\n\tif ( animation ) {\n\n\t\ttime = animation.time;\n\n\t}\n\n\treturn time;\n\n};\n\nTHREE.MorphBlendMesh.prototype.getAnimationDuration = function ( name ) {\n\n\tvar duration = - 1;\n\n\tvar animation = this.animationsMap[ name ];\n\n\tif ( animation ) {\n\n\t\tduration = animation.duration;\n\n\t}\n\n\treturn duration;\n\n};\n\nTHREE.MorphBlendMesh.prototype.playAnimation = function ( name ) {\n\n\tvar animation = this.animationsMap[ name ];\n\n\tif ( animation ) {\n\n\t\tanimation.time = 0;\n\t\tanimation.active = true;\n\n\t} else {\n\n\t\tconsole.warn( \"THREE.MorphBlendMesh: animation[\" + name + \"] undefined in .playAnimation()\" );\n\n\t}\n\n};\n\nTHREE.MorphBlendMesh.prototype.stopAnimation = function ( name ) {\n\n\tvar animation = this.animationsMap[ name ];\n\n\tif ( animation ) {\n\n\t\tanimation.active = false;\n\n\t}\n\n};\n\nTHREE.MorphBlendMesh.prototype.update = function ( delta ) {\n\n\tfor ( var i = 0, il = this.animationsList.length; i < il; i ++ ) {\n\n\t\tvar animation = this.animationsList[ i ];\n\n\t\tif ( ! animation.active ) continue;\n\n\t\tvar frameTime = animation.duration / animation.length;\n\n\t\tanimation.time += animation.direction * delta;\n\n\t\tif ( animation.mirroredLoop ) {\n\n\t\t\tif ( animation.time > animation.duration || animation.time < 0 ) {\n\n\t\t\t\tanimation.direction *= - 1;\n\n\t\t\t\tif ( animation.time > animation.duration ) {\n\n\t\t\t\t\tanimation.time = animation.duration;\n\t\t\t\t\tanimation.directionBackwards = true;\n\n\t\t\t\t}\n\n\t\t\t\tif ( animation.time < 0 ) {\n\n\t\t\t\t\tanimation.time = 0;\n\t\t\t\t\tanimation.directionBackwards = false;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tanimation.time = animation.time % animation.duration;\n\n\t\t\tif ( animation.time < 0 ) animation.time += animation.duration;\n\n\t\t}\n\n\t\tvar keyframe = animation.start + THREE.Math.clamp( Math.floor( animation.time / frameTime ), 0, animation.length - 1 );\n\t\tvar weight = animation.weight;\n\n\t\tif ( keyframe !== animation.currentFrame ) {\n\n\t\t\tthis.morphTargetInfluences[ animation.lastFrame ] = 0;\n\t\t\tthis.morphTargetInfluences[ animation.currentFrame ] = 1 * weight;\n\n\t\t\tthis.morphTargetInfluences[ keyframe ] = 0;\n\n\t\t\tanimation.lastFrame = animation.currentFrame;\n\t\t\tanimation.currentFrame = keyframe;\n\n\t\t}\n\n\t\tvar mix = ( animation.time % frameTime ) / frameTime;\n\n\t\tif ( animation.directionBackwards ) mix = 1 - mix;\n\n\t\tif ( animation.currentFrame !== animation.lastFrame ) {\n\n\t\t\tthis.morphTargetInfluences[ animation.currentFrame ] = mix * weight;\n\t\t\tthis.morphTargetInfluences[ animation.lastFrame ] = ( 1 - mix ) * weight;\n\n\t\t} else {\n\n\t\t\tthis.morphTargetInfluences[ animation.currentFrame ] = weight;\n\n\t\t}\n\n\t}\n\n};\n\n\n\n\n/** WEBPACK FOOTER **\n ** c:/data/Projects/Steering/vendor/three.js\n **/","module.exports = { \"default\": require(\"core-js/library/fn/math/sign\"), __esModule: true };\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/core-js/math/sign.js\n ** module id = 88\n ** module chunks = 0\n **/","require('../../modules/es6.math.sign');\nmodule.exports = require('../../modules/$.core').Math.sign;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/fn/math/sign.js\n ** module id = 89\n ** module chunks = 0\n **/","// 20.2.2.28 Math.sign(x)\nvar $def = require('./$.def');\n\n$def($def.S, 'Math', {sign: require('./$.sign')});\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/es6.math.sign.js\n ** module id = 90\n ** module chunks = 0\n **/","// 20.2.2.28 Math.sign(x)\nmodule.exports = Math.sign || function sign(x){\n  return (x = +x) == 0 || x != x ? x : x < 0 ? -1 : 1;\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/modules/$.sign.js\n ** module id = 91\n ** module chunks = 0\n **/","module.exports = { \"default\": require(\"core-js/library/fn/object/define-properties\"), __esModule: true };\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/core-js/object/define-properties.js\n ** module id = 92\n ** module chunks = 0\n **/","var $ = require('../../modules/$');\nmodule.exports = function defineProperties(T, D){\n  return $.setDescs(T, D);\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/~/core-js/library/fn/object/define-properties.js\n ** module id = 93\n ** module chunks = 0\n **/","import Debug from 'debug';\r\nlet debug = Debug('hedra:plugins:resize');\r\n\r\nimport THREE from 'three';\r\n\r\nfunction resize(config) {\r\n\tdebug('resize');\r\n\t\r\n\tvar parent = this.renderer.domElement.parentNode;\r\n\tvar event = {};\r\n\t\r\n\tif(parent === document.body) {\r\n\t\tevent.width = window.innerWidth;\r\n\t\tevent.height = window.innerHeight;\r\n\t}\r\n\telse {\r\n\t\tevent.width = parent.offsetWidth;\r\n\t\tevent.height = parent.offsetHeight;\r\n\t}\r\n\t\r\n\tthis.bubble('resize', event);\r\n\t\r\n\tthis.camera.aspect = event.width / event.height;\r\n\t\r\n\tif(config.fov) {\r\n\t\tthis.camera.fov = config.y;\r\n\t\t\r\n\t\tvar height = 2 * Math.tan(THREE.Math.degToRad(config.y / 2));\r\n\t\tevent.fovx = THREE.Math.radToDeg(2 * Math.atan(height * this.camera.aspect / 2));\r\n\t\tevent.fovy = THREE.Math.radToDeg(2 * Math.atan(height / 2));\r\n\t\t\r\n\t\tif(event.fovx < config.x) {\r\n\t\t\tvar width = 2 * Math.tan(THREE.Math.degToRad(config.x / 2));\r\n\t\t\tevent.fovy = THREE.Math.radToDeg(2 * Math.atan(width / this.camera.aspect / 2));\r\n\t\t\tevent.fovx = THREE.Math.radToDeg(2 * Math.atan(width / 2));\r\n\t\t\t\r\n\t\t\tthis.camera.fov = event.fovy;\r\n\t\t}\r\n\t}\r\n\t\r\n\tthis.bubble('resize-post', event);\r\n\t\r\n\tthis.camera.updateProjectionMatrix();\r\n\t\r\n\tthis.renderer.setSize(event.width, event.height);\r\n}\r\n\r\nexport default function Resize(context, config) {\r\n\tdebug('initialize', config);\r\n\t\r\n\tconfig = config || {};\r\n\tif(config.fov !== false) {\r\n\t\tconfig.fov = true;\r\n\t}\r\n\t\r\n\twindow.addEventListener('resize', resize.bind(context, config), false);\r\n\tsetTimeout(resize.bind(context, config), 0);\r\n\t\r\n\tif(config.fov) {\r\n\t\tif(!config.ratio) {\r\n\t\t\tconfig.ratio = 16 / 9;\r\n\t\t}\r\n\t\t\r\n\t\tif(!config.y) {\r\n\t\t\tconfig.y = 2 * THREE.Math.radToDeg(Math.atan(3 / 4));\r\n\t\t}\r\n\t\t\r\n\t\tvar height = 2 * Math.tan(THREE.Math.degToRad(config.y / 2));\r\n\t\t\r\n\t\tif(!config.x) {\r\n\t\t\tconfig.x = 2 * THREE.Math.radToDeg(Math.atan(height / 2 * config.ratio));\r\n\t\t}\r\n\t\t\r\n\t\tvar width = 2 * Math.tan(THREE.Math.degToRad(config.x / 2));\r\n\t\t\r\n\t\tif(config.helper) {\r\n\t\t\tcontext.fov_helper = new THREE.Mesh(new THREE.BoxGeometry(width / height, 1, 1), new THREE.MeshBasicMaterial({ wireframe: true }));\r\n\t\t\tcontext.fov_helper.name = 'FOV Helper';\r\n\t\t\tcontext.fov_helper.position.set(0, 0, -1 / height - 0.5);\r\n\t\t\tcontext.camera.add(context.fov_helper);\r\n\t\t}\r\n\t}\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** c:/data/Projects/Steering/~/hedra/plugins/resize.jsx\n **/","export function fromDisc(radius) {\r\n\tradius *= Math.sqrt(Math.random());\r\n\t\r\n\tlet angle = 2 * Math.PI * Math.random();\r\n\t\r\n\treturn [\r\n\t\tradius * Math.cos(angle),\r\n\t\tradius * Math.sin(angle),\r\n\t];\r\n}\r\n\r\nexport function fromCircle(radius) {\r\n\tlet angle = 2 * Math.PI * Math.random();\r\n\t\r\n\treturn [\r\n\t\tradius * Math.cos(angle),\r\n\t\tradius * Math.sin(angle),\r\n\t];\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** c:/data/Projects/Steering/src/lib/random.js\n **/","import Debug from 'debug';\r\nlet debug = Debug('app:agent');\r\n\r\nimport Hedra from 'hedra';\r\nimport THREE from 'three';\r\nimport Steering from './steering';\r\n\r\nlet geometry;\r\nlet material;\r\n\r\nexport default class Agent extends Hedra {\r\n\tstatic load() {\r\n\t\treturn new Promise((resolve) => {\r\n\t\t\tvar vertices = [\r\n\t\t\t\t 0,  0, -1,\r\n\t\t\t\t 1,  1,  1,\r\n\t\t\t\t-1,  1,  1,\r\n\t\t\t\t-1, -1,  1,\r\n\t\t\t\t 1, -1,  1,\r\n\t\t\t];\r\n\t\t\t\r\n\t\t\tvar faces = [\r\n\t\t\t\t2, 1, 0,\r\n\t\t\t\t3, 2, 0,\r\n\t\t\t\t4, 3, 0,\r\n\t\t\t\t1, 4, 0,\r\n\t\t\t\t\r\n\t\t\t\t1, 2, 3,\r\n\t\t\t\t3, 4, 1,\r\n\t\t\t];\r\n\t\t\t\r\n\t\t\tgeometry = new THREE.PolyhedronGeometry(vertices, faces, 1);\r\n\t\t\t\r\n\t\t\tmaterial = new THREE.MeshNormalMaterial();\r\n\t\t\t\r\n\t\t\tresolve();\r\n\t\t});\r\n\t}\r\n\t\r\n\tconstructor(config) {\r\n\t\tdebug('construct');\r\n\t\t\r\n\t\tconfig = config || {};\r\n\t\tconfig.geometry = geometry;\r\n\t\tconfig.material = material;\r\n\t\t\r\n\t\tsuper(config);\r\n\t\t\r\n\t\tthis.steering = new Steering(this);\r\n\t\t\r\n\t\tthis.on('update').then((dt, t) => {\r\n\t\t\tthis.steering.update(dt);\r\n\t\t\t\r\n\t\t\tthis.position.set(...this.steering.position);\r\n\t\t\t\r\n\t\t\tthis.quaternion.setFromRotationMatrix(\r\n\t\t\t\tnew THREE.Matrix4().lookAt(new THREE.Vector3(), new THREE.Vector3(...this.steering.velocity), new THREE.Vector3(0, 0, 1))\r\n\t\t\t);\r\n\t\t});\r\n\t}\r\n}\r\n\r\n\n\n\n/** WEBPACK FOOTER **\n ** c:/data/Projects/Steering/src/agent.js\n **/","\"use strict\";\n\nexports[\"default\"] = Function.prototype.bind;\nexports.__esModule = true;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/babel-runtime/helpers/bind.js\n ** module id = 97\n ** module chunks = 0\n **/","import Debug from 'debug';\r\nlet debug = Debug('app:agent');\r\n\r\nimport Emitter from 'emitter';\r\nimport Vec3 from 'gl-matrix/vec3';\r\n\r\nexport default class Steering extends Emitter {\r\n\tconstructor(track) {\r\n\t\tdebug('construct');\r\n\t\t\r\n\t\tsuper();\r\n\t\t\r\n\t\tif (track) {\r\n\t\t\tthis._position = track.position;\r\n\t\t}\r\n\t\t\r\n\t\tthis.speed = 1;\r\n\t\tthis.velocity = Vec3.fromValues(1, 0, 0);\r\n\t\tthis.position = Vec3.fromValues(0, 0, 0);\r\n\t}\r\n\t\r\n\tupdate(dt) {\r\n\t\tlet force = Vec3.create();\r\n\t\t\r\n\t\tVec3.set(force, 0, 0, 0);\r\n\t\tthis.emit('steer', force);\r\n\t\t\r\n\t\tVec3.scale(force, force, dt);\r\n\t\t\r\n\t\tVec3.add(this.velocity, this.velocity, force);\r\n\t\tVec3.normalize(this.velocity, this.velocity);\r\n\t\tVec3.scale(this.velocity, this.velocity, this.speed);\r\n\t\t\r\n\t\tVec3.add(this.position, this.position, Vec3.scale([], this.velocity, dt));\r\n\t}\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** c:/data/Projects/Steering/src/steering/index.js\n **/","/* Copyright (c) 2015, Brandon Jones, Colin MacKenzie IV.\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE. */\n\nvar glMatrix = require(\"./common.js\");\n\n/**\n * @class 3 Dimensional Vector\n * @name vec3\n */\nvar vec3 = {};\n\n/**\n * Creates a new, empty vec3\n *\n * @returns {vec3} a new 3D vector\n */\nvec3.create = function() {\n    var out = new glMatrix.ARRAY_TYPE(3);\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n    return out;\n};\n\n/**\n * Creates a new vec3 initialized with values from an existing vector\n *\n * @param {vec3} a vector to clone\n * @returns {vec3} a new 3D vector\n */\nvec3.clone = function(a) {\n    var out = new glMatrix.ARRAY_TYPE(3);\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    return out;\n};\n\n/**\n * Creates a new vec3 initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} a new 3D vector\n */\nvec3.fromValues = function(x, y, z) {\n    var out = new glMatrix.ARRAY_TYPE(3);\n    out[0] = x;\n    out[1] = y;\n    out[2] = z;\n    return out;\n};\n\n/**\n * Copy the values from one vec3 to another\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the source vector\n * @returns {vec3} out\n */\nvec3.copy = function(out, a) {\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    return out;\n};\n\n/**\n * Set the components of a vec3 to the given values\n *\n * @param {vec3} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} out\n */\nvec3.set = function(out, x, y, z) {\n    out[0] = x;\n    out[1] = y;\n    out[2] = z;\n    return out;\n};\n\n/**\n * Adds two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nvec3.add = function(out, a, b) {\n    out[0] = a[0] + b[0];\n    out[1] = a[1] + b[1];\n    out[2] = a[2] + b[2];\n    return out;\n};\n\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nvec3.subtract = function(out, a, b) {\n    out[0] = a[0] - b[0];\n    out[1] = a[1] - b[1];\n    out[2] = a[2] - b[2];\n    return out;\n};\n\n/**\n * Alias for {@link vec3.subtract}\n * @function\n */\nvec3.sub = vec3.subtract;\n\n/**\n * Multiplies two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nvec3.multiply = function(out, a, b) {\n    out[0] = a[0] * b[0];\n    out[1] = a[1] * b[1];\n    out[2] = a[2] * b[2];\n    return out;\n};\n\n/**\n * Alias for {@link vec3.multiply}\n * @function\n */\nvec3.mul = vec3.multiply;\n\n/**\n * Divides two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nvec3.divide = function(out, a, b) {\n    out[0] = a[0] / b[0];\n    out[1] = a[1] / b[1];\n    out[2] = a[2] / b[2];\n    return out;\n};\n\n/**\n * Alias for {@link vec3.divide}\n * @function\n */\nvec3.div = vec3.divide;\n\n/**\n * Returns the minimum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nvec3.min = function(out, a, b) {\n    out[0] = Math.min(a[0], b[0]);\n    out[1] = Math.min(a[1], b[1]);\n    out[2] = Math.min(a[2], b[2]);\n    return out;\n};\n\n/**\n * Returns the maximum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nvec3.max = function(out, a, b) {\n    out[0] = Math.max(a[0], b[0]);\n    out[1] = Math.max(a[1], b[1]);\n    out[2] = Math.max(a[2], b[2]);\n    return out;\n};\n\n/**\n * Scales a vec3 by a scalar number\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec3} out\n */\nvec3.scale = function(out, a, b) {\n    out[0] = a[0] * b;\n    out[1] = a[1] * b;\n    out[2] = a[2] * b;\n    return out;\n};\n\n/**\n * Adds two vec3's after scaling the second operand by a scalar value\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {vec3} out\n */\nvec3.scaleAndAdd = function(out, a, b, scale) {\n    out[0] = a[0] + (b[0] * scale);\n    out[1] = a[1] + (b[1] * scale);\n    out[2] = a[2] + (b[2] * scale);\n    return out;\n};\n\n/**\n * Calculates the euclidian distance between two vec3's\n *\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {Number} distance between a and b\n */\nvec3.distance = function(a, b) {\n    var x = b[0] - a[0],\n        y = b[1] - a[1],\n        z = b[2] - a[2];\n    return Math.sqrt(x*x + y*y + z*z);\n};\n\n/**\n * Alias for {@link vec3.distance}\n * @function\n */\nvec3.dist = vec3.distance;\n\n/**\n * Calculates the squared euclidian distance between two vec3's\n *\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {Number} squared distance between a and b\n */\nvec3.squaredDistance = function(a, b) {\n    var x = b[0] - a[0],\n        y = b[1] - a[1],\n        z = b[2] - a[2];\n    return x*x + y*y + z*z;\n};\n\n/**\n * Alias for {@link vec3.squaredDistance}\n * @function\n */\nvec3.sqrDist = vec3.squaredDistance;\n\n/**\n * Calculates the length of a vec3\n *\n * @param {vec3} a vector to calculate length of\n * @returns {Number} length of a\n */\nvec3.length = function (a) {\n    var x = a[0],\n        y = a[1],\n        z = a[2];\n    return Math.sqrt(x*x + y*y + z*z);\n};\n\n/**\n * Alias for {@link vec3.length}\n * @function\n */\nvec3.len = vec3.length;\n\n/**\n * Calculates the squared length of a vec3\n *\n * @param {vec3} a vector to calculate squared length of\n * @returns {Number} squared length of a\n */\nvec3.squaredLength = function (a) {\n    var x = a[0],\n        y = a[1],\n        z = a[2];\n    return x*x + y*y + z*z;\n};\n\n/**\n * Alias for {@link vec3.squaredLength}\n * @function\n */\nvec3.sqrLen = vec3.squaredLength;\n\n/**\n * Negates the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a vector to negate\n * @returns {vec3} out\n */\nvec3.negate = function(out, a) {\n    out[0] = -a[0];\n    out[1] = -a[1];\n    out[2] = -a[2];\n    return out;\n};\n\n/**\n * Returns the inverse of the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a vector to invert\n * @returns {vec3} out\n */\nvec3.inverse = function(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  return out;\n};\n\n/**\n * Normalize a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a vector to normalize\n * @returns {vec3} out\n */\nvec3.normalize = function(out, a) {\n    var x = a[0],\n        y = a[1],\n        z = a[2];\n    var len = x*x + y*y + z*z;\n    if (len > 0) {\n        //TODO: evaluate use of glm_invsqrt here?\n        len = 1 / Math.sqrt(len);\n        out[0] = a[0] * len;\n        out[1] = a[1] * len;\n        out[2] = a[2] * len;\n    }\n    return out;\n};\n\n/**\n * Calculates the dot product of two vec3's\n *\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {Number} dot product of a and b\n */\nvec3.dot = function (a, b) {\n    return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n};\n\n/**\n * Computes the cross product of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nvec3.cross = function(out, a, b) {\n    var ax = a[0], ay = a[1], az = a[2],\n        bx = b[0], by = b[1], bz = b[2];\n\n    out[0] = ay * bz - az * by;\n    out[1] = az * bx - ax * bz;\n    out[2] = ax * by - ay * bx;\n    return out;\n};\n\n/**\n * Performs a linear interpolation between two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @param {Number} t interpolation amount between the two inputs\n * @returns {vec3} out\n */\nvec3.lerp = function (out, a, b, t) {\n    var ax = a[0],\n        ay = a[1],\n        az = a[2];\n    out[0] = ax + t * (b[0] - ax);\n    out[1] = ay + t * (b[1] - ay);\n    out[2] = az + t * (b[2] - az);\n    return out;\n};\n\n/**\n * Performs a hermite interpolation with two control points\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @param {vec3} c the third operand\n * @param {vec3} d the fourth operand\n * @param {Number} t interpolation amount between the two inputs\n * @returns {vec3} out\n */\nvec3.hermite = function (out, a, b, c, d, t) {\n  var factorTimes2 = t * t,\n      factor1 = factorTimes2 * (2 * t - 3) + 1,\n      factor2 = factorTimes2 * (t - 2) + t,\n      factor3 = factorTimes2 * (t - 1),\n      factor4 = factorTimes2 * (3 - 2 * t);\n  \n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  \n  return out;\n};\n\n/**\n * Performs a bezier interpolation with two control points\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @param {vec3} c the third operand\n * @param {vec3} d the fourth operand\n * @param {Number} t interpolation amount between the two inputs\n * @returns {vec3} out\n */\nvec3.bezier = function (out, a, b, c, d, t) {\n  var inverseFactor = 1 - t,\n      inverseFactorTimesTwo = inverseFactor * inverseFactor,\n      factorTimes2 = t * t,\n      factor1 = inverseFactorTimesTwo * inverseFactor,\n      factor2 = 3 * t * inverseFactorTimesTwo,\n      factor3 = 3 * factorTimes2 * inverseFactor,\n      factor4 = factorTimes2 * t;\n  \n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  \n  return out;\n};\n\n/**\n * Generates a random vector with the given scale\n *\n * @param {vec3} out the receiving vector\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\n * @returns {vec3} out\n */\nvec3.random = function (out, scale) {\n    scale = scale || 1.0;\n\n    var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n    var z = (glMatrix.RANDOM() * 2.0) - 1.0;\n    var zScale = Math.sqrt(1.0-z*z) * scale;\n\n    out[0] = Math.cos(r) * zScale;\n    out[1] = Math.sin(r) * zScale;\n    out[2] = z * scale;\n    return out;\n};\n\n/**\n * Transforms the vec3 with a mat4.\n * 4th vector component is implicitly '1'\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the vector to transform\n * @param {mat4} m matrix to transform with\n * @returns {vec3} out\n */\nvec3.transformMat4 = function(out, a, m) {\n    var x = a[0], y = a[1], z = a[2],\n        w = m[3] * x + m[7] * y + m[11] * z + m[15];\n    w = w || 1.0;\n    out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\n    out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\n    out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\n    return out;\n};\n\n/**\n * Transforms the vec3 with a mat3.\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the vector to transform\n * @param {mat4} m the 3x3 matrix to transform with\n * @returns {vec3} out\n */\nvec3.transformMat3 = function(out, a, m) {\n    var x = a[0], y = a[1], z = a[2];\n    out[0] = x * m[0] + y * m[3] + z * m[6];\n    out[1] = x * m[1] + y * m[4] + z * m[7];\n    out[2] = x * m[2] + y * m[5] + z * m[8];\n    return out;\n};\n\n/**\n * Transforms the vec3 with a quat\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the vector to transform\n * @param {quat} q quaternion to transform with\n * @returns {vec3} out\n */\nvec3.transformQuat = function(out, a, q) {\n    // benchmarks: http://jsperf.com/quaternion-transform-vec3-implementations\n\n    var x = a[0], y = a[1], z = a[2],\n        qx = q[0], qy = q[1], qz = q[2], qw = q[3],\n\n        // calculate quat * vec\n        ix = qw * x + qy * z - qz * y,\n        iy = qw * y + qz * x - qx * z,\n        iz = qw * z + qx * y - qy * x,\n        iw = -qx * x - qy * y - qz * z;\n\n    // calculate result * inverse quat\n    out[0] = ix * qw + iw * -qx + iy * -qz - iz * -qy;\n    out[1] = iy * qw + iw * -qy + iz * -qx - ix * -qz;\n    out[2] = iz * qw + iw * -qz + ix * -qy - iy * -qx;\n    return out;\n};\n\n/**\n * Rotate a 3D vector around the x-axis\n * @param {vec3} out The receiving vec3\n * @param {vec3} a The vec3 point to rotate\n * @param {vec3} b The origin of the rotation\n * @param {Number} c The angle of rotation\n * @returns {vec3} out\n */\nvec3.rotateX = function(out, a, b, c){\n   var p = [], r=[];\n\t  //Translate point to the origin\n\t  p[0] = a[0] - b[0];\n\t  p[1] = a[1] - b[1];\n  \tp[2] = a[2] - b[2];\n\n\t  //perform rotation\n\t  r[0] = p[0];\n\t  r[1] = p[1]*Math.cos(c) - p[2]*Math.sin(c);\n\t  r[2] = p[1]*Math.sin(c) + p[2]*Math.cos(c);\n\n\t  //translate to correct position\n\t  out[0] = r[0] + b[0];\n\t  out[1] = r[1] + b[1];\n\t  out[2] = r[2] + b[2];\n\n  \treturn out;\n};\n\n/**\n * Rotate a 3D vector around the y-axis\n * @param {vec3} out The receiving vec3\n * @param {vec3} a The vec3 point to rotate\n * @param {vec3} b The origin of the rotation\n * @param {Number} c The angle of rotation\n * @returns {vec3} out\n */\nvec3.rotateY = function(out, a, b, c){\n  \tvar p = [], r=[];\n  \t//Translate point to the origin\n  \tp[0] = a[0] - b[0];\n  \tp[1] = a[1] - b[1];\n  \tp[2] = a[2] - b[2];\n  \n  \t//perform rotation\n  \tr[0] = p[2]*Math.sin(c) + p[0]*Math.cos(c);\n  \tr[1] = p[1];\n  \tr[2] = p[2]*Math.cos(c) - p[0]*Math.sin(c);\n  \n  \t//translate to correct position\n  \tout[0] = r[0] + b[0];\n  \tout[1] = r[1] + b[1];\n  \tout[2] = r[2] + b[2];\n  \n  \treturn out;\n};\n\n/**\n * Rotate a 3D vector around the z-axis\n * @param {vec3} out The receiving vec3\n * @param {vec3} a The vec3 point to rotate\n * @param {vec3} b The origin of the rotation\n * @param {Number} c The angle of rotation\n * @returns {vec3} out\n */\nvec3.rotateZ = function(out, a, b, c){\n  \tvar p = [], r=[];\n  \t//Translate point to the origin\n  \tp[0] = a[0] - b[0];\n  \tp[1] = a[1] - b[1];\n  \tp[2] = a[2] - b[2];\n  \n  \t//perform rotation\n  \tr[0] = p[0]*Math.cos(c) - p[1]*Math.sin(c);\n  \tr[1] = p[0]*Math.sin(c) + p[1]*Math.cos(c);\n  \tr[2] = p[2];\n  \n  \t//translate to correct position\n  \tout[0] = r[0] + b[0];\n  \tout[1] = r[1] + b[1];\n  \tout[2] = r[2] + b[2];\n  \n  \treturn out;\n};\n\n/**\n * Perform some operation over an array of vec3s.\n *\n * @param {Array} a the array of vectors to iterate over\n * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed\n * @param {Number} offset Number of elements to skip at the beginning of the array\n * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array\n * @param {Function} fn Function to call for each vector in the array\n * @param {Object} [arg] additional argument to pass to fn\n * @returns {Array} a\n * @function\n */\nvec3.forEach = (function() {\n    var vec = vec3.create();\n\n    return function(a, stride, offset, count, fn, arg) {\n        var i, l;\n        if(!stride) {\n            stride = 3;\n        }\n\n        if(!offset) {\n            offset = 0;\n        }\n        \n        if(count) {\n            l = Math.min((count * stride) + offset, a.length);\n        } else {\n            l = a.length;\n        }\n\n        for(i = offset; i < l; i += stride) {\n            vec[0] = a[i]; vec[1] = a[i+1]; vec[2] = a[i+2];\n            fn(vec, vec, arg);\n            a[i] = vec[0]; a[i+1] = vec[1]; a[i+2] = vec[2];\n        }\n        \n        return a;\n    };\n})();\n\n/**\n * Get the angle between two 3D vectors\n * @param {vec3} a The first operand\n * @param {vec3} b The second operand\n * @returns {Number} The angle in radians\n */\nvec3.angle = function(a, b) {\n   \n    var tempA = vec3.fromValues(a[0], a[1], a[2]);\n    var tempB = vec3.fromValues(b[0], b[1], b[2]);\n \n    vec3.normalize(tempA, tempA);\n    vec3.normalize(tempB, tempB);\n \n    var cosine = vec3.dot(tempA, tempB);\n\n    if(cosine > 1.0){\n        return 0;\n    } else {\n        return Math.acos(cosine);\n    }     \n};\n\n/**\n * Returns a string representation of a vector\n *\n * @param {vec3} vec vector to represent as a string\n * @returns {String} string representation of the vector\n */\nvec3.str = function (a) {\n    return 'vec3(' + a[0] + ', ' + a[1] + ', ' + a[2] + ')';\n};\n\nmodule.exports = vec3;\n\n\n\n/** WEBPACK FOOTER **\n ** c:/data/Projects/Steering/vendor/gl-matrix/vec3.js\n **/","/* Copyright (c) 2015, Brandon Jones, Colin MacKenzie IV.\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE. */\n\n/**\n * @class Common utilities\n * @name glMatrix\n */\nvar glMatrix = {};\n\n// Configuration Constants\nglMatrix.EPSILON = 0.000001;\nglMatrix.ARRAY_TYPE = (typeof Float32Array !== 'undefined') ? Float32Array : Array;\nglMatrix.RANDOM = Math.random;\nglMatrix.ENABLE_SIMD = false;\n\n// Capability detection\nglMatrix.SIMD_AVAILABLE = (glMatrix.ARRAY_TYPE === Float32Array) && ('SIMD' in window);\nglMatrix.USE_SIMD = glMatrix.ENABLE_SIMD && glMatrix.SIMD_AVAILABLE;\n\n/**\n * Sets the type of array used when creating new vectors and matrices\n *\n * @param {Type} type Array type, such as Float32Array or Array\n */\nglMatrix.setMatrixArrayType = function(type) {\n    glMatrix.ARRAY_TYPE = type;\n}\n\nvar degree = Math.PI / 180;\n\n/**\n* Convert Degree To Radian\n*\n* @param {Number} Angle in Degrees\n*/\nglMatrix.toRadian = function(a){\n     return a * degree;\n}\n\nmodule.exports = glMatrix;\n\n\n\n/** WEBPACK FOOTER **\n ** c:/data/Projects/Steering/vendor/gl-matrix/common.js\n **/","import Agent from './agent';\r\nimport Wander from './steering/behaviours/wander';\r\nimport Pursue from './steering/behaviours/pursue';\r\nimport Evade from './steering/behaviours/evade';\r\n\r\nexport default function() {\r\n\tlet agents = [];\r\n\t\r\n\tlet predator = new Agent();\r\n\tagents.push(predator);\r\n\t\r\n\tpredator.steering.wander = new Wander(predator.steering, { weight: 25 });\r\n\tpredator.steering.speed = 5;\r\n\t\r\n\tlet prey = new Agent();\r\n\tagents.push(prey);\r\n\t\r\n\tprey.steering.wander = new Wander(prey.steering, { weight: 25 });\r\n\tprey.steering.speed = 5 * 1.5;\r\n\t\r\n\tpredator.steering.pursue = new Pursue(predator.steering, { weight: 5, target: prey.steering, radius: 0 });\r\n\tprey.steering.evade      = new  Evade(prey.steering, { weight: 5, target: predator.steering, radius: 0 });\r\n\t\r\n\treturn agents;\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** c:/data/Projects/Steering/src/hunt.js\n **/","import Behaviour from '../behaviour';\r\n\r\nimport Vec3 from 'gl-matrix/vec3';\r\n\r\nexport default class Wander extends Behaviour {\r\n\tconstructor(agent, { weight, radius = .5, distance = 1, volatility = .5 }) {\r\n\t\tsuper(agent, weight);\r\n\t\t\r\n\t\tthis.angle = 0;\r\n\t\tthis.radius = radius;\r\n\t\tthis.distance = distance;\r\n\t\tthis.volatility = volatility;\r\n\t\t\r\n\t\tagent.on('steer').then((force) => {\r\n\t\t\tthis.angle += (Math.random() * 2 - 1) * volatility;\r\n\t\t\t\r\n\t\t\tlet displacement = Vec3.fromValues(\r\n\t\t\t\tMath.cos(this.angle) * this.radius,\r\n\t\t\t\tMath.sin(this.angle) * this.radius,\r\n\t\t\t\t0\r\n\t\t\t);\r\n\t\t\t\r\n\t\t\tlet wander = Vec3.fromValues(...agent.velocity);\r\n\t\t\tVec3.scale(wander, wander, this.distance);\r\n\t\t\tVec3.add(wander, wander, displacement);\r\n\t\t\t\r\n\t\t\tVec3.normalize(wander, wander);\r\n\t\t\t\r\n\t\t\tBehaviour.addForce(force, wander, this.weight);\r\n\t\t});\r\n\t}\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** c:/data/Projects/Steering/src/steering/behaviours/wander.js\n **/","import Vec3 from 'gl-matrix/vec3';\r\n\r\nexport default class Behaviour {\r\n\tstatic addForce(force, delta, weight) {\r\n\t\tVec3.scale(delta, delta, weight);\r\n\t\tVec3.add(force, force, delta);\r\n\t}\r\n\t\r\n\tstatic neighborhoodDistance(source, agents, radius) {\r\n\t\treturn agents\r\n\t\t\t.map((agent) => {\r\n\t\t\t\tlet delta = Vec3.sub([], source.position, agent.position);\r\n\t\t\t\t\r\n\t\t\t\treturn {\r\n\t\t\t\t\tdistance: Vec3.length(delta),\r\n\t\t\t\t\tagent: agent,\r\n\t\t\t\t};\r\n\t\t\t})\r\n\t\t\t.filter((agent) => {\r\n\t\t\t\treturn source !== agent.agent && agent.distance < radius;\r\n\t\t\t})\r\n\t\t;\r\n\t}\r\n\t\r\n\tconstructor(agent, weight = 1) {\r\n\t\tthis.agent = agent;\r\n\t\tthis.weight = weight;\r\n\t}\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** c:/data/Projects/Steering/src/steering/behaviour.js\n **/","import Behaviour from '../behaviour';\r\n\r\nimport Vec3 from 'gl-matrix/vec3';\r\nimport { seek } from './seek';\r\n\r\nexport default class Pursue extends Behaviour {\r\n\tconstructor(agent, { weight, target, radius = 0 }) {\r\n\t\tsuper(agent, weight);\r\n\t\t\r\n\t\tthis.target = target;\r\n\t\tthis.radius = radius;\r\n\t\t\r\n\t\tagent.on('steer').then((force) => {\r\n\t\t\tlet distance = Vec3.length(Vec3.sub([], this.target.position, agent.position));\r\n\t\t\tlet time = distance / agent.speed;\r\n\t\t\t\r\n\t\t\tlet position = Vec3.scale([], this.target.velocity, time);\r\n\t\t\tVec3.add(position, position, this.target.position);\r\n\t\t\t\r\n\t\t\tlet pursue = seek(agent, { position }, this.radius);\r\n\t\t\t\r\n\t\t\tBehaviour.addForce(force, pursue, this.weight);\r\n\t\t});\r\n\t}\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** c:/data/Projects/Steering/src/steering/behaviours/pursue.js\n **/","import Behaviour from '../behaviour';\r\n\r\nimport Vec3 from 'gl-matrix/vec3';\r\n\r\nexport default class Seek extends Behaviour {\r\n\tconstructor(agent, { weight, target, radius = 0 }) {\r\n\t\tsuper(agent, weight);\r\n\t\t\r\n\t\tthis.target = target;\r\n\t\tthis.radius = radius;\r\n\t\t\r\n\t\tagent.on('steer').then((force) => {\r\n\t\t\tlet delta = seek(agent, this.target, this.radius);\r\n\t\t\t\r\n\t\t\tBehaviour.addForce(force, delta, this.weight);\r\n\t\t});\r\n\t}\r\n}\r\n\r\nexport function seek(agent, target, radius) {\r\n\tlet seek = Vec3.sub([], target.position, agent.position);\r\n\tlet distance = Vec3.length(seek);\r\n\t\r\n\tVec3.normalize(seek, seek);\r\n\tVec3.scale(seek, seek, agent.speed);\r\n\t\r\n\tif (distance < radius) {\r\n\t\tVec3.scale(seek, seek, distance / radius);\r\n\t}\r\n\t\r\n\tVec3.sub(seek, seek, agent.velocity);\r\n\t\r\n\tVec3.normalize(seek, seek);\r\n\t\r\n\treturn seek;\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** c:/data/Projects/Steering/src/steering/behaviours/seek.js\n **/","import Behaviour from '../behaviour';\r\n\r\nimport Vec3 from 'gl-matrix/vec3';\r\nimport { flee } from './flee';\r\n\r\nexport default class Pursue extends Behaviour {\r\n\tconstructor(agent, { weight, target, radius = 0 }) {\r\n\t\tsuper(agent, weight);\r\n\t\t\r\n\t\tthis.target = target;\r\n\t\tthis.radius = radius;\r\n\t\t\r\n\t\tagent.on('steer').then((force) => {\r\n\t\t\tlet distance = Vec3.length(Vec3.sub([], this.target.position, agent.position));\r\n\t\t\tlet time = distance / agent.speed;\r\n\t\t\t\r\n\t\t\tlet position = Vec3.scale([], this.target.velocity, time);\r\n\t\t\tVec3.add(position, position, this.target.position);\r\n\t\t\t\r\n\t\t\tlet pursue = flee(agent, { position }, this.radius);\r\n\t\t\t\r\n\t\t\tBehaviour.addForce(force, pursue, this.weight);\r\n\t\t});\r\n\t}\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** c:/data/Projects/Steering/src/steering/behaviours/evade.js\n **/","import Behaviour from '../behaviour';\r\n\r\nimport Vec3 from 'gl-matrix/vec3';\r\n\r\nexport default class Flee extends Behaviour {\r\n\tconstructor(agent, { weight, target, radius = 0 }) {\r\n\t\tsuper(agent, weight);\r\n\t\t\r\n\t\tthis.target = target;\r\n\t\tthis.radius = radius;\r\n\t\t\r\n\t\tagent.on('steer').then((force) => {\r\n\t\t\tlet delta = flee(agent, this.target, this.radius);\r\n\t\t\t\r\n\t\t\tBehaviour.addForce(force, delta, this.weight);\r\n\t\t});\r\n\t}\r\n}\r\n\r\nexport function flee(agent, target, radius) {\r\n\tlet flee = Vec3.sub([], target.position, agent.position);\r\n\tlet distance = Vec3.length(flee);\r\n\t\r\n\tVec3.normalize(flee, flee);\r\n\tVec3.scale(flee, flee, -agent.speed);\r\n\t\r\n\tif (distance < radius) {\r\n\t\tVec3.scale(flee, flee, distance / radius);\r\n\t}\r\n\t\r\n\tVec3.sub(flee, flee, agent.velocity);\r\n\t\r\n\tVec3.normalize(flee, flee);\r\n\t\r\n\treturn flee;\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** c:/data/Projects/Steering/src/steering/behaviours/flee.js\n **/","import Agent from './agent';\r\nimport Wander from './steering/behaviours/wander';\r\nimport Align from './steering/behaviours/align';\r\nimport Cohere from './steering/behaviours/cohere';\r\nimport Separate from './steering/behaviours/separate';\r\n\r\nexport default function() {\r\n\tlet agents = [];\r\n\tlet steerings = [];\r\n\t\r\n\tfor (var i = 0; i < 150; i++) {\r\n\t\tlet agent = new Agent();\r\n\t\tagents.push(agent);\r\n\t\t\r\n\t\tsteerings.push(agent.steering);\r\n\t\t\r\n\t\tagent.steering.speed = Math.random() + 4;\r\n\t\tagent.steering.wander = new Wander(agent.steering, { weight: 20 });\r\n\t\tagent.steering.align = new Align(agent.steering, { weight: 10, agents: steerings, radius: 15 });\r\n\t\tagent.steering.cohere = new Cohere(agent.steering, { weight: 5, agents: steerings, radius: 9 });\r\n\t\tagent.steering.separate = new Separate(agent.steering, { weight: 15, agents: steerings, radius: 3 });\r\n\t}\r\n\t\r\n\treturn agents;\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** c:/data/Projects/Steering/src/swarm.js\n **/","import Behaviour from '../behaviour';\r\n\r\nimport Vec3 from 'gl-matrix/vec3';\r\n\r\nexport default class Align extends Behaviour {\r\n\tconstructor(agent, { weight, agents, radius = 0 }) {\r\n\t\tsuper(agent, weight);\r\n\t\t\r\n\t\tthis.agents = agents;\r\n\t\tthis.radius = radius;\r\n\t\t\r\n\t\tagent.on('steer').then((force) => {\r\n\t\t\tlet agents = Behaviour.neighborhoodDistance(agent, this.agents, this.radius);\r\n\t\t\t\r\n\t\t\tif (!agents.length) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tlet delta = agents.reduce((average, agent) => {\r\n\t\t\t\treturn Vec3.add(average, average, agent.agent.velocity);\r\n\t\t\t}, Vec3.create());\r\n\t\t\t\r\n\t\t\tVec3.normalize(delta, delta);\r\n\t\t\t\r\n\t\t\tBehaviour.addForce(force, delta, this.weight);\r\n\t\t});\r\n\t}\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** c:/data/Projects/Steering/src/steering/behaviours/align.js\n **/","import Behaviour from '../behaviour';\r\n\r\nimport Vec3 from 'gl-matrix/vec3';\r\n\r\nexport default class Cohere extends Behaviour {\r\n\tconstructor(agent, { weight, agents, radius = 0 }) {\r\n\t\tsuper(agent, weight);\r\n\t\t\r\n\t\tthis.agents = agents;\r\n\t\tthis.radius = radius;\r\n\t\t\r\n\t\tagent.on('steer').then((force) => {\r\n\t\t\tlet agents = Behaviour.neighborhoodDistance(agent, this.agents, this.radius);\r\n\t\t\t\r\n\t\t\tif (!agents.length) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tlet position = agents.reduce((position, agent) => {\r\n\t\t\t\treturn Vec3.add(position, position, agent.agent.position);\r\n\t\t\t}, Vec3.create());\r\n\t\t\t\r\n\t\t\tVec3.scale(position, position, 1 / agents.length);\r\n\t\t\tVec3.sub(position, position, agent.position);\r\n\t\t\t\r\n\t\t\tVec3.normalize(position, position);\r\n\t\t\t\r\n\t\t\tBehaviour.addForce(force, position, this.weight);\r\n\t\t});\r\n\t}\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** c:/data/Projects/Steering/src/steering/behaviours/cohere.js\n **/","import Behaviour from '../behaviour';\r\n\r\nimport Vec3 from 'gl-matrix/vec3';\r\n\r\nexport default class Cohere extends Behaviour {\r\n\tconstructor(agent, { weight, agents, radius = 0 }) {\r\n\t\tsuper(agent, weight);\r\n\t\t\r\n\t\tthis.agents = agents;\r\n\t\tthis.radius = radius;\r\n\t\t\r\n\t\tagent.on('steer').then((force) => {\r\n\t\t\tlet agents = Behaviour.neighborhoodDistance(agent, this.agents, this.radius);\r\n\t\t\t\r\n\t\t\tif (!agents.length) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tlet position = agents.reduce((position, agent) => {\r\n\t\t\t\treturn Vec3.add(position, position, agent.agent.position);\r\n\t\t\t}, Vec3.create());\r\n\t\t\t\r\n\t\t\tVec3.scale(position, position, 1 / agents.length);\r\n\t\t\tVec3.sub(position, position, agent.position);\r\n\t\t\tVec3.scale(position, position, -1);\r\n\t\t\t\r\n\t\t\tVec3.normalize(position, position);\r\n\t\t\t\r\n\t\t\tBehaviour.addForce(force, position, this.weight);\r\n\t\t});\r\n\t}\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** c:/data/Projects/Steering/src/steering/behaviours/separate.js\n **/"],"sourceRoot":""}